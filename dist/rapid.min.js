(()=>{var KM=Object.create;var D5=Object.defineProperty;var ZM=Object.getOwnPropertyDescriptor;var JM=Object.getOwnPropertyNames;var eP=Object.getPrototypeOf,tP=Object.prototype.hasOwnProperty;var rP=(t,e,r)=>e in t?D5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var nt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),F5=(t,e)=>{for(var r in e)D5(t,r,{get:e[r],enumerable:!0})},iP=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of JM(e))!tP.call(t,n)&&n!==r&&D5(t,n,{get:()=>e[n],enumerable:!(i=ZM(e,n))||i.enumerable});return t};var dt=(t,e,r)=>(r=t!=null?KM(eP(t)):{},iP(e||!t||!t.__esModule?D5(r,"default",{value:t,enumerable:!0}):r,t));var ix=(t,e,r)=>(rP(t,typeof e!="symbol"?e+"":e,r),r);var sx=nt((V9,nx)=>{(function(t){"use strict";function e(O){return parseInt(O)===O}function r(O){if(!e(O.length))return!1;for(var R=0;R<O.length;R++)if(!e(O[R])||O[R]<0||O[R]>255)return!1;return!0}function i(O,R){if(O.buffer&&O.name==="Uint8Array")return R&&(O.slice?O=O.slice():O=Array.prototype.slice.call(O)),O;if(Array.isArray(O)){if(!r(O))throw new Error("Array contains invalid value: "+O);return new Uint8Array(O)}if(e(O.length)&&r(O))return new Uint8Array(O);throw new Error("unsupported array-like object")}function n(O){return new Uint8Array(O)}function s(O,R,U,G,$){(G!=null||$!=null)&&(O.slice?O=O.slice(G,$):O=Array.prototype.slice.call(O,G,$)),R.set(O,U)}var o=function(){function O(U){var G=[],$=0;for(U=encodeURI(U);$<U.length;){var q=U.charCodeAt($++);q===37?(G.push(parseInt(U.substr($,2),16)),$+=2):G.push(q)}return i(G)}function R(U){for(var G=[],$=0;$<U.length;){var q=U[$];q<128?(G.push(String.fromCharCode(q)),$++):q>191&&q<224?(G.push(String.fromCharCode((q&31)<<6|U[$+1]&63)),$+=2):(G.push(String.fromCharCode((q&15)<<12|(U[$+1]&63)<<6|U[$+2]&63)),$+=3)}return G.join("")}return{toBytes:O,fromBytes:R}}(),a=function(){function O(G){for(var $=[],q=0;q<G.length;q+=2)$.push(parseInt(G.substr(q,2),16));return $}var R="0123456789abcdef";function U(G){for(var $=[],q=0;q<G.length;q++){var ie=G[q];$.push(R[(ie&240)>>4]+R[ie&15])}return $.join("")}return{toBytes:O,fromBytes:U}}(),l={16:10,24:12,32:14},c=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],u=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],d=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],h=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],p=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],m=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],g=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],y=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],v=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],x=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],_=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],b=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],w=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],E=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],A=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function T(O){for(var R=[],U=0;U<O.length;U+=4)R.push(O[U]<<24|O[U+1]<<16|O[U+2]<<8|O[U+3]);return R}var k=function(O){if(!(this instanceof k))throw Error("AES must be instanitated with `new`");Object.defineProperty(this,"key",{value:i(O,!0)}),this._prepare()};k.prototype._prepare=function(){var O=l[this.key.length];if(O==null)throw new Error("invalid key size (must be 16, 24 or 32 bytes)");this._Ke=[],this._Kd=[];for(var R=0;R<=O;R++)this._Ke.push([0,0,0,0]),this._Kd.push([0,0,0,0]);for(var U=(O+1)*4,G=this.key.length/4,$=T(this.key),q,R=0;R<G;R++)q=R>>2,this._Ke[q][R%4]=$[R],this._Kd[O-q][R%4]=$[R];for(var ie=0,Q=G,re;Q<U;){if(re=$[G-1],$[0]^=u[re>>16&255]<<24^u[re>>8&255]<<16^u[re&255]<<8^u[re>>24&255]^c[ie]<<24,ie+=1,G!=8)for(var R=1;R<G;R++)$[R]^=$[R-1];else{for(var R=1;R<G/2;R++)$[R]^=$[R-1];re=$[G/2-1],$[G/2]^=u[re&255]^u[re>>8&255]<<8^u[re>>16&255]<<16^u[re>>24&255]<<24;for(var R=G/2+1;R<G;R++)$[R]^=$[R-1]}for(var R=0,ve,de;R<G&&Q<U;)ve=Q>>2,de=Q%4,this._Ke[ve][de]=$[R],this._Kd[O-ve][de]=$[R++],Q++}for(var ve=1;ve<O;ve++)for(var de=0;de<4;de++)re=this._Kd[ve][de],this._Kd[ve][de]=b[re>>24&255]^w[re>>16&255]^E[re>>8&255]^A[re&255]},k.prototype.encrypt=function(O){if(O.length!=16)throw new Error("invalid plaintext size (must be 16 bytes)");for(var R=this._Ke.length-1,U=[0,0,0,0],G=T(O),$=0;$<4;$++)G[$]^=this._Ke[0][$];for(var q=1;q<R;q++){for(var $=0;$<4;$++)U[$]=h[G[$]>>24&255]^p[G[($+1)%4]>>16&255]^m[G[($+2)%4]>>8&255]^g[G[($+3)%4]&255]^this._Ke[q][$];G=U.slice()}for(var ie=n(16),Q,$=0;$<4;$++)Q=this._Ke[R][$],ie[4*$]=(u[G[$]>>24&255]^Q>>24)&255,ie[4*$+1]=(u[G[($+1)%4]>>16&255]^Q>>16)&255,ie[4*$+2]=(u[G[($+2)%4]>>8&255]^Q>>8)&255,ie[4*$+3]=(u[G[($+3)%4]&255]^Q)&255;return ie},k.prototype.decrypt=function(O){if(O.length!=16)throw new Error("invalid ciphertext size (must be 16 bytes)");for(var R=this._Kd.length-1,U=[0,0,0,0],G=T(O),$=0;$<4;$++)G[$]^=this._Kd[0][$];for(var q=1;q<R;q++){for(var $=0;$<4;$++)U[$]=y[G[$]>>24&255]^v[G[($+3)%4]>>16&255]^x[G[($+2)%4]>>8&255]^_[G[($+1)%4]&255]^this._Kd[q][$];G=U.slice()}for(var ie=n(16),Q,$=0;$<4;$++)Q=this._Kd[R][$],ie[4*$]=(d[G[$]>>24&255]^Q>>24)&255,ie[4*$+1]=(d[G[($+3)%4]>>16&255]^Q>>16)&255,ie[4*$+2]=(d[G[($+2)%4]>>8&255]^Q>>8)&255,ie[4*$+3]=(d[G[($+1)%4]&255]^Q)&255;return ie};var C=function(O){if(!(this instanceof C))throw Error("AES must be instanitated with `new`");this.description="Electronic Code Block",this.name="ecb",this._aes=new k(O)};C.prototype.encrypt=function(O){if(O=i(O),O.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var R=n(O.length),U=n(16),G=0;G<O.length;G+=16)s(O,U,0,G,G+16),U=this._aes.encrypt(U),s(U,R,G);return R},C.prototype.decrypt=function(O){if(O=i(O),O.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var R=n(O.length),U=n(16),G=0;G<O.length;G+=16)s(O,U,0,G,G+16),U=this._aes.decrypt(U),s(U,R,G);return R};var I=function(O,R){if(!(this instanceof I))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Block Chaining",this.name="cbc",!R)R=n(16);else if(R.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");this._lastCipherblock=i(R,!0),this._aes=new k(O)};I.prototype.encrypt=function(O){if(O=i(O),O.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var R=n(O.length),U=n(16),G=0;G<O.length;G+=16){s(O,U,0,G,G+16);for(var $=0;$<16;$++)U[$]^=this._lastCipherblock[$];this._lastCipherblock=this._aes.encrypt(U),s(this._lastCipherblock,R,G)}return R},I.prototype.decrypt=function(O){if(O=i(O),O.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var R=n(O.length),U=n(16),G=0;G<O.length;G+=16){s(O,U,0,G,G+16),U=this._aes.decrypt(U);for(var $=0;$<16;$++)R[G+$]=U[$]^this._lastCipherblock[$];s(O,this._lastCipherblock,0,G,G+16)}return R};var P=function(O,R,U){if(!(this instanceof P))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Feedback",this.name="cfb",!R)R=n(16);else if(R.length!=16)throw new Error("invalid initialation vector size (must be 16 size)");U||(U=1),this.segmentSize=U,this._shiftRegister=i(R,!0),this._aes=new k(O)};P.prototype.encrypt=function(O){if(O.length%this.segmentSize!=0)throw new Error("invalid plaintext size (must be segmentSize bytes)");for(var R=i(O,!0),U,G=0;G<R.length;G+=this.segmentSize){U=this._aes.encrypt(this._shiftRegister);for(var $=0;$<this.segmentSize;$++)R[G+$]^=U[$];s(this._shiftRegister,this._shiftRegister,0,this.segmentSize),s(R,this._shiftRegister,16-this.segmentSize,G,G+this.segmentSize)}return R},P.prototype.decrypt=function(O){if(O.length%this.segmentSize!=0)throw new Error("invalid ciphertext size (must be segmentSize bytes)");for(var R=i(O,!0),U,G=0;G<R.length;G+=this.segmentSize){U=this._aes.encrypt(this._shiftRegister);for(var $=0;$<this.segmentSize;$++)R[G+$]^=U[$];s(this._shiftRegister,this._shiftRegister,0,this.segmentSize),s(O,this._shiftRegister,16-this.segmentSize,G,G+this.segmentSize)}return R};var N=function(O,R){if(!(this instanceof N))throw Error("AES must be instanitated with `new`");if(this.description="Output Feedback",this.name="ofb",!R)R=n(16);else if(R.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");this._lastPrecipher=i(R,!0),this._lastPrecipherIndex=16,this._aes=new k(O)};N.prototype.encrypt=function(O){for(var R=i(O,!0),U=0;U<R.length;U++)this._lastPrecipherIndex===16&&(this._lastPrecipher=this._aes.encrypt(this._lastPrecipher),this._lastPrecipherIndex=0),R[U]^=this._lastPrecipher[this._lastPrecipherIndex++];return R},N.prototype.decrypt=N.prototype.encrypt;var M=function(O){if(!(this instanceof M))throw Error("Counter must be instanitated with `new`");O!==0&&!O&&(O=1),typeof O=="number"?(this._counter=n(16),this.setValue(O)):this.setBytes(O)};M.prototype.setValue=function(O){if(typeof O!="number"||parseInt(O)!=O)throw new Error("invalid counter value (must be an integer)");if(O>Number.MAX_SAFE_INTEGER)throw new Error("integer value out of safe range");for(var R=15;R>=0;--R)this._counter[R]=O%256,O=parseInt(O/256)},M.prototype.setBytes=function(O){if(O=i(O,!0),O.length!=16)throw new Error("invalid counter bytes size (must be 16 bytes)");this._counter=O},M.prototype.increment=function(){for(var O=15;O>=0;O--)if(this._counter[O]===255)this._counter[O]=0;else{this._counter[O]++;break}};var D=function(O,R){if(!(this instanceof D))throw Error("AES must be instanitated with `new`");this.description="Counter",this.name="ctr",R instanceof M||(R=new M(R)),this._counter=R,this._remainingCounter=null,this._remainingCounterIndex=16,this._aes=new k(O)};D.prototype.encrypt=function(O){for(var R=i(O,!0),U=0;U<R.length;U++)this._remainingCounterIndex===16&&(this._remainingCounter=this._aes.encrypt(this._counter._counter),this._remainingCounterIndex=0,this._counter.increment()),R[U]^=this._remainingCounter[this._remainingCounterIndex++];return R},D.prototype.decrypt=D.prototype.encrypt;function F(O){O=i(O,!0);var R=16-O.length%16,U=n(O.length+R);s(O,U);for(var G=O.length;G<U.length;G++)U[G]=R;return U}function L(O){if(O=i(O,!0),O.length<16)throw new Error("PKCS#7 invalid length");var R=O[O.length-1];if(R>16)throw new Error("PKCS#7 padding byte out of range");for(var U=O.length-R,G=0;G<R;G++)if(O[U+G]!==R)throw new Error("PKCS#7 invalid padding byte");var $=n(U);return s(O,$,0,0,U),$}var B={AES:k,Counter:M,ModeOfOperation:{ecb:C,cbc:I,cfb:P,ofb:N,ctr:D},utils:{hex:a,utf8:o},padding:{pkcs7:{pad:F,strip:L}},_arrayTest:{coerceArray:i,createArray:n,copyArray:s}};typeof V9<"u"?nx.exports=B:typeof define=="function"&&define.amd?define([],function(){return B}):(t.aesjs&&(B._aesjs=t.aesjs),t.aesjs=B)})(V9)});var U5=nt(B5=>{B5.remove=nP;var L5=[{base:" ",chars:"\xA0"},{base:"0",chars:"\u07C0"},{base:"A",chars:"\u24B6\uFF21\xC0\xC1\xC2\u1EA6\u1EA4\u1EAA\u1EA8\xC3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\xC4\u01DE\u1EA2\xC5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F"},{base:"AA",chars:"\uA732"},{base:"AE",chars:"\xC6\u01FC\u01E2"},{base:"AO",chars:"\uA734"},{base:"AU",chars:"\uA736"},{base:"AV",chars:"\uA738\uA73A"},{base:"AY",chars:"\uA73C"},{base:"B",chars:"\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0181"},{base:"C",chars:"\u24B8\uFF23\uA73E\u1E08\u0106C\u0108\u010A\u010C\xC7\u0187\u023B"},{base:"D",chars:"\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018A\u0189\u1D05\uA779"},{base:"Dh",chars:"\xD0"},{base:"DZ",chars:"\u01F1\u01C4"},{base:"Dz",chars:"\u01F2\u01C5"},{base:"E",chars:"\u025B\u24BA\uFF25\xC8\xC9\xCA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\xCB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E\u1D07"},{base:"F",chars:"\uA77C\u24BB\uFF26\u1E1E\u0191\uA77B"},{base:"G",chars:"\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E\u0262"},{base:"H",chars:"\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D"},{base:"I",chars:"\u24BE\uFF29\xCC\xCD\xCE\u0128\u012A\u012C\u0130\xCF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197"},{base:"J",chars:"\u24BF\uFF2A\u0134\u0248\u0237"},{base:"K",chars:"\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2"},{base:"L",chars:"\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780"},{base:"LJ",chars:"\u01C7"},{base:"Lj",chars:"\u01C8"},{base:"M",chars:"\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C\u03FB"},{base:"N",chars:"\uA7A4\u0220\u24C3\uFF2E\u01F8\u0143\xD1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u019D\uA790\u1D0E"},{base:"NJ",chars:"\u01CA"},{base:"Nj",chars:"\u01CB"},{base:"O",chars:"\u24C4\uFF2F\xD2\xD3\xD4\u1ED2\u1ED0\u1ED6\u1ED4\xD5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\xD6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\xD8\u01FE\u0186\u019F\uA74A\uA74C"},{base:"OE",chars:"\u0152"},{base:"OI",chars:"\u01A2"},{base:"OO",chars:"\uA74E"},{base:"OU",chars:"\u0222"},{base:"P",chars:"\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754"},{base:"Q",chars:"\u24C6\uFF31\uA756\uA758\u024A"},{base:"R",chars:"\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782"},{base:"S",chars:"\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784"},{base:"T",chars:"\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786"},{base:"Th",chars:"\xDE"},{base:"TZ",chars:"\uA728"},{base:"U",chars:"\u24CA\uFF35\xD9\xDA\xDB\u0168\u1E78\u016A\u1E7A\u016C\xDC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244"},{base:"V",chars:"\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245"},{base:"VY",chars:"\uA760"},{base:"W",chars:"\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72"},{base:"X",chars:"\u24CD\uFF38\u1E8A\u1E8C"},{base:"Y",chars:"\u24CE\uFF39\u1EF2\xDD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE"},{base:"Z",chars:"\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762"},{base:"a",chars:"\u24D0\uFF41\u1E9A\xE0\xE1\xE2\u1EA7\u1EA5\u1EAB\u1EA9\xE3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\xE4\u01DF\u1EA3\xE5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250\u0251"},{base:"aa",chars:"\uA733"},{base:"ae",chars:"\xE6\u01FD\u01E3"},{base:"ao",chars:"\uA735"},{base:"au",chars:"\uA737"},{base:"av",chars:"\uA739\uA73B"},{base:"ay",chars:"\uA73D"},{base:"b",chars:"\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253\u0182"},{base:"c",chars:"\uFF43\u24D2\u0107\u0109\u010B\u010D\xE7\u1E09\u0188\u023C\uA73F\u2184"},{base:"d",chars:"\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\u018B\u13E7\u0501\uA7AA"},{base:"dh",chars:"\xF0"},{base:"dz",chars:"\u01F3\u01C6"},{base:"e",chars:"\u24D4\uFF45\xE8\xE9\xEA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\xEB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u01DD"},{base:"f",chars:"\u24D5\uFF46\u1E1F\u0192"},{base:"ff",chars:"\uFB00"},{base:"fi",chars:"\uFB01"},{base:"fl",chars:"\uFB02"},{base:"ffi",chars:"\uFB03"},{base:"ffl",chars:"\uFB04"},{base:"g",chars:"\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\uA77F\u1D79"},{base:"h",chars:"\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265"},{base:"hv",chars:"\u0195"},{base:"i",chars:"\u24D8\uFF49\xEC\xED\xEE\u0129\u012B\u012D\xEF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131"},{base:"j",chars:"\u24D9\uFF4A\u0135\u01F0\u0249"},{base:"k",chars:"\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3"},{base:"l",chars:"\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747\u026D"},{base:"lj",chars:"\u01C9"},{base:"m",chars:"\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F"},{base:"n",chars:"\u24DD\uFF4E\u01F9\u0144\xF1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5\u043B\u0509"},{base:"nj",chars:"\u01CC"},{base:"o",chars:"\u24DE\uFF4F\xF2\xF3\xF4\u1ED3\u1ED1\u1ED7\u1ED5\xF5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\xF6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\xF8\u01FF\uA74B\uA74D\u0275\u0254\u1D11"},{base:"oe",chars:"\u0153"},{base:"oi",chars:"\u01A3"},{base:"oo",chars:"\uA74F"},{base:"ou",chars:"\u0223"},{base:"p",chars:"\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755\u03C1"},{base:"q",chars:"\u24E0\uFF51\u024B\uA757\uA759"},{base:"r",chars:"\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783"},{base:"s",chars:"\u24E2\uFF53\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B\u0282"},{base:"ss",chars:"\xDF"},{base:"t",chars:"\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787"},{base:"th",chars:"\xFE"},{base:"tz",chars:"\uA729"},{base:"u",chars:"\u24E4\uFF55\xF9\xFA\xFB\u0169\u1E79\u016B\u1E7B\u016D\xFC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289"},{base:"v",chars:"\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C"},{base:"vy",chars:"\uA761"},{base:"w",chars:"\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73"},{base:"x",chars:"\u24E7\uFF58\u1E8B\u1E8D"},{base:"y",chars:"\u24E8\uFF59\u1EF3\xFD\u0177\u1EF9\u0233\u1E8F\xFF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF"},{base:"z",chars:"\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763"}],W9={};for(E4=0;E4<L5.length;E4+=1)for(X9=L5[E4].chars,O5=0;O5<X9.length;O5+=1)W9[X9[O5]]=L5[E4].base;var X9,O5,E4;function nP(t){return t.replace(/[^\u0000-\u007e]/g,function(e){return W9[e]||e})}B5.replacementList=L5;B5.diacriticsMap=W9});var X8=nt((sJ,V8)=>{"use strict";var WN=Object.prototype.hasOwnProperty,Zi="~";function u2(){}Object.create&&(u2.prototype=Object.create(null),new u2().__proto__||(Zi=!1));function qN(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function Wb(t,e,r,i,n){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new qN(r,i||t,n),o=Zi?Zi+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],s]:t._events[o].push(s):(t._events[o]=s,t._eventsCount++),t}function Yf(t,e){--t._eventsCount===0?t._events=new u2:delete t._events[e]}function Li(){this._events=new u2,this._eventsCount=0}Li.prototype.eventNames=function(){var e=[],r,i;if(this._eventsCount===0)return e;for(i in r=this._events)WN.call(r,i)&&e.push(Zi?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};Li.prototype.listeners=function(e){var r=Zi?Zi+e:e,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};Li.prototype.listenerCount=function(e){var r=Zi?Zi+e:e,i=this._events[r];return i?i.fn?1:i.length:0};Li.prototype.emit=function(e,r,i,n,s,o){var a=Zi?Zi+e:e;if(!this._events[a])return!1;var l=this._events[a],c=arguments.length,u,d;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,r),!0;case 3:return l.fn.call(l.context,r,i),!0;case 4:return l.fn.call(l.context,r,i,n),!0;case 5:return l.fn.call(l.context,r,i,n,s),!0;case 6:return l.fn.call(l.context,r,i,n,s,o),!0}for(d=1,u=new Array(c-1);d<c;d++)u[d-1]=arguments[d];l.fn.apply(l.context,u)}else{var h=l.length,p;for(d=0;d<h;d++)switch(l[d].once&&this.removeListener(e,l[d].fn,void 0,!0),c){case 1:l[d].fn.call(l[d].context);break;case 2:l[d].fn.call(l[d].context,r);break;case 3:l[d].fn.call(l[d].context,r,i);break;case 4:l[d].fn.call(l[d].context,r,i,n);break;default:if(!u)for(p=1,u=new Array(c-1);p<c;p++)u[p-1]=arguments[p];l[d].fn.apply(l[d].context,u)}}return!0};Li.prototype.on=function(e,r,i){return Wb(this,e,r,i,!1)};Li.prototype.once=function(e,r,i){return Wb(this,e,r,i,!0)};Li.prototype.removeListener=function(e,r,i,n){var s=Zi?Zi+e:e;if(!this._events[s])return this;if(!r)return Yf(this,s),this;var o=this._events[s];if(o.fn)o.fn===r&&(!n||o.once)&&(!i||o.context===i)&&Yf(this,s);else{for(var a=0,l=[],c=o.length;a<c;a++)(o[a].fn!==r||n&&!o[a].once||i&&o[a].context!==i)&&l.push(o[a]);l.length?this._events[s]=l.length===1?l[0]:l:Yf(this,s)}return this};Li.prototype.removeAllListeners=function(e){var r;return e?(r=Zi?Zi+e:e,this._events[r]&&Yf(this,r)):(this._events=new u2,this._eventsCount=0),this};Li.prototype.off=Li.prototype.removeListener;Li.prototype.addListener=Li.prototype.on;Li.prefixed=Zi;Li.EventEmitter=Li;typeof V8<"u"&&(V8.exports=Li)});var K8=nt((oJ,Q8)=>{"use strict";Q8.exports=Zf;Q8.exports.default=Zf;function Zf(t,e,r){r=r||2;var i=e&&e.length,n=i?e[0]*r:t.length,s=Yb(t,0,n,r,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,c,u,d,h,p;if(i&&(s=JN(t,e,s,r)),t.length>80*r){a=c=t[0],l=u=t[1];for(var m=r;m<n;m+=r)d=t[m],h=t[m+1],d<a&&(a=d),h<l&&(l=h),d>c&&(c=d),h>u&&(u=h);p=Math.max(c-a,u-l),p=p!==0?32767/p:0}return f2(s,o,r,a,l,p,0),o}function Yb(t,e,r,i,n){var s,o;if(n===Y8(t,e,r,i)>0)for(s=e;s<r;s+=i)o=qb(s,t[s],t[s+1],o);else for(s=r-i;s>=e;s-=i)o=qb(s,t[s],t[s+1],o);return o&&Jf(o,o.next)&&(h2(o),o=o.next),o}function Wl(t,e){if(!t)return t;e||(e=t);var r=t,i;do if(i=!1,!r.steiner&&(Jf(r,r.next)||Nr(r.prev,r,r.next)===0)){if(h2(r),r=e=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==e);return e}function f2(t,e,r,i,n,s,o){if(t){!o&&s&&nD(t,i,n,s);for(var a=t,l,c;t.prev!==t.next;){if(l=t.prev,c=t.next,s?QN(t,i,n,s):YN(t)){e.push(l.i/r|0),e.push(t.i/r|0),e.push(c.i/r|0),h2(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=KN(Wl(t),e,r),f2(t,e,r,i,n,s,2)):o===2&&ZN(t,e,r,i,n,s):f2(Wl(t),e,r,i,n,s,1);break}}}}function YN(t){var e=t.prev,r=t,i=t.next;if(Nr(e,r,i)>=0)return!1;for(var n=e.x,s=r.x,o=i.x,a=e.y,l=r.y,c=i.y,u=n<s?n<o?n:o:s<o?s:o,d=a<l?a<c?a:c:l<c?l:c,h=n>s?n>o?n:o:s>o?s:o,p=a>l?a>c?a:c:l>c?l:c,m=i.next;m!==e;){if(m.x>=u&&m.x<=h&&m.y>=d&&m.y<=p&&Oc(n,a,s,l,o,c,m.x,m.y)&&Nr(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function QN(t,e,r,i){var n=t.prev,s=t,o=t.next;if(Nr(n,s,o)>=0)return!1;for(var a=n.x,l=s.x,c=o.x,u=n.y,d=s.y,h=o.y,p=a<l?a<c?a:c:l<c?l:c,m=u<d?u<h?u:h:d<h?d:h,g=a>l?a>c?a:c:l>c?l:c,y=u>d?u>h?u:h:d>h?d:h,v=W8(p,m,e,r,i),x=W8(g,y,e,r,i),_=t.prevZ,b=t.nextZ;_&&_.z>=v&&b&&b.z<=x;){if(_.x>=p&&_.x<=g&&_.y>=m&&_.y<=y&&_!==n&&_!==o&&Oc(a,u,l,d,c,h,_.x,_.y)&&Nr(_.prev,_,_.next)>=0||(_=_.prevZ,b.x>=p&&b.x<=g&&b.y>=m&&b.y<=y&&b!==n&&b!==o&&Oc(a,u,l,d,c,h,b.x,b.y)&&Nr(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;_&&_.z>=v;){if(_.x>=p&&_.x<=g&&_.y>=m&&_.y<=y&&_!==n&&_!==o&&Oc(a,u,l,d,c,h,_.x,_.y)&&Nr(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=x;){if(b.x>=p&&b.x<=g&&b.y>=m&&b.y<=y&&b!==n&&b!==o&&Oc(a,u,l,d,c,h,b.x,b.y)&&Nr(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function KN(t,e,r){var i=t;do{var n=i.prev,s=i.next.next;!Jf(n,s)&&Qb(n,i,i.next,s)&&d2(n,s)&&d2(s,n)&&(e.push(n.i/r|0),e.push(i.i/r|0),e.push(s.i/r|0),h2(i),h2(i.next),i=t=s),i=i.next}while(i!==t);return Wl(i)}function ZN(t,e,r,i,n,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&aD(o,a)){var l=Kb(o,a);o=Wl(o,o.next),l=Wl(l,l.next),f2(o,e,r,i,n,s,0),f2(l,e,r,i,n,s,0);return}a=a.next}o=o.next}while(o!==t)}function JN(t,e,r,i){var n=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:t.length,c=Yb(t,a,l,i,!1),c===c.next&&(c.steiner=!0),n.push(oD(c));for(n.sort(eD),s=0;s<n.length;s++)r=tD(n[s],r);return r}function eD(t,e){return t.x-e.x}function tD(t,e){var r=rD(t,e);if(!r)return e;var i=Kb(r,t);return Wl(i,i.next),Wl(r,r.next)}function rD(t,e){var r=e,i=t.x,n=t.y,s=-1/0,o;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var a=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s&&(s=a,o=r.x<r.next.x?r:r.next,a===i))return o}r=r.next}while(r!==e);if(!o)return null;var l=o,c=o.x,u=o.y,d=1/0,h;r=o;do i>=r.x&&r.x>=c&&i!==r.x&&Oc(n<u?i:s,n,c,u,n<u?s:i,n,r.x,r.y)&&(h=Math.abs(n-r.y)/(i-r.x),d2(r,t)&&(h<d||h===d&&(r.x>o.x||r.x===o.x&&iD(o,r)))&&(o=r,d=h)),r=r.next;while(r!==l);return o}function iD(t,e){return Nr(t.prev,t,e.prev)<0&&Nr(e.next,t,t.next)<0}function nD(t,e,r,i){var n=t;do n.z===0&&(n.z=W8(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,sD(n)}function sD(t){var e,r,i,n,s,o,a,l,c=1;do{for(r=t,t=null,s=null,o=0;r;){for(o++,i=r,a=0,e=0;e<c&&(a++,i=i.nextZ,!!i);e++);for(l=c;a>0||l>0&&i;)a!==0&&(l===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:t=n,n.prevZ=s,s=n;r=i}s.nextZ=null,c*=2}while(o>1);return t}function W8(t,e,r,i,n){return t=(t-r)*n|0,e=(e-i)*n|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function oD(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function Oc(t,e,r,i,n,s,o,a){return(n-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(r-o)*(e-a)&&(r-o)*(s-a)>=(n-o)*(i-a)}function aD(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!lD(t,e)&&(d2(t,e)&&d2(e,t)&&cD(t,e)&&(Nr(t.prev,t,e.prev)||Nr(t,e.prev,e))||Jf(t,e)&&Nr(t.prev,t,t.next)>0&&Nr(e.prev,e,e.next)>0)}function Nr(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Jf(t,e){return t.x===e.x&&t.y===e.y}function Qb(t,e,r,i){var n=Kf(Nr(t,e,r)),s=Kf(Nr(t,e,i)),o=Kf(Nr(r,i,t)),a=Kf(Nr(r,i,e));return!!(n!==s&&o!==a||n===0&&Qf(t,r,e)||s===0&&Qf(t,i,e)||o===0&&Qf(r,t,i)||a===0&&Qf(r,e,i))}function Qf(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Kf(t){return t>0?1:t<0?-1:0}function lD(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Qb(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function d2(t,e){return Nr(t.prev,t,t.next)<0?Nr(t,e,t.next)>=0&&Nr(t,t.prev,e)>=0:Nr(t,e,t.prev)<0||Nr(t,t.next,e)<0}function cD(t,e){var r=t,i=!1,n=(t.x+e.x)/2,s=(t.y+e.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==t);return i}function Kb(t,e){var r=new q8(t.i,t.x,t.y),i=new q8(e.i,e.x,e.y),n=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function qb(t,e,r,i){var n=new q8(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function h2(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function q8(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Zf.deviation=function(t,e,r,i){var n=e&&e.length,s=n?e[0]*r:t.length,o=Math.abs(Y8(t,0,s,r));if(n)for(var a=0,l=e.length;a<l;a++){var c=e[a]*r,u=a<l-1?e[a+1]*r:t.length;o-=Math.abs(Y8(t,c,u,r))}var d=0;for(a=0;a<i.length;a+=3){var h=i[a]*r,p=i[a+1]*r,m=i[a+2]*r;d+=Math.abs((t[h]-t[m])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[m+1]-t[h+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function Y8(t,e,r,i){for(var n=0,s=e,o=r-i;s<r;s+=i)n+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return n}Zf.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++)for(var o=0;o<e;o++)r.vertices.push(t[n][s][o]);n>0&&(i+=t[n-1].length,r.holes.push(i))}return r}});var Zb=nt((Lc,Bc)=>{(function(t){var e=typeof Lc=="object"&&Lc&&!Lc.nodeType&&Lc,r=typeof Bc=="object"&&Bc&&!Bc.nodeType&&Bc,i=typeof global=="object"&&global;(i.global===i||i.window===i||i.self===i)&&(t=i);var n,s=2147483647,o=36,a=1,l=26,c=38,u=700,d=72,h=128,p="-",m=/^xn--/,g=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,v={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=o-a,_=Math.floor,b=String.fromCharCode,w;function E(B){throw RangeError(v[B])}function A(B,O){for(var R=B.length,U=[];R--;)U[R]=O(B[R]);return U}function T(B,O){var R=B.split("@"),U="";R.length>1&&(U=R[0]+"@",B=R[1]),B=B.replace(y,".");var G=B.split("."),$=A(G,O).join(".");return U+$}function k(B){for(var O=[],R=0,U=B.length,G,$;R<U;)G=B.charCodeAt(R++),G>=55296&&G<=56319&&R<U?($=B.charCodeAt(R++),($&64512)==56320?O.push(((G&1023)<<10)+($&1023)+65536):(O.push(G),R--)):O.push(G);return O}function C(B){return A(B,function(O){var R="";return O>65535&&(O-=65536,R+=b(O>>>10&1023|55296),O=56320|O&1023),R+=b(O),R}).join("")}function I(B){return B-48<10?B-22:B-65<26?B-65:B-97<26?B-97:o}function P(B,O){return B+22+75*(B<26)-((O!=0)<<5)}function N(B,O,R){var U=0;for(B=R?_(B/u):B>>1,B+=_(B/O);B>x*l>>1;U+=o)B=_(B/x);return _(U+(x+1)*B/(B+c))}function M(B){var O=[],R=B.length,U,G=0,$=h,q=d,ie,Q,re,ve,de,we,ne,Ie,at;for(ie=B.lastIndexOf(p),ie<0&&(ie=0),Q=0;Q<ie;++Q)B.charCodeAt(Q)>=128&&E("not-basic"),O.push(B.charCodeAt(Q));for(re=ie>0?ie+1:0;re<R;){for(ve=G,de=1,we=o;re>=R&&E("invalid-input"),ne=I(B.charCodeAt(re++)),(ne>=o||ne>_((s-G)/de))&&E("overflow"),G+=ne*de,Ie=we<=q?a:we>=q+l?l:we-q,!(ne<Ie);we+=o)at=o-Ie,de>_(s/at)&&E("overflow"),de*=at;U=O.length+1,q=N(G-ve,U,ve==0),_(G/U)>s-$&&E("overflow"),$+=_(G/U),G%=U,O.splice(G++,0,$)}return C(O)}function D(B){var O,R,U,G,$,q,ie,Q,re,ve,de,we=[],ne,Ie,at,Et;for(B=k(B),ne=B.length,O=h,R=0,$=d,q=0;q<ne;++q)de=B[q],de<128&&we.push(b(de));for(U=G=we.length,G&&we.push(p);U<ne;){for(ie=s,q=0;q<ne;++q)de=B[q],de>=O&&de<ie&&(ie=de);for(Ie=U+1,ie-O>_((s-R)/Ie)&&E("overflow"),R+=(ie-O)*Ie,O=ie,q=0;q<ne;++q)if(de=B[q],de<O&&++R>s&&E("overflow"),de==O){for(Q=R,re=o;ve=re<=$?a:re>=$+l?l:re-$,!(Q<ve);re+=o)Et=Q-ve,at=o-ve,we.push(b(P(ve+Et%at,0))),Q=_(Et/at);we.push(b(P(Q,0))),$=N(R,Ie,U==G),R=0,++U}++R,++O}return we.join("")}function F(B){return T(B,function(O){return m.test(O)?M(O.slice(4).toLowerCase()):O})}function L(B){return T(B,function(O){return g.test(O)?"xn--"+D(O):O})}if(n={version:"1.3.2",ucs2:{decode:k,encode:C},decode:M,encode:D,toASCII:L,toUnicode:F},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return n});else if(e&&r)if(Bc.exports==e)r.exports=n;else for(w in n)n.hasOwnProperty(w)&&(e[w]=n[w]);else t.punycode=n})(Lc)});var ew=nt((aJ,Jb)=>{"use strict";Jb.exports={isString:function(t){return typeof t=="string"},isObject:function(t){return typeof t=="object"&&t!==null},isNull:function(t){return t===null},isNullOrUndefined:function(t){return t==null}}});var rw=nt((lJ,tw)=>{"use strict";function uD(t,e){return Object.prototype.hasOwnProperty.call(t,e)}tw.exports=function(t,e,r,i){e=e||"&",r=r||"=";var n={};if(typeof t!="string"||t.length===0)return n;var s=/\+/g;t=t.split(e);var o=1e3;i&&typeof i.maxKeys=="number"&&(o=i.maxKeys);var a=t.length;o>0&&a>o&&(a=o);for(var l=0;l<a;++l){var c=t[l].replace(s,"%20"),u=c.indexOf(r),d,h,p,m;u>=0?(d=c.substr(0,u),h=c.substr(u+1)):(d=c,h=""),p=decodeURIComponent(d),m=decodeURIComponent(h),uD(n,p)?Array.isArray(n[p])?n[p].push(m):n[p]=[n[p],m]:n[p]=m}return n}});var nw=nt((cJ,iw)=>{"use strict";var p2=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};iw.exports=function(t,e,r,i){return e=e||"&",r=r||"=",t===null&&(t=void 0),typeof t=="object"?Object.keys(t).map(function(n){var s=encodeURIComponent(p2(n))+r;return Array.isArray(t[n])?t[n].map(function(o){return s+encodeURIComponent(p2(o))}).join(e):s+encodeURIComponent(p2(t[n]))}).join(e):i?encodeURIComponent(p2(i))+r+encodeURIComponent(p2(t)):""}});var sw=nt(m2=>{"use strict";m2.decode=m2.parse=rw();m2.encode=m2.stringify=nw()});var tp=nt(Gc=>{"use strict";var fD=Zb(),fo=ew();Gc.parse=g2;Gc.resolve=bD;Gc.resolveObject=wD;Gc.format=_D;Gc.Url=ds;function ds(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var dD=/^([a-z0-9.+-]+:)/i,hD=/:[0-9]*$/,pD=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,mD=["<",">",'"',"`"," ","\r",`
`,"	"],gD=["{","}","|","\\","^","`"].concat(mD),Z8=["'"].concat(gD),ow=["%","/","?",";","#"].concat(Z8),aw=["/","?","#"],yD=255,lw=/^[+a-z0-9A-Z_-]{0,63}$/,vD=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,xD={javascript:!0,"javascript:":!0},J8={javascript:!0,"javascript:":!0},Uc={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},ep=sw();function g2(t,e,r){if(t&&fo.isObject(t)&&t instanceof ds)return t;var i=new ds;return i.parse(t,e,r),i}ds.prototype.parse=function(t,e,r){if(!fo.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),n=i!==-1&&i<t.indexOf("#")?"?":"#",s=t.split(n),o=/\\/g;s[0]=s[0].replace(o,"/"),t=s.join(n);var a=t;if(a=a.trim(),!r&&t.split("#").length===1){var l=pD.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=ep.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var c=dD.exec(a);if(c){c=c[0];var u=c.toLowerCase();this.protocol=u,a=a.substr(c.length)}if(r||c||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var d=a.substr(0,2)==="//";d&&!(c&&J8[c])&&(a=a.substr(2),this.slashes=!0)}if(!J8[c]&&(d||c&&!Uc[c])){for(var h=-1,p=0;p<aw.length;p++){var m=a.indexOf(aw[p]);m!==-1&&(h===-1||m<h)&&(h=m)}var g,y;h===-1?y=a.lastIndexOf("@"):y=a.lastIndexOf("@",h),y!==-1&&(g=a.slice(0,y),a=a.slice(y+1),this.auth=decodeURIComponent(g)),h=-1;for(var p=0;p<ow.length;p++){var m=a.indexOf(ow[p]);m!==-1&&(h===-1||m<h)&&(h=m)}h===-1&&(h=a.length),this.host=a.slice(0,h),a=a.slice(h),this.parseHost(),this.hostname=this.hostname||"";var v=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!v)for(var x=this.hostname.split(/\./),p=0,_=x.length;p<_;p++){var b=x[p];if(b&&!b.match(lw)){for(var w="",E=0,A=b.length;E<A;E++)b.charCodeAt(E)>127?w+="x":w+=b[E];if(!w.match(lw)){var T=x.slice(0,p),k=x.slice(p+1),C=b.match(vD);C&&(T.push(C[1]),k.unshift(C[2])),k.length&&(a="/"+k.join(".")+a),this.hostname=T.join(".");break}}}this.hostname.length>yD?this.hostname="":this.hostname=this.hostname.toLowerCase(),v||(this.hostname=fD.toASCII(this.hostname));var I=this.port?":"+this.port:"",P=this.hostname||"";this.host=P+I,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!xD[u])for(var p=0,_=Z8.length;p<_;p++){var N=Z8[p];if(a.indexOf(N)!==-1){var M=encodeURIComponent(N);M===N&&(M=escape(N)),a=a.split(N).join(M)}}var D=a.indexOf("#");D!==-1&&(this.hash=a.substr(D),a=a.slice(0,D));var F=a.indexOf("?");if(F!==-1?(this.search=a.substr(F),this.query=a.substr(F+1),e&&(this.query=ep.parse(this.query)),a=a.slice(0,F)):e&&(this.search="",this.query={}),a&&(this.pathname=a),Uc[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var I=this.pathname||"",L=this.search||"";this.path=I+L}return this.href=this.format(),this};function _D(t){return fo.isString(t)&&(t=g2(t)),t instanceof ds?t.format():ds.prototype.format.call(t)}ds.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,s="";this.host?n=t+this.host:this.hostname&&(n=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&fo.isObject(this.query)&&Object.keys(this.query).length&&(s=ep.stringify(this.query));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Uc[e])&&n!==!1?(n="//"+(n||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):n||(n=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),r=r.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+n+r+o+i};function bD(t,e){return g2(t,!1,!0).resolve(e)}ds.prototype.resolve=function(t){return this.resolveObject(g2(t,!1,!0)).format()};function wD(t,e){return t?g2(t,!1,!0).resolveObject(e):e}ds.prototype.resolveObject=function(t){if(fo.isString(t)){var e=new ds;e.parse(t,!1,!0),t=e}for(var r=new ds,i=Object.keys(this),n=0;n<i.length;n++){var s=i[n];r[s]=this[s]}if(r.hash=t.hash,t.href==="")return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(r[l]=t[l])}return Uc[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!Uc[t.protocol]){for(var c=Object.keys(t),u=0;u<c.length;u++){var d=c[u];r[d]=t[d]}return r.href=r.format(),r}if(r.protocol=t.protocol,!t.host&&!J8[t.protocol]){for(var _=(t.pathname||"").split("/");_.length&&!(t.host=_.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),r.pathname=_.join("/")}else r.pathname=t.pathname;if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var h=r.pathname||"",p=r.search||"";r.path=h+p}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var m=r.pathname&&r.pathname.charAt(0)==="/",g=t.host||t.pathname&&t.pathname.charAt(0)==="/",y=g||m||r.host&&t.pathname,v=y,x=r.pathname&&r.pathname.split("/")||[],_=t.pathname&&t.pathname.split("/")||[],b=r.protocol&&!Uc[r.protocol];if(b&&(r.hostname="",r.port=null,r.host&&(x[0]===""?x[0]=r.host:x.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(_[0]===""?_[0]=t.host:_.unshift(t.host)),t.host=null),y=y&&(_[0]===""||x[0]==="")),g)r.host=t.host||t.host===""?t.host:r.host,r.hostname=t.hostname||t.hostname===""?t.hostname:r.hostname,r.search=t.search,r.query=t.query,x=_;else if(_.length)x||(x=[]),x.pop(),x=x.concat(_),r.search=t.search,r.query=t.query;else if(!fo.isNullOrUndefined(t.search)){if(b){r.hostname=r.host=x.shift();var w=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;w&&(r.auth=w.shift(),r.host=r.hostname=w.shift())}return r.search=t.search,r.query=t.query,(!fo.isNull(r.pathname)||!fo.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!x.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var E=x.slice(-1)[0],A=(r.host||t.host||x.length>1)&&(E==="."||E==="..")||E==="",T=0,k=x.length;k>=0;k--)E=x[k],E==="."?x.splice(k,1):E===".."?(x.splice(k,1),T++):T&&(x.splice(k,1),T--);if(!y&&!v)for(;T--;T)x.unshift("..");y&&x[0]!==""&&(!x[0]||x[0].charAt(0)!=="/")&&x.unshift(""),A&&x.join("/").substr(-1)!=="/"&&x.push("");var C=x[0]===""||x[0]&&x[0].charAt(0)==="/";if(b){r.hostname=r.host=C?"":x.length?x.shift():"";var w=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;w&&(r.auth=w.shift(),r.host=r.hostname=w.shift())}return y=y||r.host&&x.length,y&&!C&&x.unshift(""),x.length?r.pathname=x.join("/"):(r.pathname=null,r.path=null),(!fo.isNull(r.pathname)||!fo.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r};ds.prototype.parseHost=function(){var t=this.host,e=hD.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}});var zw=nt((up,fp)=>{(function(t,e){typeof up=="object"&&typeof fp<"u"?fp.exports=e():typeof define=="function"&&define.amd?define(e):t.quickselect=e()})(up,function(){"use strict";function t(n,s,o,a,l){e(n,s,o||0,a||n.length-1,l||i)}function e(n,s,o,a,l){for(;a>o;){if(a-o>600){var c=a-o+1,u=s-o+1,d=Math.log(c),h=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*h*(c-h)/c)*(u-c/2<0?-1:1),m=Math.max(o,Math.floor(s-u*h/c+p)),g=Math.min(a,Math.floor(s+(c-u)*h/c+p));e(n,s,m,g,l)}var y=n[s],v=o,x=a;for(r(n,o,s),l(n[a],y)>0&&r(n,o,a);v<x;){for(r(n,v,x),v++,x--;l(n[v],y)<0;)v++;for(;l(n[x],y)>0;)x--}l(n[o],y)===0?r(n,o,x):(x++,r(n,x,a)),x<=s&&(o=x+1),s<=x&&(a=x-1)}}function r(n,s,o){var a=n[s];n[s]=n[o],n[o]=a}function i(n,s){return n<s?-1:n>s?1:0}return t})});var Vw=nt((Nee,pp)=>{"use strict";pp.exports=A2;pp.exports.default=A2;var OD=zw();function A2(t,e){if(!(this instanceof A2))return new A2(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),e&&this._initFormat(e),this.clear()}A2.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],i=this.toBBox;if(!hd(t,e))return r;for(var n=[],s,o,a,l;e;){for(s=0,o=e.children.length;s<o;s++)a=e.children[s],l=e.leaf?i(a):a,hd(t,l)&&(e.leaf?r.push(a):hp(t,l)?this._all(a,r):n.push(a));e=n.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!hd(t,e))return!1;for(var i=[],n,s,o,a;e;){for(n=0,s=e.children.length;n<s;n++)if(o=e.children[n],a=e.leaf?r(o):o,hd(t,a)){if(e.leaf||hp(t,a))return!0;i.push(o)}e=i.pop()}return!1},load:function(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=i;else if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Wc([]),this},remove:function(t,e){if(!t)return this;for(var r=this.data,i=this.toBBox(t),n=[],s=[],o,a,l,c;r||n.length;){if(r||(r=n.pop(),a=n[n.length-1],o=s.pop(),c=!0),r.leaf&&(l=LD(t,r.children,e),l!==-1))return r.children.splice(l,1),n.push(r),this._condense(n),this;!c&&!r.leaf&&hp(r,i)?(n.push(r),s.push(o),o=0,a=r,r=r.children[0]):a?(o++,r=a.children[o],c=!1):r=null}return this},toBBox:function(t){return t},compareMinX:Hw,compareMinY:$w,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,i){var n=r-e+1,s=this._maxEntries,o;if(n<=s)return o=Wc(t.slice(e,r+1)),Xc(o,this.toBBox),o;i||(i=Math.ceil(Math.log(n)/Math.log(s)),s=Math.ceil(n/Math.pow(s,i-1))),o=Wc([]),o.leaf=!1,o.height=i;var a=Math.ceil(n/s),l=a*Math.ceil(Math.sqrt(s)),c,u,d,h;for(jw(t,e,r,l,this.compareMinX),c=e;c<=r;c+=l)for(d=Math.min(c+l-1,r),jw(t,c,d,a,this.compareMinY),u=c;u<=d;u+=a)h=Math.min(u+a-1,d),o.children.push(this._build(t,u,h,i-1));return Xc(o,this.toBBox),o},_chooseSubtree:function(t,e,r,i){for(var n,s,o,a,l,c,u,d;i.push(e),!(e.leaf||i.length-1===r);){for(u=d=1/0,n=0,s=e.children.length;n<s;n++)o=e.children[n],l=dp(o),c=BD(t,o)-l,c<d?(d=c,u=l<u?l:u,a=o):c===d&&l<u&&(u=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,r){var i=this.toBBox,n=r?t:i(t),s=[],o=this._chooseSubtree(n,this.data,e,s);for(o.children.push(t),T2(o,n);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(n,s,e)},_split:function(t,e){var r=t[e],i=r.children.length,n=this._minEntries;this._chooseSplitAxis(r,n,i);var s=this._chooseSplitIndex(r,n,i),o=Wc(r.children.splice(s,r.children.length-s));o.height=r.height,o.leaf=r.leaf,Xc(r,this.toBBox),Xc(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(r,o)},_splitRoot:function(t,e){this.data=Wc([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Xc(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var i,n,s,o,a,l,c,u;for(l=c=1/0,i=e;i<=r-e;i++)n=S2(t,0,i,this.toBBox),s=S2(t,i,r,this.toBBox),o=UD(n,s),a=dp(n)+dp(s),o<l?(l=o,u=i,c=a<c?a:c):o===l&&a<c&&(c=a,u=i);return u},_chooseSplitAxis:function(t,e,r){var i=t.leaf?this.compareMinX:Hw,n=t.leaf?this.compareMinY:$w,s=this._allDistMargin(t,e,r,i),o=this._allDistMargin(t,e,r,n);s<o&&t.children.sort(i)},_allDistMargin:function(t,e,r,i){t.children.sort(i);var n=this.toBBox,s=S2(t,0,e,n),o=S2(t,r-e,r,n),a=dd(s)+dd(o),l,c;for(l=e;l<r-e;l++)c=t.children[l],T2(s,t.leaf?n(c):c),a+=dd(s);for(l=r-e-1;l>=e;l--)c=t.children[l],T2(o,t.leaf?n(c):c),a+=dd(o);return a},_adjustParentBBoxes:function(t,e,r){for(var i=r;i>=0;i--)T2(e[i],t)},_condense:function(t){for(var e=t.length-1,r;e>=0;e--)t[e].children.length===0?e>0?(r=t[e-1].children,r.splice(r.indexOf(t[e]),1)):this.clear():Xc(t[e],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};function LD(t,e,r){if(!r)return e.indexOf(t);for(var i=0;i<e.length;i++)if(r(t,e[i]))return i;return-1}function Xc(t,e){S2(t,0,t.children.length,e,t)}function S2(t,e,r,i,n){n||(n=Wc(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var s=e,o;s<r;s++)o=t.children[s],T2(n,t.leaf?i(o):o);return n}function T2(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Hw(t,e){return t.minX-e.minX}function $w(t,e){return t.minY-e.minY}function dp(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function dd(t){return t.maxX-t.minX+(t.maxY-t.minY)}function BD(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function UD(t,e){var r=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,n-r)*Math.max(0,s-i)}function hp(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function hd(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Wc(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function jw(t,e,r,i,n){for(var s=[e,r],o;s.length;)r=s.pop(),e=s.pop(),!(r-e<=i)&&(o=e+Math.ceil((r-e)/i/2)*i,OD(t,o,e,r,n),s.push(e,o,o,r))}});var Ww=nt((Dee,Xw)=>{"use strict";Xw.exports=pd;pd.polyline=pd;pd.polygon=GD;function pd(t,e,r){var i=t.length,n=qc(t[0],e),s=[],o,a,l,c,u;for(r||(r=[]),o=1;o<i;o++){for(a=t[o-1],l=t[o],c=u=qc(l,e);;)if(n|c){if(n&c)break;n?(a=mp(a,l,n,e),n=qc(a,e)):(l=mp(a,l,c,e),c=qc(l,e))}else{s.push(a),c!==u?(s.push(l),o<i-1&&(r.push(s),s=[])):o===i-1&&s.push(l);break}n=u}return s.length&&r.push(s),r}function GD(t,e){var r,i,n,s,o,a,l;for(i=1;i<=8;i*=2){for(r=[],n=t[t.length-1],s=!(qc(n,e)&i),o=0;o<t.length;o++)a=t[o],l=!(qc(a,e)&i),l!==s&&r.push(mp(n,a,i,e)),l&&r.push(a),n=a,s=l;if(t=r,!t.length)break}return r}function mp(t,e,r,i){return r&8?[t[0]+(e[0]-t[0])*(i[3]-t[1])/(e[1]-t[1]),i[3]]:r&4?[t[0]+(e[0]-t[0])*(i[1]-t[1])/(e[1]-t[1]),i[1]]:r&2?[i[2],t[1]+(e[1]-t[1])*(i[2]-t[0])/(e[0]-t[0])]:r&1?[i[0],t[1]+(e[1]-t[1])*(i[0]-t[0])/(e[0]-t[0])]:null}function qc(t,e){var r=0;return t[0]<e[0]?r|=1:t[0]>e[2]&&(r|=2),t[1]<e[1]?r|=4:t[1]>e[3]&&(r|=8),r}});var C2=nt((Fee,Qw)=>{"use strict";var zD=Vw(),HD=Ww();Qw.exports=$D;function $D(t){for(var e=[],r=0;r<t.features.length;r++){var i=t.features[r];if(i.geometry){var n=i.geometry.coordinates;if(i.geometry.type==="Polygon")e.push(qw(n,i.properties));else if(i.geometry.type==="MultiPolygon")for(var s=0;s<n.length;s++)e.push(qw(n[s],i.properties))}}var o=zD().load(e);function a(l,c){for(var u=[],d=o.search({minX:l[0],minY:l[1],maxX:l[0],maxY:l[1]}),h=0;h<d.length;h++)if(Yw(d[h].coords,l))if(c)u.push(d[h].props);else return d[h].props;return c&&u.length?u:null}return a.tree=o,a.bbox=function(c){for(var u=[],d=o.search({minX:c[0],minY:c[1],maxX:c[2],maxY:c[3]}),h=0;h<d.length;h++)jD(d[h].coords,c)&&u.push(d[h].props);return u},a}function jD(t,e){var r=[(e[0]+e[2])/2,(e[1]+e[3])/2];if(Yw(t,r))return!0;for(var i=0;i<t.length;i++)if(HD(t[i],e).length>0)return!0;return!1}function Yw(t,e){for(var r=!1,i=0,n=t.length;i<n;i++)for(var s=t[i],o=0,a=s.length,l=a-1;o<a;l=o++)VD(e,s[o],s[l])&&(r=!r);return r}function VD(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}function qw(t,e){for(var r={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,coords:t,props:e},i=0;i<t[0].length;i++){var n=t[0][i];r.minX=Math.min(r.minX,n[0]),r.minY=Math.min(r.minY,n[1]),r.maxX=Math.max(r.maxX,n[0]),r.maxY=Math.max(r.maxY,n[1])}return r}});var nE=nt((Oee,md)=>{md.exports.RADIUS=6378137;md.exports.FLATTENING=1/298.257223563;md.exports.POLAR_RADIUS=63567523142e-4});var bp=nt((Lee,_p)=>{var sE=nE();_p.exports.geometry=aE;_p.exports.ring=xp;function aE(t){var e=0,r;switch(t.type){case"Polygon":return oE(t.coordinates);case"MultiPolygon":for(r=0;r<t.coordinates.length;r++)e+=oE(t.coordinates[r]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<t.geometries.length;r++)e+=aE(t.geometries[r]);return e}}function oE(t){var e=0;if(t&&t.length>0){e+=Math.abs(xp(t[0]));for(var r=1;r<t.length;r++)e-=Math.abs(xp(t[r]))}return e}function xp(t){var e,r,i,n,s,o,a,l=0,c=t.length;if(c>2){for(a=0;a<c;a++)a===c-2?(n=c-2,s=c-1,o=0):a===c-1?(n=c-1,s=0,o=1):(n=a,s=a+1,o=a+2),e=t[n],r=t[s],i=t[o],l+=(vp(i[0])-vp(e[0]))*Math.sin(vp(r[1]));l=l*sE.RADIUS*sE.RADIUS/2}return l}function vp(t){return t*Math.PI/180}});var cE=nt(lE=>{lE.validateCenter=function(e){var r=[2,3];if(!Array.isArray(e)||!r.includes(e.length))throw new Error("ERROR! Center has to be an array of length two or three");var[i,n]=e;if(typeof i!="number"||typeof n!="number")throw new Error(`ERROR! Longitude and Latitude has to be numbers but where ${typeof i} and ${typeof n}`);if(i>180||i<-180)throw new Error(`ERROR! Longitude has to be between -180 and 180 but was ${i}`);if(n>90||n<-90)throw new Error(`ERROR! Latitude has to be between -90 and 90 but was ${n}`)}});var fE=nt(uE=>{uE.validateRadius=function(e){if(typeof e!="number")throw new Error(`ERROR! Radius has to be a positive number but was: ${typeof e}`);if(e<=0)throw new Error(`ERROR! Radius has to be a positive number but was: ${e}`)}});var hE=nt(dE=>{dE.validateNumberOfEdges=function(e){if(typeof e!="number"){let r=Array.isArray(e)?"array":typeof e;throw new Error(`ERROR! Number of edges has to be a number but was: ${r}`)}if(e<3)throw new Error(`ERROR! Number of edges has to be at least 3 but was: ${e}`)}});var mE=nt(pE=>{pE.validateEarthRadius=function(e){if(typeof e!="number"){let r=Array.isArray(e)?"array":typeof e;throw new Error(`ERROR! Earth radius has to be a number but was: ${r}`)}if(e<=0)throw new Error(`ERROR! Earth radius has to be a positive number but was: ${e}`)}});var yE=nt(gE=>{gE.validateBearing=function(e){if(typeof e!="number"){let r=Array.isArray(e)?"array":typeof e;throw new Error(`ERROR! Bearing has to be a number but was: ${r}`)}}});var EE=nt(ql=>{var vE=cE().validateCenter,xE=fE().validateRadius,_E=hE().validateNumberOfEdges,bE=mE().validateEarthRadius,wE=yE().validateBearing;function rF({center:t,radius:e,numberOfEdges:r,earthRadius:i,bearing:n}){vE(t),xE(e),_E(r),bE(i),wE(n)}ql.validateCenter=vE;ql.validateRadius=xE;ql.validateNumberOfEdges=_E;ql.validateEarthRadius=bE;ql.validateBearing=wE;ql.validateInput=rF});var AE=nt((jee,TE)=>{"use strict";var{validateInput:iF}=EE(),wp=6378137;function Ep(t){return t*Math.PI/180}function SE(t){return t*180/Math.PI}function nF(t,e,r,i){var n=Ep(t[1]),s=Ep(t[0]),o=e/r,a=Math.asin(Math.sin(n)*Math.cos(o)+Math.cos(n)*Math.sin(o)*Math.cos(i)),l=s+Math.atan2(Math.sin(i)*Math.sin(o)*Math.cos(n),Math.cos(o)-Math.sin(n)*Math.sin(a));return[SE(l),SE(a)]}TE.exports=function(e,r,i){var n=sF(i),s=oF(i),o=lF(i),a=aF(i);iF({center:e,radius:r,numberOfEdges:n,earthRadius:s,bearing:o});for(var l=Ep(o),c=[],u=0;u<n;++u)c.push(nF(e,r,s,l+a*2*Math.PI*-u/n));return c.push(c[0]),{type:"Polygon",coordinates:[c]}};function sF(t){if(Sp(t))return 32;if(gd(t)){var e=t.numberOfEdges;return e===void 0?32:e}return t}function oF(t){if(Sp(t))return wp;if(gd(t)){var e=t.earthRadius;return e===void 0?wp:e}return wp}function aF(t){return gd(t)&&t.rightHandRule?-1:1}function lF(t){if(Sp(t))return 0;if(gd(t)){var e=t.bearing;return e===void 0?0:e}return 0}function gd(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function Sp(t){return t==null}});var Cp=nt((Tp,Ap)=>{(function(t,e){typeof Tp=="object"&&typeof Ap<"u"?Ap.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self,t.polygonClipping=e())})(Tp,function(){"use strict";function t(J,V){if(!(J instanceof V))throw new TypeError("Cannot call a class as a function")}function e(J,V){for(var z=0;z<V.length;z++){var X=V[z];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(J,X.key,X)}}function r(J,V,z){return V&&e(J.prototype,V),z&&e(J,z),J}var i=function(){function J(V,z){this.next=null,this.key=V,this.data=z,this.left=null,this.right=null}return J}();function n(J,V){return J>V?1:J<V?-1:0}function s(J,V,z){for(var X=new i(null,null),W=X,Y=X;;){var te=z(J,V.key);if(te<0){if(V.left===null)break;if(z(J,V.left.key)<0){var ce=V.left;if(V.left=ce.right,ce.right=V,V=ce,V.left===null)break}Y.left=V,Y=V,V=V.left}else if(te>0){if(V.right===null)break;if(z(J,V.right.key)>0){var ce=V.right;if(V.right=ce.left,ce.left=V,V=ce,V.right===null)break}W.right=V,W=V,V=V.right}else break}return W.right=V.left,Y.left=V.right,V.left=X.right,V.right=X.left,V}function o(J,V,z,X){var W=new i(J,V);if(z===null)return W.left=W.right=null,W;z=s(J,z,X);var Y=X(J,z.key);return Y<0?(W.left=z.left,W.right=z,z.left=null):Y>=0&&(W.right=z.right,W.left=z,z.right=null),W}function a(J,V,z){var X=null,W=null;if(V){V=s(J,V,z);var Y=z(V.key,J);Y===0?(X=V.left,W=V.right):Y<0?(W=V.right,V.right=null,X=V):(X=V.left,V.left=null,W=V)}return{left:X,right:W}}function l(J,V,z){return V===null?J:(J===null||(V=s(J.key,V,z),V.left=J),V)}function c(J,V,z,X,W){if(J){X(""+V+(z?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+W(J)+`
`);var Y=V+(z?"    ":"\u2502   ");J.left&&c(J.left,Y,!1,X,W),J.right&&c(J.right,Y,!0,X,W)}}var u=function(){function J(V){V===void 0&&(V=n),this._root=null,this._size=0,this._comparator=V}return J.prototype.insert=function(V,z){return this._size++,this._root=o(V,z,this._root,this._comparator)},J.prototype.add=function(V,z){var X=new i(V,z);this._root===null&&(X.left=X.right=null,this._size++,this._root=X);var W=this._comparator,Y=s(V,this._root,W),te=W(V,Y.key);return te===0?this._root=Y:(te<0?(X.left=Y.left,X.right=Y,Y.left=null):te>0&&(X.right=Y.right,X.left=Y,Y.right=null),this._size++,this._root=X),this._root},J.prototype.remove=function(V){this._root=this._remove(V,this._root,this._comparator)},J.prototype._remove=function(V,z,X){var W;if(z===null)return null;z=s(V,z,X);var Y=X(V,z.key);return Y===0?(z.left===null?W=z.right:(W=s(V,z.left,X),W.right=z.right),this._size--,W):z},J.prototype.pop=function(){var V=this._root;if(V){for(;V.left;)V=V.left;return this._root=s(V.key,this._root,this._comparator),this._root=this._remove(V.key,this._root,this._comparator),{key:V.key,data:V.data}}return null},J.prototype.findStatic=function(V){for(var z=this._root,X=this._comparator;z;){var W=X(V,z.key);if(W===0)return z;W<0?z=z.left:z=z.right}return null},J.prototype.find=function(V){return this._root&&(this._root=s(V,this._root,this._comparator),this._comparator(V,this._root.key)!==0)?null:this._root},J.prototype.contains=function(V){for(var z=this._root,X=this._comparator;z;){var W=X(V,z.key);if(W===0)return!0;W<0?z=z.left:z=z.right}return!1},J.prototype.forEach=function(V,z){for(var X=this._root,W=[],Y=!1;!Y;)X!==null?(W.push(X),X=X.left):W.length!==0?(X=W.pop(),V.call(z,X),X=X.right):Y=!0;return this},J.prototype.range=function(V,z,X,W){for(var Y=[],te=this._comparator,ce=this._root,ye;Y.length!==0||ce;)if(ce)Y.push(ce),ce=ce.left;else{if(ce=Y.pop(),ye=te(ce.key,z),ye>0)break;if(te(ce.key,V)>=0&&X.call(W,ce))return this;ce=ce.right}return this},J.prototype.keys=function(){var V=[];return this.forEach(function(z){var X=z.key;return V.push(X)}),V},J.prototype.values=function(){var V=[];return this.forEach(function(z){var X=z.data;return V.push(X)}),V},J.prototype.min=function(){return this._root?this.minNode(this._root).key:null},J.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},J.prototype.minNode=function(V){if(V===void 0&&(V=this._root),V)for(;V.left;)V=V.left;return V},J.prototype.maxNode=function(V){if(V===void 0&&(V=this._root),V)for(;V.right;)V=V.right;return V},J.prototype.at=function(V){for(var z=this._root,X=!1,W=0,Y=[];!X;)if(z)Y.push(z),z=z.left;else if(Y.length>0){if(z=Y.pop(),W===V)return z;W++,z=z.right}else X=!0;return null},J.prototype.next=function(V){var z=this._root,X=null;if(V.right){for(X=V.right;X.left;)X=X.left;return X}for(var W=this._comparator;z;){var Y=W(V.key,z.key);if(Y===0)break;Y<0?(X=z,z=z.left):z=z.right}return X},J.prototype.prev=function(V){var z=this._root,X=null;if(V.left!==null){for(X=V.left;X.right;)X=X.right;return X}for(var W=this._comparator;z;){var Y=W(V.key,z.key);if(Y===0)break;Y<0?z=z.left:(X=z,z=z.right)}return X},J.prototype.clear=function(){return this._root=null,this._size=0,this},J.prototype.toList=function(){return p(this._root)},J.prototype.load=function(V,z,X){z===void 0&&(z=[]),X===void 0&&(X=!1);var W=V.length,Y=this._comparator;if(X&&y(V,z,0,W-1,Y),this._root===null)this._root=d(V,z,0,W),this._size=W;else{var te=g(this.toList(),h(V,z),Y);W=this._size+W,this._root=m({head:te},0,W)}return this},J.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(J.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(J.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),J.prototype.toString=function(V){V===void 0&&(V=function(W){return String(W.key)});var z=[];return c(this._root,"",!0,function(X){return z.push(X)},V),z.join("")},J.prototype.update=function(V,z,X){var W=this._comparator,Y=a(V,this._root,W),te=Y.left,ce=Y.right;W(V,z)<0?ce=o(z,X,ce,W):te=o(z,X,te,W),this._root=l(te,ce,W)},J.prototype.split=function(V){return a(V,this._root,this._comparator)},J}();function d(J,V,z,X){var W=X-z;if(W>0){var Y=z+Math.floor(W/2),te=J[Y],ce=V[Y],ye=new i(te,ce);return ye.left=d(J,V,z,Y),ye.right=d(J,V,Y+1,X),ye}return null}function h(J,V){for(var z=new i(null,null),X=z,W=0;W<J.length;W++)X=X.next=new i(J[W],V[W]);return X.next=null,z.next}function p(J){for(var V=J,z=[],X=!1,W=new i(null,null),Y=W;!X;)V?(z.push(V),V=V.left):z.length>0?(V=Y=Y.next=z.pop(),V=V.right):X=!0;return Y.next=null,W.next}function m(J,V,z){var X=z-V;if(X>0){var W=V+Math.floor(X/2),Y=m(J,V,W),te=J.head;return te.left=Y,J.head=J.head.next,te.right=m(J,W+1,z),te}return null}function g(J,V,z){for(var X=new i(null,null),W=X,Y=J,te=V;Y!==null&&te!==null;)z(Y.key,te.key)<0?(W.next=Y,Y=Y.next):(W.next=te,te=te.next),W=W.next;return Y!==null?W.next=Y:te!==null&&(W.next=te),X.next}function y(J,V,z,X,W){if(!(z>=X)){for(var Y=J[z+X>>1],te=z-1,ce=X+1;;){do te++;while(W(J[te],Y)<0);do ce--;while(W(J[ce],Y)>0);if(te>=ce)break;var ye=J[te];J[te]=J[ce],J[ce]=ye,ye=V[te],V[te]=V[ce],V[ce]=ye}y(J,V,z,ce,W),y(J,V,ce+1,X,W)}}var v=function(V,z){return V.ll.x<=z.x&&z.x<=V.ur.x&&V.ll.y<=z.y&&z.y<=V.ur.y},x=function(V,z){if(z.ur.x<V.ll.x||V.ur.x<z.ll.x||z.ur.y<V.ll.y||V.ur.y<z.ll.y)return null;var X=V.ll.x<z.ll.x?z.ll.x:V.ll.x,W=V.ur.x<z.ur.x?V.ur.x:z.ur.x,Y=V.ll.y<z.ll.y?z.ll.y:V.ll.y,te=V.ur.y<z.ur.y?V.ur.y:z.ur.y;return{ll:{x:X,y:Y},ur:{x:W,y:te}}},_=Number.EPSILON;_===void 0&&(_=Math.pow(2,-52));var b=_*_,w=function(V,z){if(-_<V&&V<_&&-_<z&&z<_)return 0;var X=V-z;return X*X<b*V*z?0:V<z?-1:1},E=function(){function J(){t(this,J),this.reset()}return r(J,[{key:"reset",value:function(){this.xRounder=new A,this.yRounder=new A}},{key:"round",value:function(z,X){return{x:this.xRounder.round(z),y:this.yRounder.round(X)}}}]),J}(),A=function(){function J(){t(this,J),this.tree=new u,this.round(0)}return r(J,[{key:"round",value:function(z){var X=this.tree.add(z),W=this.tree.prev(X);if(W!==null&&w(X.key,W.key)===0)return this.tree.remove(z),W.key;var Y=this.tree.next(X);return Y!==null&&w(X.key,Y.key)===0?(this.tree.remove(z),Y.key):z}}]),J}(),T=new E,k=function(V,z){return V.x*z.y-V.y*z.x},C=function(V,z){return V.x*z.x+V.y*z.y},I=function(V,z,X){var W={x:z.x-V.x,y:z.y-V.y},Y={x:X.x-V.x,y:X.y-V.y},te=k(W,Y);return w(te,0)},P=function(V){return Math.sqrt(C(V,V))},N=function(V,z,X){var W={x:z.x-V.x,y:z.y-V.y},Y={x:X.x-V.x,y:X.y-V.y};return k(Y,W)/P(Y)/P(W)},M=function(V,z,X){var W={x:z.x-V.x,y:z.y-V.y},Y={x:X.x-V.x,y:X.y-V.y};return C(Y,W)/P(Y)/P(W)},D=function(V,z,X){return z.y===0?null:{x:V.x+z.x/z.y*(X-V.y),y:X}},F=function(V,z,X){return z.x===0?null:{x:X,y:V.y+z.y/z.x*(X-V.x)}},L=function(V,z,X,W){if(z.x===0)return F(X,W,V.x);if(W.x===0)return F(V,z,X.x);if(z.y===0)return D(X,W,V.y);if(W.y===0)return D(V,z,X.y);var Y=k(z,W);if(Y==0)return null;var te={x:X.x-V.x,y:X.y-V.y},ce=k(te,z)/Y,ye=k(te,W)/Y,Fe=V.x+ye*z.x,He=X.x+ce*W.x,ae=V.y+ye*z.y,pe=X.y+ce*W.y,Ee=(Fe+He)/2,Me=(ae+pe)/2;return{x:Ee,y:Me}},B=function(){r(J,null,[{key:"compare",value:function(z,X){var W=J.comparePoints(z.point,X.point);return W!==0?W:(z.point!==X.point&&z.link(X),z.isLeft!==X.isLeft?z.isLeft?1:-1:R.compare(z.segment,X.segment))}},{key:"comparePoints",value:function(z,X){return z.x<X.x?-1:z.x>X.x?1:z.y<X.y?-1:z.y>X.y?1:0}}]);function J(V,z){t(this,J),V.events===void 0?V.events=[this]:V.events.push(this),this.point=V,this.isLeft=z}return r(J,[{key:"link",value:function(z){if(z.point===this.point)throw new Error("Tried to link already linked events");for(var X=z.point.events,W=0,Y=X.length;W<Y;W++){var te=X[W];this.point.events.push(te),te.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var z=this.point.events.length,X=0;X<z;X++){var W=this.point.events[X];if(W.segment.consumedBy===void 0)for(var Y=X+1;Y<z;Y++){var te=this.point.events[Y];te.consumedBy===void 0&&W.otherSE.point.events===te.otherSE.point.events&&W.segment.consume(te.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var z=[],X=0,W=this.point.events.length;X<W;X++){var Y=this.point.events[X];Y!==this&&!Y.segment.ringOut&&Y.segment.isInResult()&&z.push(Y)}return z}},{key:"getLeftmostComparator",value:function(z){var X=this,W=new Map,Y=function(ce){var ye=ce.otherSE;W.set(ce,{sine:N(X.point,z.point,ye.point),cosine:M(X.point,z.point,ye.point)})};return function(te,ce){W.has(te)||Y(te),W.has(ce)||Y(ce);var ye=W.get(te),Fe=ye.sine,He=ye.cosine,ae=W.get(ce),pe=ae.sine,Ee=ae.cosine;return Fe>=0&&pe>=0?He<Ee?1:He>Ee?-1:0:Fe<0&&pe<0?He<Ee?-1:He>Ee?1:0:pe<Fe?-1:pe>Fe?1:0}}}]),J}(),O=0,R=function(){r(J,null,[{key:"compare",value:function(z,X){var W=z.leftSE.point.x,Y=X.leftSE.point.x,te=z.rightSE.point.x,ce=X.rightSE.point.x;if(ce<W)return 1;if(te<Y)return-1;var ye=z.leftSE.point.y,Fe=X.leftSE.point.y,He=z.rightSE.point.y,ae=X.rightSE.point.y;if(W<Y){if(Fe<ye&&Fe<He)return 1;if(Fe>ye&&Fe>He)return-1;var pe=z.comparePoint(X.leftSE.point);if(pe<0)return 1;if(pe>0)return-1;var Ee=X.comparePoint(z.rightSE.point);return Ee!==0?Ee:-1}if(W>Y){if(ye<Fe&&ye<ae)return-1;if(ye>Fe&&ye>ae)return 1;var Me=X.comparePoint(z.leftSE.point);if(Me!==0)return Me;var Pe=z.comparePoint(X.rightSE.point);return Pe<0?1:Pe>0?-1:1}if(ye<Fe)return-1;if(ye>Fe)return 1;if(te<ce){var Ze=X.comparePoint(z.rightSE.point);if(Ze!==0)return Ze}if(te>ce){var Zt=z.comparePoint(X.rightSE.point);if(Zt<0)return 1;if(Zt>0)return-1}if(te!==ce){var Ut=He-ye,kr=te-W,ii=ae-Fe,xi=ce-Y;if(Ut>kr&&ii<xi)return 1;if(Ut<kr&&ii>xi)return-1}return te>ce?1:te<ce||He<ae?-1:He>ae?1:z.id<X.id?-1:z.id>X.id?1:0}}]);function J(V,z,X,W){t(this,J),this.id=++O,this.leftSE=V,V.segment=this,V.otherSE=z,this.rightSE=z,z.segment=this,z.otherSE=V,this.rings=X,this.windings=W}return r(J,[{key:"replaceRightSE",value:function(z){this.rightSE=z,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var z=this.leftSE.point.y,X=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:z<X?z:X},ur:{x:this.rightSE.point.x,y:z>X?z:X}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(z){return z.x===this.leftSE.point.x&&z.y===this.leftSE.point.y||z.x===this.rightSE.point.x&&z.y===this.rightSE.point.y}},{key:"comparePoint",value:function(z){if(this.isAnEndpoint(z))return 0;var X=this.leftSE.point,W=this.rightSE.point,Y=this.vector();if(X.x===W.x)return z.x===X.x?0:z.x<X.x?1:-1;var te=(z.y-X.y)/Y.y,ce=X.x+te*Y.x;if(z.x===ce)return 0;var ye=(z.x-X.x)/Y.x,Fe=X.y+ye*Y.y;return z.y===Fe?0:z.y<Fe?-1:1}},{key:"getIntersection",value:function(z){var X=this.bbox(),W=z.bbox(),Y=x(X,W);if(Y===null)return null;var te=this.leftSE.point,ce=this.rightSE.point,ye=z.leftSE.point,Fe=z.rightSE.point,He=v(X,ye)&&this.comparePoint(ye)===0,ae=v(W,te)&&z.comparePoint(te)===0,pe=v(X,Fe)&&this.comparePoint(Fe)===0,Ee=v(W,ce)&&z.comparePoint(ce)===0;if(ae&&He)return Ee&&!pe?ce:!Ee&&pe?Fe:null;if(ae)return pe&&te.x===Fe.x&&te.y===Fe.y?null:te;if(He)return Ee&&ce.x===ye.x&&ce.y===ye.y?null:ye;if(Ee&&pe)return null;if(Ee)return ce;if(pe)return Fe;var Me=L(te,this.vector(),ye,z.vector());return Me===null||!v(Y,Me)?null:T.round(Me.x,Me.y)}},{key:"split",value:function(z){var X=[],W=z.events!==void 0,Y=new B(z,!0),te=new B(z,!1),ce=this.rightSE;this.replaceRightSE(te),X.push(te),X.push(Y);var ye=new J(Y,ce,this.rings.slice(),this.windings.slice());return B.comparePoints(ye.leftSE.point,ye.rightSE.point)>0&&ye.swapEvents(),B.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),W&&(Y.checkForConsuming(),te.checkForConsuming()),X}},{key:"swapEvents",value:function(){var z=this.rightSE;this.rightSE=this.leftSE,this.leftSE=z,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var X=0,W=this.windings.length;X<W;X++)this.windings[X]*=-1}},{key:"consume",value:function(z){for(var X=this,W=z;X.consumedBy;)X=X.consumedBy;for(;W.consumedBy;)W=W.consumedBy;var Y=J.compare(X,W);if(Y!==0){if(Y>0){var te=X;X=W,W=te}if(X.prev===W){var ce=X;X=W,W=ce}for(var ye=0,Fe=W.rings.length;ye<Fe;ye++){var He=W.rings[ye],ae=W.windings[ye],pe=X.rings.indexOf(He);pe===-1?(X.rings.push(He),X.windings.push(ae)):X.windings[pe]+=ae}W.rings=null,W.windings=null,W.consumedBy=X,W.leftSE.consumedBy=X.leftSE,W.rightSE.consumedBy=X.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var z=this.prev.consumedBy||this.prev;this._beforeState=z.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var z=this.beforeState();this._afterState={rings:z.rings.slice(0),windings:z.windings.slice(0),multiPolys:[]};for(var X=this._afterState.rings,W=this._afterState.windings,Y=this._afterState.multiPolys,te=0,ce=this.rings.length;te<ce;te++){var ye=this.rings[te],Fe=this.windings[te],He=X.indexOf(ye);He===-1?(X.push(ye),W.push(Fe)):W[He]+=Fe}for(var ae=[],pe=[],Ee=0,Me=X.length;Ee<Me;Ee++)if(W[Ee]!==0){var Pe=X[Ee],Ze=Pe.poly;if(pe.indexOf(Ze)===-1)if(Pe.isExterior)ae.push(Ze);else{pe.indexOf(Ze)===-1&&pe.push(Ze);var Zt=ae.indexOf(Pe.poly);Zt!==-1&&ae.splice(Zt,1)}}for(var Ut=0,kr=ae.length;Ut<kr;Ut++){var ii=ae[Ut].multiPoly;Y.indexOf(ii)===-1&&Y.push(ii)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var z=this.beforeState().multiPolys,X=this.afterState().multiPolys;switch(ne.type){case"union":{var W=z.length===0,Y=X.length===0;this._isInResult=W!==Y;break}case"intersection":{var te,ce;z.length<X.length?(te=z.length,ce=X.length):(te=X.length,ce=z.length),this._isInResult=ce===ne.numMultiPolys&&te<ce;break}case"xor":{var ye=Math.abs(z.length-X.length);this._isInResult=ye%2===1;break}case"difference":{var Fe=function(ae){return ae.length===1&&ae[0].isSubject};this._isInResult=Fe(z)!==Fe(X);break}default:throw new Error("Unrecognized operation type found ".concat(ne.type))}return this._isInResult}}],[{key:"fromRing",value:function(z,X,W){var Y,te,ce,ye=B.comparePoints(z,X);if(ye<0)Y=z,te=X,ce=1;else if(ye>0)Y=X,te=z,ce=-1;else throw new Error("Tried to create degenerate segment at [".concat(z.x,", ").concat(z.y,"]"));var Fe=new B(Y,!0),He=new B(te,!1);return new J(Fe,He,[W],[ce])}}]),J}(),U=function(){function J(V,z,X){if(t(this,J),!Array.isArray(V)||V.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=z,this.isExterior=X,this.segments=[],typeof V[0][0]!="number"||typeof V[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var W=T.round(V[0][0],V[0][1]);this.bbox={ll:{x:W.x,y:W.y},ur:{x:W.x,y:W.y}};for(var Y=W,te=1,ce=V.length;te<ce;te++){if(typeof V[te][0]!="number"||typeof V[te][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var ye=T.round(V[te][0],V[te][1]);ye.x===Y.x&&ye.y===Y.y||(this.segments.push(R.fromRing(Y,ye,this)),ye.x<this.bbox.ll.x&&(this.bbox.ll.x=ye.x),ye.y<this.bbox.ll.y&&(this.bbox.ll.y=ye.y),ye.x>this.bbox.ur.x&&(this.bbox.ur.x=ye.x),ye.y>this.bbox.ur.y&&(this.bbox.ur.y=ye.y),Y=ye)}(W.x!==Y.x||W.y!==Y.y)&&this.segments.push(R.fromRing(Y,W,this))}return r(J,[{key:"getSweepEvents",value:function(){for(var z=[],X=0,W=this.segments.length;X<W;X++){var Y=this.segments[X];z.push(Y.leftSE),z.push(Y.rightSE)}return z}}]),J}(),G=function(){function J(V,z){if(t(this,J),!Array.isArray(V))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new U(V[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var X=1,W=V.length;X<W;X++){var Y=new U(V[X],this,!1);Y.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Y.bbox.ll.x),Y.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Y.bbox.ll.y),Y.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Y.bbox.ur.x),Y.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Y.bbox.ur.y),this.interiorRings.push(Y)}this.multiPoly=z}return r(J,[{key:"getSweepEvents",value:function(){for(var z=this.exteriorRing.getSweepEvents(),X=0,W=this.interiorRings.length;X<W;X++)for(var Y=this.interiorRings[X].getSweepEvents(),te=0,ce=Y.length;te<ce;te++)z.push(Y[te]);return z}}]),J}(),$=function(){function J(V,z){if(t(this,J),!Array.isArray(V))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof V[0][0][0]=="number"&&(V=[V])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var X=0,W=V.length;X<W;X++){var Y=new G(V[X],this);Y.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Y.bbox.ll.x),Y.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Y.bbox.ll.y),Y.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Y.bbox.ur.x),Y.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Y.bbox.ur.y),this.polys.push(Y)}this.isSubject=z}return r(J,[{key:"getSweepEvents",value:function(){for(var z=[],X=0,W=this.polys.length;X<W;X++)for(var Y=this.polys[X].getSweepEvents(),te=0,ce=Y.length;te<ce;te++)z.push(Y[te]);return z}}]),J}(),q=function(){r(J,null,[{key:"factory",value:function(z){for(var X=[],W=0,Y=z.length;W<Y;W++){var te=z[W];if(!(!te.isInResult()||te.ringOut)){for(var ce=null,ye=te.leftSE,Fe=te.rightSE,He=[ye],ae=ye.point,pe=[];ce=ye,ye=Fe,He.push(ye),ye.point!==ae;)for(;;){var Ee=ye.getAvailableLinkedEvents();if(Ee.length===0){var Me=He[0].point,Pe=He[He.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Me.x,",")+" ".concat(Me.y,"]. Last matching segment found ends at")+" [".concat(Pe.x,", ").concat(Pe.y,"]."))}if(Ee.length===1){Fe=Ee[0].otherSE;break}for(var Ze=null,Zt=0,Ut=pe.length;Zt<Ut;Zt++)if(pe[Zt].point===ye.point){Ze=Zt;break}if(Ze!==null){var kr=pe.splice(Ze)[0],ii=He.splice(kr.index);ii.unshift(ii[0].otherSE),X.push(new J(ii.reverse()));continue}pe.push({index:He.length,point:ye.point});var xi=ye.getLeftmostComparator(ce);Fe=Ee.sort(xi)[0].otherSE;break}X.push(new J(He))}}return X}}]);function J(V){t(this,J),this.events=V;for(var z=0,X=V.length;z<X;z++)V[z].segment.ringOut=this;this.poly=null}return r(J,[{key:"getGeom",value:function(){for(var z=this.events[0].point,X=[z],W=1,Y=this.events.length-1;W<Y;W++){var te=this.events[W].point,ce=this.events[W+1].point;I(te,z,ce)!==0&&(X.push(te),z=te)}if(X.length===1)return null;var ye=X[0],Fe=X[1];I(ye,z,Fe)===0&&X.shift(),X.push(X[0]);for(var He=this.isExteriorRing()?1:-1,ae=this.isExteriorRing()?0:X.length-1,pe=this.isExteriorRing()?X.length:-1,Ee=[],Me=ae;Me!=pe;Me+=He)Ee.push([X[Me].x,X[Me].y]);return Ee}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var z=this.enclosingRing();this._isExteriorRing=z?!z.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var z=this.events[0],X=1,W=this.events.length;X<W;X++){var Y=this.events[X];B.compare(z,Y)>0&&(z=Y)}for(var te=z.segment.prevInResult(),ce=te?te.prevInResult():null;;){if(!te)return null;if(!ce)return te.ringOut;if(ce.ringOut!==te.ringOut)return ce.ringOut.enclosingRing()!==te.ringOut?te.ringOut:te.ringOut.enclosingRing();te=ce.prevInResult(),ce=te?te.prevInResult():null}}}]),J}(),ie=function(){function J(V){t(this,J),this.exteriorRing=V,V.poly=this,this.interiorRings=[]}return r(J,[{key:"addInterior",value:function(z){this.interiorRings.push(z),z.poly=this}},{key:"getGeom",value:function(){var z=[this.exteriorRing.getGeom()];if(z[0]===null)return null;for(var X=0,W=this.interiorRings.length;X<W;X++){var Y=this.interiorRings[X].getGeom();Y!==null&&z.push(Y)}return z}}]),J}(),Q=function(){function J(V){t(this,J),this.rings=V,this.polys=this._composePolys(V)}return r(J,[{key:"getGeom",value:function(){for(var z=[],X=0,W=this.polys.length;X<W;X++){var Y=this.polys[X].getGeom();Y!==null&&z.push(Y)}return z}},{key:"_composePolys",value:function(z){for(var X=[],W=0,Y=z.length;W<Y;W++){var te=z[W];if(!te.poly)if(te.isExteriorRing())X.push(new ie(te));else{var ce=te.enclosingRing();ce.poly||X.push(new ie(ce)),ce.poly.addInterior(te)}}return X}}]),J}(),re=function(){function J(V){var z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R.compare;t(this,J),this.queue=V,this.tree=new u(z),this.segments=[]}return r(J,[{key:"process",value:function(z){var X=z.segment,W=[];if(z.consumedBy)return z.isLeft?this.queue.remove(z.otherSE):this.tree.remove(X),W;var Y=z.isLeft?this.tree.insert(X):this.tree.find(X);if(!Y)throw new Error("Unable to find segment #".concat(X.id," ")+"[".concat(X.leftSE.point.x,", ").concat(X.leftSE.point.y,"] -> ")+"[".concat(X.rightSE.point.x,", ").concat(X.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var te=Y,ce=Y,ye=void 0,Fe=void 0;ye===void 0;)te=this.tree.prev(te),te===null?ye=null:te.key.consumedBy===void 0&&(ye=te.key);for(;Fe===void 0;)ce=this.tree.next(ce),ce===null?Fe=null:ce.key.consumedBy===void 0&&(Fe=ce.key);if(z.isLeft){var He=null;if(ye){var ae=ye.getIntersection(X);if(ae!==null&&(X.isAnEndpoint(ae)||(He=ae),!ye.isAnEndpoint(ae)))for(var pe=this._splitSafely(ye,ae),Ee=0,Me=pe.length;Ee<Me;Ee++)W.push(pe[Ee])}var Pe=null;if(Fe){var Ze=Fe.getIntersection(X);if(Ze!==null&&(X.isAnEndpoint(Ze)||(Pe=Ze),!Fe.isAnEndpoint(Ze)))for(var Zt=this._splitSafely(Fe,Ze),Ut=0,kr=Zt.length;Ut<kr;Ut++)W.push(Zt[Ut])}if(He!==null||Pe!==null){var ii=null;if(He===null)ii=Pe;else if(Pe===null)ii=He;else{var xi=B.comparePoints(He,Pe);ii=xi<=0?He:Pe}this.queue.remove(X.rightSE),W.push(X.rightSE);for(var Fl=X.split(ii),ns=0,so=Fl.length;ns<so;ns++)W.push(Fl[ns])}W.length>0?(this.tree.remove(X),W.push(z)):(this.segments.push(X),X.prev=ye)}else{if(ye&&Fe){var Dn=ye.getIntersection(Fe);if(Dn!==null){if(!ye.isAnEndpoint(Dn))for(var Bo=this._splitSafely(ye,Dn),mn=0,Da=Bo.length;mn<Da;mn++)W.push(Bo[mn]);if(!Fe.isAnEndpoint(Dn))for(var Fa=this._splitSafely(Fe,Dn),w4=0,j9=Fa.length;w4<j9;w4++)W.push(Fa[w4])}}this.tree.remove(X)}return W}},{key:"_splitSafely",value:function(z,X){this.tree.remove(z);var W=z.rightSE;this.queue.remove(W);var Y=z.split(X);return Y.push(W),z.consumedBy===void 0&&this.tree.insert(z),Y}}]),J}(),ve=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,de=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,we=function(){function J(){t(this,J)}return r(J,[{key:"run",value:function(z,X,W){ne.type=z,T.reset();for(var Y=[new $(X,!0)],te=0,ce=W.length;te<ce;te++)Y.push(new $(W[te],!1));if(ne.numMultiPolys=Y.length,ne.type==="difference")for(var ye=Y[0],Fe=1;Fe<Y.length;)x(Y[Fe].bbox,ye.bbox)!==null?Fe++:Y.splice(Fe,1);if(ne.type==="intersection"){for(var He=0,ae=Y.length;He<ae;He++)for(var pe=Y[He],Ee=He+1,Me=Y.length;Ee<Me;Ee++)if(x(pe.bbox,Y[Ee].bbox)===null)return[]}for(var Pe=new u(B.compare),Ze=0,Zt=Y.length;Ze<Zt;Ze++)for(var Ut=Y[Ze].getSweepEvents(),kr=0,ii=Ut.length;kr<ii;kr++)if(Pe.insert(Ut[kr]),Pe.size>ve)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var xi=new re(Pe),Fl=Pe.size,ns=Pe.pop();ns;){var so=ns.key;if(Pe.size===Fl){var Dn=so.segment;throw new Error("Unable to pop() ".concat(so.isLeft?"left":"right"," SweepEvent ")+"[".concat(so.point.x,", ").concat(so.point.y,"] from segment #").concat(Dn.id," ")+"[".concat(Dn.leftSE.point.x,", ").concat(Dn.leftSE.point.y,"] -> ")+"[".concat(Dn.rightSE.point.x,", ").concat(Dn.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Pe.size>ve)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(xi.segments.length>de)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var Bo=xi.process(so),mn=0,Da=Bo.length;mn<Da;mn++){var Fa=Bo[mn];Fa.consumedBy===void 0&&Pe.insert(Fa)}Fl=Pe.size,ns=Pe.pop()}T.reset();var w4=q.factory(xi.segments),j9=new Q(w4);return j9.getGeom()}}]),J}(),ne=new we,Ie=function(V){for(var z=arguments.length,X=new Array(z>1?z-1:0),W=1;W<z;W++)X[W-1]=arguments[W];return ne.run("union",V,X)},at=function(V){for(var z=arguments.length,X=new Array(z>1?z-1:0),W=1;W<z;W++)X[W-1]=arguments[W];return ne.run("intersection",V,X)},Et=function(V){for(var z=arguments.length,X=new Array(z>1?z-1:0),W=1;W<z;W++)X[W-1]=arguments[W];return ne.run("xor",V,X)},$t=function(V){for(var z=arguments.length,X=new Array(z>1?z-1:0),W=1;W<z;W++)X[W-1]=arguments[W];return ne.run("difference",V,X)},Pt={union:Ie,intersection:at,xor:Et,difference:$t};return Pt})});var CE=nt((Vee,kp)=>{(function(){function t(e,r,i){function n(h){return h.map(function(p,m){return m<2?1*p.toFixed(r):1*p.toFixed(i)})}function s(h){return h.map(n)}function o(h){return h.map(s)}function a(h){return h.map(o)}function l(h){if(!h)return{};switch(h.type){case"Point":return h.coordinates=n(h.coordinates),h;case"LineString":case"MultiPoint":return h.coordinates=s(h.coordinates),h;case"Polygon":case"MultiLineString":return h.coordinates=o(h.coordinates),h;case"MultiPolygon":return h.coordinates=a(h.coordinates),h;case"GeometryCollection":return h.geometries=h.geometries.map(l),h;default:return{}}}function c(h){return h.geometry=l(h.geometry),h}function u(h){return h.features=h.features.map(c),h}function d(h){return h.geometries=h.geometries.map(l),h}if(!e)return e;switch(e.type){case"Feature":return c(e);case"GeometryCollection":return d(e);case"FeatureCollection":return u(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiPolygon":case"MultiLineString":return l(e);default:return e}}kp.exports=t,kp.exports.parse=t})()});var ME=nt((Xee,IE)=>{function yd(t){return typeof t=="object"&&t!==null}function cF(t,e){Array.isArray(t)?t.forEach(e):yd(t)&&Object.keys(t).forEach(function(r){var i=t[r];e(i,r)})}function kE(t){var e=0;return Array.isArray(t)||yd(t)?(cF(t,function(r){if(Array.isArray(r)||yd(r)){var i=kE(r);i>e&&(e=i)}}),e+1):e}function uF(t,e){e=e||{};var r=JSON.stringify([1],null,Qc(e,"indent",2)).slice(2,-3),i=Qc(e,"margins",!1),n=Qc(e,"arrayMargins",!1),s=Qc(e,"objectMargins",!1),o=r===""?1/0:Qc(e,"maxLength",80),a=Qc(e,"maxNesting",1/0);return function l(c,u,d){c&&typeof c.toJSON=="function"&&(c=c.toJSON());var h=JSON.stringify(c);if(h===void 0)return h;var p=o-u.length-d,m=kE(c);if(m<=a&&h.length<=p){var g=dF(h,{addMargin:i,addArrayMargin:n,addObjectMargin:s});if(g.length<=p)return g}if(yd(c)){var y=u+r,v=[],x,_=function(w,E){return E===w.length-1?0:1};if(Array.isArray(c)){for(var b=0;b<c.length;b++)v.push(l(c[b],y,_(c,b))||"null");x="[]"}else Object.keys(c).forEach(function(w,E,A){var T=JSON.stringify(w)+": ",k=l(c[w],y,T.length+_(A,E));k!==void 0&&v.push(T+k)}),x="{}";if(v.length>0)return[x[0],r+v.join(`,
`+y),x[1]].join(`
`+u)}return h}(t,"",0)}var fF=/("(?:[^\\"]|\\.)*")|[:,\][}{]/g;function dF(t,e){e=e||{};var r={"{":"{","}":"}","[":"[","]":"]",",":", ",":":": "};return(e.addMargin||e.addObjectMargin)&&(r["{"]="{ ",r["}"]=" }"),(e.addMargin||e.addArrayMargin)&&(r["["]="[ ",r["]"]=" ]"),t.replace(fF,function(i,n){return n?i:r[i]})}function Qc(t,e,r){return e in t?t[e]:r}IE.exports=uF});var t1=nt((bie,hS)=>{"use strict";hS.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var i,n,s;if(Array.isArray(e)){if(i=e.length,i!=r.length)return!1;for(n=i;n--!==0;)if(!t(e[n],r[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(s=Object.keys(e),i=s.length,i!==Object.keys(r).length)return!1;for(n=i;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[n]))return!1;for(n=i;n--!==0;){var o=s[n];if(!t(e[o],r[o]))return!1}return!0}return e!==e&&r!==r}});var Us=nt(($p,jp)=>{(function(t,e){typeof $p=="object"&&typeof jp<"u"?jp.exports=e():typeof define=="function"&&define.amd?define(e):(t=t||self).RBush=e()})($p,function(){"use strict";function t(y,v,x,_,b){(function w(E,A,T,k,C){for(;k>T;){if(k-T>600){var I=k-T+1,P=A-T+1,N=Math.log(I),M=.5*Math.exp(2*N/3),D=.5*Math.sqrt(N*M*(I-M)/I)*(P-I/2<0?-1:1),F=Math.max(T,Math.floor(A-P*M/I+D)),L=Math.min(k,Math.floor(A+(I-P)*M/I+D));w(E,A,F,L,C)}var B=E[A],O=T,R=k;for(e(E,T,A),C(E[k],B)>0&&e(E,T,k);O<R;){for(e(E,O,R),O++,R--;C(E[O],B)<0;)O++;for(;C(E[R],B)>0;)R--}C(E[T],B)===0?e(E,T,R):e(E,++R,k),R<=A&&(T=R+1),A<=R&&(k=R-1)}})(y,v,x||0,_||y.length-1,b||r)}function e(y,v,x){var _=y[v];y[v]=y[x],y[x]=_}function r(y,v){return y<v?-1:y>v?1:0}var i=function(y){y===void 0&&(y=9),this._maxEntries=Math.max(4,y),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function n(y,v,x){if(!x)return v.indexOf(y);for(var _=0;_<v.length;_++)if(x(y,v[_]))return _;return-1}function s(y,v){o(y,0,y.children.length,v,y)}function o(y,v,x,_,b){b||(b=m(null)),b.minX=1/0,b.minY=1/0,b.maxX=-1/0,b.maxY=-1/0;for(var w=v;w<x;w++){var E=y.children[w];a(b,y.leaf?_(E):E)}return b}function a(y,v){return y.minX=Math.min(y.minX,v.minX),y.minY=Math.min(y.minY,v.minY),y.maxX=Math.max(y.maxX,v.maxX),y.maxY=Math.max(y.maxY,v.maxY),y}function l(y,v){return y.minX-v.minX}function c(y,v){return y.minY-v.minY}function u(y){return(y.maxX-y.minX)*(y.maxY-y.minY)}function d(y){return y.maxX-y.minX+(y.maxY-y.minY)}function h(y,v){return y.minX<=v.minX&&y.minY<=v.minY&&v.maxX<=y.maxX&&v.maxY<=y.maxY}function p(y,v){return v.minX<=y.maxX&&v.minY<=y.maxY&&v.maxX>=y.minX&&v.maxY>=y.minY}function m(y){return{children:y,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(y,v,x,_,b){for(var w=[v,x];w.length;)if(!((x=w.pop())-(v=w.pop())<=_)){var E=v+Math.ceil((x-v)/_/2)*_;t(y,E,v,x,b),w.push(v,E,E,x)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(y){var v=this.data,x=[];if(!p(y,v))return x;for(var _=this.toBBox,b=[];v;){for(var w=0;w<v.children.length;w++){var E=v.children[w],A=v.leaf?_(E):E;p(y,A)&&(v.leaf?x.push(E):h(y,A)?this._all(E,x):b.push(E))}v=b.pop()}return x},i.prototype.collides=function(y){var v=this.data;if(!p(y,v))return!1;for(var x=[];v;){for(var _=0;_<v.children.length;_++){var b=v.children[_],w=v.leaf?this.toBBox(b):b;if(p(y,w)){if(v.leaf||h(y,w))return!0;x.push(b)}}v=x.pop()}return!1},i.prototype.load=function(y){if(!y||!y.length)return this;if(y.length<this._minEntries){for(var v=0;v<y.length;v++)this.insert(y[v]);return this}var x=this._build(y.slice(),0,y.length-1,0);if(this.data.children.length)if(this.data.height===x.height)this._splitRoot(this.data,x);else{if(this.data.height<x.height){var _=this.data;this.data=x,x=_}this._insert(x,this.data.height-x.height-1,!0)}else this.data=x;return this},i.prototype.insert=function(y){return y&&this._insert(y,this.data.height-1),this},i.prototype.clear=function(){return this.data=m([]),this},i.prototype.remove=function(y,v){if(!y)return this;for(var x,_,b,w=this.data,E=this.toBBox(y),A=[],T=[];w||A.length;){if(w||(w=A.pop(),_=A[A.length-1],x=T.pop(),b=!0),w.leaf){var k=n(y,w.children,v);if(k!==-1)return w.children.splice(k,1),A.push(w),this._condense(A),this}b||w.leaf||!h(w,E)?_?(x++,w=_.children[x],b=!1):w=null:(A.push(w),T.push(x),x=0,_=w,w=w.children[0])}return this},i.prototype.toBBox=function(y){return y},i.prototype.compareMinX=function(y,v){return y.minX-v.minX},i.prototype.compareMinY=function(y,v){return y.minY-v.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(y){return this.data=y,this},i.prototype._all=function(y,v){for(var x=[];y;)y.leaf?v.push.apply(v,y.children):x.push.apply(x,y.children),y=x.pop();return v},i.prototype._build=function(y,v,x,_){var b,w=x-v+1,E=this._maxEntries;if(w<=E)return s(b=m(y.slice(v,x+1)),this.toBBox),b;_||(_=Math.ceil(Math.log(w)/Math.log(E)),E=Math.ceil(w/Math.pow(E,_-1))),(b=m([])).leaf=!1,b.height=_;var A=Math.ceil(w/E),T=A*Math.ceil(Math.sqrt(E));g(y,v,x,T,this.compareMinX);for(var k=v;k<=x;k+=T){var C=Math.min(k+T-1,x);g(y,k,C,A,this.compareMinY);for(var I=k;I<=C;I+=A){var P=Math.min(I+A-1,C);b.children.push(this._build(y,I,P,_-1))}}return s(b,this.toBBox),b},i.prototype._chooseSubtree=function(y,v,x,_){for(;_.push(v),!v.leaf&&_.length-1!==x;){for(var b=1/0,w=1/0,E=void 0,A=0;A<v.children.length;A++){var T=v.children[A],k=u(T),C=(I=y,P=T,(Math.max(P.maxX,I.maxX)-Math.min(P.minX,I.minX))*(Math.max(P.maxY,I.maxY)-Math.min(P.minY,I.minY))-k);C<w?(w=C,b=k<b?k:b,E=T):C===w&&k<b&&(b=k,E=T)}v=E||v.children[0]}var I,P;return v},i.prototype._insert=function(y,v,x){var _=x?y:this.toBBox(y),b=[],w=this._chooseSubtree(_,this.data,v,b);for(w.children.push(y),a(w,_);v>=0&&b[v].children.length>this._maxEntries;)this._split(b,v),v--;this._adjustParentBBoxes(_,b,v)},i.prototype._split=function(y,v){var x=y[v],_=x.children.length,b=this._minEntries;this._chooseSplitAxis(x,b,_);var w=this._chooseSplitIndex(x,b,_),E=m(x.children.splice(w,x.children.length-w));E.height=x.height,E.leaf=x.leaf,s(x,this.toBBox),s(E,this.toBBox),v?y[v-1].children.push(E):this._splitRoot(x,E)},i.prototype._splitRoot=function(y,v){this.data=m([y,v]),this.data.height=y.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(y,v,x){for(var _,b,w,E,A,T,k,C=1/0,I=1/0,P=v;P<=x-v;P++){var N=o(y,0,P,this.toBBox),M=o(y,P,x,this.toBBox),D=(b=N,w=M,E=void 0,A=void 0,T=void 0,k=void 0,E=Math.max(b.minX,w.minX),A=Math.max(b.minY,w.minY),T=Math.min(b.maxX,w.maxX),k=Math.min(b.maxY,w.maxY),Math.max(0,T-E)*Math.max(0,k-A)),F=u(N)+u(M);D<C?(C=D,_=P,I=F<I?F:I):D===C&&F<I&&(I=F,_=P)}return _||x-v},i.prototype._chooseSplitAxis=function(y,v,x){var _=y.leaf?this.compareMinX:l,b=y.leaf?this.compareMinY:c;this._allDistMargin(y,v,x,_)<this._allDistMargin(y,v,x,b)&&y.children.sort(_)},i.prototype._allDistMargin=function(y,v,x,_){y.children.sort(_);for(var b=this.toBBox,w=o(y,0,v,b),E=o(y,x-v,x,b),A=d(w)+d(E),T=v;T<x-v;T++){var k=y.children[T];a(w,y.leaf?b(k):k),A+=d(w)}for(var C=x-v-1;C>=v;C--){var I=y.children[C];a(E,y.leaf?b(I):I),A+=d(E)}return A},i.prototype._adjustParentBBoxes=function(y,v,x){for(var _=x;_>=0;_--)a(v[_],y)},i.prototype._condense=function(y){for(var v=y.length-1,x=void 0;v>=0;v--)y[v].children.length===0?v>0?(x=y[v-1].children).splice(x.indexOf(y[v]),1):this.clear():s(y[v],this.toBBox)},i})});var FC=nt((nQe,Ty)=>{"use strict";Ty.exports=a5;Ty.exports.default=a5;function a5(t,e){if(!(this instanceof a5))return new a5(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||kG,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}function kG(t,e){return t<e?-1:t>e?1:0}a5.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,r=this.compare,i=e[t];t>0;){var n=t-1>>1,s=e[n];if(r(i,s)>=0)break;e[t]=s,t=n}e[t]=i},_down:function(t){for(var e=this.data,r=this.compare,i=this.length>>1,n=e[t];t<i;){var s=(t<<1)+1,o=s+1,a=e[s];if(o<this.length&&r(e[o],a)<0&&(s=o,a=e[o]),r(a,n)>=0)break;e[t]=a,t=s}e[t]=n}}});var LC=nt((sQe,Ay)=>{"use strict";var IG=FC();Ay.exports=OC;Ay.exports.default=OC;function OC(t,e,r){e=e||1;for(var i,n,s,o,a=0;a<t[0].length;a++){var l=t[0][a];(!a||l[0]<i)&&(i=l[0]),(!a||l[1]<n)&&(n=l[1]),(!a||l[0]>s)&&(s=l[0]),(!a||l[1]>o)&&(o=l[1])}var c=s-i,u=o-n,d=Math.min(c,u),h=d/2,p=new IG(null,MG);if(d===0)return[i,n];for(var m=i;m<s;m+=d)for(var g=n;g<o;g+=d)p.push(new Cl(m+h,g+h,h,t));var y=RG(t),v=new Cl(i+c/2,n+u/2,0,t);v.d>y.d&&(y=v);for(var x=p.length;p.length;){var _=p.pop();_.d>y.d&&(y=_,r&&console.log("found best %d after %d probes",Math.round(1e4*_.d)/1e4,x)),!(_.max-y.d<=e)&&(h=_.h/2,p.push(new Cl(_.x-h,_.y-h,h,t)),p.push(new Cl(_.x+h,_.y-h,h,t)),p.push(new Cl(_.x-h,_.y+h,h,t)),p.push(new Cl(_.x+h,_.y+h,h,t)),x+=4)}return r&&(console.log("num probes: "+x),console.log("best distance: "+y.d)),[y.x,y.y]}function MG(t,e){return e.max-t.max}function Cl(t,e,r,i){this.x=t,this.y=e,this.h=r,this.d=PG(t,e,i),this.max=this.d+this.h*Math.SQRT2}function PG(t,e,r){for(var i=!1,n=1/0,s=0;s<r.length;s++)for(var o=r[s],a=0,l=o.length,c=l-1;a<l;c=a++){var u=o[a],d=o[c];u[1]>e!=d[1]>e&&t<(d[0]-u[0])*(e-u[1])/(d[1]-u[1])+u[0]&&(i=!i),n=Math.min(n,NG(t,e,u,d))}return(i?1:-1)*Math.sqrt(n)}function RG(t){for(var e=0,r=0,i=0,n=t[0],s=0,o=n.length,a=o-1;s<o;a=s++){var l=n[s],c=n[a],u=l[0]*c[1]-c[0]*l[1];r+=(l[0]+c[0])*u,i+=(l[1]+c[1])*u,e+=u*3}return e===0?new Cl(n[0][0],n[0][1],0,t):new Cl(r/e,i/e,0,t)}function NG(t,e,r,i){var n=r[0],s=r[1],o=i[0]-n,a=i[1]-s;if(o!==0||a!==0){var l=((t-n)*o+(e-s)*a)/(o*o+a*a);l>1?(n=i[0],s=i[1]):l>0&&(n+=o*l,s+=a*l)}return o=t-n,a=e-s,o*o+a*a}});var My=nt((hKe,jC)=>{jC.exports=q6;function q6(t,e){var r=t&&t.type,i;if(r==="FeatureCollection")for(i=0;i<t.features.length;i++)q6(t.features[i],e);else if(r==="GeometryCollection")for(i=0;i<t.geometries.length;i++)q6(t.geometries[i],e);else if(r==="Feature")q6(t.geometry,e);else if(r==="Polygon")HC(t.coordinates,e);else if(r==="MultiPolygon")for(i=0;i<t.coordinates.length;i++)HC(t.coordinates[i],e);return t}function HC(t,e){if(t.length!==0){$C(t[0],e);for(var r=1;r<t.length;r++)$C(t[r],!e)}}function $C(t,e){for(var r=0,i=0,n=0,s=t.length,o=s-1;n<s;o=n++){var a=(t[n][0]-t[o][0])*(t[o][1]+t[n][1]),l=r+a;i+=Math.abs(r)>=Math.abs(a)?r-l+a:a-l+r,r=l}r+i>=0!=!!e&&t.reverse()}});var Ny=nt((QKe,WC)=>{"use strict";WC.exports=function(t,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var r=typeof e.cycles=="boolean"?e.cycles:!1,i=e.cmp&&function(s){return function(o){return function(a,l){var c={key:a,value:o[a]},u={key:l,value:o[l]};return s(c,u)}}}(e.cmp),n=[];return function s(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var a,l;if(Array.isArray(o)){for(l="[",a=0;a<o.length;a++)a&&(l+=","),l+=s(o[a])||"null";return l+"]"}if(o===null)return"null";if(n.indexOf(o)!==-1){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var c=n.push(o)-1,u=Object.keys(o).sort(i&&i(o));for(l="",a=0;a<u.length;a++){var d=u[a],h=s(o[d]);h&&(l&&(l+=","),l+=JSON.stringify(d)+":"+h)}return n.splice(c,1),"{"+l+"}"}}(t)}});var lk=nt((dtt,i4)=>{i4.exports=gz;i4.exports.pair=vz;i4.exports.format=Oy;i4.exports.formatPair=yz;i4.exports.coordToDMS=ak;function gz(t,e){var r=Ly(t,e);return r===null?null:r.val}function yz(t){return Oy(t.lat,"lat")+" "+Oy(t.lon,"lon")}function Oy(t,e){var r=ak(t,e);return r.whole+"\xB0 "+(r.minutes?r.minutes+"' ":"")+(r.seconds?r.seconds+'" ':"")+r.dir}function ak(t,e){var r={lat:["N","S"],lon:["E","W"]}[e]||"",i=r[t>=0?0:1],n=Math.abs(t),s=Math.floor(n),o=n-s,a=o*60,l=Math.floor(a),c=Math.floor((a-l)*60);return{whole:s,minutes:l,seconds:c,dir:i}}function Ly(t,e){if(e||(e="NSEW"),typeof t!="string")return null;t=t.toUpperCase();var r=/^[\s\,]*([NSEW])?\s*([\-|\|\]?[0-9.]+)[]?\s*(?:([0-9.]+)[']\s*)?(?:([0-9.]+)(?:''|"||)\s*)?([NSEW])?/,i=t.match(r);if(!i)return null;var n=i[0],s;if(i[1]&&i[5]?(s=i[1],n=n.slice(0,-1)):s=i[1]||i[5],s&&e.indexOf(s)===-1)return null;var o=i[2]?parseFloat(i[2]):0,a=i[3]?parseFloat(i[3])/60:0,l=i[4]?parseFloat(i[4])/3600:0,c=o<0?-1:1;return(s==="S"||s==="W")&&(c*=-1),{val:(Math.abs(o)+a+l)*c,dim:s,matched:n,remain:t.slice(n.length)}}function vz(t,e){t=t.trim();var r=Ly(t,e);if(!r)return null;t=r.remain.trim();var i=Ly(t,e);return!i||i.remain?null:r.dim?xz(r.val,i.val,r.dim):[r.val,i.val]}function xz(t,e,r){if(r==="N"||r==="S")return[t,e];if(r==="W"||r==="E")return[e,t]}});var aI=nt((H0t,oI)=>{"use strict";oI.exports=a4;function a4(t,e){this.x=t,this.y=e}a4.prototype={clone:function(){return new a4(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),i=e*this.x-r*this.y,n=r*this.x+e*this.y;return this.x=i,this.y=n,this},_rotateAround:function(t,e){var r=Math.cos(t),i=Math.sin(t),n=e.x+r*(this.x-e.x)-i*(this.y-e.y),s=e.y+i*(this.x-e.x)+r*(this.y-e.y);return this.x=n,this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};a4.convert=function(t){return t instanceof a4?t:Array.isArray(t)?new a4(t[0],t[1]):t}});var Ky=nt(($0t,lI)=>{"use strict";var vH=aI();lI.exports=l4;function l4(t,e,r,i,n){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=n,t.readFields(xH,this,e)}function xH(t,e,r){t==1?e.id=r.readVarint():t==2?_H(r,e):t==3?e.type=r.readVarint():t==4&&(e._geometry=r.pos)}function _H(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var i=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[i]=n}}l4.types=["Unknown","Point","LineString","Polygon"];l4.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,i=0,n=0,s=0,o=[],a;t.pos<e;){if(i<=0){var l=t.readVarint();r=l&7,i=l>>3}if(i--,r===1||r===2)n+=t.readSVarint(),s+=t.readSVarint(),r===1&&(a&&o.push(a),a=[]),a.push(new vH(n,s));else if(r===7)a&&a.push(a[0].clone());else throw new Error("unknown command "+r)}return a&&o.push(a),o};l4.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,i=0,n=0,s=0,o=1/0,a=-1/0,l=1/0,c=-1/0;t.pos<e;){if(i<=0){var u=t.readVarint();r=u&7,i=u>>3}if(i--,r===1||r===2)n+=t.readSVarint(),s+=t.readSVarint(),n<o&&(o=n),n>a&&(a=n),s<l&&(l=s),s>c&&(c=s);else if(r!==7)throw new Error("unknown command "+r)}return[o,l,a,c]};l4.prototype.toGeoJSON=function(t,e,r){var i=this.extent*Math.pow(2,r),n=this.extent*t,s=this.extent*e,o=this.loadGeometry(),a=l4.types[this.type],l,c;function u(p){for(var m=0;m<p.length;m++){var g=p[m],y=180-(g.y+s)*360/i;p[m]=[(g.x+n)*360/i-180,360/Math.PI*Math.atan(Math.exp(y*Math.PI/180))-90]}}switch(this.type){case 1:var d=[];for(l=0;l<o.length;l++)d[l]=o[l][0];o=d,u(o);break;case 2:for(l=0;l<o.length;l++)u(o[l]);break;case 3:for(o=bH(o),l=0;l<o.length;l++)for(c=0;c<o[l].length;c++)u(o[l][c]);break}o.length===1?o=o[0]:a="Multi"+a;var h={type:"Feature",geometry:{type:a,coordinates:o},properties:this.properties};return"id"in this&&(h.id=this.id),h};function bH(t){var e=t.length;if(e<=1)return[t];for(var r=[],i,n,s=0;s<e;s++){var o=wH(t[s]);o!==0&&(n===void 0&&(n=o<0),n===o<0?(i&&r.push(i),i=[t[s]]):i.push(t[s]))}return i&&r.push(i),r}function wH(t){for(var e=0,r=0,i=t.length,n=i-1,s,o;r<i;n=r++)s=t[r],o=t[n],e+=(o.x-s.x)*(s.y+o.y);return e}});var Zy=nt((j0t,uI)=>{"use strict";var EH=Ky();uI.exports=cI;function cI(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(SH,this,e),this.length=this._features.length}function SH(t,e,r){t===15?e.version=r.readVarint():t===1?e.name=r.readString():t===5?e.extent=r.readVarint():t===2?e._features.push(r.pos):t===3?e._keys.push(r.readString()):t===4&&e._values.push(TH(r))}function TH(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var i=t.readVarint()>>3;e=i===1?t.readString():i===2?t.readFloat():i===3?t.readDouble():i===4?t.readVarint64():i===5?t.readVarint():i===6?t.readSVarint():i===7?t.readBoolean():null}return e}cI.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new EH(this._pbf,e,this.extent,this._keys,this._values)}});var dI=nt((V0t,fI)=>{"use strict";var AH=Zy();fI.exports=CH;function CH(t,e){this.layers=t.readFields(kH,{},e)}function kH(t,e,r){if(t===3){var i=new AH(r,r.readVarint()+r.pos);i.length&&(e[i.name]=i)}}});var Jy=nt((X0t,v9)=>{v9.exports.VectorTile=dI();v9.exports.VectorTileFeature=Ky();v9.exports.VectorTileLayer=Zy()});var hI=nt(ev=>{ev.read=function(t,e,r,i,n){var s,o,a=n*8-i-1,l=(1<<a)-1,c=l>>1,u=-7,d=r?n-1:0,h=r?-1:1,p=t[e+d];for(d+=h,s=p&(1<<-u)-1,p>>=-u,u+=a;u>0;s=s*256+t[e+d],d+=h,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=o*256+t[e+d],d+=h,u-=8);if(s===0)s=1-c;else{if(s===l)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-c}return(p?-1:1)*o*Math.pow(2,s-i)};ev.write=function(t,e,r,i,n,s){var o,a,l,c=s*8-n-1,u=(1<<c)-1,d=u>>1,h=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,m=i?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+d>=1?e+=h/l:e+=h*Math.pow(2,1-d),e*l>=2&&(o++,l/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*l-1)*Math.pow(2,n),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,n),o=0));n>=8;t[r+p]=a&255,p+=m,a/=256,n-=8);for(o=o<<n|a,c+=n;c>0;t[r+p]=o&255,p+=m,o/=256,c-=8);t[r+p-m]|=g*128}});var rv=nt((q0t,vI)=>{"use strict";vI.exports=Kt;var x9=hI();function Kt(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Kt.Varint=0;Kt.Fixed64=1;Kt.Bytes=2;Kt.Fixed32=5;var tv=(1<<16)*(1<<16),pI=1/tv,IH=12,yI=typeof TextDecoder>"u"?null:new TextDecoder("utf8");Kt.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),n=i>>3,s=this.pos;this.type=i&7,t(n,e,this),this.pos===s&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=_9(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=gI(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=_9(this.buf,this.pos)+_9(this.buf,this.pos+4)*tv;return this.pos+=8,t},readSFixed64:function(){var t=_9(this.buf,this.pos)+gI(this.buf,this.pos+4)*tv;return this.pos+=8,t},readFloat:function(){var t=x9.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=x9.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,r,i;return i=e[this.pos++],r=i&127,i<128||(i=e[this.pos++],r|=(i&127)<<7,i<128)||(i=e[this.pos++],r|=(i&127)<<14,i<128)||(i=e[this.pos++],r|=(i&127)<<21,i<128)?r:(i=e[this.pos],r|=(i&15)<<28,MH(r,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=IH&&yI?jH(this.buf,e,t):$H(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Kt.Bytes)return t.push(this.readVarint(e));var r=Ma(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Kt.Bytes)return t.push(this.readSVarint());var e=Ma(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Kt.Bytes)return t.push(this.readBoolean());var e=Ma(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Kt.Bytes)return t.push(this.readFloat());var e=Ma(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Kt.Bytes)return t.push(this.readDouble());var e=Ma(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Kt.Bytes)return t.push(this.readFixed32());var e=Ma(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Kt.Bytes)return t.push(this.readSFixed32());var e=Ma(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Kt.Bytes)return t.push(this.readFixed64());var e=Ma(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Kt.Bytes)return t.push(this.readSFixed64());var e=Ma(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===Kt.Varint)for(;this.buf[this.pos++]>127;);else if(e===Kt.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Kt.Fixed32)this.pos+=4;else if(e===Kt.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),u4(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),u4(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),u4(this.buf,t&-1,this.pos),u4(this.buf,Math.floor(t*pI),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),u4(this.buf,t&-1,this.pos),u4(this.buf,Math.floor(t*pI),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){PH(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=VH(this.buf,t,this.pos);var r=this.pos-e;r>=128&&mI(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),x9.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),x9.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var i=this.pos-r;i>=128&&mI(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,r){this.writeTag(t,Kt.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,DH,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,FH,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,BH,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,OH,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,LH,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,UH,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,GH,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,zH,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,HH,e)},writeBytesField:function(t,e){this.writeTag(t,Kt.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Kt.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Kt.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Kt.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Kt.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Kt.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Kt.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Kt.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Kt.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Kt.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};function MH(t,e,r){var i=r.buf,n,s;if(s=i[r.pos++],n=(s&112)>>4,s<128||(s=i[r.pos++],n|=(s&127)<<3,s<128)||(s=i[r.pos++],n|=(s&127)<<10,s<128)||(s=i[r.pos++],n|=(s&127)<<17,s<128)||(s=i[r.pos++],n|=(s&127)<<24,s<128)||(s=i[r.pos++],n|=(s&1)<<31,s<128))return c4(t,n,e);throw new Error("Expected varint not more than 10 bytes")}function Ma(t){return t.type===Kt.Bytes?t.readVarint()+t.pos:t.pos+1}function c4(t,e,r){return r?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function PH(t,e){var r,i;if(t>=0?(r=t%4294967296|0,i=t/4294967296|0):(r=~(-t%4294967296),i=~(-t/4294967296),r^4294967295?r=r+1|0:(r=0,i=i+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),RH(r,i,e),NH(i,e)}function RH(t,e,r){r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos]=t&127}function NH(t,e){var r=(t&7)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127)))))}function mI(t,e,r){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));r.realloc(i);for(var n=r.pos-1;n>=t;n--)r.buf[n+i]=r.buf[n]}function DH(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function FH(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function OH(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function LH(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function BH(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function UH(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function GH(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function zH(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function HH(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function _9(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function u4(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function gI(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function $H(t,e,r){for(var i="",n=e;n<r;){var s=t[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a>r)break;var l,c,u;a===1?s<128&&(o=s):a===2?(l=t[n+1],(l&192)===128&&(o=(s&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=t[n+1],c=t[n+2],(l&192)===128&&(c&192)===128&&(o=(s&15)<<12|(l&63)<<6|c&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=t[n+1],c=t[n+2],u=t[n+3],(l&192)===128&&(c&192)===128&&(u&192)===128&&(o=(s&15)<<18|(l&63)<<12|(c&63)<<6|u&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,i+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),i+=String.fromCharCode(o),n+=a}return i}function jH(t,e,r){return yI.decode(t.subarray(e,r))}function VH(t,e,r){for(var i=0,n,s;i<e.length;i++){if(n=e.charCodeAt(i),n>55295&&n<57344)if(s)if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,s=n;continue}else n=s-55296<<10|n-56320|65536,s=null;else{n>56319||i+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):s=n;continue}else s&&(t[r++]=239,t[r++]=191,t[r++]=189,s=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=n&63|128)}return r}});var K1=nt((Lut,OI)=>{var yv=E$(),_$=S$(),b$=T$(),w$=typeof window<"u"?window:global;OI.exports={assign:yv,create:_$,trim:b$,bind:A$,slice:vv,each:FI,map:C$,pluck:xv,isList:_v,isFunction:k$,isObject:I$,Global:w$};function E$(){return Object.assign?Object.assign:function(e,r,i,n){for(var s=1;s<arguments.length;s++)FI(Object(arguments[s]),function(o,a){e[a]=o});return e}}function S$(){if(Object.create)return function(r,i,n,s){var o=vv(arguments,1);return yv.apply(this,[Object.create(r)].concat(o))};{let e=function(){};var t=e;return function(i,n,s,o){var a=vv(arguments,1);return e.prototype=i,yv.apply(this,[new e].concat(a))}}}function T$(){return String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}function A$(t,e){return function(){return e.apply(t,Array.prototype.slice.call(arguments,0))}}function vv(t,e){return Array.prototype.slice.call(t,e||0)}function FI(t,e){xv(t,function(r,i){return e(r,i),!1})}function C$(t,e){var r=_v(t)?[]:{};return xv(t,function(i,n){return r[n]=e(i,n),!1}),r}function xv(t,e){if(_v(t)){for(var r=0;r<t.length;r++)if(e(t[r],r))return t[r]}else for(var i in t)if(t.hasOwnProperty(i)&&e(t[i],i))return t[i]}function _v(t){return t!=null&&typeof t!="function"&&typeof t.length=="number"}function k$(t){return t&&{}.toString.call(t)==="[object Function]"}function I$(t){return t&&{}.toString.call(t)==="[object Object]"}});var BI=nt((But,LI)=>{var Nl=K1(),M$=Nl.slice,P$=Nl.pluck,d4=Nl.each,R$=Nl.bind,N$=Nl.create,bv=Nl.isList,wv=Nl.isFunction,D$=Nl.isObject;LI.exports={createStore:Ev};var F$={version:"2.0.12",enabled:!1,get:function(t,e){var r=this.storage.read(this._namespacePrefix+t);return this._deserialize(r,e)},set:function(t,e){return e===void 0?this.remove(t):(this.storage.write(this._namespacePrefix+t,this._serialize(e)),e)},remove:function(t){this.storage.remove(this._namespacePrefix+t)},each:function(t){var e=this;this.storage.each(function(r,i){t.call(e,e._deserialize(r),(i||"").replace(e._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(t){return this._namespacePrefix=="__storejs_"+t+"_"},createStore:function(){return Ev.apply(this,arguments)},addPlugin:function(t){this._addPlugin(t)},namespace:function(t){return Ev(this.storage,this.plugins,t)}};function O$(){var t=typeof console>"u"?null:console;if(t){var e=t.warn?t.warn:t.log;e.apply(t,arguments)}}function Ev(t,e,r){r||(r=""),t&&!bv(t)&&(t=[t]),e&&!bv(e)&&(e=[e]);var i=r?"__storejs_"+r+"_":"",n=r?new RegExp("^"+i):null,s=/^[a-zA-Z0-9_\-]*$/;if(!s.test(r))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var o={_namespacePrefix:i,_namespaceRegexp:n,_testStorage:function(l){try{var c="__storejs__test__";l.write(c,c);var u=l.read(c)===c;return l.remove(c),u}catch{return!1}},_assignPluginFnProp:function(l,c){var u=this[c];this[c]=function(){var h=M$(arguments,0),p=this;function m(){if(u)return d4(arguments,function(y,v){h[v]=y}),u.apply(p,h)}var g=[m].concat(h);return l.apply(p,g)}},_serialize:function(l){return JSON.stringify(l)},_deserialize:function(l,c){if(!l)return c;var u="";try{u=JSON.parse(l)}catch{u=l}return u!==void 0?u:c},_addStorage:function(l){this.enabled||this._testStorage(l)&&(this.storage=l,this.enabled=!0)},_addPlugin:function(l){var c=this;if(bv(l)){d4(l,function(h){c._addPlugin(h)});return}var u=P$(this.plugins,function(h){return l===h});if(!u){if(this.plugins.push(l),!wv(l))throw new Error("Plugins must be function values that return objects");var d=l.call(this);if(!D$(d))throw new Error("Plugins must return an object of function properties");d4(d,function(h,p){if(!wv(h))throw new Error("Bad plugin property: "+p+" from plugin "+l.name+". Plugins should only return functions.");c._assignPluginFnProp(h,p)})}},addStorage:function(l){O$("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(l)}},a=N$(o,F$,{plugins:[]});return a.raw={},d4(a,function(l,c){wv(l)&&(a.raw[c]=R$(a,l))}),d4(t,function(l){a._addStorage(l)}),d4(e,function(l){a._addPlugin(l)}),a}});var zI=nt((Uut,GI)=>{var L$=K1(),B$=L$.Global;GI.exports={name:"localStorage",read:UI,write:U$,each:G$,remove:z$,clearAll:H$};function h4(){return B$.localStorage}function UI(t){return h4().getItem(t)}function U$(t,e){return h4().setItem(t,e)}function G$(t){for(var e=h4().length-1;e>=0;e--){var r=h4().key(e);t(UI(r),r)}}function z$(t){return h4().removeItem(t)}function H$(){return h4().clear()}});var jI=nt((Gut,$I)=>{var $$=K1(),j$=$$.Global;$I.exports={name:"oldFF-globalStorage",read:V$,write:X$,each:HI,remove:W$,clearAll:q$};var Z1=j$.globalStorage;function V$(t){return Z1[t]}function X$(t,e){Z1[t]=e}function HI(t){for(var e=Z1.length-1;e>=0;e--){var r=Z1.key(e);t(Z1[r],r)}}function W$(t){return Z1.removeItem(t)}function q$(){HI(function(t,e){delete Z1[t]})}});var WI=nt((zut,XI)=>{var Y$=K1(),Sv=Y$.Global;XI.exports={name:"oldIE-userDataStorage",write:Q$,read:K$,each:Z$,remove:J$,clearAll:ej};var T5="storejs",S5=Sv.document,A5=rj(),VI=(Sv.navigator?Sv.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);function Q$(t,e){if(!VI){var r=Tv(t);A5(function(i){i.setAttribute(r,e),i.save(T5)})}}function K$(t){if(!VI){var e=Tv(t),r=null;return A5(function(i){r=i.getAttribute(e)}),r}}function Z$(t){A5(function(e){for(var r=e.XMLDocument.documentElement.attributes,i=r.length-1;i>=0;i--){var n=r[i];t(e.getAttribute(n.name),n.name)}})}function J$(t){var e=Tv(t);A5(function(r){r.removeAttribute(e),r.save(T5)})}function ej(){A5(function(t){var e=t.XMLDocument.documentElement.attributes;t.load(T5);for(var r=e.length-1;r>=0;r--)t.removeAttribute(e[r].name);t.save(T5)})}var tj=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function Tv(t){return t.replace(/^\d/,"___$&").replace(tj,"___")}function rj(){if(!S5||!S5.documentElement||!S5.documentElement.addBehavior)return null;var t="script",e,r,i;try{r=new ActiveXObject("htmlfile"),r.open(),r.write("<"+t+">document.w=window</"+t+'><iframe src="/favicon.ico"></iframe>'),r.close(),e=r.w.frames[0].document,i=e.createElement("div")}catch{i=S5.createElement("div"),e=S5.body}return function(n){var s=[].slice.call(arguments,0);s.unshift(i),e.appendChild(i),i.addBehavior("#default#userData"),i.load(T5),n.apply(this,s),e.removeChild(i)}}});var JI=nt((Hut,ZI)=>{var qI=K1(),ij=qI.Global,nj=qI.trim;ZI.exports={name:"cookieStorage",read:sj,write:oj,each:YI,remove:QI,clearAll:aj};var C5=ij.document;function sj(t){if(!t||!KI(t))return null;var e="(?:^|.*;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(C5.cookie.replace(new RegExp(e),"$1"))}function YI(t){for(var e=C5.cookie.split(/; ?/g),r=e.length-1;r>=0;r--)if(nj(e[r])){var i=e[r].split("="),n=unescape(i[0]),s=unescape(i[1]);t(s,n)}}function oj(t,e){t&&(C5.cookie=escape(t)+"="+escape(e)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")}function QI(t){!t||!KI(t)||(C5.cookie=escape(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function aj(){YI(function(t,e){QI(e)})}function KI(t){return new RegExp("(?:^|;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(C5.cookie)}});var rM=nt(($ut,tM)=>{var lj=K1(),cj=lj.Global;tM.exports={name:"sessionStorage",read:eM,write:uj,each:fj,remove:dj,clearAll:hj};function p4(){return cj.sessionStorage}function eM(t){return p4().getItem(t)}function uj(t,e){return p4().setItem(t,e)}function fj(t){for(var e=p4().length-1;e>=0;e--){var r=p4().key(e);t(eM(r),r)}}function dj(t){return p4().removeItem(t)}function hj(){return p4().clear()}});var nM=nt((jut,iM)=>{iM.exports={name:"memoryStorage",read:pj,write:mj,each:gj,remove:yj,clearAll:vj};var J1={};function pj(t){return J1[t]}function mj(t,e){J1[t]=e}function gj(t){for(var e in J1)J1.hasOwnProperty(e)&&t(J1[e],e)}function yj(t){delete J1[t]}function vj(t){J1={}}});var oM=nt((Vut,sM)=>{sM.exports=[zI(),jI(),WI(),JI(),rM(),nM()]});var aM=nt((exports,module)=>{typeof JSON!="object"&&(JSON={});(function(){"use strict";var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;function f(t){return t<10?"0"+t:t}function this_value(){return this.valueOf()}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;function quote(t){return rx_escapable.lastIndex=0,rx_escapable.test(t)?'"'+t.replace(rx_escapable,function(e){var r=meta[e];return typeof r=="string"?r:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var r,i,n,s,o=gap,a,l=e[t];switch(l&&typeof l=="object"&&typeof l.toJSON=="function"&&(l=l.toJSON(t)),typeof rep=="function"&&(l=rep.call(e,t,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,a=[],Object.prototype.toString.apply(l)==="[object Array]"){for(s=l.length,r=0;r<s;r+=1)a[r]=str(r,l)||"null";return n=a.length===0?"[]":gap?`[
`+gap+a.join(`,
`+gap)+`
`+o+"]":"["+a.join(",")+"]",gap=o,n}if(rep&&typeof rep=="object")for(s=rep.length,r=0;r<s;r+=1)typeof rep[r]=="string"&&(i=rep[r],n=str(i,l),n&&a.push(quote(i)+(gap?": ":":")+n));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(n=str(i,l),n&&a.push(quote(i)+(gap?": ":":")+n));return n=a.length===0?"{}":gap?`{
`+gap+a.join(`,
`+gap)+`
`+o+"}":"{"+a.join(",")+"}",gap=o,n}}typeof JSON.stringify!="function"&&(meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,r){var i;if(gap="",indent="",typeof r=="number")for(i=0;i<r;i+=1)indent+=" ";else typeof r=="string"&&(indent=r);if(rep=e,e&&typeof e!="function"&&(typeof e!="object"||typeof e.length!="number"))throw new Error("JSON.stringify");return str("",{"":t})}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){var j;function walk(t,e){var r,i,n=t[e];if(n&&typeof n=="object")for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i=walk(n,r),i!==void 0?n[r]=i:delete n[r]);return reviver.call(t,e,n)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})})()});var cM=nt((Xut,lM)=>{lM.exports=xj;function xj(){return aM(),{}}});var fM=nt((Wut,uM)=>{var _j=BI(),bj=oM(),wj=[cM()];uM.exports=_j.createStore(bj,wj)});var $9={};F5($9,{BehaviorDrag:()=>l0,BehaviorDraw:()=>c0,BehaviorHover:()=>u0,BehaviorKeyOperation:()=>Ft,BehaviorLasso:()=>f0,BehaviorMapInteraction:()=>d0,BehaviorPaste:()=>h0,BehaviorSelect:()=>p0,Difference:()=>Gn,Graph:()=>Dr,LocationManager:()=>M2,ModeAddNote:()=>m0,ModeAddPoint:()=>g0,ModeBrowse:()=>y0,ModeDragNode:()=>v0,ModeDrawArea:()=>x0,ModeDrawLine:()=>_0,ModeMove:()=>b0,ModeRotate:()=>w0,ModeSave:()=>k0,ModeSelect:()=>mu,QAItem:()=>Rt,RendererImagery:()=>vu,RendererImagerySource:()=>Es,RendererMap:()=>e4,RendererPhotos:()=>t4,Tree:()=>zn,UiPanelBackground:()=>d5,UiPanelHistory:()=>h5,UiPanelLocation:()=>m5,UiPanelMeasurement:()=>g5,actionAddEntity:()=>Wt,actionAddMember:()=>Ql,actionAddMidpoint:()=>Xr,actionAddVertex:()=>Ui,actionChangeMember:()=>Ja,actionChangePreset:()=>Hn,actionChangeTags:()=>er,actionCircularize:()=>Id,actionConnect:()=>n1,actionCopyEntities:()=>s0,actionDeleteMember:()=>el,actionDeleteMultiple:()=>ea,actionDeleteNode:()=>po,actionDeleteRelation:()=>Qr,actionDeleteWay:()=>ps,actionDiscardTags:()=>ia,actionDisconnect:()=>L2,actionExtract:()=>n0,actionJoin:()=>Md,actionMerge:()=>Pd,actionMergeNodes:()=>$n,actionMergePolygon:()=>Rd,actionMergeRemoteChanges:()=>a0,actionMove:()=>Za,actionMoveMember:()=>E7,actionMoveNode:()=>mo,actionNoop:()=>hr,actionOrthogonalize:()=>Ka,actionRapidAcceptFeature:()=>Qh,actionReflect:()=>Nd,actionRestrictTurn:()=>VM,actionReverse:()=>os,actionRevert:()=>G2,actionRotate:()=>Hd,actionScale:()=>XM,actionSplit:()=>ta,actionStraightenNodes:()=>Dd,actionStraightenWay:()=>Fd,actionUnrestrictTurn:()=>WM,actionUpgradeTags:()=>Od,coreContext:()=>Nk,coreFileFetcher:()=>z8,coreHistory:()=>Cd,coreLocalizer:()=>Pp,coreRapidContext:()=>Ad,coreUploader:()=>Ud,coreValidator:()=>Bd,d3:()=>hV,fileFetcher:()=>Qe,geoChooseEdge:()=>Fr,geoHasLineIntersections:()=>pS,geoHasSelfIntersections:()=>r1,geoOrthoCalcScore:()=>kd,geoOrthoCanOrthogonalize:()=>i0,geoOrthoMaxOffsetAngle:()=>gS,geoOrthoNormalizedDotProduct:()=>i1,localizer:()=>se,locationManager:()=>wt,modeDragNote:()=>pA,modeSelect:()=>Se,operationCircularize:()=>Xp,operationContinue:()=>Wp,operationCopy:()=>O2,operationCycleHighwayTag:()=>qp,operationDelete:()=>on,operationDisconnect:()=>Yp,operationDowngrade:()=>B2,operationExtract:()=>Qp,operationMerge:()=>Kp,operationMove:()=>Zp,operationOrthogonalize:()=>Jp,operationPaste:()=>U2,operationReflectLong:()=>tm,operationReflectShort:()=>em,operationReverse:()=>rm,operationRotate:()=>im,operationSplit:()=>nm,operationStraighten:()=>sm,osmAreaKeys:()=>Uo,osmChangeset:()=>nn,osmEntity:()=>Te,osmFlowingWaterwayTagValues:()=>dc,osmInferRestriction:()=>BE,osmIntersection:()=>LE,osmIsInterestingTag:()=>$i,osmIsOldMultipolygonOuterMember:()=>Zc,osmJoinWays:()=>En,osmLanes:()=>Wf,osmLifecyclePrefixes:()=>Oa,osmNode:()=>je,osmNodeGeometriesForTags:()=>Ba,osmNote:()=>Jt,osmOldMultipolygonOuterMember:()=>UE,osmOldMultipolygonOuterMemberOfRelation:()=>Jc,osmOneWayTags:()=>Ms,osmPavedTags:()=>Bl,osmPointTags:()=>uc,osmRailwayTrackTagValues:()=>W5,osmRelation:()=>Cr,osmRemoveLifecyclePrefix:()=>A4,osmRoutableHighwayTagValues:()=>as,osmSetAreaKeys:()=>j5,osmSetPointTags:()=>V5,osmSetVertexTags:()=>X5,osmTagSuggestingArea:()=>La,osmTurn:()=>P2,osmVertexTags:()=>fc,osmWay:()=>Lt,prefs:()=>ee,presetCategory:()=>Rp,presetCollection:()=>Ii,presetField:()=>Np,presetIndex:()=>jM,presetManager:()=>xe,presetPreset:()=>Yl,rendererFeatures:()=>a7,sdk:()=>pV,serviceEsriData:()=>Hy,serviceFbAIFeatures:()=>$y,serviceImproveOSM:()=>qy,serviceKartaview:()=>gv,serviceKeepRight:()=>Xy,serviceMapRules:()=>uv,serviceMapillary:()=>cv,serviceNominatim:()=>dv,serviceNsi:()=>mv,serviceOsm:()=>s4,serviceOsmWikibase:()=>Dv,serviceOsmose:()=>Qy,serviceStreetside:()=>Fv,serviceTaginfo:()=>Bv,serviceVectorTile:()=>Hv,serviceWikidata:()=>Vv,serviceWikipedia:()=>Wv,services:()=>K,svgDefs:()=>l7,svgIcon:()=>Z,svgTagClasses:()=>qM,t:()=>S,uiAccount:()=>c7,uiAttribution:()=>u7,uiChangesetEditor:()=>Xd,uiCmd:()=>et,uiCombobox:()=>At,uiCommit:()=>Yd,uiCommitWarnings:()=>qd,uiConfirm:()=>tl,uiConflicts:()=>$d,uiContributors:()=>f7,uiDataEditor:()=>I0,uiDataHeader:()=>Kd,uiDisclosure:()=>s1,uiEditMenu:()=>d7,uiEntityEditor:()=>C7,uiFeatureInfo:()=>KC,uiFeatureList:()=>x7,uiField:()=>vs,uiFieldAccess:()=>qv,uiFieldAddress:()=>Yv,uiFieldCheck:()=>Kl,uiFieldCombo:()=>is,uiFieldCycleway:()=>Qv,uiFieldDefaultCheck:()=>Kl,uiFieldEmail:()=>Nn,uiFieldIdentifier:()=>Nn,uiFieldLanes:()=>G9,uiFieldLocalized:()=>Kv,uiFieldManyCombo:()=>is,uiFieldMultiCombo:()=>is,uiFieldNetworkCombo:()=>is,uiFieldNumber:()=>Nn,uiFieldOnewayCheck:()=>Kl,uiFieldRadio:()=>N5,uiFieldRoadspeed:()=>Zv,uiFieldSemiCombo:()=>is,uiFieldStructureRadio:()=>N5,uiFieldTel:()=>Nn,uiFieldText:()=>Nn,uiFieldTextarea:()=>Jv,uiFieldTypeCombo:()=>is,uiFieldUrl:()=>Nn,uiFieldWikidata:()=>ex,uiFieldWikipedia:()=>z9,uiFields:()=>S0,uiFlash:()=>gu,uiFormFields:()=>T0,uiFullScreen:()=>h7,uiGeolocate:()=>p7,uiImproveOsmComments:()=>Zd,uiImproveOsmDetails:()=>Jd,uiImproveOsmEditor:()=>fu,uiImproveOsmHeader:()=>Bh,uiInfo:()=>m7,uiInit:()=>h9,uiInspector:()=>I7,uiIntro:()=>Qs,uiIssuesInfo:()=>g7,uiKeepRightDetails:()=>Uh,uiKeepRightEditor:()=>du,uiKeepRightHeader:()=>Gh,uiLoading:()=>ra,uiMapInMap:()=>V1,uiModal:()=>Er,uiNoteComments:()=>Hh,uiNoteEditor:()=>pu,uiNoteHeader:()=>$h,uiNoteReport:()=>jh,uiPaneBackground:()=>Q7,uiPaneHelp:()=>K7,uiPaneIssues:()=>t9,uiPaneMapData:()=>a9,uiPanePreferences:()=>u9,uiPopover:()=>jd,uiPresetIcon:()=>X1,uiPresetList:()=>k7,uiRapidColorpicker:()=>U7,uiRapidFeatureInspector:()=>yu,uiRapidFeatureToggleDialog:()=>z7,uiRapidFirstEditDialog:()=>Yh,uiRapidPowerUserFeaturesDialog:()=>H7,uiRapidServiceLicense:()=>f9,uiRapidSplash:()=>qh,uiRapidViewManageDatasets:()=>G7,uiRapidWhatsNew:()=>d9,uiRestore:()=>y7,uiScale:()=>v7,uiSectionBackgroundDisplayOptions:()=>V7,uiSectionBackgroundList:()=>W7,uiSectionBackgroundOffset:()=>q7,uiSectionChanges:()=>Wd,uiSectionDataLayers:()=>i9,uiSectionEntityIssues:()=>_7,uiSectionFeatureType:()=>b7,uiSectionMapFeatures:()=>n9,uiSectionMapInteractionOptions:()=>c9,uiSectionMapStyleOptions:()=>s9,uiSectionOverlayList:()=>Y7,uiSectionPhotoOverlays:()=>o9,uiSectionPresetFields:()=>w7,uiSectionPrivacy:()=>l9,uiSectionRawMemberEditor:()=>S7,uiSectionRawMembershipEditor:()=>T7,uiSectionRawTagEditor:()=>rl,uiSectionSelectionList:()=>A7,uiSectionValidationIssues:()=>_5,uiSectionValidationOptions:()=>Z7,uiSectionValidationRules:()=>J7,uiSectionValidationStatus:()=>e9,uiSettingsCustomBackground:()=>X7,uiSettingsCustomData:()=>r9,uiSidebar:()=>M7,uiSourceSwitch:()=>P7,uiSpinner:()=>R7,uiSplash:()=>YM,uiStatus:()=>N7,uiSuccess:()=>Qd,uiTagReference:()=>yo,uiToggle:()=>A0,uiTooltip:()=>Ae,uiVersion:()=>$7,uiViewOnKeepRight:()=>zh,uiViewOnOSM:()=>hu,uiZoom:()=>j7,utilDetect:()=>Rr,utilDisplayLabel:()=>ft,utilDisplayName:()=>qt,utilDisplayPOIName:()=>Q6,utilDisplayType:()=>gs,utilFastMouse:()=>y5,utilFunctor:()=>tr,utilGetSetValue:()=>De,utilHighlightEntities:()=>ct,utilKeybinding:()=>rt,utilNoAuto:()=>qe,utilRebind:()=>ge,utilSetTransform:()=>As,utilTotalExtent:()=>vt,utilTriggerEvent:()=>E0,utilWrap:()=>Kc,validationAlmostJunction:()=>am,validationCloseNodes:()=>lm,validationCrossingWays:()=>cm,validationDisconnectedWay:()=>um,validationDuplicateWaySegments:()=>fm,validationFormatting:()=>dm,validationHelpRequest:()=>hm,validationImpossibleOneway:()=>pm,validationIncompatibleSource:()=>mm,validationMaprules:()=>gm,validationMismatchedGeometry:()=>ym,validationMissingRole:()=>vm,validationMissingTag:()=>xm,validationOutdatedTags:()=>_m,validationPrivateData:()=>bm,validationSuspiciousName:()=>Em,validationUnsquareWay:()=>Sm,validationYShapedConnection:()=>wm});function Wt(t){return function(e){return e.replace(t)}}var G5=dt(sx(),1),q9=dt(U5(),1),sP=[250,157,60,79,142,134,229,129,138,126,210,129,29,71,160,208];function ox(t,e){e=e||sP;let r=G5.default.utils.hex.toBytes(t),n=new G5.default.ModeOfOperation.ctr(e).decrypt(r);return G5.default.utils.utf8.fromBytes(n)}function ni(t,e){if(t===e)return!0;let r=t.length;if(r!==e.length)return!1;for(;r--;)if(t[r]!==e[r])return!1;return!0}function si(t,e){let r=new Set(e);return Array.from(new Set(t)).filter(i=>!r.has(i))}function Ir(t,e){let r=new Set(e);return Array.from(new Set(t)).filter(i=>r.has(i))}function jt(t,e){let r=new Set(t);return e.forEach(i=>r.add(i)),Array.from(r)}function $e(t){return Array.from(new Set(t))}function S4(t,e){if(!e||e<0)return[t.slice()];let r=new Array(Math.ceil(t.length/e));return Array.from(r,(i,n)=>t.slice(n*e,n*e+e))}function Y9(t){return t.reduce((e,r)=>e.concat(r),[])}function yr(t,e){return t.reduce((r,i)=>{let n=typeof e=="function"?e(i):i[e];return(r[n]=r[n]||[]).push(i),r},{})}function ac(t,e){let r=new Set;return t.reduce((i,n)=>{let s=typeof e=="function"?e(n):n[e];return s&&!r.has(s)&&(r.add(s),i.push(n)),i},[])}function Fi(t,e){return Object.keys(t).reduce((r,i)=>(e.indexOf(i)===-1&&(r[i]=t[i]),r),{})}function Q9(t){let e={};for(let i in t){if(!i)continue;let n=t[i];n!==void 0&&(e[i]=r(i,n))}return e;function r(i,n){function s(l){return/_hours|_times|:conditional$/.test(l)}function o(l){return/^(description|note|fixme)$/.test(l)}if(o(i))return n;let a=n.split(";").map(l=>l.trim()).join(s(i)?"; ":";");return(i.indexOf("website")!==-1||i.indexOf("email")!==-1||a.indexOf("http")===0)&&(a=a.replace(/[\u200B-\u200F\uFEFF]/g,"")),a}}function ax(t,e,r){let i=new Set(t),n=new Set,s=new Set;return t.forEach(o),lc(Array.from(s));function o(a){if(n.has(a))return;n.add(a),i.has(a)||s.add(a);let l=e.hasEntity(a);!l||l.type!=="relation"||r&&l.isMultipolygon()||(l.members||[]).forEach(c=>o(c.id))}}function K9(t,e){let r=new Set;return t.forEach(i),Array.from(r);function i(n){if(r.has(n))return;r.add(n);let s=e.hasEntity(n);!s||s.type!=="relation"||(s.members||[]).forEach(o=>i(o.id))}}function Ol(t,e){let r=new Set(t);return t.forEach(i),lc(Array.from(r));function i(n){var s=e.hasEntity(n);!s||s.type!=="relation"||(s.members||[]).forEach(o=>r.add(o.id))}}function z5(t,e){return lc(K9(t,e))}function lc(t){return t.length?"."+t.join(",."):"nothing"}function dr(t,e){let r=new Set,i=new Set;return t.forEach(n),Array.from(i);function n(s){if(r.has(s))return;r.add(s);let o=e.hasEntity(s);o&&(o.type==="node"?i.add(o):o.type==="way"?(o.nodes||[]).forEach(n):(o.members||[]).forEach(a=>n(a.id)))}}function cc(t,e){let r=[];return jt(Object.keys(t),Object.keys(e)).sort().forEach(n=>{let s=t[n],o=e[n];(s||s==="")&&(o===void 0||o!==s)&&r.push({type:"-",key:n,oldVal:s,newVal:o,display:`- ${n}=${s}`}),(o||o==="")&&(s===void 0||o!==s)&&r.push({type:"+",key:n,oldVal:s,newVal:o,display:`+ ${n}=${o}`})}),r}function lx(t){let e=t&&t.tags||{};return Object.keys(e).map(r=>`${r}=${e[r]}`).join(", ")}function cx(t){let e;function r(){let n=new Date;n.setSeconds(n.getSeconds()+5),document.cookie=t+"=1; expires="+n.toUTCString()+"; sameSite=strict"}return{lock:()=>e?!0:document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+t+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")?!1:(r(),e=window.setInterval(r,4e3),!0),unlock:()=>{e&&(document.cookie=t+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; sameSite=strict",clearInterval(e),e=null)},locked:()=>!!e}}function H5(t,e){if(t=(0,q9.remove)(t.toLowerCase()),e=(0,q9.remove)(e.toLowerCase()),t.length===0)return e.length;if(e.length===0)return t.length;let r=[];for(let i=0;i<=e.length;i++)r[i]=[i];for(let i=0;i<=t.length;i++)r[0][i]=i;for(let i=1;i<=e.length;i++)for(let n=1;n<=t.length;n++)e.charAt(i-1)===t.charAt(n-1)?r[i][n]=r[i-1][n-1]:r[i][n]=Math.min(r[i-1][n-1]+1,Math.min(r[i][n-1]+1,r[i-1][n]+1));return r[e.length][t.length]}function Ll(t){let e=0;if(t.length===0)return e;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);e=(e<<5)-e+i,e=e&e}return e}function xt(t,e){function r(i){return encodeURIComponent(i).replace(/(%2F|%3A|%2C|%7B|%7D)/g,decodeURIComponent)}return Object.keys(t).sort().map(i=>encodeURIComponent(i)+"="+(e?r(t[i]):encodeURIComponent(t[i]))).join("&")}function Fn(t){let e=0;for(;e<t.length&&(t[e]==="?"||t[e]==="#");)e++;return t=t.slice(e),t.split("&").reduce((r,i)=>{let n=i.split("=");return n.length===2&&(r[n[0]]=decodeURIComponent(n[1])),r},{})}function Z9(t){return Array.from(t).length}function $5(t,e){return Array.from(t).slice(0,e).join("")}function T4(t){return t.toLowerCase().replace(/[^a-z0-9]+/g,"_")}function ss(t){return"rapideditor-"+T4(t.toString())+"-"+new Date().getTime().toString()}function os(t,e){var r=/^.*(_|:)?(description|name|note|website|ref|source|comment|watch|attribution)(_|:)?/,i=/^([+\-]?)(?=[\d.])/,n=/direction$/,s=/^turn:lanes:?/,o=[[/:right$/,":left"],[/:left$/,":right"],[/:forward$/,":backward"],[/:backward$/,":forward"],[/:right:/,":left:"],[/:left:/,":right:"],[/:forward:/,":backward:"],[/:backward:/,":forward:"]],a={left:"right",right:"left",up:"down",down:"up",forward:"backward",backward:"forward",forwards:"backward",backwards:"forward"},l={forward:"backward",backward:"forward",forwards:"backward",backwards:"forward"},c={yes:"-1",1:"-1","-1":"yes"},u={N:"S",NNE:"SSW",NE:"SW",ENE:"WSW",E:"W",ESE:"WNW",SE:"NW",SSE:"NNW",S:"N",SSW:"NNE",SW:"NE",WSW:"ENE",W:"E",WNW:"ESE",NW:"SE",NNW:"SSE"};function d(y){for(var v=0;v<o.length;++v){var x=o[v];if(x[0].test(y))return y.replace(x[0],x[1])}return y}function h(y,v,x){if(r.test(y)||s.test(y))return v;if(y==="incline"&&i.test(v))return v.replace(i,function(b,w){return w==="-"?"":"-"});if(e&&e.reverseOneway&&y==="oneway")return c[v]||v;if(x&&n.test(y)){if(u[v])return u[v];var _=parseFloat(v);if(typeof _=="number"&&!isNaN(_))return _<180?_+=180:_-=180,_.toString()}return a[v]||v}function p(y,v){for(var x=0;x<v.length;x++){var _=y.hasEntity(v[x]);if(!(!_||!Object.keys(_.tags).length)){var b={};for(var w in _.tags)b[d(w)]=h(w,_.tags[w],_.id===t);y=y.replace(_.update({tags:b}))}}return y}function m(y,v){var x=v.nodes.slice().reverse(),_={},b;for(var w in v.tags)_[d(w)]=h(w,v.tags[w]);return y.parentRelations(v).forEach(function(E){E.members.forEach(function(A,T){A.id===v.id&&(b=l[A.role])&&(E=E.updateMember({role:b},T),y=y.replace(E))})}),p(y,x).replace(v.update({nodes:x,tags:_}))}var g=function(y){var v=y.entity(t);return v.type==="way"?m(y,v):p(y,[t])};return g.disabled=function(y){var v=y.hasEntity(t);if(!v||v.type==="way")return!1;for(var x in v.tags){var _=v.tags[x];if(d(x)!==x||h(x,_,!0)!==_)return!1}return"nondirectional_node"},g.entityID=function(){return t},g}function $i(t){return t!=="attribution"&&t!=="created_by"&&t!=="source"&&t!=="odbl"&&t.indexOf("source:")!==0&&t.indexOf("source_ref")!==0&&t.indexOf("tiger:")!==0}var Uo={};function j5(t){Uo=t}var Oa={proposed:!0,planned:!0,construction:!0,disused:!0,abandoned:!0,was:!0,dismantled:!0,razed:!0,demolished:!0,destroyed:!0,removed:!0,obliterated:!0,intermittent:!0};function A4(t){let e=t.split(":");return e.length===1?t:e[0]in Oa?t.slice(e[0].length+1):t}var ux={highway:{elevator:!0,rest_area:!0,services:!0},public_transport:{platform:!0},railway:{platform:!0,roundhouse:!0,station:!0,traverser:!0,turntable:!0,wash:!0},traffic_calming:{island:!0},waterway:{dam:!0}};function La(t){if(t.area==="yes")return{area:"yes"};if(t.area==="no")return null;var e={};for(var r in t){let i=A4(r);if(i in Uo&&!(t[r]in Uo[i])||i in ux&&t[r]in ux[i])return e[r]=t[r],e}return null}var uc={};function V5(t){uc=t}var fc={};function X5(t){fc=t}function Ba(t){var e={};for(var r in t)if(uc[r]&&(uc[r]["*"]||uc[r][t[r]])&&(e.point=!0),fc[r]&&(fc[r]["*"]||fc[r][t[r]])&&(e.vertex=!0),e.point&&e.vertex)break;return e}var Ms={aerialway:{chair_lift:!0,drag_lift:!0,"j-bar":!0,magic_carpet:!0,mixed_lift:!0,platter:!0,rope_tow:!0,"t-bar":!0,zip_line:!0},highway:{motorway:!0},junction:{circular:!0,roundabout:!0},man_made:{goods_conveyor:!0,"piste:halfpipe":!0},"piste:type":{downhill:!0,sled:!0,yes:!0},"seamark:type":{"two-way_route":!0,recommended_traffic_lane:!0,separation_lane:!0,separation_roundabout:!0},waterway:{canal:!0,ditch:!0,drain:!0,fish_pass:!0,pressurised:!0,river:!0,spillway:!0,stream:!0,tidal_channel:!0}},Bl={surface:{paved:!0,asphalt:!0,concrete:!0,chipseal:!0,"concrete:lanes":!0,"concrete:plates":!0},tracktype:{grade1:!0}},J9={surface:{cobblestone:!0,"cobblestone:flattened":!0,unhewn_cobblestone:!0,sett:!0,paving_stones:!0,metal:!0,wood:!0}},C4={natural:{cliff:!0,coastline:"coastline"},barrier:{retaining_wall:!0,kerb:!0,guard_rail:!0,city_wall:!0},man_made:{embankment:!0},waterway:{weir:!0}},as={motorway:!0,trunk:!0,primary:!0,secondary:!0,tertiary:!0,residential:!0,motorway_link:!0,trunk_link:!0,primary_link:!0,secondary_link:!0,tertiary_link:!0,unclassified:!0,road:!0,service:!0,track:!0,living_street:!0,bus_guideway:!0,path:!0,footway:!0,cycleway:!0,bridleway:!0,pedestrian:!0,corridor:!0,steps:!0},fx={runway:!0,taxiway:!0},Ps={path:!0,footway:!0,cycleway:!0,bridleway:!0,pedestrian:!0,corridor:!0,steps:!0},W5={rail:!0,light_rail:!0,tram:!0,subway:!0,monorail:!0,funicular:!0,miniature:!0,narrow_gauge:!0,disused:!0,preserved:!0},dc={canal:!0,ditch:!0,drain:!0,fish_pass:!0,river:!0,stream:!0,tidal_channel:!0};function Go(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function hc(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function*dx(t,e){if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(i=+i)>=i&&(yield i)}}var Oi=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){let r=this._partials,i=0;for(let n=0;n<this._n&&n<32;n++){let s=r[n],o=e+s,a=Math.abs(e)<Math.abs(s)?e-(o-s):s-(o-e);a&&(r[i++]=a),e=o}return r[i]=e,this._n=i+1,this}valueOf(){let e=this._partials,r=this._n,i,n,s,o=0;if(r>0){for(o=e[--r];r>0&&(i=o,n=e[--r],o=i+n,s=n-(o-i),!s););r>0&&(s<0&&e[r-1]<0||s>0&&e[r-1]>0)&&(n=s*2,i=o+n,n==i-o&&(o=i))}return o}};function hx(t=Go){if(t===Go)return e8;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{let i=t(e,r);return i||i===0?i:(t(r,r)===0)-(t(e,e)===0)}}function e8(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}function q5(t,e){let r;if(e===void 0)for(let i of t)i!=null&&(r<i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let n of t)(n=e(n,++i,t))!=null&&(r<n||r===void 0&&n>=n)&&(r=n)}return r}function Y5(t,e){let r;if(e===void 0)for(let i of t)i!=null&&(r>i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let n of t)(n=e(n,++i,t))!=null&&(r>n||r===void 0&&n>=n)&&(r=n)}return r}function Q5(t,e,r=0,i=1/0,n){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),i=Math.floor(Math.min(t.length-1,i)),!(r<=e&&e<=i))return t;for(n=n===void 0?e8:hx(n);i>r;){if(i-r>600){let l=i-r+1,c=e-r+1,u=Math.log(l),d=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*d*(l-d)/l)*(c-l/2<0?-1:1),p=Math.max(r,Math.floor(e-c*d/l+h)),m=Math.min(i,Math.floor(e+(l-c)*d/l+h));Q5(t,e,p,m,n)}let s=t[e],o=r,a=i;for(k4(t,r,e),n(t[i],s)>0&&k4(t,r,i);o<a;){for(k4(t,o,a),++o,--a;n(t[o],s)<0;)++o;for(;n(t[a],s)>0;)--a}n(t[r],s)===0?k4(t,r,a):(++a,k4(t,a,i)),a<=e&&(r=a+1),e<=a&&(i=a-1)}return t}function k4(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}function t8(t,e,r){if(t=Float64Array.from(dx(t,r)),!(!(i=t.length)||isNaN(e=+e))){if(e<=0||i<2)return Y5(t);if(e>=1)return q5(t);var i,n=(i-1)*e,s=Math.floor(n),o=q5(Q5(t,s).subarray(0,s+1)),a=Y5(t.subarray(s+1));return o+(a-o)*(n-s)}}function K5(t,e){return t8(t,.5,e)}var pc=1e-6,r8=1e-12,mc=Math.PI,I4=mc/2,i8=mc/4,Z5=mc*2,Ul=180/mc,Ar=mc/180,gc=Math.abs,px=Math.atan,zo=Math.atan2,Ur=Math.cos;var mx=Math.exp;var J5=Math.hypot,gx=Math.log;var Gr=Math.sin;var yc=Math.sqrt,yx=Math.tan;function M4(t){return t>1?I4:t<-1?-I4:Math.asin(t)}function ji(){}function ef(t,e){t&&xx.hasOwnProperty(t.type)&&xx[t.type](t,e)}var vx={Feature:function(t,e){ef(t.geometry,e)},FeatureCollection:function(t,e){for(var r=t.features,i=-1,n=r.length;++i<n;)ef(r[i].geometry,e)}},xx={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var r=t.coordinates,i=-1,n=r.length;++i<n;)t=r[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){n8(t.coordinates,e,0)},MultiLineString:function(t,e){for(var r=t.coordinates,i=-1,n=r.length;++i<n;)n8(r[i],e,0)},Polygon:function(t,e){_x(t.coordinates,e)},MultiPolygon:function(t,e){for(var r=t.coordinates,i=-1,n=r.length;++i<n;)_x(r[i],e)},GeometryCollection:function(t,e){for(var r=t.geometries,i=-1,n=r.length;++i<n;)ef(r[i],e)}};function n8(t,e,r){var i=-1,n=t.length-r,s;for(e.lineStart();++i<n;)s=t[i],e.point(s[0],s[1],s[2]);e.lineEnd()}function _x(t,e){var r=-1,i=t.length;for(e.polygonStart();++r<i;)n8(t[r],e,1);e.polygonEnd()}function Ua(t,e){t&&vx.hasOwnProperty(t.type)?vx[t.type](t,e):ef(t,e)}var P4=new Oi,tf=new Oi,bx,wx,s8,o8,a8,Rs={point:ji,lineStart:ji,lineEnd:ji,polygonStart:function(){P4=new Oi,Rs.lineStart=aP,Rs.lineEnd=lP},polygonEnd:function(){var t=+P4;tf.add(t<0?Z5+t:t),this.lineStart=this.lineEnd=this.point=ji},sphere:function(){tf.add(Z5)}};function aP(){Rs.point=cP}function lP(){Ex(bx,wx)}function cP(t,e){Rs.point=Ex,bx=t,wx=e,t*=Ar,e*=Ar,s8=t,o8=Ur(e=e/2+i8),a8=Gr(e)}function Ex(t,e){t*=Ar,e*=Ar,e=e/2+i8;var r=t-s8,i=r>=0?1:-1,n=i*r,s=Ur(e),o=Gr(e),a=a8*o,l=o8*s+a*Ur(n),c=a*i*Gr(n);P4.add(zo(c,l)),s8=t,o8=s,a8=o}function oo(t){return tf=new Oi,Ua(t,Rs),tf*2}function Sx(t){return[zo(t[1],t[0]),M4(t[2])]}function Tx(t){var e=t[0],r=t[1],i=Ur(r);return[i*Ur(e),i*Gr(e),Gr(r)]}function l8(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ax(t){var e=yc(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var Mr,gn,zr,Ln,Gl,Mx,Px,vc,R4,Ga,$o,Ho={point:c8,lineStart:Cx,lineEnd:kx,polygonStart:function(){Ho.point=Nx,Ho.lineStart=uP,Ho.lineEnd=fP,R4=new Oi,Rs.polygonStart()},polygonEnd:function(){Rs.polygonEnd(),Ho.point=c8,Ho.lineStart=Cx,Ho.lineEnd=kx,P4<0?(Mr=-(zr=180),gn=-(Ln=90)):R4>pc?Ln=90:R4<-pc&&(gn=-90),$o[0]=Mr,$o[1]=zr},sphere:function(){Mr=-(zr=180),gn=-(Ln=90)}};function c8(t,e){Ga.push($o=[Mr=t,zr=t]),e<gn&&(gn=e),e>Ln&&(Ln=e)}function Rx(t,e){var r=Tx([t*Ar,e*Ar]);if(vc){var i=l8(vc,r),n=[i[1],-i[0],0],s=l8(n,i);Ax(s),s=Sx(s);var o=t-Gl,a=o>0?1:-1,l=s[0]*Ul*a,c,u=gc(o)>180;u^(a*Gl<l&&l<a*t)?(c=s[1]*Ul,c>Ln&&(Ln=c)):(l=(l+360)%360-180,u^(a*Gl<l&&l<a*t)?(c=-s[1]*Ul,c<gn&&(gn=c)):(e<gn&&(gn=e),e>Ln&&(Ln=e))),u?t<Gl?On(Mr,t)>On(Mr,zr)&&(zr=t):On(t,zr)>On(Mr,zr)&&(Mr=t):zr>=Mr?(t<Mr&&(Mr=t),t>zr&&(zr=t)):t>Gl?On(Mr,t)>On(Mr,zr)&&(zr=t):On(t,zr)>On(Mr,zr)&&(Mr=t)}else Ga.push($o=[Mr=t,zr=t]);e<gn&&(gn=e),e>Ln&&(Ln=e),vc=r,Gl=t}function Cx(){Ho.point=Rx}function kx(){$o[0]=Mr,$o[1]=zr,Ho.point=c8,vc=null}function Nx(t,e){if(vc){var r=t-Gl;R4.add(gc(r)>180?r+(r>0?360:-360):r)}else Mx=t,Px=e;Rs.point(t,e),Rx(t,e)}function uP(){Rs.lineStart()}function fP(){Nx(Mx,Px),Rs.lineEnd(),gc(R4)>pc&&(Mr=-(zr=180)),$o[0]=Mr,$o[1]=zr,vc=null}function On(t,e){return(e-=t)<0?e+360:e}function dP(t,e){return t[0]-e[0]}function Ix(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function N4(t){var e,r,i,n,s,o,a;if(Ln=zr=-(Mr=gn=1/0),Ga=[],Ua(t,Ho),r=Ga.length){for(Ga.sort(dP),e=1,i=Ga[0],s=[i];e<r;++e)n=Ga[e],Ix(i,n[0])||Ix(i,n[1])?(On(i[0],n[1])>On(i[0],i[1])&&(i[1]=n[1]),On(n[0],i[1])>On(i[0],i[1])&&(i[0]=n[0])):s.push(i=n);for(o=-1/0,r=s.length-1,e=0,i=s[r];e<=r;i=n,++e)n=s[e],(a=On(i[1],n[0]))>o&&(o=a,Mr=n[0],zr=i[1])}return Ga=$o=null,Mr===1/0||gn===1/0?[[NaN,NaN],[NaN,NaN]]:[[Mr,gn],[zr,Ln]]}var D4,rf,nf,sf,of,af,lf,cf,u8,f8,d8,Ox,Lx,Vi,Xi,Wi,Ns={sphere:ji,point:h8,lineStart:Dx,lineEnd:Fx,polygonStart:function(){Ns.lineStart=mP,Ns.lineEnd=gP},polygonEnd:function(){Ns.lineStart=Dx,Ns.lineEnd=Fx}};function h8(t,e){t*=Ar,e*=Ar;var r=Ur(e);F4(r*Ur(t),r*Gr(t),Gr(e))}function F4(t,e,r){++D4,nf+=(t-nf)/D4,sf+=(e-sf)/D4,of+=(r-of)/D4}function Dx(){Ns.point=hP}function hP(t,e){t*=Ar,e*=Ar;var r=Ur(e);Vi=r*Ur(t),Xi=r*Gr(t),Wi=Gr(e),Ns.point=pP,F4(Vi,Xi,Wi)}function pP(t,e){t*=Ar,e*=Ar;var r=Ur(e),i=r*Ur(t),n=r*Gr(t),s=Gr(e),o=zo(yc((o=Xi*s-Wi*n)*o+(o=Wi*i-Vi*s)*o+(o=Vi*n-Xi*i)*o),Vi*i+Xi*n+Wi*s);rf+=o,af+=o*(Vi+(Vi=i)),lf+=o*(Xi+(Xi=n)),cf+=o*(Wi+(Wi=s)),F4(Vi,Xi,Wi)}function Fx(){Ns.point=h8}function mP(){Ns.point=yP}function gP(){Bx(Ox,Lx),Ns.point=h8}function yP(t,e){Ox=t,Lx=e,t*=Ar,e*=Ar,Ns.point=Bx;var r=Ur(e);Vi=r*Ur(t),Xi=r*Gr(t),Wi=Gr(e),F4(Vi,Xi,Wi)}function Bx(t,e){t*=Ar,e*=Ar;var r=Ur(e),i=r*Ur(t),n=r*Gr(t),s=Gr(e),o=Xi*s-Wi*n,a=Wi*i-Vi*s,l=Vi*n-Xi*i,c=J5(o,a,l),u=M4(c),d=c&&-u/c;u8.add(d*o),f8.add(d*a),d8.add(d*l),rf+=u,af+=u*(Vi+(Vi=i)),lf+=u*(Xi+(Xi=n)),cf+=u*(Wi+(Wi=s)),F4(Vi,Xi,Wi)}function p8(t){D4=rf=nf=sf=of=af=lf=cf=0,u8=new Oi,f8=new Oi,d8=new Oi,Ua(t,Ns);var e=+u8,r=+f8,i=+d8,n=J5(e,r,i);return n<r8&&(e=af,r=lf,i=cf,rf<pc&&(e=nf,r=sf,i=of),n=J5(e,r,i),n<r8)?[NaN,NaN]:[zo(r,e)*Ul,M4(i/n)*Ul]}var m8,g8,uf,ff,xc={sphere:ji,point:ji,lineStart:vP,lineEnd:ji,polygonStart:ji,polygonEnd:ji};function vP(){xc.point=_P,xc.lineEnd=xP}function xP(){xc.point=xc.lineEnd=ji}function _P(t,e){t*=Ar,e*=Ar,g8=t,uf=Gr(e),ff=Ur(e),xc.point=bP}function bP(t,e){t*=Ar,e*=Ar;var r=Gr(e),i=Ur(e),n=gc(t-g8),s=Ur(n),o=Gr(n),a=i*o,l=ff*r-uf*i*s,c=uf*r+ff*i*s;m8.add(zo(yc(a*a+l*l),c)),g8=t,uf=r,ff=i}function y8(t){return m8=new Oi,Ua(t,xc),+m8}function x8(t){return{stream:wP(t)}}function wP(t){return function(e){var r=new v8;for(var i in t)r[i]=t[i];return r.stream=e,r}}function v8(){}v8.prototype={constructor:v8,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function _c(t,e){return[t,gx(yx((I4+e)/2))]}_c.invert=function(t,e){return[t,2*px(mx(e))-I4]};function bc(t){for(var e=-1,r=t.length,i,n=t[r-1],s=0;++e<r;)i=n,n=t[e],s+=i[1]*n[0]-i[0]*n[1];return s/2}function yn(t){for(var e=-1,r=t.length,i=0,n=0,s,o=t[r-1],a,l=0;++e<r;)s=o,o=t[e],l+=a=s[0]*o[1]-o[0]*s[1],i+=(s[0]+o[0])*a,n+=(s[1]+o[1])*a;return l*=3,[i/l,n/l]}function Ux(t,e,r){return(e[0]-t[0])*(r[1]-t[1])-(e[1]-t[1])*(r[0]-t[0])}function EP(t,e){return t[0]-e[0]||t[1]-e[1]}function Gx(t){let e=t.length,r=[0,1],i=2,n;for(n=2;n<e;++n){for(;i>1&&Ux(t[r[i-2]],t[r[i-1]],t[n])<=0;)--i;r[i++]=n}return r.slice(0,i)}function Ds(t){if((r=t.length)<3)return null;var e,r,i=new Array(r),n=new Array(r);for(e=0;e<r;++e)i[e]=[+t[e][0],+t[e][1],e];for(i.sort(EP),e=0;e<r;++e)n[e]=[i[e][0],-i[e][1]];var s=Gx(i),o=Gx(n),a=o[0]===s[0],l=o[o.length-1]===s[s.length-1],c=[];for(e=s.length-1;e>=0;--e)c.push(t[i[s[e]][2]]);for(e=+a;e<o.length-l;++e)c.push(t[i[o[e]][2]]);return c}var SP={value:()=>{}};function Hx(){for(var t=0,e=arguments.length,r={},i;t<e;++t){if(!(i=arguments[t]+"")||i in r||/[\s.]/.test(i))throw new Error("illegal type: "+i);r[i]=[]}return new df(r)}function df(t){this._=t}function TP(t,e){return t.trim().split(/^|\s+/).map(function(r){var i="",n=r.indexOf(".");if(n>=0&&(i=r.slice(n+1),r=r.slice(0,n)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:i}})}df.prototype=Hx.prototype={constructor:df,on:function(t,e){var r=this._,i=TP(t+"",r),n,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((n=(t=i[s]).type)&&(n=AP(r[n],t.name)))return n;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(n=(t=i[s]).type)r[n]=zx(r[n],t.name,e);else if(e==null)for(n in r)r[n]=zx(r[n],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new df(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var r=new Array(n),i=0,n,s;i<n;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,n=s.length;i<n;++i)s[i].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],n=0,s=i.length;n<s;++n)i[n].value.apply(e,r)}};function AP(t,e){for(var r=0,i=t.length,n;r<i;++r)if((n=t[r]).name===e)return n.value}function zx(t,e,r){for(var i=0,n=t.length;i<n;++i)if(t[i].name===e){t[i]=SP,t=t.slice(0,i).concat(t.slice(i+1));break}return r!=null&&t.push({name:e,value:r}),t}var fe=Hx;var hf="http://www.w3.org/1999/xhtml",_8={svg:"http://www.w3.org/2000/svg",xhtml:hf,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function jo(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),_8.hasOwnProperty(e)?{space:_8[e],local:t}:t}function CP(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===hf&&e.documentElement.namespaceURI===hf?e.createElement(t):e.createElementNS(r,t)}}function kP(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function pf(t){var e=jo(t);return(e.local?kP:CP)(e)}function IP(){}function zl(t){return t==null?IP:function(){return this.querySelector(t)}}function $x(t){typeof t!="function"&&(t=zl(t));for(var e=this._groups,r=e.length,i=new Array(r),n=0;n<r;++n)for(var s=e[n],o=s.length,a=i[n]=new Array(o),l,c,u=0;u<o;++u)(l=s[u])&&(c=t.call(l,l.__data__,u,s))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new wr(i,this._parents)}function O4(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function MP(){return[]}function L4(t){return t==null?MP:function(){return this.querySelectorAll(t)}}function PP(t){return function(){return O4(t.apply(this,arguments))}}function jx(t){typeof t=="function"?t=PP(t):t=L4(t);for(var e=this._groups,r=e.length,i=[],n=[],s=0;s<r;++s)for(var o=e[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&(i.push(t.call(l,l.__data__,c,o)),n.push(l));return new wr(i,n)}function B4(t){return function(){return this.matches(t)}}function mf(t){return function(e){return e.matches(t)}}var RP=Array.prototype.find;function NP(t){return function(){return RP.call(this.children,t)}}function DP(){return this.firstElementChild}function Vx(t){return this.select(t==null?DP:NP(typeof t=="function"?t:mf(t)))}var FP=Array.prototype.filter;function OP(){return Array.from(this.children)}function LP(t){return function(){return FP.call(this.children,t)}}function Xx(t){return this.selectAll(t==null?OP:LP(typeof t=="function"?t:mf(t)))}function Wx(t){typeof t!="function"&&(t=B4(t));for(var e=this._groups,r=e.length,i=new Array(r),n=0;n<r;++n)for(var s=e[n],o=s.length,a=i[n]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new wr(i,this._parents)}function gf(t){return new Array(t.length)}function qx(){return new wr(this._enter||this._groups.map(gf),this._parents)}function U4(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}U4.prototype={constructor:U4,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Yx(t){return function(){return t}}function BP(t,e,r,i,n,s){for(var o=0,a,l=e.length,c=s.length;o<c;++o)(a=e[o])?(a.__data__=s[o],i[o]=a):r[o]=new U4(t,s[o]);for(;o<l;++o)(a=e[o])&&(n[o]=a)}function UP(t,e,r,i,n,s,o){var a,l,c=new Map,u=e.length,d=s.length,h=new Array(u),p;for(a=0;a<u;++a)(l=e[a])&&(h[a]=p=o.call(l,l.__data__,a,e)+"",c.has(p)?n[a]=l:c.set(p,l));for(a=0;a<d;++a)p=o.call(t,s[a],a,s)+"",(l=c.get(p))?(i[a]=l,l.__data__=s[a],c.delete(p)):r[a]=new U4(t,s[a]);for(a=0;a<u;++a)(l=e[a])&&c.get(h[a])===l&&(n[a]=l)}function GP(t){return t.__data__}function Qx(t,e){if(!arguments.length)return Array.from(this,GP);var r=e?UP:BP,i=this._parents,n=this._groups;typeof t!="function"&&(t=Yx(t));for(var s=n.length,o=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var u=i[c],d=n[c],h=d.length,p=zP(t.call(u,u&&u.__data__,c,i)),m=p.length,g=a[c]=new Array(m),y=o[c]=new Array(m),v=l[c]=new Array(h);r(u,d,g,y,v,p,e);for(var x=0,_=0,b,w;x<m;++x)if(b=g[x]){for(x>=_&&(_=x+1);!(w=y[_])&&++_<m;);b._next=w||null}}return o=new wr(o,i),o._enter=a,o._exit=l,o}function zP(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Kx(){return new wr(this._exit||this._groups.map(gf),this._parents)}function Zx(t,e,r){var i=this.enter(),n=this,s=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(n=e(n),n&&(n=n.selection())),r==null?s.remove():r(s),i&&n?i.merge(n).order():n}function Jx(t){for(var e=t.selection?t.selection():t,r=this._groups,i=e._groups,n=r.length,s=i.length,o=Math.min(n,s),a=new Array(n),l=0;l<o;++l)for(var c=r[l],u=i[l],d=c.length,h=a[l]=new Array(d),p,m=0;m<d;++m)(p=c[m]||u[m])&&(h[m]=p);for(;l<n;++l)a[l]=r[l];return new wr(a,this._parents)}function e_(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var i=t[e],n=i.length-1,s=i[n],o;--n>=0;)(o=i[n])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function t_(t){t||(t=HP);function e(d,h){return d&&h?t(d.__data__,h.__data__):!d-!h}for(var r=this._groups,i=r.length,n=new Array(i),s=0;s<i;++s){for(var o=r[s],a=o.length,l=n[s]=new Array(a),c,u=0;u<a;++u)(c=o[u])&&(l[u]=c);l.sort(e)}return new wr(n,this._parents).order()}function HP(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function r_(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function i_(){return Array.from(this)}function n_(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var i=t[e],n=0,s=i.length;n<s;++n){var o=i[n];if(o)return o}return null}function s_(){let t=0;for(let e of this)++t;return t}function o_(){return!this.node()}function a_(t){for(var e=this._groups,r=0,i=e.length;r<i;++r)for(var n=e[r],s=0,o=n.length,a;s<o;++s)(a=n[s])&&t.call(a,a.__data__,s,n);return this}function $P(t){return function(){this.removeAttribute(t)}}function jP(t){return function(){this.removeAttributeNS(t.space,t.local)}}function VP(t,e){return function(){this.setAttribute(t,e)}}function XP(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function WP(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function qP(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function l_(t,e){var r=jo(t);if(arguments.length<2){var i=this.node();return r.local?i.getAttributeNS(r.space,r.local):i.getAttribute(r)}return this.each((e==null?r.local?jP:$P:typeof e=="function"?r.local?qP:WP:r.local?XP:VP)(r,e))}function yf(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function YP(t){return function(){this.style.removeProperty(t)}}function QP(t,e,r){return function(){this.style.setProperty(t,e,r)}}function KP(t,e,r){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,r)}}function c_(t,e,r){return arguments.length>1?this.each((e==null?YP:typeof e=="function"?KP:QP)(t,e,r??"")):za(this.node(),t)}function za(t,e){return t.style.getPropertyValue(e)||yf(t).getComputedStyle(t,null).getPropertyValue(e)}function ZP(t){return function(){delete this[t]}}function JP(t,e){return function(){this[t]=e}}function eR(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function u_(t,e){return arguments.length>1?this.each((e==null?ZP:typeof e=="function"?eR:JP)(t,e)):this.node()[t]}function f_(t){return t.trim().split(/^|\s+/)}function b8(t){return t.classList||new d_(t)}function d_(t){this._node=t,this._names=f_(t.getAttribute("class")||"")}d_.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function h_(t,e){for(var r=b8(t),i=-1,n=e.length;++i<n;)r.add(e[i])}function p_(t,e){for(var r=b8(t),i=-1,n=e.length;++i<n;)r.remove(e[i])}function tR(t){return function(){h_(this,t)}}function rR(t){return function(){p_(this,t)}}function iR(t,e){return function(){(e.apply(this,arguments)?h_:p_)(this,t)}}function m_(t,e){var r=f_(t+"");if(arguments.length<2){for(var i=b8(this.node()),n=-1,s=r.length;++n<s;)if(!i.contains(r[n]))return!1;return!0}return this.each((typeof e=="function"?iR:e?tR:rR)(r,e))}function nR(){this.textContent=""}function sR(t){return function(){this.textContent=t}}function oR(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function g_(t){return arguments.length?this.each(t==null?nR:(typeof t=="function"?oR:sR)(t)):this.node().textContent}function aR(){this.innerHTML=""}function lR(t){return function(){this.innerHTML=t}}function cR(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function y_(t){return arguments.length?this.each(t==null?aR:(typeof t=="function"?cR:lR)(t)):this.node().innerHTML}function uR(){this.nextSibling&&this.parentNode.appendChild(this)}function v_(){return this.each(uR)}function fR(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function x_(){return this.each(fR)}function __(t){var e=typeof t=="function"?t:pf(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function dR(){return null}function b_(t,e){var r=typeof t=="function"?t:pf(t),i=e==null?dR:typeof e=="function"?e:zl(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),i.apply(this,arguments)||null)})}function hR(){var t=this.parentNode;t&&t.removeChild(this)}function w_(){return this.each(hR)}function pR(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function mR(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function E_(t){return this.select(t?mR:pR)}function S_(t){return arguments.length?this.property("__data__",t):this.node().__data__}function gR(t){return function(e){t.call(this,e,this.__data__)}}function yR(t){return t.trim().split(/^|\s+/).map(function(e){var r="",i=e.indexOf(".");return i>=0&&(r=e.slice(i+1),e=e.slice(0,i)),{type:e,name:r}})}function vR(t){return function(){var e=this.__on;if(e){for(var r=0,i=-1,n=e.length,s;r<n;++r)s=e[r],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function xR(t,e,r){return function(){var i=this.__on,n,s=gR(e);if(i){for(var o=0,a=i.length;o<a;++o)if((n=i[o]).type===t.type&&n.name===t.name){this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=s,n.options=r),n.value=e;return}}this.addEventListener(t.type,s,r),n={type:t.type,name:t.name,value:e,listener:s,options:r},i?i.push(n):this.__on=[n]}}function T_(t,e,r){var i=yR(t+""),n,s=i.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(n=0,u=a[l];n<s;++n)if((o=i[n]).type===u.type&&o.name===u.name)return u.value}return}for(a=e?xR:vR,n=0;n<s;++n)this.each(a(i[n],e,r));return this}function A_(t,e,r){var i=yf(t),n=i.CustomEvent;typeof n=="function"?n=new n(e,r):(n=i.document.createEvent("Event"),r?(n.initEvent(e,r.bubbles,r.cancelable),n.detail=r.detail):n.initEvent(e,!1,!1)),t.dispatchEvent(n)}function _R(t,e){return function(){return A_(this,t,e)}}function bR(t,e){return function(){return A_(this,t,e.apply(this,arguments))}}function C_(t,e){return this.each((typeof e=="function"?bR:_R)(t,e))}function*k_(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var i=t[e],n=0,s=i.length,o;n<s;++n)(o=i[n])&&(yield o)}var G4=[null];function wr(t,e){this._groups=t,this._parents=e}function I_(){return new wr([[document.documentElement]],G4)}function wR(){return this}wr.prototype=I_.prototype={constructor:wr,select:$x,selectAll:jx,selectChild:Vx,selectChildren:Xx,filter:Wx,data:Qx,enter:qx,exit:Kx,join:Zx,merge:Jx,selection:wR,order:e_,sort:t_,call:r_,nodes:i_,node:n_,size:s_,empty:o_,each:a_,attr:l_,style:c_,property:u_,classed:m_,text:g_,html:y_,raise:v_,lower:x_,append:__,insert:b_,remove:w_,clone:E_,datum:S_,on:T_,dispatch:C_,[Symbol.iterator]:k_};var Vo=I_;function H(t){return typeof t=="string"?new wr([[document.querySelector(t)]],[document.documentElement]):new wr([[t]],G4)}function M_(t){let e;for(;e=t.sourceEvent;)t=e;return t}function ls(t,e){if(t=M_(t),e===void 0&&(e=t.currentTarget),e){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var i=r.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var n=e.getBoundingClientRect();return[t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop]}}return[t.pageX,t.pageY]}function w8(t){return typeof t=="string"?new wr([document.querySelectorAll(t)],[document.documentElement]):new wr([O4(t)],G4)}var P_={passive:!1},Hl={capture:!0,passive:!1};function vf(t){t.stopImmediatePropagation()}function Ha(t){t.preventDefault(),t.stopImmediatePropagation()}function z4(t){var e=t.document.documentElement,r=H(t).on("dragstart.drag",Ha,Hl);"onselectstart"in e?r.on("selectstart.drag",Ha,Hl):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function H4(t,e){var r=t.document.documentElement,i=H(t).on("dragstart.drag",null);e&&(i.on("click.drag",Ha,Hl),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in r?i.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}var $4=t=>()=>t;function j4(t,{sourceEvent:e,subject:r,target:i,identifier:n,active:s,x:o,y:a,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:n,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}j4.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function ER(t){return!t.ctrlKey&&!t.button}function SR(){return this.parentNode}function TR(t,e){return e??{x:t.x,y:t.y}}function AR(){return navigator.maxTouchPoints||"ontouchstart"in this}function V4(){var t=ER,e=SR,r=TR,i=AR,n={},s=fe("start","drag","end"),o=0,a,l,c,u,d=0;function h(b){b.on("mousedown.drag",p).filter(i).on("touchstart.drag",y).on("touchmove.drag",v,P_).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(b,w){if(!(u||!t.call(this,b,w))){var E=_(this,e.call(this,b,w),b,w,"mouse");E&&(H(b.view).on("mousemove.drag",m,Hl).on("mouseup.drag",g,Hl),z4(b.view),vf(b),c=!1,a=b.clientX,l=b.clientY,E("start",b))}}function m(b){if(Ha(b),!c){var w=b.clientX-a,E=b.clientY-l;c=w*w+E*E>d}n.mouse("drag",b)}function g(b){H(b.view).on("mousemove.drag mouseup.drag",null),H4(b.view,c),Ha(b),n.mouse("end",b)}function y(b,w){if(t.call(this,b,w)){var E=b.changedTouches,A=e.call(this,b,w),T=E.length,k,C;for(k=0;k<T;++k)(C=_(this,A,b,w,E[k].identifier,E[k]))&&(vf(b),C("start",b,E[k]))}}function v(b){var w=b.changedTouches,E=w.length,A,T;for(A=0;A<E;++A)(T=n[w[A].identifier])&&(Ha(b),T("drag",b,w[A]))}function x(b){var w=b.changedTouches,E=w.length,A,T;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),A=0;A<E;++A)(T=n[w[A].identifier])&&(vf(b),T("end",b,w[A]))}function _(b,w,E,A,T,k){var C=s.copy(),I=ls(k||E,w),P,N,M;if((M=r.call(b,new j4("beforestart",{sourceEvent:E,target:h,identifier:T,active:o,x:I[0],y:I[1],dx:0,dy:0,dispatch:C}),A))!=null)return P=M.x-I[0]||0,N=M.y-I[1]||0,function D(F,L,B){var O=I,R;switch(F){case"start":n[T]=D,R=o++;break;case"end":delete n[T],--o;case"drag":I=ls(B||L,w),R=o;break}C.call(F,b,new j4(F,{sourceEvent:L,subject:M,target:h,identifier:T,active:R,x:I[0]+P,y:I[1]+N,dx:I[0]-O[0],dy:I[1]-O[1],dispatch:C}),A)}}return h.filter=function(b){return arguments.length?(t=typeof b=="function"?b:$4(!!b),h):t},h.container=function(b){return arguments.length?(e=typeof b=="function"?b:$4(b),h):e},h.subject=function(b){return arguments.length?(r=typeof b=="function"?b:$4(b),h):r},h.touchable=function(b){return arguments.length?(i=typeof b=="function"?b:$4(!!b),h):i},h.on=function(){var b=s.on.apply(s,arguments);return b===s?h:b},h.clickDistance=function(b){return arguments.length?(d=(b=+b)*b,h):Math.sqrt(d)},h}function xf(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function E8(t,e){var r=Object.create(t.prototype);for(var i in e)r[i]=e[i];return r}function q4(){}var X4=.7,wf=1/X4,wc="\\s*([+-]?\\d+)\\s*",W4="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ao="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",CR=/^#([0-9a-f]{3,8})$/,kR=new RegExp(`^rgb\\(${wc},${wc},${wc}\\)$`),IR=new RegExp(`^rgb\\(${ao},${ao},${ao}\\)$`),MR=new RegExp(`^rgba\\(${wc},${wc},${wc},${W4}\\)$`),PR=new RegExp(`^rgba\\(${ao},${ao},${ao},${W4}\\)$`),RR=new RegExp(`^hsl\\(${W4},${ao},${ao}\\)$`),NR=new RegExp(`^hsla\\(${W4},${ao},${ao},${W4}\\)$`),R_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};xf(q4,Os,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:N_,formatHex:N_,formatHex8:DR,formatHsl:FR,formatRgb:D_,toString:D_});function N_(){return this.rgb().formatHex()}function DR(){return this.rgb().formatHex8()}function FR(){return G_(this).formatHsl()}function D_(){return this.rgb().formatRgb()}function Os(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=CR.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?F_(e):r===3?new vn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?_f(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?_f(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=kR.exec(t))?new vn(e[1],e[2],e[3],1):(e=IR.exec(t))?new vn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=MR.exec(t))?_f(e[1],e[2],e[3],e[4]):(e=PR.exec(t))?_f(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=RR.exec(t))?B_(e[1],e[2]/100,e[3]/100,1):(e=NR.exec(t))?B_(e[1],e[2]/100,e[3]/100,e[4]):R_.hasOwnProperty(t)?F_(R_[t]):t==="transparent"?new vn(NaN,NaN,NaN,0):null}function F_(t){return new vn(t>>16&255,t>>8&255,t&255,1)}function _f(t,e,r,i){return i<=0&&(t=e=r=NaN),new vn(t,e,r,i)}function OR(t){return t instanceof q4||(t=Os(t)),t?(t=t.rgb(),new vn(t.r,t.g,t.b,t.opacity)):new vn}function Ec(t,e,r,i){return arguments.length===1?OR(t):new vn(t,e,r,i??1)}function vn(t,e,r,i){this.r=+t,this.g=+e,this.b=+r,this.opacity=+i}xf(vn,Ec,E8(q4,{brighter(t){return t=t==null?wf:Math.pow(wf,t),new vn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?X4:Math.pow(X4,t),new vn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new vn(jl(this.r),jl(this.g),jl(this.b),Ef(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:O_,formatHex:O_,formatHex8:LR,formatRgb:L_,toString:L_}));function O_(){return`#${$l(this.r)}${$l(this.g)}${$l(this.b)}`}function LR(){return`#${$l(this.r)}${$l(this.g)}${$l(this.b)}${$l((isNaN(this.opacity)?1:this.opacity)*255)}`}function L_(){let t=Ef(this.opacity);return`${t===1?"rgb(":"rgba("}${jl(this.r)}, ${jl(this.g)}, ${jl(this.b)}${t===1?")":`, ${t})`}`}function Ef(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function jl(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function $l(t){return t=jl(t),(t<16?"0":"")+t.toString(16)}function B_(t,e,r,i){return i<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Fs(t,e,r,i)}function G_(t){if(t instanceof Fs)return new Fs(t.h,t.s,t.l,t.opacity);if(t instanceof q4||(t=Os(t)),!t)return new Fs;if(t instanceof Fs)return t;t=t.rgb();var e=t.r/255,r=t.g/255,i=t.b/255,n=Math.min(e,r,i),s=Math.max(e,r,i),o=NaN,a=s-n,l=(s+n)/2;return a?(e===s?o=(r-i)/a+(r<i)*6:r===s?o=(i-e)/a+2:o=(e-r)/a+4,a/=l<.5?s+n:2-s-n,o*=60):a=l>0&&l<1?0:o,new Fs(o,a,l,t.opacity)}function z_(t,e,r,i){return arguments.length===1?G_(t):new Fs(t,e,r,i??1)}function Fs(t,e,r,i){this.h=+t,this.s=+e,this.l=+r,this.opacity=+i}xf(Fs,z_,E8(q4,{brighter(t){return t=t==null?wf:Math.pow(wf,t),new Fs(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?X4:Math.pow(X4,t),new Fs(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*e,n=2*r-i;return new vn(S8(t>=240?t-240:t+120,n,i),S8(t,n,i),S8(t<120?t+240:t-120,n,i),this.opacity)},clamp(){return new Fs(U_(this.h),bf(this.s),bf(this.l),Ef(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=Ef(this.opacity);return`${t===1?"hsl(":"hsla("}${U_(this.h)}, ${bf(this.s)*100}%, ${bf(this.l)*100}%${t===1?")":`, ${t})`}`}}));function U_(t){return t=(t||0)%360,t<0?t+360:t}function bf(t){return Math.max(0,Math.min(1,t||0))}function S8(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}function T8(t,e,r,i,n){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*r+(1+3*t+3*s-3*o)*i+o*n)/6}function H_(t){var e=t.length-1;return function(r){var i=r<=0?r=0:r>=1?(r=1,e-1):Math.floor(r*e),n=t[i],s=t[i+1],o=i>0?t[i-1]:2*n-s,a=i<e-1?t[i+2]:2*s-n;return T8((r-i/e)*e,o,n,s,a)}}function $_(t){var e=t.length;return function(r){var i=Math.floor(((r%=1)<0?++r:r)*e),n=t[(i+e-1)%e],s=t[i%e],o=t[(i+1)%e],a=t[(i+2)%e];return T8((r-i/e)*e,n,s,o,a)}}var Y4=t=>()=>t;function BR(t,e){return function(r){return t+r*e}}function UR(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(i){return Math.pow(t+i*e,r)}}function j_(t){return(t=+t)==1?Sf:function(e,r){return r-e?UR(e,r,t):Y4(isNaN(e)?r:e)}}function Sf(t,e){var r=e-t;return r?BR(t,r):Y4(isNaN(t)?e:t)}var lo=function t(e){var r=j_(e);function i(n,s){var o=r((n=Ec(n)).r,(s=Ec(s)).r),a=r(n.g,s.g),l=r(n.b,s.b),c=Sf(n.opacity,s.opacity);return function(u){return n.r=o(u),n.g=a(u),n.b=l(u),n.opacity=c(u),n+""}}return i.gamma=t,i}(1);function V_(t){return function(e){var r=e.length,i=new Array(r),n=new Array(r),s=new Array(r),o,a;for(o=0;o<r;++o)a=Ec(e[o]),i[o]=a.r||0,n[o]=a.g||0,s[o]=a.b||0;return i=t(i),n=t(n),s=t(s),a.opacity=1,function(l){return a.r=i(l),a.g=n(l),a.b=s(l),a+""}}}var GR=V_(H_),zR=V_($_);function X_(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,i=e.slice(),n;return function(s){for(n=0;n<r;++n)i[n]=t[n]*(1-s)+e[n]*s;return i}}function W_(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function q_(t,e){var r=e?e.length:0,i=t?Math.min(r,t.length):0,n=new Array(i),s=new Array(r),o;for(o=0;o<i;++o)n[o]=$a(t[o],e[o]);for(;o<r;++o)s[o]=e[o];return function(a){for(o=0;o<i;++o)s[o]=n[o](a);return s}}function Y_(t,e){var r=new Date;return t=+t,e=+e,function(i){return r.setTime(t*(1-i)+e*i),r}}function Hr(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function Q_(t,e){var r={},i={},n;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(n in e)n in t?r[n]=$a(t[n],e[n]):i[n]=e[n];return function(s){for(n in r)i[n]=r[n](s);return i}}var C8=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,A8=new RegExp(C8.source,"g");function HR(t){return function(){return t}}function $R(t){return function(e){return t(e)+""}}function Q4(t,e){var r=C8.lastIndex=A8.lastIndex=0,i,n,s,o=-1,a=[],l=[];for(t=t+"",e=e+"";(i=C8.exec(t))&&(n=A8.exec(e));)(s=n.index)>r&&(s=e.slice(r,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(n=n[0])?a[o]?a[o]+=n:a[++o]=n:(a[++o]=null,l.push({i:o,x:Hr(i,n)})),r=A8.lastIndex;return r<e.length&&(s=e.slice(r),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?$R(l[0].x):HR(e):(e=l.length,function(c){for(var u=0,d;u<e;++u)a[(d=l[u]).i]=d.x(c);return a.join("")})}function $a(t,e){var r=typeof e,i;return e==null||r==="boolean"?Y4(e):(r==="number"?Hr:r==="string"?(i=Os(e))?(e=i,lo):Q4:e instanceof Os?lo:e instanceof Date?Y_:W_(e)?X_:Array.isArray(e)?q_:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Q_:Hr)(t,e)}var K_=180/Math.PI,Tf={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function k8(t,e,r,i,n,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*r+e*i)&&(r-=t*l,i-=e*l),(a=Math.sqrt(r*r+i*i))&&(r/=a,i/=a,l/=a),t*i<e*r&&(t=-t,e=-e,l=-l,o=-o),{translateX:n,translateY:s,rotate:Math.atan2(e,t)*K_,skewX:Math.atan(l)*K_,scaleX:o,scaleY:a}}var Af;function Z_(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Tf:k8(e.a,e.b,e.c,e.d,e.e,e.f)}function J_(t){return t==null?Tf:(Af||(Af=document.createElementNS("http://www.w3.org/2000/svg","g")),Af.setAttribute("transform",t),(t=Af.transform.baseVal.consolidate())?(t=t.matrix,k8(t.a,t.b,t.c,t.d,t.e,t.f)):Tf)}function eb(t,e,r,i){function n(c){return c.length?c.pop()+" ":""}function s(c,u,d,h,p,m){if(c!==d||u!==h){var g=p.push("translate(",null,e,null,r);m.push({i:g-4,x:Hr(c,d)},{i:g-2,x:Hr(u,h)})}else(d||h)&&p.push("translate("+d+e+h+r)}function o(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(n(d)+"rotate(",null,i)-2,x:Hr(c,u)})):u&&d.push(n(d)+"rotate("+u+i)}function a(c,u,d,h){c!==u?h.push({i:d.push(n(d)+"skewX(",null,i)-2,x:Hr(c,u)}):u&&d.push(n(d)+"skewX("+u+i)}function l(c,u,d,h,p,m){if(c!==d||u!==h){var g=p.push(n(p)+"scale(",null,",",null,")");m.push({i:g-4,x:Hr(c,d)},{i:g-2,x:Hr(u,h)})}else(d!==1||h!==1)&&p.push(n(p)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=t(c),u=t(u),s(c.translateX,c.translateY,u.translateX,u.translateY,d,h),o(c.rotate,u.rotate,d,h),a(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(p){for(var m=-1,g=h.length,y;++m<g;)d[(y=h[m]).i]=y.x(p);return d.join("")}}}var I8=eb(Z_,"px, ","px)","deg)"),M8=eb(J_,", ",")",")");var jR=1e-12;function tb(t){return((t=Math.exp(t))+1/t)/2}function VR(t){return((t=Math.exp(t))-1/t)/2}function XR(t){return((t=Math.exp(2*t))-1)/(t+1)}var P8=function t(e,r,i){function n(s,o){var a=s[0],l=s[1],c=s[2],u=o[0],d=o[1],h=o[2],p=u-a,m=d-l,g=p*p+m*m,y,v;if(g<jR)v=Math.log(h/c)/e,y=function(A){return[a+A*p,l+A*m,c*Math.exp(e*A*v)]};else{var x=Math.sqrt(g),_=(h*h-c*c+i*g)/(2*c*r*x),b=(h*h-c*c-i*g)/(2*h*r*x),w=Math.log(Math.sqrt(_*_+1)-_),E=Math.log(Math.sqrt(b*b+1)-b);v=(E-w)/e,y=function(A){var T=A*v,k=tb(w),C=c/(r*x)*(k*XR(e*T+w)-VR(w));return[a+C*p,l+C*m,c*k/tb(e*T+w)]}}return y.duration=v*1e3*e/Math.SQRT2,y}return n.rho=function(s){var o=Math.max(.001,+s),a=o*o,l=a*a;return t(o,a,l)},n}(Math.SQRT2,2,4);var Sc=0,Z4=0,K4=0,ib=1e3,Cf,J4,kf=0,Vl=0,If=0,e2=typeof performance=="object"&&performance.now?performance:Date,nb=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function r2(){return Vl||(nb(WR),Vl=e2.now()+If)}function WR(){Vl=0}function t2(){this._call=this._time=this._next=null}t2.prototype=Tc.prototype={constructor:t2,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?r2():+r)+(e==null?0:+e),!this._next&&J4!==this&&(J4?J4._next=this:Cf=this,J4=this),this._call=t,this._time=r,R8()},stop:function(){this._call&&(this._call=null,this._time=1/0,R8())}};function Tc(t,e,r){var i=new t2;return i.restart(t,e,r),i}function Mf(){r2(),++Sc;for(var t=Cf,e;t;)(e=Vl-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Sc}function rb(){Vl=(kf=e2.now())+If,Sc=Z4=0;try{Mf()}finally{Sc=0,YR(),Vl=0}}function qR(){var t=e2.now(),e=t-kf;e>ib&&(If-=e,kf=t)}function YR(){for(var t,e=Cf,r,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:Cf=r);J4=t,R8(i)}function R8(t){if(!Sc){Z4&&(Z4=clearTimeout(Z4));var e=t-Vl;e>24?(t<1/0&&(Z4=setTimeout(rb,t-e2.now()-If)),K4&&(K4=clearInterval(K4))):(K4||(kf=e2.now(),K4=setInterval(qR,ib)),Sc=1,nb(rb))}}function Ac(t,e,r){var i=new t2;return e=e==null?0:+e,i.restart(n=>{i.stop(),t(n+e)},e,r),i}var QR=fe("start","end","cancel","interrupt"),KR=[],ab=0,sb=1,Rf=2,Pf=3,ob=4,Nf=5,i2=6;function ja(t,e,r,i,n,s){var o=t.__transition;if(!o)t.__transition={};else if(r in o)return;ZR(t,r,{name:e,index:i,group:n,on:QR,tween:KR,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:ab})}function n2(t,e){var r=ui(t,e);if(r.state>ab)throw new Error("too late; already scheduled");return r}function Ci(t,e){var r=ui(t,e);if(r.state>Pf)throw new Error("too late; already running");return r}function ui(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function ZR(t,e,r){var i=t.__transition,n;i[e]=r,r.timer=Tc(s,0,r.time);function s(c){r.state=sb,r.timer.restart(o,r.delay,r.time),r.delay<=c&&o(c-r.delay)}function o(c){var u,d,h,p;if(r.state!==sb)return l();for(u in i)if(p=i[u],p.name===r.name){if(p.state===Pf)return Ac(o);p.state===ob?(p.state=i2,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete i[u]):+u<e&&(p.state=i2,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete i[u])}if(Ac(function(){r.state===Pf&&(r.state=ob,r.timer.restart(a,r.delay,r.time),a(c))}),r.state=Rf,r.on.call("start",t,t.__data__,r.index,r.group),r.state===Rf){for(r.state=Pf,n=new Array(h=r.tween.length),u=0,d=-1;u<h;++u)(p=r.tween[u].value.call(t,t.__data__,r.index,r.group))&&(n[++d]=p);n.length=d+1}}function a(c){for(var u=c<r.duration?r.ease.call(null,c/r.duration):(r.timer.restart(l),r.state=Nf,1),d=-1,h=n.length;++d<h;)n[d].call(t,u);r.state===Nf&&(r.on.call("end",t,t.__data__,r.index,r.group),l())}function l(){r.state=i2,r.timer.stop(),delete i[e];for(var c in i)return;delete t.__transition}}function Va(t,e){var r=t.__transition,i,n,s=!0,o;if(r){e=e==null?null:e+"";for(o in r){if((i=r[o]).name!==e){s=!1;continue}n=i.state>Rf&&i.state<Nf,i.state=i2,i.timer.stop(),i.on.call(n?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete r[o]}s&&delete t.__transition}}function lb(t){return this.each(function(){Va(this,t)})}function JR(t,e){var r,i;return function(){var n=Ci(this,t),s=n.tween;if(s!==r){i=r=s;for(var o=0,a=i.length;o<a;++o)if(i[o].name===e){i=i.slice(),i.splice(o,1);break}}n.tween=i}}function eN(t,e,r){var i,n;if(typeof r!="function")throw new Error;return function(){var s=Ci(this,t),o=s.tween;if(o!==i){n=(i=o).slice();for(var a={name:e,value:r},l=0,c=n.length;l<c;++l)if(n[l].name===e){n[l]=a;break}l===c&&n.push(a)}s.tween=n}}function cb(t,e){var r=this._id;if(t+="",arguments.length<2){for(var i=ui(this.node(),r).tween,n=0,s=i.length,o;n<s;++n)if((o=i[n]).name===t)return o.value;return null}return this.each((e==null?JR:eN)(r,t,e))}function Cc(t,e,r){var i=t._id;return t.each(function(){var n=Ci(this,i);(n.value||(n.value={}))[e]=r.apply(this,arguments)}),function(n){return ui(n,i).value[e]}}function Df(t,e){var r;return(typeof e=="number"?Hr:e instanceof Os?lo:(r=Os(e))?(e=r,lo):Q4)(t,e)}function tN(t){return function(){this.removeAttribute(t)}}function rN(t){return function(){this.removeAttributeNS(t.space,t.local)}}function iN(t,e,r){var i,n=r+"",s;return function(){var o=this.getAttribute(t);return o===n?null:o===i?s:s=e(i=o,r)}}function nN(t,e,r){var i,n=r+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===n?null:o===i?s:s=e(i=o,r)}}function sN(t,e,r){var i,n,s;return function(){var o,a=r(this),l;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=a+"",o===l?null:o===i&&l===n?s:(n=l,s=e(i=o,a)))}}function oN(t,e,r){var i,n,s;return function(){var o,a=r(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=a+"",o===l?null:o===i&&l===n?s:(n=l,s=e(i=o,a)))}}function ub(t,e){var r=jo(t),i=r==="transform"?M8:Df;return this.attrTween(t,typeof e=="function"?(r.local?oN:sN)(r,i,Cc(this,"attr."+t,e)):e==null?(r.local?rN:tN)(r):(r.local?nN:iN)(r,i,e))}function aN(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function lN(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function cN(t,e){var r,i;function n(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&lN(t,s)),r}return n._value=e,n}function uN(t,e){var r,i;function n(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&aN(t,s)),r}return n._value=e,n}function fb(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var i=jo(t);return this.tween(r,(i.local?cN:uN)(i,e))}function fN(t,e){return function(){n2(this,t).delay=+e.apply(this,arguments)}}function dN(t,e){return e=+e,function(){n2(this,t).delay=e}}function db(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?fN:dN)(e,t)):ui(this.node(),e).delay}function hN(t,e){return function(){Ci(this,t).duration=+e.apply(this,arguments)}}function pN(t,e){return e=+e,function(){Ci(this,t).duration=e}}function hb(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?hN:pN)(e,t)):ui(this.node(),e).duration}function mN(t,e){if(typeof e!="function")throw new Error;return function(){Ci(this,t).ease=e}}function pb(t){var e=this._id;return arguments.length?this.each(mN(e,t)):ui(this.node(),e).ease}function gN(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;Ci(this,t).ease=r}}function mb(t){if(typeof t!="function")throw new Error;return this.each(gN(this._id,t))}function gb(t){typeof t!="function"&&(t=B4(t));for(var e=this._groups,r=e.length,i=new Array(r),n=0;n<r;++n)for(var s=e[n],o=s.length,a=i[n]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new qi(i,this._parents,this._name,this._id)}function yb(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,i=e.length,n=r.length,s=Math.min(i,n),o=new Array(i),a=0;a<s;++a)for(var l=e[a],c=r[a],u=l.length,d=o[a]=new Array(u),h,p=0;p<u;++p)(h=l[p]||c[p])&&(d[p]=h);for(;a<i;++a)o[a]=e[a];return new qi(o,this._parents,this._name,this._id)}function yN(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function vN(t,e,r){var i,n,s=yN(e)?n2:Ci;return function(){var o=s(this,t),a=o.on;a!==i&&(n=(i=a).copy()).on(e,r),o.on=n}}function vb(t,e){var r=this._id;return arguments.length<2?ui(this.node(),r).on.on(t):this.each(vN(r,t,e))}function xN(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function xb(){return this.on("end.remove",xN(this._id))}function _b(t){var e=this._name,r=this._id;typeof t!="function"&&(t=zl(t));for(var i=this._groups,n=i.length,s=new Array(n),o=0;o<n;++o)for(var a=i[o],l=a.length,c=s[o]=new Array(l),u,d,h=0;h<l;++h)(u=a[h])&&(d=t.call(u,u.__data__,h,a))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,ja(c[h],e,r,h,c,ui(u,r)));return new qi(s,this._parents,e,r)}function bb(t){var e=this._name,r=this._id;typeof t!="function"&&(t=L4(t));for(var i=this._groups,n=i.length,s=[],o=[],a=0;a<n;++a)for(var l=i[a],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=t.call(u,u.__data__,d,l),p,m=ui(u,r),g=0,y=h.length;g<y;++g)(p=h[g])&&ja(p,e,r,g,h,m);s.push(h),o.push(u)}return new qi(s,o,e,r)}var _N=Vo.prototype.constructor;function wb(){return new _N(this._groups,this._parents)}function bN(t,e){var r,i,n;return function(){var s=za(this,t),o=(this.style.removeProperty(t),za(this,t));return s===o?null:s===r&&o===i?n:n=e(r=s,i=o)}}function Eb(t){return function(){this.style.removeProperty(t)}}function wN(t,e,r){var i,n=r+"",s;return function(){var o=za(this,t);return o===n?null:o===i?s:s=e(i=o,r)}}function EN(t,e,r){var i,n,s;return function(){var o=za(this,t),a=r(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),za(this,t))),o===l?null:o===i&&l===n?s:(n=l,s=e(i=o,a))}}function SN(t,e){var r,i,n,s="style."+e,o="end."+s,a;return function(){var l=Ci(this,t),c=l.on,u=l.value[s]==null?a||(a=Eb(e)):void 0;(c!==r||n!==u)&&(i=(r=c).copy()).on(o,n=u),l.on=i}}function Sb(t,e,r){var i=(t+="")=="transform"?I8:Df;return e==null?this.styleTween(t,bN(t,i)).on("end.style."+t,Eb(t)):typeof e=="function"?this.styleTween(t,EN(t,i,Cc(this,"style."+t,e))).each(SN(this._id,t)):this.styleTween(t,wN(t,i,e),r).on("end.style."+t,null)}function TN(t,e,r){return function(i){this.style.setProperty(t,e.call(this,i),r)}}function AN(t,e,r){var i,n;function s(){var o=e.apply(this,arguments);return o!==n&&(i=(n=o)&&TN(t,o,r)),i}return s._value=e,s}function Tb(t,e,r){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,AN(t,e,r??""))}function CN(t){return function(){this.textContent=t}}function kN(t){return function(){var e=t(this);this.textContent=e??""}}function Ab(t){return this.tween("text",typeof t=="function"?kN(Cc(this,"text",t)):CN(t==null?"":t+""))}function IN(t){return function(e){this.textContent=t.call(this,e)}}function MN(t){var e,r;function i(){var n=t.apply(this,arguments);return n!==r&&(e=(r=n)&&IN(n)),e}return i._value=t,i}function Cb(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,MN(t))}function kb(){for(var t=this._name,e=this._id,r=Ff(),i=this._groups,n=i.length,s=0;s<n;++s)for(var o=i[s],a=o.length,l,c=0;c<a;++c)if(l=o[c]){var u=ui(l,e);ja(l,t,r,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new qi(i,this._parents,t,r)}function Ib(){var t,e,r=this,i=r._id,n=r.size();return new Promise(function(s,o){var a={value:o},l={value:function(){--n===0&&s()}};r.each(function(){var c=Ci(this,i),u=c.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),n===0&&s()})}var PN=0;function qi(t,e,r,i){this._groups=t,this._parents=e,this._name=r,this._id=i}function Mb(t){return Vo().transition(t)}function Ff(){return++PN}var Xo=Vo.prototype;qi.prototype=Mb.prototype={constructor:qi,select:_b,selectAll:bb,selectChild:Xo.selectChild,selectChildren:Xo.selectChildren,filter:gb,merge:yb,selection:wb,transition:kb,call:Xo.call,nodes:Xo.nodes,node:Xo.node,size:Xo.size,empty:Xo.empty,each:Xo.each,on:vb,attr:ub,attrTween:fb,style:Sb,styleTween:Tb,text:Ab,textTween:Cb,remove:xb,tween:cb,delay:db,duration:hb,ease:pb,easeVarying:mb,end:Ib,[Symbol.iterator]:Xo[Symbol.iterator]};var s2=t=>+t;function Xl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var RN={time:null,delay:0,duration:250,ease:Xl};function NN(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function Pb(t){var e,r;t instanceof qi?(e=t._id,t=t._name):(e=Ff(),(r=RN).time=r2(),t=t==null?null:t+"");for(var i=this._groups,n=i.length,s=0;s<n;++s)for(var o=i[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&ja(l,t,e,c,o,r||NN(l,e));return new qi(i,this._parents,t,e)}Vo.prototype.interrupt=lb;Vo.prototype.transition=Pb;var o2=t=>()=>t;function N8(t,{sourceEvent:e,target:r,transform:i,dispatch:n}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:n}})}function Ls(t,e,r){this.k=t,this.x=e,this.y=r}Ls.prototype={constructor:Ls,scale:function(t){return t===1?this:new Ls(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Ls(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var cs=new Ls(1,0,0);D8.prototype=Ls.prototype;function D8(t){for(;!t.__zoom;)if(!(t=t.parentNode))return cs;return t.__zoom}function Of(t){t.stopImmediatePropagation()}function kc(t){t.preventDefault(),t.stopImmediatePropagation()}function DN(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function FN(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Rb(){return this.__zoom||cs}function ON(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function LN(){return navigator.maxTouchPoints||"ontouchstart"in this}function BN(t,e,r){var i=t.invertX(e[0][0])-r[0][0],n=t.invertX(e[1][0])-r[1][0],s=t.invertY(e[0][1])-r[0][1],o=t.invertY(e[1][1])-r[1][1];return t.translate(n>i?(i+n)/2:Math.min(0,i)||Math.max(0,n),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function Ic(){var t=DN,e=FN,r=BN,i=ON,n=LN,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,l=P8,c=fe("start","zoom","end"),u,d,h,p=500,m=150,g=0,y=10;function v(M){M.property("__zoom",Rb).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",k).on("dblclick.zoom",C).filter(n).on("touchstart.zoom",I).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",N).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(M,D,F,L){var B=M.selection?M.selection():M;B.property("__zoom",Rb),M!==B?w(M,D,F,L):B.interrupt().each(function(){E(this,arguments).event(L).start().zoom(null,typeof D=="function"?D.apply(this,arguments):D).end()})},v.scaleBy=function(M,D,F,L){v.scaleTo(M,function(){var B=this.__zoom.k,O=typeof D=="function"?D.apply(this,arguments):D;return B*O},F,L)},v.scaleTo=function(M,D,F,L){v.transform(M,function(){var B=e.apply(this,arguments),O=this.__zoom,R=F==null?b(B):typeof F=="function"?F.apply(this,arguments):F,U=O.invert(R),G=typeof D=="function"?D.apply(this,arguments):D;return r(_(x(O,G),R,U),B,o)},F,L)},v.translateBy=function(M,D,F,L){v.transform(M,function(){return r(this.__zoom.translate(typeof D=="function"?D.apply(this,arguments):D,typeof F=="function"?F.apply(this,arguments):F),e.apply(this,arguments),o)},null,L)},v.translateTo=function(M,D,F,L,B){v.transform(M,function(){var O=e.apply(this,arguments),R=this.__zoom,U=L==null?b(O):typeof L=="function"?L.apply(this,arguments):L;return r(cs.translate(U[0],U[1]).scale(R.k).translate(typeof D=="function"?-D.apply(this,arguments):-D,typeof F=="function"?-F.apply(this,arguments):-F),O,o)},L,B)};function x(M,D){return D=Math.max(s[0],Math.min(s[1],D)),D===M.k?M:new Ls(D,M.x,M.y)}function _(M,D,F){var L=D[0]-F[0]*M.k,B=D[1]-F[1]*M.k;return L===M.x&&B===M.y?M:new Ls(M.k,L,B)}function b(M){return[(+M[0][0]+ +M[1][0])/2,(+M[0][1]+ +M[1][1])/2]}function w(M,D,F,L){M.on("start.zoom",function(){E(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(L).end()}).tween("zoom",function(){var B=this,O=arguments,R=E(B,O).event(L),U=e.apply(B,O),G=F==null?b(U):typeof F=="function"?F.apply(B,O):F,$=Math.max(U[1][0]-U[0][0],U[1][1]-U[0][1]),q=B.__zoom,ie=typeof D=="function"?D.apply(B,O):D,Q=l(q.invert(G).concat($/q.k),ie.invert(G).concat($/ie.k));return function(re){if(re===1)re=ie;else{var ve=Q(re),de=$/ve[2];re=new Ls(de,G[0]-ve[0]*de,G[1]-ve[1]*de)}R.zoom(null,re)}})}function E(M,D,F){return!F&&M.__zooming||new A(M,D)}function A(M,D){this.that=M,this.args=D,this.active=0,this.sourceEvent=null,this.extent=e.apply(M,D),this.taps=0}A.prototype={event:function(M){return M&&(this.sourceEvent=M),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(M,D){return this.mouse&&M!=="mouse"&&(this.mouse[1]=D.invert(this.mouse[0])),this.touch0&&M!=="touch"&&(this.touch0[1]=D.invert(this.touch0[0])),this.touch1&&M!=="touch"&&(this.touch1[1]=D.invert(this.touch1[0])),this.that.__zoom=D,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(M){var D=H(this.that).datum();c.call(M,this.that,new N8(M,{sourceEvent:this.sourceEvent,target:v,type:M,transform:this.that.__zoom,dispatch:c}),D)}};function T(M,...D){if(!t.apply(this,arguments))return;var F=E(this,D).event(M),L=this.__zoom,B=Math.max(s[0],Math.min(s[1],L.k*Math.pow(2,i.apply(this,arguments)))),O=ls(M);if(F.wheel)(F.mouse[0][0]!==O[0]||F.mouse[0][1]!==O[1])&&(F.mouse[1]=L.invert(F.mouse[0]=O)),clearTimeout(F.wheel);else{if(L.k===B)return;F.mouse=[O,L.invert(O)],Va(this),F.start()}kc(M),F.wheel=setTimeout(R,m),F.zoom("mouse",r(_(x(L,B),F.mouse[0],F.mouse[1]),F.extent,o));function R(){F.wheel=null,F.end()}}function k(M,...D){if(h||!t.apply(this,arguments))return;var F=M.currentTarget,L=E(this,D,!0).event(M),B=H(M.view).on("mousemove.zoom",G,!0).on("mouseup.zoom",$,!0),O=ls(M,F),R=M.clientX,U=M.clientY;z4(M.view),Of(M),L.mouse=[O,this.__zoom.invert(O)],Va(this),L.start();function G(q){if(kc(q),!L.moved){var ie=q.clientX-R,Q=q.clientY-U;L.moved=ie*ie+Q*Q>g}L.event(q).zoom("mouse",r(_(L.that.__zoom,L.mouse[0]=ls(q,F),L.mouse[1]),L.extent,o))}function $(q){B.on("mousemove.zoom mouseup.zoom",null),H4(q.view,L.moved),kc(q),L.event(q).end()}}function C(M,...D){if(t.apply(this,arguments)){var F=this.__zoom,L=ls(M.changedTouches?M.changedTouches[0]:M,this),B=F.invert(L),O=F.k*(M.shiftKey?.5:2),R=r(_(x(F,O),L,B),e.apply(this,D),o);kc(M),a>0?H(this).transition().duration(a).call(w,R,L,M):H(this).call(v.transform,R,L,M)}}function I(M,...D){if(t.apply(this,arguments)){var F=M.touches,L=F.length,B=E(this,D,M.changedTouches.length===L).event(M),O,R,U,G;for(Of(M),R=0;R<L;++R)U=F[R],G=ls(U,this),G=[G,this.__zoom.invert(G),U.identifier],B.touch0?!B.touch1&&B.touch0[2]!==G[2]&&(B.touch1=G,B.taps=0):(B.touch0=G,O=!0,B.taps=1+!!u);u&&(u=clearTimeout(u)),O&&(B.taps<2&&(d=G[0],u=setTimeout(function(){u=null},p)),Va(this),B.start())}}function P(M,...D){if(this.__zooming){var F=E(this,D).event(M),L=M.changedTouches,B=L.length,O,R,U,G;for(kc(M),O=0;O<B;++O)R=L[O],U=ls(R,this),F.touch0&&F.touch0[2]===R.identifier?F.touch0[0]=U:F.touch1&&F.touch1[2]===R.identifier&&(F.touch1[0]=U);if(R=F.that.__zoom,F.touch1){var $=F.touch0[0],q=F.touch0[1],ie=F.touch1[0],Q=F.touch1[1],re=(re=ie[0]-$[0])*re+(re=ie[1]-$[1])*re,ve=(ve=Q[0]-q[0])*ve+(ve=Q[1]-q[1])*ve;R=x(R,Math.sqrt(re/ve)),U=[($[0]+ie[0])/2,($[1]+ie[1])/2],G=[(q[0]+Q[0])/2,(q[1]+Q[1])/2]}else if(F.touch0)U=F.touch0[0],G=F.touch0[1];else return;F.zoom("touch",r(_(R,U,G),F.extent,o))}}function N(M,...D){if(this.__zooming){var F=E(this,D).event(M),L=M.changedTouches,B=L.length,O,R;for(Of(M),h&&clearTimeout(h),h=setTimeout(function(){h=null},p),O=0;O<B;++O)R=L[O],F.touch0&&F.touch0[2]===R.identifier?delete F.touch0:F.touch1&&F.touch1[2]===R.identifier&&delete F.touch1;if(F.touch1&&!F.touch0&&(F.touch0=F.touch1,delete F.touch1),F.touch0)F.touch0[1]=this.__zoom.invert(F.touch0[0]);else if(F.end(),F.taps===2&&(R=ls(R,this),Math.hypot(d[0]-R[0],d[1]-R[1])<y)){var U=H(this).on("dblclick.zoom");U&&U.apply(this,arguments)}}}return v.wheelDelta=function(M){return arguments.length?(i=typeof M=="function"?M:o2(+M),v):i},v.filter=function(M){return arguments.length?(t=typeof M=="function"?M:o2(!!M),v):t},v.touchable=function(M){return arguments.length?(n=typeof M=="function"?M:o2(!!M),v):n},v.extent=function(M){return arguments.length?(e=typeof M=="function"?M:o2([[+M[0][0],+M[0][1]],[+M[1][0],+M[1][1]]]),v):e},v.scaleExtent=function(M){return arguments.length?(s[0]=+M[0],s[1]=+M[1],v):[s[0],s[1]]},v.translateExtent=function(M){return arguments.length?(o[0][0]=+M[0][0],o[1][0]=+M[1][0],o[0][1]=+M[0][1],o[1][1]=+M[1][1],v):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},v.constrain=function(M){return arguments.length?(r=M,v):r},v.duration=function(M){return arguments.length?(a=+M,v):a},v.interpolate=function(M){return arguments.length?(l=M,v):l},v.on=function(){var M=c.on.apply(c,arguments);return M===c?v:M},v.clickDistance=function(M){return arguments.length?(g=(M=+M)*M,v):Math.sqrt(g)},v.tapDistance=function(M){return arguments.length?(y=+M,v):y},v}var co=2*Math.PI,Lf=6356752314245179e-9,Bf=6378137;function F8(t){return t*(co*Bf/360)}function c2(t,e){return Math.abs(e)>=90?0:t*(co*Lf/360)*Math.abs(Math.cos(e*(Math.PI/180)))}function uo(t){return t/(co*Bf/360)}function fi(t,e){return Math.abs(e)>=90?0:t/(co*Lf/360)/Math.abs(Math.cos(e*(Math.PI/180)))}function Uf(t,e){return e=e||256,[t[0]*e/(co*Lf),-t[1]*e/(co*Bf)]}function Gf(t,e){return e=e||256,[t[0]*co*Lf/e,-t[1]*co*Bf/e]}function Tt(t,e){let r=c2(t[0]-e[0],(t[1]+e[1])/2),i=F8(t[1]-e[1]);return Math.sqrt(r*r+i*i)}function xn(t,e){e=e||256;let r=Math.log(e)*Math.LOG2E;return Math.log(t*co)/Math.LN2-r}function di(t,e){return e=e||256,e*Math.pow(2,t)/co}function zf(t,e){let r=1/0,i;for(let n=0;n<t.length;n++){let s=Tt(t[n],e);s<r&&(r=s,i=n)}return i!==void 0?{index:i,distance:r,point:t[i]}:null}var le=class{constructor(t,e){this.min=[1/0,1/0],this.max=[-1/0,-1/0];let r;t instanceof le?(r=t.min,e=t.max):r=t,r&&r.length===2&&(this.min[0]=r[0],this.min[1]=r[1],e||(e=r)),e&&e.length===2&&(this.max[0]=e[0],this.max[1]=e[1])}equals(t){return this.min[0]===t.min[0]&&this.min[1]===t.min[1]&&this.max[0]===t.max[0]&&this.max[1]===t.max[1]}area(){return Math.abs((this.max[0]-this.min[0])*(this.max[1]-this.min[1]))}center(){return[(this.min[0]+this.max[0])/2,(this.min[1]+this.max[1])/2]}rectangle(){return[this.min[0],this.min[1],this.max[0],this.max[1]]}toParam(){return this.rectangle().join(",")}bbox(){return{minX:this.min[0],minY:this.min[1],maxX:this.max[0],maxY:this.max[1]}}polygon(){return[[this.min[0],this.min[1]],[this.min[0],this.max[1]],[this.max[0],this.max[1]],[this.max[0],this.min[1]],[this.min[0],this.min[1]]]}contains(t){return t.min[0]>=this.min[0]&&t.min[1]>=this.min[1]&&t.max[0]<=this.max[0]&&t.max[1]<=this.max[1]}intersects(t){return t.min[0]<=this.max[0]&&t.min[1]<=this.max[1]&&t.max[0]>=this.min[0]&&t.max[1]>=this.min[1]}intersection(t){return this.intersects(t)?new le([Math.max(t.min[0],this.min[0]),Math.max(t.min[1],this.min[1])],[Math.min(t.max[0],this.max[0]),Math.min(t.max[1],this.max[1])]):new le}percentContainedIn(t){let e=this.intersection(t).area(),r=this.area();return e===1/0||r===1/0?0:e===0||r===0?t.contains(this)?1:0:e/r}extend(t){return new le([Math.min(t.min[0],this.min[0]),Math.min(t.min[1],this.min[1])],[Math.max(t.max[0],this.max[0]),Math.max(t.max[1],this.max[1])])}padByMeters(t){let e=uo(t),r=fi(t,this.center()[1]);return new le([this.min[0]-r,this.min[1]-e],[this.max[0]+r,this.max[1]+e])}};function pt(t,e,r){return r?Math.abs(t[0]-e[0])<=r&&Math.abs(t[1]-e[1])<=r:t[0]===e[0]&&t[1]===e[1]}function Ot(t,e){return[t[0]+e[0],t[1]+e[1]]}function St(t,e){return[t[0]-e[0],t[1]-e[1]]}function Yi(t,e){return[t[0]*e,t[1]*e]}function Ct(t,e,r){return[t[0]+(e[0]-t[0])*r,t[1]+(e[1]-t[1])*r]}function ut(t,e){e=e||[0,0];let r=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(r*r+i*i)}function O8(t,e=[0,0]){return(t[0]-e[0])**2+(t[1]-e[1])**2}function Mc(t){let e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return e!==0?Yi(t,1/e):[0,0]}function vr(t,e){return Math.atan2(e[1]-t[1],e[0]-t[0])}function us(t,e,r){r=r||[0,0];let i=St(t,r),n=St(e,r);return i[0]*n[0]+i[1]*n[1]}function Hf(t,e,r){r=r||[0,0];let i=Mc(St(t,r)),n=Mc(St(e,r));return us(i,n)}function l2(t,e,r){r=r||[0,0];let i=St(t,r),n=St(e,r);return i[0]*n[1]-i[1]*n[0]}function Db(t,e){let r=1/0,i,n;for(let s=0;s<e.length-1;s++){let o=e[s],a=St(e[s+1],o),l=St(t,o),c=us(l,a)/us(a,a),u;c<0?u=o:c>1?u=e[s+1]:u=[o[0]+c*a[0],o[1]+c*a[1]];let d=ut(u,t);d<r&&(r=d,i=s+1,n=u)}return i!==void 0&&n!==void 0?{index:i,distance:r,target:n}:null}function Fb(t,e){return t[0]===e[0]&&t[1]===e[1]||t[0]===e[1]&&t[1]===e[0]}function Wo(t,e,r){return t.map(i=>{let n=St(i,r);return[n[0]*Math.cos(e)-n[1]*Math.sin(e)+r[0],n[0]*Math.sin(e)+n[1]*Math.cos(e)+r[1]]})}function qo(t,e){if(t.length!==2||e.length!==2)return null;let r=[t[0][0],t[0][1]],i=[t[1][0],t[1][1]],n=[e[0][0],e[0][1]],s=[e[1][0],e[1][1]],o=St(i,r),a=St(s,n),l=l2(St(n,r),o),c=l2(o,a);if(l&&c){let u=l/c,d=l2(St(n,r),a)/c;if(d>=0&&d<=1&&u>=0&&u<=1)return Ct(r,i,d)}return null}function $f(t,e){let r=[];for(let i=0;i<t.length-1;i++)for(let n=0;n<e.length-1;n++){let s=[t[i],t[i+1]],o=[e[n],e[n+1]],a=qo(s,o);a&&r.push(a)}return r}function UN(t,e){for(let r=0;r<t.length-1;r++)for(let i=0;i<e.length-1;i++){let n=[t[r],t[r+1]],s=[e[i],e[i+1]];if(qo(n,s))return!0}return!1}function Pc(t,e){let r=t[0],i=t[1],n=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){let a=e[s][0],l=e[s][1],c=e[o][0],u=e[o][1];l>i!=u>i&&r<(c-a)*(i-l)/(u-l)+a&&(n=!n)}return n}function jf(t,e){return e.every(r=>Pc(r,t))}function Vf(t,e,r){function i(n,s){return s.some(o=>Pc(o,n))}return i(t,e)||!!r&&UN(t,e)}function Rc(t){let e=Ds(t);if(!e)return null;let r=yn(e),i=1/0,n=new le,s=0,o=e[0];for(let a=0;a<=e.length-1;a++){let l=a===e.length-1?e[0]:e[a+1],c=Math.atan2(l[1]-o[1],l[0]-o[0]),d=Wo(e,-c,r).reduce((p,m)=>(p.min[0]=Math.min(p.min[0],m[0]),p.min[1]=Math.min(p.min[1],m[1]),p.max[0]=Math.max(p.max[0],m[0]),p.max[1]=Math.max(p.max[1],m[1]),p),new le),h=d.area();h<i&&(i=h,n=d,s=c),o=l}return{poly:Wo(n.polygon(),s,r),angle:s}}function L8(t){let e=0;for(let r=0;r<t.length-1;r++)e+=ut(t[r],t[r+1]);return e}function Xf(t,e){let r=[80,20,50,20],i=0,n=0;return t[0]>e[0]-r[1]&&(i=-10),t[0]<r[3]&&(i=10),t[1]>e[1]-r[2]&&(n=-10),t[1]<r[0]&&(n=10),i||n?[i,n]:null}var Qi=class{constructor(t,e,r){this._proj=_c,this._dimensions=[[0,0],[0,0]],this._x=t||0,this._y=e||0,this._k=r||256/Math.PI}project(t){return t=this._proj(t[0]*Math.PI/180,t[1]*Math.PI/180),[t[0]*this._k+this._x,this._y-t[1]*this._k]}invert(t){return t=this._proj.invert((t[0]-this._x)/this._k,(this._y-t[1])/this._k),[t[0]*180/Math.PI,t[1]*180/Math.PI]}scale(t){return t===void 0?this._k:(this._k=+t,this)}translate(t){return t===void 0?[this._x,this._y]:(this._x=+t[0],this._y=+t[1],this)}dimensions(t){return t===void 0?this._dimensions:(this._dimensions=t,this)}transform(t){return t===void 0?cs.translate(this._x,this._y).scale(this._k):(this._x=+t.x,this._y=+t.y,this._k=+t.k,this)}getStream(){let t=this;return x8({point:function(e,r){let i=t.project([e,r]);this.stream.point(i[0],i[1])}}).stream}};function a2(t,e,r){return Math.max(e,Math.min(t,r))}function Nb(t,e){return Array.from(Array(1+e-t).keys()).map(r=>t+r)}var Pr=class{constructor(){this._tileSize=256,this._zoomRange=[0,24],this._margin=0,this._skipNullIsland=!1}getTiles(t){let e=t.dimensions(),r=t.translate(),i=t.scale(),n=xn(i,this._tileSize),s=a2(Math.round(n),this._zoomRange[0],this._zoomRange[1]),o=0,a=Math.pow(2,s)-1,l=Math.log(this._tileSize)*Math.LOG2E,c=Math.pow(2,n-s+l),u=[i*Math.PI-r[0],i*Math.PI-r[1]],d=[u[0]+e[0][0],u[1]+e[0][1]],h=[u[0]+e[1][0],u[1]+e[1][1]],p=new le(d,h),m=Math.pow(2,s)/2*this._tileSize,g=di(s,this._tileSize),y=new Qi(m,m,g),v=Nb(a2(Math.floor(d[0]/c)-this._margin,o,a),a2(Math.floor(h[0]/c)+this._margin,o,a)),x=Nb(a2(Math.floor(d[1]/c)-this._margin,o,a),a2(Math.floor(h[1]/c)+this._margin,o,a)),_=[];for(let b=0;b<x.length;b++){let w=x[b];for(let E=0;E<v.length;E++){let A=v[E],T=[A,w,s];if(this._skipNullIsland&&Pr.isNearNullIsland(A,w,s))continue;let k=[A*this._tileSize,w*this._tileSize],C=[(A+1)*this._tileSize,(w+1)*this._tileSize],I=new le(k,C),P=p.intersects(I),N=y.invert([k[0],C[1]]),M=y.invert([C[0],k[1]]),D={id:T.toString(),xyz:T,pxExtent:new le(k,C),wgs84Extent:new le(N,M),isVisible:P};P?_.unshift(D):_.push(D)}}return{tiles:_}}getGeoJSON(t){return{type:"FeatureCollection",features:t.tiles.map(r=>({type:"Feature",properties:{id:r.id,name:r.id},geometry:{type:"Polygon",coordinates:[r.wgs84Extent.polygon()]}}))}}tileSize(t){return t===void 0?this._tileSize:(this._tileSize=t,this)}zoomRange(t,e){return t===void 0?this._zoomRange:(e===void 0&&(e=t),this._zoomRange=[t,e],this)}margin(t){return t===void 0?this._margin:(this._margin=+t,this)}skipNullIsland(t){return t===void 0?this._skipNullIsland:(this._skipNullIsland=t,this)}static isNearNullIsland(t,e,r){if(r>=7){let i=Math.pow(2,r-1),n=Math.pow(2,r-6),s=i-n/2,o=i+n/2-1;return t>=s&&t<=o&&e>=s&&e<=o}return!1}};var zN=0;function Te(t){if(!(this instanceof Te))return t&&t.type?Te[t.type].apply(this,arguments):t&&t.id?Te[Te.id.type(t.id)].apply(this,arguments):new Te().initialize(arguments)}Te.id=function(t){return Te.id.fromOSM(t,Te.id.next[t]--)};Te.id.next={changeset:-1,node:-1,way:-1,relation:-1};Te.id.fromOSM=function(t,e){return t[0]+e};Te.id.toOSM=function(t){return t.slice(1)};Te.id.type=function(t){return{c:"changeset",n:"node",w:"way",r:"relation"}[t[0]]};Te.key=function(t){return t.id+"v"+(t.v||0)};var Nc;Te.deprecatedTagValuesByKey=function(t){return Nc||(Nc={},t.forEach(function(e){var r=Object.keys(e.old);if(r.length===1){var i=r[0],n=e.old[i];n!=="*"&&(Nc[i]?Nc[i].push(n):Nc[i]=[n])}})),Nc};Te.prototype={tags:{},initialize:function(t){for(var e=0;e<t.length;++e){var r=t[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(r[i]===void 0?delete this[i]:this[i]=r[i])}return!this.id&&this.type&&(this.id=Te.id(this.type)),this.hasOwnProperty("visible")||(this.visible=!0),this},copy:function(t,e){if(e[this.id])return e[this.id];var r=Te(this,{id:void 0,user:void 0,version:void 0,v:void 0});return e[this.id]=r,r},osmId:function(){return Te.id.toOSM(this.id)},isNew:function(){return this.osmId()<0},update:function(t){return Te(this,t).touch()},touch:function(){return this.v=zN++,this},mergeTags:function(t){var e=Object.assign({},this.tags),r=!1;for(var i in t){var n=e[i],s=t[i];if(!n)r=!0,e[i]=s;else if(i==="building"){if(s==="yes")continue;n==="yes"&&(r=!0,e[i]=s)}else n!==s&&(r=!0,e[i]=$5(jt(n.split(/;\s*/),s.split(/;\s*/)).join(";"),255))}return r?this.update({tags:e}):this},intersects:function(t,e){return this.extent(e).intersects(t)},hasNonGeometryTags:function(){return Object.keys(this.tags).some(function(t){return t!=="area"})},hasParentRelations:function(t){return t.parentRelations(this).length>0},hasInterestingTags:function(){return Object.keys(this.tags).some($i)},isHighwayIntersection:function(){return!1},isDegenerate:function(){return!0},deprecatedTags:function(t){var e=this.tags;if(Object.keys(e).length===0)return[];var r=[];return t.forEach(function(i){var n=Object.keys(i.old);if(i.replace){var s=Object.keys(i.replace).some(function(a){if(!e[a]||i.old[a])return!1;var l=i.replace[a];return!(l==="*"||l===e[a])});if(s)return}var o=n.every(function(a){if(!e[a])return!1;if(i.old[a]==="*"||i.old[a]===e[a])return!0;var l=e[a].split(";").filter(Boolean);if(l.length===0)return!1;if(l.length>1)return l.indexOf(i.old[a])!==-1;if(e[a]===i.old[a])if(i.replace&&i.old[a]===i.replace[a]){var c=Object.keys(i.replace);return!c.every(function(u){return e[u]===i.replace[u]})}else return!0;return!1});o&&r.push(i)}),r}};function Wf(t){if(t.type!=="way"||!t.tags.highway)return null;var e=t.tags,r=t.isOneWay(),i=HN(e,r),n=$N(e),s=jN(e,r,i),o=s.forward,a=s.backward,l=s.bothways,c={};c.unspecified=B8(e["turn:lanes"]),c.forward=B8(e["turn:lanes:forward"]),c.backward=B8(e["turn:lanes:backward"]);var u={};u.unspecified=U8(e["maxspeed:lanes"],n),u.forward=U8(e["maxspeed:lanes:forward"],n),u.backward=U8(e["maxspeed:lanes:backward"],n);var d={};d.unspecified=Ki(e["psv:lanes"]),d.forward=Ki(e["psv:lanes:forward"]),d.backward=Ki(e["psv:lanes:backward"]);var h={};h.unspecified=Ki(e["bus:lanes"]),h.forward=Ki(e["bus:lanes:forward"]),h.backward=Ki(e["bus:lanes:backward"]);var p={};p.unspecified=Ki(e["taxi:lanes"]),p.forward=Ki(e["taxi:lanes:forward"]),p.backward=Ki(e["taxi:lanes:backward"]);var m={};m.unspecified=Ki(e["hov:lanes"]),m.forward=Ki(e["hov:lanes:forward"]),m.backward=Ki(e["hov:lanes:backward"]);var g={};g.unspecified=Ki(e["hgv:lanes"]),g.forward=Ki(e["hgv:lanes:forward"]),g.backward=Ki(e["hgv:lanes:backward"]);var y={};y.unspecified=G8(e["bicycleway:lanes"]),y.forward=G8(e["bicycleway:lanes:forward"]),y.backward=G8(e["bicycleway:lanes:backward"]);var v={forward:[],backward:[],unspecified:[]};return Xa(v,c,"turnLane"),Xa(v,u,"maxspeed"),Xa(v,d,"psv"),Xa(v,h,"bus"),Xa(v,p,"taxi"),Xa(v,m,"hov"),Xa(v,g,"hgv"),Xa(v,y,"bicycleway"),{metadata:{count:i,oneway:r,forward:o,backward:a,bothways:l,turnLanes:c,maxspeed:n,maxspeedLanes:u,psvLanes:d,busLanes:h,taxiLanes:p,hovLanes:m,hgvLanes:g,bicyclewayLanes:y},lanes:v}}function HN(t,e){var r;if(t.lanes&&(r=parseInt(t.lanes,10),r>0))return r;switch(t.highway){case"trunk":case"motorway":r=e?2:4;break;default:r=e?1:2;break}return r}function $N(t){var e=t.maxspeed;if(e){var r=/^([0-9][\.0-9]+?)(?:[ ]?(?:km\/h|kmh|kph|mph|knots))?$/;if(r.test(e))return parseInt(e,10)}}function jN(t,e,r){var i=parseInt(t["lanes:forward"],10),n=parseInt(t["lanes:backward"],10),s=parseInt(t["lanes:both_ways"],10)>0?1:0;return parseInt(t.oneway,10)===-1?(i=0,s=0,n=r):e?(i=r,s=0,n=0):isNaN(i)&&isNaN(n)?(n=Math.floor((r-s)/2),i=r-s-n):isNaN(i)?(n>r-s&&(n=r-s),i=r-s-n):isNaN(n)&&(i>r-s&&(i=r-s),n=r-s-i),{forward:i,backward:n,bothways:s}}function B8(t){if(t){var e=["left","slight_left","sharp_left","through","right","slight_right","sharp_right","reverse","merge_to_left","merge_to_right","none"];return t.split("|").map(function(r){return r===""&&(r="none"),r.split(";").map(function(i){return e.indexOf(i)===-1?"unknown":i})})}}function U8(t,e){if(t)return t.split("|").map(function(r){if(r==="none")return r;var i=parseInt(r,10);return r===""||i===e?null:isNaN(i)?"unknown":i})}function Ki(t){if(t){var e=["yes","no","designated"];return t.split("|").map(function(r){return r===""&&(r="no"),e.indexOf(r)===-1?"unknown":r})}}function G8(t){if(t){var e=["yes","no","designated","lane"];return t.split("|").map(function(r){return r===""&&(r="no"),e.indexOf(r)===-1?"unknown":r})}}function Xa(t,e,r){e.forward&&e.forward.forEach(function(i,n){t.forward[n]||(t.forward[n]={}),t.forward[n][r]=i}),e.backward&&e.backward.forEach(function(i,n){t.backward[n]||(t.backward[n]={}),t.backward[n][r]=i}),e.unspecified&&e.unspecified.forEach(function(i,n){t.unspecified[n]||(t.unspecified[n]={}),t.unspecified[n][r]=i})}var yt;function Rr(t){if(yt&&!t)return yt;yt={};let e=navigator.userAgent,r=null;r=e.match(/(edg)\/?\s*(\.?\d+(\.\d+)*)/i),r!==null&&(yt.browser="Edge",yt.version=r[2]),yt.browser||(r=e.match(/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/i),r!==null&&(yt.browser="msie",yt.version=r[1])),yt.browser||(r=e.match(/(opr)\/?\s*(\.?\d+(\.\d+)*)/i),r!==null&&(yt.browser="Opera",yt.version=r[2])),yt.browser||(r=e.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i),r!==null&&(yt.browser=r[1],yt.version=r[2],r=e.match(/version\/([\.\d]+)/i),r!==null&&(yt.version=r[1]))),yt.browser||(yt.browser=navigator.appName,yt.version=navigator.appVersion),yt.version=yt.version.split(/\W/).slice(0,2).join("."),yt.opera=yt.browser.toLowerCase()==="opera"&&parseFloat(yt.version)<15,yt.browser.toLowerCase()==="msie"?yt.support=!1:yt.support=!0,yt.filedrop=window.FileReader&&"ondrop"in window,yt.download=!(yt.ie||yt.browser.toLowerCase()==="edge"),yt.cssfilters=!(yt.ie||yt.browser.toLowerCase()==="edge"),/Win/.test(e)?(yt.os="win",yt.platform="Windows"):/Mac/.test(e)?(yt.os="mac",yt.platform="Macintosh"):/X11/.test(e)||/Linux/.test(e)?(yt.os="linux",yt.platform="Linux"):(yt.os="win",yt.platform="Unknown"),yt.isMobileWebKit=(/\b(iPad|iPhone|iPod)\b/.test(e)||navigator.platform==="MacIntel"&&"maxTouchPoints"in navigator&&navigator.maxTouchPoints>1)&&/WebKit/.test(e)&&!/Edge/.test(e)&&!window.MSStream,yt.browserLocales=Array.from(new Set([navigator.language].concat(navigator.languages||[]).concat([navigator.userLanguage]).filter(Boolean)));let i=window.top.location,n=i.origin;return n||(n=i.protocol+"//"+i.hostname+(i.port?":"+i.port:"")),yt.host=n+i.pathname,yt}var Dc;try{Dc=localStorage}catch{}Dc=Dc||(()=>{let t={};return{getItem:e=>t[e],setItem:(e,r)=>t[e]=r,removeItem:e=>delete t[e]}})();function ee(t,e){try{return arguments.length===1?Dc.getItem(t):(e===null?Dc.removeItem(t):Dc.setItem(t,e),!0)}catch{return typeof console<"u"&&console.error("localStorage quota exceeded"),!1}}var Qe=z8();function z8(){let t={},e={},r={address_formats:"data/address_formats.min.json",deprecated:"https://cdn.jsdelivr.net/npm/@openstreetmap/id-tagging-schema@6.0/dist/deprecated.min.json",discarded:"https://cdn.jsdelivr.net/npm/@openstreetmap/id-tagging-schema@6.0/dist/discarded.min.json",imagery:"data/imagery.min.json",intro_graph:"data/intro_graph.min.json",intro_rapid_graph:"data/intro_rapid_graph.min.json",keepRight:"data/keepRight.min.json",languages:"data/languages.min.json",locales:"locales/index.min.json",oci_defaults:"https://cdn.jsdelivr.net/npm/osm-community-index@5.3/dist/defaults.min.json",oci_features:"https://cdn.jsdelivr.net/npm/osm-community-index@5.3/dist/featureCollection.min.json",oci_resources:"https://cdn.jsdelivr.net/npm/osm-community-index@5.3/dist/resources.min.json",preset_categories:"https://cdn.jsdelivr.net/npm/@openstreetmap/id-tagging-schema@6.0/dist/preset_categories.min.json",preset_defaults:"https://cdn.jsdelivr.net/npm/@openstreetmap/id-tagging-schema@6.0/dist/preset_defaults.min.json",preset_fields:"https://cdn.jsdelivr.net/npm/@openstreetmap/id-tagging-schema@6.0/dist/fields.min.json",preset_presets:"https://cdn.jsdelivr.net/npm/@openstreetmap/id-tagging-schema@6.0/dist/presets.min.json",phone_formats:"data/phone_formats.min.json",qa_data:"data/qa_data.min.json",shortcuts:"data/shortcuts.min.json",territory_languages:"data/territory_languages.min.json",wmf_sitematrix:"https://cdn.jsdelivr.net/npm/wmf-sitematrix@0.1/wikipedia.min.json"},i={};t.cache=()=>i,t.get=o=>{if(i[o])return Promise.resolve(i[o]);let a=r[o],l=a&&t.asset(a);if(!l)return Promise.reject(`Unknown data file for "${o}"`);let c=e[l];return c||(e[l]=c=fetch(l).then(u=>{if(!u.ok&&u.status!==0||!u.json)throw new Error(u.status+" "+u.statusText);if(!(u.status===204||u.status===205))return u.json()}).then(u=>{if(delete e[l],!u)throw new Error(`No data loaded for "${o}"`);return i[o]=u,u}).catch(u=>{throw delete e[l],u})),c},t.fileMap=function(o){return arguments.length?(r=o,t):r};let n="";t.assetPath=function(o){return arguments.length?(n=o,t):n};let s={};return t.assetMap=function(o){return arguments.length?(s=o,t):s},t.asset=o=>{if(/^http(s)?:\/\//i.test(o))return o;let a=n+o;return s[a]||a},t}var he={};F5(he,{BaseTextureCache:()=>rn,BoundingBox:()=>Vc,CanvasRenderTarget:()=>ld,DATA_URI:()=>od,EventEmitter:()=>xr.default,ProgramCache:()=>w2,TextureCache:()=>bi,clearTextureCache:()=>Fw,correctBlendMode:()=>Aw,createIndicesForQuads:()=>Mw,decomposeDataUri:()=>Uw,deprecation:()=>ht,destroyTextureCache:()=>Dw,determineCrossOrigin:()=>fd,earcut:()=>Gw.default,getBufferType:()=>qa,getCanvasBoundingBox:()=>cd,getResolutionOfUrl:()=>E2,hex2rgb:()=>ww,hex2string:()=>Ew,interleaveTypedArrays:()=>Pw,isMobile:()=>fs,isPow2:()=>_2,isWebGLSupported:()=>td,log2:()=>b2,nextPow2:()=>Ya,path:()=>rp,premultiplyBlendMode:()=>x2,premultiplyRgba:()=>Cw,premultiplyTint:()=>kw,premultiplyTintToRgba:()=>Iw,removeItems:()=>ad,rgb2hex:()=>Tw,sayHello:()=>fw,sign:()=>Rw,skipHello:()=>uw,string2hex:()=>Sw,trimCanvas:()=>Bw,uid:()=>ho,url:()=>ed});var H8={createCanvas:(t,e)=>{let r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};var ue={ADAPTER:H8,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var $8=/iPhone/i,Ob=/iPod/i,Lb=/iPad/i,Bb=/\biOS-universal(?:.+)Mac\b/i,j8=/\bAndroid(?:.+)Mobile\b/i,Ub=/Android/i,Fc=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,qf=/Silk/i,Yo=/Windows Phone/i,Gb=/\bWindows(?:.+)ARM\b/i,zb=/BlackBerry/i,Hb=/BB10/i,$b=/Opera Mini/i,jb=/\b(CriOS|Chrome)(?:.+)Mobile/i,Vb=/Mobile(?:.+)Firefox\b/i,Xb=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function VN(t){return function(e){return e.test(t)}}function Wa(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var r=e.userAgent,i=r.split("[FBAN");typeof i[1]<"u"&&(r=i[0]),i=r.split("Twitter"),typeof i[1]<"u"&&(r=i[0]);var n=VN(r),s={apple:{phone:n($8)&&!n(Yo),ipod:n(Ob),tablet:!n($8)&&(n(Lb)||Xb(e))&&!n(Yo),universal:n(Bb),device:(n($8)||n(Ob)||n(Lb)||n(Bb)||Xb(e))&&!n(Yo)},amazon:{phone:n(Fc),tablet:!n(Fc)&&n(qf),device:n(Fc)||n(qf)},android:{phone:!n(Yo)&&n(Fc)||!n(Yo)&&n(j8),tablet:!n(Yo)&&!n(Fc)&&!n(j8)&&(n(qf)||n(Ub)),device:!n(Yo)&&(n(Fc)||n(qf)||n(j8)||n(Ub))||n(/\bokhttp\b/i)},windows:{phone:n(Yo),tablet:n(Gb),device:n(Yo)||n(Gb)},other:{blackberry:n(zb),blackberry10:n(Hb),opera:n($b),firefox:n(Vb),chrome:n(jb),device:n(zb)||n(Hb)||n($b)||n(Vb)||n(jb)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}var XN=Wa.default??Wa,fs=XN(globalThis.navigator);ue.RETINA_PREFIX=/@([0-9\.]+)x/;ue.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var xr=dt(X8(),1),Gw=dt(K8(),1);var zc=dt(tp(),1),ed={parse:zc.parse,format:zc.format,resolve:zc.resolve};function Bs(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function y2(t){return t.split("?")[0].split("#")[0]}function ED(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function SD(t,e,r){return t.replace(new RegExp(ED(e),"g"),r)}function TD(t,e){let r="",i=0,n=-1,s=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||s===1))if(n!==a-1&&s===2){if(r.length<2||i!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){let l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",i=0):(r=r.slice(0,l),i=r.length-1-r.lastIndexOf("/")),n=a,s=0;continue}}else if(r.length===2||r.length===1){r="",i=0,n=a,s=0;continue}}e&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+=`/${t.slice(n+1,a)}`:r=t.slice(n+1,a),i=a-n-1;n=a,s=0}else o===46&&s!==-1?++s:s=-1}return r}var rp={toPosix(t){return SD(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},hasProtocol(t){return/^[^/:]+:\//.test(this.toPosix(t))},getProtocol(t){Bs(t),t=this.toPosix(t);let e="",r=/^file:\/\/\//.exec(t),i=/^[^/:]+:\/\//.exec(t),n=/^[^/:]+:\//.exec(t);if(r||i||n){let s=r?.[0]||i?.[0]||n?.[0];e=s,t=t.slice(s.length)}return e},toAbsolute(t,e,r){if(this.isDataUrl(t))return t;let i=y2(this.toPosix(e??ue.ADAPTER.getBaseUrl())),n=y2(this.toPosix(r??this.rootname(i)));return Bs(t),t=this.toPosix(t),t.startsWith("/")?rp.join(n,t.slice(1)):this.isAbsolute(t)?t:this.join(i,t)},normalize(t){if(t=this.toPosix(t),Bs(t),t.length===0)return".";let e="",r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));let i=t.endsWith("/");return t=TD(t,!1),t.length>0&&i&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return Bs(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){let i=t[r];if(Bs(i),i.length>0)if(e===void 0)e=i;else{let n=t[r-1]??"";this.extname(n)?e+=`/../${i}`:e+=`/${i}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(Bs(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0),r=e===47,i=-1,n=!0,s=this.getProtocol(t),o=t;t=t.slice(s.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!n){i=a;break}}else n=!1;return i===-1?r?"/":this.isUrl(o)?s+t:s:r&&i===1?"//":s+t.slice(0,i)},rootname(t){Bs(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){let r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Bs(t),e&&Bs(e),t=y2(this.toPosix(t));let r=0,i=-1,n=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(s=t.length-1;s>=0;--s){let l=t.charCodeAt(s);if(l===47){if(!n){r=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return r===i?i=a:i===-1&&(i=t.length),t.slice(r,i)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!n){r=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":t.slice(r,i)},extname(t){Bs(t),t=y2(this.toPosix(t));let e=-1,r=0,i=-1,n=!0,s=0;for(let o=t.length-1;o>=0;--o){let a=t.charCodeAt(o);if(a===47){if(!n){r=o+1;break}continue}i===-1&&(n=!1,i=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===r+1?"":t.slice(e,i)},parse(t){Bs(t);let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=y2(this.toPosix(t));let r=t.charCodeAt(0),i=this.isAbsolute(t),n,s="";e.root=this.rootname(t),i||this.hasProtocol(t)?n=1:n=0;let o=-1,a=0,l=-1,c=!0,u=t.length-1,d=0;for(;u>=n;--u){if(r=t.charCodeAt(u),r===47){if(!c){a=u+1;break}continue}l===-1&&(c=!1,l=u+1),r===46?o===-1?o=u:d!==1&&(d=1):o!==-1&&(d=-1)}return o===-1||l===-1||d===0||d===1&&o===l-1&&o===a+1?l!==-1&&(a===0&&i?e.base=e.name=t.slice(1,l):e.base=e.name=t.slice(a,l)):(a===0&&i?(e.name=t.slice(1,o),e.base=t.slice(1,l)):(e.name=t.slice(a,o),e.base=t.slice(a,l)),e.ext=t.slice(o,l)),e.dir=this.dirname(t),s&&(e.dir=s+e.dir),e},sep:"/",delimiter:":"};var cw={};function ht(t,e,r=3){if(cw[e])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(i=i.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(i))),cw[e]=!0}function uw(){ht("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function fw(){ht("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}var ip;function td(){return typeof ip>"u"&&(ip=function(){let e={stencil:!0,failIfMajorPerformanceCaveat:ue.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!ue.ADAPTER.getWebGLRenderingContext())return!1;let r=ue.ADAPTER.createCanvas(),i=r.getContext("webgl",e)||r.getContext("experimental-webgl",e),n=!!i?.getContextAttributes()?.stencil;if(i){let s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,n}catch{return!1}}()),ip}var AD={grad:.9,turn:360,rad:360/(2*Math.PI)},Qo=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},_i=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},hs=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},xw=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},dw=function(t){return{r:hs(t.r,0,255),g:hs(t.g,0,255),b:hs(t.b,0,255),a:hs(t.a)}},np=function(t){return{r:_i(t.r),g:_i(t.g),b:_i(t.b),a:_i(t.a,3)}},CD=/^#([0-9a-f]{3,8})$/i,rd=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},_w=function(t){var e=t.r,r=t.g,i=t.b,n=t.a,s=Math.max(e,r,i),o=s-Math.min(e,r,i),a=o?s===e?(r-i)/o:s===r?2+(i-e)/o:4+(e-r)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:n}},bw=function(t){var e=t.h,r=t.s,i=t.v,n=t.a;e=e/360*6,r/=100,i/=100;var s=Math.floor(e),o=i*(1-r),a=i*(1-(e-s)*r),l=i*(1-(1-e+s)*r),c=s%6;return{r:255*[i,a,o,o,l,i][c],g:255*[l,i,i,a,o,o][c],b:255*[o,o,l,i,i,a][c],a:n}},hw=function(t){return{h:xw(t.h),s:hs(t.s,0,100),l:hs(t.l,0,100),a:hs(t.a)}},pw=function(t){return{h:_i(t.h),s:_i(t.s),l:_i(t.l),a:_i(t.a,3)}},mw=function(t){return bw((r=(e=t).s,{h:e.h,s:(r*=((i=e.l)<50?i:100-i)/100)>0?2*r/(i+r)*100:0,v:i+r,a:e.a}));var e,r,i},v2=function(t){return{h:(e=_w(t)).h,s:(n=(200-(r=e.s))*(i=e.v)/100)>0&&n<200?r*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:e.a};var e,r,i,n},kD=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ID=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,MD=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,PD=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ap={string:[[function(t){var e=CD.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?_i(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?_i(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=MD.exec(t)||PD.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:dw({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=kD.exec(t)||ID.exec(t);if(!e)return null;var r,i,n=hw({h:(r=e[1],i=e[2],i===void 0&&(i="deg"),Number(r)*(AD[i]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return mw(n)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,i=t.b,n=t.a,s=n===void 0?1:n;return Qo(e)&&Qo(r)&&Qo(i)?dw({r:Number(e),g:Number(r),b:Number(i),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,r=t.s,i=t.l,n=t.a,s=n===void 0?1:n;if(!Qo(e)||!Qo(r)||!Qo(i))return null;var o=hw({h:Number(e),s:Number(r),l:Number(i),a:Number(s)});return mw(o)},"hsl"],[function(t){var e=t.h,r=t.s,i=t.v,n=t.a,s=n===void 0?1:n;if(!Qo(e)||!Qo(r)||!Qo(i))return null;var o=function(a){return{h:xw(a.h),s:hs(a.s,0,100),v:hs(a.v,0,100),a:hs(a.a)}}({h:Number(e),s:Number(r),v:Number(i),a:Number(s)});return bw(o)},"hsv"]]},gw=function(t,e){for(var r=0;r<e.length;r++){var i=e[r][0](t);if(i)return[i,e[r][1]]}return[null,void 0]},RD=function(t){return typeof t=="string"?gw(t.trim(),ap.string):typeof t=="object"&&t!==null?gw(t,ap.object):[null,void 0]};var sp=function(t,e){var r=v2(t);return{h:r.h,s:hs(r.s+100*e,0,100),l:r.l,a:r.a}},op=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},yw=function(t,e){var r=v2(t);return{h:r.h,s:r.s,l:hs(r.l+100*e,0,100),a:r.a}},lp=function(){function t(e){this.parsed=RD(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return _i(op(this.rgba),2)},t.prototype.isDark=function(){return op(this.rgba)<.5},t.prototype.isLight=function(){return op(this.rgba)>=.5},t.prototype.toHex=function(){return e=np(this.rgba),r=e.r,i=e.g,n=e.b,o=(s=e.a)<1?rd(_i(255*s)):"","#"+rd(r)+rd(i)+rd(n)+o;var e,r,i,n,s,o},t.prototype.toRgb=function(){return np(this.rgba)},t.prototype.toRgbString=function(){return e=np(this.rgba),r=e.r,i=e.g,n=e.b,(s=e.a)<1?"rgba("+r+", "+i+", "+n+", "+s+")":"rgb("+r+", "+i+", "+n+")";var e,r,i,n,s},t.prototype.toHsl=function(){return pw(v2(this.rgba))},t.prototype.toHslString=function(){return e=pw(v2(this.rgba)),r=e.h,i=e.s,n=e.l,(s=e.a)<1?"hsla("+r+", "+i+"%, "+n+"%, "+s+")":"hsl("+r+", "+i+"%, "+n+"%)";var e,r,i,n,s},t.prototype.toHsv=function(){return e=_w(this.rgba),{h:_i(e.h),s:_i(e.s),v:_i(e.v),a:_i(e.a,3)};var e},t.prototype.invert=function(){return Ji({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),Ji(sp(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),Ji(sp(this.rgba,-e))},t.prototype.grayscale=function(){return Ji(sp(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),Ji(yw(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),Ji(yw(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?Ji({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):_i(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=v2(this.rgba);return typeof e=="number"?Ji({h:e,s:r.s,l:r.l,a:r.a}):_i(r.h)},t.prototype.isEqual=function(e){return this.toHex()===Ji(e).toHex()},t}(),Ji=function(t){return t instanceof lp?t:new lp(t)},vw=[],Hc=function(t){t.forEach(function(e){vw.indexOf(e)<0&&(e(lp,ap),vw.push(e))})};function $c(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in r)i[r[n]]=n;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=i[this.toHex()];if(c)return c;if(o?.closest){var u=this.toRgb(),d=1/0,h="black";if(!s.length)for(var p in r)s[p]=new t(r[p]).toRgb();for(var m in r){var g=(a=u,l=s[m],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));g<d&&(d=g,h=m)}return h}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":r[a];return l?new t(l).toRgb():null},"name"])}Hc([$c]);var jc=class{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof jc)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){let r=typeof t;if(r!==typeof e)return!1;if(r==="number"||r==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((n,s)=>n===e[s]);if(t!==null&&e!==null){let n=Object.keys(t),s=Object.keys(e);return n.length!==s.length?!1:n.every(o=>t[o]===e[o])}return t===e}toRgba(){let[t,e,r,i]=this._components;return{r:t,g:e,b:r,a:i}}toRgb(){let[t,e,r]=this._components;return{r:t,g:e,b:r}}toRgbaString(){let[t,e,r]=this.toUint8RgbArray();return`rgba(${t},${e},${r},${this.alpha})`}toUint8RgbArray(t){let[e,r,i]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(r*255),t[2]=Math.round(i*255),t}toRgbArray(t){t=t??[];let[e,r,i]=this._components;return t[0]=e,t[1]=r,t[2]=i,t}toNumber(){return this._int}toLittleEndianNumber(){let t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){let[e,r,i,n]=jc.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=r,this._components[2]*=i,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,n=this._int&255;return e&&(r=r*t+.5|0,i=i*t+.5|0,n=n*t+.5|0),(t*255<<24)+(r<<16)+(i<<8)+n}toHex(){let t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){let e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){let[e,r,i]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(r*t)/t,this._components[2]=Math.round(i*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];let[e,r,i,n]=this._components;return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}normalize(t){let e,r,i,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){let s=t;e=(s>>16&255)/255,r=(s>>8&255)/255,i=(s&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,r,i,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,r,i,n=255]=t,e/=255,r/=255,i/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){let o=jc.HEX_PATTERN.exec(t);o&&(t=`#${o[2]}`)}let s=Ji(t);s.isValid()&&({r:e,g:r,b:i,a:n}=s.rgba,e/=255,r/=255,i/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=r,this._components[2]=i,this._components[3]=n,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);let[t,e,r]=this._components;this._int=(t*255<<16)+(e*255<<8)+(r*255|0)}_clamp(t,e=0,r=1){return typeof t=="number"?Math.min(Math.max(t,e),r):(t.forEach((i,n)=>{t[n]=Math.min(Math.max(i,e),r)}),t)}},Bn=jc;Bn.shared=new jc;Bn.temp=new jc;Bn.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function ww(t,e=[]){return ht("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),Bn.shared.setValue(t).toRgbArray(e)}function Ew(t){return ht("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Bn.shared.setValue(t).toHex()}function Sw(t){return ht("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),Bn.shared.setValue(t).toNumber()}function Tw(t){return ht("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Bn.shared.setValue(t).toNumber()}var en=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(en||{}),cp=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(cp||{}),id=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(id||{}),We=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(We||{}),_n=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(_n||{}),Ce=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(Ce||{}),Ko=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(Ko||{}),Ge=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(Ge||{}),nd=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(nd||{}),ki=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(ki||{}),bn=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(bn||{}),oi=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(oi||{}),$r=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))($r||{}),Un=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(Un||{}),sd=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(sd||{}),tn=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(tn||{}),jr=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(jr||{});var ar=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(ar||{}),wn=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(wn||{});function ND(){let t=[],e=[];for(let i=0;i<32;i++)t[i]=i,e[i]=i;t[We.NORMAL_NPM]=We.NORMAL,t[We.ADD_NPM]=We.ADD,t[We.SCREEN_NPM]=We.SCREEN,e[We.NORMAL]=We.NORMAL_NPM,e[We.ADD]=We.ADD_NPM,e[We.SCREEN]=We.SCREEN_NPM;let r=[];return r.push(e),r.push(t),r}var x2=ND();function Aw(t,e){return x2[e?1:0][t]}function Cw(t,e,r,i=!0){return ht("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),Bn.shared.setValue(t).premultiply(e,i).toArray(r??new Float32Array(4))}function kw(t,e){return ht("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),Bn.shared.setValue(t).toPremultiplied(e)}function Iw(t,e,r,i=!0){return ht("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),Bn.shared.setValue(t).premultiply(e,i).toArray(r??new Float32Array(4))}var od=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Mw(t,e=null){let r=t*6;if(e=e||new Uint16Array(r),e.length!==r)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${r}`);for(let i=0,n=0;i<r;i+=6,n+=4)e[i+0]=n+0,e[i+1]=n+1,e[i+2]=n+2,e[i+3]=n+0,e[i+4]=n+2,e[i+5]=n+3;return e}function qa(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}var DD={Float32Array,Uint32Array,Int32Array,Uint8Array};function Pw(t,e){let r=0,i=0,n={};for(let l=0;l<t.length;l++)i+=e[l],r+=t[l].length;let s=new ArrayBuffer(r*4),o=null,a=0;for(let l=0;l<t.length;l++){let c=e[l],u=t[l],d=qa(u);n[d]||(n[d]=new DD[d](s)),o=n[d];for(let h=0;h<u.length;h++){let p=(h/c|0)*i+a,m=h%c;o[p+m]=u[h]}a+=c}return new Float32Array(s)}function Ya(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function _2(t){return!(t&t-1)&&!!t}function b2(t){let e=(t>65535?1:0)<<4;t>>>=e;let r=(t>255?1:0)<<3;return t>>>=r,e|=r,r=(t>15?1:0)<<2,t>>>=r,e|=r,r=(t>3?1:0)<<1,t>>>=r,e|=r,e|t>>1}function ad(t,e,r){let i=t.length,n;if(e>=i||r===0)return;r=e+r>i?i-e:r;let s=i-r;for(n=e;n<s;++n)t[n]=t[n+r];t.length=s}function Rw(t){return t===0?0:t<0?-1:1}var FD=0;function ho(){return++FD}var Nw=class{constructor(t,e,r,i){this.left=t,this.top=e,this.right=r,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}},Vc=Nw;Vc.EMPTY=new Nw(0,0,0,0);var w2={},bi=Object.create(null),rn=Object.create(null);function Dw(){let t;for(t in bi)bi[t].destroy();for(t in rn)rn[t].destroy()}function Fw(){let t;for(t in bi)delete bi[t];for(t in rn)delete rn[t]}var ld=class{constructor(e,r,i){this._canvas=ue.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||ue.RESOLUTION,this.resize(e,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,r){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}};function Ow(t,e,r){for(let i=0,n=4*r*e;i<e;++i,n+=4)if(t[n+3]!==0)return!1;return!0}function Lw(t,e,r,i,n){let s=4*e;for(let o=i,a=i*s+4*r;o<=n;++o,a+=s)if(t[a+3]!==0)return!1;return!0}function cd(t){let{width:e,height:r}=t,i=t.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");let s=i.getImageData(0,0,e,r).data,o=0,a=0,l=e-1,c=r-1;for(;a<r&&Ow(s,e,a);)++a;if(a===r)return Vc.EMPTY;for(;Ow(s,e,c);)--c;for(;Lw(s,e,o,a,c);)++o;for(;Lw(s,e,l,a,c);)--l;return++l,++c,new Vc(o,a,l,c)}function Bw(t){let e=cd(t),{width:r,height:i}=e,n=null;if(!e.isEmpty()){let s=t.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");n=s.getImageData(e.left,e.top,r,i)}return{width:r,height:i,data:n}}function Uw(t){let e=od.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}var ud;function fd(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location,ud||(ud=document.createElement("a")),ud.href=t;let r=ed.parse(ud.href),i=!r.port&&e.port===""||r.port===e.port;return r.hostname!==e.hostname||!i||r.protocol!==e.protocol?"anonymous":""}function E2(t,e=1){let r=ue.RETINA_PREFIX?.exec(t);return r?parseFloat(r[1]):e}var Kw=dt(C2(),1),XD={type:"FeatureCollection",features:[{type:"Feature",properties:{wikidata:"Q21",nameEn:"England",aliases:["GB-ENG"],country:"GB",groups:["Q23666","Q3336843","154","150","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["44"]},geometry:{type:"MultiPolygon",coordinates:[[[[-6.03913,51.13217],[-7.74976,48.64773],[1.17405,50.74239],[2.18458,51.52087],[2.56575,51.85301],[.792,57.56437],[-2.30613,55.62698],[-2.17058,55.45916],[-2.6095,55.28488],[-2.63532,55.19452],[-3.02906,55.04606],[-3.09361,54.94924],[-3.38407,54.94278],[-4.1819,54.57861],[-3.5082,53.54318],[-3.08228,53.25526],[-3.03675,53.25092],[-2.92329,53.19383],[-2.92022,53.17685],[-2.98598,53.15589],[-2.90649,53.10964],[-2.87469,53.12337],[-2.89131,53.09374],[-2.83133,52.99184],[-2.7251,52.98389],[-2.72221,52.92969],[-2.80549,52.89428],[-2.85897,52.94487],[-2.92401,52.93836],[-2.97243,52.9651],[-3.13576,52.895],[-3.15744,52.84947],[-3.16105,52.79599],[-3.08734,52.77504],[-3.01001,52.76636],[-2.95581,52.71794],[-3.01724,52.72083],[-3.04398,52.65435],[-3.13648,52.58208],[-3.12926,52.5286],[-3.09746,52.53077],[-3.08662,52.54811],[-3.00929,52.57774],[-2.99701,52.551],[-3.03603,52.49969],[-3.13359,52.49174],[-3.22971,52.45344],[-3.22754,52.42526],[-3.04687,52.34504],[-2.95364,52.3501],[-2.99701,52.323],[-3.00785,52.2753],[-3.09289,52.20546],[-3.12638,52.08114],[-2.97111,51.90456],[-2.8818,51.93196],[-2.78742,51.88833],[-2.74277,51.84367],[-2.66234,51.83555],[-2.66336,51.59504],[-3.20563,51.31615],[-6.03913,51.13217]]]]}},{type:"Feature",properties:{wikidata:"Q22",nameEn:"Scotland",aliases:["GB-SCT"],country:"GB",groups:["Q23666","Q3336843","154","150","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["44"]},geometry:{type:"MultiPolygon",coordinates:[[[[.792,57.56437],[-.3751,61.32236],[-14.78497,57.60709],[-6.82333,55.83103],[-4.69044,54.3629],[-3.38407,54.94278],[-3.09361,54.94924],[-3.02906,55.04606],[-2.63532,55.19452],[-2.6095,55.28488],[-2.17058,55.45916],[-2.30613,55.62698],[.792,57.56437]]]]}},{type:"Feature",properties:{wikidata:"Q25",nameEn:"Wales",aliases:["GB-WLS"],country:"GB",groups:["Q23666","Q3336843","154","150","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["44"]},geometry:{type:"MultiPolygon",coordinates:[[[[-3.5082,53.54318],[-5.37267,53.63269],[-6.03913,51.13217],[-3.20563,51.31615],[-2.66336,51.59504],[-2.66234,51.83555],[-2.74277,51.84367],[-2.78742,51.88833],[-2.8818,51.93196],[-2.97111,51.90456],[-3.12638,52.08114],[-3.09289,52.20546],[-3.00785,52.2753],[-2.99701,52.323],[-2.95364,52.3501],[-3.04687,52.34504],[-3.22754,52.42526],[-3.22971,52.45344],[-3.13359,52.49174],[-3.03603,52.49969],[-2.99701,52.551],[-3.00929,52.57774],[-3.08662,52.54811],[-3.09746,52.53077],[-3.12926,52.5286],[-3.13648,52.58208],[-3.04398,52.65435],[-3.01724,52.72083],[-2.95581,52.71794],[-3.01001,52.76636],[-3.08734,52.77504],[-3.16105,52.79599],[-3.15744,52.84947],[-3.13576,52.895],[-2.97243,52.9651],[-2.92401,52.93836],[-2.85897,52.94487],[-2.80549,52.89428],[-2.72221,52.92969],[-2.7251,52.98389],[-2.83133,52.99184],[-2.89131,53.09374],[-2.87469,53.12337],[-2.90649,53.10964],[-2.98598,53.15589],[-2.92022,53.17685],[-2.92329,53.19383],[-3.03675,53.25092],[-3.08228,53.25526],[-3.5082,53.54318]]]]}},{type:"Feature",properties:{wikidata:"Q26",nameEn:"Northern Ireland",aliases:["GB-NIR"],country:"GB",groups:["Q22890","Q3336843","154","150","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["44"]},geometry:{type:"MultiPolygon",coordinates:[[[[-6.34755,55.49206],[-7.2471,55.06933],[-7.34464,55.04688],[-7.4033,55.00391],[-7.40004,54.94498],[-7.44404,54.9403],[-7.4473,54.87003],[-7.47626,54.83084],[-7.54508,54.79401],[-7.54671,54.74606],[-7.64449,54.75265],[-7.75041,54.7103],[-7.83352,54.73854],[-7.93293,54.66603],[-7.70315,54.62077],[-7.8596,54.53671],[-7.99812,54.54427],[-8.04538,54.48941],[-8.179,54.46763],[-8.04555,54.36292],[-7.87101,54.29299],[-7.8596,54.21779],[-7.81397,54.20159],[-7.69501,54.20731],[-7.55812,54.12239],[-7.4799,54.12239],[-7.44567,54.1539],[-7.32834,54.11475],[-7.30553,54.11869],[-7.34005,54.14698],[-7.29157,54.17191],[-7.28017,54.16714],[-7.29687,54.1354],[-7.29493,54.12013],[-7.26316,54.13863],[-7.25012,54.20063],[-7.14908,54.22732],[-7.19145,54.31296],[-7.02034,54.4212],[-6.87775,54.34682],[-6.85179,54.29176],[-6.81583,54.22791],[-6.74575,54.18788],[-6.70175,54.20218],[-6.6382,54.17071],[-6.66264,54.0666],[-6.62842,54.03503],[-6.47849,54.06947],[-6.36605,54.07234],[-6.36279,54.11248],[-6.32694,54.09337],[-6.29003,54.11278],[-6.26218,54.09785],[-5.83481,53.87749],[-4.69044,54.3629],[-6.34755,55.49206]]]]}},{type:"Feature",properties:{wikidata:"Q35",nameEn:"Denmark",country:"DK",groups:["EU","154","150","UN"],callingCodes:["45"]},geometry:{type:"MultiPolygon",coordinates:[[[[12.16597,56.60205],[10.40861,58.38489],[7.28637,57.35913],[8.02459,55.09613],[8.45719,55.06747],[8.55769,54.91837],[8.63979,54.91069],[8.76387,54.8948],[8.81178,54.90518],[8.92795,54.90452],[9.04629,54.87249],[9.14275,54.87421],[9.20571,54.85841],[9.24631,54.84726],[9.23445,54.83432],[9.2474,54.8112],[9.32771,54.80602],[9.33849,54.80233],[9.36496,54.81749],[9.38532,54.83968],[9.41213,54.84254],[9.43155,54.82586],[9.4659,54.83131],[9.58937,54.88785],[9.62734,54.88057],[9.61187,54.85548],[9.73563,54.8247],[9.89314,54.84171],[10.16755,54.73883],[10.31111,54.65968],[11.00303,54.63689],[11.90309,54.38543],[12.85844,54.82438],[13.93395,54.84044],[15.36991,54.73263],[15.79951,55.54655],[14.89259,55.5623],[14.28399,55.1553],[12.84405,55.13257],[12.60345,55.42675],[12.88472,55.63369],[12.6372,55.91371],[12.65312,56.04345],[12.07466,56.29488],[12.16597,56.60205]]]]}},{type:"Feature",properties:{wikidata:"Q55",nameEn:"Netherlands",country:"NL",groups:["EU","155","150","UN"],callingCodes:["31"]},geometry:{type:"MultiPolygon",coordinates:[[[[5.45168,54.20039],[2.56575,51.85301],[3.36263,51.37112],[3.38696,51.33436],[3.35847,51.31572],[3.38289,51.27331],[3.41704,51.25933],[3.43488,51.24135],[3.52698,51.2458],[3.51502,51.28697],[3.58939,51.30064],[3.78999,51.25766],[3.78783,51.2151],[3.90125,51.20371],[3.97889,51.22537],[4.01957,51.24504],[4.05165,51.24171],[4.16721,51.29348],[4.24024,51.35371],[4.21923,51.37443],[4.33265,51.37687],[4.34086,51.35738],[4.39292,51.35547],[4.43777,51.36989],[4.38064,51.41965],[4.39747,51.43316],[4.38122,51.44905],[4.47736,51.4778],[4.5388,51.48184],[4.54675,51.47265],[4.52846,51.45002],[4.53521,51.4243],[4.57489,51.4324],[4.65442,51.42352],[4.72935,51.48424],[4.74578,51.48937],[4.77321,51.50529],[4.78803,51.50284],[4.84139,51.4799],[4.82409,51.44736],[4.82946,51.4213],[4.78314,51.43319],[4.76577,51.43046],[4.77229,51.41337],[4.78941,51.41102],[4.84988,51.41502],[4.90016,51.41404],[4.92152,51.39487],[5.00393,51.44406],[5.0106,51.47167],[5.03281,51.48679],[5.04774,51.47022],[5.07891,51.4715],[5.10456,51.43163],[5.07102,51.39469],[5.13105,51.34791],[5.13377,51.31592],[5.16222,51.31035],[5.2002,51.32243],[5.24244,51.30495],[5.22542,51.26888],[5.23814,51.26064],[5.26461,51.26693],[5.29716,51.26104],[5.33886,51.26314],[5.347,51.27502],[5.41672,51.26248],[5.4407,51.28169],[5.46519,51.2849],[5.48476,51.30053],[5.515,51.29462],[5.5569,51.26544],[5.5603,51.22249],[5.65145,51.19788],[5.65528,51.18736],[5.70344,51.1829],[5.74617,51.18928],[5.77735,51.17845],[5.77697,51.1522],[5.82564,51.16753],[5.85508,51.14445],[5.80798,51.11661],[5.8109,51.10861],[5.83226,51.10585],[5.82921,51.09328],[5.79903,51.09371],[5.79835,51.05834],[5.77258,51.06196],[5.75961,51.03113],[5.77688,51.02483],[5.76242,50.99703],[5.71864,50.96092],[5.72875,50.95428],[5.74752,50.96202],[5.75927,50.95601],[5.74644,50.94723],[5.72545,50.92312],[5.72644,50.91167],[5.71626,50.90796],[5.69858,50.91046],[5.67886,50.88142],[5.64504,50.87107],[5.64009,50.84742],[5.65259,50.82309],[5.70118,50.80764],[5.68995,50.79641],[5.70107,50.7827],[5.68091,50.75804],[5.69469,50.75529],[5.72216,50.76398],[5.73904,50.75674],[5.74356,50.7691],[5.76533,50.78159],[5.77513,50.78308],[5.80673,50.7558],[5.84548,50.76542],[5.84888,50.75448],[5.88734,50.77092],[5.89129,50.75125],[5.89132,50.75124],[5.95942,50.7622],[5.97545,50.75441],[6.01976,50.75398],[6.02624,50.77453],[5.97497,50.79992],[5.98404,50.80988],[6.00462,50.80065],[6.02328,50.81694],[6.01921,50.84435],[6.05623,50.8572],[6.05702,50.85179],[6.07431,50.84674],[6.07693,50.86025],[6.08805,50.87223],[6.07486,50.89307],[6.09297,50.92066],[6.01615,50.93367],[6.02697,50.98303],[5.95282,50.98728],[5.90296,50.97356],[5.90493,51.00198],[5.87849,51.01969],[5.86735,51.05182],[5.9134,51.06736],[5.9541,51.03496],[5.98292,51.07469],[6.16706,51.15677],[6.17384,51.19589],[6.07889,51.17038],[6.07889,51.24432],[6.16977,51.33169],[6.22674,51.36135],[6.22641,51.39948],[6.20654,51.40049],[6.21724,51.48568],[6.18017,51.54096],[6.09055,51.60564],[6.11759,51.65609],[6.02767,51.6742],[6.04091,51.71821],[5.95003,51.7493],[5.98665,51.76944],[5.94568,51.82786],[5.99848,51.83195],[6.06705,51.86136],[6.10337,51.84829],[6.16902,51.84094],[6.11551,51.89769],[6.15349,51.90439],[6.21443,51.86801],[6.29872,51.86801],[6.30593,51.84998],[6.40704,51.82771],[6.38815,51.87257],[6.47179,51.85395],[6.50231,51.86313],[6.58556,51.89386],[6.68386,51.91861],[6.72319,51.89518],[6.82357,51.96711],[6.83035,51.9905],[6.68128,52.05052],[6.76117,52.11895],[6.83984,52.11728],[6.97189,52.20329],[6.9897,52.2271],[7.03729,52.22695],[7.06365,52.23789],[7.02703,52.27941],[7.07044,52.37805],[7.03417,52.40237],[6.99041,52.47235],[6.94293,52.43597],[6.69507,52.488],[6.71641,52.62905],[6.77307,52.65375],[7.04557,52.63318],[7.07253,52.81083],[7.21694,53.00742],[7.17898,53.13817],[7.22681,53.18165],[7.21679,53.20058],[7.19052,53.31866],[7.00198,53.32672],[6.91025,53.44221],[5.45168,54.20039]],[[4.93295,51.44945],[4.95244,51.45207],[4.9524,51.45014],[4.93909,51.44632],[4.93295,51.44945]],[[4.91493,51.4353],[4.91935,51.43634],[4.92227,51.44252],[4.91811,51.44621],[4.92287,51.44741],[4.92811,51.4437],[4.92566,51.44273],[4.92815,51.43856],[4.92879,51.44161],[4.93544,51.44634],[4.94025,51.44193],[4.93416,51.44185],[4.93471,51.43861],[4.94265,51.44003],[4.93986,51.43064],[4.92952,51.42984],[4.92652,51.43329],[4.91493,51.4353]]]]}},{type:"Feature",properties:{wikidata:"Q782",nameEn:"Hawaii",aliases:["US-HI"],country:"US",groups:["Q35657","061","009","UN"],roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1"]},geometry:{type:"MultiPolygon",coordinates:[[[[-177.8563,29.18961],[-179.49839,27.86265],[-151.6784,9.55515],[-154.05867,45.51124],[-177.5224,27.7635],[-177.8563,29.18961]]]]}},{type:"Feature",properties:{wikidata:"Q797",nameEn:"Alaska",aliases:["US-AK"],country:"US",groups:["Q35657","021","003","019","UN"],roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1"]},geometry:{type:"MultiPolygon",coordinates:[[[[169.34848,52.47228],[180,51.0171],[179.84401,55.10087],[169.34848,52.47228]]],[[[-168.95635,65.98512],[-169.03888,65.48473],[-172.76104,63.77445],[-179.55295,57.62081],[-179.55295,50.81807],[-133.92876,54.62289],[-130.61931,54.70835],[-130.64499,54.76912],[-130.44184,54.85377],[-130.27203,54.97174],[-130.18765,55.07744],[-130.08035,55.21556],[-129.97513,55.28029],[-130.15373,55.74895],[-130.00857,55.91344],[-130.00093,56.00325],[-130.10173,56.12178],[-130.33965,56.10849],[-130.77769,56.36185],[-131.8271,56.62247],[-133.38523,58.42773],[-133.84645,58.73543],[-134.27175,58.8634],[-134.48059,59.13231],[-134.55699,59.1297],[-134.7047,59.2458],[-135.00267,59.28745],[-135.03069,59.56208],[-135.48007,59.79937],[-136.31566,59.59083],[-136.22381,59.55526],[-136.33727,59.44466],[-136.47323,59.46617],[-136.52365,59.16752],[-136.82619,59.16198],[-137.4925,58.89415],[-137.60623,59.24465],[-138.62145,59.76431],[-138.71149,59.90728],[-139.05365,59.99655],[-139.20603,60.08896],[-139.05831,60.35205],[-139.68991,60.33693],[-139.98024,60.18027],[-140.45648,60.30919],[-140.5227,60.22077],[-141.00116,60.30648],[-140.97446,84.39275],[-168.25765,71.99091],[-168.95635,65.98512]]]]}},{type:"Feature",properties:{wikidata:"Q3492",nameEn:"Sumatra",aliases:["ID-SM"],country:"ID",groups:["035","142","UN"],driveSide:"left",callingCodes:["62"]},geometry:{type:"MultiPolygon",coordinates:[[[[109.82788,2.86812],[110.90339,7.52694],[105.01437,3.24936],[104.56723,1.44271],[104.34728,1.33529],[104.12282,1.27714],[104.03085,1.26954],[103.74084,1.12902],[103.66049,1.18825],[103.56591,1.19719],[103.03657,1.30383],[96.11174,6.69841],[74.28481,-3.17525],[102.92489,-8.17146],[106.32259,-5.50116],[106.38511,-5.16715],[109.17017,-4.07401],[109.3962,-2.07276],[108.50935,-2.01066],[107.94791,1.06924],[109.82788,2.86812]]]]}},{type:"Feature",properties:{wikidata:"Q3757",nameEn:"Java",aliases:["ID-JW"],country:"ID",groups:["035","142","UN"],driveSide:"left",callingCodes:["62"]},geometry:{type:"MultiPolygon",coordinates:[[[[109.17017,-4.07401],[106.38511,-5.16715],[106.32259,-5.50116],[102.92489,-8.17146],[116.22542,-10.49172],[114.39575,-8.2889],[114.42235,-8.09762],[114.92859,-7.49253],[116.33992,-7.56171],[116.58433,-5.30385],[109.17017,-4.07401]]]]}},{type:"Feature",properties:{wikidata:"Q3795",nameEn:"Kalimantan",aliases:["ID-KA"],country:"ID",groups:["Q36117","035","142","UN"],driveSide:"left",callingCodes:["62"]},geometry:{type:"MultiPolygon",coordinates:[[[[120.02464,2.83703],[118.06469,4.16638],[117.67641,4.16535],[117.47313,4.18857],[117.25801,4.35108],[115.90217,4.37708],[115.58276,3.93499],[115.53713,3.14776],[115.11343,2.82879],[115.1721,2.49671],[114.80706,2.21665],[114.80706,1.92351],[114.57892,1.5],[114.03788,1.44787],[113.64677,1.23933],[113.01448,1.42832],[113.021,1.57819],[112.48648,1.56516],[112.2127,1.44135],[112.15679,1.17004],[111.94553,1.12016],[111.82846,.99349],[111.55434,.97864],[111.22979,1.08326],[110.62374,.873],[110.49182,.88088],[110.35354,.98869],[109.66397,1.60425],[109.66397,1.79972],[109.57923,1.80624],[109.53794,1.91771],[109.62558,1.99182],[109.82788,2.86812],[107.94791,1.06924],[108.50935,-2.01066],[109.3962,-2.07276],[109.17017,-4.07401],[116.58433,-5.30385],[120.02464,2.83703]]]]}},{type:"Feature",properties:{wikidata:"Q3803",nameEn:"Lesser Sunda Islands",aliases:["ID-NU"],country:"ID",groups:["035","142","UN"],driveSide:"left",callingCodes:["62"]},geometry:{type:"MultiPolygon",coordinates:[[[[116.96967,-8.01483],[114.92859,-7.49253],[114.42235,-8.09762],[114.39575,-8.2889],[116.22542,-10.49172],[122.14954,-11.52517],[125.68138,-9.85176],[125.09025,-9.46406],[124.97892,-9.19281],[125.04044,-9.17093],[125.09434,-9.19669],[125.18907,-9.16434],[125.18632,-9.03142],[125.11764,-8.96359],[124.97742,-9.08128],[124.94011,-8.85617],[124.46701,-9.13002],[124.45971,-9.30263],[124.38554,-9.3582],[124.35258,-9.43002],[124.3535,-9.48493],[124.28115,-9.50453],[124.28115,-9.42189],[124.21247,-9.36904],[124.14517,-9.42324],[124.10539,-9.41206],[124.04286,-9.34243],[124.04628,-9.22671],[124.33472,-9.11416],[124.92337,-8.75859],[125.87688,-7.49892],[116.96967,-8.01483]]]]}},{type:"Feature",properties:{wikidata:"Q3812",nameEn:"Sulawesi",aliases:["ID-SL"],country:"ID",groups:["035","142","UN"],driveSide:"left",callingCodes:["62"]},geometry:{type:"MultiPolygon",coordinates:[[[[128.34321,3.90322],[126.69413,6.02692],[119.56457,.90759],[116.58433,-5.30385],[116.33992,-7.56171],[116.96967,-8.01483],[125.87688,-7.49892],[123.78965,-.86805],[128.34321,3.90322]]]]}},{type:"Feature",properties:{wikidata:"Q3827",nameEn:"Maluku Islands",aliases:["ID-ML"],country:"ID",groups:["035","142","UN"],driveSide:"left",callingCodes:["62"]},geometry:{type:"MultiPolygon",coordinates:[[[[129.63187,2.21409],[128.34321,3.90322],[123.78965,-.86805],[125.87688,-7.49892],[125.58506,-7.95311],[125.87691,-8.31789],[127.42116,-8.22471],[127.55165,-9.05052],[135.49042,-9.2276],[135.35517,-5.01442],[132.8312,-4.70282],[130.8468,-2.61103],[128.40647,-2.30349],[129.71519,-.24692],[129.63187,2.21409]]]]}},{type:"Feature",properties:{wikidata:"Q3845",nameEn:"Western New Guinea",aliases:["ID-PP"],country:"ID",groups:["035","142","UN"],driveSide:"left",callingCodes:["62"]},geometry:{type:"MultiPolygon",coordinates:[[[[135.49042,-9.2276],[141.01842,-9.35091],[141.01763,-6.90181],[140.90448,-6.85033],[140.85295,-6.72996],[140.99813,-6.3233],[141.02352,.08993],[129.63187,2.21409],[129.71519,-.24692],[128.40647,-2.30349],[130.8468,-2.61103],[132.8312,-4.70282],[135.35517,-5.01442],[135.49042,-9.2276]]]]}},{type:"Feature",properties:{wikidata:"Q5765",nameEn:"Balearic Islands",aliases:["ES-IB"],country:"ES",groups:["EU","039","150","UN"],callingCodes:["34 971"]},geometry:{type:"MultiPolygon",coordinates:[[[[-2.27707,35.35051],[5.10072,39.89531],[3.75438,42.33445],[-2.27707,35.35051]]]]}},{type:"Feature",properties:{wikidata:"Q5823",nameEn:"Ceuta",aliases:["ES-CE"],country:"ES",groups:["EA","EU","015","002","UN"],level:"subterritory",callingCodes:["34"]},geometry:{type:"MultiPolygon",coordinates:[[[[-5.38491,35.92591],[-5.37338,35.88417],[-5.35844,35.87375],[-5.34379,35.8711],[-5.21179,35.90091],[-5.38491,35.92591]]]]}},{type:"Feature",properties:{wikidata:"Q5831",nameEn:"Melilla",aliases:["ES-ML"],country:"ES",groups:["EA","EU","015","002","UN"],level:"subterritory",callingCodes:["34"]},geometry:{type:"MultiPolygon",coordinates:[[[[-2.91909,35.33927],[-2.96038,35.31609],[-2.96648,35.30475],[-2.96978,35.29459],[-2.97035,35.28852],[-2.96507,35.28801],[-2.96826,35.28296],[-2.96516,35.27967],[-2.95431,35.2728],[-2.95065,35.26576],[-2.93893,35.26737],[-2.92272,35.27509],[-2.91909,35.33927]]]]}},{type:"Feature",properties:{wikidata:"Q7835",nameEn:"Crimea",country:"RU",groups:["151","150","UN"],level:"subterritory",callingCodes:["7"]},geometry:{type:"MultiPolygon",coordinates:[[[[33.5,44],[36.4883,45.0488],[36.475,45.2411],[36.5049,45.3136],[36.6545,45.3417],[36.6645,45.4514],[35.0498,45.7683],[34.9601,45.7563],[34.7991,45.8101],[34.8015,45.9005],[34.7548,45.907],[34.6668,45.9714],[34.6086,45.9935],[34.5589,45.9935],[34.5201,45.951],[34.4873,45.9427],[34.4415,45.9599],[34.4122,46.0025],[34.3391,46.0611],[34.2511,46.0532],[34.181,46.068],[34.1293,46.1049],[34.0731,46.1177],[34.0527,46.1084],[33.9155,46.1594],[33.8523,46.1986],[33.7972,46.2048],[33.7405,46.1855],[33.646,46.2303],[33.6152,46.2261],[33.6385,46.1415],[33.6147,46.1356],[33.5732,46.1032],[33.5909,46.0601],[33.5597,46.0307],[31.5,45.5],[33.5,44]]]]}},{type:"Feature",properties:{wikidata:"Q12837",nameEn:"Iberia",level:"sharedLandform"},geometry:null},{type:"Feature",properties:{wikidata:"Q14056",nameEn:"Jan Mayen",aliases:["NO-22"],country:"NO",groups:["SJ","154","150","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[-9.18243,72.23144],[-10.71459,70.09565],[-5.93364,70.76368],[-9.18243,72.23144]]]]}},{type:"Feature",properties:{wikidata:"Q19188",nameEn:"Mainland China",country:"CN",groups:["030","142","UN"],callingCodes:["86"]},geometry:{type:"MultiPolygon",coordinates:[[[[125.6131,53.07229],[125.17522,53.20225],[124.46078,53.21881],[123.86158,53.49391],[123.26989,53.54843],[122.85966,53.47395],[122.35063,53.49565],[121.39213,53.31888],[120.85633,53.28499],[120.0451,52.7359],[120.04049,52.58773],[120.46454,52.63811],[120.71673,52.54099],[120.61346,52.32447],[120.77337,52.20805],[120.65907,51.93544],[120.10963,51.671],[119.13553,50.37412],[119.38598,50.35162],[119.27996,50.13348],[119.11003,50.00276],[118.61623,49.93809],[117.82343,49.52696],[117.48208,49.62324],[117.27597,49.62544],[116.71193,49.83813],[116.03781,48.87014],[116.06565,48.81716],[115.78876,48.51781],[115.811,48.25699],[115.52082,48.15367],[115.57128,47.91988],[115.94296,47.67741],[116.21879,47.88505],[116.4465,47.83662],[116.67405,47.89039],[116.9723,47.87285],[117.37875,47.63627],[117.50181,47.77216],[117.80196,48.01661],[118.03676,48.00982],[118.11009,48.04],[118.22677,48.03853],[118.29654,48.00246],[118.55766,47.99277],[118.7564,47.76947],[119.12343,47.66458],[119.13995,47.53997],[119.35892,47.48104],[119.31964,47.42617],[119.54918,47.29505],[119.56019,47.24874],[119.62403,47.24575],[119.71209,47.19192],[119.85518,46.92196],[119.91242,46.90091],[119.89261,46.66423],[119.80455,46.67631],[119.77373,46.62947],[119.68127,46.59015],[119.65265,46.62342],[119.42827,46.63783],[119.32827,46.61433],[119.24978,46.64761],[119.10448,46.65516],[119.00541,46.74273],[118.92616,46.72765],[118.89974,46.77139],[118.8337,46.77742],[118.78747,46.68689],[118.30534,46.73519],[117.69554,46.50991],[117.60748,46.59771],[117.41782,46.57862],[117.36609,46.36335],[116.83166,46.38637],[116.75551,46.33083],[116.58612,46.30211],[116.26678,45.96479],[116.24012,45.8778],[116.27366,45.78637],[116.16989,45.68603],[115.60329,45.44717],[114.94546,45.37377],[114.74612,45.43585],[114.54801,45.38337],[114.5166,45.27189],[113.70918,44.72891],[112.74662,44.86297],[112.4164,45.06858],[111.98695,45.09074],[111.76275,44.98032],[111.40498,44.3461],[111.96289,43.81596],[111.93776,43.68709],[111.79758,43.6637],[111.59087,43.51207],[111.0149,43.3289],[110.4327,42.78293],[110.08401,42.6411],[109.89402,42.63111],[109.452,42.44842],[109.00679,42.45302],[108.84489,42.40246],[107.57258,42.40898],[107.49681,42.46221],[107.29755,42.41395],[107.24774,42.36107],[106.76517,42.28741],[105.0123,41.63188],[104.51667,41.66113],[104.52258,41.8706],[103.92804,41.78246],[102.72403,42.14675],[102.07645,42.22519],[101.80515,42.50074],[100.84979,42.67087],[100.33297,42.68231],[99.50671,42.56535],[97.1777,42.7964],[96.37926,42.72055],[96.35658,42.90363],[95.89543,43.2528],[95.52594,43.99353],[95.32891,44.02407],[95.39772,44.2805],[95.01191,44.25274],[94.71959,44.35284],[94.10003,44.71016],[93.51161,44.95964],[91.64048,45.07408],[90.89169,45.19667],[90.65114,45.49314],[90.70907,45.73437],[91.03026,46.04194],[90.99672,46.14207],[90.89639,46.30711],[91.07696,46.57315],[91.0147,46.58171],[91.03649,46.72916],[90.84035,46.99525],[90.76108,46.99399],[90.48542,47.30438],[90.48854,47.41826],[90.33598,47.68303],[90.10871,47.7375],[90.06512,47.88177],[89.76624,47.82745],[89.55453,48.0423],[89.0711,47.98528],[88.93186,48.10263],[88.8011,48.11302],[88.58316,48.21893],[88.58939,48.34531],[87.96361,48.58478],[88.0788,48.71436],[87.73822,48.89582],[87.88171,48.95853],[87.81333,49.17354],[87.48983,49.13794],[87.478,49.07403],[87.28386,49.11626],[86.87238,49.12432],[86.73568,48.99918],[86.75343,48.70331],[86.38069,48.46064],[85.73581,48.3939],[85.5169,48.05493],[85.61067,47.49753],[85.69696,47.2898],[85.54294,47.06171],[85.22443,47.04816],[84.93995,46.87399],[84.73077,47.01394],[83.92184,46.98912],[83.04622,47.19053],[82.21792,45.56619],[82.58474,45.40027],[82.51374,45.1755],[81.73278,45.3504],[80.11169,45.03352],[79.8987,44.89957],[80.38384,44.63073],[80.40229,44.23319],[80.40031,44.10986],[80.75156,43.44948],[80.69718,43.32589],[80.77771,43.30065],[80.78817,43.14235],[80.62913,43.141],[80.3735,43.01557],[80.58999,42.9011],[80.38169,42.83142],[80.26886,42.8366],[80.16892,42.61137],[80.26841,42.23797],[80.17807,42.21166],[80.17842,42.03211],[79.92977,42.04113],[78.3732,41.39603],[78.15757,41.38565],[78.12873,41.23091],[77.81287,41.14307],[77.76206,41.01574],[77.52723,41.00227],[77.3693,41.0375],[77.28004,41.0033],[76.99302,41.0696],[76.75681,40.95354],[76.5261,40.46114],[76.33659,40.3482],[75.96168,40.38064],[75.91361,40.2948],[75.69663,40.28642],[75.5854,40.66874],[75.22834,40.45382],[75.08243,40.43945],[74.82013,40.52197],[74.78168,40.44886],[74.85996,40.32857],[74.69875,40.34668],[74.35063,40.09742],[74.25533,40.13191],[73.97049,40.04378],[73.83006,39.76136],[73.9051,39.75073],[73.92354,39.69565],[73.94683,39.60733],[73.87018,39.47879],[73.59831,39.46425],[73.59241,39.40843],[73.5004,39.38402],[73.55396,39.3543],[73.54572,39.27567],[73.60638,39.24534],[73.75823,39.023],[73.81728,39.04007],[73.82964,38.91517],[73.7445,38.93867],[73.7033,38.84782],[73.80656,38.66449],[73.79806,38.61106],[73.97933,38.52945],[74.17022,38.65504],[74.51217,38.47034],[74.69619,38.42947],[74.69894,38.22155],[74.80331,38.19889],[74.82665,38.07359],[74.9063,38.03033],[74.92416,37.83428],[75.00935,37.77486],[74.8912,37.67576],[74.94338,37.55501],[75.06011,37.52779],[75.15899,37.41443],[75.09719,37.37297],[75.12328,37.31839],[74.88887,37.23275],[74.80605,37.21565],[74.49981,37.24518],[74.56453,37.03023],[75.13839,37.02622],[75.40481,36.95382],[75.45562,36.71971],[75.72737,36.7529],[75.92391,36.56986],[76.0324,36.41198],[76.00906,36.17511],[75.93028,36.13136],[76.15325,35.9264],[76.14913,35.82848],[76.33453,35.84296],[76.50961,35.8908],[76.77323,35.66062],[76.84539,35.67356],[76.96624,35.5932],[77.44277,35.46132],[77.70232,35.46244],[77.80532,35.52058],[78.11664,35.48022],[78.03466,35.3785],[78.00033,35.23954],[78.22692,34.88771],[78.18435,34.7998],[78.27781,34.61484],[78.54964,34.57283],[78.56475,34.50835],[78.74465,34.45174],[79.05364,34.32482],[78.99802,34.3027],[78.91769,34.15452],[78.66225,34.08858],[78.65657,34.03195],[78.73367,34.01121],[78.77349,33.73871],[78.67599,33.66445],[78.73636,33.56521],[79.15252,33.17156],[79.14016,33.02545],[79.46562,32.69668],[79.26768,32.53277],[79.13174,32.47766],[79.0979,32.38051],[78.99322,32.37948],[78.96713,32.33655],[78.7831,32.46873],[78.73916,32.69438],[78.38897,32.53938],[78.4645,32.45367],[78.49609,32.2762],[78.68754,32.10256],[78.74404,32.00384],[78.78036,31.99478],[78.69933,31.78723],[78.84516,31.60631],[78.71032,31.50197],[78.77898,31.31209],[78.89344,31.30481],[79.01931,31.42817],[79.14016,31.43403],[79.30694,31.17357],[79.59884,30.93943],[79.93255,30.88288],[80.20721,30.58541],[80.54504,30.44936],[80.83343,30.32023],[81.03953,30.20059],[81.12842,30.01395],[81.24362,30.0126],[81.29032,30.08806],[81.2623,30.14596],[81.33355,30.15303],[81.39928,30.21862],[81.41018,30.42153],[81.5459,30.37688],[81.62033,30.44703],[81.99082,30.33423],[82.10135,30.35439],[82.10757,30.23745],[82.19475,30.16884],[82.16984,30.0692],[82.38622,30.02608],[82.5341,29.9735],[82.73024,29.81695],[83.07116,29.61957],[83.28131,29.56813],[83.44787,29.30513],[83.63156,29.16249],[83.82303,29.30513],[83.97559,29.33091],[84.18107,29.23451],[84.24801,29.02783],[84.2231,28.89571],[84.47528,28.74023],[84.62317,28.73887],[84.85511,28.58041],[85.06059,28.68562],[85.19135,28.62825],[85.18668,28.54076],[85.10729,28.34092],[85.38127,28.28336],[85.4233,28.32996],[85.59765,28.30529],[85.60854,28.25045],[85.69105,28.38475],[85.71907,28.38064],[85.74864,28.23126],[85.84672,28.18187],[85.90743,28.05144],[85.97813,27.99023],[85.94946,27.9401],[86.06309,27.90021],[86.12069,27.93047],[86.08333,28.02121],[86.088,28.09264],[86.18607,28.17364],[86.22966,27.9786],[86.42736,27.91122],[86.51609,27.96623],[86.56265,28.09569],[86.74181,28.10638],[86.75582,28.04182],[87.03757,27.94835],[87.11696,27.84104],[87.56996,27.84517],[87.72718,27.80938],[87.82681,27.95248],[88.13378,27.88015],[88.1278,27.95417],[88.25332,27.9478],[88.54858,28.06057],[88.63235,28.12356],[88.83559,28.01936],[88.88091,27.85192],[88.77517,27.45415],[88.82981,27.38814],[88.91901,27.32483],[88.93678,27.33777],[88.96947,27.30319],[89.00216,27.32532],[88.95355,27.4106],[88.97213,27.51671],[89.0582,27.60985],[89.12825,27.62502],[89.59525,28.16433],[89.79762,28.23979],[90.13387,28.19178],[90.58842,28.02838],[90.69894,28.07784],[91.20019,27.98715],[91.25779,28.07509],[91.46327,28.0064],[91.48973,27.93903],[91.5629,27.84823],[91.6469,27.76358],[91.84722,27.76325],[91.87057,27.7195],[92.27432,27.89077],[92.32101,27.79363],[92.42538,27.80092],[92.7275,27.98662],[92.73025,28.05814],[92.65472,28.07632],[92.67486,28.15018],[92.93075,28.25671],[93.14635,28.37035],[93.18069,28.50319],[93.44621,28.67189],[93.72797,28.68821],[94.35897,29.01965],[94.2752,29.11687],[94.69318,29.31739],[94.81353,29.17804],[95.0978,29.14446],[95.11291,29.09527],[95.2214,29.10727],[95.26122,29.07727],[95.3038,29.13847],[95.41091,29.13007],[95.50842,29.13487],[95.72086,29.20797],[95.75149,29.32063],[95.84899,29.31464],[96.05361,29.38167],[96.31316,29.18643],[96.18682,29.11087],[96.20467,29.02325],[96.3626,29.10607],[96.61391,28.72742],[96.40929,28.51526],[96.48895,28.42955],[96.6455,28.61657],[96.85561,28.4875],[96.88445,28.39452],[96.98882,28.32564],[97.1289,28.3619],[97.34547,28.21385],[97.41729,28.29783],[97.47085,28.2688],[97.50518,28.49716],[97.56835,28.55628],[97.70705,28.5056],[97.79632,28.33168],[97.90069,28.3776],[98.15337,28.12114],[98.13964,27.9478],[98.32641,27.51385],[98.42529,27.55404],[98.43353,27.67086],[98.69582,27.56499],[98.7333,26.85615],[98.77547,26.61994],[98.72741,26.36183],[98.67797,26.24487],[98.7329,26.17218],[98.66884,26.09165],[98.63128,26.15492],[98.57085,26.11547],[98.60763,26.01512],[98.70818,25.86241],[98.63128,25.79937],[98.54064,25.85129],[98.40606,25.61129],[98.31268,25.55307],[98.25774,25.6051],[98.16848,25.62739],[98.18084,25.56298],[98.12591,25.50722],[98.14925,25.41547],[97.92541,25.20815],[97.83614,25.2715],[97.77023,25.11492],[97.72216,25.08508],[97.72903,24.91332],[97.79949,24.85655],[97.76481,24.8289],[97.73127,24.83015],[97.70181,24.84557],[97.64354,24.79171],[97.56648,24.76475],[97.56383,24.75535],[97.5542,24.74943],[97.54675,24.74202],[97.56525,24.72838],[97.56286,24.54535],[97.52757,24.43748],[97.60029,24.4401],[97.66998,24.45288],[97.7098,24.35658],[97.65624,24.33781],[97.66723,24.30027],[97.71941,24.29652],[97.76799,24.26365],[97.72998,24.2302],[97.72799,24.18883],[97.75305,24.16902],[97.72903,24.12606],[97.62363,24.00506],[97.5247,23.94032],[97.64667,23.84574],[97.72302,23.89288],[97.79456,23.94836],[97.79416,23.95663],[97.84328,23.97603],[97.86545,23.97723],[97.88811,23.97446],[97.8955,23.97758],[97.89676,23.97931],[97.89683,23.98389],[97.88814,23.98605],[97.88414,23.99405],[97.88616,24.00463],[97.90998,24.02094],[97.93951,24.01953],[97.98691,24.03897],[97.99583,24.04932],[98.04709,24.07616],[98.05302,24.07408],[98.05671,24.07961],[98.0607,24.07812],[98.06703,24.08028],[98.07806,24.07988],[98.20666,24.11406],[98.54476,24.13119],[98.59256,24.08371],[98.85319,24.13042],[98.87998,24.15624],[98.89632,24.10612],[98.67797,23.9644],[98.68209,23.80492],[98.79607,23.77947],[98.82933,23.72921],[98.81775,23.694],[98.88396,23.59555],[98.80294,23.5345],[98.82877,23.47908],[98.87683,23.48995],[98.92104,23.36946],[98.87573,23.33038],[98.93958,23.31414],[98.92515,23.29535],[98.88597,23.18656],[99.05975,23.16382],[99.04601,23.12215],[99.25741,23.09025],[99.34127,23.13099],[99.52214,23.08218],[99.54218,22.90014],[99.43537,22.94086],[99.45654,22.85726],[99.31243,22.73893],[99.38247,22.57544],[99.37972,22.50188],[99.28771,22.4105],[99.17318,22.18025],[99.19176,22.16983],[99.1552,22.15874],[99.33166,22.09656],[99.47585,22.13345],[99.85351,22.04183],[99.96612,22.05965],[99.99084,21.97053],[99.94003,21.82782],[99.98654,21.71064],[100.04956,21.66843],[100.12679,21.70539],[100.17486,21.65306],[100.10757,21.59945],[100.12542,21.50365],[100.1625,21.48704],[100.18447,21.51898],[100.25863,21.47043],[100.35201,21.53176],[100.42892,21.54325],[100.4811,21.46148],[100.57861,21.45637],[100.72143,21.51898],[100.87265,21.67396],[101.11744,21.77659],[101.15156,21.56129],[101.2124,21.56422],[101.19349,21.41959],[101.26912,21.36482],[101.2229,21.23271],[101.29326,21.17254],[101.54563,21.25668],[101.6068,21.23329],[101.59491,21.18621],[101.60886,21.17947],[101.66977,21.20004],[101.70548,21.14911],[101.7622,21.14813],[101.79266,21.19025],[101.76745,21.21571],[101.83887,21.20983],[101.84412,21.25291],[101.74014,21.30967],[101.74224,21.48276],[101.7727,21.51794],[101.7475,21.5873],[101.80001,21.57461],[101.83257,21.61562],[101.74555,21.72852],[101.7791,21.83019],[101.62566,21.96574],[101.57525,22.13026],[101.60675,22.13513],[101.53638,22.24794],[101.56789,22.28876],[101.61306,22.27515],[101.68973,22.46843],[101.7685,22.50337],[101.86828,22.38397],[101.90714,22.38688],[101.91344,22.44417],[101.98487,22.42766],[102.03633,22.46164],[102.1245,22.43372],[102.14099,22.40092],[102.16621,22.43336],[102.26428,22.41321],[102.25339,22.4607],[102.41061,22.64184],[102.38415,22.67919],[102.42618,22.69212],[102.46665,22.77108],[102.51802,22.77969],[102.57095,22.7036],[102.60675,22.73376],[102.8636,22.60735],[102.9321,22.48659],[103.0722,22.44775],[103.07843,22.50097],[103.17961,22.55705],[103.15782,22.59873],[103.18895,22.64471],[103.28079,22.68063],[103.32282,22.8127],[103.43179,22.75816],[103.43646,22.70648],[103.52675,22.59155],[103.57812,22.65764],[103.56255,22.69499],[103.64506,22.79979],[103.87904,22.56683],[103.93286,22.52703],[103.94513,22.52553],[103.95191,22.5134],[103.96352,22.50584],[103.96783,22.51173],[103.97384,22.50634],[103.99247,22.51958],[104.01088,22.51823],[104.03734,22.72945],[104.11384,22.80363],[104.27084,22.8457],[104.25683,22.76534],[104.35593,22.69353],[104.47225,22.75813],[104.58122,22.85571],[104.60457,22.81841],[104.65283,22.83419],[104.72755,22.81984],[104.77114,22.90017],[104.84942,22.93631],[104.86765,22.95178],[104.8334,23.01484],[104.79478,23.12934],[104.87382,23.12854],[104.87992,23.17141],[104.91435,23.18666],[104.9486,23.17235],[104.96532,23.20463],[104.98712,23.19176],[105.07002,23.26248],[105.11672,23.25247],[105.17276,23.28679],[105.22569,23.27249],[105.32376,23.39684],[105.40782,23.28107],[105.42805,23.30824],[105.49966,23.20669],[105.56037,23.16806],[105.57594,23.075],[105.72382,23.06641],[105.8726,22.92756],[105.90119,22.94168],[105.99568,22.94178],[106.00179,22.99049],[106.19705,22.98475],[106.27022,22.87722],[106.34961,22.86718],[106.49749,22.91164],[106.51306,22.94891],[106.55976,22.92311],[106.60179,22.92884],[106.6516,22.86862],[106.6734,22.89587],[106.71387,22.88296],[106.71128,22.85982],[106.78422,22.81532],[106.81271,22.8226],[106.83685,22.8098],[106.82404,22.7881],[106.76293,22.73491],[106.72321,22.63606],[106.71698,22.58432],[106.65316,22.5757],[106.61269,22.60301],[106.58395,22.474],[106.55665,22.46498],[106.57221,22.37],[106.55976,22.34841],[106.6516,22.33977],[106.69986,22.22309],[106.67495,22.1885],[106.6983,22.15102],[106.70142,22.02409],[106.68274,21.99811],[106.69276,21.96013],[106.72551,21.97923],[106.74345,22.00965],[106.81038,21.97934],[106.9178,21.97357],[106.92714,21.93459],[106.97228,21.92592],[106.99252,21.95191],[107.05634,21.92303],[107.06101,21.88982],[107.00964,21.85948],[107.02615,21.81981],[107.10771,21.79879],[107.20734,21.71493],[107.24625,21.7077],[107.29296,21.74674],[107.35834,21.6672],[107.35989,21.60063],[107.38636,21.59774],[107.41593,21.64839],[107.47197,21.6672],[107.49532,21.62958],[107.49065,21.59774],[107.54047,21.5934],[107.56537,21.61945],[107.66967,21.60787],[107.80355,21.66141],[107.86114,21.65128],[107.90006,21.5905],[107.92652,21.58906],[107.95232,21.5388],[107.96774,21.53601],[107.97074,21.54072],[107.97383,21.53961],[107.97932,21.54503],[108.02926,21.54997],[108.0569,21.53604],[108.10003,21.47338],[108.00365,17.98159],[111.60491,13.57105],[118.41371,24.06775],[118.11703,24.39734],[118.28244,24.51231],[118.35291,24.51645],[118.42453,24.54644],[118.56434,24.49266],[120.49232,25.22863],[121.03532,26.8787],[123.5458,31.01942],[122.29378,31.76513],[122.80525,33.30571],[123.85601,37.49093],[123.90497,38.79949],[124.17532,39.8232],[124.23201,39.9248],[124.35029,39.95639],[124.37089,40.03004],[124.3322,40.05573],[124.38556,40.11047],[124.40719,40.13655],[124.86913,40.45387],[125.71172,40.85223],[125.76869,40.87908],[126.00335,40.92835],[126.242,41.15454],[126.53189,41.35206],[126.60631,41.65565],[126.90729,41.79955],[127.17841,41.59714],[127.29712,41.49473],[127.92943,41.44291],[128.02633,41.42103],[128.03311,41.39232],[128.12967,41.37931],[128.18546,41.41279],[128.20061,41.40895],[128.30716,41.60322],[128.15119,41.74568],[128.04487,42.01769],[128.94007,42.03537],[128.96068,42.06657],[129.15178,42.17224],[129.22285,42.26491],[129.22423,42.3553],[129.28541,42.41574],[129.42882,42.44702],[129.54701,42.37254],[129.60482,42.44461],[129.72541,42.43739],[129.75294,42.59409],[129.77183,42.69435],[129.7835,42.76521],[129.80719,42.79218],[129.83277,42.86746],[129.85261,42.96494],[129.8865,43.00395],[129.95082,43.01051],[129.96409,42.97306],[130.12957,42.98361],[130.09764,42.91425],[130.26095,42.9027],[130.23068,42.80125],[130.2385,42.71127],[130.41826,42.6011],[130.44361,42.54849],[130.50123,42.61636],[130.55143,42.52158],[130.62107,42.58413],[130.56576,42.68925],[130.40213,42.70788],[130.44361,42.76205],[130.66524,42.84753],[131.02438,42.86518],[131.02668,42.91246],[131.135,42.94114],[131.10274,43.04734],[131.20414,43.13654],[131.19031,43.21385],[131.30324,43.39498],[131.29402,43.46695],[131.19492,43.53047],[131.21105,43.82383],[131.26176,43.94011],[131.23583,43.96085],[131.25484,44.03131],[131.30365,44.04262],[131.1108,44.70266],[130.95639,44.85154],[131.48415,44.99513],[131.68466,45.12374],[131.66852,45.2196],[131.76532,45.22609],[131.86903,45.33636],[131.99417,45.2567],[132.83978,45.05916],[132.96373,45.0212],[133.12293,45.1332],[133.09279,45.25693],[133.19419,45.51913],[133.41083,45.57723],[133.48457,45.86203],[133.60442,45.90053],[133.67569,45.9759],[133.72695,46.05576],[133.68047,46.14697],[133.88097,46.25066],[133.91496,46.4274],[133.84104,46.46681],[134.03538,46.75668],[134.20016,47.33458],[134.50898,47.4812],[134.7671,47.72051],[134.55508,47.98651],[134.67098,48.1564],[134.75328,48.36763],[134.49516,48.42884],[132.66989,47.96491],[132.57309,47.71741],[131.90448,47.68011],[131.2635,47.73325],[131.09871,47.6852],[130.95985,47.6957],[130.90915,47.90623],[130.65103,48.10052],[130.84462,48.30942],[130.52147,48.61745],[130.66946,48.88251],[130.43232,48.90844],[130.2355,48.86741],[129.85416,49.11067],[129.67598,49.29596],[129.50685,49.42398],[129.40398,49.44194],[129.35317,49.3481],[129.23232,49.40353],[129.11153,49.36813],[128.72896,49.58676],[127.83476,49.5748],[127.53516,49.84306],[127.49299,50.01251],[127.60515,50.23503],[127.37384,50.28393],[127.36009,50.43787],[127.28765,50.46585],[127.36335,50.58306],[127.28165,50.72075],[127.14586,50.91152],[126.93135,51.0841],[126.90369,51.3238],[126.68349,51.70607],[126.44606,51.98254],[126.558,52.13738],[125.6131,53.07229]],[[113.56865,22.20973],[113.57123,22.20416],[113.60504,22.20464],[113.63011,22.10782],[113.57191,22.07696],[113.54839,22.10909],[113.54942,22.14519],[113.54093,22.15497],[113.52659,22.18271],[113.53552,22.20607],[113.53301,22.21235],[113.53591,22.21369],[113.54093,22.21314],[113.54333,22.21688],[113.5508,22.21672],[113.56865,22.20973]],[[114.50148,22.15017],[113.92195,22.13873],[113.83338,22.1826],[113.81621,22.2163],[113.86771,22.42972],[114.03113,22.5065],[114.05438,22.5026],[114.05729,22.51104],[114.06272,22.51617],[114.07267,22.51855],[114.07817,22.52997],[114.08606,22.53276],[114.09048,22.53716],[114.09692,22.53435],[114.1034,22.5352],[114.11181,22.52878],[114.11656,22.53415],[114.12665,22.54003],[114.13823,22.54319],[114.1482,22.54091],[114.15123,22.55163],[114.1597,22.56041],[114.17247,22.55944],[114.18338,22.55444],[114.20655,22.55706],[114.22185,22.55343],[114.22888,22.5436],[114.25154,22.55977],[114.44998,22.55977],[114.50148,22.15017]]]]}},{type:"Feature",properties:{wikidata:"Q22890",nameEn:"Ireland",level:"sharedLandform"},geometry:null},{type:"Feature",properties:{wikidata:"Q23666",nameEn:"Great Britain",country:"GB",level:"sharedLandform"},geometry:null},{type:"Feature",properties:{wikidata:"Q23681",nameEn:"Northern Cyprus",groups:["Q644636","145","142"],driveSide:"left",callingCodes:["90 392"]},geometry:{type:"MultiPolygon",coordinates:[[[[33.67678,35.03866],[33.67742,35.05963],[33.68474,35.06602],[33.69095,35.06237],[33.70861,35.07644],[33.7161,35.07279],[33.70209,35.04882],[33.71482,35.03722],[33.73824,35.05321],[33.76106,35.04253],[33.78581,35.05104],[33.82067,35.07826],[33.84168,35.06823],[33.8541,35.07201],[33.87479,35.08881],[33.87097,35.09389],[33.87622,35.10457],[33.87224,35.12293],[33.88561,35.12449],[33.88943,35.12007],[33.88737,35.11408],[33.89853,35.11377],[33.91789,35.08688],[33.91299,35.07579],[33.90247,35.07686],[33.89485,35.06873],[33.88367,35.07877],[33.85261,35.0574],[33.8355,35.05777],[33.82051,35.0667],[33.8012,35.04786],[33.81524,35.04192],[33.83055,35.02865],[33.82875,35.01685],[33.84045,35.00616],[33.85216,35.00579],[33.85891,35.001],[33.85621,34.98956],[33.83505,34.98108],[33.84811,34.97075],[33.86432,34.97592],[33.90075,34.96623],[33.98684,34.76642],[35.48515,34.70851],[35.51152,36.10954],[32.82353,35.70297],[32.46489,35.48584],[32.60361,35.16647],[32.64864,35.19967],[32.70947,35.18328],[32.70779,35.14127],[32.85733,35.07742],[32.86406,35.1043],[32.94471,35.09422],[33.01192,35.15639],[33.08249,35.17319],[33.11105,35.15639],[33.15138,35.19504],[33.27068,35.16815],[33.3072,35.16816],[33.31955,35.18096],[33.35056,35.18328],[33.34964,35.17803],[33.35596,35.17942],[33.35612,35.17402],[33.36569,35.17479],[33.3717,35.1788],[33.37248,35.18698],[33.38575,35.2018],[33.4076,35.20062],[33.41675,35.16325],[33.46813,35.10564],[33.48136,35.0636],[33.47825,35.04103],[33.45178,35.02078],[33.45256,35.00288],[33.47666,35.00701],[33.48915,35.06594],[33.53975,35.08151],[33.57478,35.06049],[33.567,35.04803],[33.59658,35.03635],[33.61215,35.0527],[33.63765,35.03869],[33.67678,35.03866]]]]}},{type:"Feature",properties:{wikidata:"Q25231",nameEn:"Svalbard",aliases:["NO-21"],country:"NO",groups:["SJ","154","150","UN"],level:"subterritory",callingCodes:["47 79"]},geometry:{type:"MultiPolygon",coordinates:[[[[-7.49892,77.24208],[32.07813,72.01005],[36.85549,84.09565],[-7.49892,77.24208]]]]}},{type:"Feature",properties:{wikidata:"Q25263",nameEn:"Azores",aliases:["PT-20"],country:"PT",groups:["Q3320166","Q2914565","Q105472","EU","039","150","UN"],callingCodes:["351"]},geometry:{type:"MultiPolygon",coordinates:[[[[-23.12984,40.26428],[-36.43765,41.39418],[-22.54767,33.34416],[-23.12984,40.26428]]]]}},{type:"Feature",properties:{wikidata:"Q25359",nameEn:"Navassa Island",aliases:["UM-76"],country:"US",groups:["UM","Q1352230","029","003","419","019","UN"],level:"subterritory",roadSpeedUnit:"mph",roadHeightUnit:"ft"},geometry:{type:"MultiPolygon",coordinates:[[[[-74.7289,18.71009],[-75.71816,18.46438],[-74.76465,18.06252],[-74.7289,18.71009]]]]}},{type:"Feature",properties:{wikidata:"Q25396",nameEn:"Bonaire",aliases:["BQ-BO","NL-BQ1"],country:"NL",groups:["Q1451600","BQ","029","003","419","019","UN"],level:"subterritory",callingCodes:["599 7"]},geometry:{type:"MultiPolygon",coordinates:[[[[-67.89186,12.4116],[-68.90012,12.62309],[-68.33524,11.78151],[-68.01417,11.77722],[-67.89186,12.4116]]]]}},{type:"Feature",properties:{wikidata:"Q25528",nameEn:"Saba",aliases:["BQ-SA","NL-BQ2"],country:"NL",groups:["Q1451600","BQ","029","003","419","019","UN"],level:"subterritory",callingCodes:["599 4"]},geometry:{type:"MultiPolygon",coordinates:[[[[-63.07669,17.79659],[-63.81314,17.95045],[-63.22932,17.32592],[-63.07669,17.79659]]]]}},{type:"Feature",properties:{wikidata:"Q26180",nameEn:"Sint Eustatius",aliases:["BQ-SE","NL-BQ3"],country:"NL",groups:["Q1451600","BQ","029","003","419","019","UN"],level:"subterritory",callingCodes:["599 3"]},geometry:{type:"MultiPolygon",coordinates:[[[[-63.07669,17.79659],[-63.34999,16.94218],[-62.76692,17.64353],[-63.07669,17.79659]]]]}},{type:"Feature",properties:{wikidata:"Q26253",nameEn:"Madeira",aliases:["PT-30"],country:"PT",groups:["Q3320166","Q2914565","Q105472","EU","039","150","UN"],callingCodes:["351"]},geometry:{type:"MultiPolygon",coordinates:[[[[-19.30302,33.65304],[-16.04789,29.65076],[-11.68307,33.12333],[-19.30302,33.65304]]]]}},{type:"Feature",properties:{wikidata:"Q26927",nameEn:"Lakshadweep",aliases:["IN-LD"],country:"IN",groups:["034","142","UN"],driveSide:"left",callingCodes:["91"]},geometry:{type:"MultiPolygon",coordinates:[[[[67.64074,11.57295],[76.59015,5.591],[72.67494,13.58102],[67.64074,11.57295]]]]}},{type:"Feature",properties:{wikidata:"Q27329",nameEn:"Asian Russia",country:"RU",groups:["142","UN"],callingCodes:["7"]},geometry:{type:"MultiPolygon",coordinates:[[[[-179.99933,64.74703],[-172.76104,63.77445],[-169.03888,65.48473],[-168.95635,65.98512],[-168.25765,71.99091],[-179.9843,71.90735],[-179.99933,64.74703]]],[[[59.99809,51.98263],[60.19925,51.99173],[60.48915,52.15175],[60.72581,52.15538],[60.78201,52.22067],[61.05417,52.35096],[60.98021,52.50068],[60.84709,52.52228],[60.84118,52.63912],[60.71693,52.66245],[60.71989,52.75923],[61.05842,52.92217],[61.23462,53.03227],[62.0422,52.96105],[62.12799,52.99133],[62.14574,53.09626],[61.19024,53.30536],[61.14291,53.41481],[61.29082,53.50992],[61.37957,53.45887],[61.57185,53.50112],[61.55706,53.57144],[60.90626,53.62937],[61.22574,53.80268],[61.14283,53.90063],[60.99796,53.93699],[61.26863,53.92797],[61.3706,54.08464],[61.47603,54.08048],[61.56941,53.95703],[61.65318,54.02445],[62.03913,53.94768],[62.00966,54.04134],[62.38535,54.03961],[62.45931,53.90737],[62.56876,53.94047],[62.58651,54.05871],[63.80604,54.27079],[63.91224,54.20013],[64.02715,54.22679],[63.97686,54.29763],[64.97216,54.4212],[65.11033,54.33028],[65.24663,54.35721],[65.20174,54.55216],[68.21308,54.98645],[68.26661,55.09226],[68.19206,55.18823],[68.90865,55.38148],[69.34224,55.36344],[69.74917,55.35545],[70.19179,55.1476],[70.76493,55.3027],[70.96009,55.10558],[71.08288,54.71253],[71.24185,54.64965],[71.08706,54.33376],[71.10379,54.13326],[71.96141,54.17736],[72.17477,54.36303],[72.43415,53.92685],[72.71026,54.1161],[73.37963,53.96132],[73.74778,54.07194],[73.68921,53.86522],[73.25412,53.61532],[73.39218,53.44623],[75.07405,53.80831],[75.43398,53.98652],[75.3668,54.07439],[76.91052,54.4677],[76.82266,54.1798],[76.44076,54.16017],[76.54243,53.99329],[77.90383,53.29807],[79.11255,52.01171],[80.08138,50.77658],[80.4127,50.95581],[80.44819,51.20855],[80.80318,51.28262],[81.16999,51.15662],[81.06091,50.94833],[81.41248,50.97524],[81.46581,50.77658],[81.94999,50.79307],[82.55443,50.75412],[83.14607,51.00796],[83.8442,50.87375],[84.29385,50.27257],[84.99198,50.06793],[85.24047,49.60239],[86.18709,49.50259],[86.63674,49.80136],[86.79056,49.74787],[86.61307,49.60239],[86.82606,49.51796],[87.03071,49.25142],[87.31465,49.23603],[87.28386,49.11626],[87.478,49.07403],[87.48983,49.13794],[87.81333,49.17354],[87.98977,49.18147],[88.15543,49.30314],[88.17223,49.46934],[88.42449,49.48821],[88.82499,49.44808],[89.70687,49.72535],[89.59711,49.90851],[91.86048,50.73734],[92.07173,50.69585],[92.44714,50.78762],[93.01109,50.79001],[92.99595,50.63183],[94.30823,50.57498],[94.39258,50.22193],[94.49477,50.17832],[94.6121,50.04239],[94.97166,50.04725],[95.02465,49.96941],[95.74757,49.97915],[95.80056,50.04239],[96.97388,49.88413],[97.24639,49.74737],[97.56811,49.84265],[97.56432,49.92801],[97.76871,49.99861],[97.85197,49.91339],[98.29481,50.33561],[98.31373,50.4996],[98.06393,50.61262],[97.9693,50.78044],[98.01472,50.86652],[97.83305,51.00248],[98.05257,51.46696],[98.22053,51.46579],[98.33222,51.71832],[98.74142,51.8637],[98.87768,52.14563],[99.27888,51.96876],[99.75578,51.90108],[99.89203,51.74903],[100.61116,51.73028],[101.39085,51.45753],[101.5044,51.50467],[102.14032,51.35566],[102.32194,50.67982],[102.71178,50.38873],[103.70343,50.13952],[105.32528,50.4648],[106.05562,50.40582],[106.07865,50.33474],[106.47156,50.31909],[106.49628,50.32436],[106.51122,50.34408],[106.58373,50.34044],[106.80326,50.30177],[107.00007,50.1977],[107.1174,50.04239],[107.36407,49.97612],[107.96116,49.93191],[107.95387,49.66659],[108.27937,49.53167],[108.53969,49.32325],[109.18017,49.34709],[109.51325,49.22859],[110.24373,49.16676],[110.39891,49.25083],[110.64493,49.1816],[113.02647,49.60772],[113.20216,49.83356],[114.325,50.28098],[114.9703,50.19254],[115.26068,49.97367],[115.73602,49.87688],[116.22402,50.04477],[116.62502,49.92919],[116.71193,49.83813],[117.27597,49.62544],[117.48208,49.62324],[117.82343,49.52696],[118.61623,49.93809],[119.11003,50.00276],[119.27996,50.13348],[119.38598,50.35162],[119.13553,50.37412],[120.10963,51.671],[120.65907,51.93544],[120.77337,52.20805],[120.61346,52.32447],[120.71673,52.54099],[120.46454,52.63811],[120.04049,52.58773],[120.0451,52.7359],[120.85633,53.28499],[121.39213,53.31888],[122.35063,53.49565],[122.85966,53.47395],[123.26989,53.54843],[123.86158,53.49391],[124.46078,53.21881],[125.17522,53.20225],[125.6131,53.07229],[126.558,52.13738],[126.44606,51.98254],[126.68349,51.70607],[126.90369,51.3238],[126.93135,51.0841],[127.14586,50.91152],[127.28165,50.72075],[127.36335,50.58306],[127.28765,50.46585],[127.36009,50.43787],[127.37384,50.28393],[127.60515,50.23503],[127.49299,50.01251],[127.53516,49.84306],[127.83476,49.5748],[128.72896,49.58676],[129.11153,49.36813],[129.23232,49.40353],[129.35317,49.3481],[129.40398,49.44194],[129.50685,49.42398],[129.67598,49.29596],[129.85416,49.11067],[130.2355,48.86741],[130.43232,48.90844],[130.66946,48.88251],[130.52147,48.61745],[130.84462,48.30942],[130.65103,48.10052],[130.90915,47.90623],[130.95985,47.6957],[131.09871,47.6852],[131.2635,47.73325],[131.90448,47.68011],[132.57309,47.71741],[132.66989,47.96491],[134.49516,48.42884],[134.75328,48.36763],[134.67098,48.1564],[134.55508,47.98651],[134.7671,47.72051],[134.50898,47.4812],[134.20016,47.33458],[134.03538,46.75668],[133.84104,46.46681],[133.91496,46.4274],[133.88097,46.25066],[133.68047,46.14697],[133.72695,46.05576],[133.67569,45.9759],[133.60442,45.90053],[133.48457,45.86203],[133.41083,45.57723],[133.19419,45.51913],[133.09279,45.25693],[133.12293,45.1332],[132.96373,45.0212],[132.83978,45.05916],[131.99417,45.2567],[131.86903,45.33636],[131.76532,45.22609],[131.66852,45.2196],[131.68466,45.12374],[131.48415,44.99513],[130.95639,44.85154],[131.1108,44.70266],[131.30365,44.04262],[131.25484,44.03131],[131.23583,43.96085],[131.26176,43.94011],[131.21105,43.82383],[131.19492,43.53047],[131.29402,43.46695],[131.30324,43.39498],[131.19031,43.21385],[131.20414,43.13654],[131.10274,43.04734],[131.135,42.94114],[131.02668,42.91246],[131.02438,42.86518],[130.66524,42.84753],[130.44361,42.76205],[130.40213,42.70788],[130.56576,42.68925],[130.62107,42.58413],[130.55143,42.52158],[130.56835,42.43281],[130.60805,42.4317],[130.64181,42.41422],[130.66367,42.38024],[130.65022,42.32281],[131.95041,41.5445],[140.9182,45.92937],[145.82343,44.571],[145.23667,43.76813],[153.94307,38.42848],[180,62.52334],[180,71.53642],[155.31937,81.93282],[76.13964,83.37843],[64.18965,69.94255],[66.1708,67.61252],[61.98014,65.72191],[60.74386,64.95767],[59.63945,64.78384],[59.80579,64.13948],[59.24834,63.01859],[59.61398,62.44915],[59.36223,61.3882],[59.50685,60.91162],[58.3853,59.487],[59.15636,59.14682],[59.40376,58.45822],[58.71104,58.07475],[58.81412,57.71602],[58.13789,57.68097],[58.07604,57.08308],[57.28024,56.87898],[57.51527,56.08729],[59.28419,56.15739],[59.49035,55.60486],[58.81825,55.03378],[57.25137,55.26262],[57.14829,54.84204],[57.95234,54.39672],[59.95217,54.85853],[59.70487,54.14846],[58.94336,53.953],[58.79644,52.43392],[59.22409,52.28437],[59.25033,52.46803],[60.17516,52.39457],[60.17253,52.25814],[59.91279,52.06924],[59.99809,51.98263]]]]}},{type:"Feature",properties:{wikidata:"Q34366",nameEn:"Tasmania",aliases:["AU-TAS"],country:"AU",groups:["053","009","UN"],driveSide:"left",callingCodes:["61"]},geometry:{type:"MultiPolygon",coordinates:[[[[123.64533,-39.13605],[159.69067,-56.28945],[159.74028,-39.1978],[123.64533,-39.13605]]]]}},{type:"Feature",properties:{wikidata:"Q34497",nameEn:"Saint Helena",aliases:["SH-HL"],country:"GB",groups:["SH","BOTS","011","202","002","UN"],level:"subterritory",driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["290"]},geometry:{type:"MultiPolygon",coordinates:[[[[-8.3824,-13.9131],[-6.17428,-19.07236],[-3.29308,-15.22647],[-8.3824,-13.9131]]]]}},{type:"Feature",properties:{wikidata:"Q35657",nameEn:"US States",country:"US",level:"subcountryGroup"},geometry:null},{type:"Feature",properties:{wikidata:"Q36117",nameEn:"Borneo",level:"sharedLandform"},geometry:null},{type:"Feature",properties:{wikidata:"Q36678",nameEn:"West Bank",country:"PS",groups:["145","142"],callingCodes:["970"]},geometry:{type:"MultiPolygon",coordinates:[[[[35.47672,31.49578],[35.55941,31.76535],[35.52758,31.9131],[35.54375,31.96587],[35.52012,32.04076],[35.57111,32.21877],[35.55807,32.38674],[35.42078,32.41562],[35.41048,32.43706],[35.41598,32.45593],[35.42034,32.46009],[35.40224,32.50136],[35.35212,32.52047],[35.30685,32.51024],[35.29306,32.50947],[35.25049,32.52453],[35.2244,32.55289],[35.15937,32.50466],[35.10882,32.4757],[35.10024,32.47856],[35.09236,32.47614],[35.08564,32.46948],[35.07059,32.4585],[35.05423,32.41754],[35.05311,32.4024],[35.0421,32.38242],[35.05142,32.3667],[35.04243,32.35008],[35.01772,32.33863],[35.01119,32.28684],[35.02939,32.2671],[35.01841,32.23981],[34.98885,32.20758],[34.95703,32.19522],[34.96009,32.17503],[34.99039,32.14626],[34.98507,32.12606],[34.99437,32.10962],[34.9863,32.09551],[35.00261,32.027],[34.98682,31.96935],[35.00124,31.93264],[35.03489,31.92448],[35.03978,31.89276],[35.03489,31.85919],[34.99712,31.85569],[34.9724,31.83352],[35.01978,31.82944],[35.05617,31.85685],[35.07677,31.85627],[35.14174,31.81325],[35.18603,31.80901],[35.18169,31.82542],[35.19461,31.82687],[35.21469,31.81835],[35.216,31.83894],[35.21128,31.863],[35.20381,31.86716],[35.20673,31.88151],[35.20791,31.8821],[35.20945,31.8815],[35.21016,31.88237],[35.21276,31.88153],[35.2136,31.88241],[35.22014,31.88264],[35.22294,31.87889],[35.22567,31.86745],[35.22817,31.8638],[35.2249,31.85433],[35.2304,31.84222],[35.24816,31.8458],[35.25753,31.8387],[35.251,31.83085],[35.26404,31.82567],[35.25573,31.81362],[35.26058,31.79064],[35.25225,31.7678],[35.26319,31.74846],[35.25182,31.73945],[35.24981,31.72543],[35.2438,31.7201],[35.24315,31.71244],[35.23972,31.70896],[35.22392,31.71899],[35.21937,31.71578],[35.20538,31.72388],[35.18023,31.72067],[35.16478,31.73242],[35.15474,31.73352],[35.15119,31.73634],[35.13931,31.73012],[35.12933,31.7325],[35.11895,31.71454],[35.10782,31.71594],[35.08226,31.69107],[35.00879,31.65426],[34.95249,31.59813],[34.9415,31.55601],[34.94356,31.50743],[34.93258,31.47816],[34.89756,31.43891],[34.87833,31.39321],[34.88932,31.37093],[34.92571,31.34337],[35.02459,31.35979],[35.13033,31.3551],[35.22921,31.37445],[35.39675,31.49572],[35.47672,31.49578]]]]}},{type:"Feature",properties:{wikidata:"Q37362",nameEn:"Akrotiri and Dhekelia",aliases:["SBA"],country:"GB"},geometry:null},{type:"Feature",properties:{wikidata:"Q38095",nameEn:"Gal\xE1pagos Islands",aliases:["EC-W"],country:"EC",groups:["005","419","019","UN"],callingCodes:["593"]},geometry:{type:"MultiPolygon",coordinates:[[[[-93.12365,2.64343],[-92.46744,-2.52874],[-87.07749,-.8849],[-93.12365,2.64343]]]]}},{type:"Feature",properties:{wikidata:"Q39760",nameEn:"Gaza Strip",country:"PS",groups:["145","142"],callingCodes:["970"]},geometry:{type:"MultiPolygon",coordinates:[[[[34.052,31.46619],[34.21853,31.32363],[34.23572,31.2966],[34.24012,31.29591],[34.26742,31.21998],[34.29417,31.24194],[34.36523,31.28963],[34.37381,31.30598],[34.36505,31.36404],[34.40077,31.40926],[34.48892,31.48365],[34.56797,31.54197],[34.48681,31.59711],[34.29262,31.70393],[34.052,31.46619]]]]}},{type:"Feature",properties:{wikidata:"Q40888",nameEn:"Andaman and Nicobar Islands",aliases:["IN-AN"],country:"IN",groups:["034","142","UN"],driveSide:"left",callingCodes:["91"]},geometry:{type:"MultiPolygon",coordinates:[[[[94.42132,5.96581],[94.6371,13.81803],[86.7822,13.41052],[94.42132,5.96581]]]]}},{type:"Feature",properties:{wikidata:"Q41684",nameEn:"Stewart Island",country:"NZ",groups:["053","009","UN"],driveSide:"left",callingCodes:["64"]},geometry:{type:"MultiPolygon",coordinates:[[[[166.59185,-47.61313],[169.70504,-47.56021],[167.52103,-46.41337],[166.59185,-47.61313]]]]}},{type:"Feature",properties:{wikidata:"Q43296",nameEn:"Wake Island",aliases:["WK","WAK","WKUM","872","UM-79"],country:"US",groups:["UM","Q1352230","057","009","UN"],level:"subterritory",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1"]},geometry:{type:"MultiPolygon",coordinates:[[[[167.34779,18.97692],[166.67967,20.14834],[165.82549,18.97692],[167.34779,18.97692]]]]}},{type:"Feature",properties:{wikidata:"Q46275",nameEn:"New Zealand Subantarctic Islands",country:"NZ",groups:["Q851132","053","009","UN"],driveSide:"left"},geometry:{type:"MultiPolygon",coordinates:[[[[164.30551,-47.88072],[161.96603,-56.07661],[179.49541,-50.04657],[179.49541,-47.2902],[169.91032,-47.66283],[164.30551,-47.88072]]]]}},{type:"Feature",properties:{wikidata:"Q46395",nameEn:"British Overseas Territories",aliases:["BOTS","UKOTS"],country:"GB",level:"subcountryGroup"},geometry:null},{type:"Feature",properties:{wikidata:"Q46772",nameEn:"Kerguelen Islands",country:"FR",groups:["EU","TF","Q1451600","014","202","002","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[61.9216,-49.39746],[70.67507,-51.14192],[74.25129,-45.45074],[61.9216,-49.39746]]]]}},{type:"Feature",properties:{wikidata:"Q46879",nameEn:"Baker Island",aliases:["UM-81"],country:"US",groups:["UM","Q1352230","061","009","UN"],level:"subterritory",roadSpeedUnit:"mph",roadHeightUnit:"ft"},geometry:{type:"MultiPolygon",coordinates:[[[[-175.33482,-1.40631],[-175.31323,.5442],[-177.91421,.39582],[-175.33482,-1.40631]]]]}},{type:"Feature",properties:{wikidata:"Q47863",nameEn:"Midway Atoll",aliases:["MI","MID","MIUM","488","UM-71"],country:"US",groups:["UM","Q1352230","061","009","UN"],level:"subterritory",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1"]},geometry:{type:"MultiPolygon",coordinates:[[[[-176.29741,29.09786],[-177.77531,29.29793],[-177.5224,27.7635],[-176.29741,29.09786]]]]}},{type:"Feature",properties:{wikidata:"Q62218",nameEn:"Jarvis Island",aliases:["UM-86"],country:"US",groups:["UM","Q1352230","061","009","UN"],level:"subterritory",roadSpeedUnit:"mph",roadHeightUnit:"ft"},geometry:{type:"MultiPolygon",coordinates:[[[[-160.42921,-1.4364],[-159.12443,.19975],[-160.38779,.30331],[-160.42921,-1.4364]]]]}},{type:"Feature",properties:{wikidata:"Q105472",nameEn:"Macaronesia",level:"sharedLandform"},geometry:null},{type:"Feature",properties:{wikidata:"Q114935",nameEn:"Kermadec Islands",country:"NZ",groups:["Q851132","053","009","UN"],driveSide:"left",callingCodes:["64"]},geometry:{type:"MultiPolygon",coordinates:[[[[-174.40891,-29.09438],[-180,-24.21376],[-179.96512,-35.00791],[-174.40891,-29.09438]]]]}},{type:"Feature",properties:{wikidata:"Q115459",nameEn:"Chatham Islands",aliases:["NZ-CIT"],country:"NZ",groups:["Q851132","053","009","UN"],driveSide:"left",callingCodes:["64"]},geometry:{type:"MultiPolygon",coordinates:[[[[-179.93224,-45.18423],[-172.47015,-45.17912],[-176.30998,-41.38382],[-179.93224,-45.18423]]]]}},{type:"Feature",properties:{wikidata:"Q118863",nameEn:"North Island",country:"NZ",groups:["053","009","UN"],driveSide:"left",callingCodes:["64"]},geometry:{type:"MultiPolygon",coordinates:[[[[179.49541,-47.2902],[179.49541,-36.79303],[174.17679,-32.62487],[170.27492,-36.38133],[174.58663,-40.80446],[174.46634,-41.55028],[179.49541,-47.2902]]]]}},{type:"Feature",properties:{wikidata:"Q120755",nameEn:"South Island",country:"NZ",groups:["053","009","UN"],driveSide:"left",callingCodes:["64"]},geometry:{type:"MultiPolygon",coordinates:[[[[169.70504,-47.56021],[179.49541,-47.2902],[174.46634,-41.55028],[174.58663,-40.80446],[170.27492,-36.38133],[166.56976,-39.94841],[164.8365,-46.0205],[167.52103,-46.41337],[169.70504,-47.56021]]]]}},{type:"Feature",properties:{wikidata:"Q123076",nameEn:"Palmyra Atoll",aliases:["UM-95"],country:"US",groups:["UM","Q1352230","061","009","UN"],level:"subterritory",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1"]},geometry:{type:"MultiPolygon",coordinates:[[[[-161.06795,5.2462],[-161.0731,7.1291],[-163.24478,5.24198],[-161.06795,5.2462]]]]}},{type:"Feature",properties:{wikidata:"Q130574",nameEn:"Chafarinas Islands",country:"ES",groups:["EU","Q191011","015","002","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[-2.40316,35.16893],[-2.43262,35.20652],[-2.45965,35.16527],[-2.40316,35.16893]]]]}},{type:"Feature",properties:{wikidata:"Q130895",nameEn:"Kingman Reef",aliases:["UM-89"],country:"US",groups:["UM","Q1352230","061","009","UN"],level:"subterritory",roadSpeedUnit:"mph",roadHeightUnit:"ft"},geometry:{type:"MultiPolygon",coordinates:[[[[-161.0731,7.1291],[-163.16627,7.15036],[-163.24478,5.24198],[-161.0731,7.1291]]]]}},{type:"Feature",properties:{wikidata:"Q131008",nameEn:"Johnston Atoll",aliases:["JT","JTN","JTUM","396","UM-67"],country:"US",groups:["UM","Q1352230","061","009","UN"],level:"subterritory",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1"]},geometry:{type:"MultiPolygon",coordinates:[[[[-170.65691,16.57199],[-168.87689,16.01159],[-169.2329,17.4933],[-170.65691,16.57199]]]]}},{type:"Feature",properties:{wikidata:"Q131305",nameEn:"Howland Island",aliases:["UM-84"],country:"US",groups:["UM","Q1352230","061","009","UN"],level:"subterritory",roadSpeedUnit:"mph",roadHeightUnit:"ft"},geometry:{type:"MultiPolygon",coordinates:[[[[-177.91421,.39582],[-175.31323,.5442],[-176.74464,2.28109],[-177.91421,.39582]]]]}},{type:"Feature",properties:{wikidata:"Q133888",nameEn:"Ashmore and Cartier Islands",country:"AU",groups:["053","009","UN"],driveSide:"left",callingCodes:["61"]},geometry:{type:"MultiPolygon",coordinates:[[[[123.7463,-11.1783],[120.6877,-13.59408],[125.29076,-12.33139],[123.7463,-11.1783]]]]}},{type:"Feature",properties:{wikidata:"Q153732",nameEn:"Mariana Islands",level:"sharedLandform"},geometry:null},{type:"Feature",properties:{wikidata:"Q172216",nameEn:"Coral Sea Islands",country:"AU",groups:["053","009","UN"],driveSide:"left",callingCodes:["61"]},geometry:{type:"MultiPolygon",coordinates:[[[[159.77159,-28.41151],[156.73836,-14.50464],[145.2855,-9.62524],[147.69992,-17.5933],[152.93188,-20.92631],[154.02855,-24.43238],[159.77159,-28.41151]]]]}},{type:"Feature",properties:{wikidata:"Q179313",nameEn:"Alderney",country:"GB",groups:["GG","830","Q185086","154","150","UN"],level:"subterritory",driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["44 01481"]},geometry:{type:"MultiPolygon",coordinates:[[[[-2.36485,49.48223],[-2.09454,49.46288],[-2.02963,49.91866],[-2.49556,49.79012],[-2.36485,49.48223]]]]}},{type:"Feature",properties:{wikidata:"Q185086",nameEn:"Crown Dependencies",country:"GB",level:"subcountryGroup"},geometry:null},{type:"Feature",properties:{wikidata:"Q190571",nameEn:"Scattered Islands",country:"FR",groups:["EU","TF","Q1451600","014","202","002","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[53.53458,-16.36909],[54.96649,-16.28353],[54.61476,-15.02273],[53.53458,-16.36909]]],[[[38.55969,-20.75596],[40.68027,-23.38889],[43.52893,-15.62903],[38.55969,-20.75596]]],[[[47.03092,-11.05648],[47.11593,-12.08552],[47.96702,-11.46447],[47.03092,-11.05648]]]]}},{type:"Feature",properties:{wikidata:"Q191011",nameEn:"Plazas de soberan\xEDa",country:"ES"},geometry:null},{type:"Feature",properties:{wikidata:"Q191146",nameEn:"Pe\xF1\xF3n de V\xE9lez de la Gomera",country:"ES",groups:["EU","Q191011","015","002","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[-4.30191,35.17419],[-4.30112,35.17058],[-4.29436,35.17149],[-4.30191,35.17419]]]]}},{type:"Feature",properties:{wikidata:"Q201698",nameEn:"Crozet Islands",country:"FR",groups:["EU","TF","Q1451600","014","202","002","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[55.03425,-43.65017],[46.31615,-46.28749],[54.5587,-47.93013],[55.03425,-43.65017]]]]}},{type:"Feature",properties:{wikidata:"Q578170",nameEn:"Contiguous United States",aliases:["CONUS"],country:"US",groups:["Q35657","021","003","019","UN"],roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1"]},geometry:{type:"MultiPolygon",coordinates:[[[[-97.13927,25.96583],[-96.92418,25.97377],[-80.57035,24.0565],[-78.91214,27.76553],[-61.98255,37.34815],[-67.16117,44.20069],[-66.93432,44.82597],[-66.96824,44.83078],[-66.98249,44.87071],[-66.96824,44.90965],[-67.0216,44.95333],[-67.11316,45.11176],[-67.15965,45.16179],[-67.19603,45.16771],[-67.20349,45.1722],[-67.22751,45.16344],[-67.27039,45.1934],[-67.29748,45.18173],[-67.29754,45.14865],[-67.34927,45.122],[-67.48201,45.27351],[-67.42394,45.37969],[-67.50578,45.48971],[-67.42144,45.50584],[-67.43815,45.59162],[-67.6049,45.60725],[-67.80705,45.69528],[-67.80653,45.80022],[-67.75654,45.82324],[-67.80961,45.87531],[-67.75196,45.91814],[-67.78111,45.9392],[-67.78578,47.06473],[-67.87993,47.10377],[-67.94843,47.1925],[-68.23244,47.35712],[-68.37458,47.35851],[-68.38332,47.28723],[-68.57914,47.28431],[-68.60575,47.24659],[-68.70125,47.24399],[-68.89222,47.1807],[-69.05039,47.2456],[-69.05073,47.30076],[-69.05148,47.42012],[-69.22119,47.46461],[-69.99966,46.69543],[-70.05812,46.41768],[-70.18547,46.35357],[-70.29078,46.18832],[-70.23855,46.1453],[-70.31025,45.96424],[-70.24694,45.95138],[-70.25976,45.89675],[-70.41523,45.79497],[-70.38934,45.73215],[-70.54019,45.67291],[-70.68516,45.56964],[-70.72651,45.49771],[-70.62518,45.42286],[-70.65383,45.37592],[-70.78372,45.43269],[-70.82638,45.39828],[-70.80236,45.37444],[-70.84816,45.22698],[-70.89864,45.2398],[-70.91169,45.29849],[-70.95193,45.33895],[-71.0107,45.34819],[-71.01866,45.31573],[-71.08364,45.30623],[-71.14568,45.24128],[-71.19723,45.25438],[-71.22338,45.25184],[-71.29371,45.29996],[-71.37133,45.24624],[-71.44252,45.2361],[-71.40364,45.21382],[-71.42778,45.12624],[-71.48735,45.07784],[-71.50067,45.01357],[-73.35025,45.00942],[-74.32699,44.99029],[-74.66689,45.00646],[-74.8447,45.00606],[-74.99101,44.98051],[-75.01363,44.95608],[-75.2193,44.87821],[-75.41441,44.76614],[-75.76813,44.51537],[-75.8217,44.43176],[-75.95947,44.34463],[-76.00018,44.34896],[-76.16285,44.28262],[-76.1664,44.23051],[-76.244,44.19643],[-76.31222,44.19894],[-76.35324,44.13493],[-76.43859,44.09393],[-76.79706,43.63099],[-79.25796,43.54052],[-79.06921,43.26183],[-79.05512,43.25375],[-79.05544,43.21224],[-79.05002,43.20133],[-79.05384,43.17418],[-79.04652,43.16396],[-79.0427,43.13934],[-79.06881,43.12029],[-79.05671,43.10937],[-79.07486,43.07845],[-79.01055,43.06659],[-78.99941,43.05612],[-79.02424,43.01983],[-79.02074,42.98444],[-78.98126,42.97],[-78.96312,42.95509],[-78.93224,42.95229],[-78.90905,42.93022],[-78.90712,42.89733],[-78.93684,42.82887],[-82.67862,41.67615],[-83.11184,41.95671],[-83.14962,42.04089],[-83.12724,42.2376],[-83.09837,42.28877],[-83.07837,42.30978],[-83.02253,42.33045],[-82.82964,42.37355],[-82.64242,42.55594],[-82.58873,42.54984],[-82.57583,42.5718],[-82.51858,42.611],[-82.51063,42.66025],[-82.46613,42.76615],[-82.4826,42.8068],[-82.45331,42.93139],[-82.4253,42.95423],[-82.4146,42.97626],[-82.42469,42.992],[-82.48419,45.30225],[-83.59589,45.82131],[-83.43746,45.99749],[-83.57017,46.105],[-83.83329,46.12169],[-83.90453,46.05922],[-83.95399,46.05634],[-84.1096,46.23987],[-84.09756,46.25512],[-84.11615,46.2681],[-84.11254,46.32329],[-84.13451,46.39218],[-84.11196,46.50248],[-84.12885,46.53068],[-84.17723,46.52753],[-84.1945,46.54061],[-84.2264,46.53337],[-84.26351,46.49508],[-84.29893,46.49127],[-84.34174,46.50683],[-84.42101,46.49853],[-84.4481,46.48972],[-84.47607,46.45225],[-84.55635,46.45974],[-84.85871,46.88881],[-88.37033,48.30586],[-89.48837,48.01412],[-89.57972,48.00023],[-89.77248,48.02607],[-89.89974,47.98109],[-90.07418,48.11043],[-90.56312,48.09488],[-90.56444,48.12184],[-90.75045,48.09143],[-90.87588,48.2484],[-91.08016,48.18096],[-91.25025,48.08522],[-91.43248,48.04912],[-91.45829,48.07454],[-91.58025,48.04339],[-91.55649,48.10611],[-91.70451,48.11805],[-91.71231,48.19875],[-91.86125,48.21278],[-91.98929,48.25409],[-92.05339,48.35958],[-92.14732,48.36578],[-92.202,48.35252],[-92.26662,48.35651],[-92.30939,48.31251],[-92.27167,48.25046],[-92.37185,48.22259],[-92.48147,48.36609],[-92.45588,48.40624],[-92.50712,48.44921],[-92.65606,48.43471],[-92.71323,48.46081],[-92.69927,48.49573],[-92.62747,48.50278],[-92.6342,48.54133],[-92.7287,48.54005],[-92.94973,48.60866],[-93.25391,48.64266],[-93.33946,48.62787],[-93.3712,48.60599],[-93.39758,48.60364],[-93.40693,48.60948],[-93.44472,48.59147],[-93.47022,48.54357],[-93.66382,48.51845],[-93.79267,48.51631],[-93.80939,48.52439],[-93.80676,48.58232],[-93.83288,48.62745],[-93.85769,48.63284],[-94.23215,48.65202],[-94.25104,48.65729],[-94.25172,48.68404],[-94.27153,48.70232],[-94.4174,48.71049],[-94.44258,48.69223],[-94.53826,48.70216],[-94.54885,48.71543],[-94.58903,48.71803],[-94.69335,48.77883],[-94.69669,48.80918],[-94.70486,48.82365],[-94.70087,48.8339],[-94.687,48.84077],[-94.75017,49.09931],[-94.77355,49.11998],[-94.82487,49.29483],[-94.8159,49.32299],[-94.85381,49.32492],[-94.95681,49.37035],[-94.99532,49.36579],[-95.01419,49.35647],[-95.05825,49.35311],[-95.12903,49.37056],[-95.15357,49.384],[-95.15355,48.9996],[-123.32163,49.00419],[-123.0093,48.83186],[-123.0093,48.76586],[-123.26565,48.6959],[-123.15614,48.35395],[-123.50039,48.21223],[-125.03842,48.53282],[-133.98258,38.06389],[-118.48109,32.5991],[-117.1243,32.53427],[-115.88053,32.63624],[-114.71871,32.71894],[-114.76736,32.64094],[-114.80584,32.62028],[-114.81141,32.55543],[-114.79524,32.55731],[-114.82011,32.49609],[-111.07523,31.33232],[-108.20979,31.33316],[-108.20899,31.78534],[-106.529,31.784],[-106.52266,31.77509],[-106.51251,31.76922],[-106.50962,31.76155],[-106.50111,31.75714],[-106.48815,31.74769],[-106.47298,31.75054],[-106.46726,31.75998],[-106.45244,31.76523],[-106.43419,31.75478],[-106.41773,31.75196],[-106.38003,31.73151],[-106.3718,31.71165],[-106.34864,31.69663],[-106.33419,31.66303],[-106.30305,31.62154],[-106.28084,31.56173],[-106.24612,31.54193],[-106.23711,31.51262],[-106.20346,31.46305],[-106.09025,31.40569],[-106.00363,31.39181],[-104.77674,30.4236],[-104.5171,29.64671],[-104.3969,29.57105],[-104.39363,29.55396],[-104.37752,29.54255],[-103.15787,28.93865],[-102.60596,29.8192],[-101.47277,29.7744],[-101.05686,29.44738],[-101.01128,29.36947],[-100.96725,29.3477],[-100.94579,29.34523],[-100.94056,29.33371],[-100.87982,29.296],[-100.79696,29.24688],[-100.67294,29.09744],[-100.63689,28.90812],[-100.59809,28.88197],[-100.52313,28.75598],[-100.5075,28.74066],[-100.51222,28.70679],[-100.50029,28.66117],[-99.55409,27.61314],[-99.51478,27.55836],[-99.52955,27.49747],[-99.50208,27.50021],[-99.48045,27.49016],[-99.482,27.47128],[-99.49744,27.43746],[-99.53573,27.30926],[-99.08477,26.39849],[-99.03053,26.41249],[-99.00546,26.3925],[-98.35126,26.15129],[-98.30491,26.10475],[-98.27075,26.09457],[-98.24603,26.07191],[-97.97017,26.05232],[-97.95155,26.0625],[-97.66511,26.01708],[-97.52025,25.88518],[-97.49828,25.89877],[-97.45669,25.86874],[-97.42511,25.83969],[-97.37332,25.83854],[-97.35946,25.92189],[-97.13927,25.96583]]]]}},{type:"Feature",properties:{wikidata:"Q620634",nameEn:"Bir Tawil",groups:["015","002"],level:"territory"},geometry:{type:"MultiPolygon",coordinates:[[[[33.17563,22.00405],[33.57251,21.72406],[33.99686,21.76784],[34.0765,22.00501],[33.17563,22.00405]]]]}},{type:"Feature",properties:{wikidata:"Q639185",nameEn:"Peros Banhos",country:"GB",groups:["IO","BOTS","014","202","002","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[72.12587,-4.02588],[70.1848,-6.37445],[72.09518,-5.61768],[72.12587,-4.02588]]]]}},{type:"Feature",properties:{wikidata:"Q644636",nameEn:"Cyprus",level:"sharedLandform"},geometry:null},{type:"Feature",properties:{wikidata:"Q851132",nameEn:"New Zealand Outlying Islands",country:"NZ",level:"subcountryGroup"},geometry:null},{type:"Feature",properties:{wikidata:"Q875134",nameEn:"European Russia",country:"RU",groups:["151","150","UN"],callingCodes:["7"]},geometry:{type:"MultiPolygon",coordinates:[[[[18.57853,55.25302],[19.64312,54.45423],[19.8038,54.44203],[20.63871,54.3706],[21.41123,54.32395],[22.79705,54.36264],[22.7253,54.41732],[22.70208,54.45312],[22.67788,54.532],[22.71293,54.56454],[22.68021,54.58486],[22.7522,54.63525],[22.74225,54.64339],[22.75467,54.6483],[22.73397,54.66604],[22.73631,54.72952],[22.87317,54.79492],[22.85083,54.88711],[22.76422,54.92521],[22.68723,54.9811],[22.65451,54.97037],[22.60075,55.01863],[22.58907,55.07085],[22.47688,55.04408],[22.31562,55.0655],[22.14267,55.05345],[22.11697,55.02131],[22.06087,55.02935],[22.02582,55.05078],[22.03984,55.07888],[21.99543,55.08691],[21.96505,55.07353],[21.85521,55.09493],[21.64954,55.1791],[21.55605,55.20311],[21.51095,55.18507],[21.46766,55.21115],[21.38446,55.29348],[21.35465,55.28427],[21.26425,55.24456],[20.95181,55.27994],[20.60454,55.40986],[18.57853,55.25302]]],[[[26.32936,60.00121],[26.90044,59.63819],[27.85643,59.58538],[28.04187,59.47017],[28.19061,59.39962],[28.21137,59.38058],[28.20537,59.36491],[28.19284,59.35791],[28.14215,59.28934],[28.00689,59.28351],[27.90911,59.24353],[27.87978,59.18097],[27.80482,59.1116],[27.74429,58.98351],[27.36366,58.78381],[27.55489,58.39525],[27.48541,58.22615],[27.62393,58.09462],[27.67282,57.92627],[27.81841,57.89244],[27.78526,57.83963],[27.56689,57.83356],[27.50171,57.78842],[27.52615,57.72843],[27.3746,57.66834],[27.40393,57.62125],[27.31919,57.57672],[27.34698,57.52242],[27.56832,57.53728],[27.52453,57.42826],[27.86101,57.29402],[27.66511,56.83921],[27.86101,56.88204],[28.04768,56.59004],[28.13526,56.57989],[28.10069,56.524],[28.19057,56.44637],[28.16599,56.37806],[28.23716,56.27588],[28.15217,56.16964],[28.30571,56.06035],[28.36888,56.05805],[28.37987,56.11399],[28.43068,56.09407],[28.5529,56.11705],[28.68337,56.10173],[28.63668,56.07262],[28.73418,55.97131],[29.08299,56.03427],[29.21717,55.98971],[29.44692,55.95978],[29.3604,55.75862],[29.51283,55.70294],[29.61446,55.77716],[29.80672,55.79569],[29.97975,55.87281],[30.12136,55.8358],[30.27776,55.86819],[30.30987,55.83592],[30.48257,55.81066],[30.51346,55.78982],[30.51037,55.76568],[30.63344,55.73079],[30.67464,55.64176],[30.72957,55.66268],[30.7845,55.58514],[30.86003,55.63169],[30.93419,55.6185],[30.95204,55.50667],[30.90123,55.46621],[30.93144,55.3914],[30.8257,55.3313],[30.81946,55.27931],[30.87944,55.28223],[30.97369,55.17134],[31.02071,55.06167],[31.00972,55.02783],[30.94243,55.03964],[30.9081,55.02232],[30.95754,54.98609],[30.93144,54.9585],[30.81759,54.94064],[30.8264,54.90062],[30.75165,54.80699],[30.95479,54.74346],[30.97127,54.71967],[31.0262,54.70698],[30.98226,54.68872],[30.99187,54.67046],[31.19339,54.66947],[31.21399,54.63113],[31.08543,54.50361],[31.22945,54.46585],[31.3177,54.34067],[31.30791,54.25315],[31.57002,54.14535],[31.89599,54.0837],[31.88744,54.03653],[31.85019,53.91801],[31.77028,53.80015],[31.89137,53.78099],[32.12621,53.81586],[32.36663,53.7166],[32.45717,53.74039],[32.50112,53.68594],[32.40499,53.6656],[32.47777,53.5548],[32.74968,53.45597],[32.73257,53.33494],[32.51725,53.28431],[32.40773,53.18856],[32.15368,53.07594],[31.82373,53.10042],[31.787,53.18033],[31.62496,53.22886],[31.56316,53.19432],[31.40523,53.21406],[31.36403,53.13504],[31.3915,53.09712],[31.33519,53.08805],[31.32283,53.04101],[31.24147,53.031],[31.35667,52.97854],[31.592,52.79011],[31.57277,52.71613],[31.50406,52.69707],[31.63869,52.55361],[31.56316,52.51518],[31.61397,52.48843],[31.62084,52.33849],[31.57971,52.32146],[31.70735,52.26711],[31.6895,52.1973],[31.77877,52.18636],[31.7822,52.11406],[31.81722,52.09955],[31.85018,52.11305],[31.96141,52.08015],[31.92159,52.05144],[32.08813,52.03319],[32.23331,52.08085],[32.2777,52.10266],[32.34044,52.1434],[32.33083,52.23685],[32.38988,52.24946],[32.3528,52.32842],[32.54781,52.32423],[32.69475,52.25535],[32.85405,52.27888],[32.89937,52.2461],[33.18913,52.3754],[33.51323,52.35779],[33.48027,52.31499],[33.55718,52.30324],[33.78789,52.37204],[34.05239,52.20132],[34.11199,52.14087],[34.09413,52.00835],[34.41136,51.82793],[34.42922,51.72852],[34.07765,51.67065],[34.17599,51.63253],[34.30562,51.5205],[34.22048,51.4187],[34.33446,51.363],[34.23009,51.26429],[34.31661,51.23936],[34.38802,51.2746],[34.6613,51.25053],[34.6874,51.18],[34.82472,51.17483],[34.97304,51.2342],[35.14058,51.23162],[35.12685,51.16191],[35.20375,51.04723],[35.31774,51.08434],[35.40837,51.04119],[35.32598,50.94524],[35.39307,50.92145],[35.41367,50.80227],[35.47704,50.77274],[35.48116,50.66405],[35.39464,50.64751],[35.47463,50.49247],[35.58003,50.45117],[35.61711,50.35707],[35.73659,50.35489],[35.80388,50.41356],[35.8926,50.43829],[36.06893,50.45205],[36.20763,50.3943],[36.30101,50.29088],[36.47817,50.31457],[36.58371,50.28563],[36.56655,50.2413],[36.64571,50.218],[36.69377,50.26982],[36.91762,50.34963],[37.08468,50.34935],[37.48204,50.46079],[37.47243,50.36277],[37.62486,50.29966],[37.62879,50.24481],[37.61113,50.21976],[37.75807,50.07896],[37.79515,50.08425],[37.90776,50.04194],[38.02999,49.94482],[38.02999,49.90592],[38.21675,49.98104],[38.18517,50.08161],[38.32524,50.08866],[38.35408,50.00664],[38.65688,49.97176],[38.68677,50.00904],[38.73311,49.90238],[38.90477,49.86787],[38.9391,49.79524],[39.1808,49.88911],[39.27968,49.75976],[39.44496,49.76067],[39.59142,49.73758],[39.65047,49.61761],[39.84548,49.56064],[40.13249,49.61672],[40.16683,49.56865],[40.03636,49.52321],[40.03087,49.45452],[40.1141,49.38798],[40.14912,49.37681],[40.18331,49.34996],[40.22176,49.25683],[40.01988,49.1761],[39.93437,49.05709],[39.6836,49.05121],[39.6683,48.99454],[39.71353,48.98959],[39.72649,48.9754],[39.74874,48.98675],[39.78368,48.91596],[39.98967,48.86901],[40.03636,48.91957],[40.08168,48.87443],[39.97182,48.79398],[39.79466,48.83739],[39.73104,48.7325],[39.71765,48.68673],[39.67226,48.59368],[39.79764,48.58668],[39.84548,48.57821],[39.86196,48.46633],[39.88794,48.44226],[39.94847,48.35055],[39.84136,48.33321],[39.84273,48.30947],[39.90041,48.3049],[39.91465,48.26743],[39.95248,48.29972],[39.9693,48.29904],[39.97325,48.31399],[39.99241,48.31768],[40.00752,48.22445],[39.94847,48.22811],[39.83724,48.06501],[39.88256,48.04482],[39.77544,48.04206],[39.82213,47.96396],[39.73935,47.82876],[38.87979,47.87719],[38.79628,47.81109],[38.76379,47.69346],[38.35062,47.61631],[38.28679,47.53552],[38.28954,47.39255],[38.22225,47.30788],[38.33074,47.30508],[38.32112,47.2585],[38.23049,47.2324],[38.22955,47.12069],[38.3384,46.98085],[38.12112,46.86078],[37.62608,46.82615],[35.23066,45.79231],[35.04991,45.76827],[36.6645,45.4514],[36.6545,45.3417],[36.5049,45.3136],[36.475,45.2411],[36.4883,45.0488],[33.5943,44.03313],[39.81147,43.06294],[40.0078,43.38551],[40.00853,43.40578],[40.01552,43.42025],[40.01007,43.42411],[40.03312,43.44262],[40.04445,43.47776],[40.10657,43.57344],[40.65957,43.56212],[41.64935,43.22331],[42.40563,43.23226],[42.66667,43.13917],[42.75889,43.19651],[43.03322,43.08883],[43.0419,43.02413],[43.81453,42.74297],[43.73119,42.62043],[43.95517,42.55396],[44.54202,42.75699],[44.70002,42.74679],[44.80941,42.61277],[44.88754,42.74934],[45.15318,42.70598],[45.36501,42.55268],[45.78692,42.48358],[45.61676,42.20768],[46.42738,41.91323],[46.5332,41.87389],[46.58924,41.80547],[46.75269,41.8623],[46.8134,41.76252],[47.00955,41.63583],[46.99554,41.59743],[47.03757,41.55434],[47.10762,41.59044],[47.34579,41.27884],[47.49004,41.26366],[47.54504,41.20275],[47.62288,41.22969],[47.75831,41.19455],[47.87973,41.21798],[48.07587,41.49957],[48.22064,41.51472],[48.2878,41.56221],[48.40277,41.60441],[48.42301,41.65444],[48.55078,41.77917],[48.5867,41.84306],[48.80971,41.95365],[49.2134,44.84989],[49.88945,46.04554],[49.32259,46.26944],[49.16518,46.38542],[48.54988,46.56267],[48.51142,46.69268],[49.01136,46.72716],[48.52326,47.4102],[48.45173,47.40818],[48.15348,47.74545],[47.64973,47.76559],[47.41689,47.83687],[47.38731,47.68176],[47.12107,47.83687],[47.11516,48.27188],[46.49011,48.43019],[46.78392,48.95352],[47.00857,49.04921],[47.04658,49.19834],[46.78398,49.34026],[46.9078,49.86707],[47.18319,49.93721],[47.34589,50.09308],[47.30448,50.30894],[47.58551,50.47867],[48.10044,50.09242],[48.24519,49.86099],[48.42564,49.82283],[48.68352,49.89546],[48.90782,50.02281],[48.57946,50.63278],[48.86936,50.61589],[49.12673,50.78639],[49.41959,50.85927],[49.39001,51.09396],[49.76866,51.11067],[49.97277,51.2405],[50.26859,51.28677],[50.59695,51.61859],[51.26254,51.68466],[51.301,51.48799],[51.77431,51.49536],[51.8246,51.67916],[52.36119,51.74161],[52.54329,51.48444],[53.46165,51.49445],[53.69299,51.23466],[54.12248,51.11542],[54.46331,50.85554],[54.41894,50.61214],[54.55797,50.52006],[54.71476,50.61214],[54.56685,51.01958],[54.72067,51.03261],[55.67774,50.54508],[56.11398,50.7471],[56.17906,50.93204],[57.17302,51.11253],[57.44221,50.88354],[57.74986,50.93017],[57.75578,51.13852],[58.3208,51.15151],[58.87974,50.70852],[59.48928,50.64216],[59.51886,50.49937],[59.81172,50.54451],[60.01288,50.8163],[60.17262,50.83312],[60.31914,50.67705],[60.81833,50.6629],[61.4431,50.80679],[61.56889,51.23679],[61.6813,51.25716],[61.55114,51.32746],[61.50677,51.40687],[60.95655,51.48615],[60.92401,51.61124],[60.5424,51.61675],[60.36787,51.66815],[60.50986,51.7964],[60.09867,51.87135],[59.99809,51.98263],[59.91279,52.06924],[60.17253,52.25814],[60.17516,52.39457],[59.25033,52.46803],[59.22409,52.28437],[58.79644,52.43392],[58.94336,53.953],[59.70487,54.14846],[59.95217,54.85853],[57.95234,54.39672],[57.14829,54.84204],[57.25137,55.26262],[58.81825,55.03378],[59.49035,55.60486],[59.28419,56.15739],[57.51527,56.08729],[57.28024,56.87898],[58.07604,57.08308],[58.13789,57.68097],[58.81412,57.71602],[58.71104,58.07475],[59.40376,58.45822],[59.15636,59.14682],[58.3853,59.487],[59.50685,60.91162],[59.36223,61.3882],[59.61398,62.44915],[59.24834,63.01859],[59.80579,64.13948],[59.63945,64.78384],[60.74386,64.95767],[61.98014,65.72191],[66.1708,67.61252],[64.18965,69.94255],[76.13964,83.37843],[36.85549,84.09565],[32.07813,72.01005],[31.59909,70.16571],[30.84095,69.80584],[30.95011,69.54699],[30.52662,69.54699],[30.16363,69.65244],[29.97205,69.41623],[29.27631,69.2811],[29.26623,69.13794],[29.0444,69.0119],[28.91738,69.04774],[28.45957,68.91417],[28.78224,68.86696],[28.43941,68.53366],[28.62982,68.19816],[29.34179,68.06655],[29.66955,67.79872],[30.02041,67.67523],[29.91155,67.51507],[28.9839,66.94139],[29.91155,66.13863],[30.16363,65.66935],[29.97205,65.70256],[29.74013,65.64025],[29.84096,65.56945],[29.68972,65.31803],[29.61914,65.23791],[29.8813,65.22101],[29.84096,65.1109],[29.61914,65.05993],[29.68972,64.80789],[30.05271,64.79072],[30.12329,64.64862],[30.01238,64.57513],[30.06279,64.35782],[30.4762,64.25728],[30.55687,64.09036],[30.25437,63.83364],[29.98213,63.75795],[30.49637,63.46666],[31.23244,63.22239],[31.29294,63.09035],[31.58535,62.91642],[31.38369,62.66284],[31.10136,62.43042],[29.01829,61.17448],[28.82816,61.1233],[28.47974,60.93365],[27.77352,60.52722],[27.71177,60.3893],[27.44953,60.22766],[26.32936,60.00121]]]]}},{type:"Feature",properties:{wikidata:"Q1083368",nameEn:"Mainland Finland",country:"FI",groups:["EU","154","150","UN"],callingCodes:["358"]},geometry:{type:"MultiPolygon",coordinates:[[[[29.12697,69.69193],[28.36883,69.81658],[28.32849,69.88605],[27.97558,69.99671],[27.95542,70.0965],[27.57226,70.06215],[27.05802,69.92069],[26.64461,69.96565],[26.40261,69.91377],[25.96904,69.68397],[25.69679,69.27039],[25.75729,68.99383],[25.61613,68.89602],[25.42455,68.90328],[25.12206,68.78684],[25.10189,68.63307],[24.93048,68.61102],[24.90023,68.55579],[24.74898,68.65143],[24.18432,68.73936],[24.02299,68.81601],[23.781,68.84514],[23.68017,68.70276],[23.13064,68.64684],[22.53321,68.74393],[22.38367,68.71561],[22.27276,68.89514],[21.63833,69.27485],[21.27827,69.31281],[21.00732,69.22755],[20.98641,69.18809],[21.11099,69.10291],[21.05775,69.0356],[20.72171,69.11874],[20.55258,69.06069],[20.78802,69.03087],[20.91658,68.96764],[20.85104,68.93142],[20.90649,68.89696],[21.03001,68.88969],[22.00429,68.50692],[22.73028,68.40881],[23.10336,68.26551],[23.15377,68.14759],[23.26469,68.15134],[23.40081,68.05545],[23.65793,67.9497],[23.45627,67.85297],[23.54701,67.59306],[23.39577,67.46974],[23.75372,67.43688],[23.75372,67.29914],[23.54701,67.25435],[23.58735,67.20752],[23.56214,67.17038],[23.98563,66.84149],[23.98059,66.79585],[23.89488,66.772],[23.85959,66.56434],[23.63776,66.43568],[23.67591,66.3862],[23.64982,66.30603],[23.71339,66.21299],[23.90497,66.15802],[24.15791,65.85385],[24.14798,65.83466],[24.15107,65.81427],[24.14112,65.39731],[20.15877,63.06556],[19.23413,60.61414],[20.96741,60.71528],[21.15143,60.54555],[21.08159,60.20167],[21.02509,60.12142],[21.35468,59.67511],[20.5104,59.15546],[26.32936,60.00121],[27.44953,60.22766],[27.71177,60.3893],[27.77352,60.52722],[28.47974,60.93365],[28.82816,61.1233],[29.01829,61.17448],[31.10136,62.43042],[31.38369,62.66284],[31.58535,62.91642],[31.29294,63.09035],[31.23244,63.22239],[30.49637,63.46666],[29.98213,63.75795],[30.25437,63.83364],[30.55687,64.09036],[30.4762,64.25728],[30.06279,64.35782],[30.01238,64.57513],[30.12329,64.64862],[30.05271,64.79072],[29.68972,64.80789],[29.61914,65.05993],[29.84096,65.1109],[29.8813,65.22101],[29.61914,65.23791],[29.68972,65.31803],[29.84096,65.56945],[29.74013,65.64025],[29.97205,65.70256],[30.16363,65.66935],[29.91155,66.13863],[28.9839,66.94139],[29.91155,67.51507],[30.02041,67.67523],[29.66955,67.79872],[29.34179,68.06655],[28.62982,68.19816],[28.43941,68.53366],[28.78224,68.86696],[28.45957,68.91417],[28.91738,69.04774],[28.81248,69.11997],[28.8629,69.22395],[29.31664,69.47994],[29.12697,69.69193]]]]}},{type:"Feature",properties:{wikidata:"Q1184963",nameEn:"Alhucemas Islands",country:"ES",groups:["EU","Q191011","015","002","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[-3.90602,35.21494],[-3.88372,35.20767],[-3.89343,35.22728],[-3.90602,35.21494]]]]}},{type:"Feature",properties:{wikidata:"Q1298289",nameEn:"Egmont Islands",country:"GB",groups:["IO","BOTS","014","202","002","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[70.1848,-6.37445],[70.67958,-8.2663],[72.17991,-6.68509],[70.1848,-6.37445]]]]}},{type:"Feature",properties:{wikidata:"Q1352230",nameEn:"US Territories",country:"US",level:"subcountryGroup"},geometry:null},{type:"Feature",properties:{wikidata:"Q1451600",nameEn:"Overseas Countries and Territories of the EU",aliases:["OCT"],level:"subunion"},geometry:null},{type:"Feature",properties:{wikidata:"Q1544253",nameEn:"Great Chagos Bank",country:"GB",groups:["IO","BOTS","014","202","002","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[70.1848,-6.37445],[72.17991,-6.68509],[73.20573,-5.20727],[70.1848,-6.37445]]]]}},{type:"Feature",properties:{wikidata:"Q1585511",nameEn:"Salomon Atoll",country:"GB",groups:["IO","BOTS","014","202","002","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[72.09518,-5.61768],[73.20573,-5.20727],[72.12587,-4.02588],[72.09518,-5.61768]]]]}},{type:"Feature",properties:{wikidata:"Q1681727",nameEn:"Saint-Paul and Amsterdam",country:"FR",groups:["EU","TF","Q1451600","014","202","002","UN"],level:"subterritory"},geometry:{type:"MultiPolygon",coordinates:[[[[76.31747,-42.16264],[80.15867,-36.04977],[71.22311,-38.75287],[76.31747,-42.16264]]]]}},{type:"Feature",properties:{wikidata:"Q1901211",nameEn:"East Malaysia",country:"MY",groups:["Q36117","035","142","UN"],driveSide:"left",callingCodes:["60"]},geometry:{type:"MultiPolygon",coordinates:[[[[110.90339,7.52694],[109.82788,2.86812],[109.62558,1.99182],[109.53794,1.91771],[109.57923,1.80624],[109.66397,1.79972],[109.66397,1.60425],[110.35354,.98869],[110.49182,.88088],[110.62374,.873],[111.22979,1.08326],[111.55434,.97864],[111.82846,.99349],[111.94553,1.12016],[112.15679,1.17004],[112.2127,1.44135],[112.48648,1.56516],[113.021,1.57819],[113.01448,1.42832],[113.64677,1.23933],[114.03788,1.44787],[114.57892,1.5],[114.80706,1.92351],[114.80706,2.21665],[115.1721,2.49671],[115.11343,2.82879],[115.53713,3.14776],[115.58276,3.93499],[115.90217,4.37708],[117.25801,4.35108],[117.47313,4.18857],[117.67641,4.16535],[118.06469,4.16638],[118.93936,4.09009],[119.52945,5.35672],[117.98544,6.27477],[117.93857,6.89845],[117.17735,7.52841],[116.79524,7.43869],[115.02521,5.35005],[115.16236,5.01011],[115.15092,4.87604],[115.20737,4.8256],[115.27819,4.63661],[115.2851,4.42295],[115.36346,4.33563],[115.31275,4.30806],[115.09978,4.39123],[115.07737,4.53418],[115.04064,4.63706],[115.02278,4.74137],[115.02955,4.82087],[115.05038,4.90275],[114.99417,4.88201],[114.96982,4.81146],[114.88841,4.81905],[114.8266,4.75062],[114.77303,4.72871],[114.83189,4.42387],[114.88039,4.4257],[114.78539,4.12205],[114.64211,4.00694],[114.49922,4.13108],[114.4416,4.27588],[114.32176,4.2552],[114.32176,4.34942],[114.26876,4.49878],[114.15813,4.57],[114.07448,4.58441],[114.10166,4.76112],[110.90339,7.52694]]]]}},{type:"Feature",properties:{wikidata:"Q1973345",nameEn:"Peninsular Malaysia",country:"MY",groups:["035","142","UN"],driveSide:"left",callingCodes:["60"]},geometry:{type:"MultiPolygon",coordinates:[[[[102.46318,7.22462],[102.09086,6.23546],[102.08127,6.22679],[102.07732,6.193],[102.09182,6.14161],[102.01835,6.05407],[101.99209,6.04075],[101.97114,6.01992],[101.9714,6.00575],[101.94712,5.98421],[101.92819,5.85511],[101.91776,5.84269],[101.89188,5.8386],[101.80144,5.74505],[101.75074,5.79091],[101.69773,5.75881],[101.58019,5.93534],[101.25524,5.78633],[101.25755,5.71065],[101.14062,5.61613],[100.98815,5.79464],[101.02708,5.91013],[101.087,5.9193],[101.12388,6.11411],[101.06165,6.14161],[101.12618,6.19431],[101.10313,6.25617],[100.85884,6.24929],[100.81045,6.45086],[100.74822,6.46231],[100.74361,6.50811],[100.66986,6.45086],[100.43027,6.52389],[100.42351,6.51762],[100.41791,6.5189],[100.41152,6.52299],[100.35413,6.54932],[100.31929,6.65413],[100.32607,6.65933],[100.32671,6.66526],[100.31884,6.66423],[100.31618,6.66781],[100.30828,6.66462],[100.29651,6.68439],[100.19511,6.72559],[100.12,6.42105],[100.0756,6.4045],[99.91873,6.50233],[99.50117,6.44501],[99.31854,5.99868],[99.75778,3.86466],[103.03657,1.30383],[103.56591,1.19719],[103.62738,1.35255],[103.67468,1.43166],[103.7219,1.46108],[103.74161,1.4502],[103.76395,1.45183],[103.81181,1.47953],[103.86383,1.46288],[103.89565,1.42841],[103.93384,1.42926],[104.00131,1.42405],[104.02277,1.4438],[104.04622,1.44691],[104.07348,1.43322],[104.08871,1.42015],[104.09162,1.39694],[104.08072,1.35998],[104.12282,1.27714],[104.34728,1.33529],[104.56723,1.44271],[105.01437,3.24936],[102.46318,7.22462]]]]}},{type:"Feature",properties:{wikidata:"Q2093907",nameEn:"Three Kings Islands",country:"NZ",groups:["Q851132","053","009","UN"],driveSide:"left"},geometry:{type:"MultiPolygon",coordinates:[[[[174.17679,-32.62487],[170.93268,-32.97889],[171.97383,-34.64644],[174.17679,-32.62487]]]]}},{type:"Feature",properties:{wikidata:"Q2298216",nameEn:"Solander Islands",country:"NZ",groups:["Q851132","053","009","UN"],driveSide:"left"},geometry:{type:"MultiPolygon",coordinates:[[[[167.39068,-46.49187],[166.5534,-46.39484],[166.84561,-46.84889],[167.39068,-46.49187]]]]}},{type:"Feature",properties:{wikidata:"Q2872203",nameEn:"Mainland Australia",country:"AU",groups:["053","009","UN"],level:"subcountryGroup",driveSide:"left",callingCodes:["61"]},geometry:{type:"MultiPolygon",coordinates:[[[[88.16419,-23.49578],[123.64533,-39.13605],[159.74028,-39.1978],[159.76765,-29.76946],[154.02855,-24.43238],[152.93188,-20.92631],[147.69992,-17.5933],[145.2855,-9.62524],[143.87386,-9.02382],[143.29772,-9.33993],[142.48658,-9.36754],[142.19246,-9.15378],[141.88934,-9.36111],[141.01842,-9.35091],[135.49042,-9.2276],[127.55165,-9.05052],[125.29076,-12.33139],[88.16419,-23.49578]]]]}},{type:"Feature",properties:{wikidata:"Q2914565",nameEn:"Autonomous Regions of Portugal",country:"PT",level:"subcountryGroup"},geometry:null},{type:"Feature",properties:{wikidata:"Q2915956",nameEn:"Mainland Portugal",country:"PT",groups:["Q12837","EU","039","150","UN"],level:"subcountryGroup",callingCodes:["351"]},geometry:{type:"MultiPolygon",coordinates:[[[[-10.39881,36.12218],[-7.37282,36.96896],[-7.39769,37.16868],[-7.41133,37.20314],[-7.41854,37.23813],[-7.43227,37.25152],[-7.43974,37.38913],[-7.46878,37.47127],[-7.51759,37.56119],[-7.41981,37.75729],[-7.33441,37.81193],[-7.27314,37.90145],[-7.24544,37.98884],[-7.12648,38.00296],[-7.10366,38.04404],[-7.05966,38.01966],[-7.00375,38.01914],[-6.93418,38.21454],[-7.09389,38.17227],[-7.15581,38.27597],[-7.32529,38.44336],[-7.265,38.61674],[-7.26174,38.72107],[-7.03848,38.87221],[-7.051,38.907],[-6.95211,39.0243],[-6.97004,39.07619],[-7.04011,39.11919],[-7.10692,39.10275],[-7.14929,39.11287],[-7.12811,39.17101],[-7.23566,39.20132],[-7.23403,39.27579],[-7.3149,39.34857],[-7.2927,39.45847],[-7.49477,39.58794],[-7.54121,39.66717],[-7.33507,39.64569],[-7.24707,39.66576],[-7.01613,39.66877],[-6.97492,39.81488],[-6.91463,39.86618],[-6.86737,40.01986],[-6.94233,40.10716],[-7.00589,40.12087],[-7.02544,40.18564],[-7.00426,40.23169],[-6.86085,40.26776],[-6.86085,40.2976],[-6.80218,40.33239],[-6.78426,40.36468],[-6.84618,40.42177],[-6.84944,40.46394],[-6.7973,40.51723],[-6.80218,40.55067],[-6.84292,40.56801],[-6.79567,40.65955],[-6.82826,40.74603],[-6.82337,40.84472],[-6.79892,40.84842],[-6.80707,40.88047],[-6.84292,40.89771],[-6.8527,40.93958],[-6.9357,41.02888],[-6.913,41.03922],[-6.88843,41.03027],[-6.84781,41.02692],[-6.80942,41.03629],[-6.79241,41.05397],[-6.75655,41.10187],[-6.77319,41.13049],[-6.69711,41.1858],[-6.68286,41.21641],[-6.65046,41.24725],[-6.55937,41.24417],[-6.38551,41.35274],[-6.38553,41.38655],[-6.3306,41.37677],[-6.26777,41.48796],[-6.19128,41.57638],[-6.29863,41.66432],[-6.44204,41.68258],[-6.49907,41.65823],[-6.54633,41.68623],[-6.56426,41.74219],[-6.51374,41.8758],[-6.56752,41.88429],[-6.5447,41.94371],[-6.58544,41.96674],[-6.61967,41.94008],[-6.75004,41.94129],[-6.76959,41.98734],[-6.81196,41.99097],[-6.82174,41.94493],[-6.94396,41.94403],[-6.95537,41.96553],[-6.98144,41.9728],[-7.01078,41.94977],[-7.07596,41.94977],[-7.08574,41.97401],[-7.14115,41.98855],[-7.18549,41.97515],[-7.18677,41.88793],[-7.32366,41.8406],[-7.37092,41.85031],[-7.42864,41.80589],[-7.42854,41.83262],[-7.44759,41.84451],[-7.45566,41.86488],[-7.49803,41.87095],[-7.52737,41.83939],[-7.62188,41.83089],[-7.58603,41.87944],[-7.65774,41.88308],[-7.69848,41.90977],[-7.84188,41.88065],[-7.88055,41.84571],[-7.88751,41.92553],[-7.90707,41.92432],[-7.92336,41.8758],[-7.9804,41.87337],[-8.01136,41.83453],[-8.0961,41.81024],[-8.16455,41.81753],[-8.16944,41.87944],[-8.19551,41.87459],[-8.2185,41.91237],[-8.16232,41.9828],[-8.08796,42.01398],[-8.08847,42.05767],[-8.11729,42.08537],[-8.18178,42.06436],[-8.19406,42.12141],[-8.18947,42.13853],[-8.1986,42.15402],[-8.22406,42.1328],[-8.24681,42.13993],[-8.2732,42.12396],[-8.29809,42.106],[-8.32161,42.10218],[-8.33912,42.08358],[-8.36353,42.09065],[-8.38323,42.07683],[-8.40143,42.08052],[-8.42512,42.07199],[-8.44123,42.08218],[-8.48185,42.0811],[-8.52837,42.07658],[-8.5252,42.06264],[-8.54563,42.0537],[-8.58086,42.05147],[-8.59493,42.05708],[-8.63791,42.04691],[-8.64626,42.03668],[-8.65832,42.02972],[-8.6681,41.99703],[-8.69071,41.98862],[-8.7478,41.96282],[-8.74606,41.9469],[-8.75712,41.92833],[-8.81794,41.90375],[-8.87157,41.86488],[-11.19304,41.83075],[-10.39881,36.12218]]]]}},{type:"Feature",properties:{wikidata:"Q3311985",nameEn:"Guernsey",country:"GB",groups:["GG","830","Q185086","154","150","UN"],level:"subterritory",driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["44 01481"]},geometry:{type:"MultiPolygon",coordinates:[[[[-2.49556,49.79012],[-3.28154,49.57329],[-2.65349,49.15373],[-2.36485,49.48223],[-2.49556,49.79012]]]]}},{type:"Feature",properties:{wikidata:"Q3320166",nameEn:"Outermost Regions of the EU",aliases:["OMR"],level:"subunion"},geometry:null},{type:"Feature",properties:{wikidata:"Q3336843",nameEn:"Countries of the United Kingdom",aliases:["GB-UKM"],country:"GB",level:"subcountryGroup"},geometry:null},{type:"Feature",properties:{wikidata:"Q6736667",nameEn:"Mainland India",country:"IN",groups:["034","142","UN"],driveSide:"left",callingCodes:["91"]},geometry:{type:"MultiPolygon",coordinates:[[[[89.08044,21.41871],[89.07114,22.15335],[88.9367,22.58527],[88.94614,22.66941],[88.9151,22.75228],[88.96713,22.83346],[88.87063,22.95235],[88.88327,23.03885],[88.86377,23.08759],[88.99148,23.21134],[88.71133,23.2492],[88.79254,23.46028],[88.79351,23.50535],[88.74841,23.47361],[88.56507,23.64044],[88.58087,23.87105],[88.66189,23.87607],[88.73743,23.91751],[88.6976,24.14703],[88.74841,24.1959],[88.68801,24.31464],[88.50934,24.32474],[88.12296,24.51301],[88.08786,24.63232],[88.00683,24.66477],[88.15515,24.85806],[88.14004,24.93529],[88.21832,24.96642],[88.27325,24.88796],[88.33917,24.86803],[88.46277,25.07468],[88.44766,25.20149],[88.94067,25.18534],[89.00463,25.26583],[89.01105,25.30303],[88.85278,25.34679],[88.81296,25.51546],[88.677,25.46959],[88.4559,25.59227],[88.45103,25.66245],[88.242,25.80811],[88.13138,25.78773],[88.08804,25.91334],[88.16581,26.0238],[88.1844,26.14417],[88.34757,26.22216],[88.35153,26.29123],[88.51649,26.35923],[88.48749,26.45855],[88.36938,26.48683],[88.35153,26.45241],[88.33093,26.48929],[88.41196,26.63837],[88.4298,26.54489],[88.62144,26.46783],[88.69485,26.38353],[88.67837,26.26291],[88.78961,26.31093],[88.85004,26.23211],[89.05328,26.2469],[88.91321,26.37984],[88.92357,26.40711],[88.95612,26.4564],[89.08899,26.38845],[89.15869,26.13708],[89.35953,26.0077],[89.53515,26.00382],[89.57101,25.9682],[89.63968,26.22595],[89.70201,26.15138],[89.73581,26.15818],[89.77865,26.08387],[89.77728,26.04254],[89.86592,25.93115],[89.80585,25.82489],[89.84388,25.70042],[89.86129,25.61714],[89.81208,25.37244],[89.84086,25.31854],[89.83371,25.29548],[89.87629,25.28337],[89.90478,25.31038],[90.1155,25.22686],[90.40034,25.1534],[90.65042,25.17788],[90.87427,25.15799],[91.25517,25.20677],[91.63648,25.12846],[92.0316,25.1834],[92.33957,25.07593],[92.39147,25.01471],[92.49887,24.88796],[92.38626,24.86055],[92.25854,24.9191],[92.15796,24.54435],[92.11662,24.38997],[91.96603,24.3799],[91.89258,24.14674],[91.82596,24.22345],[91.76004,24.23848],[91.73257,24.14703],[91.65292,24.22095],[91.63782,24.1132],[91.55542,24.08687],[91.37414,24.10693],[91.35741,23.99072],[91.29587,24.0041],[91.22308,23.89616],[91.25192,23.83463],[91.15579,23.6599],[91.28293,23.37538],[91.36453,23.06612],[91.40848,23.07117],[91.4035,23.27522],[91.46615,23.2328],[91.54993,23.01051],[91.61571,22.93929],[91.7324,23.00043],[91.81634,23.08001],[91.76417,23.26619],[91.84789,23.42235],[91.95642,23.47361],[91.95093,23.73284],[92.04706,23.64229],[92.15417,23.73409],[92.26541,23.70392],[92.38214,23.28705],[92.37665,22.9435],[92.5181,22.71441],[92.60029,22.1522],[92.56616,22.13554],[92.60949,21.97638],[92.67532,22.03547],[92.70416,22.16017],[92.86208,22.05456],[92.89504,21.95143],[92.93899,22.02656],[92.99804,21.98964],[92.99255,22.05965],[93.04885,22.20595],[93.15734,22.18687],[93.14224,22.24535],[93.19991,22.25425],[93.18206,22.43716],[93.13537,22.45873],[93.11477,22.54374],[93.134,22.59573],[93.09417,22.69459],[93.134,22.92498],[93.12988,23.05772],[93.2878,23.00464],[93.38478,23.13698],[93.36862,23.35426],[93.38781,23.36139],[93.39981,23.38828],[93.38805,23.4728],[93.43475,23.68299],[93.3908,23.7622],[93.3908,23.92925],[93.36059,23.93176],[93.32351,24.04468],[93.34735,24.10151],[93.41415,24.07854],[93.46633,23.97067],[93.50616,23.94432],[93.62871,24.00922],[93.75952,24.0003],[93.80279,23.92549],[93.92089,23.95812],[94.14081,23.83333],[94.30215,24.23752],[94.32362,24.27692],[94.45279,24.56656],[94.50729,24.59281],[94.5526,24.70764],[94.60204,24.70889],[94.73937,25.00545],[94.74212,25.13606],[94.57458,25.20318],[94.68032,25.47003],[94.80117,25.49359],[95.18556,26.07338],[95.11428,26.1019],[95.12801,26.38397],[95.05798,26.45408],[95.23513,26.68499],[95.30339,26.65372],[95.437,26.7083],[95.81603,27.01335],[95.93002,27.04149],[96.04949,27.19428],[96.15591,27.24572],[96.40779,27.29818],[96.55761,27.29928],[96.73888,27.36638],[96.88445,27.25046],[96.85287,27.2065],[96.89132,27.17474],[97.14675,27.09041],[97.17422,27.14052],[96.91431,27.45752],[96.90112,27.62149],[97.29919,27.92233],[97.35824,27.87256],[97.38845,28.01329],[97.35412,28.06663],[97.31292,28.06784],[97.34547,28.21385],[97.1289,28.3619],[96.98882,28.32564],[96.88445,28.39452],[96.85561,28.4875],[96.6455,28.61657],[96.48895,28.42955],[96.40929,28.51526],[96.61391,28.72742],[96.3626,29.10607],[96.20467,29.02325],[96.18682,29.11087],[96.31316,29.18643],[96.05361,29.38167],[95.84899,29.31464],[95.75149,29.32063],[95.72086,29.20797],[95.50842,29.13487],[95.41091,29.13007],[95.3038,29.13847],[95.26122,29.07727],[95.2214,29.10727],[95.11291,29.09527],[95.0978,29.14446],[94.81353,29.17804],[94.69318,29.31739],[94.2752,29.11687],[94.35897,29.01965],[93.72797,28.68821],[93.44621,28.67189],[93.18069,28.50319],[93.14635,28.37035],[92.93075,28.25671],[92.67486,28.15018],[92.65472,28.07632],[92.73025,28.05814],[92.7275,27.98662],[92.42538,27.80092],[92.32101,27.79363],[92.27432,27.89077],[91.87057,27.7195],[91.84722,27.76325],[91.6469,27.76358],[91.55819,27.6144],[91.65007,27.48287],[92.01132,27.47352],[92.12019,27.27829],[92.04702,27.26861],[92.03457,27.07334],[92.11863,26.893],[92.05523,26.8692],[91.83181,26.87318],[91.50067,26.79223],[90.67715,26.77215],[90.48504,26.8594],[90.39271,26.90704],[90.30402,26.85098],[90.04535,26.72422],[89.86124,26.73307],[89.63369,26.74402],[89.42349,26.83727],[89.3901,26.84225],[89.38319,26.85963],[89.37913,26.86224],[89.1926,26.81329],[89.12825,26.81661],[89.09554,26.89089],[88.95807,26.92668],[88.92301,26.99286],[88.8714,26.97488],[88.86984,27.10937],[88.74219,27.144],[88.91901,27.32483],[88.82981,27.38814],[88.77517,27.45415],[88.88091,27.85192],[88.83559,28.01936],[88.63235,28.12356],[88.54858,28.06057],[88.25332,27.9478],[88.1278,27.95417],[88.13378,27.88015],[88.1973,27.85067],[88.19107,27.79285],[88.04008,27.49223],[88.07277,27.43007],[88.01646,27.21612],[88.01587,27.21388],[87.9887,27.11045],[88.11719,26.98758],[88.13422,26.98705],[88.12302,26.95324],[88.19107,26.75516],[88.1659,26.68177],[88.16452,26.64111],[88.09963,26.54195],[88.09414,26.43732],[88.00895,26.36029],[87.90115,26.44923],[87.89085,26.48565],[87.84193,26.43663],[87.7918,26.46737],[87.76004,26.40711],[87.67893,26.43501],[87.66803,26.40294],[87.59175,26.38342],[87.55274,26.40596],[87.51571,26.43106],[87.46566,26.44058],[87.37314,26.40815],[87.34568,26.34787],[87.26568,26.37294],[87.26587,26.40592],[87.24682,26.4143],[87.18863,26.40558],[87.14751,26.40542],[87.09147,26.45039],[87.0707,26.58571],[87.04691,26.58685],[87.01559,26.53228],[86.95912,26.52076],[86.94543,26.52076],[86.82898,26.43919],[86.76797,26.45892],[86.74025,26.42386],[86.69124,26.45169],[86.62686,26.46891],[86.61313,26.48658],[86.57073,26.49825],[86.54258,26.53819],[86.49726,26.54218],[86.31564,26.61925],[86.26235,26.61886],[86.22513,26.58863],[86.13596,26.60651],[86.02729,26.66756],[85.8492,26.56667],[85.85126,26.60866],[85.83126,26.61134],[85.76907,26.63076],[85.72315,26.67471],[85.73483,26.79613],[85.66239,26.84822],[85.61621,26.86721],[85.59461,26.85161],[85.5757,26.85955],[85.56471,26.84133],[85.47752,26.79292],[85.34302,26.74954],[85.21159,26.75933],[85.18046,26.80519],[85.19291,26.86909],[85.15883,26.86966],[85.02635,26.85381],[85.05592,26.88991],[85.00536,26.89523],[84.97186,26.9149],[84.96687,26.95599],[84.85754,26.98984],[84.82913,27.01989],[84.793,26.9968],[84.64496,27.04669],[84.69166,27.21294],[84.62161,27.33885],[84.29315,27.39],[84.25735,27.44941],[84.21376,27.45218],[84.10791,27.52399],[84.02229,27.43836],[83.93306,27.44939],[83.86182,27.4241],[83.85595,27.35797],[83.61288,27.47013],[83.39495,27.4798],[83.38872,27.39276],[83.35136,27.33885],[83.29999,27.32778],[83.2673,27.36235],[83.27197,27.38309],[83.19413,27.45632],[82.94938,27.46036],[82.93261,27.50328],[82.74119,27.49838],[82.70378,27.72122],[82.46405,27.6716],[82.06554,27.92222],[81.97214,27.93322],[81.91223,27.84995],[81.47867,28.08303],[81.48179,28.12148],[81.38683,28.17638],[81.32923,28.13521],[81.19847,28.36284],[81.03471,28.40054],[80.55142,28.69182],[80.50575,28.6706],[80.52443,28.54897],[80.44504,28.63098],[80.37188,28.63371],[80.12125,28.82346],[80.06957,28.82763],[80.05743,28.91479],[80.18085,29.13649],[80.23178,29.11626],[80.26602,29.13938],[80.24112,29.21414],[80.28626,29.20327],[80.31428,29.30784],[80.24322,29.44299],[80.37939,29.57098],[80.41858,29.63581],[80.38428,29.68513],[80.36803,29.73865],[80.41554,29.79451],[80.43458,29.80466],[80.48997,29.79566],[80.56247,29.86661],[80.57179,29.91422],[80.60226,29.95732],[80.67076,29.95732],[80.8778,30.13384],[80.86673,30.17321],[80.91143,30.22173],[80.92547,30.17193],[81.03953,30.20059],[80.83343,30.32023],[80.54504,30.44936],[80.20721,30.58541],[79.93255,30.88288],[79.59884,30.93943],[79.30694,31.17357],[79.14016,31.43403],[79.01931,31.42817],[78.89344,31.30481],[78.77898,31.31209],[78.71032,31.50197],[78.84516,31.60631],[78.69933,31.78723],[78.78036,31.99478],[78.74404,32.00384],[78.68754,32.10256],[78.49609,32.2762],[78.4645,32.45367],[78.38897,32.53938],[78.73916,32.69438],[78.7831,32.46873],[78.96713,32.33655],[78.99322,32.37948],[79.0979,32.38051],[79.13174,32.47766],[79.26768,32.53277],[79.46562,32.69668],[79.14016,33.02545],[79.15252,33.17156],[78.73636,33.56521],[78.67599,33.66445],[78.77349,33.73871],[78.73367,34.01121],[78.65657,34.03195],[78.66225,34.08858],[78.91769,34.15452],[78.99802,34.3027],[79.05364,34.32482],[78.74465,34.45174],[78.56475,34.50835],[78.54964,34.57283],[78.27781,34.61484],[78.18435,34.7998],[78.22692,34.88771],[78.00033,35.23954],[78.03466,35.3785],[78.11664,35.48022],[77.80532,35.52058],[77.70232,35.46244],[77.44277,35.46132],[76.96624,35.5932],[76.84539,35.67356],[76.77323,35.66062],[76.75475,35.52617],[76.85088,35.39754],[76.93465,35.39866],[77.11796,35.05419],[76.99251,34.93349],[76.87193,34.96906],[76.74514,34.92488],[76.74377,34.84039],[76.67648,34.76371],[76.47186,34.78965],[76.15463,34.6429],[76.04614,34.67566],[75.75438,34.51827],[75.38009,34.55021],[75.01479,34.64629],[74.6663,34.703],[74.58083,34.77386],[74.31239,34.79626],[74.12897,34.70073],[73.96423,34.68244],[73.93401,34.63386],[73.93951,34.57169],[73.89419,34.54568],[73.88732,34.48911],[73.74999,34.3781],[73.74862,34.34183],[73.8475,34.32935],[73.90517,34.35317],[73.98208,34.2522],[73.90677,34.10504],[73.88732,34.05105],[73.91341,34.01235],[74.21554,34.03853],[74.25262,34.01577],[74.26086,33.92237],[74.14001,33.83002],[74.05898,33.82089],[74.00891,33.75437],[73.96423,33.73071],[73.98968,33.66155],[73.97367,33.64061],[74.03576,33.56718],[74.10115,33.56392],[74.18121,33.4745],[74.17983,33.3679],[74.08782,33.26232],[74.01366,33.25199],[74.02144,33.18908],[74.15374,33.13477],[74.17571,33.07495],[74.31854,33.02891],[74.34875,32.97823],[74.31227,32.92795],[74.41467,32.90563],[74.45312,32.77755],[74.6289,32.75561],[74.64675,32.82604],[74.7113,32.84219],[74.65345,32.71225],[74.69542,32.66792],[74.64424,32.60985],[74.65251,32.56416],[74.67431,32.56676],[74.68362,32.49298],[74.84725,32.49075],[74.97634,32.45367],[75.03265,32.49538],[75.28259,32.36556],[75.38046,32.26836],[75.25649,32.10187],[75.00793,32.03786],[74.9269,32.0658],[74.86236,32.04485],[74.79919,31.95983],[74.58907,31.87824],[74.47771,31.72227],[74.57498,31.60382],[74.61517,31.55698],[74.59319,31.50197],[74.64713,31.45605],[74.59773,31.4136],[74.53223,31.30321],[74.51629,31.13829],[74.56023,31.08303],[74.60281,31.10419],[74.60006,31.13711],[74.6852,31.12771],[74.67971,31.05479],[74.5616,31.04153],[73.88993,30.36305],[73.95736,30.28466],[73.97225,30.19829],[73.80299,30.06969],[73.58665,30.01848],[73.3962,29.94707],[73.28094,29.56646],[73.05886,29.1878],[73.01337,29.16422],[72.94272,29.02487],[72.40402,28.78283],[72.29495,28.66367],[72.20329,28.3869],[71.9244,28.11555],[71.89921,27.96035],[70.79054,27.68423],[70.60927,28.02178],[70.37307,28.01208],[70.12502,27.8057],[70.03136,27.56627],[69.58519,27.18109],[69.50904,26.74892],[69.88555,26.56836],[70.05584,26.60398],[70.17532,26.55362],[70.17532,26.24118],[70.08193,26.08094],[70.0985,25.93238],[70.2687,25.71156],[70.37444,25.67443],[70.53649,25.68928],[70.60378,25.71898],[70.67382,25.68186],[70.66695,25.39314],[70.89148,25.15064],[70.94002,24.92843],[71.09405,24.69017],[70.97594,24.60904],[71.00341,24.46038],[71.12838,24.42662],[71.04461,24.34657],[70.94985,24.3791],[70.85784,24.30903],[70.88393,24.27398],[70.71502,24.23517],[70.57906,24.27774],[70.5667,24.43787],[70.11712,24.30915],[70.03428,24.172],[69.73335,24.17007],[69.59579,24.29777],[69.29778,24.28712],[69.19341,24.25646],[69.07806,24.29777],[68.97781,24.26021],[68.90914,24.33156],[68.7416,24.31904],[68.74643,23.97027],[68.39339,23.96838],[68.20763,23.85849],[68.11329,23.53945],[76.59015,5.591],[79.50447,8.91876],[79.42124,9.80115],[80.48418,10.20786],[89.08044,21.41871]]]]}},{type:"Feature",properties:{wikidata:"Q9143535",nameEn:"Akrotiri",country:"GB",groups:["Q644636","Q37362","BOTS","145","142","UN"],level:"subterritory",driveSide:"left",callingCodes:["357"]},geometry:{type:"MultiPolygon",coordinates:[[[[32.86014,34.70585],[32.82717,34.70622],[32.79433,34.67883],[32.76136,34.68318],[32.75515,34.64985],[32.74412,34.43926],[33.26744,34.49942],[33.0138,34.64424],[32.96968,34.64046],[32.96718,34.63446],[32.95891,34.62919],[32.95323,34.64075],[32.95471,34.64528],[32.94976,34.65204],[32.94796,34.6587],[32.95325,34.66462],[32.97079,34.66112],[32.97736,34.65277],[32.99014,34.65518],[32.98668,34.67268],[32.99135,34.68061],[32.95539,34.68471],[32.94683,34.67907],[32.94379,34.67111],[32.93693,34.67027],[32.93449,34.66241],[32.92807,34.66736],[32.93043,34.67091],[32.91398,34.67343],[32.9068,34.66102],[32.86167,34.68734],[32.86014,34.70585]]]]}},{type:"Feature",properties:{wikidata:"Q9206745",nameEn:"Dhekelia",country:"GB",groups:["Q644636","Q37362","BOTS","145","142","UN"],level:"subterritory",driveSide:"left",callingCodes:["357"]},geometry:{type:"MultiPolygon",coordinates:[[[[33.70575,34.97947],[33.83531,34.73974],[33.98684,34.76642],[33.90075,34.96623],[33.86432,34.97592],[33.84811,34.97075],[33.83505,34.98108],[33.85621,34.98956],[33.85891,35.001],[33.85216,35.00579],[33.84045,35.00616],[33.82875,35.01685],[33.83055,35.02865],[33.81524,35.04192],[33.8012,35.04786],[33.82051,35.0667],[33.8355,35.05777],[33.85261,35.0574],[33.88367,35.07877],[33.89485,35.06873],[33.90247,35.07686],[33.91299,35.07579],[33.91789,35.08688],[33.89853,35.11377],[33.88737,35.11408],[33.88943,35.12007],[33.88561,35.12449],[33.87224,35.12293],[33.87622,35.10457],[33.87097,35.09389],[33.87479,35.08881],[33.8541,35.07201],[33.84168,35.06823],[33.82067,35.07826],[33.78581,35.05104],[33.76106,35.04253],[33.73824,35.05321],[33.71482,35.03722],[33.70209,35.04882],[33.7161,35.07279],[33.70861,35.07644],[33.69095,35.06237],[33.68474,35.06602],[33.67742,35.05963],[33.67678,35.03866],[33.69938,35.03123],[33.69731,35.01754],[33.71514,35.00294],[33.70639,34.99303],[33.70575,34.97947]],[[33.77312,34.9976],[33.77553,34.99518],[33.78516,34.99582],[33.79191,34.98914],[33.78917,34.98854],[33.78571,34.98951],[33.78318,34.98699],[33.78149,34.98854],[33.77843,34.988],[33.7778,34.98981],[33.76738,34.99188],[33.76605,34.99543],[33.75682,34.99916],[33.75994,35.00113],[33.77312,34.9976]],[[33.74144,35.01053],[33.7343,35.01178],[33.73781,35.02181],[33.74265,35.02329],[33.74983,35.02274],[33.7492,35.01319],[33.74144,35.01053]]]]}},{type:"Feature",properties:{wikidata:"Q16390686",nameEn:"Peninsular Spain",country:"ES",groups:["Q12837","EU","039","150","UN"],callingCodes:["34"]},geometry:{type:"MultiPolygon",coordinates:[[[[3.75438,42.33445],[3.17156,42.43545],[3.11379,42.43646],[3.10027,42.42621],[3.08167,42.42748],[3.03734,42.47363],[2.96518,42.46692],[2.94283,42.48174],[2.92107,42.4573],[2.88413,42.45938],[2.86983,42.46843],[2.85675,42.45444],[2.84335,42.45724],[2.77464,42.41046],[2.75497,42.42578],[2.72056,42.42298],[2.65311,42.38771],[2.6747,42.33974],[2.57934,42.35808],[2.55516,42.35351],[2.54382,42.33406],[2.48457,42.33933],[2.43508,42.37568],[2.43299,42.39423],[2.38504,42.39977],[2.25551,42.43757],[2.20578,42.41633],[2.16599,42.42314],[2.12789,42.41291],[2.11621,42.38393],[2.06241,42.35906],[2.00488,42.35399],[1.96482,42.37787],[1.9574,42.42401],[1.94084,42.43039],[1.94061,42.43333],[1.94292,42.44316],[1.93663,42.45439],[1.88853,42.4501],[1.83037,42.48395],[1.76335,42.48863],[1.72515,42.50338],[1.70571,42.48867],[1.66826,42.50779],[1.65674,42.47125],[1.58933,42.46275],[1.57953,42.44957],[1.55937,42.45808],[1.55073,42.43299],[1.5127,42.42959],[1.44529,42.43724],[1.43838,42.47848],[1.41648,42.48315],[1.46661,42.50949],[1.44759,42.54431],[1.41245,42.53539],[1.4234,42.55959],[1.44529,42.56722],[1.42512,42.58292],[1.44197,42.60217],[1.35562,42.71944],[1.15928,42.71407],[1.0804,42.78569],[.98292,42.78754],[.96166,42.80629],[.93089,42.79154],[.711,42.86372],[.66121,42.84021],[.65421,42.75872],[.67873,42.69458],[.40214,42.69779],[.36251,42.72282],[.29407,42.67431],[.25336,42.7174],[.17569,42.73424],[-.02468,42.68513],[-.10519,42.72761],[-.16141,42.79535],[-.17939,42.78974],[-.3122,42.84788],[-.38833,42.80132],[-.41319,42.80776],[-.44334,42.79939],[-.50863,42.82713],[-.55497,42.77846],[-.67637,42.88303],[-.69837,42.87945],[-.72608,42.89318],[-.73422,42.91228],[-.72037,42.92541],[-.75478,42.96916],[-.81652,42.95166],[-.97133,42.96239],[-1.00963,42.99279],[-1.10333,43.0059],[-1.22881,43.05534],[-1.25244,43.04164],[-1.30531,43.06859],[-1.30052,43.09581],[-1.27118,43.11961],[-1.32209,43.1127],[-1.34419,43.09665],[-1.35272,43.02658],[-1.44067,43.047],[-1.47555,43.08372],[-1.41562,43.12815],[-1.3758,43.24511],[-1.40942,43.27272],[-1.45289,43.27049],[-1.50992,43.29481],[-1.55963,43.28828],[-1.57674,43.25269],[-1.61341,43.25269],[-1.63052,43.28591],[-1.62481,43.30726],[-1.69407,43.31378],[-1.73074,43.29481],[-1.7397,43.32979],[-1.75079,43.3317],[-1.75334,43.34107],[-1.77068,43.34396],[-1.78714,43.35476],[-1.78332,43.36399],[-1.79319,43.37497],[-1.77289,43.38957],[-1.81005,43.59738],[-10.14298,44.17365],[-11.19304,41.83075],[-8.87157,41.86488],[-8.81794,41.90375],[-8.75712,41.92833],[-8.74606,41.9469],[-8.7478,41.96282],[-8.69071,41.98862],[-8.6681,41.99703],[-8.65832,42.02972],[-8.64626,42.03668],[-8.63791,42.04691],[-8.59493,42.05708],[-8.58086,42.05147],[-8.54563,42.0537],[-8.5252,42.06264],[-8.52837,42.07658],[-8.48185,42.0811],[-8.44123,42.08218],[-8.42512,42.07199],[-8.40143,42.08052],[-8.38323,42.07683],[-8.36353,42.09065],[-8.33912,42.08358],[-8.32161,42.10218],[-8.29809,42.106],[-8.2732,42.12396],[-8.24681,42.13993],[-8.22406,42.1328],[-8.1986,42.15402],[-8.18947,42.13853],[-8.19406,42.12141],[-8.18178,42.06436],[-8.11729,42.08537],[-8.08847,42.05767],[-8.08796,42.01398],[-8.16232,41.9828],[-8.2185,41.91237],[-8.19551,41.87459],[-8.16944,41.87944],[-8.16455,41.81753],[-8.0961,41.81024],[-8.01136,41.83453],[-7.9804,41.87337],[-7.92336,41.8758],[-7.90707,41.92432],[-7.88751,41.92553],[-7.88055,41.84571],[-7.84188,41.88065],[-7.69848,41.90977],[-7.65774,41.88308],[-7.58603,41.87944],[-7.62188,41.83089],[-7.52737,41.83939],[-7.49803,41.87095],[-7.45566,41.86488],[-7.44759,41.84451],[-7.42854,41.83262],[-7.42864,41.80589],[-7.37092,41.85031],[-7.32366,41.8406],[-7.18677,41.88793],[-7.18549,41.97515],[-7.14115,41.98855],[-7.08574,41.97401],[-7.07596,41.94977],[-7.01078,41.94977],[-6.98144,41.9728],[-6.95537,41.96553],[-6.94396,41.94403],[-6.82174,41.94493],[-6.81196,41.99097],[-6.76959,41.98734],[-6.75004,41.94129],[-6.61967,41.94008],[-6.58544,41.96674],[-6.5447,41.94371],[-6.56752,41.88429],[-6.51374,41.8758],[-6.56426,41.74219],[-6.54633,41.68623],[-6.49907,41.65823],[-6.44204,41.68258],[-6.29863,41.66432],[-6.19128,41.57638],[-6.26777,41.48796],[-6.3306,41.37677],[-6.38553,41.38655],[-6.38551,41.35274],[-6.55937,41.24417],[-6.65046,41.24725],[-6.68286,41.21641],[-6.69711,41.1858],[-6.77319,41.13049],[-6.75655,41.10187],[-6.79241,41.05397],[-6.80942,41.03629],[-6.84781,41.02692],[-6.88843,41.03027],[-6.913,41.03922],[-6.9357,41.02888],[-6.8527,40.93958],[-6.84292,40.89771],[-6.80707,40.88047],[-6.79892,40.84842],[-6.82337,40.84472],[-6.82826,40.74603],[-6.79567,40.65955],[-6.84292,40.56801],[-6.80218,40.55067],[-6.7973,40.51723],[-6.84944,40.46394],[-6.84618,40.42177],[-6.78426,40.36468],[-6.80218,40.33239],[-6.86085,40.2976],[-6.86085,40.26776],[-7.00426,40.23169],[-7.02544,40.18564],[-7.00589,40.12087],[-6.94233,40.10716],[-6.86737,40.01986],[-6.91463,39.86618],[-6.97492,39.81488],[-7.01613,39.66877],[-7.24707,39.66576],[-7.33507,39.64569],[-7.54121,39.66717],[-7.49477,39.58794],[-7.2927,39.45847],[-7.3149,39.34857],[-7.23403,39.27579],[-7.23566,39.20132],[-7.12811,39.17101],[-7.14929,39.11287],[-7.10692,39.10275],[-7.04011,39.11919],[-6.97004,39.07619],[-6.95211,39.0243],[-7.051,38.907],[-7.03848,38.87221],[-7.26174,38.72107],[-7.265,38.61674],[-7.32529,38.44336],[-7.15581,38.27597],[-7.09389,38.17227],[-6.93418,38.21454],[-7.00375,38.01914],[-7.05966,38.01966],[-7.10366,38.04404],[-7.12648,38.00296],[-7.24544,37.98884],[-7.27314,37.90145],[-7.33441,37.81193],[-7.41981,37.75729],[-7.51759,37.56119],[-7.46878,37.47127],[-7.43974,37.38913],[-7.43227,37.25152],[-7.41854,37.23813],[-7.41133,37.20314],[-7.39769,37.16868],[-7.37282,36.96896],[-7.2725,35.73269],[-5.10878,36.05227],[-2.27707,35.35051],[3.75438,42.33445]],[[-5.27801,36.14942],[-5.34064,36.03744],[-5.40526,36.15488],[-5.34536,36.15501],[-5.33822,36.15272],[-5.27801,36.14942]]],[[[1.99838,42.44682],[2.01564,42.45171],[1.99216,42.46208],[1.98579,42.47486],[1.99766,42.4858],[1.98916,42.49351],[1.98022,42.49569],[1.97697,42.48568],[1.97227,42.48487],[1.97003,42.48081],[1.96215,42.47854],[1.95606,42.45785],[1.96125,42.45364],[1.98378,42.44697],[1.99838,42.44682]]]]}},{type:"Feature",properties:{wikidata:"Q98059339",nameEn:"Mainland Norway",country:"NO",groups:["154","150","UN"],callingCodes:["47"]},geometry:{type:"MultiPolygon",coordinates:[[[[10.40861,58.38489],[10.64958,58.89391],[11.08911,58.98745],[11.15367,59.07862],[11.34459,59.11672],[11.4601,58.99022],[11.45199,58.89604],[11.65732,58.90177],[11.8213,59.24985],[11.69297,59.59442],[11.92112,59.69531],[11.87121,59.86039],[12.15641,59.8926],[12.36317,59.99259],[12.52003,60.13846],[12.59133,60.50559],[12.2277,61.02442],[12.69115,61.06584],[12.86939,61.35427],[12.57707,61.56547],[12.40595,61.57226],[12.14746,61.7147],[12.29187,62.25699],[12.07085,62.6297],[12.19919,63.00104],[11.98529,63.27487],[12.19919,63.47935],[12.14928,63.59373],[12.74105,64.02171],[13.23411,64.09087],[13.98222,64.00953],[14.16051,64.18725],[14.11117,64.46674],[13.64276,64.58402],[14.50926,65.31786],[14.53778,66.12399],[15.05113,66.15572],[15.49318,66.28509],[15.37197,66.48217],[16.35589,67.06419],[16.39154,67.21653],[16.09922,67.4364],[16.12774,67.52106],[16.38441,67.52923],[16.7409,67.91037],[17.30416,68.11591],[17.90787,67.96537],[18.13836,68.20874],[18.1241,68.53721],[18.39503,68.58672],[18.63032,68.50849],[18.97255,68.52416],[19.93508,68.35911],[20.22027,68.48759],[19.95647,68.55546],[20.22027,68.67246],[20.33435,68.80174],[20.28444,68.93283],[20.0695,69.04469],[20.55258,69.06069],[20.72171,69.11874],[21.05775,69.0356],[21.11099,69.10291],[20.98641,69.18809],[21.00732,69.22755],[21.27827,69.31281],[21.63833,69.27485],[22.27276,68.89514],[22.38367,68.71561],[22.53321,68.74393],[23.13064,68.64684],[23.68017,68.70276],[23.781,68.84514],[24.02299,68.81601],[24.18432,68.73936],[24.74898,68.65143],[24.90023,68.55579],[24.93048,68.61102],[25.10189,68.63307],[25.12206,68.78684],[25.42455,68.90328],[25.61613,68.89602],[25.75729,68.99383],[25.69679,69.27039],[25.96904,69.68397],[26.40261,69.91377],[26.64461,69.96565],[27.05802,69.92069],[27.57226,70.06215],[27.95542,70.0965],[27.97558,69.99671],[28.32849,69.88605],[28.36883,69.81658],[29.12697,69.69193],[29.31664,69.47994],[28.8629,69.22395],[28.81248,69.11997],[28.91738,69.04774],[29.0444,69.0119],[29.26623,69.13794],[29.27631,69.2811],[29.97205,69.41623],[30.16363,69.65244],[30.52662,69.54699],[30.95011,69.54699],[30.84095,69.80584],[31.59909,70.16571],[32.07813,72.01005],[-11.60274,67.73467],[7.28637,57.35913],[10.40861,58.38489]]]]}},{type:"Feature",properties:{wikidata:"Q98543636",nameEn:"Mainland Ecuador",country:"EC",groups:["005","419","019","UN"],callingCodes:["593"]},geometry:{type:"MultiPolygon",coordinates:[[[[-84.52388,-3.36941],[-80.30602,-3.39149],[-80.20647,-3.431],[-80.24123,-3.46124],[-80.24586,-3.48677],[-80.23651,-3.48652],[-80.22629,-3.501],[-80.20535,-3.51667],[-80.21642,-3.5888],[-80.19848,-3.59249],[-80.18741,-3.63994],[-80.19926,-3.68894],[-80.13232,-3.90317],[-80.46386,-4.01342],[-80.4822,-4.05477],[-80.45023,-4.20938],[-80.32114,-4.21323],[-80.46386,-4.41516],[-80.39256,-4.48269],[-80.13945,-4.29786],[-79.79722,-4.47558],[-79.59402,-4.46848],[-79.26248,-4.95167],[-79.1162,-4.97774],[-79.01659,-5.01481],[-78.85149,-4.66795],[-78.68394,-4.60754],[-78.34362,-3.38633],[-78.24589,-3.39907],[-78.22642,-3.51113],[-78.14324,-3.47653],[-78.19369,-3.36431],[-77.94147,-3.05454],[-76.6324,-2.58397],[-76.05203,-2.12179],[-75.57429,-1.55961],[-75.3872,-.9374],[-75.22862,-.95588],[-75.22862,-.60048],[-75.53615,-.19213],[-75.60169,-.18708],[-75.61997,-.10012],[-75.40192,-.17196],[-75.25764,-.11943],[-75.82927,.09578],[-76.23441,.42294],[-76.41215,.38228],[-76.4094,.24015],[-76.89177,.24736],[-77.52001,.40782],[-77.49984,.64476],[-77.67815,.73863],[-77.66416,.81604],[-77.68613,.83029],[-77.7148,.85003],[-77.85677,.80197],[-78.42749,1.15389],[-78.87137,1.47457],[-82.12561,4.00341],[-84.52388,-3.36941]]]]}},{type:"Feature",properties:{m49:"001",wikidata:"Q2",nameEn:"World",aliases:["Earth","Planet"],level:"world"},geometry:null},{type:"Feature",properties:{m49:"002",wikidata:"Q15",nameEn:"Africa",level:"region"},geometry:null},{type:"Feature",properties:{m49:"003",wikidata:"Q49",nameEn:"North America",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"005",wikidata:"Q18",nameEn:"South America",level:"intermediateRegion"},geometry:null},{type:"Feature",properties:{m49:"009",wikidata:"Q538",nameEn:"Oceania",level:"region"},geometry:null},{type:"Feature",properties:{m49:"011",wikidata:"Q4412",nameEn:"Western Africa",level:"intermediateRegion"},geometry:null},{type:"Feature",properties:{m49:"013",wikidata:"Q27611",nameEn:"Central America",level:"intermediateRegion"},geometry:null},{type:"Feature",properties:{m49:"014",wikidata:"Q27407",nameEn:"Eastern Africa",level:"intermediateRegion"},geometry:null},{type:"Feature",properties:{m49:"015",wikidata:"Q27381",nameEn:"Northern Africa",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"017",wikidata:"Q27433",nameEn:"Middle Africa",level:"intermediateRegion"},geometry:null},{type:"Feature",properties:{m49:"018",wikidata:"Q27394",nameEn:"Southern Africa",level:"intermediateRegion"},geometry:null},{type:"Feature",properties:{m49:"019",wikidata:"Q828",nameEn:"Americas",level:"region"},geometry:null},{type:"Feature",properties:{m49:"021",wikidata:"Q2017699",nameEn:"Northern America",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"029",wikidata:"Q664609",nameEn:"Caribbean",level:"intermediateRegion"},geometry:null},{type:"Feature",properties:{m49:"030",wikidata:"Q27231",nameEn:"Eastern Asia",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"034",wikidata:"Q771405",nameEn:"Southern Asia",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"035",wikidata:"Q11708",nameEn:"South-eastern Asia",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"039",wikidata:"Q27449",nameEn:"Southern Europe",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"053",wikidata:"Q45256",nameEn:"Australia and New Zealand",aliases:["Australasia"],level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"054",wikidata:"Q37394",nameEn:"Melanesia",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"057",wikidata:"Q3359409",nameEn:"Micronesia",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"061",wikidata:"Q35942",nameEn:"Polynesia",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"142",wikidata:"Q48",nameEn:"Asia",level:"region"},geometry:null},{type:"Feature",properties:{m49:"143",wikidata:"Q27275",nameEn:"Central Asia",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"145",wikidata:"Q27293",nameEn:"Western Asia",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"150",wikidata:"Q46",nameEn:"Europe",level:"region"},geometry:null},{type:"Feature",properties:{m49:"151",wikidata:"Q27468",nameEn:"Eastern Europe",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"154",wikidata:"Q27479",nameEn:"Northern Europe",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"155",wikidata:"Q27496",nameEn:"Western Europe",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"202",wikidata:"Q132959",nameEn:"Sub-Saharan Africa",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"419",wikidata:"Q72829598",nameEn:"Latin America and the Caribbean",level:"subregion"},geometry:null},{type:"Feature",properties:{m49:"680",wikidata:"Q3405693",nameEn:"Sark",country:"GB",groups:["GG","830","Q185086","154","150","UN"],level:"subterritory",driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["44 01481"]},geometry:{type:"MultiPolygon",coordinates:[[[[-2.36485,49.48223],[-2.65349,49.15373],[-2.09454,49.46288],[-2.36485,49.48223]]]]}},{type:"Feature",properties:{m49:"830",wikidata:"Q42314",nameEn:"Channel Islands",level:"intermediateRegion"},geometry:null},{type:"Feature",properties:{iso1A2:"AC",iso1A3:"ASC",wikidata:"Q46197",nameEn:"Ascension Island",aliases:["SH-AC"],country:"GB",groups:["SH","BOTS","011","202","002","UN"],isoStatus:"excRes",driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["247"]},geometry:{type:"MultiPolygon",coordinates:[[[[-14.82771,-8.70814],[-13.33271,-8.07391],[-14.91926,-6.63386],[-14.82771,-8.70814]]]]}},{type:"Feature",properties:{iso1A2:"AD",iso1A3:"AND",iso1N3:"020",wikidata:"Q228",nameEn:"Andorra",groups:["Q12837","039","150","UN"],callingCodes:["376"]},geometry:{type:"MultiPolygon",coordinates:[[[[1.72515,42.50338],[1.73683,42.55492],[1.7858,42.57698],[1.72588,42.59098],[1.73452,42.61515],[1.68267,42.62533],[1.6625,42.61982],[1.63485,42.62957],[1.60085,42.62703],[1.55418,42.65669],[1.50867,42.64483],[1.48043,42.65203],[1.46718,42.63296],[1.47986,42.61346],[1.44197,42.60217],[1.42512,42.58292],[1.44529,42.56722],[1.4234,42.55959],[1.41245,42.53539],[1.44759,42.54431],[1.46661,42.50949],[1.41648,42.48315],[1.43838,42.47848],[1.44529,42.43724],[1.5127,42.42959],[1.55073,42.43299],[1.55937,42.45808],[1.57953,42.44957],[1.58933,42.46275],[1.65674,42.47125],[1.66826,42.50779],[1.70571,42.48867],[1.72515,42.50338]]]]}},{type:"Feature",properties:{iso1A2:"AE",iso1A3:"ARE",iso1N3:"784",wikidata:"Q878",nameEn:"United Arab Emirates",groups:["145","142","UN"],callingCodes:["971"]},geometry:{type:"MultiPolygon",coordinates:[[[[56.26534,25.62825],[56.25341,25.61443],[56.26636,25.60643],[56.25365,25.60211],[56.20473,25.61119],[56.18363,25.65508],[56.14826,25.66351],[56.13579,25.73524],[56.17416,25.77239],[56.13963,25.82765],[56.19334,25.9795],[56.15498,26.06828],[56.08666,26.05038],[55.81777,26.18798],[55.14145,25.62624],[53.97892,24.64436],[52.82259,25.51697],[52.35509,25.00368],[52.02277,24.75635],[51.83108,24.71675],[51.58834,24.66608],[51.41644,24.39615],[51.58871,24.27256],[51.59617,24.12041],[52.56622,22.94341],[55.13599,22.63334],[55.2137,22.71065],[55.22634,23.10378],[55.57358,23.669],[55.48677,23.94946],[55.73301,24.05994],[55.8308,24.01633],[56.01799,24.07426],[55.95472,24.2172],[55.83367,24.20193],[55.77658,24.23476],[55.76558,24.23227],[55.75257,24.23466],[55.75382,24.2466],[55.75939,24.26114],[55.76781,24.26209],[55.79145,24.27914],[55.80747,24.31069],[55.83395,24.32776],[55.83271,24.41521],[55.76461,24.5287],[55.83271,24.68567],[55.83408,24.77858],[55.81348,24.80102],[55.81116,24.9116],[55.85094,24.96858],[55.90849,24.96771],[55.96316,25.00857],[56.05715,24.95727],[56.05106,24.87461],[55.97467,24.89639],[55.97836,24.87673],[56.03535,24.81161],[56.06128,24.74457],[56.13684,24.73699],[56.20062,24.78565],[56.20568,24.85063],[56.30269,24.88334],[56.34873,24.93205],[56.3227,24.97284],[56.86325,25.03856],[56.82555,25.7713],[56.26534,25.62825]],[[56.26062,25.33108],[56.3005,25.31815],[56.3111,25.30107],[56.35172,25.30681],[56.34438,25.26653],[56.27628,25.23404],[56.24341,25.22867],[56.20872,25.24104],[56.20838,25.25668],[56.24465,25.27505],[56.25008,25.28843],[56.23362,25.31253],[56.26062,25.33108]]],[[[56.28423,25.26344],[56.29379,25.2754],[56.28102,25.28486],[56.2716,25.27916],[56.27086,25.26128],[56.28423,25.26344]]]]}},{type:"Feature",properties:{iso1A2:"AF",iso1A3:"AFG",iso1N3:"004",wikidata:"Q889",nameEn:"Afghanistan",groups:["034","142","UN"],callingCodes:["93"]},geometry:{type:"MultiPolygon",coordinates:[[[[70.61526,38.34774],[70.60407,38.28046],[70.54673,38.24541],[70.4898,38.12546],[70.17206,37.93276],[70.1863,37.84296],[70.27694,37.81258],[70.28243,37.66706],[70.15015,37.52519],[69.95971,37.5659],[69.93362,37.61378],[69.84435,37.60616],[69.80041,37.5746],[69.51888,37.5844],[69.44954,37.4869],[69.36645,37.40462],[69.45022,37.23315],[69.39529,37.16752],[69.25152,37.09426],[69.03274,37.25174],[68.96407,37.32603],[68.88168,37.33368],[68.91189,37.26704],[68.80889,37.32494],[68.81438,37.23862],[68.6798,37.27906],[68.61851,37.19815],[68.41888,37.13906],[68.41201,37.10402],[68.29253,37.10621],[68.27605,37.00977],[68.18542,37.02074],[68.02194,36.91923],[67.87917,37.0591],[67.7803,37.08978],[67.78329,37.1834],[67.51868,37.26102],[67.2581,37.17216],[67.2224,37.24545],[67.13039,37.27168],[67.08232,37.35469],[66.95598,37.40162],[66.64699,37.32958],[66.55743,37.35409],[66.30993,37.32409],[65.72274,37.55438],[65.64137,37.45061],[65.64263,37.34388],[65.51778,37.23881],[64.97945,37.21913],[64.61141,36.6351],[64.62514,36.44311],[64.57295,36.34362],[64.43288,36.24401],[64.05385,36.10433],[63.98519,36.03773],[63.56496,35.95106],[63.53475,35.90881],[63.29579,35.85985],[63.12276,35.86208],[63.10318,35.81782],[63.23262,35.67487],[63.10079,35.63024],[63.12276,35.53196],[63.0898,35.43131],[62.90853,35.37086],[62.74098,35.25432],[62.62288,35.22067],[62.48006,35.28796],[62.29878,35.13312],[62.29191,35.25964],[62.15871,35.33278],[62.05709,35.43803],[61.97743,35.4604],[61.77693,35.41341],[61.58742,35.43803],[61.27371,35.61482],[61.18187,35.30249],[61.0991,35.27845],[61.12831,35.09938],[61.06926,34.82139],[61.00197,34.70631],[60.99922,34.63064],[60.72316,34.52857],[60.91321,34.30411],[60.66502,34.31539],[60.50209,34.13992],[60.5838,33.80793],[60.5485,33.73422],[60.57762,33.59772],[60.69573,33.56054],[60.91133,33.55596],[60.88908,33.50219],[60.56485,33.12944],[60.86191,32.22565],[60.84541,31.49561],[61.70929,31.37391],[61.80569,31.16167],[61.80957,31.12576],[61.83257,31.0452],[61.8335,30.97669],[61.78268,30.92724],[61.80829,30.84224],[60.87231,29.86514],[62.47751,29.40782],[63.5876,29.50456],[64.12966,29.39157],[64.19796,29.50407],[64.62116,29.58903],[65.04005,29.53957],[66.24175,29.85181],[66.36042,29.9583],[66.23609,30.06321],[66.34869,30.404],[66.28413,30.57001],[66.39194,30.9408],[66.42645,30.95309],[66.58175,30.97532],[66.68166,31.07597],[66.72561,31.20526],[66.83273,31.26867],[67.04147,31.31561],[67.03323,31.24519],[67.29964,31.19586],[67.78854,31.33203],[67.7748,31.4188],[67.62374,31.40473],[67.58323,31.52772],[67.72056,31.52304],[67.86887,31.63536],[68.00071,31.6564],[68.1655,31.82691],[68.25614,31.80357],[68.27605,31.75863],[68.44222,31.76446],[68.57475,31.83158],[68.6956,31.75687],[68.79997,31.61665],[68.91078,31.59687],[68.95995,31.64822],[69.00939,31.62249],[69.11514,31.70782],[69.20577,31.85957],[69.3225,31.93186],[69.27032,32.14141],[69.27932,32.29119],[69.23599,32.45946],[69.2868,32.53938],[69.38155,32.56601],[69.44747,32.6678],[69.43649,32.7302],[69.38018,32.76601],[69.47082,32.85834],[69.5436,32.8768],[69.49854,32.88843],[69.49004,33.01509],[69.57656,33.09911],[69.71526,33.09911],[69.79766,33.13247],[69.85259,33.09451],[70.02563,33.14282],[70.07369,33.22557],[70.13686,33.21064],[70.32775,33.34496],[70.17062,33.53535],[70.20141,33.64387],[70.14785,33.6553],[70.14236,33.71701],[70.00503,33.73528],[69.85671,33.93719],[69.87307,33.9689],[69.90203,34.04194],[70.54336,33.9463],[70.88119,33.97933],[71.07345,34.06242],[71.06933,34.10564],[71.09307,34.11961],[71.09453,34.13524],[71.13078,34.16503],[71.12815,34.26619],[71.17662,34.36769],[71.02401,34.44835],[71.0089,34.54568],[71.11602,34.63047],[71.08718,34.69034],[71.28356,34.80882],[71.29472,34.87728],[71.50329,34.97328],[71.49917,35.00478],[71.55273,35.02615],[71.52938,35.09023],[71.67495,35.21262],[71.5541,35.28776],[71.54294,35.31037],[71.65435,35.4479],[71.49917,35.6267],[71.55273,35.71483],[71.37969,35.95865],[71.19505,36.04134],[71.60491,36.39429],[71.80267,36.49924],[72.18135,36.71838],[72.6323,36.84601],[73.82685,36.91421],[74.04856,36.82648],[74.43389,37.00977],[74.53739,36.96224],[74.56453,37.03023],[74.49981,37.24518],[74.80605,37.21565],[74.88887,37.23275],[74.8294,37.3435],[74.68383,37.3948],[74.56161,37.37734],[74.41055,37.3948],[74.23339,37.41116],[74.20308,37.34208],[73.8564,37.26158],[73.82552,37.22659],[73.64974,37.23643],[73.61129,37.27469],[73.76647,37.33913],[73.77197,37.4417],[73.29633,37.46495],[73.06884,37.31729],[72.79693,37.22222],[72.66381,37.02014],[72.54095,37.00007],[72.31676,36.98115],[71.83229,36.68084],[71.67083,36.67346],[71.57195,36.74943],[71.51502,36.89128],[71.48481,36.93218],[71.46923,36.99925],[71.45578,37.03094],[71.43097,37.05855],[71.44127,37.11856],[71.4494,37.18137],[71.4555,37.21418],[71.47386,37.2269],[71.48339,37.23937],[71.4824,37.24921],[71.48536,37.26017],[71.50674,37.31502],[71.49821,37.31975],[71.4862,37.33405],[71.47685,37.40281],[71.49612,37.4279],[71.5256,37.47971],[71.50616,37.50733],[71.49693,37.53527],[71.5065,37.60912],[71.51972,37.61945],[71.54186,37.69691],[71.55234,37.73209],[71.53053,37.76534],[71.54324,37.77104],[71.55752,37.78677],[71.59255,37.79956],[71.58843,37.92425],[71.51565,37.95349],[71.32871,37.88564],[71.296,37.93403],[71.2809,37.91995],[71.24969,37.93031],[71.27278,37.96496],[71.27622,37.99946],[71.28922,38.01272],[71.29878,38.04429],[71.36444,38.15358],[71.37803,38.25641],[71.33869,38.27335],[71.33114,38.30339],[71.21291,38.32797],[71.1451,38.40106],[71.10957,38.40671],[71.10592,38.42077],[71.09542,38.42517],[71.0556,38.40176],[71.03545,38.44779],[70.98693,38.48862],[70.92728,38.43021],[70.88719,38.46826],[70.84376,38.44688],[70.82538,38.45394],[70.81697,38.44507],[70.80521,38.44447],[70.79766,38.44944],[70.78702,38.45031],[70.78581,38.45502],[70.77132,38.45548],[70.75455,38.4252],[70.72485,38.4131],[70.69807,38.41861],[70.67438,38.40597],[70.6761,38.39144],[70.69189,38.37031],[70.64966,38.34999],[70.61526,38.34774]]]]}},{type:"Feature",properties:{iso1A2:"AG",iso1A3:"ATG",iso1N3:"028",wikidata:"Q781",nameEn:"Antigua and Barbuda",groups:["029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",callingCodes:["1 268"]},geometry:{type:"MultiPolygon",coordinates:[[[[-61.66959,18.6782],[-62.58307,16.68909],[-62.1023,16.97277],[-61.23098,16.62484],[-61.66959,18.6782]]]]}},{type:"Feature",properties:{iso1A2:"AI",iso1A3:"AIA",iso1N3:"660",wikidata:"Q25228",nameEn:"Anguilla",country:"GB",groups:["BOTS","029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",callingCodes:["1 264"]},geometry:{type:"MultiPolygon",coordinates:[[[[-63.79029,19.11219],[-63.35989,18.06012],[-62.62718,18.26185],[-63.79029,19.11219]]]]}},{type:"Feature",properties:{iso1A2:"AL",iso1A3:"ALB",iso1N3:"008",wikidata:"Q222",nameEn:"Albania",groups:["039","150","UN"],callingCodes:["355"]},geometry:{type:"MultiPolygon",coordinates:[[[[20.07761,42.55582],[20.01834,42.54622],[20.00842,42.5109],[19.9324,42.51699],[19.82333,42.46581],[19.76549,42.50237],[19.74731,42.57422],[19.77375,42.58517],[19.73244,42.66299],[19.65972,42.62774],[19.4836,42.40831],[19.42352,42.36546],[19.42,42.33019],[19.28623,42.17745],[19.40687,42.10024],[19.37548,42.06835],[19.36867,42.02564],[19.37691,41.96977],[19.34601,41.95675],[19.33812,41.90669],[19.37451,41.8842],[19.37597,41.84849],[19.26406,41.74971],[19.0384,40.35325],[19.95905,39.82857],[19.97622,39.78684],[19.92466,39.69533],[19.98042,39.6504],[20.00957,39.69227],[20.05189,39.69112],[20.12956,39.65805],[20.15988,39.652],[20.22376,39.64532],[20.22707,39.67459],[20.27412,39.69884],[20.31961,39.72799],[20.29152,39.80421],[20.30804,39.81563],[20.38572,39.78516],[20.41475,39.81437],[20.41546,39.82832],[20.31135,39.99438],[20.37911,39.99058],[20.42373,40.06777],[20.48487,40.06271],[20.51297,40.08168],[20.55593,40.06524],[20.61081,40.07866],[20.62566,40.0897],[20.67162,40.09433],[20.71789,40.27739],[20.78234,40.35803],[20.7906,40.42726],[20.83688,40.47882],[20.94925,40.46625],[20.96908,40.51526],[21.03932,40.56299],[21.05833,40.66586],[20.98134,40.76046],[20.95752,40.76982],[20.98396,40.79109],[20.97887,40.85475],[20.97693,40.90103],[20.94305,40.92399],[20.83671,40.92752],[20.81567,40.89662],[20.73504,40.9081],[20.71634,40.91781],[20.65558,41.08009],[20.63454,41.0889],[20.59832,41.09066],[20.58546,41.11179],[20.59715,41.13644],[20.51068,41.2323],[20.49432,41.33679],[20.52119,41.34381],[20.55976,41.4087],[20.51301,41.442],[20.49039,41.49277],[20.45331,41.51436],[20.45809,41.5549],[20.52103,41.56473],[20.55508,41.58113],[20.51769,41.65975],[20.52937,41.69292],[20.51301,41.72433],[20.53405,41.78099],[20.57144,41.7897],[20.55976,41.87068],[20.59524,41.8818],[20.57946,41.91593],[20.63069,41.94913],[20.59434,42.03879],[20.55633,42.08173],[20.56955,42.12097],[20.48857,42.25444],[20.3819,42.3029],[20.34479,42.32656],[20.24399,42.32168],[20.21797,42.41237],[20.17127,42.50469],[20.07761,42.55582]]]]}},{type:"Feature",properties:{iso1A2:"AM",iso1A3:"ARM",iso1N3:"051",wikidata:"Q399",nameEn:"Armenia",groups:["145","142","UN"],callingCodes:["374"]},geometry:{type:"MultiPolygon",coordinates:[[[[45.0133,41.29747],[44.93493,41.25685],[44.81437,41.30371],[44.80053,41.25949],[44.81749,41.23488],[44.84358,41.23088],[44.89911,41.21366],[44.87887,41.20195],[44.82084,41.21513],[44.72814,41.20338],[44.61462,41.24018],[44.59322,41.1933],[44.46791,41.18204],[44.34417,41.2382],[44.34337,41.20312],[44.32139,41.2079],[44.18148,41.24644],[44.16591,41.19141],[43.84835,41.16329],[43.74717,41.1117],[43.67712,41.13398],[43.4717,41.12611],[43.44984,41.0988],[43.47319,41.02251],[43.58683,40.98961],[43.67712,40.93084],[43.67712,40.84846],[43.74872,40.7365],[43.7425,40.66805],[43.63664,40.54159],[43.54791,40.47413],[43.60862,40.43267],[43.59928,40.34019],[43.71136,40.16673],[43.65221,40.14889],[43.65688,40.11199],[43.92307,40.01787],[44.1057,40.03555],[44.1778,40.02845],[44.26973,40.04866],[44.46635,39.97733],[44.61845,39.8281],[44.75779,39.7148],[44.88354,39.74432],[44.92869,39.72157],[45.06604,39.79277],[45.18554,39.67846],[45.17464,39.58614],[45.21784,39.58074],[45.23535,39.61373],[45.30385,39.61373],[45.29606,39.57654],[45.46992,39.49888],[45.70547,39.60174],[45.80804,39.56716],[45.83,39.46487],[45.79225,39.3695],[45.99774,39.28931],[46.02303,39.09978],[46.06973,39.0744],[46.14785,38.84206],[46.20601,38.85262],[46.34059,38.92076],[46.53497,38.86548],[46.51805,38.94982],[46.54296,39.07078],[46.44022,39.19636],[46.52584,39.18912],[46.54141,39.15895],[46.58032,39.21204],[46.63481,39.23013],[46.56476,39.24942],[46.50093,39.33736],[46.43244,39.35181],[46.37795,39.42039],[46.4013,39.45405],[46.53051,39.47809],[46.51027,39.52373],[46.57721,39.54414],[46.57098,39.56694],[46.52117,39.58734],[46.42465,39.57534],[46.40286,39.63651],[46.18493,39.60533],[45.96543,39.78859],[45.82533,39.82925],[45.7833,39.9475],[45.60895,39.97733],[45.59806,40.0131],[45.78642,40.03218],[45.83779,39.98925],[45.97944,40.181],[45.95609,40.27846],[45.65098,40.37696],[45.42994,40.53804],[45.45484,40.57707],[45.35366,40.65979],[45.4206,40.7424],[45.55914,40.78366],[45.60584,40.87436],[45.40814,40.97904],[45.44083,41.01663],[45.39725,41.02603],[45.35677,40.99784],[45.28859,41.03757],[45.26162,41.0228],[45.25897,41.0027],[45.1994,41.04518],[45.16493,41.05068],[45.1634,41.08082],[45.1313,41.09369],[45.12923,41.06059],[45.06784,41.05379],[45.08028,41.10917],[45.19942,41.13299],[45.1969,41.168],[45.11811,41.19967],[45.05201,41.19211],[45.02932,41.2101],[45.05497,41.2464],[45.0133,41.29747]],[[45.21324,40.9817],[45.21219,40.99001],[45.20518,40.99348],[45.19312,40.98998],[45.18382,41.0066],[45.20625,41.01484],[45.23487,41.00226],[45.23095,40.97828],[45.21324,40.9817]],[[45.00864,41.03411],[44.9903,41.05657],[44.96031,41.06345],[44.95383,41.07553],[44.97169,41.09176],[45.00864,41.09407],[45.03406,41.07931],[45.04517,41.06653],[45.03792,41.03938],[45.00864,41.03411]]],[[[45.50279,40.58424],[45.56071,40.64765],[45.51825,40.67382],[45.47927,40.65023],[45.50279,40.58424]]]]}},{type:"Feature",properties:{iso1A2:"AO",iso1A3:"AGO",iso1N3:"024",wikidata:"Q916",nameEn:"Angola",groups:["017","202","002","UN"],callingCodes:["244"]},geometry:{type:"MultiPolygon",coordinates:[[[[16.55507,-5.85631],[13.04371,-5.87078],[12.42245,-6.07585],[11.95767,-5.94705],[12.20376,-5.76338],[12.26557,-5.74031],[12.52318,-5.74353],[12.52301,-5.17481],[12.53599,-5.1618],[12.53586,-5.14658],[12.51589,-5.1332],[12.49815,-5.14058],[12.46297,-5.09408],[12.60251,-5.01715],[12.63465,-4.94632],[12.70868,-4.95505],[12.8733,-4.74346],[13.11195,-4.67745],[13.09648,-4.63739],[12.91489,-4.47907],[12.87096,-4.40315],[12.76844,-4.38709],[12.64835,-4.55937],[12.40964,-4.60609],[12.32324,-4.78415],[12.25587,-4.79437],[12.20901,-4.75642],[12.16068,-4.90089],[12.00924,-5.02627],[11.50888,-5.33417],[10.5065,-17.25284],[11.75063,-17.25013],[12.07076,-17.15165],[12.52111,-17.24495],[12.97145,-16.98567],[13.36212,-16.98048],[13.95896,-17.43141],[14.28743,-17.38814],[18.39229,-17.38927],[18.84226,-17.80375],[21.14283,-17.94318],[21.42741,-18.02787],[23.47474,-17.62877],[23.20038,-17.47563],[22.17217,-16.50269],[22.00323,-16.18028],[21.97988,-13.00148],[24.03339,-12.99091],[23.90937,-12.844],[24.06672,-12.29058],[23.98804,-12.13149],[24.02603,-11.15368],[24.00027,-10.89356],[23.86868,-11.02856],[23.45631,-10.946],[23.16602,-11.10577],[22.54205,-11.05784],[22.25951,-11.24911],[22.17954,-10.85884],[22.32604,-10.76291],[22.19039,-9.94628],[21.84856,-9.59871],[21.79824,-7.29628],[20.56263,-7.28566],[20.61689,-6.90876],[20.31846,-6.91953],[20.30218,-6.98955],[19.5469,-7.00195],[19.33698,-7.99743],[18.33635,-8.00126],[17.5828,-8.13784],[16.96282,-7.21787],[16.55507,-5.85631]]]]}},{type:"Feature",properties:{iso1A2:"AQ",iso1A3:"ATA",iso1N3:"010",wikidata:"Q51",nameEn:"Antarctica",level:"region",callingCodes:["672"]},geometry:{type:"MultiPolygon",coordinates:[[[[180,-60],[-180,-60],[-180,-90],[180,-90],[180,-60]]]]}},{type:"Feature",properties:{iso1A2:"AR",iso1A3:"ARG",iso1N3:"032",wikidata:"Q414",nameEn:"Argentina",aliases:["RA"],groups:["005","419","019","UN"],callingCodes:["54"]},geometry:{type:"MultiPolygon",coordinates:[[[[-72.31343,-50.58411],[-72.33873,-51.59954],[-71.99889,-51.98018],[-69.97824,-52.00845],[-68.41683,-52.33516],[-68.60702,-52.65781],[-68.60733,-54.9125],[-68.01394,-54.8753],[-67.46182,-54.92205],[-67.11046,-54.94199],[-66.07313,-55.19618],[-63.67376,-55.11859],[-54.78916,-36.21945],[-57.83001,-34.69099],[-58.34425,-34.15035],[-58.44442,-33.84033],[-58.40475,-33.11777],[-58.1224,-32.98842],[-58.22362,-32.52416],[-58.10036,-32.25338],[-58.20252,-31.86966],[-58.00076,-31.65016],[-58.0023,-31.53084],[-58.07569,-31.44916],[-57.98127,-31.3872],[-57.9908,-31.34924],[-57.86729,-31.06352],[-57.89476,-30.95994],[-57.8024,-30.77193],[-57.89115,-30.49572],[-57.64859,-30.35095],[-57.61478,-30.25165],[-57.65132,-30.19229],[-57.09386,-29.74211],[-56.81251,-29.48154],[-56.62789,-29.18073],[-56.57295,-29.11357],[-56.54171,-29.11447],[-56.05265,-28.62651],[-56.00458,-28.60421],[-56.01729,-28.51223],[-55.65418,-28.18304],[-55.6262,-28.17124],[-55.33303,-27.94661],[-55.16872,-27.86224],[-55.1349,-27.89759],[-54.90805,-27.73149],[-54.90159,-27.63132],[-54.67657,-27.57214],[-54.50416,-27.48232],[-54.41888,-27.40882],[-54.19268,-27.30751],[-54.19062,-27.27639],[-54.15978,-27.2889],[-53.80144,-27.09844],[-53.73372,-26.6131],[-53.68269,-26.33359],[-53.64505,-26.28089],[-53.64186,-26.25976],[-53.64632,-26.24798],[-53.63881,-26.25075],[-53.63739,-26.2496],[-53.65237,-26.23289],[-53.65018,-26.19501],[-53.73968,-26.10012],[-53.73391,-26.07006],[-53.7264,-26.0664],[-53.73086,-26.05842],[-53.73511,-26.04211],[-53.83691,-25.94849],[-53.90831,-25.55513],[-54.52926,-25.62846],[-54.5502,-25.58915],[-54.59398,-25.59224],[-54.62063,-25.91213],[-54.60664,-25.9691],[-54.67359,-25.98607],[-54.69333,-26.37705],[-54.70732,-26.45099],[-54.80868,-26.55669],[-55.00584,-26.78754],[-55.06351,-26.80195],[-55.16948,-26.96068],[-55.25243,-26.93808],[-55.39611,-26.97679],[-55.62322,-27.1941],[-55.59094,-27.32444],[-55.74475,-27.44485],[-55.89195,-27.3467],[-56.18313,-27.29851],[-56.85337,-27.5165],[-58.04205,-27.2387],[-58.59549,-27.29973],[-58.65321,-27.14028],[-58.3198,-26.83443],[-58.1188,-26.16704],[-57.87176,-25.93604],[-57.57431,-25.47269],[-57.80821,-25.13863],[-58.25492,-24.92528],[-58.33055,-24.97099],[-59.33886,-24.49935],[-59.45482,-24.34787],[-60.03367,-24.00701],[-60.28163,-24.04436],[-60.99754,-23.80934],[-61.0782,-23.62932],[-61.9756,-23.0507],[-62.22768,-22.55807],[-62.51761,-22.37684],[-62.64455,-22.25091],[-62.8078,-22.12534],[-62.81124,-21.9987],[-63.66482,-21.99918],[-63.68113,-22.0544],[-63.70963,-21.99934],[-63.93287,-21.99934],[-64.22918,-22.55807],[-64.31489,-22.88824],[-64.35108,-22.73282],[-64.4176,-22.67692],[-64.58888,-22.25035],[-64.67174,-22.18957],[-64.90014,-22.12136],[-64.99524,-22.08255],[-65.47435,-22.08908],[-65.57743,-22.07675],[-65.58694,-22.09794],[-65.61166,-22.09504],[-65.7467,-22.10105],[-65.9261,-21.93335],[-66.04832,-21.9187],[-66.03836,-21.84829],[-66.24077,-21.77837],[-66.29714,-22.08741],[-66.7298,-22.23644],[-67.18382,-22.81525],[-66.99632,-22.99839],[-67.33563,-24.04237],[-68.24825,-24.42596],[-68.56909,-24.69831],[-68.38372,-25.08636],[-68.57622,-25.32505],[-68.38372,-26.15353],[-68.56909,-26.28146],[-68.59048,-26.49861],[-68.27677,-26.90626],[-68.43363,-27.08414],[-68.77586,-27.16029],[-69.22504,-27.95042],[-69.66709,-28.44055],[-69.80969,-29.07185],[-69.99507,-29.28351],[-69.8596,-30.26131],[-70.14479,-30.36595],[-70.55832,-31.51559],[-69.88099,-33.34489],[-69.87386,-34.13344],[-70.49416,-35.24145],[-70.38008,-36.02375],[-70.95047,-36.4321],[-71.24279,-37.20264],[-70.89532,-38.6923],[-71.37826,-38.91474],[-71.92726,-40.72714],[-71.74901,-42.11711],[-72.15541,-42.15941],[-72.14828,-42.85321],[-71.64206,-43.64774],[-71.81318,-44.38097],[-71.16436,-44.46244],[-71.26418,-44.75684],[-72.06985,-44.81756],[-71.35687,-45.22075],[-71.75614,-45.61611],[-71.68577,-46.55385],[-71.94152,-47.13595],[-72.50478,-47.80586],[-72.27662,-48.28727],[-72.54042,-48.52392],[-72.56894,-48.81116],[-73.09655,-49.14342],[-73.45156,-49.79461],[-73.55259,-49.92488],[-73.15765,-50.78337],[-72.31343,-50.58411]]]]}},{type:"Feature",properties:{iso1A2:"AS",iso1A3:"ASM",iso1N3:"016",wikidata:"Q16641",nameEn:"American Samoa",aliases:["US-AS"],country:"US",groups:["Q1352230","061","009","UN"],roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1 684"]},geometry:{type:"MultiPolygon",coordinates:[[[[-171.39864,-10.21587],[-170.99605,-15.1275],[-166.32598,-15.26169],[-171.39864,-10.21587]]]]}},{type:"Feature",properties:{iso1A2:"AT",iso1A3:"AUT",iso1N3:"040",wikidata:"Q40",nameEn:"Austria",groups:["EU","155","150","UN"],callingCodes:["43"]},geometry:{type:"MultiPolygon",coordinates:[[[[15.34823,48.98444],[15.28305,48.98831],[15.26177,48.95766],[15.16358,48.94278],[15.15534,48.99056],[14.99878,49.01444],[14.97612,48.96983],[14.98917,48.90082],[14.95072,48.79101],[14.98032,48.77959],[14.9782,48.7766],[14.98112,48.77524],[14.9758,48.76857],[14.95641,48.75915],[14.94773,48.76268],[14.81545,48.7874],[14.80821,48.77711],[14.80584,48.73489],[14.72756,48.69502],[14.71794,48.59794],[14.66762,48.58215],[14.60808,48.62881],[14.56139,48.60429],[14.4587,48.64695],[14.43076,48.58855],[14.33909,48.55852],[14.20691,48.5898],[14.09104,48.5943],[14.01482,48.63788],[14.06151,48.66873],[13.84023,48.76988],[13.82266,48.75544],[13.81863,48.73257],[13.79337,48.71375],[13.81791,48.69832],[13.81283,48.68426],[13.81901,48.6761],[13.82609,48.62345],[13.80038,48.59487],[13.80519,48.58026],[13.76921,48.55324],[13.7513,48.5624],[13.74816,48.53058],[13.72802,48.51208],[13.66113,48.53558],[13.65186,48.55092],[13.62508,48.55501],[13.59705,48.57013],[13.57535,48.55912],[13.51291,48.59023],[13.50131,48.58091],[13.50663,48.57506],[13.46967,48.55157],[13.45214,48.56472],[13.43695,48.55776],[13.45727,48.51092],[13.42527,48.45711],[13.43929,48.43386],[13.40709,48.37292],[13.30897,48.31575],[13.26039,48.29422],[13.18093,48.29577],[13.126,48.27867],[13.0851,48.27711],[13.02083,48.25689],[12.95306,48.20629],[12.87126,48.20318],[12.84475,48.16556],[12.836,48.1647],[12.8362,48.15876],[12.82673,48.15245],[12.80676,48.14979],[12.78595,48.12445],[12.7617,48.12796],[12.74973,48.10885],[12.76141,48.07373],[12.8549,48.01122],[12.87476,47.96195],[12.91683,47.95647],[12.9211,47.95135],[12.91985,47.94069],[12.92668,47.93879],[12.93419,47.94063],[12.93642,47.94436],[12.93886,47.94046],[12.94163,47.92927],[13.00588,47.84374],[12.98543,47.82896],[12.96311,47.79957],[12.93202,47.77302],[12.94371,47.76281],[12.9353,47.74788],[12.91711,47.74026],[12.90274,47.72513],[12.91333,47.7178],[12.92969,47.71094],[12.98578,47.7078],[13.01382,47.72116],[13.07692,47.68814],[13.09562,47.63304],[13.06407,47.60075],[13.06641,47.58577],[13.04537,47.58183],[13.05355,47.56291],[13.03252,47.53373],[13.04537,47.49426],[12.9998,47.46267],[12.98344,47.48716],[12.9624,47.47452],[12.85256,47.52741],[12.84672,47.54556],[12.80699,47.54477],[12.77427,47.58025],[12.82101,47.61493],[12.76492,47.64485],[12.77777,47.66689],[12.7357,47.6787],[12.6071,47.6741],[12.57438,47.63238],[12.53816,47.63553],[12.50076,47.62293],[12.44117,47.6741],[12.43883,47.6977],[12.37222,47.68433],[12.336,47.69534],[12.27991,47.68827],[12.26004,47.67725],[12.24017,47.69534],[12.26238,47.73544],[12.2542,47.7433],[12.22571,47.71776],[12.18303,47.70065],[12.16217,47.70105],[12.16769,47.68167],[12.18347,47.66663],[12.18507,47.65984],[12.19895,47.64085],[12.20801,47.61082],[12.20398,47.60667],[12.18568,47.6049],[12.17737,47.60121],[12.18145,47.61019],[12.17824,47.61506],[12.13734,47.60639],[12.05788,47.61742],[12.02282,47.61033],[12.0088,47.62451],[11.85572,47.60166],[11.84052,47.58354],[11.63934,47.59202],[11.60681,47.57881],[11.58811,47.55515],[11.58578,47.52281],[11.52618,47.50939],[11.4362,47.51413],[11.38128,47.47465],[11.4175,47.44621],[11.33804,47.44937],[11.29597,47.42566],[11.27844,47.39956],[11.22002,47.3964],[11.25157,47.43277],[11.20482,47.43198],[11.12536,47.41222],[11.11835,47.39719],[10.97111,47.39561],[10.97111,47.41617],[10.98513,47.42882],[10.92437,47.46991],[10.93839,47.48018],[10.90918,47.48571],[10.87061,47.4786],[10.86945,47.5015],[10.91268,47.51334],[10.88814,47.53701],[10.77596,47.51729],[10.7596,47.53228],[10.6965,47.54253],[10.68832,47.55752],[10.63456,47.5591],[10.60337,47.56755],[10.56912,47.53584],[10.48849,47.54057],[10.47329,47.58552],[10.43473,47.58394],[10.44992,47.5524],[10.4324,47.50111],[10.44291,47.48453],[10.46278,47.47901],[10.47446,47.43318],[10.4359,47.41183],[10.4324,47.38494],[10.39851,47.37623],[10.33424,47.30813],[10.23257,47.27088],[10.17531,47.27167],[10.17648,47.29149],[10.2147,47.31014],[10.19998,47.32832],[10.23757,47.37609],[10.22774,47.38904],[10.2127,47.38019],[10.17648,47.38889],[10.16362,47.36674],[10.11805,47.37228],[10.09819,47.35724],[10.06897,47.40709],[10.1052,47.4316],[10.09001,47.46005],[10.07131,47.45531],[10.03859,47.48927],[10.00003,47.48216],[9.96029,47.53899],[9.92407,47.53111],[9.87733,47.54688],[9.87499,47.52953],[9.8189,47.54688],[9.82591,47.58158],[9.80254,47.59419],[9.76748,47.5934],[9.72736,47.53457],[9.55125,47.53629],[9.56312,47.49495],[9.58208,47.48344],[9.59482,47.46305],[9.60205,47.46165],[9.60484,47.46358],[9.60841,47.47178],[9.62158,47.45858],[9.62475,47.45685],[9.6423,47.45599],[9.65728,47.45383],[9.65863,47.44847],[9.64483,47.43842],[9.6446,47.43233],[9.65043,47.41937],[9.65136,47.40504],[9.6629,47.39591],[9.67334,47.39191],[9.67445,47.38429],[9.6711,47.37824],[9.66243,47.37136],[9.65427,47.36824],[9.62476,47.36639],[9.59978,47.34671],[9.58513,47.31334],[9.55857,47.29919],[9.54773,47.2809],[9.53116,47.27029],[9.56766,47.24281],[9.55176,47.22585],[9.56981,47.21926],[9.58264,47.20673],[9.56539,47.17124],[9.62623,47.14685],[9.63395,47.08443],[9.61216,47.07732],[9.60717,47.06091],[9.87935,47.01337],[9.88266,46.93343],[9.98058,46.91434],[10.10715,46.84296],[10.22675,46.86942],[10.24128,46.93147],[10.30031,46.92093],[10.36933,47.00212],[10.48376,46.93891],[10.47197,46.85698],[10.54783,46.84505],[10.66405,46.87614],[10.75753,46.82258],[10.72974,46.78972],[11.00764,46.76896],[11.10618,46.92966],[11.33355,46.99862],[11.50739,47.00644],[11.74789,46.98484],[12.19254,47.09331],[12.21781,47.03996],[12.11675,47.01241],[12.2006,46.88854],[12.27591,46.88651],[12.38708,46.71529],[12.59992,46.6595],[12.94445,46.60401],[13.27627,46.56059],[13.64088,46.53438],[13.7148,46.5222],[13.89837,46.52331],[14.00422,46.48474],[14.04002,46.49117],[14.12097,46.47724],[14.15989,46.43327],[14.28326,46.44315],[14.314,46.43327],[14.42608,46.44614],[14.45877,46.41717],[14.52176,46.42617],[14.56463,46.37208],[14.5942,46.43434],[14.66892,46.44936],[14.72185,46.49974],[14.81836,46.51046],[14.83549,46.56614],[14.86419,46.59411],[14.87129,46.61],[14.92283,46.60848],[14.96002,46.63459],[14.98024,46.6009],[15.01451,46.641],[15.14215,46.66131],[15.23711,46.63994],[15.41235,46.65556],[15.45514,46.63697],[15.46906,46.61321],[15.54431,46.6312],[15.55333,46.64988],[15.54533,46.66985],[15.59826,46.68908],[15.62317,46.67947],[15.63255,46.68069],[15.6365,46.6894],[15.6543,46.69228],[15.6543,46.70616],[15.67411,46.70735],[15.69523,46.69823],[15.72279,46.69548],[15.73823,46.70011],[15.76771,46.69863],[15.78518,46.70712],[15.8162,46.71897],[15.87691,46.7211],[15.94864,46.68769],[15.98512,46.68463],[15.99988,46.67947],[16.04036,46.6549],[16.04347,46.68694],[16.02808,46.71094],[15.99769,46.7266],[15.98432,46.74991],[15.99126,46.78199],[15.99054,46.82772],[16.05786,46.83927],[16.10983,46.867],[16.19904,46.94134],[16.22403,46.939],[16.27594,46.9643],[16.28202,47.00159],[16.51369,47.00084],[16.43936,47.03548],[16.52176,47.05747],[16.46134,47.09395],[16.52863,47.13974],[16.44932,47.14418],[16.46442,47.16845],[16.4523,47.18812],[16.42801,47.18422],[16.41739,47.20649],[16.43663,47.21127],[16.44142,47.25079],[16.47782,47.25918],[16.45104,47.41181],[16.49908,47.39416],[16.52414,47.41007],[16.57152,47.40868],[16.6718,47.46139],[16.64821,47.50155],[16.71059,47.52692],[16.64193,47.63114],[16.58699,47.61772],[16.4222,47.66537],[16.55129,47.72268],[16.53514,47.73837],[16.54779,47.75074],[16.61183,47.76171],[16.65679,47.74197],[16.72089,47.73469],[16.7511,47.67878],[16.82938,47.68432],[16.86509,47.72268],[16.87538,47.68895],[17.08893,47.70928],[17.05048,47.79377],[17.07039,47.81129],[17.00997,47.86245],[17.08275,47.87719],[17.11022,47.92461],[17.09786,47.97336],[17.16001,48.00636],[17.07039,48.0317],[17.09168,48.09366],[17.05735,48.14179],[17.02919,48.13996],[16.97701,48.17385],[16.89461,48.31332],[16.90903,48.32519],[16.84243,48.35258],[16.83317,48.38138],[16.83588,48.3844],[16.8497,48.38321],[16.85204,48.44968],[16.94611,48.53614],[16.93955,48.60371],[16.90354,48.71541],[16.79779,48.70998],[16.71883,48.73806],[16.68518,48.7281],[16.67008,48.77699],[16.46134,48.80865],[16.40915,48.74576],[16.37345,48.729],[16.06034,48.75436],[15.84404,48.86921],[15.78087,48.87644],[15.75341,48.8516],[15.6921,48.85973],[15.61622,48.89541],[15.51357,48.91549],[15.48027,48.94481],[15.34823,48.98444]]]]}},{type:"Feature",properties:{iso1A2:"AU",iso1A3:"AUS",iso1N3:"036",wikidata:"Q408",nameEn:"Australia"},geometry:null},{type:"Feature",properties:{iso1A2:"AW",iso1A3:"ABW",iso1N3:"533",wikidata:"Q21203",nameEn:"Aruba",aliases:["NL-AW"],country:"NL",groups:["Q1451600","029","003","419","019","UN"],callingCodes:["297"]},geometry:{type:"MultiPolygon",coordinates:[[[[-70.00823,12.98375],[-70.35625,12.58277],[-69.60231,12.17],[-70.00823,12.98375]]]]}},{type:"Feature",properties:{iso1A2:"AX",iso1A3:"ALA",iso1N3:"248",wikidata:"Q5689",nameEn:"\xC5land Islands",country:"FI",groups:["EU","154","150","UN"],callingCodes:["358 18","358 457"]},geometry:{type:"MultiPolygon",coordinates:[[[[19.08191,60.19152],[20.5104,59.15546],[21.35468,59.67511],[21.02509,60.12142],[21.08159,60.20167],[21.15143,60.54555],[20.96741,60.71528],[19.23413,60.61414],[19.08191,60.19152]]]]}},{type:"Feature",properties:{iso1A2:"AZ",iso1A3:"AZE",iso1N3:"031",wikidata:"Q227",nameEn:"Azerbaijan",groups:["145","142","UN"],callingCodes:["994"]},geometry:{type:"MultiPolygon",coordinates:[[[[46.42738,41.91323],[46.3984,41.84399],[46.30863,41.79133],[46.23962,41.75811],[46.20538,41.77205],[46.17891,41.72094],[46.19759,41.62327],[46.24429,41.59883],[46.26531,41.63339],[46.28182,41.60089],[46.3253,41.60912],[46.34039,41.5947],[46.34126,41.57454],[46.29794,41.5724],[46.33925,41.4963],[46.40307,41.48464],[46.4669,41.43331],[46.63658,41.37727],[46.72375,41.28609],[46.66148,41.20533],[46.63969,41.09515],[46.55096,41.1104],[46.48558,41.0576],[46.456,41.09984],[46.37661,41.10805],[46.27698,41.19011],[46.13221,41.19479],[45.95786,41.17956],[45.80842,41.2229],[45.69946,41.29545],[45.75705,41.35157],[45.71035,41.36208],[45.68389,41.3539],[45.45973,41.45898],[45.4006,41.42402],[45.31352,41.47168],[45.26285,41.46433],[45.1797,41.42231],[45.09867,41.34065],[45.0133,41.29747],[45.05497,41.2464],[45.02932,41.2101],[45.05201,41.19211],[45.11811,41.19967],[45.1969,41.168],[45.19942,41.13299],[45.08028,41.10917],[45.06784,41.05379],[45.12923,41.06059],[45.1313,41.09369],[45.1634,41.08082],[45.16493,41.05068],[45.1994,41.04518],[45.25897,41.0027],[45.26162,41.0228],[45.28859,41.03757],[45.35677,40.99784],[45.39725,41.02603],[45.44083,41.01663],[45.40814,40.97904],[45.60584,40.87436],[45.55914,40.78366],[45.4206,40.7424],[45.35366,40.65979],[45.45484,40.57707],[45.42994,40.53804],[45.65098,40.37696],[45.95609,40.27846],[45.97944,40.181],[45.83779,39.98925],[45.78642,40.03218],[45.59806,40.0131],[45.60895,39.97733],[45.7833,39.9475],[45.82533,39.82925],[45.96543,39.78859],[46.18493,39.60533],[46.40286,39.63651],[46.42465,39.57534],[46.52117,39.58734],[46.57098,39.56694],[46.57721,39.54414],[46.51027,39.52373],[46.53051,39.47809],[46.4013,39.45405],[46.37795,39.42039],[46.43244,39.35181],[46.50093,39.33736],[46.56476,39.24942],[46.63481,39.23013],[46.58032,39.21204],[46.54141,39.15895],[46.52584,39.18912],[46.44022,39.19636],[46.54296,39.07078],[46.51805,38.94982],[46.53497,38.86548],[46.75752,39.03231],[46.83822,39.13143],[46.92539,39.16644],[46.95341,39.13505],[47.05771,39.20143],[47.05927,39.24846],[47.31301,39.37492],[47.38978,39.45999],[47.50099,39.49615],[47.84774,39.66285],[47.98977,39.70999],[48.34264,39.42935],[48.37385,39.37584],[48.15984,39.30028],[48.12404,39.25208],[48.15361,39.19419],[48.31239,39.09278],[48.33884,39.03022],[48.28437,38.97186],[48.08627,38.94434],[48.07734,38.91616],[48.01409,38.90333],[48.02581,38.82705],[48.24773,38.71883],[48.3146,38.59958],[48.45084,38.61013],[48.58793,38.45076],[48.62217,38.40198],[48.70001,38.40564],[48.78979,38.45026],[48.81072,38.44853],[48.84969,38.45015],[48.88288,38.43975],[52.39847,39.43556],[48.80971,41.95365],[48.5867,41.84306],[48.55078,41.77917],[48.42301,41.65444],[48.40277,41.60441],[48.2878,41.56221],[48.22064,41.51472],[48.07587,41.49957],[47.87973,41.21798],[47.75831,41.19455],[47.62288,41.22969],[47.54504,41.20275],[47.49004,41.26366],[47.34579,41.27884],[47.10762,41.59044],[47.03757,41.55434],[46.99554,41.59743],[47.00955,41.63583],[46.8134,41.76252],[46.75269,41.8623],[46.58924,41.80547],[46.5332,41.87389],[46.42738,41.91323]],[[45.50279,40.58424],[45.47927,40.65023],[45.51825,40.67382],[45.56071,40.64765],[45.50279,40.58424]]],[[[45.00864,41.03411],[45.03792,41.03938],[45.04517,41.06653],[45.03406,41.07931],[45.00864,41.09407],[44.97169,41.09176],[44.95383,41.07553],[44.96031,41.06345],[44.9903,41.05657],[45.00864,41.03411]]],[[[45.21324,40.9817],[45.23095,40.97828],[45.23487,41.00226],[45.20625,41.01484],[45.18382,41.0066],[45.19312,40.98998],[45.20518,40.99348],[45.21219,40.99001],[45.21324,40.9817]]],[[[45.46992,39.49888],[45.29606,39.57654],[45.30385,39.61373],[45.23535,39.61373],[45.21784,39.58074],[45.17464,39.58614],[45.18554,39.67846],[45.06604,39.79277],[44.92869,39.72157],[44.88354,39.74432],[44.75779,39.7148],[44.80977,39.65768],[44.81043,39.62677],[44.88916,39.59653],[44.96746,39.42998],[45.05932,39.36435],[45.08751,39.35052],[45.16168,39.21952],[45.30489,39.18333],[45.40148,39.09007],[45.40452,39.07224],[45.44811,39.04927],[45.44966,38.99243],[45.6131,38.964],[45.6155,38.94304],[45.65172,38.95199],[45.83883,38.90768],[45.90266,38.87739],[45.94624,38.89072],[46.00228,38.87376],[46.06766,38.87861],[46.14785,38.84206],[46.06973,39.0744],[46.02303,39.09978],[45.99774,39.28931],[45.79225,39.3695],[45.83,39.46487],[45.80804,39.56716],[45.70547,39.60174],[45.46992,39.49888]]]]}},{type:"Feature",properties:{iso1A2:"BA",iso1A3:"BIH",iso1N3:"070",wikidata:"Q225",nameEn:"Bosnia and Herzegovina",groups:["039","150","UN"],callingCodes:["387"]},geometry:{type:"MultiPolygon",coordinates:[[[[17.84826,45.04489],[17.66571,45.13408],[17.59104,45.10816],[17.51469,45.10791],[17.47589,45.12656],[17.45615,45.12523],[17.4498,45.16119],[17.41229,45.13335],[17.33573,45.14521],[17.32092,45.16246],[17.26815,45.18444],[17.25131,45.14957],[17.24325,45.146],[17.18438,45.14764],[17.0415,45.20759],[16.9385,45.22742],[16.92405,45.27607],[16.83804,45.18951],[16.81137,45.18434],[16.78219,45.19002],[16.74845,45.20393],[16.64962,45.20714],[16.60194,45.23042],[16.56559,45.22307],[16.5501,45.2212],[16.52982,45.22713],[16.49155,45.21153],[16.4634,45.14522],[16.40023,45.1147],[16.38309,45.05955],[16.38219,45.05139],[16.3749,45.05206],[16.35863,45.03529],[16.35404,45.00241],[16.29036,44.99732],[16.12153,45.09616],[15.98412,45.23088],[15.83512,45.22459],[15.76371,45.16508],[15.78842,45.11519],[15.74585,45.0638],[15.78568,44.97401],[15.74723,44.96818],[15.76096,44.87045],[15.79472,44.8455],[15.72584,44.82334],[15.8255,44.71501],[15.89348,44.74964],[16.05828,44.61538],[16.00884,44.58605],[16.03012,44.55572],[16.10566,44.52586],[16.16814,44.40679],[16.12969,44.38275],[16.21346,44.35231],[16.18688,44.27012],[16.36864,44.08263],[16.43662,44.07523],[16.43629,44.02826],[16.50528,44.0244],[16.55472,43.95326],[16.70922,43.84887],[16.75316,43.77157],[16.80736,43.76011],[17.00585,43.58037],[17.15828,43.49376],[17.24411,43.49376],[17.29699,43.44542],[17.25579,43.40353],[17.286,43.33065],[17.46986,43.16559],[17.64268,43.08595],[17.70879,42.97223],[17.5392,42.92787],[17.6444,42.88641],[17.68151,42.92725],[17.7948,42.89556],[17.80854,42.9182],[17.88201,42.83668],[18.24318,42.6112],[18.36197,42.61423],[18.43735,42.55921],[18.49778,42.58409],[18.53751,42.57376],[18.55504,42.58409],[18.52232,42.62279],[18.57373,42.64429],[18.54841,42.68328],[18.54603,42.69171],[18.55221,42.69045],[18.56789,42.72074],[18.47324,42.74992],[18.45921,42.81682],[18.47633,42.85829],[18.4935,42.86433],[18.49661,42.89306],[18.49076,42.95553],[18.52232,43.01451],[18.66254,43.03928],[18.64735,43.14766],[18.66605,43.2056],[18.71747,43.2286],[18.6976,43.25243],[18.76538,43.29838],[18.85342,43.32426],[18.84794,43.33735],[18.83912,43.34795],[18.90911,43.36383],[18.95819,43.32899],[18.95001,43.29327],[19.00844,43.24988],[19.04233,43.30008],[19.08206,43.29668],[19.08673,43.31453],[19.04071,43.397],[19.01078,43.43854],[18.96053,43.45042],[18.95469,43.49367],[18.91379,43.50299],[19.01078,43.55806],[19.04934,43.50384],[19.13933,43.5282],[19.15685,43.53943],[19.22807,43.5264],[19.24774,43.53061],[19.2553,43.5938],[19.33426,43.58833],[19.36653,43.60921],[19.41941,43.54056],[19.42696,43.57987],[19.50455,43.58385],[19.5176,43.71403],[19.3986,43.79668],[19.23465,43.98764],[19.24363,44.01502],[19.38439,43.96611],[19.52515,43.95573],[19.56498,43.99922],[19.61836,44.01464],[19.61991,44.05254],[19.57467,44.04716],[19.55999,44.06894],[19.51167,44.08158],[19.47321,44.1193],[19.48386,44.14332],[19.47338,44.15034],[19.43905,44.13088],[19.40927,44.16722],[19.3588,44.18353],[19.34773,44.23244],[19.32464,44.27185],[19.26945,44.26957],[19.23306,44.26097],[19.20508,44.2917],[19.18328,44.28383],[19.16741,44.28648],[19.13332,44.31492],[19.13556,44.338],[19.11547,44.34218],[19.1083,44.3558],[19.11865,44.36712],[19.10298,44.36924],[19.10365,44.37795],[19.10704,44.38249],[19.10749,44.39421],[19.11785,44.40313],[19.14681,44.41463],[19.14837,44.45253],[19.12278,44.50132],[19.13369,44.52521],[19.16699,44.52197],[19.26388,44.65412],[19.32543,44.74058],[19.36722,44.88164],[19.18183,44.92055],[19.01994,44.85493],[18.8704,44.85097],[18.76347,44.90669],[18.76369,44.93707],[18.80661,44.93561],[18.78357,44.97741],[18.65723,45.07544],[18.47939,45.05871],[18.41896,45.11083],[18.32077,45.1021],[18.24387,45.13699],[18.1624,45.07654],[18.03121,45.12632],[18.01594,45.15163],[17.99479,45.14958],[17.97834,45.13831],[17.97336,45.12245],[17.93706,45.08016],[17.87148,45.04645],[17.84826,45.04489]]]]}},{type:"Feature",properties:{iso1A2:"BB",iso1A3:"BRB",iso1N3:"052",wikidata:"Q244",nameEn:"Barbados",groups:["029","003","419","019","UN"],driveSide:"left",callingCodes:["1 246"]},geometry:{type:"MultiPolygon",coordinates:[[[[-58.56442,13.24471],[-59.80731,13.87556],[-59.82929,12.70644],[-58.56442,13.24471]]]]}},{type:"Feature",properties:{iso1A2:"BD",iso1A3:"BGD",iso1N3:"050",wikidata:"Q902",nameEn:"Bangladesh",groups:["034","142","UN"],driveSide:"left",callingCodes:["880"]},geometry:{type:"MultiPolygon",coordinates:[[[[89.15869,26.13708],[89.08899,26.38845],[88.95612,26.4564],[88.92357,26.40711],[88.91321,26.37984],[89.05328,26.2469],[88.85004,26.23211],[88.78961,26.31093],[88.67837,26.26291],[88.69485,26.38353],[88.62144,26.46783],[88.4298,26.54489],[88.41196,26.63837],[88.33093,26.48929],[88.35153,26.45241],[88.36938,26.48683],[88.48749,26.45855],[88.51649,26.35923],[88.35153,26.29123],[88.34757,26.22216],[88.1844,26.14417],[88.16581,26.0238],[88.08804,25.91334],[88.13138,25.78773],[88.242,25.80811],[88.45103,25.66245],[88.4559,25.59227],[88.677,25.46959],[88.81296,25.51546],[88.85278,25.34679],[89.01105,25.30303],[89.00463,25.26583],[88.94067,25.18534],[88.44766,25.20149],[88.46277,25.07468],[88.33917,24.86803],[88.27325,24.88796],[88.21832,24.96642],[88.14004,24.93529],[88.15515,24.85806],[88.00683,24.66477],[88.08786,24.63232],[88.12296,24.51301],[88.50934,24.32474],[88.68801,24.31464],[88.74841,24.1959],[88.6976,24.14703],[88.73743,23.91751],[88.66189,23.87607],[88.58087,23.87105],[88.56507,23.64044],[88.74841,23.47361],[88.79351,23.50535],[88.79254,23.46028],[88.71133,23.2492],[88.99148,23.21134],[88.86377,23.08759],[88.88327,23.03885],[88.87063,22.95235],[88.96713,22.83346],[88.9151,22.75228],[88.94614,22.66941],[88.9367,22.58527],[89.07114,22.15335],[89.08044,21.41871],[92.47409,20.38654],[92.26071,21.05697],[92.17752,21.17445],[92.20087,21.337],[92.37939,21.47764],[92.43158,21.37025],[92.55105,21.3856],[92.60187,21.24615],[92.68152,21.28454],[92.59775,21.6092],[92.62187,21.87037],[92.60949,21.97638],[92.56616,22.13554],[92.60029,22.1522],[92.5181,22.71441],[92.37665,22.9435],[92.38214,23.28705],[92.26541,23.70392],[92.15417,23.73409],[92.04706,23.64229],[91.95093,23.73284],[91.95642,23.47361],[91.84789,23.42235],[91.76417,23.26619],[91.81634,23.08001],[91.7324,23.00043],[91.61571,22.93929],[91.54993,23.01051],[91.46615,23.2328],[91.4035,23.27522],[91.40848,23.07117],[91.36453,23.06612],[91.28293,23.37538],[91.15579,23.6599],[91.25192,23.83463],[91.22308,23.89616],[91.29587,24.0041],[91.35741,23.99072],[91.37414,24.10693],[91.55542,24.08687],[91.63782,24.1132],[91.65292,24.22095],[91.73257,24.14703],[91.76004,24.23848],[91.82596,24.22345],[91.89258,24.14674],[91.96603,24.3799],[92.11662,24.38997],[92.15796,24.54435],[92.25854,24.9191],[92.38626,24.86055],[92.49887,24.88796],[92.39147,25.01471],[92.33957,25.07593],[92.0316,25.1834],[91.63648,25.12846],[91.25517,25.20677],[90.87427,25.15799],[90.65042,25.17788],[90.40034,25.1534],[90.1155,25.22686],[89.90478,25.31038],[89.87629,25.28337],[89.83371,25.29548],[89.84086,25.31854],[89.81208,25.37244],[89.86129,25.61714],[89.84388,25.70042],[89.80585,25.82489],[89.86592,25.93115],[89.77728,26.04254],[89.77865,26.08387],[89.73581,26.15818],[89.70201,26.15138],[89.63968,26.22595],[89.57101,25.9682],[89.53515,26.00382],[89.35953,26.0077],[89.15869,26.13708]]]]}},{type:"Feature",properties:{iso1A2:"BE",iso1A3:"BEL",iso1N3:"056",wikidata:"Q31",nameEn:"Belgium",groups:["EU","155","150","UN"],callingCodes:["32"]},geometry:{type:"MultiPolygon",coordinates:[[[[4.93295,51.44945],[4.93909,51.44632],[4.9524,51.45014],[4.95244,51.45207],[4.93295,51.44945]]],[[[4.91493,51.4353],[4.92652,51.43329],[4.92952,51.42984],[4.93986,51.43064],[4.94265,51.44003],[4.93471,51.43861],[4.93416,51.44185],[4.94025,51.44193],[4.93544,51.44634],[4.92879,51.44161],[4.92815,51.43856],[4.92566,51.44273],[4.92811,51.4437],[4.92287,51.44741],[4.91811,51.44621],[4.92227,51.44252],[4.91935,51.43634],[4.91493,51.4353]]],[[[4.82946,51.4213],[4.82409,51.44736],[4.84139,51.4799],[4.78803,51.50284],[4.77321,51.50529],[4.74578,51.48937],[4.72935,51.48424],[4.65442,51.42352],[4.57489,51.4324],[4.53521,51.4243],[4.52846,51.45002],[4.54675,51.47265],[4.5388,51.48184],[4.47736,51.4778],[4.38122,51.44905],[4.39747,51.43316],[4.38064,51.41965],[4.43777,51.36989],[4.39292,51.35547],[4.34086,51.35738],[4.33265,51.37687],[4.21923,51.37443],[4.24024,51.35371],[4.16721,51.29348],[4.05165,51.24171],[4.01957,51.24504],[3.97889,51.22537],[3.90125,51.20371],[3.78783,51.2151],[3.78999,51.25766],[3.58939,51.30064],[3.51502,51.28697],[3.52698,51.2458],[3.43488,51.24135],[3.41704,51.25933],[3.38289,51.27331],[3.35847,51.31572],[3.38696,51.33436],[3.36263,51.37112],[2.56575,51.85301],[2.18458,51.52087],[2.55904,51.07014],[2.57551,51.00326],[2.63074,50.94746],[2.59093,50.91751],[2.63331,50.81457],[2.71165,50.81295],[2.81056,50.71773],[2.8483,50.72276],[2.86985,50.7033],[2.87937,50.70298],[2.88504,50.70656],[2.90069,50.69263],[2.91036,50.6939],[2.90873,50.702],[2.95019,50.75138],[2.96778,50.75242],[3.00537,50.76588],[3.04314,50.77674],[3.09163,50.77717],[3.10614,50.78303],[3.11206,50.79416],[3.11987,50.79188],[3.1257,50.78603],[3.15017,50.79031],[3.16476,50.76843],[3.18339,50.74981],[3.18811,50.74025],[3.20064,50.73547],[3.19017,50.72569],[3.20845,50.71662],[3.22042,50.71019],[3.24593,50.71389],[3.26063,50.70086],[3.26141,50.69151],[3.2536,50.68977],[3.264,50.67668],[3.23951,50.6585],[3.2729,50.60718],[3.28575,50.52724],[3.37693,50.49538],[3.44629,50.51009],[3.47385,50.53397],[3.51564,50.5256],[3.49509,50.48885],[3.5683,50.50192],[3.58361,50.49049],[3.61014,50.49568],[3.64426,50.46275],[3.66153,50.45165],[3.67494,50.40239],[3.67262,50.38663],[3.65709,50.36873],[3.66976,50.34563],[3.71009,50.30305],[3.70987,50.3191],[3.73911,50.34809],[3.84314,50.35219],[3.90781,50.32814],[3.96771,50.34989],[4.0268,50.35793],[4.0689,50.3254],[4.10237,50.31247],[4.10957,50.30234],[4.11954,50.30425],[4.13665,50.25609],[4.16808,50.25786],[4.15524,50.2833],[4.17347,50.28838],[4.17861,50.27443],[4.20651,50.27333],[4.21945,50.25539],[4.15524,50.21103],[4.16014,50.19239],[4.13561,50.13078],[4.20147,50.13535],[4.23101,50.06945],[4.16294,50.04719],[4.13508,50.01976],[4.14239,49.98034],[4.20532,49.95803],[4.31963,49.97043],[4.35051,49.95315],[4.43488,49.94122],[4.51098,49.94659],[4.5414,49.96911],[4.68695,49.99685],[4.70064,50.09384],[4.75237,50.11314],[4.82438,50.16878],[4.83279,50.15331],[4.88602,50.15182],[4.8382,50.06738],[4.78827,49.95609],[4.88529,49.9236],[4.85134,49.86457],[4.86965,49.82271],[4.85464,49.78995],[4.96714,49.79872],[5.09249,49.76193],[5.14545,49.70287],[5.26232,49.69456],[5.31465,49.66846],[5.33039,49.6555],[5.30214,49.63055],[5.3137,49.61225],[5.33851,49.61599],[5.34837,49.62889],[5.3974,49.61596],[5.43713,49.5707],[5.46734,49.52648],[5.46541,49.49825],[5.55001,49.52729],[5.60909,49.51228],[5.64505,49.55146],[5.75649,49.54321],[5.7577,49.55915],[5.77435,49.56298],[5.79195,49.55228],[5.81838,49.54777],[5.84143,49.5533],[5.84692,49.55663],[5.8424,49.56082],[5.87256,49.57539],[5.86986,49.58756],[5.84971,49.58674],[5.84826,49.5969],[5.8762,49.60898],[5.87609,49.62047],[5.88393,49.62802],[5.88552,49.63507],[5.90599,49.63853],[5.90164,49.6511],[5.9069,49.66377],[5.86175,49.67862],[5.86527,49.69291],[5.88677,49.70951],[5.86503,49.72739],[5.84193,49.72161],[5.82562,49.72395],[5.83149,49.74729],[5.82245,49.75048],[5.78871,49.7962],[5.75409,49.79239],[5.74953,49.81428],[5.74364,49.82058],[5.74844,49.82435],[5.7404,49.83452],[5.74076,49.83823],[5.74975,49.83933],[5.74953,49.84709],[5.75884,49.84811],[5.74567,49.85368],[5.75861,49.85631],[5.75269,49.8711],[5.78415,49.87922],[5.73621,49.89796],[5.77314,49.93646],[5.77291,49.96056],[5.80833,49.96451],[5.81163,49.97142],[5.83467,49.97823],[5.83968,49.9892],[5.82331,49.99662],[5.81866,50.01286],[5.8551,50.02683],[5.86904,50.04614],[5.85474,50.06342],[5.8857,50.07824],[5.89488,50.11476],[5.95929,50.13295],[5.96453,50.17259],[6.02488,50.18283],[6.03093,50.16362],[6.06406,50.15344],[6.08577,50.17246],[6.12028,50.16374],[6.1137,50.13668],[6.1379,50.12964],[6.15298,50.14126],[6.14132,50.14971],[6.14588,50.17106],[6.18739,50.1822],[6.18364,50.20815],[6.16853,50.2234],[6.208,50.25179],[6.28797,50.27458],[6.29949,50.30887],[6.32488,50.32333],[6.35701,50.31139],[6.40641,50.32425],[6.40785,50.33557],[6.3688,50.35898],[6.34406,50.37994],[6.36852,50.40776],[6.37219,50.45397],[6.34005,50.46083],[6.3465,50.48833],[6.30809,50.50058],[6.26637,50.50272],[6.22335,50.49578],[6.20599,50.52089],[6.19193,50.5212],[6.18716,50.52653],[6.19579,50.5313],[6.19735,50.53576],[6.17802,50.54179],[6.17739,50.55875],[6.20281,50.56952],[6.22581,50.5907],[6.24005,50.58732],[6.24888,50.59869],[6.2476,50.60392],[6.26957,50.62444],[6.17852,50.6245],[6.11707,50.72231],[6.04428,50.72861],[6.0406,50.71848],[6.0326,50.72647],[6.03889,50.74618],[6.01976,50.75398],[5.97545,50.75441],[5.95942,50.7622],[5.89132,50.75124],[5.89129,50.75125],[5.88734,50.77092],[5.84888,50.75448],[5.84548,50.76542],[5.80673,50.7558],[5.77513,50.78308],[5.76533,50.78159],[5.74356,50.7691],[5.73904,50.75674],[5.72216,50.76398],[5.69469,50.75529],[5.68091,50.75804],[5.70107,50.7827],[5.68995,50.79641],[5.70118,50.80764],[5.65259,50.82309],[5.64009,50.84742],[5.64504,50.87107],[5.67886,50.88142],[5.69858,50.91046],[5.71626,50.90796],[5.72644,50.91167],[5.72545,50.92312],[5.74644,50.94723],[5.75927,50.95601],[5.74752,50.96202],[5.72875,50.95428],[5.71864,50.96092],[5.76242,50.99703],[5.77688,51.02483],[5.75961,51.03113],[5.77258,51.06196],[5.79835,51.05834],[5.79903,51.09371],[5.82921,51.09328],[5.83226,51.10585],[5.8109,51.10861],[5.80798,51.11661],[5.85508,51.14445],[5.82564,51.16753],[5.77697,51.1522],[5.77735,51.17845],[5.74617,51.18928],[5.70344,51.1829],[5.65528,51.18736],[5.65145,51.19788],[5.5603,51.22249],[5.5569,51.26544],[5.515,51.29462],[5.48476,51.30053],[5.46519,51.2849],[5.4407,51.28169],[5.41672,51.26248],[5.347,51.27502],[5.33886,51.26314],[5.29716,51.26104],[5.26461,51.26693],[5.23814,51.26064],[5.22542,51.26888],[5.24244,51.30495],[5.2002,51.32243],[5.16222,51.31035],[5.13377,51.31592],[5.13105,51.34791],[5.07102,51.39469],[5.10456,51.43163],[5.07891,51.4715],[5.04774,51.47022],[5.03281,51.48679],[5.0106,51.47167],[5.00393,51.44406],[4.92152,51.39487],[4.90016,51.41404],[4.84988,51.41502],[4.78941,51.41102],[4.77229,51.41337],[4.76577,51.43046],[4.78314,51.43319],[4.82946,51.4213]]]]}},{type:"Feature",properties:{iso1A2:"BF",iso1A3:"BFA",iso1N3:"854",wikidata:"Q965",nameEn:"Burkina Faso",groups:["011","202","002","UN"],callingCodes:["226"]},geometry:{type:"MultiPolygon",coordinates:[[[[.23859,15.00135],[.06588,14.96961],[-.24673,15.07805],[-.72004,15.08655],[-1.05875,14.7921],[-1.32166,14.72774],[-1.68083,14.50023],[-1.97945,14.47709],[-1.9992,14.19011],[-2.10223,14.14878],[-2.47587,14.29671],[-2.66175,14.14713],[-2.84667,14.05532],[-2.90831,13.81174],[-2.88189,13.64921],[-3.26407,13.70699],[-3.28396,13.5422],[-3.23599,13.29035],[-3.43507,13.27272],[-3.4313,13.1588],[-3.54454,13.1781],[-3.7911,13.36665],[-3.96282,13.38164],[-3.90558,13.44375],[-3.96501,13.49778],[-4.34477,13.12927],[-4.21819,12.95722],[-4.238,12.71467],[-4.47356,12.71252],[-4.41412,12.31922],[-4.57703,12.19875],[-4.54841,12.1385],[-4.62546,12.13204],[-4.62987,12.06531],[-4.70692,12.06746],[-4.72893,12.01579],[-5.07897,11.97918],[-5.26389,11.84778],[-5.40258,11.8327],[-5.26389,11.75728],[-5.29251,11.61715],[-5.22867,11.60421],[-5.20665,11.43811],[-5.25509,11.36905],[-5.25949,11.24816],[-5.32553,11.21578],[-5.32994,11.13371],[-5.49284,11.07538],[-5.41579,10.84628],[-5.47083,10.75329],[-5.46643,10.56074],[-5.51058,10.43177],[-5.39602,10.2929],[-5.12465,10.29788],[-4.96453,9.99923],[-4.96621,9.89132],[-4.6426,9.70696],[-4.31392,9.60062],[-4.25999,9.76012],[-3.69703,9.94279],[-3.31779,9.91125],[-3.27228,9.84981],[-3.19306,9.93781],[-3.16609,9.85147],[-3.00765,9.74019],[-2.93012,9.57403],[-2.76494,9.40778],[-2.68802,9.49343],[-2.76534,9.56589],[-2.74174,9.83172],[-2.83108,10.40252],[-2.94232,10.64281],[-2.83373,11.0067],[-.67143,10.99811],[-.61937,10.91305],[-.44298,11.04292],[-.42391,11.11661],[-.38219,11.12596],[-.35955,11.07801],[-.28566,11.12713],[-.27374,11.17157],[-.13493,11.14075],[.50388,11.01011],[.48852,10.98561],[.50521,10.98035],[.4958,10.93269],[.66104,10.99964],[.91245,10.99597],[.9813,11.08876],[1.03409,11.04719],[1.42823,11.46822],[2.00988,11.42227],[2.29983,11.68254],[2.39723,11.89473],[2.05785,12.35539],[2.26349,12.41915],[.99167,13.10727],[.99253,13.37515],[1.18873,13.31771],[1.21217,13.37853],[1.24516,13.33968],[1.28509,13.35488],[1.24429,13.39373],[1.20088,13.38951],[1.02813,13.46635],[.99514,13.5668],[.77637,13.64442],[.77377,13.6866],[.61924,13.68491],[.38051,14.05575],[.16936,14.51654],[.23859,15.00135]]]]}},{type:"Feature",properties:{iso1A2:"BG",iso1A3:"BGR",iso1N3:"100",wikidata:"Q219",nameEn:"Bulgaria",groups:["EU","151","150","UN"],callingCodes:["359"]},geometry:{type:"MultiPolygon",coordinates:[[[[23.05288,43.79494],[22.85314,43.84452],[22.83753,43.88055],[22.87873,43.9844],[23.01674,44.01946],[23.04988,44.07694],[22.67173,44.21564],[22.61711,44.16938],[22.61688,44.06534],[22.41449,44.00514],[22.35558,43.81281],[22.41043,43.69566],[22.47582,43.6558],[22.53397,43.47225],[22.82036,43.33665],[22.89727,43.22417],[23.00806,43.19279],[22.98104,43.11199],[22.89521,43.03625],[22.78397,42.98253],[22.74826,42.88701],[22.54302,42.87774],[22.43309,42.82057],[22.4997,42.74144],[22.43983,42.56851],[22.55669,42.50144],[22.51961,42.3991],[22.47498,42.3915],[22.45919,42.33822],[22.34773,42.31725],[22.38136,42.30339],[22.47251,42.20393],[22.50289,42.19527],[22.51224,42.15457],[22.67701,42.06614],[22.86749,42.02275],[22.90254,41.87587],[22.96682,41.77137],[23.01239,41.76527],[23.03342,41.71034],[22.95513,41.63265],[22.96331,41.35782],[22.93334,41.34104],[23.1833,41.31755],[23.21953,41.33773],[23.22771,41.37106],[23.31301,41.40525],[23.33639,41.36317],[23.40416,41.39999],[23.52453,41.40262],[23.63203,41.37632],[23.67644,41.41139],[23.76525,41.40175],[23.80148,41.43943],[23.89613,41.45257],[23.91483,41.47971],[23.96975,41.44118],[24.06908,41.46132],[24.06323,41.53222],[24.10063,41.54796],[24.18126,41.51735],[24.27124,41.57682],[24.30513,41.51297],[24.52599,41.56808],[24.61129,41.42278],[24.71529,41.41928],[24.8041,41.34913],[24.82514,41.4035],[24.86136,41.39298],[24.90928,41.40876],[24.942,41.38685],[25.11611,41.34212],[25.28322,41.23411],[25.48187,41.28506],[25.52394,41.2798],[25.55082,41.31667],[25.61042,41.30614],[25.66183,41.31316],[25.70507,41.29209],[25.8266,41.34563],[25.87919,41.30526],[26.12926,41.35878],[26.16548,41.42278],[26.20288,41.43943],[26.14796,41.47533],[26.176,41.50072],[26.17951,41.55409],[26.14328,41.55496],[26.15146,41.60828],[26.07083,41.64584],[26.06148,41.70345],[26.16841,41.74858],[26.21325,41.73223],[26.22888,41.74139],[26.2654,41.71544],[26.30255,41.70925],[26.35957,41.71149],[26.32952,41.73637],[26.33589,41.76802],[26.36952,41.82265],[26.53968,41.82653],[26.57961,41.90024],[26.56051,41.92995],[26.62996,41.97644],[26.79143,41.97386],[26.95638,42.00741],[27.03277,42.0809],[27.08486,42.08735],[27.19251,42.06028],[27.22376,42.10152],[27.27411,42.10409],[27.45478,41.96591],[27.52379,41.93756],[27.55191,41.90928],[27.69949,41.97515],[27.81235,41.94803],[27.83492,41.99709],[27.91479,41.97902],[28.02971,41.98066],[28.32297,41.98371],[29.24336,43.70874],[28.23293,43.76],[27.99558,43.84193],[27.92008,44.00761],[27.73468,43.95326],[27.64542,44.04958],[27.60834,44.01206],[27.39757,44.0141],[27.26845,44.12602],[26.95141,44.13555],[26.62712,44.05698],[26.38764,44.04356],[26.10115,43.96908],[26.05584,43.90925],[25.94911,43.85745],[25.72792,43.69263],[25.39528,43.61866],[25.17144,43.70261],[25.10718,43.6831],[24.96682,43.72693],[24.73542,43.68523],[24.62281,43.74082],[24.50264,43.76314],[24.35364,43.70211],[24.18149,43.68218],[23.73978,43.80627],[23.61687,43.79289],[23.4507,43.84936],[23.26772,43.84843],[23.05288,43.79494]]]]}},{type:"Feature",properties:{iso1A2:"BH",iso1A3:"BHR",iso1N3:"048",wikidata:"Q398",nameEn:"Bahrain",groups:["145","142","UN"],callingCodes:["973"]},geometry:{type:"MultiPolygon",coordinates:[[[[50.93865,26.30758],[50.71771,26.73086],[50.38162,26.53976],[50.26923,26.08243],[50.302,25.87592],[50.57069,25.57887],[50.80824,25.54641],[50.7801,25.595],[50.86149,25.6965],[50.81266,25.88946],[50.93865,26.30758]]]]}},{type:"Feature",properties:{iso1A2:"BI",iso1A3:"BDI",iso1N3:"108",wikidata:"Q967",nameEn:"Burundi",groups:["014","202","002","UN"],callingCodes:["257"]},geometry:{type:"MultiPolygon",coordinates:[[[[30.54501,-2.41404],[30.42933,-2.31064],[30.14034,-2.43626],[29.95911,-2.33348],[29.88237,-2.75105],[29.36805,-2.82933],[29.32234,-2.6483],[29.0562,-2.58632],[29.04081,-2.7416],[29.00167,-2.78523],[29.00404,-2.81978],[29.0505,-2.81774],[29.09119,-2.87871],[29.09797,-2.91935],[29.16037,-2.95457],[29.17258,-2.99385],[29.25633,-3.05471],[29.21463,-3.3514],[29.23708,-3.75856],[29.43673,-4.44845],[29.63827,-4.44681],[29.75109,-4.45836],[29.77289,-4.41733],[29.82885,-4.36153],[29.88172,-4.35743],[30.03323,-4.26631],[30.22042,-4.01738],[30.45915,-3.56532],[30.84165,-3.25152],[30.83823,-2.97837],[30.6675,-2.98987],[30.57926,-2.89791],[30.4987,-2.9573],[30.40662,-2.86151],[30.52747,-2.65841],[30.41789,-2.66266],[30.54501,-2.41404]]]]}},{type:"Feature",properties:{iso1A2:"BJ",iso1A3:"BEN",iso1N3:"204",wikidata:"Q962",nameEn:"Benin",aliases:["DY"],groups:["011","202","002","UN"],callingCodes:["229"]},geometry:{type:"MultiPolygon",coordinates:[[[[3.59375,11.70269],[3.48187,11.86092],[3.31613,11.88495],[3.25352,12.01467],[2.83978,12.40585],[2.6593,12.30631],[2.37783,12.24804],[2.39657,12.10952],[2.45824,11.98672],[2.39723,11.89473],[2.29983,11.68254],[2.00988,11.42227],[1.42823,11.46822],[1.03409,11.04719],[.9813,11.08876],[.91245,10.99597],[.8804,10.803],[.80358,10.71459],[.77666,10.37665],[1.35507,9.99525],[1.36624,9.5951],[1.33675,9.54765],[1.41746,9.3226],[1.5649,9.16941],[1.61838,9.0527],[1.64249,6.99562],[1.55877,6.99737],[1.61812,6.74843],[1.58105,6.68619],[1.76906,6.43189],[1.79826,6.28221],[1.62913,6.24075],[1.67336,6.02702],[2.74181,6.13349],[2.70566,6.38038],[2.70464,6.50831],[2.74334,6.57291],[2.7325,6.64057],[2.78204,6.70514],[2.78823,6.76356],[2.73405,6.78508],[2.74024,6.92802],[2.71702,6.95722],[2.76965,7.13543],[2.74489,7.42565],[2.79442,7.43486],[2.78668,7.5116],[2.73405,7.5423],[2.73095,7.7755],[2.67523,7.87825],[2.77907,9.06924],[3.08017,9.10006],[3.14147,9.28375],[3.13928,9.47167],[3.25093,9.61632],[3.34726,9.70696],[3.32099,9.78032],[3.35383,9.83641],[3.54429,9.87739],[3.66908,10.18136],[3.57275,10.27185],[3.6844,10.46351],[3.78292,10.40538],[3.84243,10.59316],[3.71505,11.13015],[3.49175,11.29765],[3.59375,11.70269]]]]}},{type:"Feature",properties:{iso1A2:"BL",iso1A3:"BLM",iso1N3:"652",wikidata:"Q25362",nameEn:"Saint-Barth\xE9lemy",country:"FR",groups:["EU","Q1451600","029","003","419","019","UN"],callingCodes:["590"]},geometry:{type:"MultiPolygon",coordinates:[[[[-62.62718,18.26185],[-63.1055,17.86651],[-62.34423,17.49165],[-62.62718,18.26185]]]]}},{type:"Feature",properties:{iso1A2:"BM",iso1A3:"BMU",iso1N3:"060",wikidata:"Q23635",nameEn:"Bermuda",country:"GB",groups:["BOTS","021","003","019","UN"],driveSide:"left",callingCodes:["1 441"]},geometry:{type:"MultiPolygon",coordinates:[[[[-63.20987,32.6953],[-65.31453,32.68437],[-65.63955,31.43417],[-63.20987,32.6953]]]]}},{type:"Feature",properties:{iso1A2:"BN",iso1A3:"BRN",iso1N3:"096",wikidata:"Q921",nameEn:"Brunei",groups:["Q36117","035","142","UN"],driveSide:"left",callingCodes:["673"]},geometry:{type:"MultiPolygon",coordinates:[[[[115.16236,5.01011],[115.02521,5.35005],[114.10166,4.76112],[114.07448,4.58441],[114.15813,4.57],[114.26876,4.49878],[114.32176,4.34942],[114.32176,4.2552],[114.4416,4.27588],[114.49922,4.13108],[114.64211,4.00694],[114.78539,4.12205],[114.88039,4.4257],[114.83189,4.42387],[114.77303,4.72871],[114.8266,4.75062],[114.88841,4.81905],[114.96982,4.81146],[114.99417,4.88201],[115.05038,4.90275],[115.02955,4.82087],[115.02278,4.74137],[115.04064,4.63706],[115.07737,4.53418],[115.09978,4.39123],[115.31275,4.30806],[115.36346,4.33563],[115.2851,4.42295],[115.27819,4.63661],[115.20737,4.8256],[115.15092,4.87604],[115.16236,5.01011]]]]}},{type:"Feature",properties:{iso1A2:"BO",iso1A3:"BOL",iso1N3:"068",wikidata:"Q750",nameEn:"Bolivia",groups:["005","419","019","UN"],callingCodes:["591"]},geometry:{type:"MultiPolygon",coordinates:[[[[-63.90248,-12.52544],[-64.22539,-12.45267],[-64.30708,-12.46398],[-64.99778,-11.98604],[-65.30027,-11.48749],[-65.28141,-10.86289],[-65.35402,-10.78685],[-65.37923,-10.35141],[-65.29019,-9.86253],[-65.40615,-9.63894],[-65.56244,-9.84266],[-65.68343,-9.75323],[-67.17784,-10.34016],[-68.71533,-11.14749],[-68.7651,-11.0496],[-68.75179,-11.03688],[-68.75265,-11.02383],[-68.74802,-11.00891],[-69.42792,-10.93451],[-69.47839,-10.95254],[-69.57156,-10.94555],[-68.98115,-11.8979],[-68.65044,-12.50689],[-68.85615,-12.87769],[-68.8864,-13.40792],[-69.05265,-13.68546],[-68.88135,-14.18639],[-69.36254,-14.94634],[-69.14856,-15.23478],[-69.40336,-15.61358],[-69.20291,-16.16668],[-69.09986,-16.22693],[-68.96238,-16.194],[-68.79464,-16.33272],[-68.98358,-16.42165],[-69.04027,-16.57214],[-69.00853,-16.66769],[-69.16896,-16.72233],[-69.62883,-17.28142],[-69.46863,-17.37466],[-69.46897,-17.4988],[-69.46623,-17.60518],[-69.34126,-17.72753],[-69.28671,-17.94844],[-69.07496,-18.03715],[-69.14807,-18.16893],[-69.07432,-18.28259],[-68.94987,-18.93302],[-68.87082,-19.06003],[-68.80602,-19.08355],[-68.61989,-19.27584],[-68.41218,-19.40499],[-68.66761,-19.72118],[-68.54611,-19.84651],[-68.57132,-20.03134],[-68.74273,-20.08817],[-68.7276,-20.46178],[-68.44023,-20.62701],[-68.55383,-20.7355],[-68.53957,-20.91542],[-68.40403,-20.94562],[-68.18816,-21.28614],[-67.85114,-22.87076],[-67.54284,-22.89771],[-67.18382,-22.81525],[-66.7298,-22.23644],[-66.29714,-22.08741],[-66.24077,-21.77837],[-66.03836,-21.84829],[-66.04832,-21.9187],[-65.9261,-21.93335],[-65.7467,-22.10105],[-65.61166,-22.09504],[-65.58694,-22.09794],[-65.57743,-22.07675],[-65.47435,-22.08908],[-64.99524,-22.08255],[-64.90014,-22.12136],[-64.67174,-22.18957],[-64.58888,-22.25035],[-64.4176,-22.67692],[-64.35108,-22.73282],[-64.31489,-22.88824],[-64.22918,-22.55807],[-63.93287,-21.99934],[-63.70963,-21.99934],[-63.68113,-22.0544],[-63.66482,-21.99918],[-62.81124,-21.9987],[-62.8078,-22.12534],[-62.64455,-22.25091],[-62.2757,-21.06657],[-62.26883,-20.55311],[-61.93912,-20.10053],[-61.73723,-19.63958],[-60.00638,-19.2981],[-59.06965,-19.29148],[-58.23216,-19.80058],[-58.16225,-20.16193],[-57.8496,-19.98346],[-58.14215,-19.76276],[-57.78463,-19.03259],[-57.71113,-19.03161],[-57.69134,-19.00544],[-57.71995,-18.97546],[-57.71995,-18.89573],[-57.76764,-18.90087],[-57.56807,-18.25655],[-57.48237,-18.24219],[-57.69877,-17.8431],[-57.73949,-17.56095],[-57.90082,-17.44555],[-57.99661,-17.5273],[-58.32935,-17.28195],[-58.5058,-16.80958],[-58.30918,-16.3699],[-58.32431,-16.25861],[-58.41506,-16.32636],[-60.16069,-16.26479],[-60.23797,-15.50267],[-60.58224,-15.09887],[-60.23968,-15.09515],[-60.27887,-14.63021],[-60.46037,-14.22496],[-60.48053,-13.77981],[-61.05527,-13.50054],[-61.81151,-13.49564],[-63.76259,-12.42952],[-63.90248,-12.52544]]]]}},{type:"Feature",properties:{iso1A2:"BQ",iso1A3:"BES",iso1N3:"535",wikidata:"Q27561",nameEn:"Caribbean Netherlands",country:"NL"},geometry:null},{type:"Feature",properties:{iso1A2:"BR",iso1A3:"BRA",iso1N3:"076",wikidata:"Q155",nameEn:"Brazil",groups:["005","419","019","UN"],callingCodes:["55"]},geometry:{type:"MultiPolygon",coordinates:[[[[-59.69361,4.34069],[-59.78878,4.45637],[-60.15953,4.53456],[-60.04189,4.69801],[-59.98129,5.07097],[-60.20944,5.28754],[-60.32352,5.21299],[-60.73204,5.20931],[-60.5802,4.94312],[-60.86539,4.70512],[-60.98303,4.54167],[-61.15703,4.49839],[-61.31457,4.54167],[-61.29675,4.44216],[-61.48569,4.43149],[-61.54629,4.2822],[-62.13094,4.08309],[-62.44822,4.18621],[-62.57656,4.04754],[-62.74411,4.03331],[-62.7655,3.73099],[-62.98296,3.59935],[-63.21111,3.96219],[-63.4464,3.9693],[-63.42233,3.89995],[-63.50611,3.83592],[-63.67099,4.01731],[-63.70218,3.91417],[-63.86082,3.94796],[-63.99183,3.90172],[-64.14512,4.12932],[-64.57648,4.12576],[-64.72977,4.28931],[-64.84028,4.24665],[-64.48379,3.7879],[-64.02908,2.79797],[-64.0257,2.48156],[-63.39114,2.4317],[-63.39827,2.16098],[-64.06135,1.94722],[-64.08274,1.64792],[-64.34654,1.35569],[-64.38932,1.5125],[-65.11657,1.12046],[-65.57288,.62856],[-65.50158,.92086],[-65.6727,1.01353],[-66.28507,.74585],[-66.85795,1.22998],[-67.08222,1.17441],[-67.15784,1.80439],[-67.299,1.87494],[-67.40488,2.22258],[-67.9292,1.82455],[-68.18632,2.00091],[-68.26699,1.83463],[-68.18128,1.72881],[-69.38621,1.70865],[-69.53746,1.76408],[-69.83491,1.69353],[-69.82987,1.07864],[-69.26017,1.06856],[-69.14422,.84172],[-69.20976,.57958],[-69.47696,.71065],[-70.04162,.55437],[-70.03658,-.19681],[-69.603,-.51947],[-69.59796,-.75136],[-69.4215,-1.01853],[-69.43395,-1.42219],[-69.94708,-4.2431],[-70.00888,-4.37833],[-70.11305,-4.27281],[-70.19582,-4.3607],[-70.33236,-4.15214],[-70.77601,-4.15717],[-70.96814,-4.36915],[-71.87003,-4.51661],[-72.64391,-5.0391],[-72.83973,-5.14765],[-73.24579,-6.05764],[-73.12983,-6.43852],[-73.73986,-6.87919],[-73.77011,-7.28944],[-73.96938,-7.58465],[-73.65485,-7.77897],[-73.76576,-7.89884],[-72.92886,-9.04074],[-73.21498,-9.40904],[-72.72216,-9.41397],[-72.31883,-9.5184],[-72.14742,-9.98049],[-71.23394,-9.9668],[-70.53373,-9.42628],[-70.58453,-9.58303],[-70.55429,-9.76692],[-70.62487,-9.80666],[-70.64134,-11.0108],[-70.51395,-10.92249],[-70.38791,-11.07096],[-69.90896,-10.92744],[-69.57835,-10.94051],[-69.57156,-10.94555],[-69.47839,-10.95254],[-69.42792,-10.93451],[-68.74802,-11.00891],[-68.75265,-11.02383],[-68.75179,-11.03688],[-68.7651,-11.0496],[-68.71533,-11.14749],[-67.17784,-10.34016],[-65.68343,-9.75323],[-65.56244,-9.84266],[-65.40615,-9.63894],[-65.29019,-9.86253],[-65.37923,-10.35141],[-65.35402,-10.78685],[-65.28141,-10.86289],[-65.30027,-11.48749],[-64.99778,-11.98604],[-64.30708,-12.46398],[-64.22539,-12.45267],[-63.90248,-12.52544],[-63.76259,-12.42952],[-61.81151,-13.49564],[-61.05527,-13.50054],[-60.48053,-13.77981],[-60.46037,-14.22496],[-60.27887,-14.63021],[-60.23968,-15.09515],[-60.58224,-15.09887],[-60.23797,-15.50267],[-60.16069,-16.26479],[-58.41506,-16.32636],[-58.32431,-16.25861],[-58.30918,-16.3699],[-58.5058,-16.80958],[-58.32935,-17.28195],[-57.99661,-17.5273],[-57.90082,-17.44555],[-57.73949,-17.56095],[-57.69877,-17.8431],[-57.48237,-18.24219],[-57.56807,-18.25655],[-57.76764,-18.90087],[-57.71995,-18.89573],[-57.71995,-18.97546],[-57.69134,-19.00544],[-57.71113,-19.03161],[-57.78463,-19.03259],[-58.14215,-19.76276],[-57.8496,-19.98346],[-58.16225,-20.16193],[-57.84536,-20.93155],[-57.93492,-21.65505],[-57.88239,-21.6868],[-57.94642,-21.73799],[-57.98625,-22.09157],[-56.6508,-22.28387],[-56.5212,-22.11556],[-56.45893,-22.08072],[-56.23206,-22.25347],[-55.8331,-22.29008],[-55.74941,-22.46436],[-55.741,-22.52018],[-55.72366,-22.5519],[-55.6986,-22.56268],[-55.68742,-22.58407],[-55.62493,-22.62765],[-55.63849,-22.95122],[-55.5446,-23.22811],[-55.52288,-23.2595],[-55.5555,-23.28237],[-55.43585,-23.87157],[-55.44117,-23.9185],[-55.41784,-23.9657],[-55.12292,-23.99669],[-55.0518,-23.98666],[-55.02691,-23.97317],[-54.6238,-23.83078],[-54.32807,-24.01865],[-54.28207,-24.07305],[-54.4423,-25.13381],[-54.62033,-25.46026],[-54.60196,-25.48397],[-54.59509,-25.53696],[-54.59398,-25.59224],[-54.5502,-25.58915],[-54.52926,-25.62846],[-53.90831,-25.55513],[-53.83691,-25.94849],[-53.73511,-26.04211],[-53.73086,-26.05842],[-53.7264,-26.0664],[-53.73391,-26.07006],[-53.73968,-26.10012],[-53.65018,-26.19501],[-53.65237,-26.23289],[-53.63739,-26.2496],[-53.63881,-26.25075],[-53.64632,-26.24798],[-53.64186,-26.25976],[-53.64505,-26.28089],[-53.68269,-26.33359],[-53.73372,-26.6131],[-53.80144,-27.09844],[-54.15978,-27.2889],[-54.19062,-27.27639],[-54.19268,-27.30751],[-54.41888,-27.40882],[-54.50416,-27.48232],[-54.67657,-27.57214],[-54.90159,-27.63132],[-54.90805,-27.73149],[-55.1349,-27.89759],[-55.16872,-27.86224],[-55.33303,-27.94661],[-55.6262,-28.17124],[-55.65418,-28.18304],[-56.01729,-28.51223],[-56.00458,-28.60421],[-56.05265,-28.62651],[-56.54171,-29.11447],[-56.57295,-29.11357],[-56.62789,-29.18073],[-56.81251,-29.48154],[-57.09386,-29.74211],[-57.65132,-30.19229],[-57.22502,-30.26121],[-56.90236,-30.02578],[-56.49267,-30.39471],[-56.4795,-30.3899],[-56.4619,-30.38457],[-55.87388,-31.05053],[-55.58866,-30.84117],[-55.5634,-30.8686],[-55.55373,-30.8732],[-55.55218,-30.88193],[-55.54572,-30.89051],[-55.53431,-30.89714],[-55.53276,-30.90218],[-55.52712,-30.89997],[-55.51862,-30.89828],[-55.50841,-30.9027],[-55.50821,-30.91349],[-54.17384,-31.86168],[-53.76024,-32.0751],[-53.39572,-32.58596],[-53.37671,-32.57005],[-53.1111,-32.71147],[-53.53459,-33.16843],[-53.52794,-33.68908],[-53.44031,-33.69344],[-53.39593,-33.75169],[-53.37138,-33.74313],[-52.83257,-34.01481],[-28.34015,-20.99094],[-28.99601,1.86593],[-51.35485,4.8383],[-51.63798,4.51394],[-51.61983,4.14596],[-51.79599,3.89336],[-51.82312,3.85825],[-51.85573,3.83427],[-52.31787,3.17896],[-52.6906,2.37298],[-52.96539,2.1881],[-53.78743,2.34412],[-54.16286,2.10779],[-54.6084,2.32856],[-55.01919,2.564],[-55.71493,2.40342],[-55.96292,2.53188],[-56.13054,2.27723],[-55.92159,2.05236],[-55.89863,1.89861],[-55.99278,1.83137],[-56.47045,1.95135],[-56.7659,1.89509],[-57.07092,1.95304],[-57.09109,2.01854],[-57.23981,1.95808],[-57.35073,1.98327],[-57.55743,1.69605],[-57.77281,1.73344],[-57.97336,1.64566],[-58.01873,1.51966],[-58.33887,1.58014],[-58.4858,1.48399],[-58.53571,1.29154],[-58.84229,1.17749],[-58.92072,1.31293],[-59.25583,1.40559],[-59.74066,1.87596],[-59.7264,2.27497],[-59.91177,2.36759],[-59.99733,2.92312],[-59.79769,3.37162],[-59.86899,3.57089],[-59.51963,3.91951],[-59.73353,4.20399],[-59.69361,4.34069]]]]}},{type:"Feature",properties:{iso1A2:"BS",iso1A3:"BHS",iso1N3:"044",wikidata:"Q778",nameEn:"The Bahamas",groups:["029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",callingCodes:["1 242"]},geometry:{type:"MultiPolygon",coordinates:[[[[-72.98446,20.4801],[-71.70065,25.7637],[-78.91214,27.76553],[-80.65727,23.71953],[-72.98446,20.4801]]]]}},{type:"Feature",properties:{iso1A2:"BT",iso1A3:"BTN",iso1N3:"064",wikidata:"Q917",nameEn:"Bhutan",groups:["034","142","UN"],driveSide:"left",callingCodes:["975"]},geometry:{type:"MultiPolygon",coordinates:[[[[91.6469,27.76358],[91.5629,27.84823],[91.48973,27.93903],[91.46327,28.0064],[91.25779,28.07509],[91.20019,27.98715],[90.69894,28.07784],[90.58842,28.02838],[90.13387,28.19178],[89.79762,28.23979],[89.59525,28.16433],[89.12825,27.62502],[89.0582,27.60985],[88.97213,27.51671],[88.95355,27.4106],[89.00216,27.32532],[88.96947,27.30319],[88.93678,27.33777],[88.91901,27.32483],[88.74219,27.144],[88.86984,27.10937],[88.8714,26.97488],[88.92301,26.99286],[88.95807,26.92668],[89.09554,26.89089],[89.12825,26.81661],[89.1926,26.81329],[89.37913,26.86224],[89.38319,26.85963],[89.3901,26.84225],[89.42349,26.83727],[89.63369,26.74402],[89.86124,26.73307],[90.04535,26.72422],[90.30402,26.85098],[90.39271,26.90704],[90.48504,26.8594],[90.67715,26.77215],[91.50067,26.79223],[91.83181,26.87318],[92.05523,26.8692],[92.11863,26.893],[92.03457,27.07334],[92.04702,27.26861],[92.12019,27.27829],[92.01132,27.47352],[91.65007,27.48287],[91.55819,27.6144],[91.6469,27.76358]]]]}},{type:"Feature",properties:{iso1A2:"BV",iso1A3:"BVT",iso1N3:"074",wikidata:"Q23408",nameEn:"Bouvet Island",country:"NO",groups:["005","419","019","UN"]},geometry:{type:"MultiPolygon",coordinates:[[[[4.54042,-54.0949],[2.28941,-54.13089],[3.35353,-55.17558],[4.54042,-54.0949]]]]}},{type:"Feature",properties:{iso1A2:"BW",iso1A3:"BWA",iso1N3:"072",wikidata:"Q963",nameEn:"Botswana",groups:["018","202","002","UN"],driveSide:"left",callingCodes:["267"]},geometry:{type:"MultiPolygon",coordinates:[[[[25.26433,-17.79571],[25.16882,-17.78253],[25.05895,-17.84452],[24.95586,-17.79674],[24.73364,-17.89338],[24.71887,-17.9218],[24.6303,-17.9863],[24.57485,-18.07151],[24.40577,-17.95726],[24.19416,-18.01919],[23.61088,-18.4881],[23.29618,-17.99855],[23.0996,-18.00075],[21.45556,-18.31795],[20.99904,-18.31743],[20.99751,-22.00026],[19.99912,-21.99991],[19.99817,-24.76768],[20.02809,-24.78725],[20.03678,-24.81004],[20.29826,-24.94869],[20.64795,-25.47827],[20.86081,-26.14892],[20.61754,-26.4692],[20.63275,-26.78181],[20.68596,-26.9039],[20.87031,-26.80047],[21.13353,-26.86661],[21.37869,-26.82083],[21.69322,-26.86152],[21.7854,-26.79199],[21.77114,-26.69015],[21.83291,-26.65959],[21.90703,-26.66808],[22.06192,-26.61882],[22.21206,-26.3773],[22.41921,-26.23078],[22.56365,-26.19668],[22.70808,-25.99186],[22.86012,-25.50572],[23.03497,-25.29971],[23.47588,-25.29971],[23.9244,-25.64286],[24.18287,-25.62916],[24.36531,-25.773],[24.44703,-25.73021],[24.67319,-25.81749],[24.8946,-25.80723],[25.01718,-25.72507],[25.12266,-25.75931],[25.33076,-25.76616],[25.58543,-25.6343],[25.6643,-25.4491],[25.69661,-25.29284],[25.72702,-25.25503],[25.88571,-24.87802],[25.84295,-24.78661],[25.8515,-24.75727],[26.39409,-24.63468],[26.46346,-24.60358],[26.51667,-24.47219],[26.84165,-24.24885],[26.99749,-23.65486],[27.33768,-23.40917],[27.52393,-23.37952],[27.6066,-23.21894],[27.74154,-23.2137],[27.93539,-23.04941],[27.93729,-22.96194],[28.04752,-22.90243],[28.04562,-22.8394],[28.34874,-22.5694],[28.63287,-22.55887],[28.91889,-22.44299],[29.0151,-22.22907],[29.10881,-22.21202],[29.15268,-22.21399],[29.18974,-22.18599],[29.21955,-22.17771],[29.37703,-22.19581],[29.3533,-22.18363],[29.24648,-22.05967],[29.1974,-22.07472],[29.14501,-22.07275],[29.08495,-22.04867],[29.04108,-22.00563],[29.02191,-21.95665],[29.02191,-21.90647],[29.04023,-21.85864],[29.07763,-21.81877],[28.58114,-21.63455],[28.49942,-21.66634],[28.29416,-21.59037],[28.01669,-21.57624],[27.91407,-21.31621],[27.69171,-21.08409],[27.72972,-20.51735],[27.69361,-20.48531],[27.28865,-20.49873],[27.29831,-20.28935],[27.21278,-20.08244],[26.72246,-19.92707],[26.17227,-19.53709],[25.96226,-19.08152],[25.99837,-19.02943],[25.94326,-18.90362],[25.82353,-18.82808],[25.79217,-18.6355],[25.68859,-18.56165],[25.53465,-18.39041],[25.39972,-18.12691],[25.31799,-18.07091],[25.23909,-17.90832],[25.26433,-17.79571]]]]}},{type:"Feature",properties:{iso1A2:"BY",iso1A3:"BLR",iso1N3:"112",wikidata:"Q184",nameEn:"Belarus",groups:["151","150","UN"],callingCodes:["375"]},geometry:{type:"MultiPolygon",coordinates:[[[[28.15217,56.16964],[27.97865,56.11849],[27.63065,55.89687],[27.61683,55.78558],[27.3541,55.8089],[27.27804,55.78299],[27.1559,55.85032],[26.97153,55.8102],[26.87448,55.7172],[26.76872,55.67658],[26.71802,55.70645],[26.64888,55.70515],[26.63231,55.67968],[26.63167,55.57887],[26.55094,55.5093],[26.5522,55.40277],[26.44937,55.34832],[26.5709,55.32572],[26.6714,55.33902],[26.80929,55.31642],[26.83266,55.30444],[26.835,55.28182],[26.73017,55.24226],[26.72983,55.21788],[26.68075,55.19787],[26.69243,55.16718],[26.54753,55.14181],[26.51481,55.16051],[26.46249,55.12814],[26.35121,55.1525],[26.30628,55.12536],[26.23202,55.10439],[26.26941,55.08032],[26.20397,54.99729],[26.13386,54.98924],[26.05907,54.94631],[25.99129,54.95705],[25.89462,54.93438],[25.74122,54.80108],[25.75977,54.57252],[25.68045,54.5321],[25.64813,54.48704],[25.62203,54.4656],[25.63371,54.42075],[25.5376,54.33158],[25.55425,54.31591],[25.68513,54.31727],[25.78553,54.23327],[25.78563,54.15747],[25.71084,54.16704],[25.64875,54.1259],[25.54724,54.14925],[25.51452,54.17799],[25.56823,54.25212],[25.509,54.30267],[25.35559,54.26544],[25.22705,54.26271],[25.19199,54.219],[25.0728,54.13419],[24.991,54.14241],[24.96894,54.17589],[24.77131,54.11091],[24.85311,54.02862],[24.74279,53.96663],[24.69185,53.96543],[24.69652,54.01901],[24.62275,54.00217],[24.44411,53.90076],[24.34128,53.90076],[24.19638,53.96405],[23.98837,53.92554],[23.95098,53.9613],[23.81309,53.94205],[23.80543,53.89558],[23.71726,53.93379],[23.61677,53.92691],[23.51284,53.95052],[23.62004,53.60942],[23.81995,53.24131],[23.85657,53.22923],[23.91393,53.16469],[23.87548,53.0831],[23.92184,53.02079],[23.94689,52.95919],[23.91805,52.94016],[23.93763,52.71332],[23.73615,52.6149],[23.58296,52.59868],[23.45112,52.53774],[23.34141,52.44845],[23.18196,52.28812],[23.20071,52.22848],[23.47859,52.18215],[23.54314,52.12148],[23.61,52.11264],[23.64066,52.07626],[23.68733,51.9906],[23.61523,51.92066],[23.62691,51.78208],[23.53198,51.74298],[23.57053,51.55938],[23.56236,51.53673],[23.62751,51.50512],[23.6736,51.50255],[23.60906,51.62122],[23.7766,51.66809],[23.91118,51.63316],[23.8741,51.59734],[23.99907,51.58369],[24.13075,51.66979],[24.3163,51.75063],[24.29021,51.80841],[24.37123,51.88222],[24.98784,51.91273],[25.20228,51.97143],[25.46163,51.92205],[25.73673,51.91973],[25.80574,51.94556],[25.83217,51.92587],[26.00408,51.92967],[26.19084,51.86781],[26.39367,51.87315],[26.46962,51.80501],[26.69759,51.82284],[26.80043,51.75777],[26.9489,51.73788],[26.99422,51.76933],[27.20602,51.77291],[27.20948,51.66713],[27.26613,51.65957],[27.24828,51.60161],[27.47212,51.61184],[27.51058,51.5854],[27.55727,51.63486],[27.71932,51.60672],[27.67125,51.50854],[27.76052,51.47604],[27.85253,51.62293],[27.91844,51.61952],[27.95827,51.56065],[28.10658,51.57857],[28.23452,51.66988],[28.37592,51.54505],[28.47051,51.59734],[28.64429,51.5664],[28.69161,51.44695],[28.73143,51.46236],[28.75615,51.41442],[28.78224,51.45294],[28.76027,51.48802],[28.81795,51.55552],[28.95528,51.59222],[28.99098,51.56833],[29.1187,51.65872],[29.16402,51.64679],[29.20659,51.56918],[29.25603,51.57089],[29.25191,51.49828],[29.32881,51.37843],[29.42357,51.4187],[29.49773,51.39814],[29.54372,51.48372],[29.7408,51.53417],[29.77376,51.4461],[30.17888,51.51025],[30.34642,51.42555],[30.36153,51.33984],[30.56203,51.25655],[30.64992,51.35014],[30.51946,51.59649],[30.68804,51.82806],[30.76443,51.89739],[30.90897,52.00699],[30.95589,52.07775],[31.13332,52.1004],[31.25142,52.04131],[31.38326,52.12991],[31.7822,52.11406],[31.77877,52.18636],[31.6895,52.1973],[31.70735,52.26711],[31.57971,52.32146],[31.62084,52.33849],[31.61397,52.48843],[31.56316,52.51518],[31.63869,52.55361],[31.50406,52.69707],[31.57277,52.71613],[31.592,52.79011],[31.35667,52.97854],[31.24147,53.031],[31.32283,53.04101],[31.33519,53.08805],[31.3915,53.09712],[31.36403,53.13504],[31.40523,53.21406],[31.56316,53.19432],[31.62496,53.22886],[31.787,53.18033],[31.82373,53.10042],[32.15368,53.07594],[32.40773,53.18856],[32.51725,53.28431],[32.73257,53.33494],[32.74968,53.45597],[32.47777,53.5548],[32.40499,53.6656],[32.50112,53.68594],[32.45717,53.74039],[32.36663,53.7166],[32.12621,53.81586],[31.89137,53.78099],[31.77028,53.80015],[31.85019,53.91801],[31.88744,54.03653],[31.89599,54.0837],[31.57002,54.14535],[31.30791,54.25315],[31.3177,54.34067],[31.22945,54.46585],[31.08543,54.50361],[31.21399,54.63113],[31.19339,54.66947],[30.99187,54.67046],[30.98226,54.68872],[31.0262,54.70698],[30.97127,54.71967],[30.95479,54.74346],[30.75165,54.80699],[30.8264,54.90062],[30.81759,54.94064],[30.93144,54.9585],[30.95754,54.98609],[30.9081,55.02232],[30.94243,55.03964],[31.00972,55.02783],[31.02071,55.06167],[30.97369,55.17134],[30.87944,55.28223],[30.81946,55.27931],[30.8257,55.3313],[30.93144,55.3914],[30.90123,55.46621],[30.95204,55.50667],[30.93419,55.6185],[30.86003,55.63169],[30.7845,55.58514],[30.72957,55.66268],[30.67464,55.64176],[30.63344,55.73079],[30.51037,55.76568],[30.51346,55.78982],[30.48257,55.81066],[30.30987,55.83592],[30.27776,55.86819],[30.12136,55.8358],[29.97975,55.87281],[29.80672,55.79569],[29.61446,55.77716],[29.51283,55.70294],[29.3604,55.75862],[29.44692,55.95978],[29.21717,55.98971],[29.08299,56.03427],[28.73418,55.97131],[28.63668,56.07262],[28.68337,56.10173],[28.5529,56.11705],[28.43068,56.09407],[28.37987,56.11399],[28.36888,56.05805],[28.30571,56.06035],[28.15217,56.16964]]]]}},{type:"Feature",properties:{iso1A2:"BZ",iso1A3:"BLZ",iso1N3:"084",wikidata:"Q242",nameEn:"Belize",groups:["013","003","419","019","UN"],roadSpeedUnit:"mph",callingCodes:["501"]},geometry:{type:"MultiPolygon",coordinates:[[[[-88.3268,18.49048],[-88.48242,18.49164],[-88.71505,18.0707],[-88.8716,17.89535],[-89.03839,18.0067],[-89.15105,17.95104],[-89.14985,17.81563],[-89.15025,17.04813],[-89.22683,15.88619],[-89.17418,15.90898],[-89.02415,15.9063],[-88.95358,15.88698],[-88.40779,16.09624],[-86.92368,17.61462],[-87.84815,18.18511],[-87.85693,18.18266],[-87.86657,18.19971],[-87.87604,18.18313],[-87.90671,18.15213],[-88.03165,18.16657],[-88.03238,18.41778],[-88.26593,18.47617],[-88.29909,18.47591],[-88.3268,18.49048]]]]}},{type:"Feature",properties:{iso1A2:"CA",iso1A3:"CAN",iso1N3:"124",wikidata:"Q16",nameEn:"Canada",groups:["021","003","019","UN"],callingCodes:["1"]},geometry:{type:"MultiPolygon",coordinates:[[[[-67.20349,45.1722],[-67.19603,45.16771],[-67.15965,45.16179],[-67.11316,45.11176],[-67.0216,44.95333],[-66.96824,44.90965],[-66.98249,44.87071],[-66.96824,44.83078],[-66.93432,44.82597],[-67.16117,44.20069],[-61.98255,37.34815],[-56.27503,47.39728],[-53.12387,41.40385],[-46.37635,57.3249],[-77.52957,77.23408],[-68.21821,80.48551],[-49.33696,84.57952],[-140.97446,84.39275],[-141.00116,60.30648],[-140.5227,60.22077],[-140.45648,60.30919],[-139.98024,60.18027],[-139.68991,60.33693],[-139.05831,60.35205],[-139.20603,60.08896],[-139.05365,59.99655],[-138.71149,59.90728],[-138.62145,59.76431],[-137.60623,59.24465],[-137.4925,58.89415],[-136.82619,59.16198],[-136.52365,59.16752],[-136.47323,59.46617],[-136.33727,59.44466],[-136.22381,59.55526],[-136.31566,59.59083],[-135.48007,59.79937],[-135.03069,59.56208],[-135.00267,59.28745],[-134.7047,59.2458],[-134.55699,59.1297],[-134.48059,59.13231],[-134.27175,58.8634],[-133.84645,58.73543],[-133.38523,58.42773],[-131.8271,56.62247],[-130.77769,56.36185],[-130.33965,56.10849],[-130.10173,56.12178],[-130.00093,56.00325],[-130.00857,55.91344],[-130.15373,55.74895],[-129.97513,55.28029],[-130.08035,55.21556],[-130.18765,55.07744],[-130.27203,54.97174],[-130.44184,54.85377],[-130.64499,54.76912],[-130.61931,54.70835],[-133.92876,54.62289],[-133.36909,48.51151],[-125.03842,48.53282],[-123.50039,48.21223],[-123.15614,48.35395],[-123.26565,48.6959],[-123.0093,48.76586],[-123.0093,48.83186],[-123.32163,49.00419],[-95.15355,48.9996],[-95.15357,49.384],[-95.12903,49.37056],[-95.05825,49.35311],[-95.01419,49.35647],[-94.99532,49.36579],[-94.95681,49.37035],[-94.85381,49.32492],[-94.8159,49.32299],[-94.82487,49.29483],[-94.77355,49.11998],[-94.75017,49.09931],[-94.687,48.84077],[-94.70087,48.8339],[-94.70486,48.82365],[-94.69669,48.80918],[-94.69335,48.77883],[-94.58903,48.71803],[-94.54885,48.71543],[-94.53826,48.70216],[-94.44258,48.69223],[-94.4174,48.71049],[-94.27153,48.70232],[-94.25172,48.68404],[-94.25104,48.65729],[-94.23215,48.65202],[-93.85769,48.63284],[-93.83288,48.62745],[-93.80676,48.58232],[-93.80939,48.52439],[-93.79267,48.51631],[-93.66382,48.51845],[-93.47022,48.54357],[-93.44472,48.59147],[-93.40693,48.60948],[-93.39758,48.60364],[-93.3712,48.60599],[-93.33946,48.62787],[-93.25391,48.64266],[-92.94973,48.60866],[-92.7287,48.54005],[-92.6342,48.54133],[-92.62747,48.50278],[-92.69927,48.49573],[-92.71323,48.46081],[-92.65606,48.43471],[-92.50712,48.44921],[-92.45588,48.40624],[-92.48147,48.36609],[-92.37185,48.22259],[-92.27167,48.25046],[-92.30939,48.31251],[-92.26662,48.35651],[-92.202,48.35252],[-92.14732,48.36578],[-92.05339,48.35958],[-91.98929,48.25409],[-91.86125,48.21278],[-91.71231,48.19875],[-91.70451,48.11805],[-91.55649,48.10611],[-91.58025,48.04339],[-91.45829,48.07454],[-91.43248,48.04912],[-91.25025,48.08522],[-91.08016,48.18096],[-90.87588,48.2484],[-90.75045,48.09143],[-90.56444,48.12184],[-90.56312,48.09488],[-90.07418,48.11043],[-89.89974,47.98109],[-89.77248,48.02607],[-89.57972,48.00023],[-89.48837,48.01412],[-88.37033,48.30586],[-84.85871,46.88881],[-84.55635,46.45974],[-84.47607,46.45225],[-84.4481,46.48972],[-84.42101,46.49853],[-84.34174,46.50683],[-84.29893,46.49127],[-84.26351,46.49508],[-84.2264,46.53337],[-84.1945,46.54061],[-84.17723,46.52753],[-84.12885,46.53068],[-84.11196,46.50248],[-84.13451,46.39218],[-84.11254,46.32329],[-84.11615,46.2681],[-84.09756,46.25512],[-84.1096,46.23987],[-83.95399,46.05634],[-83.90453,46.05922],[-83.83329,46.12169],[-83.57017,46.105],[-83.43746,45.99749],[-83.59589,45.82131],[-82.48419,45.30225],[-82.42469,42.992],[-82.4146,42.97626],[-82.4253,42.95423],[-82.45331,42.93139],[-82.4826,42.8068],[-82.46613,42.76615],[-82.51063,42.66025],[-82.51858,42.611],[-82.57583,42.5718],[-82.58873,42.54984],[-82.64242,42.55594],[-82.82964,42.37355],[-83.02253,42.33045],[-83.07837,42.30978],[-83.09837,42.28877],[-83.12724,42.2376],[-83.14962,42.04089],[-83.11184,41.95671],[-82.67862,41.67615],[-78.93684,42.82887],[-78.90712,42.89733],[-78.90905,42.93022],[-78.93224,42.95229],[-78.96312,42.95509],[-78.98126,42.97],[-79.02074,42.98444],[-79.02424,43.01983],[-78.99941,43.05612],[-79.01055,43.06659],[-79.07486,43.07845],[-79.05671,43.10937],[-79.06881,43.12029],[-79.0427,43.13934],[-79.04652,43.16396],[-79.05384,43.17418],[-79.05002,43.20133],[-79.05544,43.21224],[-79.05512,43.25375],[-79.06921,43.26183],[-79.25796,43.54052],[-76.79706,43.63099],[-76.43859,44.09393],[-76.35324,44.13493],[-76.31222,44.19894],[-76.244,44.19643],[-76.1664,44.23051],[-76.16285,44.28262],[-76.00018,44.34896],[-75.95947,44.34463],[-75.8217,44.43176],[-75.76813,44.51537],[-75.41441,44.76614],[-75.2193,44.87821],[-75.01363,44.95608],[-74.99101,44.98051],[-74.8447,45.00606],[-74.66689,45.00646],[-74.32699,44.99029],[-73.35025,45.00942],[-71.50067,45.01357],[-71.48735,45.07784],[-71.42778,45.12624],[-71.40364,45.21382],[-71.44252,45.2361],[-71.37133,45.24624],[-71.29371,45.29996],[-71.22338,45.25184],[-71.19723,45.25438],[-71.14568,45.24128],[-71.08364,45.30623],[-71.01866,45.31573],[-71.0107,45.34819],[-70.95193,45.33895],[-70.91169,45.29849],[-70.89864,45.2398],[-70.84816,45.22698],[-70.80236,45.37444],[-70.82638,45.39828],[-70.78372,45.43269],[-70.65383,45.37592],[-70.62518,45.42286],[-70.72651,45.49771],[-70.68516,45.56964],[-70.54019,45.67291],[-70.38934,45.73215],[-70.41523,45.79497],[-70.25976,45.89675],[-70.24694,45.95138],[-70.31025,45.96424],[-70.23855,46.1453],[-70.29078,46.18832],[-70.18547,46.35357],[-70.05812,46.41768],[-69.99966,46.69543],[-69.22119,47.46461],[-69.05148,47.42012],[-69.05073,47.30076],[-69.05039,47.2456],[-68.89222,47.1807],[-68.70125,47.24399],[-68.60575,47.24659],[-68.57914,47.28431],[-68.38332,47.28723],[-68.37458,47.35851],[-68.23244,47.35712],[-67.94843,47.1925],[-67.87993,47.10377],[-67.78578,47.06473],[-67.78111,45.9392],[-67.75196,45.91814],[-67.80961,45.87531],[-67.75654,45.82324],[-67.80653,45.80022],[-67.80705,45.69528],[-67.6049,45.60725],[-67.43815,45.59162],[-67.42144,45.50584],[-67.50578,45.48971],[-67.42394,45.37969],[-67.48201,45.27351],[-67.34927,45.122],[-67.29754,45.14865],[-67.29748,45.18173],[-67.27039,45.1934],[-67.22751,45.16344],[-67.20349,45.1722]]]]}},{type:"Feature",properties:{iso1A2:"CC",iso1A3:"CCK",iso1N3:"166",wikidata:"Q36004",nameEn:"Cocos (Keeling) Islands",country:"AU",groups:["053","009","UN"],driveSide:"left",callingCodes:["61"]},geometry:{type:"MultiPolygon",coordinates:[[[[96.61846,-10.82438],[96.02343,-12.68334],[97.93979,-12.33309],[96.61846,-10.82438]]]]}},{type:"Feature",properties:{iso1A2:"CD",iso1A3:"COD",iso1N3:"180",wikidata:"Q974",nameEn:"Democratic Republic of the Congo",aliases:["ZR"],groups:["017","202","002","UN"],callingCodes:["243"]},geometry:{type:"MultiPolygon",coordinates:[[[[27.44012,5.07349],[27.09575,5.22305],[26.93064,5.13535],[26.85579,5.03887],[26.74572,5.10685],[26.48595,5.04984],[26.13371,5.25594],[25.86073,5.19455],[25.53271,5.37431],[25.34558,5.29101],[25.31256,5.03668],[24.71816,4.90509],[24.46719,5.0915],[23.38847,4.60013],[22.94817,4.82392],[22.89094,4.79321],[22.84691,4.69887],[22.78526,4.71423],[22.6928,4.47285],[22.60915,4.48821],[22.5431,4.22041],[22.45504,4.13039],[22.27682,4.11347],[22.10721,4.20723],[21.6405,4.317],[21.55904,4.25553],[21.25744,4.33676],[21.21341,4.29285],[21.11214,4.33895],[21.08793,4.39603],[20.90383,4.44877],[20.60184,4.42394],[18.62755,3.47564],[18.63857,3.19342],[18.10683,2.26876],[18.08034,1.58553],[17.85887,1.04327],[17.86989,.58873],[17.95255,.48128],[17.93877,.32424],[17.81204,.23884],[17.66051,-.26535],[17.72112,-.52707],[17.32438,-.99265],[16.97999,-1.12762],[16.70724,-1.45815],[16.50336,-1.8795],[16.16173,-2.16586],[16.22785,-2.59528],[16.1755,-3.25014],[16.21407,-3.2969],[15.89448,-3.9513],[15.53081,-4.042],[15.48121,-4.22062],[15.41785,-4.28381],[15.32693,-4.27282],[15.25411,-4.31121],[15.1978,-4.32388],[14.83101,-4.80838],[14.67948,-4.92093],[14.5059,-4.84956],[14.41499,-4.8825],[14.37366,-4.56125],[14.47284,-4.42941],[14.3957,-4.36623],[14.40672,-4.28381],[13.9108,-4.50906],[13.81162,-4.41842],[13.71794,-4.44864],[13.70417,-4.72601],[13.50305,-4.77818],[13.41764,-4.89897],[13.11182,-4.5942],[13.09648,-4.63739],[13.11195,-4.67745],[12.8733,-4.74346],[12.70868,-4.95505],[12.63465,-4.94632],[12.60251,-5.01715],[12.46297,-5.09408],[12.49815,-5.14058],[12.51589,-5.1332],[12.53586,-5.14658],[12.53599,-5.1618],[12.52301,-5.17481],[12.52318,-5.74353],[12.26557,-5.74031],[12.20376,-5.76338],[11.95767,-5.94705],[12.42245,-6.07585],[13.04371,-5.87078],[16.55507,-5.85631],[16.96282,-7.21787],[17.5828,-8.13784],[18.33635,-8.00126],[19.33698,-7.99743],[19.5469,-7.00195],[20.30218,-6.98955],[20.31846,-6.91953],[20.61689,-6.90876],[20.56263,-7.28566],[21.79824,-7.29628],[21.84856,-9.59871],[22.19039,-9.94628],[22.32604,-10.76291],[22.17954,-10.85884],[22.25951,-11.24911],[22.54205,-11.05784],[23.16602,-11.10577],[23.45631,-10.946],[23.86868,-11.02856],[24.00027,-10.89356],[24.34528,-11.06816],[24.42612,-11.44975],[25.34069,-11.19707],[25.33058,-11.65767],[26.01777,-11.91488],[26.88687,-12.01868],[27.04351,-11.61312],[27.22541,-11.60323],[27.21025,-11.76157],[27.59932,-12.22123],[28.33199,-12.41375],[29.01918,-13.41353],[29.60531,-13.21685],[29.65078,-13.41844],[29.81551,-13.44683],[29.8139,-12.14898],[29.48404,-12.23604],[29.4992,-12.43843],[29.18592,-12.37921],[28.48357,-11.87532],[28.37241,-11.57848],[28.65032,-10.65133],[28.62795,-9.92942],[28.68532,-9.78],[28.56208,-9.49122],[28.51627,-9.44726],[28.52636,-9.35379],[28.36562,-9.30091],[28.38526,-9.23393],[28.9711,-8.66935],[28.88917,-8.4831],[30.79243,-8.27382],[30.2567,-7.14121],[29.52552,-6.2731],[29.43673,-4.44845],[29.23708,-3.75856],[29.21463,-3.3514],[29.25633,-3.05471],[29.17258,-2.99385],[29.16037,-2.95457],[29.09797,-2.91935],[29.09119,-2.87871],[29.0505,-2.81774],[29.00404,-2.81978],[29.00167,-2.78523],[29.04081,-2.7416],[29.00357,-2.70596],[28.94346,-2.69124],[28.89793,-2.66111],[28.90226,-2.62385],[28.89288,-2.55848],[28.87943,-2.55165],[28.86193,-2.53185],[28.86209,-2.5231],[28.87497,-2.50887],[28.88846,-2.50493],[28.89342,-2.49017],[28.89132,-2.47557],[28.86846,-2.44866],[28.86826,-2.41888],[28.89601,-2.37321],[28.95642,-2.37321],[29.00051,-2.29001],[29.105,-2.27043],[29.17562,-2.12278],[29.11847,-1.90576],[29.24458,-1.69663],[29.24323,-1.66826],[29.36322,-1.50887],[29.45038,-1.5054],[29.53062,-1.40499],[29.59061,-1.39016],[29.58388,-.89821],[29.63006,-.8997],[29.62708,-.71055],[29.67176,-.55714],[29.67474,-.47969],[29.65091,-.46777],[29.72687,-.08051],[29.7224,.07291],[29.77454,.16675],[29.81922,.16824],[29.87284,.39166],[29.97413,.52124],[29.95477,.64486],[29.98307,.84295],[30.1484,.89805],[30.22139,.99635],[30.24671,1.14974],[30.48503,1.21675],[31.30127,2.11006],[31.28042,2.17853],[31.20148,2.2217],[31.1985,2.29462],[31.12104,2.27676],[31.07934,2.30207],[31.06593,2.35862],[30.96911,2.41071],[30.91102,2.33332],[30.83059,2.42559],[30.74271,2.43601],[30.75612,2.5863],[30.8857,2.83923],[30.8574,2.9508],[30.77101,3.04897],[30.84251,3.26908],[30.93486,3.40737],[30.94081,3.50847],[30.85153,3.48867],[30.85997,3.5743],[30.80713,3.60506],[30.78512,3.67097],[30.56277,3.62703],[30.57378,3.74567],[30.55396,3.84451],[30.47691,3.83353],[30.27658,3.95653],[30.22374,3.93896],[30.1621,4.10586],[30.06964,4.13221],[29.79666,4.37809],[29.82087,4.56246],[29.49726,4.7007],[29.43341,4.50101],[29.22207,4.34297],[29.03054,4.48784],[28.8126,4.48784],[28.6651,4.42638],[28.20719,4.35614],[27.79551,4.59976],[27.76469,4.79284],[27.65462,4.89375],[27.56656,4.89375],[27.44012,5.07349]]]]}},{type:"Feature",properties:{iso1A2:"CF",iso1A3:"CAF",iso1N3:"140",wikidata:"Q929",nameEn:"Central African Republic",groups:["017","202","002","UN"],callingCodes:["236"]},geometry:{type:"MultiPolygon",coordinates:[[[[22.87758,10.91915],[22.45889,11.00246],[21.72139,10.64136],[21.71479,10.29932],[21.63553,10.217],[21.52766,10.2105],[21.34934,9.95907],[21.26348,9.97642],[20.82979,9.44696],[20.36748,9.11019],[19.06421,9.00367],[18.86388,8.87971],[19.11044,8.68172],[18.79783,8.25929],[18.67455,8.22226],[18.62612,8.14163],[18.64153,8.08714],[18.6085,8.05009],[18.02731,8.01085],[17.93926,7.95853],[17.67288,7.98905],[16.8143,7.53971],[16.6668,7.67281],[16.658,7.75353],[16.59415,7.76444],[16.58315,7.88657],[16.41583,7.77971],[16.40703,7.68809],[15.79942,7.44149],[15.73118,7.52006],[15.49743,7.52179],[15.23397,7.25135],[15.04717,6.77085],[14.96311,6.75693],[14.79966,6.39043],[14.80122,6.34866],[14.74206,6.26356],[14.56149,6.18928],[14.43073,6.08867],[14.42917,6.00508],[14.49455,5.91683],[14.60974,5.91838],[14.62375,5.70466],[14.58951,5.59777],[14.62531,5.51411],[14.52724,5.28319],[14.57083,5.23979],[14.65489,5.21343],[14.73383,4.6135],[15.00825,4.41458],[15.08609,4.30282],[15.10644,4.1362],[15.17482,4.05131],[15.07686,4.01805],[15.73522,3.24348],[15.77725,3.26835],[16.05449,3.02306],[16.08252,2.45708],[16.19357,2.21537],[16.50126,2.84739],[16.46701,2.92512],[16.57598,3.47999],[16.68283,3.54257],[17.01746,3.55136],[17.35649,3.63045],[17.46876,3.70515],[17.60966,3.63705],[17.83421,3.61068],[17.85842,3.53378],[18.05656,3.56893],[18.14902,3.54476],[18.17323,3.47665],[18.24148,3.50302],[18.2723,3.57992],[18.39558,3.58212],[18.49245,3.63924],[18.58711,3.49423],[18.62755,3.47564],[20.60184,4.42394],[20.90383,4.44877],[21.08793,4.39603],[21.11214,4.33895],[21.21341,4.29285],[21.25744,4.33676],[21.55904,4.25553],[21.6405,4.317],[22.10721,4.20723],[22.27682,4.11347],[22.45504,4.13039],[22.5431,4.22041],[22.60915,4.48821],[22.6928,4.47285],[22.78526,4.71423],[22.84691,4.69887],[22.89094,4.79321],[22.94817,4.82392],[23.38847,4.60013],[24.46719,5.0915],[24.71816,4.90509],[25.31256,5.03668],[25.34558,5.29101],[25.53271,5.37431],[25.86073,5.19455],[26.13371,5.25594],[26.48595,5.04984],[26.74572,5.10685],[26.85579,5.03887],[26.93064,5.13535],[27.09575,5.22305],[27.44012,5.07349],[27.26886,5.25876],[27.23017,5.37167],[27.28621,5.56382],[27.22705,5.62889],[27.22705,5.71254],[26.51721,6.09655],[26.58259,6.1987],[26.32729,6.36272],[26.38022,6.63493],[25.90076,7.09549],[25.37461,7.33024],[25.35281,7.42595],[25.20337,7.50312],[25.20649,7.61115],[25.29214,7.66675],[25.25319,7.8487],[24.98855,7.96588],[24.85156,8.16933],[24.35965,8.26177],[24.13238,8.36959],[24.25691,8.69288],[23.51905,8.71749],[23.59065,8.99743],[23.44744,8.99128],[23.4848,9.16959],[23.56263,9.19418],[23.64358,9.28637],[23.64981,9.44303],[23.62179,9.53823],[23.69155,9.67566],[23.67164,9.86923],[23.3128,10.45214],[23.02221,10.69235],[22.87758,10.91915]]]]}},{type:"Feature",properties:{iso1A2:"CG",iso1A3:"COG",iso1N3:"178",wikidata:"Q971",nameEn:"Republic of the Congo",groups:["017","202","002","UN"],callingCodes:["242"]},geometry:{type:"MultiPolygon",coordinates:[[[[18.62755,3.47564],[18.58711,3.49423],[18.49245,3.63924],[18.39558,3.58212],[18.2723,3.57992],[18.24148,3.50302],[18.17323,3.47665],[18.14902,3.54476],[18.05656,3.56893],[17.85842,3.53378],[17.83421,3.61068],[17.60966,3.63705],[17.46876,3.70515],[17.35649,3.63045],[17.01746,3.55136],[16.68283,3.54257],[16.57598,3.47999],[16.46701,2.92512],[16.50126,2.84739],[16.19357,2.21537],[16.15568,2.18955],[16.08563,2.19733],[16.05294,1.9811],[16.14634,1.70259],[16.02647,1.65591],[16.02959,1.76483],[15.48942,1.98265],[15.34776,1.91264],[15.22634,2.03243],[15.00996,1.98887],[14.61145,2.17866],[13.29457,2.16106],[13.13461,1.57238],[13.25447,1.32339],[13.15519,1.23368],[13.89582,1.4261],[14.25186,1.39842],[14.48179,.9152],[14.26066,.57255],[14.10909,.58563],[13.88648,.26652],[13.90632,-.2287],[14.06862,-.20826],[14.2165,-.38261],[14.41887,-.44799],[14.52569,-.57818],[14.41838,-1.89412],[14.25932,-1.97624],[14.23518,-2.15671],[14.16202,-2.23916],[14.23829,-2.33715],[14.10442,-2.49268],[13.85846,-2.46935],[13.92073,-2.35581],[13.75884,-2.09293],[13.47977,-2.43224],[13.02759,-2.33098],[12.82172,-1.91091],[12.61312,-1.8129],[12.44656,-1.92025],[12.47925,-2.32626],[12.04895,-2.41704],[11.96866,-2.33559],[11.74605,-2.39936],[11.57637,-2.33379],[11.64487,-2.61865],[11.5359,-2.85654],[11.64798,-2.81146],[11.80365,-3.00424],[11.70558,-3.0773],[11.70227,-3.17465],[11.96554,-3.30267],[11.8318,-3.5812],[11.92719,-3.62768],[11.87083,-3.71571],[11.68608,-3.68942],[11.57949,-3.52798],[11.48764,-3.51089],[11.22301,-3.69888],[11.12647,-3.94169],[10.75913,-4.39519],[11.50888,-5.33417],[12.00924,-5.02627],[12.16068,-4.90089],[12.20901,-4.75642],[12.25587,-4.79437],[12.32324,-4.78415],[12.40964,-4.60609],[12.64835,-4.55937],[12.76844,-4.38709],[12.87096,-4.40315],[12.91489,-4.47907],[13.09648,-4.63739],[13.11182,-4.5942],[13.41764,-4.89897],[13.50305,-4.77818],[13.70417,-4.72601],[13.71794,-4.44864],[13.81162,-4.41842],[13.9108,-4.50906],[14.40672,-4.28381],[14.3957,-4.36623],[14.47284,-4.42941],[14.37366,-4.56125],[14.41499,-4.8825],[14.5059,-4.84956],[14.67948,-4.92093],[14.83101,-4.80838],[15.1978,-4.32388],[15.25411,-4.31121],[15.32693,-4.27282],[15.41785,-4.28381],[15.48121,-4.22062],[15.53081,-4.042],[15.89448,-3.9513],[16.21407,-3.2969],[16.1755,-3.25014],[16.22785,-2.59528],[16.16173,-2.16586],[16.50336,-1.8795],[16.70724,-1.45815],[16.97999,-1.12762],[17.32438,-.99265],[17.72112,-.52707],[17.66051,-.26535],[17.81204,.23884],[17.93877,.32424],[17.95255,.48128],[17.86989,.58873],[17.85887,1.04327],[18.08034,1.58553],[18.10683,2.26876],[18.63857,3.19342],[18.62755,3.47564]]]]}},{type:"Feature",geometry:{type:"MultiPolygon",coordinates:[[[[8.72809,47.69282],[8.72617,47.69651],[8.73671,47.7169],[8.70543,47.73121],[8.74251,47.75168],[8.71778,47.76571],[8.68985,47.75686],[8.68022,47.78599],[8.65292,47.80066],[8.64425,47.76398],[8.62408,47.7626],[8.61657,47.79998],[8.56415,47.80633],[8.56814,47.78001],[8.48868,47.77215],[8.45771,47.7493],[8.44807,47.72426],[8.40569,47.69855],[8.4211,47.68407],[8.40473,47.67499],[8.41346,47.66676],[8.42264,47.66667],[8.44711,47.65379],[8.4667,47.65747],[8.46605,47.64103],[8.49656,47.64709],[8.5322,47.64687],[8.52801,47.66059],[8.56141,47.67088],[8.57683,47.66158],[8.6052,47.67258],[8.61113,47.66332],[8.62884,47.65098],[8.62049,47.63757],[8.60412,47.63735],[8.61471,47.64514],[8.60701,47.65271],[8.59545,47.64298],[8.60348,47.61204],[8.57586,47.59537],[8.55756,47.62394],[8.51686,47.63476],[8.50747,47.61897],[8.45578,47.60121],[8.46637,47.58389],[8.48949,47.588],[8.49431,47.58107],[8.43235,47.56617],[8.39477,47.57826],[8.38273,47.56608],[8.35512,47.57014],[8.32735,47.57133],[8.30277,47.58607],[8.29524,47.5919],[8.29722,47.60603],[8.2824,47.61225],[8.26313,47.6103],[8.25863,47.61571],[8.23809,47.61204],[8.22577,47.60385],[8.22011,47.6181],[8.20617,47.62141],[8.19378,47.61636],[8.1652,47.5945],[8.14947,47.59558],[8.13823,47.59147],[8.13662,47.58432],[8.11543,47.5841],[8.10395,47.57918],[8.10002,47.56504],[8.08557,47.55768],[8.06663,47.56374],[8.04383,47.55443],[8.02136,47.55096],[8.00113,47.55616],[7.97581,47.55493],[7.95682,47.55789],[7.94494,47.54511],[7.91251,47.55031],[7.90673,47.57674],[7.88664,47.58854],[7.84412,47.5841],[7.81901,47.58798],[7.79486,47.55691],[7.75261,47.54599],[7.71961,47.54219],[7.69642,47.53297],[7.68101,47.53232],[7.6656,47.53752],[7.66174,47.54554],[7.65083,47.54662],[7.63338,47.56256],[7.67655,47.56435],[7.68904,47.57133],[7.67115,47.5871],[7.68486,47.59601],[7.69385,47.60099],[7.68229,47.59905],[7.67395,47.59212],[7.64599,47.59695],[7.64213,47.5944],[7.64309,47.59151],[7.61929,47.57683],[7.60459,47.57869],[7.60523,47.58519],[7.58945,47.59017],[7.58386,47.57536],[7.56684,47.57785],[7.56548,47.57617],[7.55689,47.57232],[7.55652,47.56779],[7.53634,47.55553],[7.52831,47.55347],[7.51723,47.54578],[7.50873,47.54546],[7.49691,47.53821],[7.50588,47.52856],[7.51904,47.53515],[7.53199,47.5284],[7.5229,47.51644],[7.49804,47.51798],[7.51076,47.49651],[7.47534,47.47932],[7.43356,47.49712],[7.42923,47.48628],[7.4583,47.47216],[7.4462,47.46264],[7.43088,47.45846],[7.40308,47.43638],[7.35603,47.43432],[7.33526,47.44186],[7.24669,47.4205],[7.17026,47.44312],[7.19583,47.49455],[7.16249,47.49025],[7.12781,47.50371],[7.07425,47.48863],[7.0231,47.50522],[6.98425,47.49432],[7.0024,47.45264],[6.93953,47.43388],[6.93744,47.40714],[6.88542,47.37262],[6.87959,47.35335],[7.03125,47.36996],[7.0564,47.35134],[7.05305,47.33304],[6.94316,47.28747],[6.95108,47.26428],[6.9508,47.24338],[6.8489,47.15933],[6.76788,47.1208],[6.68823,47.06616],[6.71531,47.0494],[6.43341,46.92703],[6.46456,46.88865],[6.43216,46.80336],[6.45209,46.77502],[6.38351,46.73171],[6.27135,46.68251],[6.11084,46.57649],[6.1567,46.54402],[6.07269,46.46244],[6.08427,46.44305],[6.06407,46.41676],[6.09926,46.40768],[6.15016,46.3778],[6.15985,46.37721],[6.16987,46.36759],[6.15738,46.3491],[6.13876,46.33844],[6.1198,46.31157],[6.11697,46.29547],[6.1013,46.28512],[6.11926,46.2634],[6.12446,46.25059],[6.10071,46.23772],[6.08563,46.24651],[6.07072,46.24085],[6.0633,46.24583],[6.05029,46.23518],[6.04602,46.23127],[6.03342,46.2383],[6.02461,46.23313],[5.97542,46.21525],[5.96515,46.19638],[5.99573,46.18587],[5.98846,46.17046],[5.98188,46.17392],[5.97508,46.15863],[5.9641,46.14412],[5.95781,46.12925],[5.97893,46.13303],[5.9871,46.14499],[6.01791,46.14228],[6.03614,46.13712],[6.04564,46.14031],[6.05203,46.15191],[6.07491,46.14879],[6.09199,46.15191],[6.09926,46.14373],[6.13397,46.1406],[6.15305,46.15194],[6.18116,46.16187],[6.18871,46.16644],[6.18707,46.17999],[6.19552,46.18401],[6.19807,46.18369],[6.20539,46.19163],[6.21114,46.1927],[6.21273,46.19409],[6.21603,46.19507],[6.21844,46.19837],[6.22222,46.19888],[6.22175,46.20045],[6.23544,46.20714],[6.23913,46.20511],[6.24821,46.20531],[6.26007,46.21165],[6.27694,46.21566],[6.29663,46.22688],[6.31041,46.24417],[6.29474,46.26221],[6.26749,46.24745],[6.24952,46.26255],[6.23775,46.27822],[6.25137,46.29014],[6.24826,46.30175],[6.21981,46.31304],[6.25432,46.3632],[6.53358,46.45431],[6.82312,46.42661],[6.8024,46.39171],[6.77152,46.34784],[6.86052,46.28512],[6.78968,46.14058],[6.89321,46.12548],[6.87868,46.03855],[6.93862,46.06502],[7.00946,45.9944],[7.04151,45.92435],[7.10685,45.85653],[7.56343,45.97421],[7.85949,45.91485],[7.9049,45.99945],[7.98881,45.99867],[8.02906,46.10331],[8.11383,46.11577],[8.16866,46.17817],[8.08814,46.26692],[8.31162,46.38044],[8.30648,46.41587],[8.42464,46.46367],[8.46317,46.43712],[8.45032,46.26869],[8.62242,46.12112],[8.75697,46.10395],[8.80778,46.10085],[8.85617,46.0748],[8.79414,46.00913],[8.78585,45.98973],[8.79362,45.99207],[8.8319,45.9879],[8.85121,45.97239],[8.86688,45.96135],[8.88904,45.95465],[8.93649,45.86775],[8.94372,45.86587],[8.93504,45.86245],[8.91129,45.8388],[8.94737,45.84285],[8.9621,45.83707],[8.99663,45.83466],[9.00324,45.82055],[9.0298,45.82127],[9.03279,45.82865],[9.03793,45.83548],[9.03505,45.83976],[9.04059,45.8464],[9.04546,45.84968],[9.06642,45.8761],[9.09065,45.89906],[8.99257,45.9698],[9.01618,46.04928],[9.24503,46.23616],[9.29226,46.32717],[9.25502,46.43743],[9.28136,46.49685],[9.36128,46.5081],[9.40487,46.46621],[9.45936,46.50873],[9.46117,46.37481],[9.57015,46.2958],[9.71273,46.29266],[9.73086,46.35071],[9.95249,46.38045],[10.07055,46.21668],[10.14439,46.22992],[10.17862,46.25626],[10.10506,46.3372],[10.165,46.41051],[10.03715,46.44479],[10.10307,46.61003],[10.23674,46.63484],[10.25309,46.57432],[10.46136,46.53164],[10.49375,46.62049],[10.44686,46.64162],[10.40475,46.63671],[10.38659,46.67847],[10.47197,46.85698],[10.48376,46.93891],[10.36933,47.00212],[10.30031,46.92093],[10.24128,46.93147],[10.22675,46.86942],[10.10715,46.84296],[9.98058,46.91434],[9.88266,46.93343],[9.87935,47.01337],[9.60717,47.06091],[9.55721,47.04762],[9.54041,47.06495],[9.47548,47.05257],[9.47139,47.06402],[9.51362,47.08505],[9.52089,47.10019],[9.51044,47.13727],[9.48774,47.17402],[9.4891,47.19346],[9.50318,47.22153],[9.52406,47.24959],[9.53116,47.27029],[9.54773,47.2809],[9.55857,47.29919],[9.58513,47.31334],[9.59978,47.34671],[9.62476,47.36639],[9.65427,47.36824],[9.66243,47.37136],[9.6711,47.37824],[9.67445,47.38429],[9.67334,47.39191],[9.6629,47.39591],[9.65136,47.40504],[9.65043,47.41937],[9.6446,47.43233],[9.64483,47.43842],[9.65863,47.44847],[9.65728,47.45383],[9.6423,47.45599],[9.62475,47.45685],[9.62158,47.45858],[9.60841,47.47178],[9.60484,47.46358],[9.60205,47.46165],[9.59482,47.46305],[9.58208,47.48344],[9.56312,47.49495],[9.55125,47.53629],[9.25619,47.65939],[9.18203,47.65598],[9.17593,47.65399],[9.1755,47.65584],[9.1705,47.65513],[9.15181,47.66904],[9.13845,47.66389],[9.09891,47.67801],[9.02093,47.6868],[8.94093,47.65596],[8.89946,47.64769],[8.87625,47.65441],[8.87383,47.67045],[8.85065,47.68209],[8.86989,47.70504],[8.82002,47.71458],[8.80663,47.73821],[8.77309,47.72059],[8.76965,47.7075],[8.79966,47.70222],[8.79511,47.67462],[8.75856,47.68969],[8.72809,47.69282]],[[8.95861,45.96485],[8.96668,45.98436],[8.97741,45.98317],[8.97604,45.96151],[8.95861,45.96485]],[[8.70847,47.68904],[8.68985,47.69552],[8.66837,47.68437],[8.65769,47.68928],[8.67508,47.6979],[8.66416,47.71367],[8.70237,47.71453],[8.71773,47.69088],[8.70847,47.68904]]]]},properties:{iso1A2:"CH",iso1A3:"CHE",iso1N3:"756",wikidata:"Q39",nameEn:"Switzerland",groups:["155","150","UN"],callingCodes:["41"]}},{type:"Feature",properties:{iso1A2:"CI",iso1A3:"CIV",iso1N3:"384",wikidata:"Q1008",nameEn:"C\xF4te d'Ivoire",groups:["011","202","002","UN"],callingCodes:["225"]},geometry:{type:"MultiPolygon",coordinates:[[[[-7.52774,3.7105],[-3.34019,4.17519],[-3.10675,5.08515],[-3.11073,5.12675],[-3.063,5.13665],[-2.96554,5.10397],[-2.95261,5.12477],[-2.75502,5.10657],[-2.73074,5.1364],[-2.77625,5.34621],[-2.72737,5.34789],[-2.76614,5.60963],[-2.85378,5.65156],[-2.93132,5.62137],[-2.96671,5.6415],[-2.95323,5.71865],[-3.01896,5.71697],[-3.25999,6.62521],[-3.21954,6.74407],[-3.23327,6.81744],[-2.95438,7.23737],[-2.97822,7.27165],[-2.92339,7.60847],[-2.79467,7.86002],[-2.78395,7.94974],[-2.74819,7.92613],[-2.67787,8.02055],[-2.61232,8.02645],[-2.62901,8.11495],[-2.49037,8.20872],[-2.58243,8.7789],[-2.66357,9.01771],[-2.77799,9.04949],[-2.69814,9.22717],[-2.68802,9.49343],[-2.76494,9.40778],[-2.93012,9.57403],[-3.00765,9.74019],[-3.16609,9.85147],[-3.19306,9.93781],[-3.27228,9.84981],[-3.31779,9.91125],[-3.69703,9.94279],[-4.25999,9.76012],[-4.31392,9.60062],[-4.6426,9.70696],[-4.96621,9.89132],[-4.96453,9.99923],[-5.12465,10.29788],[-5.39602,10.2929],[-5.51058,10.43177],[-5.65135,10.46767],[-5.78124,10.43952],[-5.99478,10.19694],[-6.18851,10.24244],[-6.1731,10.46983],[-6.24795,10.74248],[-6.325,10.68624],[-6.40646,10.69922],[-6.42847,10.5694],[-6.52974,10.59104],[-6.63541,10.66893],[-6.68164,10.35074],[-6.93921,10.35291],[-7.01186,10.25111],[-6.97444,10.21644],[-7.00966,10.15794],[-7.0603,10.14711],[-7.13331,10.24877],[-7.3707,10.24677],[-7.44555,10.44602],[-7.52261,10.4655],[-7.54462,10.40921],[-7.63048,10.46334],[-7.92107,10.15577],[-7.97971,10.17117],[-8.01225,10.1021],[-8.11921,10.04577],[-8.15652,9.94288],[-8.09434,9.86936],[-8.14657,9.55062],[-8.03463,9.39604],[-7.85056,9.41812],[-7.90777,9.20456],[-7.73862,9.08422],[-7.92518,8.99332],[-7.95503,8.81146],[-7.69882,8.66148],[-7.65653,8.36873],[-7.92518,8.50652],[-8.22991,8.48438],[-8.2411,8.24196],[-8.062,8.16071],[-7.98675,8.20134],[-7.99919,8.11023],[-7.94695,8.00925],[-8.06449,8.04989],[-8.13414,7.87991],[-8.09931,7.78626],[-8.21374,7.54466],[-8.4003,7.6285],[-8.47114,7.55676],[-8.41935,7.51203],[-8.37458,7.25794],[-8.29249,7.1691],[-8.31736,6.82837],[-8.59456,6.50612],[-8.48652,6.43797],[-8.45666,6.49977],[-8.38453,6.35887],[-8.3298,6.36381],[-8.17557,6.28222],[-8.00642,6.31684],[-7.90692,6.27728],[-7.83478,6.20309],[-7.8497,6.08932],[-7.79747,6.07696],[-7.78254,5.99037],[-7.70294,5.90625],[-7.67309,5.94337],[-7.48155,5.80974],[-7.46165,5.84934],[-7.43677,5.84687],[-7.43926,5.74787],[-7.37209,5.61173],[-7.43428,5.42355],[-7.36463,5.32944],[-7.46165,5.26256],[-7.48901,5.14118],[-7.55369,5.08667],[-7.53876,4.94294],[-7.59349,4.8909],[-7.53259,4.35145],[-7.52774,3.7105]]]]}},{type:"Feature",properties:{iso1A2:"CK",iso1A3:"COK",iso1N3:"184",wikidata:"Q26988",nameEn:"Cook Islands",country:"NZ",groups:["061","009","UN"],driveSide:"left",callingCodes:["682"]},geometry:{type:"MultiPolygon",coordinates:[[[[-168.15106,-10.26955],[-156.45576,-31.75456],[-156.48634,-15.52824],[-156.50903,-7.4975],[-168.15106,-10.26955]]]]}},{type:"Feature",properties:{iso1A2:"CL",iso1A3:"CHL",iso1N3:"152",wikidata:"Q298",nameEn:"Chile",groups:["005","419","019","UN"],callingCodes:["56"]},geometry:{type:"MultiPolygon",coordinates:[[[[-68.60702,-52.65781],[-68.41683,-52.33516],[-69.97824,-52.00845],[-71.99889,-51.98018],[-72.33873,-51.59954],[-72.31343,-50.58411],[-73.15765,-50.78337],[-73.55259,-49.92488],[-73.45156,-49.79461],[-73.09655,-49.14342],[-72.56894,-48.81116],[-72.54042,-48.52392],[-72.27662,-48.28727],[-72.50478,-47.80586],[-71.94152,-47.13595],[-71.68577,-46.55385],[-71.75614,-45.61611],[-71.35687,-45.22075],[-72.06985,-44.81756],[-71.26418,-44.75684],[-71.16436,-44.46244],[-71.81318,-44.38097],[-71.64206,-43.64774],[-72.14828,-42.85321],[-72.15541,-42.15941],[-71.74901,-42.11711],[-71.92726,-40.72714],[-71.37826,-38.91474],[-70.89532,-38.6923],[-71.24279,-37.20264],[-70.95047,-36.4321],[-70.38008,-36.02375],[-70.49416,-35.24145],[-69.87386,-34.13344],[-69.88099,-33.34489],[-70.55832,-31.51559],[-70.14479,-30.36595],[-69.8596,-30.26131],[-69.99507,-29.28351],[-69.80969,-29.07185],[-69.66709,-28.44055],[-69.22504,-27.95042],[-68.77586,-27.16029],[-68.43363,-27.08414],[-68.27677,-26.90626],[-68.59048,-26.49861],[-68.56909,-26.28146],[-68.38372,-26.15353],[-68.57622,-25.32505],[-68.38372,-25.08636],[-68.56909,-24.69831],[-68.24825,-24.42596],[-67.33563,-24.04237],[-66.99632,-22.99839],[-67.18382,-22.81525],[-67.54284,-22.89771],[-67.85114,-22.87076],[-68.18816,-21.28614],[-68.40403,-20.94562],[-68.53957,-20.91542],[-68.55383,-20.7355],[-68.44023,-20.62701],[-68.7276,-20.46178],[-68.74273,-20.08817],[-68.57132,-20.03134],[-68.54611,-19.84651],[-68.66761,-19.72118],[-68.41218,-19.40499],[-68.61989,-19.27584],[-68.80602,-19.08355],[-68.87082,-19.06003],[-68.94987,-18.93302],[-69.07432,-18.28259],[-69.14807,-18.16893],[-69.07496,-18.03715],[-69.28671,-17.94844],[-69.34126,-17.72753],[-69.46623,-17.60518],[-69.46897,-17.4988],[-69.66483,-17.65083],[-69.79087,-17.65563],[-69.82868,-17.72048],[-69.75305,-17.94605],[-69.81607,-18.12582],[-69.96732,-18.25992],[-70.16394,-18.31737],[-70.31267,-18.31258],[-70.378,-18.3495],[-70.59118,-18.35072],[-113.52687,-26.52828],[-68.11646,-58.14883],[-66.07313,-55.19618],[-67.11046,-54.94199],[-67.46182,-54.92205],[-68.01394,-54.8753],[-68.60733,-54.9125],[-68.60702,-52.65781]]]]}},{type:"Feature",properties:{iso1A2:"CM",iso1A3:"CMR",iso1N3:"120",wikidata:"Q1009",nameEn:"Cameroon",groups:["017","202","002","UN"],callingCodes:["237"]},geometry:{type:"MultiPolygon",coordinates:[[[[14.83314,12.62963],[14.55058,12.78256],[14.56101,12.91036],[14.46881,13.08259],[14.08251,13.0797],[14.20204,12.53405],[14.17523,12.41916],[14.22215,12.36533],[14.4843,12.35223],[14.6474,12.17466],[14.61612,11.7798],[14.55207,11.72001],[14.64591,11.66166],[14.6124,11.51283],[14.17821,11.23831],[13.97489,11.30258],[13.78945,11.00154],[13.7403,11.00593],[13.70753,10.94451],[13.73434,10.9255],[13.54964,10.61236],[13.5705,10.53183],[13.43644,10.13326],[13.34111,10.12299],[13.25025,10.03647],[13.25323,10.00127],[13.286,9.9822],[13.27409,9.93232],[13.24132,9.91031],[13.25025,9.86042],[13.29941,9.8296],[13.25472,9.76795],[13.22642,9.57266],[13.02385,9.49334],[12.85628,9.36698],[12.91958,9.33905],[12.90022,9.11411],[12.81085,8.91992],[12.79,8.75361],[12.71701,8.7595],[12.68722,8.65938],[12.44146,8.6152],[12.4489,8.52536],[12.26123,8.43696],[12.24782,8.17904],[12.19271,8.10826],[12.20909,7.97553],[11.99908,7.67302],[12.01844,7.52981],[11.93205,7.47812],[11.84864,7.26098],[11.87396,7.09398],[11.63117,6.9905],[11.55818,6.86186],[11.57755,6.74059],[11.51499,6.60892],[11.42264,6.5882],[11.42041,6.53789],[11.09495,6.51717],[11.09644,6.68437],[10.94302,6.69325],[10.8179,6.83377],[10.83727,6.9358],[10.60789,7.06885],[10.59746,7.14719],[10.57214,7.16345],[10.53639,6.93432],[10.21466,6.88996],[10.15135,7.03781],[9.86314,6.77756],[9.77824,6.79088],[9.70674,6.51717],[9.51757,6.43874],[8.84209,5.82562],[8.88156,5.78857],[8.83687,5.68483],[8.92029,5.58403],[8.78027,5.1243],[8.60302,4.87353],[8.34397,4.30689],[9.22018,3.72052],[9.81162,2.33797],[9.82123,2.35097],[9.83754,2.32428],[9.83238,2.29079],[9.84716,2.24676],[9.89012,2.20457],[9.90749,2.20049],[9.991,2.16561],[11.3561,2.17217],[11.37116,2.29975],[13.28534,2.25716],[13.29457,2.16106],[14.61145,2.17866],[15.00996,1.98887],[15.22634,2.03243],[15.34776,1.91264],[15.48942,1.98265],[16.02959,1.76483],[16.02647,1.65591],[16.14634,1.70259],[16.05294,1.9811],[16.08563,2.19733],[16.15568,2.18955],[16.19357,2.21537],[16.08252,2.45708],[16.05449,3.02306],[15.77725,3.26835],[15.73522,3.24348],[15.07686,4.01805],[15.17482,4.05131],[15.10644,4.1362],[15.08609,4.30282],[15.00825,4.41458],[14.73383,4.6135],[14.65489,5.21343],[14.57083,5.23979],[14.52724,5.28319],[14.62531,5.51411],[14.58951,5.59777],[14.62375,5.70466],[14.60974,5.91838],[14.49455,5.91683],[14.42917,6.00508],[14.43073,6.08867],[14.56149,6.18928],[14.74206,6.26356],[14.80122,6.34866],[14.79966,6.39043],[14.96311,6.75693],[15.04717,6.77085],[15.23397,7.25135],[15.49743,7.52179],[15.56964,7.58936],[15.59272,7.7696],[15.50743,7.79302],[15.20426,8.50892],[15.09484,8.65982],[14.83566,8.80557],[14.35707,9.19611],[14.37094,9.2954],[13.97544,9.6365],[14.01793,9.73169],[14.1317,9.82413],[14.20411,10.00055],[14.4673,10.00264],[14.80082,9.93818],[14.95722,9.97926],[15.05999,9.94845],[15.14043,9.99246],[15.24618,9.99246],[15.41408,9.92876],[15.68761,9.99344],[15.50535,10.1098],[15.30874,10.31063],[15.23724,10.47764],[15.14936,10.53915],[15.15532,10.62846],[15.06737,10.80921],[15.09127,10.87431],[15.04957,11.02347],[15.10021,11.04101],[15.0585,11.40481],[15.13149,11.5537],[15.06595,11.71126],[15.11579,11.79313],[15.04808,11.8731],[15.05786,12.0608],[15.0349,12.10698],[15.00146,12.1223],[14.96952,12.0925],[14.89019,12.16593],[14.90827,12.3269],[14.83314,12.62963]]]]}},{type:"Feature",properties:{iso1A2:"CN",iso1A3:"CHN",iso1N3:"156",wikidata:"Q148",nameEn:"People's Republic of China"},geometry:null},{type:"Feature",properties:{iso1A2:"CO",iso1A3:"COL",iso1N3:"170",wikidata:"Q739",nameEn:"Colombia",groups:["005","419","019","UN"],callingCodes:["57"]},geometry:{type:"MultiPolygon",coordinates:[[[[-71.19849,12.65801],[-81.58685,18.0025],[-82.06974,14.49418],[-82.56142,11.91792],[-78.79327,9.93766],[-77.58292,9.22278],[-77.32389,8.81247],[-77.45064,8.49991],[-77.17257,7.97422],[-77.57185,7.51147],[-77.72514,7.72348],[-77.72157,7.47612],[-77.81426,7.48319],[-77.89178,7.22681],[-78.06168,7.07793],[-82.12561,4.00341],[-78.87137,1.47457],[-78.42749,1.15389],[-77.85677,.80197],[-77.7148,.85003],[-77.68613,.83029],[-77.66416,.81604],[-77.67815,.73863],[-77.49984,.64476],[-77.52001,.40782],[-76.89177,.24736],[-76.4094,.24015],[-76.41215,.38228],[-76.23441,.42294],[-75.82927,.09578],[-75.25764,-.11943],[-75.18513,-.0308],[-74.42701,-.50218],[-74.26675,-.97229],[-73.65312,-1.26222],[-72.92587,-2.44514],[-71.75223,-2.15058],[-70.94377,-2.23142],[-70.04609,-2.73906],[-70.71396,-3.7921],[-70.52393,-3.87553],[-70.3374,-3.79505],[-69.94708,-4.2431],[-69.43395,-1.42219],[-69.4215,-1.01853],[-69.59796,-.75136],[-69.603,-.51947],[-70.03658,-.19681],[-70.04162,.55437],[-69.47696,.71065],[-69.20976,.57958],[-69.14422,.84172],[-69.26017,1.06856],[-69.82987,1.07864],[-69.83491,1.69353],[-69.53746,1.76408],[-69.38621,1.70865],[-68.18128,1.72881],[-68.26699,1.83463],[-68.18632,2.00091],[-67.9292,1.82455],[-67.40488,2.22258],[-67.299,1.87494],[-67.15784,1.80439],[-67.08222,1.17441],[-66.85795,1.22998],[-67.21967,2.35778],[-67.65696,2.81691],[-67.85862,2.79173],[-67.85862,2.86727],[-67.30945,3.38393],[-67.50067,3.75812],[-67.62671,3.74303],[-67.85358,4.53249],[-67.83341,5.31104],[-67.59141,5.5369],[-67.63914,5.64963],[-67.58558,5.84537],[-67.43513,5.98835],[-67.4625,6.20625],[-67.60654,6.2891],[-69.41843,6.1072],[-70.10716,6.96516],[-70.7596,7.09799],[-71.03941,6.98163],[-71.37234,7.01588],[-71.42212,7.03854],[-71.44118,7.02116],[-71.82441,7.04314],[-72.04895,7.03837],[-72.19437,7.37034],[-72.43132,7.40034],[-72.47415,7.48928],[-72.45321,7.57232],[-72.47827,7.65604],[-72.46763,7.79518],[-72.44454,7.86031],[-72.46183,7.90682],[-72.45806,7.91141],[-72.47042,7.92306],[-72.48183,7.92909],[-72.48801,7.94329],[-72.47213,7.96106],[-72.39137,8.03534],[-72.35163,8.01163],[-72.36987,8.19976],[-72.4042,8.36513],[-72.65474,8.61428],[-72.77415,9.10165],[-72.94052,9.10663],[-73.02119,9.27584],[-73.36905,9.16636],[-72.98085,9.85253],[-72.88002,10.44309],[-72.4767,11.1117],[-72.24983,11.14138],[-71.9675,11.65536],[-71.3275,11.85],[-70.92579,11.96275],[-71.19849,12.65801]]]]}},{type:"Feature",properties:{iso1A2:"CP",iso1A3:"CPT",wikidata:"Q161258",nameEn:"Clipperton Island",country:"FR",groups:["EU","013","003","019","UN"],isoStatus:"excRes"},geometry:{type:"MultiPolygon",coordinates:[[[[-110.36279,9.79626],[-108.755,9.84085],[-109.04145,11.13245],[-110.36279,9.79626]]]]}},{type:"Feature",properties:{iso1A2:"CR",iso1A3:"CRI",iso1N3:"188",wikidata:"Q800",nameEn:"Costa Rica",groups:["013","003","419","019","UN"],callingCodes:["506"]},geometry:{type:"MultiPolygon",coordinates:[[[[-83.68276,11.01562],[-83.66597,10.79916],[-83.90838,10.71161],[-84.68197,11.07568],[-84.92439,10.9497],[-85.60529,11.22607],[-85.71223,11.06868],[-86.14524,11.09059],[-87.41779,5.02401],[-82.94503,7.93865],[-82.89978,8.04083],[-82.89137,8.05755],[-82.88641,8.10219],[-82.9388,8.26634],[-83.05209,8.33394],[-82.93056,8.43465],[-82.8679,8.44042],[-82.8382,8.48117],[-82.83322,8.52464],[-82.83975,8.54755],[-82.82739,8.60153],[-82.8794,8.6981],[-82.92068,8.74832],[-82.91377,8.774],[-82.88253,8.83331],[-82.72126,8.97125],[-82.93516,9.07687],[-82.93516,9.46741],[-82.84871,9.4973],[-82.87919,9.62645],[-82.77206,9.59573],[-82.66667,9.49746],[-82.61345,9.49881],[-82.56507,9.57279],[-82.51044,9.65379],[-83.54024,10.96805],[-83.68276,11.01562]]]]}},{type:"Feature",properties:{iso1A2:"CU",iso1A3:"CUB",iso1N3:"192",wikidata:"Q241",nameEn:"Cuba",groups:["029","003","419","019","UN"],callingCodes:["53"]},geometry:{type:"MultiPolygon",coordinates:[[[[-73.62304,20.6935],[-82.02215,24.23074],[-85.77883,21.92705],[-74.81171,18.82201],[-73.62304,20.6935]]]]}},{type:"Feature",properties:{iso1A2:"CV",iso1A3:"CPV",iso1N3:"132",wikidata:"Q1011",nameEn:"Cape Verde",groups:["Q105472","011","202","002","UN"],callingCodes:["238"]},geometry:{type:"MultiPolygon",coordinates:[[[[-28.81604,14.57305],[-20.39702,14.12816],[-23.37101,19.134],[-28.81604,14.57305]]]]}},{type:"Feature",properties:{iso1A2:"CW",iso1A3:"CUW",iso1N3:"531",wikidata:"Q25279",nameEn:"Cura\xE7ao",aliases:["NL-CW"],country:"NL",groups:["Q1451600","029","003","419","019","UN"],callingCodes:["599"]},geometry:{type:"MultiPolygon",coordinates:[[[[-68.90012,12.62309],[-69.59009,12.46019],[-68.99639,11.79035],[-68.33524,11.78151],[-68.90012,12.62309]]]]}},{type:"Feature",properties:{iso1A2:"CX",iso1A3:"CXR",iso1N3:"162",wikidata:"Q31063",nameEn:"Christmas Island",country:"AU",groups:["053","009","UN"],driveSide:"left",callingCodes:["61"]},geometry:{type:"MultiPolygon",coordinates:[[[[105.66835,-9.31927],[104.67494,-11.2566],[106.66176,-11.14349],[105.66835,-9.31927]]]]}},{type:"Feature",properties:{iso1A2:"CY",iso1A3:"CYP",iso1N3:"196",wikidata:"Q229",nameEn:"Republic of Cyprus",groups:["Q644636","EU","145","142","UN"],driveSide:"left",callingCodes:["357"]},geometry:{type:"MultiPolygon",coordinates:[[[[32.46489,35.48584],[30.15137,34.08517],[32.74412,34.43926],[32.75515,34.64985],[32.76136,34.68318],[32.79433,34.67883],[32.82717,34.70622],[32.86014,34.70585],[32.86167,34.68734],[32.9068,34.66102],[32.91398,34.67343],[32.93043,34.67091],[32.92807,34.66736],[32.93449,34.66241],[32.93693,34.67027],[32.94379,34.67111],[32.94683,34.67907],[32.95539,34.68471],[32.99135,34.68061],[32.98668,34.67268],[32.99014,34.65518],[32.97736,34.65277],[32.97079,34.66112],[32.95325,34.66462],[32.94796,34.6587],[32.94976,34.65204],[32.95471,34.64528],[32.95323,34.64075],[32.95891,34.62919],[32.96718,34.63446],[32.96968,34.64046],[33.0138,34.64424],[33.26744,34.49942],[33.83531,34.73974],[33.70575,34.97947],[33.70639,34.99303],[33.71514,35.00294],[33.69731,35.01754],[33.69938,35.03123],[33.67678,35.03866],[33.63765,35.03869],[33.61215,35.0527],[33.59658,35.03635],[33.567,35.04803],[33.57478,35.06049],[33.53975,35.08151],[33.48915,35.06594],[33.47666,35.00701],[33.45256,35.00288],[33.45178,35.02078],[33.47825,35.04103],[33.48136,35.0636],[33.46813,35.10564],[33.41675,35.16325],[33.4076,35.20062],[33.38575,35.2018],[33.37248,35.18698],[33.3717,35.1788],[33.36569,35.17479],[33.35612,35.17402],[33.35596,35.17942],[33.34964,35.17803],[33.35056,35.18328],[33.31955,35.18096],[33.3072,35.16816],[33.27068,35.16815],[33.15138,35.19504],[33.11105,35.15639],[33.08249,35.17319],[33.01192,35.15639],[32.94471,35.09422],[32.86406,35.1043],[32.85733,35.07742],[32.70779,35.14127],[32.70947,35.18328],[32.64864,35.19967],[32.60361,35.16647],[32.46489,35.48584]]],[[[33.74144,35.01053],[33.7492,35.01319],[33.74983,35.02274],[33.74265,35.02329],[33.73781,35.02181],[33.7343,35.01178],[33.74144,35.01053]]],[[[33.77312,34.9976],[33.75994,35.00113],[33.75682,34.99916],[33.76605,34.99543],[33.76738,34.99188],[33.7778,34.98981],[33.77843,34.988],[33.78149,34.98854],[33.78318,34.98699],[33.78571,34.98951],[33.78917,34.98854],[33.79191,34.98914],[33.78516,34.99582],[33.77553,34.99518],[33.77312,34.9976]]]]}},{type:"Feature",properties:{iso1A2:"CZ",iso1A3:"CZE",iso1N3:"203",wikidata:"Q213",nameEn:"Czechia",groups:["EU","151","150","UN"],callingCodes:["420"]},geometry:{type:"MultiPolygon",coordinates:[[[[14.82803,50.86966],[14.79139,50.81438],[14.70661,50.84096],[14.61993,50.86049],[14.63434,50.8883],[14.65259,50.90513],[14.64802,50.93241],[14.58024,50.91443],[14.56374,50.922],[14.59702,50.96148],[14.59908,50.98685],[14.58215,50.99306],[14.56432,51.01008],[14.53438,51.00374],[14.53321,51.01679],[14.49873,51.02242],[14.50809,51.0427],[14.49991,51.04692],[14.49154,51.04382],[14.49202,51.02286],[14.45827,51.03712],[14.41335,51.02086],[14.30098,51.05515],[14.25665,50.98935],[14.28776,50.97718],[14.32353,50.98556],[14.32793,50.97379],[14.30251,50.96606],[14.31422,50.95243],[14.39848,50.93866],[14.38691,50.89907],[14.30098,50.88448],[14.27123,50.89386],[14.24314,50.88761],[14.22331,50.86049],[14.02982,50.80662],[13.98864,50.8177],[13.89113,50.78533],[13.89444,50.74142],[13.82942,50.7251],[13.76316,50.73487],[13.70204,50.71771],[13.65977,50.73096],[13.52474,50.70394],[13.53748,50.67654],[13.5226,50.64721],[13.49742,50.63133],[13.46413,50.60102],[13.42189,50.61243],[13.37485,50.64931],[13.37805,50.627],[13.32264,50.60317],[13.32594,50.58009],[13.29454,50.57904],[13.25158,50.59268],[13.19043,50.50237],[13.13424,50.51709],[13.08301,50.50132],[13.0312,50.50944],[13.02038,50.4734],[13.02147,50.44763],[12.98433,50.42016],[12.94058,50.40944],[12.82465,50.45738],[12.73476,50.43237],[12.73044,50.42268],[12.70731,50.39948],[12.67261,50.41949],[12.51356,50.39694],[12.48747,50.37278],[12.49214,50.35228],[12.48256,50.34784],[12.46643,50.35527],[12.43722,50.33774],[12.43371,50.32506],[12.39924,50.32302],[12.40158,50.29521],[12.36594,50.28289],[12.35425,50.23993],[12.33263,50.24367],[12.32445,50.20442],[12.33847,50.19432],[12.32596,50.17146],[12.29232,50.17524],[12.28063,50.19544],[12.28755,50.22429],[12.23943,50.24594],[12.24791,50.25525],[12.26953,50.25189],[12.25119,50.27079],[12.20823,50.2729],[12.18013,50.32146],[12.10907,50.32041],[12.13716,50.27396],[12.09287,50.25032],[12.19335,50.19997],[12.21484,50.16399],[12.1917,50.13434],[12.2073,50.10315],[12.23709,50.10213],[12.27433,50.0771],[12.26111,50.06331],[12.30798,50.05719],[12.49908,49.97305],[12.47264,49.94222],[12.55197,49.92094],[12.48256,49.83575],[12.46603,49.78882],[12.40489,49.76321],[12.4462,49.70233],[12.52553,49.68415],[12.53544,49.61888],[12.56188,49.6146],[12.60155,49.52887],[12.64782,49.52565],[12.64121,49.47628],[12.669,49.42935],[12.71227,49.42363],[12.75854,49.3989],[12.78168,49.34618],[12.88414,49.33541],[12.88249,49.35479],[12.94859,49.34079],[13.03618,49.30417],[13.02957,49.27399],[13.05883,49.26259],[13.17665,49.16713],[13.17019,49.14339],[13.20405,49.12303],[13.23689,49.11412],[13.28242,49.1228],[13.39479,49.04812],[13.40802,48.98851],[13.50221,48.93752],[13.50552,48.97441],[13.58319,48.96899],[13.61624,48.9462],[13.67739,48.87886],[13.73854,48.88538],[13.76994,48.83537],[13.78977,48.83319],[13.8096,48.77877],[13.84023,48.76988],[14.06151,48.66873],[14.01482,48.63788],[14.09104,48.5943],[14.20691,48.5898],[14.33909,48.55852],[14.43076,48.58855],[14.4587,48.64695],[14.56139,48.60429],[14.60808,48.62881],[14.66762,48.58215],[14.71794,48.59794],[14.72756,48.69502],[14.80584,48.73489],[14.80821,48.77711],[14.81545,48.7874],[14.94773,48.76268],[14.95641,48.75915],[14.9758,48.76857],[14.98112,48.77524],[14.9782,48.7766],[14.98032,48.77959],[14.95072,48.79101],[14.98917,48.90082],[14.97612,48.96983],[14.99878,49.01444],[15.15534,48.99056],[15.16358,48.94278],[15.26177,48.95766],[15.28305,48.98831],[15.34823,48.98444],[15.48027,48.94481],[15.51357,48.91549],[15.61622,48.89541],[15.6921,48.85973],[15.75341,48.8516],[15.78087,48.87644],[15.84404,48.86921],[16.06034,48.75436],[16.37345,48.729],[16.40915,48.74576],[16.46134,48.80865],[16.67008,48.77699],[16.68518,48.7281],[16.71883,48.73806],[16.79779,48.70998],[16.90354,48.71541],[16.93955,48.60371],[17.00215,48.70887],[17.11202,48.82925],[17.19355,48.87602],[17.29054,48.85546],[17.3853,48.80936],[17.45671,48.85004],[17.5295,48.81117],[17.7094,48.86721],[17.73126,48.87885],[17.77944,48.92318],[17.87831,48.92679],[17.91814,49.01784],[18.06885,49.03157],[18.1104,49.08624],[18.15022,49.24518],[18.18456,49.28909],[18.36446,49.3267],[18.4139,49.36517],[18.4084,49.40003],[18.44686,49.39467],[18.54848,49.47059],[18.53063,49.49022],[18.57183,49.51162],[18.6144,49.49824],[18.67757,49.50895],[18.74761,49.492],[18.84521,49.51672],[18.84786,49.5446],[18.80479,49.6815],[18.72838,49.68163],[18.69817,49.70473],[18.62676,49.71983],[18.62943,49.74603],[18.62645,49.75002],[18.61368,49.75426],[18.61278,49.7618],[18.57183,49.83334],[18.60341,49.86256],[18.57045,49.87849],[18.57697,49.91565],[18.54299,49.92537],[18.54495,49.9079],[18.53423,49.89906],[18.41604,49.93498],[18.33562,49.94747],[18.33278,49.92415],[18.31914,49.91565],[18.27794,49.93863],[18.27107,49.96779],[18.21752,49.97309],[18.20241,49.99958],[18.10628,50.00223],[18.07898,50.04535],[18.03212,50.06574],[18.00396,50.04954],[18.04585,50.03311],[18.04585,50.01194],[18.00191,50.01723],[17.86886,49.97452],[17.77669,50.02253],[17.7506,50.07896],[17.6888,50.12037],[17.66683,50.10275],[17.59404,50.16437],[17.70528,50.18812],[17.76296,50.23382],[17.72176,50.25665],[17.74648,50.29966],[17.69292,50.32859],[17.67764,50.28977],[17.58889,50.27837],[17.3702,50.28123],[17.34548,50.2628],[17.34273,50.32947],[17.27681,50.32246],[17.19991,50.3654],[17.19579,50.38817],[17.14498,50.38117],[17.1224,50.39494],[16.89229,50.45117],[16.85933,50.41093],[16.90877,50.38642],[16.94448,50.31281],[16.99803,50.30316],[17.02138,50.27772],[16.99803,50.25753],[17.02825,50.23118],[17.00353,50.21449],[16.98018,50.24172],[16.8456,50.20834],[16.7014,50.09659],[16.63137,50.1142],[16.55446,50.16613],[16.56407,50.21009],[16.42674,50.32509],[16.39379,50.3207],[16.3622,50.34875],[16.36495,50.37679],[16.30289,50.38292],[16.28118,50.36891],[16.22821,50.41054],[16.21585,50.40627],[16.19526,50.43291],[16.31413,50.50274],[16.34572,50.49575],[16.44597,50.58041],[16.33611,50.66579],[16.23174,50.67101],[16.20839,50.63096],[16.10265,50.66405],[16.02437,50.60046],[15.98317,50.61528],[16.0175,50.63009],[15.97219,50.69799],[15.87331,50.67188],[15.81683,50.75666],[15.73186,50.73885],[15.43798,50.80833],[15.3803,50.77187],[15.36656,50.83956],[15.2773,50.8907],[15.27043,50.97724],[15.2361,50.99886],[15.1743,50.9833],[15.16744,51.01959],[15.11937,50.99021],[15.10152,51.01095],[15.06218,51.02269],[15.03895,51.0123],[15.02433,51.0242],[14.96419,50.99108],[15.01088,50.97984],[14.99852,50.86817],[14.82803,50.86966]]]]}},{type:"Feature",properties:{iso1A2:"DE",iso1A3:"DEU",iso1N3:"276",wikidata:"Q183",nameEn:"Germany",groups:["EU","155","150","UN"],callingCodes:["49"]},geometry:{type:"MultiPolygon",coordinates:[[[[8.70847,47.68904],[8.71773,47.69088],[8.70237,47.71453],[8.66416,47.71367],[8.67508,47.6979],[8.65769,47.68928],[8.66837,47.68437],[8.68985,47.69552],[8.70847,47.68904]]],[[[8.72617,47.69651],[8.72809,47.69282],[8.75856,47.68969],[8.79511,47.67462],[8.79966,47.70222],[8.76965,47.7075],[8.77309,47.72059],[8.80663,47.73821],[8.82002,47.71458],[8.86989,47.70504],[8.85065,47.68209],[8.87383,47.67045],[8.87625,47.65441],[8.89946,47.64769],[8.94093,47.65596],[9.02093,47.6868],[9.09891,47.67801],[9.13845,47.66389],[9.15181,47.66904],[9.1705,47.65513],[9.1755,47.65584],[9.17593,47.65399],[9.18203,47.65598],[9.25619,47.65939],[9.55125,47.53629],[9.72736,47.53457],[9.76748,47.5934],[9.80254,47.59419],[9.82591,47.58158],[9.8189,47.54688],[9.87499,47.52953],[9.87733,47.54688],[9.92407,47.53111],[9.96029,47.53899],[10.00003,47.48216],[10.03859,47.48927],[10.07131,47.45531],[10.09001,47.46005],[10.1052,47.4316],[10.06897,47.40709],[10.09819,47.35724],[10.11805,47.37228],[10.16362,47.36674],[10.17648,47.38889],[10.2127,47.38019],[10.22774,47.38904],[10.23757,47.37609],[10.19998,47.32832],[10.2147,47.31014],[10.17648,47.29149],[10.17531,47.27167],[10.23257,47.27088],[10.33424,47.30813],[10.39851,47.37623],[10.4324,47.38494],[10.4359,47.41183],[10.47446,47.43318],[10.46278,47.47901],[10.44291,47.48453],[10.4324,47.50111],[10.44992,47.5524],[10.43473,47.58394],[10.47329,47.58552],[10.48849,47.54057],[10.56912,47.53584],[10.60337,47.56755],[10.63456,47.5591],[10.68832,47.55752],[10.6965,47.54253],[10.7596,47.53228],[10.77596,47.51729],[10.88814,47.53701],[10.91268,47.51334],[10.86945,47.5015],[10.87061,47.4786],[10.90918,47.48571],[10.93839,47.48018],[10.92437,47.46991],[10.98513,47.42882],[10.97111,47.41617],[10.97111,47.39561],[11.11835,47.39719],[11.12536,47.41222],[11.20482,47.43198],[11.25157,47.43277],[11.22002,47.3964],[11.27844,47.39956],[11.29597,47.42566],[11.33804,47.44937],[11.4175,47.44621],[11.38128,47.47465],[11.4362,47.51413],[11.52618,47.50939],[11.58578,47.52281],[11.58811,47.55515],[11.60681,47.57881],[11.63934,47.59202],[11.84052,47.58354],[11.85572,47.60166],[12.0088,47.62451],[12.02282,47.61033],[12.05788,47.61742],[12.13734,47.60639],[12.17824,47.61506],[12.18145,47.61019],[12.17737,47.60121],[12.18568,47.6049],[12.20398,47.60667],[12.20801,47.61082],[12.19895,47.64085],[12.18507,47.65984],[12.18347,47.66663],[12.16769,47.68167],[12.16217,47.70105],[12.18303,47.70065],[12.22571,47.71776],[12.2542,47.7433],[12.26238,47.73544],[12.24017,47.69534],[12.26004,47.67725],[12.27991,47.68827],[12.336,47.69534],[12.37222,47.68433],[12.43883,47.6977],[12.44117,47.6741],[12.50076,47.62293],[12.53816,47.63553],[12.57438,47.63238],[12.6071,47.6741],[12.7357,47.6787],[12.77777,47.66689],[12.76492,47.64485],[12.82101,47.61493],[12.77427,47.58025],[12.80699,47.54477],[12.84672,47.54556],[12.85256,47.52741],[12.9624,47.47452],[12.98344,47.48716],[12.9998,47.46267],[13.04537,47.49426],[13.03252,47.53373],[13.05355,47.56291],[13.04537,47.58183],[13.06641,47.58577],[13.06407,47.60075],[13.09562,47.63304],[13.07692,47.68814],[13.01382,47.72116],[12.98578,47.7078],[12.92969,47.71094],[12.91333,47.7178],[12.90274,47.72513],[12.91711,47.74026],[12.9353,47.74788],[12.94371,47.76281],[12.93202,47.77302],[12.96311,47.79957],[12.98543,47.82896],[13.00588,47.84374],[12.94163,47.92927],[12.93886,47.94046],[12.93642,47.94436],[12.93419,47.94063],[12.92668,47.93879],[12.91985,47.94069],[12.9211,47.95135],[12.91683,47.95647],[12.87476,47.96195],[12.8549,48.01122],[12.76141,48.07373],[12.74973,48.10885],[12.7617,48.12796],[12.78595,48.12445],[12.80676,48.14979],[12.82673,48.15245],[12.8362,48.15876],[12.836,48.1647],[12.84475,48.16556],[12.87126,48.20318],[12.95306,48.20629],[13.02083,48.25689],[13.0851,48.27711],[13.126,48.27867],[13.18093,48.29577],[13.26039,48.29422],[13.30897,48.31575],[13.40709,48.37292],[13.43929,48.43386],[13.42527,48.45711],[13.45727,48.51092],[13.43695,48.55776],[13.45214,48.56472],[13.46967,48.55157],[13.50663,48.57506],[13.50131,48.58091],[13.51291,48.59023],[13.57535,48.55912],[13.59705,48.57013],[13.62508,48.55501],[13.65186,48.55092],[13.66113,48.53558],[13.72802,48.51208],[13.74816,48.53058],[13.7513,48.5624],[13.76921,48.55324],[13.80519,48.58026],[13.80038,48.59487],[13.82609,48.62345],[13.81901,48.6761],[13.81283,48.68426],[13.81791,48.69832],[13.79337,48.71375],[13.81863,48.73257],[13.82266,48.75544],[13.84023,48.76988],[13.8096,48.77877],[13.78977,48.83319],[13.76994,48.83537],[13.73854,48.88538],[13.67739,48.87886],[13.61624,48.9462],[13.58319,48.96899],[13.50552,48.97441],[13.50221,48.93752],[13.40802,48.98851],[13.39479,49.04812],[13.28242,49.1228],[13.23689,49.11412],[13.20405,49.12303],[13.17019,49.14339],[13.17665,49.16713],[13.05883,49.26259],[13.02957,49.27399],[13.03618,49.30417],[12.94859,49.34079],[12.88249,49.35479],[12.88414,49.33541],[12.78168,49.34618],[12.75854,49.3989],[12.71227,49.42363],[12.669,49.42935],[12.64121,49.47628],[12.64782,49.52565],[12.60155,49.52887],[12.56188,49.6146],[12.53544,49.61888],[12.52553,49.68415],[12.4462,49.70233],[12.40489,49.76321],[12.46603,49.78882],[12.48256,49.83575],[12.55197,49.92094],[12.47264,49.94222],[12.49908,49.97305],[12.30798,50.05719],[12.26111,50.06331],[12.27433,50.0771],[12.23709,50.10213],[12.2073,50.10315],[12.1917,50.13434],[12.21484,50.16399],[12.19335,50.19997],[12.09287,50.25032],[12.13716,50.27396],[12.10907,50.32041],[12.18013,50.32146],[12.20823,50.2729],[12.25119,50.27079],[12.26953,50.25189],[12.24791,50.25525],[12.23943,50.24594],[12.28755,50.22429],[12.28063,50.19544],[12.29232,50.17524],[12.32596,50.17146],[12.33847,50.19432],[12.32445,50.20442],[12.33263,50.24367],[12.35425,50.23993],[12.36594,50.28289],[12.40158,50.29521],[12.39924,50.32302],[12.43371,50.32506],[12.43722,50.33774],[12.46643,50.35527],[12.48256,50.34784],[12.49214,50.35228],[12.48747,50.37278],[12.51356,50.39694],[12.67261,50.41949],[12.70731,50.39948],[12.73044,50.42268],[12.73476,50.43237],[12.82465,50.45738],[12.94058,50.40944],[12.98433,50.42016],[13.02147,50.44763],[13.02038,50.4734],[13.0312,50.50944],[13.08301,50.50132],[13.13424,50.51709],[13.19043,50.50237],[13.25158,50.59268],[13.29454,50.57904],[13.32594,50.58009],[13.32264,50.60317],[13.37805,50.627],[13.37485,50.64931],[13.42189,50.61243],[13.46413,50.60102],[13.49742,50.63133],[13.5226,50.64721],[13.53748,50.67654],[13.52474,50.70394],[13.65977,50.73096],[13.70204,50.71771],[13.76316,50.73487],[13.82942,50.7251],[13.89444,50.74142],[13.89113,50.78533],[13.98864,50.8177],[14.02982,50.80662],[14.22331,50.86049],[14.24314,50.88761],[14.27123,50.89386],[14.30098,50.88448],[14.38691,50.89907],[14.39848,50.93866],[14.31422,50.95243],[14.30251,50.96606],[14.32793,50.97379],[14.32353,50.98556],[14.28776,50.97718],[14.25665,50.98935],[14.30098,51.05515],[14.41335,51.02086],[14.45827,51.03712],[14.49202,51.02286],[14.49154,51.04382],[14.49991,51.04692],[14.50809,51.0427],[14.49873,51.02242],[14.53321,51.01679],[14.53438,51.00374],[14.56432,51.01008],[14.58215,50.99306],[14.59908,50.98685],[14.59702,50.96148],[14.56374,50.922],[14.58024,50.91443],[14.64802,50.93241],[14.65259,50.90513],[14.63434,50.8883],[14.61993,50.86049],[14.70661,50.84096],[14.79139,50.81438],[14.82803,50.86966],[14.81664,50.88148],[14.89681,50.9422],[14.89252,50.94999],[14.92942,50.99744],[14.95529,51.04552],[14.97938,51.07742],[14.98229,51.11354],[14.99689,51.12205],[14.99079,51.14284],[14.99646,51.14365],[15.00083,51.14974],[14.99414,51.15813],[14.99311,51.16249],[15.0047,51.16874],[15.01242,51.21285],[15.04288,51.28387],[14.98008,51.33449],[14.96899,51.38367],[14.9652,51.44793],[14.94749,51.47155],[14.73219,51.52922],[14.72652,51.53902],[14.73047,51.54606],[14.71125,51.56209],[14.7727,51.61263],[14.75759,51.62318],[14.75392,51.67445],[14.69065,51.70842],[14.66386,51.73282],[14.64625,51.79472],[14.60493,51.80473],[14.59089,51.83302],[14.6588,51.88359],[14.6933,51.9044],[14.70601,51.92944],[14.7177,51.94048],[14.72163,51.95188],[14.71836,51.95606],[14.7139,51.95643],[14.70488,51.97679],[14.71339,52.00337],[14.76026,52.06624],[14.72971,52.09167],[14.6917,52.10283],[14.67683,52.13936],[14.70616,52.16927],[14.68344,52.19612],[14.71319,52.22144],[14.70139,52.25038],[14.58149,52.28007],[14.56378,52.33838],[14.55228,52.35264],[14.54423,52.42568],[14.63056,52.48993],[14.60081,52.53116],[14.6289,52.57136],[14.61073,52.59847],[14.22071,52.81175],[14.13806,52.82392],[14.12256,52.84311],[14.15873,52.87715],[14.14056,52.95786],[14.25954,53.00264],[14.35044,53.05829],[14.38679,53.13669],[14.36696,53.16444],[14.37853,53.20405],[14.40662,53.21098],[14.45125,53.26241],[14.44133,53.27427],[14.4215,53.27724],[14.35209,53.49506],[14.3273,53.50587],[14.30416,53.55499],[14.31904,53.61581],[14.2853,53.63392],[14.28477,53.65955],[14.27133,53.66613],[14.2836,53.67721],[14.26782,53.69866],[14.27249,53.74464],[14.21323,53.8664],[14.20823,53.90776],[14.18544,53.91258],[14.20647,53.91671],[14.22634,53.9291],[14.20811,54.12784],[13.93395,54.84044],[12.85844,54.82438],[11.90309,54.38543],[11.00303,54.63689],[10.31111,54.65968],[10.16755,54.73883],[9.89314,54.84171],[9.73563,54.8247],[9.61187,54.85548],[9.62734,54.88057],[9.58937,54.88785],[9.4659,54.83131],[9.43155,54.82586],[9.41213,54.84254],[9.38532,54.83968],[9.36496,54.81749],[9.33849,54.80233],[9.32771,54.80602],[9.2474,54.8112],[9.23445,54.83432],[9.24631,54.84726],[9.20571,54.85841],[9.14275,54.87421],[9.04629,54.87249],[8.92795,54.90452],[8.81178,54.90518],[8.76387,54.8948],[8.63979,54.91069],[8.55769,54.91837],[8.45719,55.06747],[8.02459,55.09613],[5.45168,54.20039],[6.91025,53.44221],[7.00198,53.32672],[7.19052,53.31866],[7.21679,53.20058],[7.22681,53.18165],[7.17898,53.13817],[7.21694,53.00742],[7.07253,52.81083],[7.04557,52.63318],[6.77307,52.65375],[6.71641,52.62905],[6.69507,52.488],[6.94293,52.43597],[6.99041,52.47235],[7.03417,52.40237],[7.07044,52.37805],[7.02703,52.27941],[7.06365,52.23789],[7.03729,52.22695],[6.9897,52.2271],[6.97189,52.20329],[6.83984,52.11728],[6.76117,52.11895],[6.68128,52.05052],[6.83035,51.9905],[6.82357,51.96711],[6.72319,51.89518],[6.68386,51.91861],[6.58556,51.89386],[6.50231,51.86313],[6.47179,51.85395],[6.38815,51.87257],[6.40704,51.82771],[6.30593,51.84998],[6.29872,51.86801],[6.21443,51.86801],[6.15349,51.90439],[6.11551,51.89769],[6.16902,51.84094],[6.10337,51.84829],[6.06705,51.86136],[5.99848,51.83195],[5.94568,51.82786],[5.98665,51.76944],[5.95003,51.7493],[6.04091,51.71821],[6.02767,51.6742],[6.11759,51.65609],[6.09055,51.60564],[6.18017,51.54096],[6.21724,51.48568],[6.20654,51.40049],[6.22641,51.39948],[6.22674,51.36135],[6.16977,51.33169],[6.07889,51.24432],[6.07889,51.17038],[6.17384,51.19589],[6.16706,51.15677],[5.98292,51.07469],[5.9541,51.03496],[5.9134,51.06736],[5.86735,51.05182],[5.87849,51.01969],[5.90493,51.00198],[5.90296,50.97356],[5.95282,50.98728],[6.02697,50.98303],[6.01615,50.93367],[6.09297,50.92066],[6.07486,50.89307],[6.08805,50.87223],[6.07693,50.86025],[6.07431,50.84674],[6.05702,50.85179],[6.05623,50.8572],[6.01921,50.84435],[6.02328,50.81694],[6.00462,50.80065],[5.98404,50.80988],[5.97497,50.79992],[6.02624,50.77453],[6.01976,50.75398],[6.03889,50.74618],[6.0326,50.72647],[6.0406,50.71848],[6.04428,50.72861],[6.11707,50.72231],[6.17852,50.6245],[6.26957,50.62444],[6.2476,50.60392],[6.24888,50.59869],[6.24005,50.58732],[6.22581,50.5907],[6.20281,50.56952],[6.17739,50.55875],[6.17802,50.54179],[6.19735,50.53576],[6.19579,50.5313],[6.18716,50.52653],[6.19193,50.5212],[6.20599,50.52089],[6.22335,50.49578],[6.26637,50.50272],[6.30809,50.50058],[6.3465,50.48833],[6.34005,50.46083],[6.37219,50.45397],[6.36852,50.40776],[6.34406,50.37994],[6.3688,50.35898],[6.40785,50.33557],[6.40641,50.32425],[6.35701,50.31139],[6.32488,50.32333],[6.29949,50.30887],[6.28797,50.27458],[6.208,50.25179],[6.16853,50.2234],[6.18364,50.20815],[6.18739,50.1822],[6.14588,50.17106],[6.14132,50.14971],[6.15298,50.14126],[6.1379,50.12964],[6.12055,50.09171],[6.11274,50.05916],[6.13458,50.04141],[6.13044,50.02929],[6.14666,50.02207],[6.13794,50.01466],[6.13273,50.02019],[6.1295,50.01849],[6.13806,50.01056],[6.14948,50.00908],[6.14147,49.99563],[6.1701,49.98518],[6.16466,49.97086],[6.17872,49.9537],[6.18554,49.95622],[6.18045,49.96611],[6.19089,49.96991],[6.19856,49.95053],[6.22094,49.94955],[6.22608,49.929],[6.21882,49.92403],[6.22926,49.92096],[6.23496,49.89972],[6.26146,49.88203],[6.28874,49.87592],[6.29692,49.86685],[6.30963,49.87021],[6.32303,49.85133],[6.32098,49.83728],[6.33585,49.83785],[6.34267,49.84974],[6.36576,49.85032],[6.40022,49.82029],[6.42521,49.81591],[6.42905,49.81091],[6.44131,49.81443],[6.45425,49.81164],[6.47111,49.82263],[6.48718,49.81267],[6.50647,49.80916],[6.51215,49.80124],[6.52121,49.81338],[6.53122,49.80666],[6.52169,49.79787],[6.50534,49.78952],[6.51669,49.78336],[6.51056,49.77515],[6.51828,49.76855],[6.51646,49.75961],[6.50174,49.75292],[6.50193,49.73291],[6.51805,49.72425],[6.51397,49.72058],[6.50261,49.72718],[6.49535,49.72645],[6.49694,49.72205],[6.5042,49.71808],[6.50647,49.71353],[6.49785,49.71118],[6.48014,49.69767],[6.46048,49.69092],[6.44654,49.67799],[6.42937,49.66857],[6.42726,49.66078],[6.43768,49.66021],[6.4413,49.65722],[6.41861,49.61723],[6.39822,49.60081],[6.385,49.59946],[6.37464,49.58886],[6.38342,49.5799],[6.38024,49.57593],[6.36676,49.57813],[6.35825,49.57053],[6.38228,49.55855],[6.38072,49.55171],[6.35666,49.52931],[6.36788,49.50377],[6.36907,49.48931],[6.36778,49.46937],[6.38352,49.46463],[6.39168,49.4667],[6.40274,49.46546],[6.42432,49.47683],[6.55404,49.42464],[6.533,49.40748],[6.60091,49.36864],[6.58807,49.35358],[6.572,49.35027],[6.60186,49.31055],[6.66583,49.28065],[6.69274,49.21661],[6.71843,49.2208],[6.73256,49.20486],[6.71137,49.18808],[6.73765,49.16375],[6.78265,49.16793],[6.83385,49.15162],[6.84703,49.15734],[6.86225,49.18185],[6.85016,49.19354],[6.85119,49.20038],[6.83555,49.21249],[6.85939,49.22376],[6.89298,49.20863],[6.91875,49.22261],[6.93831,49.2223],[6.94028,49.21641],[6.95963,49.203],[6.97273,49.2099],[7.01318,49.19018],[7.03459,49.19096],[7.0274,49.17042],[7.03178,49.15734],[7.04662,49.13724],[7.04409,49.12123],[7.04843,49.11422],[7.05548,49.11185],[7.06642,49.11415],[7.07162,49.1255],[7.09007,49.13094],[7.07859,49.15031],[7.10715,49.15631],[7.10384,49.13787],[7.12504,49.14253],[7.1358,49.1282],[7.1593,49.1204],[7.23473,49.12971],[7.29514,49.11426],[7.3195,49.14231],[7.35995,49.14399],[7.3662,49.17308],[7.44052,49.18354],[7.44455,49.16765],[7.49473,49.17],[7.49172,49.13915],[7.53012,49.09818],[7.56416,49.08136],[7.62575,49.07654],[7.63618,49.05428],[7.75948,49.04562],[7.79557,49.06583],[7.86386,49.03499],[7.93641,49.05544],[7.97783,49.03161],[8.14189,48.97833],[8.22604,48.97352],[8.20031,48.95856],[8.19989,48.95825],[8.12813,48.87985],[8.10253,48.81829],[8.06802,48.78957],[8.0326,48.79017],[8.01534,48.76085],[7.96994,48.75606],[7.96812,48.72491],[7.89002,48.66317],[7.84098,48.64217],[7.80057,48.5857],[7.80167,48.54758],[7.80647,48.51239],[7.76833,48.48945],[7.73109,48.39192],[7.74562,48.32736],[7.69022,48.30018],[7.6648,48.22219],[7.57137,48.12292],[7.56966,48.03265],[7.62302,47.97898],[7.55673,47.87371],[7.52921,47.77747],[7.54761,47.72912],[7.53722,47.71635],[7.51266,47.70197],[7.51915,47.68335],[7.52067,47.66437],[7.53384,47.65115],[7.5591,47.63849],[7.57423,47.61628],[7.58851,47.60794],[7.59301,47.60058],[7.58945,47.59017],[7.60523,47.58519],[7.60459,47.57869],[7.61929,47.57683],[7.64309,47.59151],[7.64213,47.5944],[7.64599,47.59695],[7.67395,47.59212],[7.68229,47.59905],[7.69385,47.60099],[7.68486,47.59601],[7.67115,47.5871],[7.68904,47.57133],[7.67655,47.56435],[7.63338,47.56256],[7.65083,47.54662],[7.66174,47.54554],[7.6656,47.53752],[7.68101,47.53232],[7.69642,47.53297],[7.71961,47.54219],[7.75261,47.54599],[7.79486,47.55691],[7.81901,47.58798],[7.84412,47.5841],[7.88664,47.58854],[7.90673,47.57674],[7.91251,47.55031],[7.94494,47.54511],[7.95682,47.55789],[7.97581,47.55493],[8.00113,47.55616],[8.02136,47.55096],[8.04383,47.55443],[8.06663,47.56374],[8.08557,47.55768],[8.10002,47.56504],[8.10395,47.57918],[8.11543,47.5841],[8.13662,47.58432],[8.13823,47.59147],[8.14947,47.59558],[8.1652,47.5945],[8.19378,47.61636],[8.20617,47.62141],[8.22011,47.6181],[8.22577,47.60385],[8.23809,47.61204],[8.25863,47.61571],[8.26313,47.6103],[8.2824,47.61225],[8.29722,47.60603],[8.29524,47.5919],[8.30277,47.58607],[8.32735,47.57133],[8.35512,47.57014],[8.38273,47.56608],[8.39477,47.57826],[8.43235,47.56617],[8.49431,47.58107],[8.48949,47.588],[8.46637,47.58389],[8.45578,47.60121],[8.50747,47.61897],[8.51686,47.63476],[8.55756,47.62394],[8.57586,47.59537],[8.60348,47.61204],[8.59545,47.64298],[8.60701,47.65271],[8.61471,47.64514],[8.60412,47.63735],[8.62049,47.63757],[8.62884,47.65098],[8.61113,47.66332],[8.6052,47.67258],[8.57683,47.66158],[8.56141,47.67088],[8.52801,47.66059],[8.5322,47.64687],[8.49656,47.64709],[8.46605,47.64103],[8.4667,47.65747],[8.44711,47.65379],[8.42264,47.66667],[8.41346,47.66676],[8.40473,47.67499],[8.4211,47.68407],[8.40569,47.69855],[8.44807,47.72426],[8.45771,47.7493],[8.48868,47.77215],[8.56814,47.78001],[8.56415,47.80633],[8.61657,47.79998],[8.62408,47.7626],[8.64425,47.76398],[8.65292,47.80066],[8.68022,47.78599],[8.68985,47.75686],[8.71778,47.76571],[8.74251,47.75168],[8.70543,47.73121],[8.73671,47.7169],[8.72617,47.69651]]]]}},{type:"Feature",properties:{iso1A2:"DG",iso1A3:"DGA",wikidata:"Q184851",nameEn:"Diego Garcia",country:"GB",groups:["IO","BOTS","014","202","002","UN"],isoStatus:"excRes",callingCodes:["246"]},geometry:{type:"MultiPolygon",coordinates:[[[[73.14823,-7.76302],[73.09982,-6.07324],[71.43792,-7.73904],[73.14823,-7.76302]]]]}},{type:"Feature",properties:{iso1A2:"DJ",iso1A3:"DJI",iso1N3:"262",wikidata:"Q977",nameEn:"Djibouti",groups:["014","202","002","UN"],callingCodes:["253"]},geometry:{type:"MultiPolygon",coordinates:[[[[43.90659,12.3823],[43.90659,12.3823],[43.32909,12.59711],[43.29075,12.79154],[42.86195,12.58747],[42.7996,12.42629],[42.6957,12.36201],[42.46941,12.52661],[42.4037,12.46478],[41.95461,11.81157],[41.82878,11.72361],[41.77727,11.49902],[41.8096,11.33606],[41.80056,10.97127],[42.06302,10.92599],[42.13691,10.97586],[42.42669,10.98493],[42.62989,11.09711],[42.75111,11.06992],[42.79037,10.98493],[42.95776,10.98533],[43.90659,12.3823]]]]}},{type:"Feature",properties:{iso1A2:"DK",iso1A3:"DNK",iso1N3:"208",wikidata:"Q756617",nameEn:"Kingdom of Denmark"},geometry:null},{type:"Feature",properties:{iso1A2:"DM",iso1A3:"DMA",iso1N3:"212",wikidata:"Q784",nameEn:"Dominica",groups:["029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",callingCodes:["1 767"]},geometry:{type:"MultiPolygon",coordinates:[[[[-61.32485,14.91445],[-60.86656,15.82603],[-61.95646,15.5094],[-61.32485,14.91445]]]]}},{type:"Feature",properties:{iso1A2:"DO",iso1A3:"DOM",iso1N3:"214",wikidata:"Q786",nameEn:"Dominican Republic",groups:["029","003","419","019","UN"],callingCodes:["1 809","1 829","1 849"]},geometry:{type:"MultiPolygon",coordinates:[[[[-67.87844,21.7938],[-72.38946,20.27111],[-71.77419,19.73128],[-71.75865,19.70231],[-71.7429,19.58445],[-71.71449,19.55364],[-71.71268,19.53374],[-71.6802,19.45008],[-71.69448,19.37866],[-71.77766,19.33823],[-71.73229,19.26686],[-71.62642,19.21212],[-71.65337,19.11759],[-71.69938,19.10916],[-71.71088,19.08353],[-71.74088,19.0437],[-71.88102,18.95007],[-71.77766,18.95007],[-71.72624,18.87802],[-71.71885,18.78423],[-71.82556,18.62551],[-71.95412,18.64939],[-72.00201,18.62312],[-71.88102,18.50125],[-71.90875,18.45821],[-71.69952,18.34101],[-71.78271,18.18302],[-71.75465,18.14405],[-71.74994,18.11115],[-71.73783,18.07177],[-71.75671,18.03456],[-72.29523,17.48026],[-68.39466,16.14167],[-67.87844,21.7938]]]]}},{type:"Feature",properties:{iso1A2:"DZ",iso1A3:"DZA",iso1N3:"012",wikidata:"Q262",nameEn:"Algeria",groups:["015","002","UN"],callingCodes:["213"]},geometry:{type:"MultiPolygon",coordinates:[[[[8.59123,37.14286],[5.10072,39.89531],[-2.27707,35.35051],[-2.21248,35.08532],[-2.21445,35.04378],[-2.04734,34.93218],[-1.97833,34.93218],[-1.97469,34.886],[-1.73707,34.74226],[-1.84569,34.61907],[-1.69788,34.48056],[-1.78042,34.39018],[-1.64666,34.10405],[-1.73494,33.71721],[-1.59508,33.59929],[-1.67067,33.27084],[-1.46249,33.0499],[-1.54244,32.95499],[-1.37794,32.73628],[-.9912,32.52467],[-1.24998,32.32993],[-1.24453,32.1917],[-1.15735,32.12096],[-1.22829,32.07832],[-2.46166,32.16603],[-2.93873,32.06557],[-2.82784,31.79459],[-3.66314,31.6339],[-3.66386,31.39202],[-3.77647,31.31912],[-3.77103,31.14984],[-3.54944,31.0503],[-3.65418,30.85566],[-3.64735,30.67539],[-4.31774,30.53229],[-4.6058,30.28343],[-5.21671,29.95253],[-5.58831,29.48103],[-5.72121,29.52322],[-5.75616,29.61407],[-6.69965,29.51623],[-6.78351,29.44634],[-6.95824,29.50924],[-7.61585,29.36252],[-8.6715,28.71194],[-8.66879,27.6666],[-8.66674,27.31569],[-4.83423,24.99935],[1.15698,21.12843],[1.20992,20.73533],[3.24648,19.81703],[3.12501,19.1366],[3.36082,18.9745],[4.26651,19.14224],[5.8153,19.45101],[7.38361,20.79165],[7.48273,20.87258],[11.96886,23.51735],[11.62498,24.26669],[11.41061,24.21456],[10.85323,24.5595],[10.33159,24.5465],[10.02432,24.98124],[10.03146,25.35635],[9.38834,26.19288],[9.51696,26.39148],[9.89569,26.57696],[9.78136,29.40961],[9.3876,30.16738],[9.55544,30.23971],[9.07483,32.07865],[8.35999,32.50101],[8.31895,32.83483],[8.1179,33.05086],[8.11433,33.10175],[7.83028,33.18851],[7.73687,33.42114],[7.54088,33.7726],[7.52851,34.06493],[7.66174,34.20167],[7.74207,34.16492],[7.81242,34.21841],[7.86264,34.3987],[8.20482,34.57575],[8.29655,34.72798],[8.25189,34.92009],[8.30727,34.95378],[8.3555,35.10007],[8.47318,35.23376],[8.30329,35.29884],[8.36086,35.47774],[8.35371,35.66373],[8.26472,35.73669],[8.2626,35.91733],[8.40731,36.42208],[8.18936,36.44939],[8.16167,36.48817],[8.47609,36.66607],[8.46537,36.7706],[8.57613,36.78062],[8.67706,36.8364],[8.62972,36.86499],[8.64044,36.9401],[8.59123,37.14286]]]]}},{type:"Feature",properties:{iso1A2:"EA",wikidata:"Q28868874",nameEn:"Ceuta, Melilla",country:"ES",level:"territory",isoStatus:"excRes"},geometry:null},{type:"Feature",properties:{iso1A2:"EC",iso1A3:"ECU",iso1N3:"218",wikidata:"Q736",nameEn:"Ecuador"},geometry:null},{type:"Feature",properties:{iso1A2:"EE",iso1A3:"EST",iso1N3:"233",wikidata:"Q191",nameEn:"Estonia",aliases:["EW"],groups:["EU","154","150","UN"],callingCodes:["372"]},geometry:{type:"MultiPolygon",coordinates:[[[[26.32936,60.00121],[20.5104,59.15546],[19.84909,57.57876],[22.80496,57.87798],[23.20055,57.56697],[24.26221,57.91787],[24.3579,57.87471],[25.19484,58.0831],[25.28237,57.98539],[25.29581,58.08288],[25.73499,57.90193],[26.05949,57.84744],[26.0324,57.79037],[26.02456,57.78342],[26.027,57.78158],[26.0266,57.77441],[26.02069,57.77169],[26.02415,57.76865],[26.03332,57.7718],[26.0543,57.76105],[26.08098,57.76619],[26.2029,57.7206],[26.1866,57.6849],[26.29253,57.59244],[26.46527,57.56885],[26.54675,57.51813],[26.90364,57.62823],[27.34698,57.52242],[27.31919,57.57672],[27.40393,57.62125],[27.3746,57.66834],[27.52615,57.72843],[27.50171,57.78842],[27.56689,57.83356],[27.78526,57.83963],[27.81841,57.89244],[27.67282,57.92627],[27.62393,58.09462],[27.48541,58.22615],[27.55489,58.39525],[27.36366,58.78381],[27.74429,58.98351],[27.80482,59.1116],[27.87978,59.18097],[27.90911,59.24353],[28.00689,59.28351],[28.14215,59.28934],[28.19284,59.35791],[28.20537,59.36491],[28.21137,59.38058],[28.19061,59.39962],[28.04187,59.47017],[27.85643,59.58538],[26.90044,59.63819],[26.32936,60.00121]]]]}},{type:"Feature",properties:{iso1A2:"EG",iso1A3:"EGY",iso1N3:"818",wikidata:"Q79",nameEn:"Egypt",groups:["015","002","UN"],callingCodes:["20"]},geometry:{type:"MultiPolygon",coordinates:[[[[33.62659,31.82938],[26.92891,33.39516],[24.8458,31.39877],[25.01077,30.73861],[24.71117,30.17441],[24.99968,29.24574],[24.99885,21.99535],[33.17563,22.00405],[34.0765,22.00501],[37.8565,22.00903],[34.4454,27.91479],[34.8812,29.36878],[34.92298,29.45305],[34.26742,31.21998],[34.24012,31.29591],[34.23572,31.2966],[34.21853,31.32363],[34.052,31.46619],[33.62659,31.82938]]]]}},{type:"Feature",properties:{iso1A2:"EH",iso1A3:"ESH",iso1N3:"732",wikidata:"Q6250",nameEn:"Western Sahara",groups:["015","002"],callingCodes:["212"]},geometry:{type:"MultiPolygon",coordinates:[[[[-8.66879,27.6666],[-8.77527,27.66663],[-8.71787,26.9898],[-9.08698,26.98639],[-9.56957,26.90042],[-9.81998,26.71379],[-10.68417,26.90984],[-11.35695,26.8505],[-11.23622,26.72023],[-11.38635,26.611],[-11.62052,26.05229],[-12.06001,26.04442],[-12.12281,25.13682],[-12.92147,24.39502],[-13.00628,24.01923],[-13.75627,23.77231],[-14.10361,22.75501],[-14.1291,22.41636],[-14.48112,22.00886],[-14.47329,21.63839],[-14.78487,21.36587],[-16.44269,21.39745],[-16.9978,21.36239],[-17.02707,21.34022],[-17.21511,21.34226],[-17.35589,20.80492],[-17.0471,20.76408],[-17.0695,20.85742],[-17.06781,20.92697],[-17.0396,20.9961],[-17.0357,21.05368],[-16.99806,21.12142],[-16.95474,21.33997],[-13.01525,21.33343],[-13.08438,22.53866],[-13.15313,22.75649],[-13.10753,22.89493],[-13.00412,23.02297],[-12.5741,23.28975],[-12.36213,23.3187],[-12.14969,23.41935],[-12.00251,23.4538],[-12.0002,25.9986],[-8.66721,25.99918],[-8.66674,27.31569],[-8.66879,27.6666]]]]}},{type:"Feature",properties:{iso1A2:"ER",iso1A3:"ERI",iso1N3:"232",wikidata:"Q986",nameEn:"Eritrea",groups:["014","202","002","UN"],callingCodes:["291"]},geometry:{type:"MultiPolygon",coordinates:[[[[40.99158,15.81743],[39.63762,18.37348],[38.57727,17.98125],[38.45916,17.87167],[38.37133,17.66269],[38.13362,17.53906],[37.50967,17.32199],[37.42694,17.04041],[36.99777,17.07172],[36.92193,16.23451],[36.76371,15.80831],[36.69761,15.75323],[36.54276,15.23478],[36.44337,15.14963],[36.54376,14.25597],[36.56536,14.26177],[36.55659,14.28237],[36.63364,14.31172],[36.85787,14.32201],[37.01622,14.2561],[37.09486,14.27155],[37.13206,14.40746],[37.3106,14.44657],[37.47319,14.2149],[37.528,14.18413],[37.91287,14.89447],[38.0364,14.72745],[38.25562,14.67287],[38.3533,14.51323],[38.45748,14.41445],[38.78306,14.4754],[38.98058,14.54895],[39.02834,14.63717],[39.16074,14.65187],[39.14772,14.61827],[39.19547,14.56996],[39.23888,14.56365],[39.26927,14.48801],[39.2302,14.44598],[39.2519,14.40393],[39.37685,14.54402],[39.52756,14.49011],[39.50585,14.55735],[39.58182,14.60987],[39.76632,14.54264],[39.9443,14.41024],[40.07236,14.54264],[40.14649,14.53969],[40.21128,14.39342],[40.25686,14.41445],[40.9167,14.11152],[41.25097,13.60787],[41.62864,13.38626],[42.05841,12.80912],[42.21469,12.75832],[42.2798,12.6355],[42.4037,12.46478],[42.46941,12.52661],[42.6957,12.36201],[42.7996,12.42629],[42.86195,12.58747],[43.29075,12.79154],[40.99158,15.81743]]]]}},{type:"Feature",properties:{iso1A2:"ES",iso1A3:"ESP",iso1N3:"724",wikidata:"Q29",nameEn:"Spain"},geometry:null},{type:"Feature",properties:{iso1A2:"ET",iso1A3:"ETH",iso1N3:"231",wikidata:"Q115",nameEn:"Ethiopia",groups:["014","202","002","UN"],callingCodes:["251"]},geometry:{type:"MultiPolygon",coordinates:[[[[42.4037,12.46478],[42.2798,12.6355],[42.21469,12.75832],[42.05841,12.80912],[41.62864,13.38626],[41.25097,13.60787],[40.9167,14.11152],[40.25686,14.41445],[40.21128,14.39342],[40.14649,14.53969],[40.07236,14.54264],[39.9443,14.41024],[39.76632,14.54264],[39.58182,14.60987],[39.50585,14.55735],[39.52756,14.49011],[39.37685,14.54402],[39.2519,14.40393],[39.2302,14.44598],[39.26927,14.48801],[39.23888,14.56365],[39.19547,14.56996],[39.14772,14.61827],[39.16074,14.65187],[39.02834,14.63717],[38.98058,14.54895],[38.78306,14.4754],[38.45748,14.41445],[38.3533,14.51323],[38.25562,14.67287],[38.0364,14.72745],[37.91287,14.89447],[37.528,14.18413],[37.47319,14.2149],[37.3106,14.44657],[37.13206,14.40746],[37.09486,14.27155],[37.01622,14.2561],[36.85787,14.32201],[36.63364,14.31172],[36.55659,14.28237],[36.56536,14.26177],[36.54376,14.25597],[36.44653,13.95666],[36.48824,13.83954],[36.38993,13.56459],[36.24545,13.36759],[36.13374,12.92665],[36.16651,12.88019],[36.14268,12.70879],[36.01458,12.72478],[35.70476,12.67101],[35.24302,11.91132],[35.11492,11.85156],[35.05832,11.71158],[35.09556,11.56278],[34.95704,11.24448],[35.01215,11.19626],[34.93172,10.95946],[34.97789,10.91559],[34.97491,10.86147],[34.86916,10.78832],[34.86618,10.74588],[34.77532,10.69027],[34.77383,10.74588],[34.59062,10.89072],[34.4372,10.781],[34.2823,10.53508],[34.34783,10.23914],[34.32102,10.11599],[34.22718,10.02506],[34.20484,9.9033],[34.13186,9.7492],[34.08717,9.55243],[34.10229,9.50238],[34.14304,9.04654],[34.14453,8.60204],[34.01346,8.50041],[33.89579,8.4842],[33.87195,8.41938],[33.71407,8.3678],[33.66938,8.44442],[33.54575,8.47094],[33.3119,8.45474],[33.19721,8.40317],[33.1853,8.29264],[33.18083,8.13047],[33.08401,8.05822],[33.0006,7.90333],[33.04944,7.78989],[33.24637,7.77939],[33.32531,7.71297],[33.44745,7.7543],[33.71407,7.65983],[33.87642,7.5491],[34.02984,7.36449],[34.03878,7.27437],[34.01495,7.25664],[34.19369,7.12807],[34.19369,7.04382],[34.35753,6.91963],[34.47669,6.91076],[34.53925,6.82794],[34.53776,6.74808],[34.65096,6.72589],[34.77459,6.5957],[34.87736,6.60161],[35.01738,6.46991],[34.96227,6.26415],[35.00546,5.89387],[35.12611,5.68937],[35.13058,5.62118],[35.31188,5.50106],[35.29938,5.34042],[35.50792,5.42431],[35.8576,5.33413],[35.81968,5.10757],[35.82118,4.77382],[35.9419,4.61933],[35.95449,4.53244],[36.03924,4.44406],[36.84474,4.44518],[37.07724,4.33503],[38.14168,3.62487],[38.45812,3.60445],[38.52336,3.62551],[38.91938,3.51198],[39.07736,3.5267],[39.19954,3.47834],[39.49444,3.45521],[39.51551,3.40895],[39.55132,3.39634],[39.58339,3.47434],[39.76808,3.67058],[39.86043,3.86974],[40.77498,4.27683],[41.1754,3.94079],[41.89488,3.97375],[42.07619,4.17667],[42.55853,4.20518],[42.84526,4.28357],[42.97746,4.44032],[43.04177,4.57923],[43.40263,4.79289],[44.02436,4.9451],[44.98104,4.91821],[47.97917,8.00124],[47.92477,8.00111],[46.99339,7.9989],[44.19222,8.93028],[43.32613,9.59205],[43.23518,9.84605],[43.0937,9.90579],[42.87643,10.18441],[42.69452,10.62672],[42.95776,10.98533],[42.79037,10.98493],[42.75111,11.06992],[42.62989,11.09711],[42.42669,10.98493],[42.13691,10.97586],[42.06302,10.92599],[41.80056,10.97127],[41.8096,11.33606],[41.77727,11.49902],[41.82878,11.72361],[41.95461,11.81157],[42.4037,12.46478]]]]}},{type:"Feature",properties:{iso1A2:"EU",iso1A3:"EUE",wikidata:"Q458",nameEn:"European Union",level:"union",isoStatus:"excRes"},geometry:null},{type:"Feature",properties:{iso1A2:"FI",iso1A3:"FIN",iso1N3:"246",wikidata:"Q33",nameEn:"Finland",aliases:["SF"]},geometry:null},{type:"Feature",properties:{iso1A2:"FJ",iso1A3:"FJI",iso1N3:"242",wikidata:"Q712",nameEn:"Fiji",groups:["054","009","UN"],driveSide:"left",callingCodes:["679"]},geometry:{type:"MultiPolygon",coordinates:[[[[174.245,-23.1974],[179.99999,-22.5],[179.99999,-11.5],[174,-11.5],[174.245,-23.1974]]],[[[-176.76826,-14.95183],[-180,-14.96041],[-180,-22.90585],[-176.74538,-22.89767],[-176.76826,-14.95183]]]]}},{type:"Feature",properties:{iso1A2:"FK",iso1A3:"FLK",iso1N3:"238",wikidata:"Q9648",nameEn:"Falkland Islands",country:"GB",groups:["BOTS","005","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["500"]},geometry:{type:"MultiPolygon",coordinates:[[[[-63.67376,-55.11859],[-54.56126,-51.26248],[-61.26735,-50.63919],[-63.67376,-55.11859]]]]}},{type:"Feature",properties:{iso1A2:"FM",iso1A3:"FSM",iso1N3:"583",wikidata:"Q702",nameEn:"Federated States of Micronesia",groups:["057","009","UN"],roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["691"]},geometry:{type:"MultiPolygon",coordinates:[[[[138.20583,13.3783],[136.27107,6.73747],[156.88247,-1.39237],[165.19726,6.22546],[138.20583,13.3783]]]]}},{type:"Feature",properties:{iso1A2:"FO",iso1A3:"FRO",iso1N3:"234",wikidata:"Q4628",nameEn:"Faroe Islands",country:"DK",groups:["154","150","UN"],callingCodes:["298"]},geometry:{type:"MultiPolygon",coordinates:[[[[-8.51774,62.35338],[-6.51083,60.95272],[-5.70102,62.77194],[-8.51774,62.35338]]]]}},{type:"Feature",properties:{iso1A2:"FR",iso1A3:"FRA",iso1N3:"250",wikidata:"Q142",nameEn:"France"},geometry:null},{type:"Feature",properties:{iso1A2:"FX",iso1A3:"FXX",iso1N3:"249",wikidata:"Q212429",nameEn:"Metropolitan France",country:"FR",groups:["EU","155","150","UN"],isoStatus:"excRes",callingCodes:["33"]},geometry:{type:"MultiPolygon",coordinates:[[[[2.55904,51.07014],[2.18458,51.52087],[1.17405,50.74239],[-2.02963,49.91866],[-2.09454,49.46288],[-1.83944,49.23037],[-2.00491,48.86706],[-2.65349,49.15373],[-6.28985,48.93406],[-1.81005,43.59738],[-1.77289,43.38957],[-1.79319,43.37497],[-1.78332,43.36399],[-1.78714,43.35476],[-1.77068,43.34396],[-1.75334,43.34107],[-1.75079,43.3317],[-1.7397,43.32979],[-1.73074,43.29481],[-1.69407,43.31378],[-1.62481,43.30726],[-1.63052,43.28591],[-1.61341,43.25269],[-1.57674,43.25269],[-1.55963,43.28828],[-1.50992,43.29481],[-1.45289,43.27049],[-1.40942,43.27272],[-1.3758,43.24511],[-1.41562,43.12815],[-1.47555,43.08372],[-1.44067,43.047],[-1.35272,43.02658],[-1.34419,43.09665],[-1.32209,43.1127],[-1.27118,43.11961],[-1.30052,43.09581],[-1.30531,43.06859],[-1.25244,43.04164],[-1.22881,43.05534],[-1.10333,43.0059],[-1.00963,42.99279],[-.97133,42.96239],[-.81652,42.95166],[-.75478,42.96916],[-.72037,42.92541],[-.73422,42.91228],[-.72608,42.89318],[-.69837,42.87945],[-.67637,42.88303],[-.55497,42.77846],[-.50863,42.82713],[-.44334,42.79939],[-.41319,42.80776],[-.38833,42.80132],[-.3122,42.84788],[-.17939,42.78974],[-.16141,42.79535],[-.10519,42.72761],[-.02468,42.68513],[.17569,42.73424],[.25336,42.7174],[.29407,42.67431],[.36251,42.72282],[.40214,42.69779],[.67873,42.69458],[.65421,42.75872],[.66121,42.84021],[.711,42.86372],[.93089,42.79154],[.96166,42.80629],[.98292,42.78754],[1.0804,42.78569],[1.15928,42.71407],[1.35562,42.71944],[1.44197,42.60217],[1.47986,42.61346],[1.46718,42.63296],[1.48043,42.65203],[1.50867,42.64483],[1.55418,42.65669],[1.60085,42.62703],[1.63485,42.62957],[1.6625,42.61982],[1.68267,42.62533],[1.73452,42.61515],[1.72588,42.59098],[1.7858,42.57698],[1.73683,42.55492],[1.72515,42.50338],[1.76335,42.48863],[1.83037,42.48395],[1.88853,42.4501],[1.93663,42.45439],[1.94292,42.44316],[1.94061,42.43333],[1.94084,42.43039],[1.9574,42.42401],[1.96482,42.37787],[2.00488,42.35399],[2.06241,42.35906],[2.11621,42.38393],[2.12789,42.41291],[2.16599,42.42314],[2.20578,42.41633],[2.25551,42.43757],[2.38504,42.39977],[2.43299,42.39423],[2.43508,42.37568],[2.48457,42.33933],[2.54382,42.33406],[2.55516,42.35351],[2.57934,42.35808],[2.6747,42.33974],[2.65311,42.38771],[2.72056,42.42298],[2.75497,42.42578],[2.77464,42.41046],[2.84335,42.45724],[2.85675,42.45444],[2.86983,42.46843],[2.88413,42.45938],[2.92107,42.4573],[2.94283,42.48174],[2.96518,42.46692],[3.03734,42.47363],[3.08167,42.42748],[3.10027,42.42621],[3.11379,42.43646],[3.17156,42.43545],[3.75438,42.33445],[7.60802,41.05927],[10.09675,41.44089],[9.56115,43.20816],[7.50102,43.51859],[7.42422,43.72209],[7.40903,43.7296],[7.41113,43.73156],[7.41291,43.73168],[7.41298,43.73311],[7.41233,43.73439],[7.42062,43.73977],[7.42299,43.74176],[7.42443,43.74087],[7.42809,43.74396],[7.43013,43.74895],[7.43624,43.75014],[7.43708,43.75197],[7.4389,43.75151],[7.4379,43.74963],[7.47823,43.73341],[7.53006,43.78405],[7.50423,43.84345],[7.49355,43.86551],[7.51162,43.88301],[7.56075,43.89932],[7.56858,43.94506],[7.60771,43.95772],[7.65266,43.9763],[7.66848,43.99943],[7.6597,44.03009],[7.72508,44.07578],[7.66878,44.12795],[7.68694,44.17487],[7.63245,44.17877],[7.62155,44.14881],[7.36364,44.11882],[7.34547,44.14359],[7.27827,44.1462],[7.16929,44.20352],[7.00764,44.23736],[6.98221,44.28289],[6.89171,44.36637],[6.88784,44.42043],[6.94504,44.43112],[6.86233,44.49834],[6.85507,44.53072],[6.96042,44.62129],[6.95133,44.66264],[7.00582,44.69364],[7.07484,44.68073],[7.00401,44.78782],[7.02217,44.82519],[6.93499,44.8664],[6.90774,44.84322],[6.75518,44.89915],[6.74519,44.93661],[6.74791,45.01939],[6.66981,45.02324],[6.62803,45.11175],[6.7697,45.16044],[6.85144,45.13226],[6.96706,45.20841],[7.07074,45.21228],[7.13115,45.25386],[7.10572,45.32924],[7.18019,45.40071],[7.00037,45.509],[6.98948,45.63869],[6.80785,45.71864],[6.80785,45.83265],[6.95315,45.85163],[7.04151,45.92435],[7.00946,45.9944],[6.93862,46.06502],[6.87868,46.03855],[6.89321,46.12548],[6.78968,46.14058],[6.86052,46.28512],[6.77152,46.34784],[6.8024,46.39171],[6.82312,46.42661],[6.53358,46.45431],[6.25432,46.3632],[6.21981,46.31304],[6.24826,46.30175],[6.25137,46.29014],[6.23775,46.27822],[6.24952,46.26255],[6.26749,46.24745],[6.29474,46.26221],[6.31041,46.24417],[6.29663,46.22688],[6.27694,46.21566],[6.26007,46.21165],[6.24821,46.20531],[6.23913,46.20511],[6.23544,46.20714],[6.22175,46.20045],[6.22222,46.19888],[6.21844,46.19837],[6.21603,46.19507],[6.21273,46.19409],[6.21114,46.1927],[6.20539,46.19163],[6.19807,46.18369],[6.19552,46.18401],[6.18707,46.17999],[6.18871,46.16644],[6.18116,46.16187],[6.15305,46.15194],[6.13397,46.1406],[6.09926,46.14373],[6.09199,46.15191],[6.07491,46.14879],[6.05203,46.15191],[6.04564,46.14031],[6.03614,46.13712],[6.01791,46.14228],[5.9871,46.14499],[5.97893,46.13303],[5.95781,46.12925],[5.9641,46.14412],[5.97508,46.15863],[5.98188,46.17392],[5.98846,46.17046],[5.99573,46.18587],[5.96515,46.19638],[5.97542,46.21525],[6.02461,46.23313],[6.03342,46.2383],[6.04602,46.23127],[6.05029,46.23518],[6.0633,46.24583],[6.07072,46.24085],[6.08563,46.24651],[6.10071,46.23772],[6.12446,46.25059],[6.11926,46.2634],[6.1013,46.28512],[6.11697,46.29547],[6.1198,46.31157],[6.13876,46.33844],[6.15738,46.3491],[6.16987,46.36759],[6.15985,46.37721],[6.15016,46.3778],[6.09926,46.40768],[6.06407,46.41676],[6.08427,46.44305],[6.07269,46.46244],[6.1567,46.54402],[6.11084,46.57649],[6.27135,46.68251],[6.38351,46.73171],[6.45209,46.77502],[6.43216,46.80336],[6.46456,46.88865],[6.43341,46.92703],[6.71531,47.0494],[6.68823,47.06616],[6.76788,47.1208],[6.8489,47.15933],[6.9508,47.24338],[6.95108,47.26428],[6.94316,47.28747],[7.05305,47.33304],[7.0564,47.35134],[7.03125,47.36996],[6.87959,47.35335],[6.88542,47.37262],[6.93744,47.40714],[6.93953,47.43388],[7.0024,47.45264],[6.98425,47.49432],[7.0231,47.50522],[7.07425,47.48863],[7.12781,47.50371],[7.16249,47.49025],[7.19583,47.49455],[7.17026,47.44312],[7.24669,47.4205],[7.33526,47.44186],[7.35603,47.43432],[7.40308,47.43638],[7.43088,47.45846],[7.4462,47.46264],[7.4583,47.47216],[7.42923,47.48628],[7.43356,47.49712],[7.47534,47.47932],[7.51076,47.49651],[7.49804,47.51798],[7.5229,47.51644],[7.53199,47.5284],[7.51904,47.53515],[7.50588,47.52856],[7.49691,47.53821],[7.50873,47.54546],[7.51723,47.54578],[7.52831,47.55347],[7.53634,47.55553],[7.55652,47.56779],[7.55689,47.57232],[7.56548,47.57617],[7.56684,47.57785],[7.58386,47.57536],[7.58945,47.59017],[7.59301,47.60058],[7.58851,47.60794],[7.57423,47.61628],[7.5591,47.63849],[7.53384,47.65115],[7.52067,47.66437],[7.51915,47.68335],[7.51266,47.70197],[7.53722,47.71635],[7.54761,47.72912],[7.52921,47.77747],[7.55673,47.87371],[7.62302,47.97898],[7.56966,48.03265],[7.57137,48.12292],[7.6648,48.22219],[7.69022,48.30018],[7.74562,48.32736],[7.73109,48.39192],[7.76833,48.48945],[7.80647,48.51239],[7.80167,48.54758],[7.80057,48.5857],[7.84098,48.64217],[7.89002,48.66317],[7.96812,48.72491],[7.96994,48.75606],[8.01534,48.76085],[8.0326,48.79017],[8.06802,48.78957],[8.10253,48.81829],[8.12813,48.87985],[8.19989,48.95825],[8.20031,48.95856],[8.22604,48.97352],[8.14189,48.97833],[7.97783,49.03161],[7.93641,49.05544],[7.86386,49.03499],[7.79557,49.06583],[7.75948,49.04562],[7.63618,49.05428],[7.62575,49.07654],[7.56416,49.08136],[7.53012,49.09818],[7.49172,49.13915],[7.49473,49.17],[7.44455,49.16765],[7.44052,49.18354],[7.3662,49.17308],[7.35995,49.14399],[7.3195,49.14231],[7.29514,49.11426],[7.23473,49.12971],[7.1593,49.1204],[7.1358,49.1282],[7.12504,49.14253],[7.10384,49.13787],[7.10715,49.15631],[7.07859,49.15031],[7.09007,49.13094],[7.07162,49.1255],[7.06642,49.11415],[7.05548,49.11185],[7.04843,49.11422],[7.04409,49.12123],[7.04662,49.13724],[7.03178,49.15734],[7.0274,49.17042],[7.03459,49.19096],[7.01318,49.19018],[6.97273,49.2099],[6.95963,49.203],[6.94028,49.21641],[6.93831,49.2223],[6.91875,49.22261],[6.89298,49.20863],[6.85939,49.22376],[6.83555,49.21249],[6.85119,49.20038],[6.85016,49.19354],[6.86225,49.18185],[6.84703,49.15734],[6.83385,49.15162],[6.78265,49.16793],[6.73765,49.16375],[6.71137,49.18808],[6.73256,49.20486],[6.71843,49.2208],[6.69274,49.21661],[6.66583,49.28065],[6.60186,49.31055],[6.572,49.35027],[6.58807,49.35358],[6.60091,49.36864],[6.533,49.40748],[6.55404,49.42464],[6.42432,49.47683],[6.40274,49.46546],[6.39168,49.4667],[6.38352,49.46463],[6.36778,49.46937],[6.3687,49.4593],[6.28818,49.48465],[6.27875,49.503],[6.25029,49.50609],[6.2409,49.51408],[6.19543,49.50536],[6.17386,49.50934],[6.15366,49.50226],[6.16115,49.49297],[6.14321,49.48796],[6.12814,49.49365],[6.12346,49.4735],[6.10325,49.4707],[6.09845,49.46351],[6.10072,49.45268],[6.08373,49.45594],[6.07887,49.46399],[6.05553,49.46663],[6.04176,49.44801],[6.02743,49.44845],[6.02648,49.45451],[5.97693,49.45513],[5.96876,49.49053],[5.94224,49.49608],[5.94128,49.50034],[5.86571,49.50015],[5.83389,49.52152],[5.83467,49.52717],[5.84466,49.53027],[5.83648,49.5425],[5.81664,49.53775],[5.80871,49.5425],[5.81838,49.54777],[5.79195,49.55228],[5.77435,49.56298],[5.7577,49.55915],[5.75649,49.54321],[5.64505,49.55146],[5.60909,49.51228],[5.55001,49.52729],[5.46541,49.49825],[5.46734,49.52648],[5.43713,49.5707],[5.3974,49.61596],[5.34837,49.62889],[5.33851,49.61599],[5.3137,49.61225],[5.30214,49.63055],[5.33039,49.6555],[5.31465,49.66846],[5.26232,49.69456],[5.14545,49.70287],[5.09249,49.76193],[4.96714,49.79872],[4.85464,49.78995],[4.86965,49.82271],[4.85134,49.86457],[4.88529,49.9236],[4.78827,49.95609],[4.8382,50.06738],[4.88602,50.15182],[4.83279,50.15331],[4.82438,50.16878],[4.75237,50.11314],[4.70064,50.09384],[4.68695,49.99685],[4.5414,49.96911],[4.51098,49.94659],[4.43488,49.94122],[4.35051,49.95315],[4.31963,49.97043],[4.20532,49.95803],[4.14239,49.98034],[4.13508,50.01976],[4.16294,50.04719],[4.23101,50.06945],[4.20147,50.13535],[4.13561,50.13078],[4.16014,50.19239],[4.15524,50.21103],[4.21945,50.25539],[4.20651,50.27333],[4.17861,50.27443],[4.17347,50.28838],[4.15524,50.2833],[4.16808,50.25786],[4.13665,50.25609],[4.11954,50.30425],[4.10957,50.30234],[4.10237,50.31247],[4.0689,50.3254],[4.0268,50.35793],[3.96771,50.34989],[3.90781,50.32814],[3.84314,50.35219],[3.73911,50.34809],[3.70987,50.3191],[3.71009,50.30305],[3.66976,50.34563],[3.65709,50.36873],[3.67262,50.38663],[3.67494,50.40239],[3.66153,50.45165],[3.64426,50.46275],[3.61014,50.49568],[3.58361,50.49049],[3.5683,50.50192],[3.49509,50.48885],[3.51564,50.5256],[3.47385,50.53397],[3.44629,50.51009],[3.37693,50.49538],[3.28575,50.52724],[3.2729,50.60718],[3.23951,50.6585],[3.264,50.67668],[3.2536,50.68977],[3.26141,50.69151],[3.26063,50.70086],[3.24593,50.71389],[3.22042,50.71019],[3.20845,50.71662],[3.19017,50.72569],[3.20064,50.73547],[3.18811,50.74025],[3.18339,50.74981],[3.16476,50.76843],[3.15017,50.79031],[3.1257,50.78603],[3.11987,50.79188],[3.11206,50.79416],[3.10614,50.78303],[3.09163,50.77717],[3.04314,50.77674],[3.00537,50.76588],[2.96778,50.75242],[2.95019,50.75138],[2.90873,50.702],[2.91036,50.6939],[2.90069,50.69263],[2.88504,50.70656],[2.87937,50.70298],[2.86985,50.7033],[2.8483,50.72276],[2.81056,50.71773],[2.71165,50.81295],[2.63331,50.81457],[2.59093,50.91751],[2.63074,50.94746],[2.57551,51.00326],[2.55904,51.07014]],[[1.99838,42.44682],[1.98378,42.44697],[1.96125,42.45364],[1.95606,42.45785],[1.96215,42.47854],[1.97003,42.48081],[1.97227,42.48487],[1.97697,42.48568],[1.98022,42.49569],[1.98916,42.49351],[1.99766,42.4858],[1.98579,42.47486],[1.99216,42.46208],[2.01564,42.45171],[1.99838,42.44682]]]]}},{type:"Feature",properties:{iso1A2:"GA",iso1A3:"GAB",iso1N3:"266",wikidata:"Q1000",nameEn:"Gabon",groups:["017","202","002","UN"],callingCodes:["241"]},geometry:{type:"MultiPolygon",coordinates:[[[[13.29457,2.16106],[13.28534,2.25716],[11.37116,2.29975],[11.3561,2.17217],[11.35307,1.00251],[9.79648,1.0019],[9.75065,1.06753],[9.66433,1.06723],[7.24416,-.64092],[10.75913,-4.39519],[11.12647,-3.94169],[11.22301,-3.69888],[11.48764,-3.51089],[11.57949,-3.52798],[11.68608,-3.68942],[11.87083,-3.71571],[11.92719,-3.62768],[11.8318,-3.5812],[11.96554,-3.30267],[11.70227,-3.17465],[11.70558,-3.0773],[11.80365,-3.00424],[11.64798,-2.81146],[11.5359,-2.85654],[11.64487,-2.61865],[11.57637,-2.33379],[11.74605,-2.39936],[11.96866,-2.33559],[12.04895,-2.41704],[12.47925,-2.32626],[12.44656,-1.92025],[12.61312,-1.8129],[12.82172,-1.91091],[13.02759,-2.33098],[13.47977,-2.43224],[13.75884,-2.09293],[13.92073,-2.35581],[13.85846,-2.46935],[14.10442,-2.49268],[14.23829,-2.33715],[14.16202,-2.23916],[14.23518,-2.15671],[14.25932,-1.97624],[14.41838,-1.89412],[14.52569,-.57818],[14.41887,-.44799],[14.2165,-.38261],[14.06862,-.20826],[13.90632,-.2287],[13.88648,.26652],[14.10909,.58563],[14.26066,.57255],[14.48179,.9152],[14.25186,1.39842],[13.89582,1.4261],[13.15519,1.23368],[13.25447,1.32339],[13.13461,1.57238],[13.29457,2.16106]]]]}},{type:"Feature",properties:{iso1A2:"GB",iso1A3:"GBR",iso1N3:"826",wikidata:"Q145",ccTLD:".uk",nameEn:"United Kingdom",aliases:["UK"]},geometry:null},{type:"Feature",properties:{iso1A2:"GD",iso1A3:"GRD",iso1N3:"308",wikidata:"Q769",nameEn:"Grenada",aliases:["WG"],groups:["029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",callingCodes:["1 473"]},geometry:{type:"MultiPolygon",coordinates:[[[[-62.64026,12.69984],[-61.77886,11.36496],[-59.94058,12.34011],[-62.64026,12.69984]]]]}},{type:"Feature",properties:{iso1A2:"GE",iso1A3:"GEO",iso1N3:"268",wikidata:"Q230",nameEn:"Georgia",groups:["145","142","UN"],callingCodes:["995"]},geometry:{type:"MultiPolygon",coordinates:[[[[46.42738,41.91323],[45.61676,42.20768],[45.78692,42.48358],[45.36501,42.55268],[45.15318,42.70598],[44.88754,42.74934],[44.80941,42.61277],[44.70002,42.74679],[44.54202,42.75699],[43.95517,42.55396],[43.73119,42.62043],[43.81453,42.74297],[43.0419,43.02413],[43.03322,43.08883],[42.75889,43.19651],[42.66667,43.13917],[42.40563,43.23226],[41.64935,43.22331],[40.65957,43.56212],[40.10657,43.57344],[40.04445,43.47776],[40.03312,43.44262],[40.01007,43.42411],[40.01552,43.42025],[40.00853,43.40578],[40.0078,43.38551],[39.81147,43.06294],[40.89217,41.72528],[41.54366,41.52185],[41.7148,41.4932],[41.7124,41.47417],[41.81939,41.43621],[41.95134,41.52466],[42.26387,41.49346],[42.51772,41.43606],[42.59202,41.58183],[42.72794,41.59714],[42.84471,41.58912],[42.78995,41.50126],[42.84899,41.47265],[42.8785,41.50516],[43.02956,41.37891],[43.21707,41.30331],[43.13373,41.25503],[43.1945,41.25242],[43.23096,41.17536],[43.36118,41.2028],[43.44973,41.17666],[43.4717,41.12611],[43.67712,41.13398],[43.74717,41.1117],[43.84835,41.16329],[44.16591,41.19141],[44.18148,41.24644],[44.32139,41.2079],[44.34337,41.20312],[44.34417,41.2382],[44.46791,41.18204],[44.59322,41.1933],[44.61462,41.24018],[44.72814,41.20338],[44.82084,41.21513],[44.87887,41.20195],[44.89911,41.21366],[44.84358,41.23088],[44.81749,41.23488],[44.80053,41.25949],[44.81437,41.30371],[44.93493,41.25685],[45.0133,41.29747],[45.09867,41.34065],[45.1797,41.42231],[45.26285,41.46433],[45.31352,41.47168],[45.4006,41.42402],[45.45973,41.45898],[45.68389,41.3539],[45.71035,41.36208],[45.75705,41.35157],[45.69946,41.29545],[45.80842,41.2229],[45.95786,41.17956],[46.13221,41.19479],[46.27698,41.19011],[46.37661,41.10805],[46.456,41.09984],[46.48558,41.0576],[46.55096,41.1104],[46.63969,41.09515],[46.66148,41.20533],[46.72375,41.28609],[46.63658,41.37727],[46.4669,41.43331],[46.40307,41.48464],[46.33925,41.4963],[46.29794,41.5724],[46.34126,41.57454],[46.34039,41.5947],[46.3253,41.60912],[46.28182,41.60089],[46.26531,41.63339],[46.24429,41.59883],[46.19759,41.62327],[46.17891,41.72094],[46.20538,41.77205],[46.23962,41.75811],[46.30863,41.79133],[46.3984,41.84399],[46.42738,41.91323]]]]}},{type:"Feature",properties:{iso1A2:"GF",iso1A3:"GUF",iso1N3:"254",wikidata:"Q3769",nameEn:"French Guiana",country:"FR",groups:["Q3320166","EU","005","419","019","UN"],callingCodes:["594"]},geometry:{type:"MultiPolygon",coordinates:[[[[-51.35485,4.8383],[-53.7094,6.2264],[-54.01074,5.68785],[-54.01877,5.52789],[-54.26916,5.26909],[-54.4717,4.91964],[-54.38444,4.13222],[-54.19367,3.84387],[-54.05128,3.63557],[-53.98914,3.627],[-53.9849,3.58697],[-54.28534,2.67798],[-54.42864,2.42442],[-54.6084,2.32856],[-54.16286,2.10779],[-53.78743,2.34412],[-52.96539,2.1881],[-52.6906,2.37298],[-52.31787,3.17896],[-51.85573,3.83427],[-51.82312,3.85825],[-51.79599,3.89336],[-51.61983,4.14596],[-51.63798,4.51394],[-51.35485,4.8383]]]]}},{type:"Feature",properties:{iso1A2:"GG",iso1A3:"GGY",iso1N3:"831",wikidata:"Q25230",nameEn:"Bailiwick of Guernsey",country:"GB"},geometry:null},{type:"Feature",properties:{iso1A2:"GH",iso1A3:"GHA",iso1N3:"288",wikidata:"Q117",nameEn:"Ghana",groups:["011","202","002","UN"],callingCodes:["233"]},geometry:{type:"MultiPolygon",coordinates:[[[[-.13493,11.14075],[-.27374,11.17157],[-.28566,11.12713],[-.35955,11.07801],[-.38219,11.12596],[-.42391,11.11661],[-.44298,11.04292],[-.61937,10.91305],[-.67143,10.99811],[-2.83373,11.0067],[-2.94232,10.64281],[-2.83108,10.40252],[-2.74174,9.83172],[-2.76534,9.56589],[-2.68802,9.49343],[-2.69814,9.22717],[-2.77799,9.04949],[-2.66357,9.01771],[-2.58243,8.7789],[-2.49037,8.20872],[-2.62901,8.11495],[-2.61232,8.02645],[-2.67787,8.02055],[-2.74819,7.92613],[-2.78395,7.94974],[-2.79467,7.86002],[-2.92339,7.60847],[-2.97822,7.27165],[-2.95438,7.23737],[-3.23327,6.81744],[-3.21954,6.74407],[-3.25999,6.62521],[-3.01896,5.71697],[-2.95323,5.71865],[-2.96671,5.6415],[-2.93132,5.62137],[-2.85378,5.65156],[-2.76614,5.60963],[-2.72737,5.34789],[-2.77625,5.34621],[-2.73074,5.1364],[-2.75502,5.10657],[-2.95261,5.12477],[-2.96554,5.10397],[-3.063,5.13665],[-3.11073,5.12675],[-3.10675,5.08515],[-3.34019,4.17519],[1.07031,5.15655],[1.27574,5.93551],[1.19771,6.11522],[1.19966,6.17069],[1.09187,6.17074],[1.05969,6.22998],[1.03108,6.24064],[.99652,6.33779],[.89283,6.33779],[.71048,6.53083],[.74862,6.56517],[.63659,6.63857],[.6497,6.73682],[.58176,6.76049],[.57406,6.80348],[.52853,6.82921],[.56508,6.92971],[.52098,6.94391],[.52217,6.9723],[.59606,7.01252],[.65327,7.31643],[.62943,7.41099],[.57223,7.39326],[.52455,7.45354],[.51979,7.58706],[.58295,7.62368],[.62943,7.85751],[.58891,8.12779],[.6056,8.13959],[.61156,8.18324],[.5913,8.19622],[.63897,8.25873],[.73432,8.29529],[.64731,8.48866],[.47211,8.59945],[.37319,8.75262],[.52455,8.87746],[.45424,9.04581],[.56388,9.40697],[.49118,9.48339],[.36485,9.49749],[.33148,9.44812],[.25758,9.42696],[.2254,9.47869],[.31241,9.50337],[.30406,9.521],[.2409,9.52335],[.23851,9.57389],[.38153,9.58682],[.36008,9.6256],[.29334,9.59387],[.26712,9.66437],[.28261,9.69022],[.32313,9.6491],[.34816,9.66907],[.34816,9.71607],[.32075,9.72781],[.36366,10.03309],[.41252,10.02018],[.41371,10.06361],[.35293,10.09412],[.39584,10.31112],[.33028,10.30408],[.29453,10.41546],[.18846,10.4096],[.12886,10.53149],[-.05945,10.63458],[-.09141,10.7147],[-.07327,10.71845],[-.07183,10.76794],[-.0228,10.81916],[-.02685,10.8783],[-.00908,10.91644],[-.0063,10.96417],[.03355,10.9807],[.02395,11.06229],[.00342,11.08317],[-.00514,11.10763],[-.0275,11.11202],[-.05733,11.08628],[-.14462,11.10811],[-.13493,11.14075]]]]}},{type:"Feature",properties:{iso1A2:"GI",iso1A3:"GIB",iso1N3:"292",wikidata:"Q1410",nameEn:"Gibraltar",country:"GB",groups:["Q12837","BOTS","039","150","UN"],callingCodes:["350"]},geometry:{type:"MultiPolygon",coordinates:[[[[-5.34064,36.03744],[-5.27801,36.14942],[-5.33822,36.15272],[-5.34536,36.15501],[-5.40526,36.15488],[-5.34064,36.03744]]]]}},{type:"Feature",properties:{iso1A2:"GL",iso1A3:"GRL",iso1N3:"304",wikidata:"Q223",nameEn:"Greenland",country:"DK",groups:["Q1451600","021","003","019","UN"],callingCodes:["299"]},geometry:{type:"MultiPolygon",coordinates:[[[[-49.33696,84.57952],[-68.21821,80.48551],[-77.52957,77.23408],[-46.37635,57.3249],[-9.68082,72.73731],[-5.7106,84.28058],[-49.33696,84.57952]]]]}},{type:"Feature",properties:{iso1A2:"GM",iso1A3:"GMB",iso1N3:"270",wikidata:"Q1005",nameEn:"The Gambia",groups:["011","202","002","UN"],callingCodes:["220"]},geometry:{type:"MultiPolygon",coordinates:[[[[-15.14917,13.57989],[-14.36795,13.23033],[-13.79409,13.34472],[-13.8955,13.59126],[-14.34721,13.46578],[-14.93719,13.80173],[-15.36504,13.79313],[-15.47902,13.58758],[-17.43598,13.59273],[-17.43966,13.04579],[-16.74676,13.06025],[-16.69343,13.16791],[-15.80355,13.16729],[-15.80478,13.34832],[-15.26908,13.37768],[-15.14917,13.57989]]]]}},{type:"Feature",properties:{iso1A2:"GN",iso1A3:"GIN",iso1N3:"324",wikidata:"Q1006",nameEn:"Guinea",groups:["011","202","002","UN"],callingCodes:["224"]},geometry:{type:"MultiPolygon",coordinates:[[[[-11.37536,12.40788],[-11.46267,12.44559],[-11.91331,12.42008],[-12.35415,12.32758],[-12.87336,12.51892],[-13.06603,12.49342],[-13.05296,12.64003],[-13.70523,12.68013],[-13.7039,12.60313],[-13.65089,12.49515],[-13.64168,12.42764],[-13.70851,12.24978],[-13.92745,12.24077],[-13.94589,12.16869],[-13.7039,12.00869],[-13.7039,11.70195],[-14.09799,11.63649],[-14.26623,11.67486],[-14.31513,11.60713],[-14.51173,11.49708],[-14.66677,11.51188],[-14.77786,11.36323],[-14.95993,10.99244],[-15.07174,10.89557],[-15.96748,10.162],[-14.36218,8.64107],[-13.29911,9.04245],[-13.18586,9.0925],[-13.08953,9.0409],[-12.94095,9.26335],[-12.76788,9.3133],[-12.47254,9.86834],[-12.24262,9.92386],[-12.12634,9.87203],[-11.91023,9.93927],[-11.89624,9.99763],[-11.2118,10.00098],[-10.6534,9.29919],[-10.74484,9.07998],[-10.5783,9.06386],[-10.56197,8.81225],[-10.47707,8.67669],[-10.61422,8.5314],[-10.70565,8.29235],[-10.63934,8.35326],[-10.54891,8.31174],[-10.37257,8.48941],[-10.27575,8.48711],[-10.203,8.47991],[-10.14579,8.52665],[-10.05375,8.50697],[-10.05873,8.42578],[-9.77763,8.54633],[-9.47415,8.35195],[-9.50898,8.18455],[-9.41445,8.02448],[-9.44928,7.9284],[-9.35724,7.74111],[-9.37465,7.62032],[-9.48161,7.37122],[-9.41943,7.41809],[-9.305,7.42056],[-9.20798,7.38109],[-9.18311,7.30461],[-9.09107,7.1985],[-8.93435,7.2824],[-8.85724,7.26019],[-8.8448,7.35149],[-8.72789,7.51429],[-8.67814,7.69428],[-8.55874,7.70167],[-8.55874,7.62525],[-8.47114,7.55676],[-8.4003,7.6285],[-8.21374,7.54466],[-8.09931,7.78626],[-8.13414,7.87991],[-8.06449,8.04989],[-7.94695,8.00925],[-7.99919,8.11023],[-7.98675,8.20134],[-8.062,8.16071],[-8.2411,8.24196],[-8.22991,8.48438],[-7.92518,8.50652],[-7.65653,8.36873],[-7.69882,8.66148],[-7.95503,8.81146],[-7.92518,8.99332],[-7.73862,9.08422],[-7.90777,9.20456],[-7.85056,9.41812],[-8.03463,9.39604],[-8.14657,9.55062],[-8.09434,9.86936],[-8.15652,9.94288],[-8.11921,10.04577],[-8.01225,10.1021],[-7.97971,10.17117],[-7.9578,10.2703],[-8.10207,10.44649],[-8.22711,10.41722],[-8.32614,10.69273],[-8.2667,10.91762],[-8.35083,11.06234],[-8.66923,10.99397],[-8.40058,11.37466],[-8.80854,11.66715],[-8.94784,12.34842],[-9.13689,12.50875],[-9.38067,12.48446],[-9.32097,12.29009],[-9.63938,12.18312],[-9.714,12.0226],[-10.30604,12.24634],[-10.71897,11.91552],[-10.80355,12.1053],[-10.99758,12.24634],[-11.24136,12.01286],[-11.50006,12.17826],[-11.37536,12.40788]]]]}},{type:"Feature",properties:{iso1A2:"GP",iso1A3:"GLP",iso1N3:"312",wikidata:"Q17012",nameEn:"Guadeloupe",country:"FR",groups:["Q3320166","EU","029","003","419","019","UN"],callingCodes:["590"]},geometry:{type:"MultiPolygon",coordinates:[[[[-60.03183,16.1129],[-61.60296,16.73066],[-63.00549,15.26166],[-60.03183,16.1129]]]]}},{type:"Feature",properties:{iso1A2:"GQ",iso1A3:"GNQ",iso1N3:"226",wikidata:"Q983",nameEn:"Equatorial Guinea",groups:["017","202","002","UN"],callingCodes:["240"]},geometry:{type:"MultiPolygon",coordinates:[[[[9.22018,3.72052],[8.34397,4.30689],[7.71762,.6674],[3.35016,-3.29031],[9.66433,1.06723],[9.75065,1.06753],[9.79648,1.0019],[11.35307,1.00251],[11.3561,2.17217],[9.991,2.16561],[9.90749,2.20049],[9.89012,2.20457],[9.84716,2.24676],[9.83238,2.29079],[9.83754,2.32428],[9.82123,2.35097],[9.81162,2.33797],[9.22018,3.72052]]]]}},{type:"Feature",properties:{iso1A2:"GR",iso1A3:"GRC",iso1N3:"300",wikidata:"Q41",nameEn:"Greece",aliases:["EL"],groups:["EU","039","150","UN"],callingCodes:["30"]},geometry:{type:"MultiPolygon",coordinates:[[[[26.03489,40.73051],[26.0754,40.72772],[26.08638,40.73214],[26.12495,40.74283],[26.12854,40.77339],[26.15685,40.80709],[26.21351,40.83298],[26.20856,40.86048],[26.26169,40.9168],[26.29441,40.89119],[26.28623,40.93005],[26.32259,40.94042],[26.35894,40.94292],[26.33297,40.98388],[26.3606,41.02027],[26.31928,41.07386],[26.32259,41.24929],[26.39861,41.25053],[26.5209,41.33993],[26.5837,41.32131],[26.62997,41.34613],[26.61767,41.42281],[26.59742,41.48058],[26.59196,41.60491],[26.5209,41.62592],[26.47958,41.67037],[26.35957,41.71149],[26.30255,41.70925],[26.2654,41.71544],[26.22888,41.74139],[26.21325,41.73223],[26.16841,41.74858],[26.06148,41.70345],[26.07083,41.64584],[26.15146,41.60828],[26.14328,41.55496],[26.17951,41.55409],[26.176,41.50072],[26.14796,41.47533],[26.20288,41.43943],[26.16548,41.42278],[26.12926,41.35878],[25.87919,41.30526],[25.8266,41.34563],[25.70507,41.29209],[25.66183,41.31316],[25.61042,41.30614],[25.55082,41.31667],[25.52394,41.2798],[25.48187,41.28506],[25.28322,41.23411],[25.11611,41.34212],[24.942,41.38685],[24.90928,41.40876],[24.86136,41.39298],[24.82514,41.4035],[24.8041,41.34913],[24.71529,41.41928],[24.61129,41.42278],[24.52599,41.56808],[24.30513,41.51297],[24.27124,41.57682],[24.18126,41.51735],[24.10063,41.54796],[24.06323,41.53222],[24.06908,41.46132],[23.96975,41.44118],[23.91483,41.47971],[23.89613,41.45257],[23.80148,41.43943],[23.76525,41.40175],[23.67644,41.41139],[23.63203,41.37632],[23.52453,41.40262],[23.40416,41.39999],[23.33639,41.36317],[23.31301,41.40525],[23.22771,41.37106],[23.21953,41.33773],[23.1833,41.31755],[22.93334,41.34104],[22.81199,41.3398],[22.76408,41.32225],[22.74538,41.16321],[22.71266,41.13945],[22.65306,41.18168],[22.62852,41.14385],[22.58295,41.11568],[22.5549,41.13065],[22.42285,41.11921],[22.26744,41.16409],[22.17629,41.15969],[22.1424,41.12449],[22.06527,41.15617],[21.90869,41.09191],[21.91102,41.04786],[21.7556,40.92525],[21.69601,40.9429],[21.57448,40.86076],[21.53007,40.90759],[21.41555,40.9173],[21.35595,40.87578],[21.25779,40.86165],[21.21105,40.8855],[21.15262,40.85546],[20.97887,40.85475],[20.98396,40.79109],[20.95752,40.76982],[20.98134,40.76046],[21.05833,40.66586],[21.03932,40.56299],[20.96908,40.51526],[20.94925,40.46625],[20.83688,40.47882],[20.7906,40.42726],[20.78234,40.35803],[20.71789,40.27739],[20.67162,40.09433],[20.62566,40.0897],[20.61081,40.07866],[20.55593,40.06524],[20.51297,40.08168],[20.48487,40.06271],[20.42373,40.06777],[20.37911,39.99058],[20.31135,39.99438],[20.41546,39.82832],[20.41475,39.81437],[20.38572,39.78516],[20.30804,39.81563],[20.29152,39.80421],[20.31961,39.72799],[20.27412,39.69884],[20.22707,39.67459],[20.22376,39.64532],[20.15988,39.652],[20.12956,39.65805],[20.05189,39.69112],[20.00957,39.69227],[19.98042,39.6504],[19.92466,39.69533],[19.97622,39.78684],[19.95905,39.82857],[19.0384,40.35325],[19.20409,39.7532],[22.5213,33.45682],[29.73302,35.92555],[29.69611,36.10365],[29.61805,36.14179],[29.61002,36.1731],[29.48192,36.18377],[29.30783,36.01033],[28.23708,36.56812],[27.95037,36.46155],[27.89482,36.69898],[27.46117,36.53789],[27.24613,36.71622],[27.45627,36.9008],[27.20312,36.94571],[27.14757,37.32],[26.95583,37.64989],[26.99377,37.69034],[27.16428,37.72343],[27.05537,37.9131],[26.21136,38.17558],[26.24183,38.44695],[26.32173,38.48731],[26.21136,38.65436],[26.61814,38.81372],[26.70773,39.0312],[26.43357,39.43096],[25.94257,39.39358],[25.61285,40.17161],[26.04292,40.3958],[25.94795,40.72797],[26.03489,40.73051]]]]}},{type:"Feature",properties:{iso1A2:"GS",iso1A3:"SGS",iso1N3:"239",wikidata:"Q35086",nameEn:"South Georgia and South Sandwich Islands",country:"GB",groups:["BOTS","005","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["500"]},geometry:{type:"MultiPolygon",coordinates:[[[[-35.26394,-43.68272],[-53.39656,-59.87088],[-22.31757,-59.85974],[-35.26394,-43.68272]]]]}},{type:"Feature",properties:{iso1A2:"GT",iso1A3:"GTM",iso1N3:"320",wikidata:"Q774",nameEn:"Guatemala",groups:["013","003","419","019","UN"],callingCodes:["502"]},geometry:{type:"MultiPolygon",coordinates:[[[[-89.14985,17.81563],[-90.98678,17.81655],[-90.99199,17.25192],[-91.43809,17.25373],[-91.04436,16.92175],[-90.69064,16.70697],[-90.61212,16.49832],[-90.40499,16.40524],[-90.44567,16.07573],[-91.73182,16.07371],[-92.20983,15.26077],[-92.0621,15.07406],[-92.1454,14.98143],[-92.1423,14.88647],[-92.18161,14.84147],[-92.1454,14.6804],[-92.2261,14.53423],[-92.37213,14.39277],[-90.55276,12.8866],[-90.11344,13.73679],[-90.10505,13.85104],[-89.88937,14.0396],[-89.81807,14.07073],[-89.76103,14.02923],[-89.73251,14.04133],[-89.75569,14.07073],[-89.70756,14.1537],[-89.61844,14.21937],[-89.52397,14.22628],[-89.50614,14.26084],[-89.58814,14.33165],[-89.57441,14.41637],[-89.39028,14.44561],[-89.34776,14.43013],[-89.35189,14.47553],[-89.23719,14.58046],[-89.15653,14.57802],[-89.13132,14.71582],[-89.23467,14.85596],[-89.15149,14.97775],[-89.18048,14.99967],[-89.15149,15.07392],[-88.97343,15.14039],[-88.32467,15.63665],[-88.31459,15.66942],[-88.24022,15.69247],[-88.22552,15.72294],[-88.20359,16.03858],[-88.40779,16.09624],[-88.95358,15.88698],[-89.02415,15.9063],[-89.17418,15.90898],[-89.22683,15.88619],[-89.15025,17.04813],[-89.14985,17.81563]]]]}},{type:"Feature",properties:{iso1A2:"GU",iso1A3:"GUM",iso1N3:"316",wikidata:"Q16635",nameEn:"Guam",aliases:["US-GU"],country:"US",groups:["Q1352230","Q153732","057","009","UN"],roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1 671"]},geometry:{type:"MultiPolygon",coordinates:[[[[146.25931,13.85876],[143.82485,13.92273],[144.61642,12.82462],[146.25931,13.85876]]]]}},{type:"Feature",properties:{iso1A2:"GW",iso1A3:"GNB",iso1N3:"624",wikidata:"Q1007",nameEn:"Guinea-Bissau",groups:["011","202","002","UN"],callingCodes:["245"]},geometry:{type:"MultiPolygon",coordinates:[[[[-14.31513,11.60713],[-14.26623,11.67486],[-14.09799,11.63649],[-13.7039,11.70195],[-13.7039,12.00869],[-13.94589,12.16869],[-13.92745,12.24077],[-13.70851,12.24978],[-13.64168,12.42764],[-13.65089,12.49515],[-13.7039,12.60313],[-13.70523,12.68013],[-15.17582,12.6847],[-15.67302,12.42974],[-16.20591,12.46157],[-16.38191,12.36449],[-16.70562,12.34803],[-17.4623,11.92379],[-15.96748,10.162],[-15.07174,10.89557],[-14.95993,10.99244],[-14.77786,11.36323],[-14.66677,11.51188],[-14.51173,11.49708],[-14.31513,11.60713]]]]}},{type:"Feature",properties:{iso1A2:"GY",iso1A3:"GUY",iso1N3:"328",wikidata:"Q734",nameEn:"Guyana",groups:["005","419","019","UN"],driveSide:"left",callingCodes:["592"]},geometry:{type:"MultiPolygon",coordinates:[[[[-56.84822,6.73257],[-59.54058,8.6862],[-59.98508,8.53046],[-59.85562,8.35213],[-59.80661,8.28906],[-59.83156,8.23261],[-59.97059,8.20791],[-60.02407,8.04557],[-60.38056,7.8302],[-60.51959,7.83373],[-60.64793,7.56877],[-60.71923,7.55817],[-60.59802,7.33194],[-60.63367,7.25061],[-60.54098,7.14804],[-60.44116,7.20817],[-60.28074,7.1162],[-60.39419,6.94847],[-60.54873,6.8631],[-61.13632,6.70922],[-61.20762,6.58174],[-61.15058,6.19558],[-61.4041,5.95304],[-60.73204,5.20931],[-60.32352,5.21299],[-60.20944,5.28754],[-59.98129,5.07097],[-60.04189,4.69801],[-60.15953,4.53456],[-59.78878,4.45637],[-59.69361,4.34069],[-59.73353,4.20399],[-59.51963,3.91951],[-59.86899,3.57089],[-59.79769,3.37162],[-59.99733,2.92312],[-59.91177,2.36759],[-59.7264,2.27497],[-59.74066,1.87596],[-59.25583,1.40559],[-58.92072,1.31293],[-58.84229,1.17749],[-58.53571,1.29154],[-58.4858,1.48399],[-58.33887,1.58014],[-58.01873,1.51966],[-57.97336,1.64566],[-57.77281,1.73344],[-57.55743,1.69605],[-57.35073,1.98327],[-57.23981,1.95808],[-57.09109,2.01854],[-57.07092,1.95304],[-56.7659,1.89509],[-56.47045,1.95135],[-56.55439,2.02003],[-56.70519,2.02964],[-57.35891,3.32121],[-58.0307,3.95513],[-57.8699,4.89394],[-57.37442,5.0208],[-57.22536,5.15605],[-57.31629,5.33714],[-56.84822,6.73257]]]]}},{type:"Feature",properties:{iso1A2:"HK",iso1A3:"HKG",iso1N3:"344",wikidata:"Q8646",nameEn:"Hong Kong",country:"CN",groups:["030","142","UN"],driveSide:"left",callingCodes:["852"]},geometry:{type:"MultiPolygon",coordinates:[[[[113.92195,22.13873],[114.50148,22.15017],[114.44998,22.55977],[114.25154,22.55977],[114.22888,22.5436],[114.22185,22.55343],[114.20655,22.55706],[114.18338,22.55444],[114.17247,22.55944],[114.1597,22.56041],[114.15123,22.55163],[114.1482,22.54091],[114.13823,22.54319],[114.12665,22.54003],[114.11656,22.53415],[114.11181,22.52878],[114.1034,22.5352],[114.09692,22.53435],[114.09048,22.53716],[114.08606,22.53276],[114.07817,22.52997],[114.07267,22.51855],[114.06272,22.51617],[114.05729,22.51104],[114.05438,22.5026],[114.03113,22.5065],[113.86771,22.42972],[113.81621,22.2163],[113.83338,22.1826],[113.92195,22.13873]]]]}},{type:"Feature",properties:{iso1A2:"HM",iso1A3:"HMD",iso1N3:"334",wikidata:"Q131198",nameEn:"Heard Island and McDonald Islands",country:"AU",groups:["053","009","UN"],driveSide:"left"},geometry:{type:"MultiPolygon",coordinates:[[[[71.08716,-53.87687],[75.44182,-53.99822],[72.87012,-51.48322],[71.08716,-53.87687]]]]}},{type:"Feature",properties:{iso1A2:"HN",iso1A3:"HND",iso1N3:"340",wikidata:"Q783",nameEn:"Honduras",groups:["013","003","419","019","UN"],callingCodes:["504"]},geometry:{type:"MultiPolygon",coordinates:[[[[-83.86109,17.73736],[-88.20359,16.03858],[-88.22552,15.72294],[-88.24022,15.69247],[-88.31459,15.66942],[-88.32467,15.63665],[-88.97343,15.14039],[-89.15149,15.07392],[-89.18048,14.99967],[-89.15149,14.97775],[-89.23467,14.85596],[-89.13132,14.71582],[-89.15653,14.57802],[-89.23719,14.58046],[-89.35189,14.47553],[-89.34776,14.43013],[-89.04187,14.33644],[-88.94608,14.20207],[-88.85785,14.17763],[-88.815,14.11652],[-88.73182,14.10919],[-88.70661,14.04317],[-88.49738,13.97224],[-88.48982,13.86458],[-88.25791,13.91108],[-88.23018,13.99915],[-88.07641,13.98447],[-88.00331,13.86948],[-87.7966,13.91353],[-87.68821,13.80829],[-87.73106,13.75443],[-87.78148,13.52906],[-87.71657,13.50577],[-87.72115,13.46083],[-87.73841,13.44169],[-87.77354,13.45767],[-87.83467,13.44655],[-87.84675,13.41078],[-87.80177,13.35689],[-87.73714,13.32715],[-87.69751,13.25228],[-87.55124,13.12523],[-87.37107,12.98646],[-87.06306,13.00892],[-87.03785,12.98682],[-86.93197,13.05313],[-86.93383,13.18677],[-86.87066,13.30641],[-86.71267,13.30348],[-86.76812,13.79605],[-86.35219,13.77157],[-86.14801,14.04317],[-86.00685,14.08474],[-86.03458,13.99181],[-85.75477,13.8499],[-85.73964,13.9698],[-85.45762,14.11304],[-85.32149,14.2562],[-85.18602,14.24929],[-85.1575,14.53934],[-84.90082,14.80489],[-84.82596,14.82212],[-84.70119,14.68078],[-84.48373,14.63249],[-84.10584,14.76353],[-83.89551,14.76697],[-83.62101,14.89448],[-83.49268,15.01158],[-83.13724,15.00002],[-83.04763,15.03256],[-82.06974,14.49418],[-81.58685,18.0025],[-83.86109,17.73736]]]]}},{type:"Feature",properties:{iso1A2:"HR",iso1A3:"HRV",iso1N3:"191",wikidata:"Q224",nameEn:"Croatia",groups:["EU","039","150","UN"],callingCodes:["385"]},geometry:{type:"MultiPolygon",coordinates:[[[[17.6444,42.88641],[17.5392,42.92787],[17.70879,42.97223],[17.64268,43.08595],[17.46986,43.16559],[17.286,43.33065],[17.25579,43.40353],[17.29699,43.44542],[17.24411,43.49376],[17.15828,43.49376],[17.00585,43.58037],[16.80736,43.76011],[16.75316,43.77157],[16.70922,43.84887],[16.55472,43.95326],[16.50528,44.0244],[16.43629,44.02826],[16.43662,44.07523],[16.36864,44.08263],[16.18688,44.27012],[16.21346,44.35231],[16.12969,44.38275],[16.16814,44.40679],[16.10566,44.52586],[16.03012,44.55572],[16.00884,44.58605],[16.05828,44.61538],[15.89348,44.74964],[15.8255,44.71501],[15.72584,44.82334],[15.79472,44.8455],[15.76096,44.87045],[15.74723,44.96818],[15.78568,44.97401],[15.74585,45.0638],[15.78842,45.11519],[15.76371,45.16508],[15.83512,45.22459],[15.98412,45.23088],[16.12153,45.09616],[16.29036,44.99732],[16.35404,45.00241],[16.35863,45.03529],[16.3749,45.05206],[16.38219,45.05139],[16.38309,45.05955],[16.40023,45.1147],[16.4634,45.14522],[16.49155,45.21153],[16.52982,45.22713],[16.5501,45.2212],[16.56559,45.22307],[16.60194,45.23042],[16.64962,45.20714],[16.74845,45.20393],[16.78219,45.19002],[16.81137,45.18434],[16.83804,45.18951],[16.92405,45.27607],[16.9385,45.22742],[17.0415,45.20759],[17.18438,45.14764],[17.24325,45.146],[17.25131,45.14957],[17.26815,45.18444],[17.32092,45.16246],[17.33573,45.14521],[17.41229,45.13335],[17.4498,45.16119],[17.45615,45.12523],[17.47589,45.12656],[17.51469,45.10791],[17.59104,45.10816],[17.66571,45.13408],[17.84826,45.04489],[17.87148,45.04645],[17.93706,45.08016],[17.97336,45.12245],[17.97834,45.13831],[17.99479,45.14958],[18.01594,45.15163],[18.03121,45.12632],[18.1624,45.07654],[18.24387,45.13699],[18.32077,45.1021],[18.41896,45.11083],[18.47939,45.05871],[18.65723,45.07544],[18.78357,44.97741],[18.80661,44.93561],[18.76369,44.93707],[18.76347,44.90669],[18.8704,44.85097],[19.01994,44.85493],[18.98957,44.90645],[19.02871,44.92541],[19.06853,44.89915],[19.15573,44.95409],[19.05205,44.97692],[19.1011,45.01191],[19.07952,45.14668],[19.14063,45.12972],[19.19144,45.17863],[19.43589,45.17137],[19.41941,45.23475],[19.28208,45.23813],[19.10774,45.29547],[18.97446,45.37528],[18.99918,45.49333],[19.08364,45.48804],[19.07471,45.53086],[18.94562,45.53712],[18.88776,45.57253],[18.96691,45.66731],[18.90305,45.71863],[18.85783,45.85493],[18.81394,45.91329],[18.80211,45.87995],[18.6792,45.92057],[18.57483,45.80772],[18.44368,45.73972],[18.12439,45.78905],[18.08869,45.76511],[17.99805,45.79671],[17.87377,45.78522],[17.66545,45.84207],[17.56821,45.93728],[17.35672,45.95209],[17.14592,46.16697],[16.8903,46.28122],[16.8541,46.36255],[16.7154,46.39523],[16.6639,46.45203],[16.59527,46.47524],[16.52604,46.47831],[16.5007,46.49644],[16.44036,46.5171],[16.38771,46.53608],[16.37193,46.55008],[16.29793,46.5121],[16.26733,46.51505],[16.26759,46.50566],[16.23961,46.49653],[16.25124,46.48067],[16.27398,46.42875],[16.27329,46.41467],[16.30162,46.40437],[16.30233,46.37837],[16.18824,46.38282],[16.14859,46.40547],[16.05281,46.39141],[16.05065,46.3833],[16.07314,46.36458],[16.07616,46.3463],[15.97965,46.30652],[15.79284,46.25811],[15.78817,46.21719],[15.75479,46.20336],[15.75436,46.21969],[15.67395,46.22478],[15.6434,46.21396],[15.64904,46.19229],[15.59909,46.14761],[15.6083,46.11992],[15.62317,46.09103],[15.72977,46.04682],[15.71246,46.01196],[15.70327,46.00015],[15.70636,45.92116],[15.67967,45.90455],[15.68383,45.88867],[15.68232,45.86819],[15.70411,45.8465],[15.66662,45.84085],[15.64185,45.82915],[15.57952,45.84953],[15.52234,45.82195],[15.47325,45.8253],[15.47531,45.79802],[15.40836,45.79491],[15.25423,45.72275],[15.30872,45.69014],[15.34919,45.71623],[15.4057,45.64727],[15.38952,45.63682],[15.34214,45.64702],[15.34695,45.63382],[15.31027,45.6303],[15.27747,45.60504],[15.29837,45.5841],[15.30249,45.53224],[15.38188,45.48752],[15.33051,45.45258],[15.27758,45.46678],[15.16862,45.42309],[15.05187,45.49079],[15.02385,45.48533],[14.92266,45.52788],[14.90554,45.47769],[14.81992,45.45913],[14.80124,45.49515],[14.71718,45.53442],[14.68605,45.53006],[14.69694,45.57366],[14.59576,45.62812],[14.60977,45.66403],[14.57397,45.67165],[14.53816,45.6205],[14.5008,45.60852],[14.49769,45.54424],[14.36693,45.48642],[14.32487,45.47142],[14.27681,45.4902],[14.26611,45.48239],[14.24239,45.50607],[14.22371,45.50388],[14.20348,45.46896],[14.07116,45.48752],[14.00578,45.52352],[13.96063,45.50825],[13.99488,45.47551],[13.97309,45.45258],[13.90771,45.45149],[13.88124,45.42637],[13.81742,45.43729],[13.7785,45.46787],[13.67398,45.4436],[13.62902,45.45898],[13.56979,45.4895],[13.45644,45.59464],[13.05142,45.33128],[13.12821,44.48877],[16.15283,42.18525],[18.45131,42.21682],[18.54128,42.39171],[18.52152,42.42302],[18.43588,42.48556],[18.44307,42.51077],[18.43735,42.55921],[18.36197,42.61423],[18.24318,42.6112],[17.88201,42.83668],[17.80854,42.9182],[17.7948,42.89556],[17.68151,42.92725],[17.6444,42.88641]]]]}},{type:"Feature",properties:{iso1A2:"HT",iso1A3:"HTI",iso1N3:"332",wikidata:"Q790",nameEn:"Haiti",aliases:["RH"],groups:["029","003","419","019","UN"],callingCodes:["509"]},geometry:{type:"MultiPolygon",coordinates:[[[[-71.71885,18.78423],[-71.72624,18.87802],[-71.77766,18.95007],[-71.88102,18.95007],[-71.74088,19.0437],[-71.71088,19.08353],[-71.69938,19.10916],[-71.65337,19.11759],[-71.62642,19.21212],[-71.73229,19.26686],[-71.77766,19.33823],[-71.69448,19.37866],[-71.6802,19.45008],[-71.71268,19.53374],[-71.71449,19.55364],[-71.7429,19.58445],[-71.75865,19.70231],[-71.77419,19.73128],[-72.38946,20.27111],[-73.37289,20.43199],[-74.7289,18.71009],[-74.76465,18.06252],[-72.29523,17.48026],[-71.75671,18.03456],[-71.73783,18.07177],[-71.74994,18.11115],[-71.75465,18.14405],[-71.78271,18.18302],[-71.69952,18.34101],[-71.90875,18.45821],[-71.88102,18.50125],[-72.00201,18.62312],[-71.95412,18.64939],[-71.82556,18.62551],[-71.71885,18.78423]]]]}},{type:"Feature",properties:{iso1A2:"HU",iso1A3:"HUN",iso1N3:"348",wikidata:"Q28",nameEn:"Hungary",groups:["EU","151","150","UN"],callingCodes:["36"]},geometry:{type:"MultiPolygon",coordinates:[[[[21.72525,48.34628],[21.67134,48.3989],[21.6068,48.50365],[21.44063,48.58456],[21.11516,48.49546],[20.83248,48.5824],[20.5215,48.53336],[20.29943,48.26104],[20.24312,48.2784],[19.92452,48.1283],[19.63338,48.25006],[19.52489,48.19791],[19.47957,48.09437],[19.28182,48.08336],[19.23924,48.0595],[19.01952,48.07052],[18.82176,48.04206],[18.76134,47.97499],[18.76821,47.87469],[18.8506,47.82308],[18.74074,47.8157],[18.66521,47.76772],[18.56496,47.76588],[18.29305,47.73541],[18.02938,47.75665],[17.71215,47.7548],[17.23699,48.02094],[17.16001,48.00636],[17.09786,47.97336],[17.11022,47.92461],[17.08275,47.87719],[17.00997,47.86245],[17.07039,47.81129],[17.05048,47.79377],[17.08893,47.70928],[16.87538,47.68895],[16.86509,47.72268],[16.82938,47.68432],[16.7511,47.67878],[16.72089,47.73469],[16.65679,47.74197],[16.61183,47.76171],[16.54779,47.75074],[16.53514,47.73837],[16.55129,47.72268],[16.4222,47.66537],[16.58699,47.61772],[16.64193,47.63114],[16.71059,47.52692],[16.64821,47.50155],[16.6718,47.46139],[16.57152,47.40868],[16.52414,47.41007],[16.49908,47.39416],[16.45104,47.41181],[16.47782,47.25918],[16.44142,47.25079],[16.43663,47.21127],[16.41739,47.20649],[16.42801,47.18422],[16.4523,47.18812],[16.46442,47.16845],[16.44932,47.14418],[16.52863,47.13974],[16.46134,47.09395],[16.52176,47.05747],[16.43936,47.03548],[16.51369,47.00084],[16.28202,47.00159],[16.27594,46.9643],[16.22403,46.939],[16.19904,46.94134],[16.10983,46.867],[16.14365,46.8547],[16.15711,46.85434],[16.21892,46.86961],[16.2365,46.87775],[16.2941,46.87137],[16.34547,46.83836],[16.3408,46.80641],[16.31303,46.79838],[16.30966,46.7787],[16.37816,46.69975],[16.42641,46.69228],[16.41863,46.66238],[16.38594,46.6549],[16.39217,46.63673],[16.50139,46.56684],[16.52885,46.53303],[16.52604,46.5051],[16.59527,46.47524],[16.6639,46.45203],[16.7154,46.39523],[16.8541,46.36255],[16.8903,46.28122],[17.14592,46.16697],[17.35672,45.95209],[17.56821,45.93728],[17.66545,45.84207],[17.87377,45.78522],[17.99805,45.79671],[18.08869,45.76511],[18.12439,45.78905],[18.44368,45.73972],[18.57483,45.80772],[18.6792,45.92057],[18.80211,45.87995],[18.81394,45.91329],[18.99712,45.93537],[19.01284,45.96529],[19.0791,45.96458],[19.10388,46.04015],[19.14543,45.9998],[19.28826,45.99694],[19.52473,46.1171],[19.56113,46.16824],[19.66007,46.19005],[19.81491,46.1313],[19.93508,46.17553],[20.01816,46.17696],[20.03533,46.14509],[20.09713,46.17315],[20.26068,46.12332],[20.28324,46.1438],[20.35573,46.16629],[20.45377,46.14405],[20.49718,46.18721],[20.63863,46.12728],[20.76085,46.21002],[20.74574,46.25467],[20.86797,46.28884],[21.06572,46.24897],[21.16872,46.30118],[21.28061,46.44941],[21.26929,46.4993],[21.33214,46.63035],[21.43926,46.65109],[21.5151,46.72147],[21.48935,46.7577],[21.52028,46.84118],[21.59307,46.86935],[21.59581,46.91628],[21.68645,46.99595],[21.648,47.03902],[21.78395,47.11104],[21.94463,47.38046],[22.01055,47.37767],[22.03389,47.42508],[22.00917,47.50492],[22.31816,47.76126],[22.41979,47.7391],[22.46559,47.76583],[22.67247,47.7871],[22.76617,47.8417],[22.77991,47.87211],[22.89849,47.95851],[22.84276,47.98602],[22.87847,48.04665],[22.81804,48.11363],[22.73427,48.12005],[22.66835,48.09162],[22.58733,48.10813],[22.59007,48.15121],[22.49806,48.25189],[22.38133,48.23726],[22.2083,48.42534],[22.14689,48.4005],[21.83339,48.36242],[21.8279,48.33321],[21.72525,48.34628]]]]}},{type:"Feature",properties:{iso1A2:"IC",wikidata:"Q5813",nameEn:"Canary Islands",country:"ES",groups:["Q3320166","Q105472","EU","039","150","UN"],isoStatus:"excRes",callingCodes:["34"]},geometry:{type:"MultiPolygon",coordinates:[[[[-12.00985,30.24121],[-25.3475,27.87574],[-14.43883,27.02969],[-12.00985,30.24121]]]]}},{type:"Feature",properties:{iso1A2:"ID",iso1A3:"IDN",iso1N3:"360",wikidata:"Q252",nameEn:"Indonesia",aliases:["RI"]},geometry:null},{type:"Feature",geometry:{type:"MultiPolygon",coordinates:[[[[-6.26218,54.09785],[-6.29003,54.11278],[-6.32694,54.09337],[-6.36279,54.11248],[-6.36605,54.07234],[-6.47849,54.06947],[-6.62842,54.03503],[-6.66264,54.0666],[-6.6382,54.17071],[-6.70175,54.20218],[-6.74575,54.18788],[-6.81583,54.22791],[-6.85179,54.29176],[-6.87775,54.34682],[-7.02034,54.4212],[-7.19145,54.31296],[-7.14908,54.22732],[-7.25012,54.20063],[-7.26316,54.13863],[-7.29493,54.12013],[-7.29687,54.1354],[-7.28017,54.16714],[-7.29157,54.17191],[-7.34005,54.14698],[-7.30553,54.11869],[-7.32834,54.11475],[-7.44567,54.1539],[-7.4799,54.12239],[-7.55812,54.12239],[-7.69501,54.20731],[-7.81397,54.20159],[-7.8596,54.21779],[-7.87101,54.29299],[-8.04555,54.36292],[-8.179,54.46763],[-8.04538,54.48941],[-7.99812,54.54427],[-7.8596,54.53671],[-7.70315,54.62077],[-7.93293,54.66603],[-7.83352,54.73854],[-7.75041,54.7103],[-7.64449,54.75265],[-7.54671,54.74606],[-7.54508,54.79401],[-7.47626,54.83084],[-7.4473,54.87003],[-7.44404,54.9403],[-7.40004,54.94498],[-7.4033,55.00391],[-7.34464,55.04688],[-7.2471,55.06933],[-6.34755,55.49206],[-7.75229,55.93854],[-11.75,54],[-11,51],[-6.03913,51.13217],[-5.37267,53.63269],[-6.26218,54.09785]]]]},properties:{iso1A2:"IE",iso1A3:"IRL",iso1N3:"372",wikidata:"Q27",nameEn:"Republic of Ireland",groups:["EU","Q22890","154","150","UN"],driveSide:"left",callingCodes:["353"]}},{type:"Feature",properties:{iso1A2:"IL",iso1A3:"ISR",iso1N3:"376",wikidata:"Q801",nameEn:"Israel",groups:["145","142","UN"],callingCodes:["972"]},geometry:{type:"MultiPolygon",coordinates:[[[[34.052,31.46619],[34.29262,31.70393],[34.48681,31.59711],[34.56797,31.54197],[34.48892,31.48365],[34.40077,31.40926],[34.36505,31.36404],[34.37381,31.30598],[34.36523,31.28963],[34.29417,31.24194],[34.26742,31.21998],[34.92298,29.45305],[34.97718,29.54294],[34.98207,29.58147],[35.02147,29.66343],[35.14108,30.07374],[35.19183,30.34636],[35.16218,30.43535],[35.19595,30.50297],[35.21379,30.60401],[35.29311,30.71365],[35.33456,30.81224],[35.33984,30.8802],[35.41371,30.95565],[35.43658,31.12444],[35.40316,31.25535],[35.47672,31.49578],[35.39675,31.49572],[35.22921,31.37445],[35.13033,31.3551],[35.02459,31.35979],[34.92571,31.34337],[34.88932,31.37093],[34.87833,31.39321],[34.89756,31.43891],[34.93258,31.47816],[34.94356,31.50743],[34.9415,31.55601],[34.95249,31.59813],[35.00879,31.65426],[35.08226,31.69107],[35.10782,31.71594],[35.11895,31.71454],[35.12933,31.7325],[35.13931,31.73012],[35.15119,31.73634],[35.15474,31.73352],[35.16478,31.73242],[35.18023,31.72067],[35.20538,31.72388],[35.21937,31.71578],[35.22392,31.71899],[35.23972,31.70896],[35.24315,31.71244],[35.2438,31.7201],[35.24981,31.72543],[35.25182,31.73945],[35.26319,31.74846],[35.25225,31.7678],[35.26058,31.79064],[35.25573,31.81362],[35.26404,31.82567],[35.251,31.83085],[35.25753,31.8387],[35.24816,31.8458],[35.2304,31.84222],[35.2249,31.85433],[35.22817,31.8638],[35.22567,31.86745],[35.22294,31.87889],[35.22014,31.88264],[35.2136,31.88241],[35.21276,31.88153],[35.21016,31.88237],[35.20945,31.8815],[35.20791,31.8821],[35.20673,31.88151],[35.20381,31.86716],[35.21128,31.863],[35.216,31.83894],[35.21469,31.81835],[35.19461,31.82687],[35.18169,31.82542],[35.18603,31.80901],[35.14174,31.81325],[35.07677,31.85627],[35.05617,31.85685],[35.01978,31.82944],[34.9724,31.83352],[34.99712,31.85569],[35.03489,31.85919],[35.03978,31.89276],[35.03489,31.92448],[35.00124,31.93264],[34.98682,31.96935],[35.00261,32.027],[34.9863,32.09551],[34.99437,32.10962],[34.98507,32.12606],[34.99039,32.14626],[34.96009,32.17503],[34.95703,32.19522],[34.98885,32.20758],[35.01841,32.23981],[35.02939,32.2671],[35.01119,32.28684],[35.01772,32.33863],[35.04243,32.35008],[35.05142,32.3667],[35.0421,32.38242],[35.05311,32.4024],[35.05423,32.41754],[35.07059,32.4585],[35.08564,32.46948],[35.09236,32.47614],[35.10024,32.47856],[35.10882,32.4757],[35.15937,32.50466],[35.2244,32.55289],[35.25049,32.52453],[35.29306,32.50947],[35.30685,32.51024],[35.35212,32.52047],[35.40224,32.50136],[35.42034,32.46009],[35.41598,32.45593],[35.41048,32.43706],[35.42078,32.41562],[35.55807,32.38674],[35.55494,32.42687],[35.57485,32.48669],[35.56614,32.64393],[35.59813,32.65159],[35.61669,32.67999],[35.66527,32.681],[35.68467,32.70715],[35.75983,32.74803],[35.78745,32.77938],[35.83758,32.82817],[35.84021,32.8725],[35.87012,32.91976],[35.89298,32.9456],[35.87188,32.98028],[35.84802,33.1031],[35.81911,33.11077],[35.81911,33.1336],[35.84285,33.16673],[35.83846,33.19397],[35.81647,33.2028],[35.81295,33.24841],[35.77513,33.27342],[35.813,33.3172],[35.77477,33.33609],[35.62019,33.27278],[35.62283,33.24226],[35.58502,33.26653],[35.58326,33.28381],[35.56523,33.28969],[35.55555,33.25844],[35.54544,33.25513],[35.54808,33.236],[35.5362,33.23196],[35.54228,33.19865],[35.52573,33.11921],[35.50335,33.114],[35.50272,33.09056],[35.448,33.09264],[35.43059,33.06659],[35.35223,33.05617],[35.31429,33.10515],[35.1924,33.08743],[35.10645,33.09318],[34.78515,33.20368],[33.62659,31.82938],[34.052,31.46619]]]]}},{type:"Feature",properties:{iso1A2:"IM",iso1A3:"IMN",iso1N3:"833",wikidata:"Q9676",nameEn:"Isle of Man",country:"GB",groups:["Q185086","154","150","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["44 01624","44 07624","44 07524","44 07924"]},geometry:{type:"MultiPolygon",coordinates:[[[[-3.98763,54.07351],[-4.1819,54.57861],[-5.6384,53.81157],[-3.98763,54.07351]]]]}},{type:"Feature",properties:{iso1A2:"IN",iso1A3:"IND",iso1N3:"356",wikidata:"Q668",nameEn:"India"},geometry:null},{type:"Feature",properties:{iso1A2:"IO",iso1A3:"IOT",iso1N3:"086",wikidata:"Q43448",nameEn:"British Indian Ocean Territory",country:"GB"},geometry:null},{type:"Feature",properties:{iso1A2:"IQ",iso1A3:"IRQ",iso1N3:"368",wikidata:"Q796",nameEn:"Iraq",groups:["145","142","UN"],callingCodes:["964"]},geometry:{type:"MultiPolygon",coordinates:[[[[42.78887,37.38615],[42.56725,37.14878],[42.35724,37.10998],[42.36697,37.0627],[41.81736,36.58782],[41.40058,36.52502],[41.28864,36.35368],[41.2564,36.06012],[41.37027,35.84095],[41.38184,35.62502],[41.26569,35.42708],[41.21654,35.1508],[41.2345,34.80049],[41.12388,34.65742],[40.97676,34.39788],[40.64314,34.31604],[38.79171,33.37328],[39.08202,32.50304],[38.98762,32.47694],[39.04251,32.30203],[39.26157,32.35555],[39.29903,32.23259],[40.01521,32.05667],[42.97601,30.72204],[42.97796,30.48295],[44.72255,29.19736],[46.42415,29.05947],[46.5527,29.10283],[46.89695,29.50584],[47.15166,30.01044],[47.37192,30.10421],[47.7095,30.10453],[48.01114,29.98906],[48.06782,30.02906],[48.17332,30.02448],[48.40479,29.85763],[48.59531,29.66815],[48.83867,29.78572],[48.61441,29.93675],[48.51011,29.96238],[48.44785,30.00148],[48.4494,30.04456],[48.43384,30.08233],[48.38869,30.11062],[48.38714,30.13485],[48.41671,30.17254],[48.41117,30.19846],[48.26393,30.3408],[48.24385,30.33846],[48.21279,30.31644],[48.19425,30.32796],[48.18321,30.39703],[48.14585,30.44133],[48.02443,30.4789],[48.03221,30.9967],[47.68219,31.00004],[47.6804,31.39086],[47.86337,31.78422],[47.64771,32.07666],[47.52474,32.15972],[47.57144,32.20583],[47.37529,32.47808],[47.17218,32.45393],[46.46788,32.91992],[46.32298,32.9731],[46.17198,32.95612],[46.09103,32.98354],[46.15175,33.07229],[46.03966,33.09577],[46.05367,33.13097],[46.11905,33.11924],[46.20623,33.20395],[45.99919,33.5082],[45.86687,33.49263],[45.96183,33.55751],[45.89801,33.63661],[45.77814,33.60938],[45.50261,33.94968],[45.42789,33.9458],[45.41077,33.97421],[45.47264,34.03099],[45.56176,34.15088],[45.58667,34.30147],[45.53552,34.35148],[45.49171,34.3439],[45.46697,34.38221],[45.43879,34.45949],[45.51883,34.47692],[45.53219,34.60441],[45.59074,34.55558],[45.60224,34.55057],[45.73923,34.54416],[45.70031,34.69277],[45.65672,34.7222],[45.68284,34.76624],[45.70031,34.82322],[45.73641,34.83975],[45.79682,34.85133],[45.78904,34.91135],[45.86532,34.89858],[45.89477,34.95805],[45.87864,35.03441],[45.92173,35.0465],[45.92203,35.09538],[45.93108,35.08148],[45.94756,35.09188],[46.06508,35.03699],[46.07747,35.0838],[46.11763,35.07551],[46.19116,35.11097],[46.15642,35.1268],[46.16229,35.16984],[46.19738,35.18536],[46.18457,35.22561],[46.11367,35.23729],[46.15474,35.2883],[46.13152,35.32548],[46.05358,35.38568],[45.98453,35.49848],[46.01518,35.52012],[45.97584,35.58132],[46.03028,35.57416],[46.01307,35.59756],[46.0165,35.61501],[45.99452,35.63574],[46.0117,35.65059],[46.01631,35.69139],[46.23736,35.71414],[46.34166,35.78363],[46.32921,35.82655],[46.17198,35.8013],[46.08325,35.8581],[45.94711,35.82218],[45.89784,35.83708],[45.81442,35.82107],[45.76145,35.79898],[45.6645,35.92872],[45.60018,35.96069],[45.55245,35.99943],[45.46594,36.00042],[45.38275,35.97156],[45.33916,35.99424],[45.37652,36.06222],[45.37312,36.09917],[45.32235,36.17383],[45.30038,36.27769],[45.26261,36.3001],[45.27394,36.35846],[45.23953,36.43257],[45.11811,36.40751],[45.00759,36.5402],[45.06985,36.62645],[45.06985,36.6814],[45.01537,36.75128],[44.84725,36.77622],[44.83479,36.81362],[44.90173,36.86096],[44.91199,36.91468],[44.89862,37.01897],[44.81611,37.04383],[44.75229,37.11958],[44.78319,37.1431],[44.76698,37.16162],[44.63179,37.19229],[44.42631,37.05825],[44.38117,37.05825],[44.35315,37.04955],[44.35937,37.02843],[44.30645,36.97373],[44.25975,36.98119],[44.18503,37.09551],[44.22239,37.15756],[44.27998,37.16501],[44.2613,37.25055],[44.13521,37.32486],[44.02002,37.33229],[43.90949,37.22453],[43.84878,37.22205],[43.82699,37.19477],[43.8052,37.22825],[43.7009,37.23692],[43.63085,37.21957],[43.56702,37.25675],[43.50787,37.24436],[43.33508,37.33105],[43.30083,37.30629],[43.11403,37.37436],[42.93705,37.32015],[42.78887,37.38615]]]]}},{type:"Feature",properties:{iso1A2:"IR",iso1A3:"IRN",iso1N3:"364",wikidata:"Q794",nameEn:"Iran",groups:["034","142","UN"],callingCodes:["98"]},geometry:{type:"MultiPolygon",coordinates:[[[[44.96746,39.42998],[44.88916,39.59653],[44.81043,39.62677],[44.71806,39.71124],[44.65422,39.72163],[44.6137,39.78393],[44.47298,39.68788],[44.48111,39.61579],[44.41849,39.56659],[44.42832,39.4131],[44.37921,39.4131],[44.29818,39.378],[44.22452,39.4169],[44.03667,39.39223],[44.1043,39.19842],[44.20946,39.13975],[44.18863,38.93881],[44.30322,38.81581],[44.26155,38.71427],[44.28065,38.6465],[44.32058,38.62752],[44.3207,38.49799],[44.3119,38.37887],[44.38309,38.36117],[44.44386,38.38295],[44.50115,38.33939],[44.42476,38.25763],[44.22509,37.88859],[44.3883,37.85433],[44.45948,37.77065],[44.55498,37.783],[44.62096,37.71985],[44.56887,37.6429],[44.61401,37.60165],[44.58449,37.45018],[44.81021,37.2915],[44.75986,37.21549],[44.7868,37.16644],[44.78319,37.1431],[44.75229,37.11958],[44.81611,37.04383],[44.89862,37.01897],[44.91199,36.91468],[44.90173,36.86096],[44.83479,36.81362],[44.84725,36.77622],[45.01537,36.75128],[45.06985,36.6814],[45.06985,36.62645],[45.00759,36.5402],[45.11811,36.40751],[45.23953,36.43257],[45.27394,36.35846],[45.26261,36.3001],[45.30038,36.27769],[45.32235,36.17383],[45.37312,36.09917],[45.37652,36.06222],[45.33916,35.99424],[45.38275,35.97156],[45.46594,36.00042],[45.55245,35.99943],[45.60018,35.96069],[45.6645,35.92872],[45.76145,35.79898],[45.81442,35.82107],[45.89784,35.83708],[45.94711,35.82218],[46.08325,35.8581],[46.17198,35.8013],[46.32921,35.82655],[46.34166,35.78363],[46.23736,35.71414],[46.01631,35.69139],[46.0117,35.65059],[45.99452,35.63574],[46.0165,35.61501],[46.01307,35.59756],[46.03028,35.57416],[45.97584,35.58132],[46.01518,35.52012],[45.98453,35.49848],[46.05358,35.38568],[46.13152,35.32548],[46.15474,35.2883],[46.11367,35.23729],[46.18457,35.22561],[46.19738,35.18536],[46.16229,35.16984],[46.15642,35.1268],[46.19116,35.11097],[46.11763,35.07551],[46.07747,35.0838],[46.06508,35.03699],[45.94756,35.09188],[45.93108,35.08148],[45.92203,35.09538],[45.92173,35.0465],[45.87864,35.03441],[45.89477,34.95805],[45.86532,34.89858],[45.78904,34.91135],[45.79682,34.85133],[45.73641,34.83975],[45.70031,34.82322],[45.68284,34.76624],[45.65672,34.7222],[45.70031,34.69277],[45.73923,34.54416],[45.60224,34.55057],[45.59074,34.55558],[45.53219,34.60441],[45.51883,34.47692],[45.43879,34.45949],[45.46697,34.38221],[45.49171,34.3439],[45.53552,34.35148],[45.58667,34.30147],[45.56176,34.15088],[45.47264,34.03099],[45.41077,33.97421],[45.42789,33.9458],[45.50261,33.94968],[45.77814,33.60938],[45.89801,33.63661],[45.96183,33.55751],[45.86687,33.49263],[45.99919,33.5082],[46.20623,33.20395],[46.11905,33.11924],[46.05367,33.13097],[46.03966,33.09577],[46.15175,33.07229],[46.09103,32.98354],[46.17198,32.95612],[46.32298,32.9731],[46.46788,32.91992],[47.17218,32.45393],[47.37529,32.47808],[47.57144,32.20583],[47.52474,32.15972],[47.64771,32.07666],[47.86337,31.78422],[47.6804,31.39086],[47.68219,31.00004],[48.03221,30.9967],[48.02443,30.4789],[48.14585,30.44133],[48.18321,30.39703],[48.19425,30.32796],[48.21279,30.31644],[48.24385,30.33846],[48.26393,30.3408],[48.41117,30.19846],[48.41671,30.17254],[48.38714,30.13485],[48.38869,30.11062],[48.43384,30.08233],[48.4494,30.04456],[48.44785,30.00148],[48.51011,29.96238],[48.61441,29.93675],[48.83867,29.78572],[49.98877,27.87827],[50.37726,27.89227],[54.39838,25.68383],[55.14145,25.62624],[55.81777,26.18798],[56.2644,26.58649],[56.68954,26.76645],[56.79239,26.41236],[56.82555,25.7713],[56.86325,25.03856],[61.46682,24.57869],[61.6433,25.27541],[61.683,25.66638],[61.83968,25.7538],[61.83831,26.07249],[61.89391,26.26251],[62.05117,26.31647],[62.21304,26.26601],[62.31484,26.528],[62.77352,26.64099],[63.1889,26.65072],[63.18688,26.83844],[63.25005,26.84212],[63.25005,27.08692],[63.32283,27.14437],[63.19649,27.25674],[62.80604,27.22412],[62.79684,27.34381],[62.84905,27.47627],[62.7638,28.02992],[62.79412,28.28108],[62.59499,28.24842],[62.40259,28.42703],[61.93581,28.55284],[61.65978,28.77937],[61.53765,29.00507],[61.31508,29.38903],[60.87231,29.86514],[61.80829,30.84224],[61.78268,30.92724],[61.8335,30.97669],[61.83257,31.0452],[61.80957,31.12576],[61.80569,31.16167],[61.70929,31.37391],[60.84541,31.49561],[60.86191,32.22565],[60.56485,33.12944],[60.88908,33.50219],[60.91133,33.55596],[60.69573,33.56054],[60.57762,33.59772],[60.5485,33.73422],[60.5838,33.80793],[60.50209,34.13992],[60.66502,34.31539],[60.91321,34.30411],[60.72316,34.52857],[60.99922,34.63064],[61.00197,34.70631],[61.06926,34.82139],[61.12831,35.09938],[61.0991,35.27845],[61.18187,35.30249],[61.27371,35.61482],[61.22719,35.67038],[61.26152,35.80749],[61.22444,35.92879],[61.12007,35.95992],[61.22719,36.12759],[61.1393,36.38782],[61.18187,36.55348],[61.14516,36.64644],[60.34767,36.63214],[60.00768,37.04102],[59.74678,37.12499],[59.55178,37.13594],[59.39385,37.34257],[59.39797,37.47892],[59.33507,37.53146],[59.22905,37.51161],[58.9338,37.67374],[58.6921,37.64548],[58.5479,37.70526],[58.47786,37.6433],[58.39959,37.63134],[58.22999,37.6856],[58.21399,37.77281],[57.79534,37.89299],[57.35042,37.98546],[57.37236,38.09321],[57.21169,38.28965],[57.03453,38.18717],[56.73928,38.27887],[56.62255,38.24005],[56.43303,38.26054],[56.32454,38.18502],[56.33278,38.08132],[55.97847,38.08024],[55.76561,38.12238],[55.44152,38.08564],[55.13412,37.94705],[54.851,37.75739],[54.77684,37.62264],[54.81804,37.61285],[54.77822,37.51597],[54.67247,37.43532],[54.58664,37.45809],[54.36211,37.34912],[54.24565,37.32047],[53.89734,37.3464],[48.88288,38.43975],[48.84969,38.45015],[48.81072,38.44853],[48.78979,38.45026],[48.70001,38.40564],[48.62217,38.40198],[48.58793,38.45076],[48.45084,38.61013],[48.3146,38.59958],[48.24773,38.71883],[48.02581,38.82705],[48.01409,38.90333],[48.07734,38.91616],[48.08627,38.94434],[48.28437,38.97186],[48.33884,39.03022],[48.31239,39.09278],[48.15361,39.19419],[48.12404,39.25208],[48.15984,39.30028],[48.37385,39.37584],[48.34264,39.42935],[47.98977,39.70999],[47.84774,39.66285],[47.50099,39.49615],[47.38978,39.45999],[47.31301,39.37492],[47.05927,39.24846],[47.05771,39.20143],[46.95341,39.13505],[46.92539,39.16644],[46.83822,39.13143],[46.75752,39.03231],[46.53497,38.86548],[46.34059,38.92076],[46.20601,38.85262],[46.14785,38.84206],[46.06766,38.87861],[46.00228,38.87376],[45.94624,38.89072],[45.90266,38.87739],[45.83883,38.90768],[45.65172,38.95199],[45.6155,38.94304],[45.6131,38.964],[45.44966,38.99243],[45.44811,39.04927],[45.40452,39.07224],[45.40148,39.09007],[45.30489,39.18333],[45.16168,39.21952],[45.08751,39.35052],[45.05932,39.36435],[44.96746,39.42998]]]]}},{type:"Feature",properties:{iso1A2:"IS",iso1A3:"ISL",iso1N3:"352",wikidata:"Q189",nameEn:"Iceland",groups:["154","150","UN"],callingCodes:["354"]},geometry:{type:"MultiPolygon",coordinates:[[[[-33.15676,62.62995],[-8.25539,63.0423],[-15.70914,69.67442],[-33.15676,62.62995]]]]}},{type:"Feature",properties:{iso1A2:"IT",iso1A3:"ITA",iso1N3:"380",wikidata:"Q38",nameEn:"Italy",groups:["EU","039","150","UN"],callingCodes:["39"]},geometry:{type:"MultiPolygon",coordinates:[[[[8.95861,45.96485],[8.97604,45.96151],[8.97741,45.98317],[8.96668,45.98436],[8.95861,45.96485]]],[[[7.63035,43.57419],[9.56115,43.20816],[10.09675,41.44089],[7.60802,41.05927],[7.89009,38.19924],[11.2718,37.6713],[12.13667,34.20326],[14.02721,36.53141],[17.67657,35.68918],[18.83516,40.36999],[16.15283,42.18525],[13.12821,44.48877],[13.05142,45.33128],[13.45644,45.59464],[13.6076,45.64761],[13.7198,45.59352],[13.74587,45.59811],[13.78445,45.5825],[13.84106,45.58185],[13.86771,45.59898],[13.8695,45.60835],[13.9191,45.6322],[13.87933,45.65207],[13.83422,45.68703],[13.83332,45.70855],[13.8235,45.7176],[13.66986,45.79955],[13.59784,45.8072],[13.58858,45.83503],[13.57563,45.8425],[13.58644,45.88173],[13.59565,45.89446],[13.60857,45.89907],[13.61931,45.91782],[13.63815,45.93607],[13.6329,45.94894],[13.64307,45.98326],[13.63458,45.98947],[13.62074,45.98388],[13.58903,45.99009],[13.56759,45.96991],[13.52963,45.96588],[13.50104,45.98078],[13.47474,46.00546],[13.49702,46.01832],[13.50998,46.04498],[13.49568,46.04839],[13.50104,46.05986],[13.57072,46.09022],[13.64053,46.13587],[13.66472,46.17392],[13.64451,46.18966],[13.56682,46.18703],[13.56114,46.2054],[13.47587,46.22725],[13.42218,46.20758],[13.37671,46.29668],[13.44808,46.33507],[13.43418,46.35992],[13.47019,46.3621],[13.5763,46.40915],[13.5763,46.42613],[13.59777,46.44137],[13.68684,46.43881],[13.7148,46.5222],[13.64088,46.53438],[13.27627,46.56059],[12.94445,46.60401],[12.59992,46.6595],[12.38708,46.71529],[12.27591,46.88651],[12.2006,46.88854],[12.11675,47.01241],[12.21781,47.03996],[12.19254,47.09331],[11.74789,46.98484],[11.50739,47.00644],[11.33355,46.99862],[11.10618,46.92966],[11.00764,46.76896],[10.72974,46.78972],[10.75753,46.82258],[10.66405,46.87614],[10.54783,46.84505],[10.47197,46.85698],[10.38659,46.67847],[10.40475,46.63671],[10.44686,46.64162],[10.49375,46.62049],[10.46136,46.53164],[10.25309,46.57432],[10.23674,46.63484],[10.10307,46.61003],[10.03715,46.44479],[10.165,46.41051],[10.10506,46.3372],[10.17862,46.25626],[10.14439,46.22992],[10.07055,46.21668],[9.95249,46.38045],[9.73086,46.35071],[9.71273,46.29266],[9.57015,46.2958],[9.46117,46.37481],[9.45936,46.50873],[9.40487,46.46621],[9.36128,46.5081],[9.28136,46.49685],[9.25502,46.43743],[9.29226,46.32717],[9.24503,46.23616],[9.01618,46.04928],[8.99257,45.9698],[9.09065,45.89906],[9.06642,45.8761],[9.04546,45.84968],[9.04059,45.8464],[9.03505,45.83976],[9.03793,45.83548],[9.03279,45.82865],[9.0298,45.82127],[9.00324,45.82055],[8.99663,45.83466],[8.9621,45.83707],[8.94737,45.84285],[8.91129,45.8388],[8.93504,45.86245],[8.94372,45.86587],[8.93649,45.86775],[8.88904,45.95465],[8.86688,45.96135],[8.85121,45.97239],[8.8319,45.9879],[8.79362,45.99207],[8.78585,45.98973],[8.79414,46.00913],[8.85617,46.0748],[8.80778,46.10085],[8.75697,46.10395],[8.62242,46.12112],[8.45032,46.26869],[8.46317,46.43712],[8.42464,46.46367],[8.30648,46.41587],[8.31162,46.38044],[8.08814,46.26692],[8.16866,46.17817],[8.11383,46.11577],[8.02906,46.10331],[7.98881,45.99867],[7.9049,45.99945],[7.85949,45.91485],[7.56343,45.97421],[7.10685,45.85653],[7.04151,45.92435],[6.95315,45.85163],[6.80785,45.83265],[6.80785,45.71864],[6.98948,45.63869],[7.00037,45.509],[7.18019,45.40071],[7.10572,45.32924],[7.13115,45.25386],[7.07074,45.21228],[6.96706,45.20841],[6.85144,45.13226],[6.7697,45.16044],[6.62803,45.11175],[6.66981,45.02324],[6.74791,45.01939],[6.74519,44.93661],[6.75518,44.89915],[6.90774,44.84322],[6.93499,44.8664],[7.02217,44.82519],[7.00401,44.78782],[7.07484,44.68073],[7.00582,44.69364],[6.95133,44.66264],[6.96042,44.62129],[6.85507,44.53072],[6.86233,44.49834],[6.94504,44.43112],[6.88784,44.42043],[6.89171,44.36637],[6.98221,44.28289],[7.00764,44.23736],[7.16929,44.20352],[7.27827,44.1462],[7.34547,44.14359],[7.36364,44.11882],[7.62155,44.14881],[7.63245,44.17877],[7.68694,44.17487],[7.66878,44.12795],[7.72508,44.07578],[7.6597,44.03009],[7.66848,43.99943],[7.65266,43.9763],[7.60771,43.95772],[7.56858,43.94506],[7.56075,43.89932],[7.51162,43.88301],[7.49355,43.86551],[7.50423,43.84345],[7.53006,43.78405],[7.63035,43.57419]],[[12.45181,41.90056],[12.44834,41.90095],[12.44582,41.90194],[12.44815,41.90326],[12.44984,41.90545],[12.45091,41.90625],[12.45543,41.90738],[12.45561,41.90629],[12.45762,41.9058],[12.45755,41.9033],[12.45826,41.90281],[12.45834,41.90174],[12.4577,41.90115],[12.45691,41.90125],[12.45626,41.90172],[12.45435,41.90143],[12.45446,41.90028],[12.45181,41.90056]],[[12.45648,43.89369],[12.44184,43.90498],[12.41641,43.89991],[12.40935,43.9024],[12.41233,43.90956],[12.40733,43.92379],[12.41551,43.92984],[12.41165,43.93769],[12.40506,43.94325],[12.40415,43.95485],[12.41414,43.95273],[12.42005,43.9578],[12.43662,43.95698],[12.44684,43.96597],[12.46205,43.97463],[12.47853,43.98052],[12.49406,43.98492],[12.50678,43.99113],[12.51463,43.99122],[12.5154,43.98508],[12.51064,43.98165],[12.51109,43.97201],[12.50622,43.97131],[12.50875,43.96198],[12.50655,43.95796],[12.51427,43.94897],[12.51553,43.94096],[12.50496,43.93017],[12.50269,43.92363],[12.49724,43.92248],[12.49247,43.91774],[12.49429,43.90973],[12.48771,43.89706],[12.45648,43.89369]]]]}},{type:"Feature",properties:{iso1A2:"JE",iso1A3:"JEY",iso1N3:"832",wikidata:"Q785",nameEn:"Bailiwick of Jersey",country:"GB",groups:["830","Q185086","154","150","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["44 01534"]},geometry:{type:"MultiPolygon",coordinates:[[[[-2.00491,48.86706],[-1.83944,49.23037],[-2.09454,49.46288],[-2.65349,49.15373],[-2.00491,48.86706]]]]}},{type:"Feature",properties:{iso1A2:"JM",iso1A3:"JAM",iso1N3:"388",wikidata:"Q766",nameEn:"Jamaica",aliases:["JA"],groups:["029","003","419","019","UN"],driveSide:"left",callingCodes:["1 876","1 658"]},geometry:{type:"MultiPolygon",coordinates:[[[[-74.09729,17.36817],[-78.9741,19.59515],[-78.34606,16.57862],[-74.09729,17.36817]]]]}},{type:"Feature",properties:{iso1A2:"JO",iso1A3:"JOR",iso1N3:"400",wikidata:"Q810",nameEn:"Jordan",groups:["145","142","UN"],callingCodes:["962"]},geometry:{type:"MultiPolygon",coordinates:[[[[39.04251,32.30203],[38.98762,32.47694],[39.08202,32.50304],[38.79171,33.37328],[36.83946,32.31293],[36.40959,32.37908],[36.23948,32.50108],[36.20875,32.49529],[36.20379,32.52751],[36.08074,32.51463],[36.02239,32.65911],[35.96633,32.66237],[35.93307,32.71966],[35.88405,32.71321],[35.75983,32.74803],[35.68467,32.70715],[35.66527,32.681],[35.61669,32.67999],[35.59813,32.65159],[35.56614,32.64393],[35.57485,32.48669],[35.55494,32.42687],[35.55807,32.38674],[35.57111,32.21877],[35.52012,32.04076],[35.54375,31.96587],[35.52758,31.9131],[35.55941,31.76535],[35.47672,31.49578],[35.40316,31.25535],[35.43658,31.12444],[35.41371,30.95565],[35.33984,30.8802],[35.33456,30.81224],[35.29311,30.71365],[35.21379,30.60401],[35.19595,30.50297],[35.16218,30.43535],[35.19183,30.34636],[35.14108,30.07374],[35.02147,29.66343],[34.98207,29.58147],[34.97718,29.54294],[34.92298,29.45305],[34.8812,29.36878],[36.07081,29.18469],[36.50005,29.49696],[36.75083,29.86903],[37.4971,29.99949],[37.66395,30.33245],[37.99354,30.49998],[36.99791,31.50081],[38.99233,31.99721],[39.29903,32.23259],[39.26157,32.35555],[39.04251,32.30203]]]]}},{type:"Feature",properties:{iso1A2:"JP",iso1A3:"JPN",iso1N3:"392",wikidata:"Q17",nameEn:"Japan",groups:["030","142","UN"],driveSide:"left",callingCodes:["81"]},geometry:{type:"MultiPolygon",coordinates:[[[[145.82361,43.38904],[145.23667,43.76813],[145.82343,44.571],[140.9182,45.92937],[133.61399,37.41],[129.2669,34.87122],[122.26612,25.98197],[123.92912,17.8782],[155.16731,23.60141],[145.82361,43.38904]]]]}},{type:"Feature",properties:{iso1A2:"KE",iso1A3:"KEN",iso1N3:"404",wikidata:"Q114",nameEn:"Kenya",groups:["014","202","002","UN"],driveSide:"left",callingCodes:["254"]},geometry:{type:"MultiPolygon",coordinates:[[[[35.9419,4.61933],[35.51424,4.61643],[35.42366,4.76969],[35.47843,4.91872],[35.30992,4.90402],[35.34151,5.02364],[34.47601,4.72162],[33.9873,4.23316],[34.06046,4.15235],[34.15429,3.80464],[34.45815,3.67385],[34.44922,3.51627],[34.39112,3.48802],[34.41794,3.44342],[34.40006,3.37949],[34.45815,3.18319],[34.56242,3.11478],[34.60114,2.93034],[34.65774,2.8753],[34.73967,2.85447],[34.78137,2.76223],[34.77244,2.70272],[34.95267,2.47209],[34.90947,2.42447],[34.98692,1.97348],[34.9899,1.6668],[34.92734,1.56109],[34.87819,1.5596],[34.7918,1.36752],[34.82606,1.30944],[34.82606,1.26626],[34.80223,1.22754],[34.67562,1.21265],[34.58029,1.14712],[34.57427,1.09868],[34.52369,1.10692],[34.43349,.85254],[34.40041,.80266],[34.31516,.75693],[34.27345,.63182],[34.20196,.62289],[34.13493,.58118],[34.11408,.48884],[34.08727,.44713],[34.10067,.36372],[33.90936,.10581],[33.98449,-.13079],[33.9264,-.54188],[33.93107,-.99298],[34.02286,-1.00779],[34.03084,-1.05101],[34.0824,-1.02264],[37.67199,-3.06222],[37.71745,-3.304],[37.5903,-3.42735],[37.63099,-3.50723],[37.75036,-3.54243],[37.81321,-3.69179],[39.21631,-4.67835],[39.44306,-4.93877],[39.62121,-4.68136],[41.75542,-1.85308],[41.56362,-1.66375],[41.56,-1.59812],[41.00099,-.83068],[40.98767,2.82959],[41.31368,3.14314],[41.89488,3.97375],[41.1754,3.94079],[40.77498,4.27683],[39.86043,3.86974],[39.76808,3.67058],[39.58339,3.47434],[39.55132,3.39634],[39.51551,3.40895],[39.49444,3.45521],[39.19954,3.47834],[39.07736,3.5267],[38.91938,3.51198],[38.52336,3.62551],[38.45812,3.60445],[38.14168,3.62487],[37.07724,4.33503],[36.84474,4.44518],[36.03924,4.44406],[35.95449,4.53244],[35.9419,4.61933]]]]}},{type:"Feature",properties:{iso1A2:"KG",iso1A3:"KGZ",iso1N3:"417",wikidata:"Q813",nameEn:"Kyrgyzstan",groups:["143","142","UN"],callingCodes:["996"]},geometry:{type:"MultiPolygon",coordinates:[[[[74.88756,42.98612],[74.75,42.99029],[74.70331,43.02519],[74.64615,43.05881],[74.57491,43.13702],[74.22489,43.24657],[73.55634,43.03071],[73.50992,42.82356],[73.44393,42.43098],[71.88792,42.83578],[71.62405,42.76613],[71.53272,42.8014],[71.2724,42.77853],[71.22785,42.69248],[71.17807,42.67381],[71.15232,42.60486],[70.97717,42.50147],[70.85973,42.30188],[70.94483,42.26238],[71.13263,42.28356],[71.28719,42.18033],[70.69777,41.92554],[70.17682,41.5455],[70.48909,41.40335],[70.67586,41.47953],[70.78572,41.36419],[70.77885,41.24813],[70.86263,41.23833],[70.9615,41.16393],[71.02193,41.19494],[71.11806,41.15359],[71.25813,41.18796],[71.27187,41.11015],[71.34877,41.16807],[71.40198,41.09436],[71.46148,41.13958],[71.43814,41.19644],[71.46688,41.31883],[71.57227,41.29175],[71.6787,41.42111],[71.65914,41.49599],[71.73054,41.54713],[71.71132,41.43012],[71.76625,41.4466],[71.83914,41.3546],[71.91457,41.2982],[71.85964,41.19081],[72.07249,41.11739],[72.10745,41.15483],[72.16433,41.16483],[72.17594,41.15522],[72.14864,41.13363],[72.1792,41.10621],[72.21061,41.05607],[72.17594,41.02377],[72.18339,40.99571],[72.324,41.03381],[72.34026,41.04539],[72.34757,41.06104],[72.36138,41.04384],[72.38511,41.02785],[72.45206,41.03018],[72.48742,40.97136],[72.55109,40.96046],[72.59136,40.86947],[72.68157,40.84942],[72.84291,40.85512],[72.94454,40.8094],[73.01869,40.84681],[73.13267,40.83512],[73.13412,40.79122],[73.0612,40.76678],[72.99133,40.76457],[72.93296,40.73089],[72.8722,40.71111],[72.85372,40.7116],[72.84754,40.67229],[72.80137,40.67856],[72.74866,40.60873],[72.74894,40.59592],[72.75982,40.57273],[72.74862,40.57131],[72.74768,40.58051],[72.73995,40.58409],[72.69579,40.59778],[72.66713,40.59076],[72.66713,40.5219],[72.47795,40.5532],[72.40517,40.61917],[72.34406,40.60144],[72.41714,40.55736],[72.38384,40.51535],[72.41513,40.50856],[72.44191,40.48222],[72.40346,40.4007],[72.24368,40.46091],[72.18648,40.49893],[71.96401,40.31907],[72.05464,40.27586],[71.85002,40.25647],[71.82646,40.21872],[71.73054,40.14818],[71.71719,40.17886],[71.69621,40.18492],[71.70569,40.20391],[71.68386,40.26984],[71.61931,40.26775],[71.61725,40.20615],[71.51549,40.22986],[71.51215,40.26943],[71.4246,40.28619],[71.36663,40.31593],[71.13042,40.34106],[71.05901,40.28765],[70.95789,40.28761],[70.9818,40.22392],[70.80495,40.16813],[70.7928,40.12797],[70.65827,40.0981],[70.65946,39.9878],[70.58912,39.95211],[70.55033,39.96619],[70.47557,39.93216],[70.57384,39.99394],[70.58297,40.00891],[70.01283,40.23288],[69.67001,40.10639],[69.64704,40.12165],[69.57615,40.10524],[69.55555,40.12296],[69.53794,40.11833],[69.53855,40.0887],[69.5057,40.03277],[69.53615,39.93991],[69.43557,39.92877],[69.43134,39.98431],[69.35649,40.01994],[69.26938,39.8127],[69.3594,39.52516],[69.68677,39.59281],[69.87491,39.53882],[70.11111,39.58223],[70.2869,39.53141],[70.44757,39.60128],[70.64087,39.58792],[70.7854,39.38933],[71.06418,39.41586],[71.08752,39.50704],[71.49814,39.61397],[71.55856,39.57588],[71.5517,39.45722],[71.62688,39.44056],[71.76816,39.45456],[71.80164,39.40631],[71.7522,39.32031],[71.79202,39.27355],[71.90601,39.27674],[72.04059,39.36704],[72.09689,39.26823],[72.17242,39.2661],[72.23834,39.17248],[72.33173,39.33093],[72.62027,39.39696],[72.85934,39.35116],[73.18454,39.35536],[73.31912,39.38615],[73.45096,39.46677],[73.59831,39.46425],[73.87018,39.47879],[73.94683,39.60733],[73.92354,39.69565],[73.9051,39.75073],[73.83006,39.76136],[73.97049,40.04378],[74.25533,40.13191],[74.35063,40.09742],[74.69875,40.34668],[74.85996,40.32857],[74.78168,40.44886],[74.82013,40.52197],[75.08243,40.43945],[75.22834,40.45382],[75.5854,40.66874],[75.69663,40.28642],[75.91361,40.2948],[75.96168,40.38064],[76.33659,40.3482],[76.5261,40.46114],[76.75681,40.95354],[76.99302,41.0696],[77.28004,41.0033],[77.3693,41.0375],[77.52723,41.00227],[77.76206,41.01574],[77.81287,41.14307],[78.12873,41.23091],[78.15757,41.38565],[78.3732,41.39603],[79.92977,42.04113],[80.17842,42.03211],[80.17807,42.21166],[79.97364,42.42816],[79.52921,42.44778],[79.19763,42.804],[78.91502,42.76839],[78.48469,42.89649],[75.82823,42.94848],[75.72174,42.79672],[75.29966,42.86183],[75.22619,42.85528],[74.88756,42.98612]],[[70.74189,39.86319],[70.63105,39.77923],[70.59667,39.83542],[70.54998,39.85137],[70.52631,39.86989],[70.53651,39.89155],[70.74189,39.86319]],[[71.86463,39.98598],[71.84316,39.95582],[71.7504,39.93701],[71.71511,39.96348],[71.78838,40.01404],[71.86463,39.98598]],[[71.21139,40.03369],[71.1427,39.95026],[71.23067,39.93581],[71.16101,39.88423],[71.10531,39.91354],[71.04979,39.89808],[71.10501,39.95568],[71.09063,39.99],[71.11668,39.99291],[71.11037,40.01984],[71.01035,40.05481],[71.00236,40.18154],[71.06305,40.1771],[71.12218,40.03052],[71.21139,40.03369]]]]}},{type:"Feature",properties:{iso1A2:"KH",iso1A3:"KHM",iso1N3:"116",wikidata:"Q424",nameEn:"Cambodia",groups:["035","142","UN"],callingCodes:["855"]},geometry:{type:"MultiPolygon",coordinates:[[[[105.87328,11.55953],[105.81645,11.56876],[105.80867,11.60536],[105.8507,11.66635],[105.88962,11.67854],[105.95188,11.63738],[106.00792,11.7197],[106.02038,11.77457],[106.06708,11.77761],[106.13158,11.73283],[106.18539,11.75171],[106.26478,11.72122],[106.30525,11.67549],[106.37219,11.69836],[106.44691,11.66787],[106.45158,11.68616],[106.41577,11.76999],[106.44535,11.8279],[106.44068,11.86294],[106.4687,11.86751],[106.4111,11.97413],[106.70687,11.96956],[106.79405,12.0807],[106.92325,12.06548],[106.99953,12.08983],[107.15831,12.27547],[107.34511,12.33327],[107.42917,12.24657],[107.4463,12.29373],[107.55059,12.36824],[107.5755,12.52177],[107.55993,12.7982],[107.49611,12.88926],[107.49144,13.01215],[107.62843,13.3668],[107.61909,13.52577],[107.53503,13.73908],[107.45252,13.78897],[107.46498,13.91593],[107.44318,13.99751],[107.38247,13.99147],[107.35757,14.02319],[107.37158,14.07906],[107.33577,14.11832],[107.40427,14.24509],[107.39493,14.32655],[107.44941,14.41552],[107.48521,14.40346],[107.52569,14.54665],[107.52102,14.59034],[107.55371,14.628],[107.54361,14.69092],[107.47238,14.61523],[107.44435,14.52785],[107.37897,14.54443],[107.3276,14.58812],[107.29803,14.58963],[107.26534,14.54292],[107.256,14.48716],[107.21241,14.48716],[107.17038,14.41782],[107.09722,14.3937],[107.03962,14.45099],[107.04585,14.41782],[106.98825,14.36806],[106.9649,14.3198],[106.90574,14.33639],[106.8497,14.29416],[106.80767,14.31226],[106.73762,14.42687],[106.63333,14.44194],[106.59908,14.50977],[106.57106,14.50525],[106.54148,14.59565],[106.50723,14.58963],[106.45898,14.55045],[106.47766,14.50977],[106.43874,14.52032],[106.40916,14.45249],[106.32355,14.44043],[106.25194,14.48415],[106.21302,14.36203],[106.00131,14.36957],[105.99509,14.32734],[106.02311,14.30623],[106.04801,14.20363],[106.10872,14.18401],[106.11962,14.11307],[106.18656,14.06324],[106.16632,14.01794],[106.10094,13.98471],[106.10405,13.9137],[105.90791,13.92881],[105.78182,14.02247],[105.78338,14.08438],[105.5561,14.15684],[105.44869,14.10703],[105.36775,14.09948],[105.2759,14.17496],[105.20894,14.34967],[105.17748,14.34432],[105.14012,14.23873],[105.08408,14.20402],[105.02804,14.23722],[104.97667,14.38806],[104.69335,14.42726],[104.55014,14.36091],[104.27616,14.39861],[103.93836,14.3398],[103.70175,14.38052],[103.71109,14.4348],[103.53518,14.42575],[103.39353,14.35639],[103.16469,14.33075],[102.93275,14.19044],[102.91251,14.01531],[102.77864,13.93374],[102.72727,13.77806],[102.56848,13.69366],[102.5481,13.6589],[102.58635,13.6286],[102.62483,13.60883],[102.57573,13.60461],[102.5358,13.56933],[102.44601,13.5637],[102.36859,13.57488],[102.33828,13.55613],[102.361,13.50551],[102.35563,13.47307],[102.35692,13.38274],[102.34611,13.35618],[102.36001,13.31142],[102.36146,13.26006],[102.43422,13.09061],[102.46011,13.08057],[102.52275,12.99813],[102.48694,12.97537],[102.49335,12.92711],[102.53053,12.77506],[102.4994,12.71736],[102.51963,12.66117],[102.57567,12.65358],[102.7796,12.43781],[102.78116,12.40284],[102.73134,12.37091],[102.70176,12.1686],[102.77026,12.06815],[102.78427,11.98746],[102.83957,11.8519],[102.90973,11.75613],[102.91449,11.65512],[102.52395,11.25257],[102.47649,9.66162],[103.99198,10.48391],[104.43778,10.42386],[104.47963,10.43046],[104.49869,10.4057],[104.59018,10.53073],[104.87933,10.52833],[104.95094,10.64003],[105.09571,10.72722],[105.02722,10.89236],[105.08326,10.95656],[105.11449,10.96332],[105.34011,10.86179],[105.42884,10.96878],[105.50045,10.94586],[105.77751,11.03671],[105.86376,10.89839],[105.84603,10.85873],[105.93403,10.83853],[105.94535,10.9168],[106.06708,10.8098],[106.18539,10.79451],[106.14301,10.98176],[106.20095,10.97795],[106.1757,11.07301],[106.1527,11.10476],[106.10444,11.07879],[105.86782,11.28343],[105.88962,11.43605],[105.87328,11.55953]]]]}},{type:"Feature",properties:{iso1A2:"KI",iso1A3:"KIR",iso1N3:"296",wikidata:"Q710",nameEn:"Kiribati",groups:["057","009","UN"],driveSide:"left",callingCodes:["686"]},geometry:{type:"MultiPolygon",coordinates:[[[[169,3.9],[169,-3.5],[178,-3.5],[178,3.9],[169,3.9]]],[[[-161.06795,5.2462],[-158.12991,-1.86122],[-175.33482,-1.40631],[-175.31804,-7.54825],[-156.50903,-7.4975],[-156.48634,-15.52824],[-135.59706,-4.70473],[-161.06795,5.2462]]]]}},{type:"Feature",properties:{iso1A2:"KM",iso1A3:"COM",iso1N3:"174",wikidata:"Q970",nameEn:"Comoros",groups:["014","202","002","UN"],callingCodes:["269"]},geometry:{type:"MultiPolygon",coordinates:[[[[42.63904,-10.02522],[43.28731,-13.97126],[45.4971,-11.75965],[42.63904,-10.02522]]]]}},{type:"Feature",properties:{iso1A2:"KN",iso1A3:"KNA",iso1N3:"659",wikidata:"Q763",nameEn:"St. Kitts and Nevis",groups:["029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",callingCodes:["1 869"]},geometry:{type:"MultiPolygon",coordinates:[[[[-62.29333,17.43155],[-62.76692,17.64353],[-63.09677,17.21372],[-62.63813,16.65446],[-62.29333,17.43155]]]]}},{type:"Feature",properties:{iso1A2:"KP",iso1A3:"PRK",iso1N3:"408",wikidata:"Q423",nameEn:"North Korea",groups:["030","142","UN"],callingCodes:["850"]},geometry:{type:"MultiPolygon",coordinates:[[[[130.26095,42.9027],[130.09764,42.91425],[130.12957,42.98361],[129.96409,42.97306],[129.95082,43.01051],[129.8865,43.00395],[129.85261,42.96494],[129.83277,42.86746],[129.80719,42.79218],[129.7835,42.76521],[129.77183,42.69435],[129.75294,42.59409],[129.72541,42.43739],[129.60482,42.44461],[129.54701,42.37254],[129.42882,42.44702],[129.28541,42.41574],[129.22423,42.3553],[129.22285,42.26491],[129.15178,42.17224],[128.96068,42.06657],[128.94007,42.03537],[128.04487,42.01769],[128.15119,41.74568],[128.30716,41.60322],[128.20061,41.40895],[128.18546,41.41279],[128.12967,41.37931],[128.03311,41.39232],[128.02633,41.42103],[127.92943,41.44291],[127.29712,41.49473],[127.17841,41.59714],[126.90729,41.79955],[126.60631,41.65565],[126.53189,41.35206],[126.242,41.15454],[126.00335,40.92835],[125.76869,40.87908],[125.71172,40.85223],[124.86913,40.45387],[124.40719,40.13655],[124.38556,40.11047],[124.3322,40.05573],[124.37089,40.03004],[124.35029,39.95639],[124.23201,39.9248],[124.17532,39.8232],[123.90497,38.79949],[123.85601,37.49093],[124.67666,38.05679],[124.84224,37.977],[124.87921,37.80827],[125.06408,37.66334],[125.37112,37.62643],[125.81159,37.72949],[126.13074,37.70512],[126.18776,37.74728],[126.19097,37.81462],[126.24402,37.83113],[126.43239,37.84095],[126.46818,37.80873],[126.56709,37.76857],[126.59918,37.76364],[126.66067,37.7897],[126.68793,37.83728],[126.68793,37.9175],[126.67023,37.95852],[126.84961,38.0344],[126.88106,38.10246],[126.95887,38.1347],[126.95338,38.17735],[127.04479,38.25518],[127.15749,38.30722],[127.38727,38.33227],[127.49672,38.30647],[127.55013,38.32257],[128.02917,38.31861],[128.27652,38.41657],[128.31105,38.58462],[128.37487,38.62345],[128.65655,38.61914],[131.95041,41.5445],[130.65022,42.32281],[130.66367,42.38024],[130.64181,42.41422],[130.60805,42.4317],[130.56835,42.43281],[130.55143,42.52158],[130.50123,42.61636],[130.44361,42.54849],[130.41826,42.6011],[130.2385,42.71127],[130.23068,42.80125],[130.26095,42.9027]]]]}},{type:"Feature",properties:{iso1A2:"KR",iso1A3:"KOR",iso1N3:"410",wikidata:"Q884",nameEn:"South Korea",groups:["030","142","UN"],callingCodes:["82"]},geometry:{type:"MultiPolygon",coordinates:[[[[133.11729,37.53115],[128.65655,38.61914],[128.37487,38.62345],[128.31105,38.58462],[128.27652,38.41657],[128.02917,38.31861],[127.55013,38.32257],[127.49672,38.30647],[127.38727,38.33227],[127.15749,38.30722],[127.04479,38.25518],[126.95338,38.17735],[126.95887,38.1347],[126.88106,38.10246],[126.84961,38.0344],[126.67023,37.95852],[126.68793,37.9175],[126.68793,37.83728],[126.66067,37.7897],[126.59918,37.76364],[126.56709,37.76857],[126.46818,37.80873],[126.43239,37.84095],[126.24402,37.83113],[126.19097,37.81462],[126.18776,37.74728],[126.13074,37.70512],[125.81159,37.72949],[125.37112,37.62643],[125.06408,37.66334],[124.87921,37.80827],[124.84224,37.977],[124.67666,38.05679],[123.85601,37.49093],[122.80525,33.30571],[125.99728,32.63328],[129.2669,34.87122],[133.11729,37.53115]]]]}},{type:"Feature",properties:{iso1A2:"KW",iso1A3:"KWT",iso1N3:"414",wikidata:"Q817",nameEn:"Kuwait",groups:["145","142","UN"],callingCodes:["965"]},geometry:{type:"MultiPolygon",coordinates:[[[[49.00421,28.81495],[48.59531,29.66815],[48.40479,29.85763],[48.17332,30.02448],[48.06782,30.02906],[48.01114,29.98906],[47.7095,30.10453],[47.37192,30.10421],[47.15166,30.01044],[46.89695,29.50584],[46.5527,29.10283],[47.46202,29.0014],[47.58376,28.83382],[47.59863,28.66798],[47.70561,28.5221],[48.42991,28.53628],[49.00421,28.81495]]]]}},{type:"Feature",properties:{iso1A2:"KY",iso1A3:"CYM",iso1N3:"136",wikidata:"Q5785",nameEn:"Cayman Islands",country:"GB",groups:["BOTS","029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1 345"]},geometry:{type:"MultiPolygon",coordinates:[[[[-82.11509,19.60401],[-80.36068,18.11751],[-79.32727,20.06742],[-82.11509,19.60401]]]]}},{type:"Feature",properties:{iso1A2:"KZ",iso1A3:"KAZ",iso1N3:"398",wikidata:"Q232",nameEn:"Kazakhstan",groups:["143","142","UN"],callingCodes:["7"]},geometry:{type:"MultiPolygon",coordinates:[[[[68.90865,55.38148],[68.19206,55.18823],[68.26661,55.09226],[68.21308,54.98645],[65.20174,54.55216],[65.24663,54.35721],[65.11033,54.33028],[64.97216,54.4212],[63.97686,54.29763],[64.02715,54.22679],[63.91224,54.20013],[63.80604,54.27079],[62.58651,54.05871],[62.56876,53.94047],[62.45931,53.90737],[62.38535,54.03961],[62.00966,54.04134],[62.03913,53.94768],[61.65318,54.02445],[61.56941,53.95703],[61.47603,54.08048],[61.3706,54.08464],[61.26863,53.92797],[60.99796,53.93699],[61.14283,53.90063],[61.22574,53.80268],[60.90626,53.62937],[61.55706,53.57144],[61.57185,53.50112],[61.37957,53.45887],[61.29082,53.50992],[61.14291,53.41481],[61.19024,53.30536],[62.14574,53.09626],[62.12799,52.99133],[62.0422,52.96105],[61.23462,53.03227],[61.05842,52.92217],[60.71989,52.75923],[60.71693,52.66245],[60.84118,52.63912],[60.84709,52.52228],[60.98021,52.50068],[61.05417,52.35096],[60.78201,52.22067],[60.72581,52.15538],[60.48915,52.15175],[60.19925,51.99173],[59.99809,51.98263],[60.09867,51.87135],[60.50986,51.7964],[60.36787,51.66815],[60.5424,51.61675],[60.92401,51.61124],[60.95655,51.48615],[61.50677,51.40687],[61.55114,51.32746],[61.6813,51.25716],[61.56889,51.23679],[61.4431,50.80679],[60.81833,50.6629],[60.31914,50.67705],[60.17262,50.83312],[60.01288,50.8163],[59.81172,50.54451],[59.51886,50.49937],[59.48928,50.64216],[58.87974,50.70852],[58.3208,51.15151],[57.75578,51.13852],[57.74986,50.93017],[57.44221,50.88354],[57.17302,51.11253],[56.17906,50.93204],[56.11398,50.7471],[55.67774,50.54508],[54.72067,51.03261],[54.56685,51.01958],[54.71476,50.61214],[54.55797,50.52006],[54.41894,50.61214],[54.46331,50.85554],[54.12248,51.11542],[53.69299,51.23466],[53.46165,51.49445],[52.54329,51.48444],[52.36119,51.74161],[51.8246,51.67916],[51.77431,51.49536],[51.301,51.48799],[51.26254,51.68466],[50.59695,51.61859],[50.26859,51.28677],[49.97277,51.2405],[49.76866,51.11067],[49.39001,51.09396],[49.41959,50.85927],[49.12673,50.78639],[48.86936,50.61589],[48.57946,50.63278],[48.90782,50.02281],[48.68352,49.89546],[48.42564,49.82283],[48.24519,49.86099],[48.10044,50.09242],[47.58551,50.47867],[47.30448,50.30894],[47.34589,50.09308],[47.18319,49.93721],[46.9078,49.86707],[46.78398,49.34026],[47.04658,49.19834],[47.00857,49.04921],[46.78392,48.95352],[46.49011,48.43019],[47.11516,48.27188],[47.12107,47.83687],[47.38731,47.68176],[47.41689,47.83687],[47.64973,47.76559],[48.15348,47.74545],[48.45173,47.40818],[48.52326,47.4102],[49.01136,46.72716],[48.51142,46.69268],[48.54988,46.56267],[49.16518,46.38542],[49.32259,46.26944],[49.88945,46.04554],[49.2134,44.84989],[52.26048,41.69249],[52.47884,41.78034],[52.97575,42.1308],[54.20635,42.38477],[54.95182,41.92424],[55.45471,41.25609],[56.00314,41.32584],[55.97584,44.99322],[55.97584,44.99328],[55.97584,44.99338],[55.97584,44.99343],[55.97584,44.99348],[55.97584,44.99353],[55.97584,44.99359],[55.97584,44.99369],[55.97584,44.99374],[55.97584,44.99384],[55.97584,44.9939],[55.97584,44.994],[55.97584,44.99405],[55.97584,44.99415],[55.97584,44.99421],[55.97584,44.99426],[55.97584,44.99431],[55.97584,44.99436],[55.97584,44.99441],[55.97594,44.99446],[55.97605,44.99452],[55.97605,44.99457],[55.97605,44.99462],[55.97605,44.99467],[55.97605,44.99477],[55.97615,44.99477],[55.97615,44.99483],[55.97615,44.99493],[55.97615,44.99498],[55.97615,44.99503],[55.97615,44.99508],[55.97625,44.99514],[55.97636,44.99519],[55.97636,44.99524],[55.97646,44.99529],[55.97646,44.99534],[55.97656,44.99539],[55.97667,44.99545],[55.97677,44.9955],[55.97677,44.99555],[55.97677,44.9956],[55.97687,44.9956],[55.97698,44.99565],[55.97698,44.9957],[55.97708,44.99576],[55.97718,44.99581],[55.97729,44.99586],[55.97739,44.99586],[55.97739,44.99591],[55.97749,44.99591],[55.9776,44.99591],[55.9777,44.99596],[55.9777,44.99601],[55.9778,44.99607],[55.97791,44.99607],[55.97801,44.99607],[55.97801,44.99612],[55.97811,44.99617],[55.97822,44.99617],[55.97832,44.99622],[55.97842,44.99622],[58.59711,45.58671],[61.01475,44.41383],[62.01711,43.51008],[63.34656,43.64003],[64.53885,43.56941],[64.96464,43.74748],[65.18666,43.48835],[65.53277,43.31856],[65.85194,42.85481],[66.09482,42.93426],[66.00546,41.94455],[66.53302,41.87388],[66.69129,41.1311],[67.9644,41.14611],[67.98511,41.02794],[68.08273,41.08148],[68.1271,41.0324],[67.96736,40.83798],[68.49983,40.56437],[68.63,40.59358],[68.58444,40.91447],[68.49983,40.99669],[68.62221,41.03019],[68.65662,40.93861],[68.73945,40.96989],[68.7217,41.05025],[69.01308,41.22804],[69.05006,41.36183],[69.15137,41.43078],[69.17701,41.43769],[69.18528,41.45175],[69.20439,41.45391],[69.22671,41.46298],[69.23332,41.45847],[69.25059,41.46693],[69.29778,41.43673],[69.35554,41.47211],[69.37468,41.46555],[69.45081,41.46246],[69.39485,41.51518],[69.45751,41.56863],[69.49545,41.545],[70.94483,42.26238],[70.85973,42.30188],[70.97717,42.50147],[71.15232,42.60486],[71.17807,42.67381],[71.22785,42.69248],[71.2724,42.77853],[71.53272,42.8014],[71.62405,42.76613],[71.88792,42.83578],[73.44393,42.43098],[73.50992,42.82356],[73.55634,43.03071],[74.22489,43.24657],[74.57491,43.13702],[74.64615,43.05881],[74.70331,43.02519],[74.75,42.99029],[74.88756,42.98612],[75.22619,42.85528],[75.29966,42.86183],[75.72174,42.79672],[75.82823,42.94848],[78.48469,42.89649],[78.91502,42.76839],[79.19763,42.804],[79.52921,42.44778],[79.97364,42.42816],[80.17807,42.21166],[80.26841,42.23797],[80.16892,42.61137],[80.26886,42.8366],[80.38169,42.83142],[80.58999,42.9011],[80.3735,43.01557],[80.62913,43.141],[80.78817,43.14235],[80.77771,43.30065],[80.69718,43.32589],[80.75156,43.44948],[80.40031,44.10986],[80.40229,44.23319],[80.38384,44.63073],[79.8987,44.89957],[80.11169,45.03352],[81.73278,45.3504],[82.51374,45.1755],[82.58474,45.40027],[82.21792,45.56619],[83.04622,47.19053],[83.92184,46.98912],[84.73077,47.01394],[84.93995,46.87399],[85.22443,47.04816],[85.54294,47.06171],[85.69696,47.2898],[85.61067,47.49753],[85.5169,48.05493],[85.73581,48.3939],[86.38069,48.46064],[86.75343,48.70331],[86.73568,48.99918],[86.87238,49.12432],[87.28386,49.11626],[87.31465,49.23603],[87.03071,49.25142],[86.82606,49.51796],[86.61307,49.60239],[86.79056,49.74787],[86.63674,49.80136],[86.18709,49.50259],[85.24047,49.60239],[84.99198,50.06793],[84.29385,50.27257],[83.8442,50.87375],[83.14607,51.00796],[82.55443,50.75412],[81.94999,50.79307],[81.46581,50.77658],[81.41248,50.97524],[81.06091,50.94833],[81.16999,51.15662],[80.80318,51.28262],[80.44819,51.20855],[80.4127,50.95581],[80.08138,50.77658],[79.11255,52.01171],[77.90383,53.29807],[76.54243,53.99329],[76.44076,54.16017],[76.82266,54.1798],[76.91052,54.4677],[75.3668,54.07439],[75.43398,53.98652],[75.07405,53.80831],[73.39218,53.44623],[73.25412,53.61532],[73.68921,53.86522],[73.74778,54.07194],[73.37963,53.96132],[72.71026,54.1161],[72.43415,53.92685],[72.17477,54.36303],[71.96141,54.17736],[71.10379,54.13326],[71.08706,54.33376],[71.24185,54.64965],[71.08288,54.71253],[70.96009,55.10558],[70.76493,55.3027],[70.19179,55.1476],[69.74917,55.35545],[69.34224,55.36344],[68.90865,55.38148]]]]}},{type:"Feature",properties:{iso1A2:"LA",iso1A3:"LAO",iso1N3:"418",wikidata:"Q819",nameEn:"Laos",groups:["035","142","UN"],callingCodes:["856"]},geometry:{type:"MultiPolygon",coordinates:[[[[102.1245,22.43372],[102.03633,22.46164],[101.98487,22.42766],[101.91344,22.44417],[101.90714,22.38688],[101.86828,22.38397],[101.7685,22.50337],[101.68973,22.46843],[101.61306,22.27515],[101.56789,22.28876],[101.53638,22.24794],[101.60675,22.13513],[101.57525,22.13026],[101.62566,21.96574],[101.7791,21.83019],[101.74555,21.72852],[101.83257,21.61562],[101.80001,21.57461],[101.7475,21.5873],[101.7727,21.51794],[101.74224,21.48276],[101.74014,21.30967],[101.84412,21.25291],[101.83887,21.20983],[101.76745,21.21571],[101.79266,21.19025],[101.7622,21.14813],[101.70548,21.14911],[101.66977,21.20004],[101.60886,21.17947],[101.59491,21.18621],[101.6068,21.23329],[101.54563,21.25668],[101.29326,21.17254],[101.2229,21.23271],[101.26912,21.36482],[101.19349,21.41959],[101.2124,21.56422],[101.15156,21.56129],[101.16198,21.52808],[101.00234,21.39612],[100.80173,21.2934],[100.72716,21.31786],[100.63578,21.05639],[100.55281,21.02796],[100.50974,20.88574],[100.64628,20.88279],[100.60112,20.8347],[100.51079,20.82194],[100.36375,20.82783],[100.1957,20.68247],[100.08404,20.36626],[100.09999,20.31614],[100.09337,20.26293],[100.11785,20.24787],[100.1712,20.24324],[100.16668,20.2986],[100.22076,20.31598],[100.25769,20.3992],[100.33383,20.4028],[100.37439,20.35156],[100.41473,20.25625],[100.44992,20.23644],[100.4537,20.19971],[100.47567,20.19133],[100.51052,20.14928],[100.55218,20.17741],[100.58808,20.15791],[100.5094,19.87904],[100.398,19.75047],[100.49604,19.53504],[100.58219,19.49164],[100.64606,19.55884],[100.77231,19.48324],[100.90302,19.61901],[101.08928,19.59748],[101.26545,19.59242],[101.26991,19.48324],[101.21347,19.46223],[101.20604,19.35296],[101.24911,19.33334],[101.261,19.12717],[101.35606,19.04716],[101.25803,18.89545],[101.22832,18.73377],[101.27585,18.68875],[101.06047,18.43247],[101.18227,18.34367],[101.15108,18.25624],[101.19118,18.2125],[101.1793,18.0544],[101.02185,17.87637],[100.96541,17.57926],[101.15108,17.47586],[101.44667,17.7392],[101.72294,17.92867],[101.78087,18.07559],[101.88485,18.02474],[102.11359,18.21532],[102.45523,17.97106],[102.59234,17.96127],[102.60971,17.95411],[102.61432,17.92273],[102.5896,17.84889],[102.59485,17.83537],[102.68194,17.80151],[102.69946,17.81686],[102.67543,17.84529],[102.68538,17.86653],[102.75954,17.89561],[102.79044,17.93612],[102.81988,17.94233],[102.86323,17.97531],[102.95812,18.0054],[102.9912,17.9949],[103.01998,17.97095],[103.0566,18.00144],[103.07823,18.03833],[103.07343,18.12351],[103.1493,18.17799],[103.14994,18.23172],[103.17093,18.2618],[103.29757,18.30475],[103.23818,18.34875],[103.24779,18.37807],[103.30977,18.4341],[103.41044,18.4486],[103.47773,18.42841],[103.60957,18.40528],[103.699,18.34125],[103.82449,18.33979],[103.85642,18.28666],[103.93916,18.33914],[103.97725,18.33631],[104.06533,18.21656],[104.10927,18.10826],[104.21776,17.99335],[104.2757,17.86139],[104.35432,17.82871],[104.45404,17.66788],[104.69867,17.53038],[104.80061,17.39367],[104.80716,17.19025],[104.73712,17.01404],[104.7373,16.91125],[104.76442,16.84752],[104.7397,16.81005],[104.76099,16.69302],[104.73349,16.565],[104.88057,16.37311],[105.00262,16.25627],[105.06204,16.09792],[105.42001,16.00657],[105.38508,15.987],[105.34115,15.92737],[105.37959,15.84074],[105.42285,15.76971],[105.46573,15.74742],[105.61756,15.68792],[105.60446,15.53301],[105.58191,15.41031],[105.47635,15.3796],[105.4692,15.33709],[105.50662,15.32054],[105.58043,15.32724],[105.46661,15.13132],[105.61162,15.00037],[105.5121,14.80802],[105.53864,14.55731],[105.43783,14.43865],[105.20894,14.34967],[105.2759,14.17496],[105.36775,14.09948],[105.44869,14.10703],[105.5561,14.15684],[105.78338,14.08438],[105.78182,14.02247],[105.90791,13.92881],[106.10405,13.9137],[106.10094,13.98471],[106.16632,14.01794],[106.18656,14.06324],[106.11962,14.11307],[106.10872,14.18401],[106.04801,14.20363],[106.02311,14.30623],[105.99509,14.32734],[106.00131,14.36957],[106.21302,14.36203],[106.25194,14.48415],[106.32355,14.44043],[106.40916,14.45249],[106.43874,14.52032],[106.47766,14.50977],[106.45898,14.55045],[106.50723,14.58963],[106.54148,14.59565],[106.57106,14.50525],[106.59908,14.50977],[106.63333,14.44194],[106.73762,14.42687],[106.80767,14.31226],[106.8497,14.29416],[106.90574,14.33639],[106.9649,14.3198],[106.98825,14.36806],[107.04585,14.41782],[107.03962,14.45099],[107.09722,14.3937],[107.17038,14.41782],[107.21241,14.48716],[107.256,14.48716],[107.26534,14.54292],[107.29803,14.58963],[107.3276,14.58812],[107.37897,14.54443],[107.44435,14.52785],[107.47238,14.61523],[107.54361,14.69092],[107.51579,14.79282],[107.59285,14.87795],[107.48277,14.93751],[107.46516,15.00982],[107.61486,15.0566],[107.61926,15.13949],[107.58844,15.20111],[107.62587,15.2266],[107.60605,15.37524],[107.62367,15.42193],[107.53341,15.40496],[107.50699,15.48771],[107.3815,15.49832],[107.34408,15.62345],[107.27583,15.62769],[107.27143,15.71459],[107.21859,15.74638],[107.21419,15.83747],[107.34188,15.89464],[107.39471,15.88829],[107.46296,16.01106],[107.44975,16.08511],[107.33968,16.05549],[107.25822,16.13587],[107.14595,16.17816],[107.15035,16.26271],[107.09091,16.3092],[107.02597,16.31132],[106.97385,16.30204],[106.96638,16.34938],[106.88067,16.43594],[106.88727,16.52671],[106.84104,16.55415],[106.74418,16.41904],[106.65832,16.47816],[106.66052,16.56892],[106.61477,16.60713],[106.58267,16.6012],[106.59013,16.62259],[106.55485,16.68704],[106.55265,16.86831],[106.52183,16.87884],[106.51963,16.92097],[106.54824,16.92729],[106.55045,17.0031],[106.50862,16.9673],[106.43597,17.01362],[106.31929,17.20509],[106.29287,17.3018],[106.24444,17.24714],[106.18991,17.28227],[106.09019,17.36399],[105.85744,17.63221],[105.76612,17.67147],[105.60381,17.89356],[105.64784,17.96687],[105.46292,18.22008],[105.38366,18.15315],[105.15942,18.38691],[105.10408,18.43533],[105.1327,18.58355],[105.19654,18.64196],[105.12829,18.70453],[104.64617,18.85668],[104.5361,18.97747],[103.87125,19.31854],[104.06058,19.43484],[104.10832,19.51575],[104.05617,19.61743],[104.06498,19.66926],[104.23229,19.70242],[104.41281,19.70035],[104.53169,19.61743],[104.64837,19.62365],[104.68359,19.72729],[104.8355,19.80395],[104.8465,19.91783],[104.9874,20.09573],[104.91695,20.15567],[104.86852,20.14121],[104.61315,20.24452],[104.62195,20.36633],[104.72102,20.40554],[104.66158,20.47774],[104.47886,20.37459],[104.40621,20.3849],[104.38199,20.47155],[104.63957,20.6653],[104.27412,20.91433],[104.11121,20.96779],[103.98024,20.91531],[103.82282,20.8732],[103.73478,20.6669],[103.68633,20.66324],[103.45737,20.82382],[103.38032,20.79501],[103.21497,20.89832],[103.12055,20.89994],[103.03469,21.05821],[102.97745,21.05821],[102.89825,21.24707],[102.80794,21.25736],[102.88939,21.3107],[102.94223,21.46034],[102.86297,21.4255],[102.98846,21.58936],[102.97965,21.74076],[102.86077,21.71213],[102.85637,21.84501],[102.81894,21.83888],[102.82115,21.73667],[102.74189,21.66713],[102.67145,21.65894],[102.62301,21.91447],[102.49092,21.99002],[102.51734,22.02676],[102.18712,22.30403],[102.14099,22.40092],[102.1245,22.43372]]]]}},{type:"Feature",properties:{iso1A2:"LB",iso1A3:"LBN",iso1N3:"422",wikidata:"Q822",nameEn:"Lebanon",aliases:["RL"],groups:["145","142","UN"],callingCodes:["961"]},geometry:{type:"MultiPolygon",coordinates:[[[[35.94816,33.47886],[35.94465,33.52774],[36.05723,33.57904],[35.9341,33.6596],[36.06778,33.82927],[36.14517,33.85118],[36.3967,33.83365],[36.38263,33.86579],[36.28589,33.91981],[36.41078,34.05253],[36.50576,34.05982],[36.5128,34.09916],[36.62537,34.20251],[36.59195,34.2316],[36.58667,34.27667],[36.60778,34.31009],[36.56556,34.31881],[36.53039,34.3798],[36.55853,34.41609],[36.46179,34.46541],[36.4442,34.50165],[36.34745,34.5002],[36.3369,34.52629],[36.39846,34.55672],[36.41429,34.61175],[36.45299,34.59438],[36.46003,34.6378],[36.42941,34.62505],[36.35384,34.65447],[36.35135,34.68516],[36.32399,34.69334],[36.29165,34.62991],[35.98718,34.64977],[35.97386,34.63322],[35.48515,34.70851],[34.78515,33.20368],[35.10645,33.09318],[35.1924,33.08743],[35.31429,33.10515],[35.35223,33.05617],[35.43059,33.06659],[35.448,33.09264],[35.50272,33.09056],[35.50335,33.114],[35.52573,33.11921],[35.54228,33.19865],[35.5362,33.23196],[35.54808,33.236],[35.54544,33.25513],[35.55555,33.25844],[35.56523,33.28969],[35.58326,33.28381],[35.58502,33.26653],[35.62283,33.24226],[35.62019,33.27278],[35.77477,33.33609],[35.81324,33.36354],[35.82577,33.40479],[35.88668,33.43183],[35.94816,33.47886]]]]}},{type:"Feature",properties:{iso1A2:"LC",iso1A3:"LCA",iso1N3:"662",wikidata:"Q760",nameEn:"St. Lucia",aliases:["WL"],groups:["029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",callingCodes:["1 758"]},geometry:{type:"MultiPolygon",coordinates:[[[[-59.95997,14.20285],[-61.69315,14.26451],[-59.94058,12.34011],[-59.95997,14.20285]]]]}},{type:"Feature",properties:{iso1A2:"LI",iso1A3:"LIE",iso1N3:"438",wikidata:"Q347",nameEn:"Liechtenstein",aliases:["FL"],groups:["155","150","UN"],callingCodes:["423"]},geometry:{type:"MultiPolygon",coordinates:[[[[9.60717,47.06091],[9.61216,47.07732],[9.63395,47.08443],[9.62623,47.14685],[9.56539,47.17124],[9.58264,47.20673],[9.56981,47.21926],[9.55176,47.22585],[9.56766,47.24281],[9.53116,47.27029],[9.52406,47.24959],[9.50318,47.22153],[9.4891,47.19346],[9.48774,47.17402],[9.51044,47.13727],[9.52089,47.10019],[9.51362,47.08505],[9.47139,47.06402],[9.47548,47.05257],[9.54041,47.06495],[9.55721,47.04762],[9.60717,47.06091]]]]}},{type:"Feature",properties:{iso1A2:"LK",iso1A3:"LKA",iso1N3:"144",wikidata:"Q854",nameEn:"Sri Lanka",groups:["034","142","UN"],driveSide:"left",callingCodes:["94"]},geometry:{type:"MultiPolygon",coordinates:[[[[76.59015,5.591],[85.15017,5.21497],[80.48418,10.20786],[79.42124,9.80115],[79.50447,8.91876],[76.59015,5.591]]]]}},{type:"Feature",properties:{iso1A2:"LR",iso1A3:"LBR",iso1N3:"430",wikidata:"Q1014",nameEn:"Liberia",groups:["011","202","002","UN"],callingCodes:["231"]},geometry:{type:"MultiPolygon",coordinates:[[[[-8.47114,7.55676],[-8.55874,7.62525],[-8.55874,7.70167],[-8.67814,7.69428],[-8.72789,7.51429],[-8.8448,7.35149],[-8.85724,7.26019],[-8.93435,7.2824],[-9.09107,7.1985],[-9.18311,7.30461],[-9.20798,7.38109],[-9.305,7.42056],[-9.41943,7.41809],[-9.48161,7.37122],[-9.37465,7.62032],[-9.35724,7.74111],[-9.44928,7.9284],[-9.41445,8.02448],[-9.50898,8.18455],[-9.47415,8.35195],[-9.77763,8.54633],[-10.05873,8.42578],[-10.05375,8.50697],[-10.14579,8.52665],[-10.203,8.47991],[-10.27575,8.48711],[-10.30084,8.30008],[-10.31635,8.28554],[-10.29839,8.21283],[-10.35227,8.15223],[-10.45023,8.15627],[-10.51554,8.1393],[-10.57523,8.04829],[-10.60492,8.04072],[-10.60422,7.7739],[-11.29417,7.21576],[-11.4027,6.97746],[-11.50429,6.92704],[-12.15048,6.15992],[-7.52774,3.7105],[-7.53259,4.35145],[-7.59349,4.8909],[-7.53876,4.94294],[-7.55369,5.08667],[-7.48901,5.14118],[-7.46165,5.26256],[-7.36463,5.32944],[-7.43428,5.42355],[-7.37209,5.61173],[-7.43926,5.74787],[-7.43677,5.84687],[-7.46165,5.84934],[-7.48155,5.80974],[-7.67309,5.94337],[-7.70294,5.90625],[-7.78254,5.99037],[-7.79747,6.07696],[-7.8497,6.08932],[-7.83478,6.20309],[-7.90692,6.27728],[-8.00642,6.31684],[-8.17557,6.28222],[-8.3298,6.36381],[-8.38453,6.35887],[-8.45666,6.49977],[-8.48652,6.43797],[-8.59456,6.50612],[-8.31736,6.82837],[-8.29249,7.1691],[-8.37458,7.25794],[-8.41935,7.51203],[-8.47114,7.55676]]]]}},{type:"Feature",properties:{iso1A2:"LS",iso1A3:"LSO",iso1N3:"426",wikidata:"Q1013",nameEn:"Lesotho",groups:["018","202","002","UN"],driveSide:"left",callingCodes:["266"]},geometry:{type:"MultiPolygon",coordinates:[[[[29.33204,-29.45598],[29.44883,-29.3772],[29.40524,-29.21246],[28.68043,-28.58744],[28.65091,-28.57025],[28.40612,-28.6215],[28.30518,-28.69531],[28.2348,-28.69471],[28.1317,-28.7293],[28.02503,-28.85991],[27.98675,-28.8787],[27.9392,-28.84864],[27.88933,-28.88156],[27.8907,-28.91612],[27.75458,-28.89839],[27.55974,-29.18954],[27.5158,-29.2261],[27.54258,-29.25575],[27.48679,-29.29349],[27.45125,-29.29708],[27.47254,-29.31968],[27.4358,-29.33465],[27.33464,-29.48161],[27.01016,-29.65439],[27.09489,-29.72796],[27.22719,-30.00718],[27.29603,-30.05473],[27.32555,-30.14785],[27.40778,-30.14577],[27.37293,-30.19401],[27.36649,-30.27246],[27.38108,-30.33456],[27.45452,-30.32239],[27.56901,-30.42504],[27.56781,-30.44562],[27.62137,-30.50509],[27.6521,-30.51707],[27.67819,-30.53437],[27.69467,-30.55862],[27.74814,-30.60635],[28.12073,-30.68072],[28.2319,-30.28476],[28.399,-30.1592],[28.68627,-30.12885],[28.80222,-30.10579],[28.9338,-30.05072],[29.16548,-29.91706],[29.12553,-29.76266],[29.28545,-29.58456],[29.33204,-29.45598]]]]}},{type:"Feature",properties:{iso1A2:"LT",iso1A3:"LTU",iso1N3:"440",wikidata:"Q37",nameEn:"Lithuania",groups:["EU","154","150","UN"],callingCodes:["370"]},geometry:{type:"MultiPolygon",coordinates:[[[[24.89005,56.46666],[24.83686,56.41565],[24.70022,56.40483],[24.57353,56.31525],[24.58143,56.29125],[24.42746,56.26522],[24.32334,56.30226],[24.13139,56.24881],[24.02657,56.3231],[23.75726,56.37282],[23.49803,56.34307],[23.40486,56.37689],[23.31606,56.3827],[23.17312,56.36795],[23.09531,56.30511],[22.96988,56.41213],[22.83048,56.367],[22.69354,56.36284],[22.56441,56.39305],[22.3361,56.4016],[22.09728,56.42851],[22.00548,56.41508],[21.74558,56.33181],[21.57888,56.31406],[21.49736,56.29106],[21.24644,56.16917],[21.15016,56.07818],[20.68447,56.04073],[20.60454,55.40986],[20.95181,55.27994],[21.26425,55.24456],[21.35465,55.28427],[21.38446,55.29348],[21.46766,55.21115],[21.51095,55.18507],[21.55605,55.20311],[21.64954,55.1791],[21.85521,55.09493],[21.96505,55.07353],[21.99543,55.08691],[22.03984,55.07888],[22.02582,55.05078],[22.06087,55.02935],[22.11697,55.02131],[22.14267,55.05345],[22.31562,55.0655],[22.47688,55.04408],[22.58907,55.07085],[22.60075,55.01863],[22.65451,54.97037],[22.68723,54.9811],[22.76422,54.92521],[22.85083,54.88711],[22.87317,54.79492],[22.73631,54.72952],[22.73397,54.66604],[22.75467,54.6483],[22.74225,54.64339],[22.7522,54.63525],[22.68021,54.58486],[22.71293,54.56454],[22.67788,54.532],[22.70208,54.45312],[22.7253,54.41732],[22.79705,54.36264],[22.83756,54.40827],[23.00584,54.38514],[22.99649,54.35927],[23.05726,54.34565],[23.04323,54.31567],[23.104,54.29794],[23.13905,54.31567],[23.15526,54.31076],[23.15938,54.29894],[23.24656,54.25701],[23.3494,54.25155],[23.39525,54.21672],[23.42418,54.17911],[23.45223,54.17775],[23.49196,54.14764],[23.52702,54.04622],[23.48261,53.98855],[23.51284,53.95052],[23.61677,53.92691],[23.71726,53.93379],[23.80543,53.89558],[23.81309,53.94205],[23.95098,53.9613],[23.98837,53.92554],[24.19638,53.96405],[24.34128,53.90076],[24.44411,53.90076],[24.62275,54.00217],[24.69652,54.01901],[24.69185,53.96543],[24.74279,53.96663],[24.85311,54.02862],[24.77131,54.11091],[24.96894,54.17589],[24.991,54.14241],[25.0728,54.13419],[25.19199,54.219],[25.22705,54.26271],[25.35559,54.26544],[25.509,54.30267],[25.56823,54.25212],[25.51452,54.17799],[25.54724,54.14925],[25.64875,54.1259],[25.71084,54.16704],[25.78563,54.15747],[25.78553,54.23327],[25.68513,54.31727],[25.55425,54.31591],[25.5376,54.33158],[25.63371,54.42075],[25.62203,54.4656],[25.64813,54.48704],[25.68045,54.5321],[25.75977,54.57252],[25.74122,54.80108],[25.89462,54.93438],[25.99129,54.95705],[26.05907,54.94631],[26.13386,54.98924],[26.20397,54.99729],[26.26941,55.08032],[26.23202,55.10439],[26.30628,55.12536],[26.35121,55.1525],[26.46249,55.12814],[26.51481,55.16051],[26.54753,55.14181],[26.69243,55.16718],[26.68075,55.19787],[26.72983,55.21788],[26.73017,55.24226],[26.835,55.28182],[26.83266,55.30444],[26.80929,55.31642],[26.6714,55.33902],[26.5709,55.32572],[26.44937,55.34832],[26.5522,55.40277],[26.55094,55.5093],[26.63167,55.57887],[26.63231,55.67968],[26.58248,55.6754],[26.46661,55.70375],[26.39561,55.71156],[26.18509,55.86813],[26.03815,55.95884],[25.90047,56.0013],[25.85893,56.00188],[25.81773,56.05444],[25.69246,56.08892],[25.68588,56.14725],[25.53621,56.16663],[25.39751,56.15707],[25.23099,56.19147],[25.09325,56.1878],[25.05762,56.26742],[24.89005,56.46666]]]]}},{type:"Feature",properties:{iso1A2:"LU",iso1A3:"LUX",iso1N3:"442",wikidata:"Q32",nameEn:"Luxembourg",groups:["EU","155","150","UN"],callingCodes:["352"]},geometry:{type:"MultiPolygon",coordinates:[[[[6.1379,50.12964],[6.1137,50.13668],[6.12028,50.16374],[6.08577,50.17246],[6.06406,50.15344],[6.03093,50.16362],[6.02488,50.18283],[5.96453,50.17259],[5.95929,50.13295],[5.89488,50.11476],[5.8857,50.07824],[5.85474,50.06342],[5.86904,50.04614],[5.8551,50.02683],[5.81866,50.01286],[5.82331,49.99662],[5.83968,49.9892],[5.83467,49.97823],[5.81163,49.97142],[5.80833,49.96451],[5.77291,49.96056],[5.77314,49.93646],[5.73621,49.89796],[5.78415,49.87922],[5.75269,49.8711],[5.75861,49.85631],[5.74567,49.85368],[5.75884,49.84811],[5.74953,49.84709],[5.74975,49.83933],[5.74076,49.83823],[5.7404,49.83452],[5.74844,49.82435],[5.74364,49.82058],[5.74953,49.81428],[5.75409,49.79239],[5.78871,49.7962],[5.82245,49.75048],[5.83149,49.74729],[5.82562,49.72395],[5.84193,49.72161],[5.86503,49.72739],[5.88677,49.70951],[5.86527,49.69291],[5.86175,49.67862],[5.9069,49.66377],[5.90164,49.6511],[5.90599,49.63853],[5.88552,49.63507],[5.88393,49.62802],[5.87609,49.62047],[5.8762,49.60898],[5.84826,49.5969],[5.84971,49.58674],[5.86986,49.58756],[5.87256,49.57539],[5.8424,49.56082],[5.84692,49.55663],[5.84143,49.5533],[5.81838,49.54777],[5.80871,49.5425],[5.81664,49.53775],[5.83648,49.5425],[5.84466,49.53027],[5.83467,49.52717],[5.83389,49.52152],[5.86571,49.50015],[5.94128,49.50034],[5.94224,49.49608],[5.96876,49.49053],[5.97693,49.45513],[6.02648,49.45451],[6.02743,49.44845],[6.04176,49.44801],[6.05553,49.46663],[6.07887,49.46399],[6.08373,49.45594],[6.10072,49.45268],[6.09845,49.46351],[6.10325,49.4707],[6.12346,49.4735],[6.12814,49.49365],[6.14321,49.48796],[6.16115,49.49297],[6.15366,49.50226],[6.17386,49.50934],[6.19543,49.50536],[6.2409,49.51408],[6.25029,49.50609],[6.27875,49.503],[6.28818,49.48465],[6.3687,49.4593],[6.36778,49.46937],[6.36907,49.48931],[6.36788,49.50377],[6.35666,49.52931],[6.38072,49.55171],[6.38228,49.55855],[6.35825,49.57053],[6.36676,49.57813],[6.38024,49.57593],[6.38342,49.5799],[6.37464,49.58886],[6.385,49.59946],[6.39822,49.60081],[6.41861,49.61723],[6.4413,49.65722],[6.43768,49.66021],[6.42726,49.66078],[6.42937,49.66857],[6.44654,49.67799],[6.46048,49.69092],[6.48014,49.69767],[6.49785,49.71118],[6.50647,49.71353],[6.5042,49.71808],[6.49694,49.72205],[6.49535,49.72645],[6.50261,49.72718],[6.51397,49.72058],[6.51805,49.72425],[6.50193,49.73291],[6.50174,49.75292],[6.51646,49.75961],[6.51828,49.76855],[6.51056,49.77515],[6.51669,49.78336],[6.50534,49.78952],[6.52169,49.79787],[6.53122,49.80666],[6.52121,49.81338],[6.51215,49.80124],[6.50647,49.80916],[6.48718,49.81267],[6.47111,49.82263],[6.45425,49.81164],[6.44131,49.81443],[6.42905,49.81091],[6.42521,49.81591],[6.40022,49.82029],[6.36576,49.85032],[6.34267,49.84974],[6.33585,49.83785],[6.32098,49.83728],[6.32303,49.85133],[6.30963,49.87021],[6.29692,49.86685],[6.28874,49.87592],[6.26146,49.88203],[6.23496,49.89972],[6.22926,49.92096],[6.21882,49.92403],[6.22608,49.929],[6.22094,49.94955],[6.19856,49.95053],[6.19089,49.96991],[6.18045,49.96611],[6.18554,49.95622],[6.17872,49.9537],[6.16466,49.97086],[6.1701,49.98518],[6.14147,49.99563],[6.14948,50.00908],[6.13806,50.01056],[6.1295,50.01849],[6.13273,50.02019],[6.13794,50.01466],[6.14666,50.02207],[6.13044,50.02929],[6.13458,50.04141],[6.11274,50.05916],[6.12055,50.09171],[6.1379,50.12964]]]]}},{type:"Feature",properties:{iso1A2:"LV",iso1A3:"LVA",iso1N3:"428",wikidata:"Q211",nameEn:"Latvia",groups:["EU","154","150","UN"],callingCodes:["371"]},geometry:{type:"MultiPolygon",coordinates:[[[[27.34698,57.52242],[26.90364,57.62823],[26.54675,57.51813],[26.46527,57.56885],[26.29253,57.59244],[26.1866,57.6849],[26.2029,57.7206],[26.08098,57.76619],[26.0543,57.76105],[26.03332,57.7718],[26.02415,57.76865],[26.02069,57.77169],[26.0266,57.77441],[26.027,57.78158],[26.02456,57.78342],[26.0324,57.79037],[26.05949,57.84744],[25.73499,57.90193],[25.29581,58.08288],[25.28237,57.98539],[25.19484,58.0831],[24.3579,57.87471],[24.26221,57.91787],[23.20055,57.56697],[22.80496,57.87798],[19.84909,57.57876],[19.64795,57.06466],[20.68447,56.04073],[21.15016,56.07818],[21.24644,56.16917],[21.49736,56.29106],[21.57888,56.31406],[21.74558,56.33181],[22.00548,56.41508],[22.09728,56.42851],[22.3361,56.4016],[22.56441,56.39305],[22.69354,56.36284],[22.83048,56.367],[22.96988,56.41213],[23.09531,56.30511],[23.17312,56.36795],[23.31606,56.3827],[23.40486,56.37689],[23.49803,56.34307],[23.75726,56.37282],[24.02657,56.3231],[24.13139,56.24881],[24.32334,56.30226],[24.42746,56.26522],[24.58143,56.29125],[24.57353,56.31525],[24.70022,56.40483],[24.83686,56.41565],[24.89005,56.46666],[25.05762,56.26742],[25.09325,56.1878],[25.23099,56.19147],[25.39751,56.15707],[25.53621,56.16663],[25.68588,56.14725],[25.69246,56.08892],[25.81773,56.05444],[25.85893,56.00188],[25.90047,56.0013],[26.03815,55.95884],[26.18509,55.86813],[26.39561,55.71156],[26.46661,55.70375],[26.58248,55.6754],[26.63231,55.67968],[26.64888,55.70515],[26.71802,55.70645],[26.76872,55.67658],[26.87448,55.7172],[26.97153,55.8102],[27.1559,55.85032],[27.27804,55.78299],[27.3541,55.8089],[27.61683,55.78558],[27.63065,55.89687],[27.97865,56.11849],[28.15217,56.16964],[28.23716,56.27588],[28.16599,56.37806],[28.19057,56.44637],[28.10069,56.524],[28.13526,56.57989],[28.04768,56.59004],[27.86101,56.88204],[27.66511,56.83921],[27.86101,57.29402],[27.52453,57.42826],[27.56832,57.53728],[27.34698,57.52242]]]]}},{type:"Feature",properties:{iso1A2:"LY",iso1A3:"LBY",iso1N3:"434",wikidata:"Q1016",nameEn:"Libya",groups:["015","002","UN"],callingCodes:["218"]},geometry:{type:"MultiPolygon",coordinates:[[[[26.92891,33.39516],[11.58941,33.36891],[11.55852,33.1409],[11.51549,33.09826],[11.46037,32.6307],[11.57828,32.48013],[11.53898,32.4138],[11.04234,32.2145],[10.7315,31.97235],[10.62788,31.96629],[10.48497,31.72956],[10.31364,31.72648],[10.12239,31.42098],[10.29516,30.90337],[9.88152,30.34074],[9.76848,30.34366],[9.55544,30.23971],[9.3876,30.16738],[9.78136,29.40961],[9.89569,26.57696],[9.51696,26.39148],[9.38834,26.19288],[10.03146,25.35635],[10.02432,24.98124],[10.33159,24.5465],[10.85323,24.5595],[11.41061,24.21456],[11.62498,24.26669],[11.96886,23.51735],[13.5631,23.16574],[14.22918,22.61719],[14.99751,23.00539],[15.99566,23.49639],[23.99539,19.49944],[23.99715,20.00038],[24.99794,19.99661],[24.99885,21.99535],[24.99968,29.24574],[24.71117,30.17441],[25.01077,30.73861],[24.8458,31.39877],[26.92891,33.39516]]]]}},{type:"Feature",properties:{iso1A2:"MA",iso1A3:"MAR",iso1N3:"504",wikidata:"Q1028",nameEn:"Morocco",groups:["015","002","UN"],callingCodes:["212"]},geometry:{type:"MultiPolygon",coordinates:[[[[-2.27707,35.35051],[-5.10878,36.05227],[-7.2725,35.73269],[-14.43883,27.02969],[-17.27295,21.93519],[-17.21511,21.34226],[-17.02707,21.34022],[-16.9978,21.36239],[-16.44269,21.39745],[-14.78487,21.36587],[-14.47329,21.63839],[-14.48112,22.00886],[-14.1291,22.41636],[-14.10361,22.75501],[-13.75627,23.77231],[-13.00628,24.01923],[-12.92147,24.39502],[-12.12281,25.13682],[-12.06001,26.04442],[-11.62052,26.05229],[-11.38635,26.611],[-11.23622,26.72023],[-11.35695,26.8505],[-10.68417,26.90984],[-9.81998,26.71379],[-9.56957,26.90042],[-9.08698,26.98639],[-8.71787,26.9898],[-8.77527,27.66663],[-8.66879,27.6666],[-8.6715,28.71194],[-7.61585,29.36252],[-6.95824,29.50924],[-6.78351,29.44634],[-6.69965,29.51623],[-5.75616,29.61407],[-5.72121,29.52322],[-5.58831,29.48103],[-5.21671,29.95253],[-4.6058,30.28343],[-4.31774,30.53229],[-3.64735,30.67539],[-3.65418,30.85566],[-3.54944,31.0503],[-3.77103,31.14984],[-3.77647,31.31912],[-3.66386,31.39202],[-3.66314,31.6339],[-2.82784,31.79459],[-2.93873,32.06557],[-2.46166,32.16603],[-1.22829,32.07832],[-1.15735,32.12096],[-1.24453,32.1917],[-1.24998,32.32993],[-.9912,32.52467],[-1.37794,32.73628],[-1.54244,32.95499],[-1.46249,33.0499],[-1.67067,33.27084],[-1.59508,33.59929],[-1.73494,33.71721],[-1.64666,34.10405],[-1.78042,34.39018],[-1.69788,34.48056],[-1.84569,34.61907],[-1.73707,34.74226],[-1.97469,34.886],[-1.97833,34.93218],[-2.04734,34.93218],[-2.21445,35.04378],[-2.21248,35.08532],[-2.27707,35.35051]],[[-2.91909,35.33927],[-2.92272,35.27509],[-2.93893,35.26737],[-2.95065,35.26576],[-2.95431,35.2728],[-2.96516,35.27967],[-2.96826,35.28296],[-2.96507,35.28801],[-2.97035,35.28852],[-2.96978,35.29459],[-2.96648,35.30475],[-2.96038,35.31609],[-2.91909,35.33927]],[[-3.90602,35.21494],[-3.89343,35.22728],[-3.88372,35.20767],[-3.90602,35.21494]],[[-4.30191,35.17419],[-4.29436,35.17149],[-4.30112,35.17058],[-4.30191,35.17419]],[[-2.40316,35.16893],[-2.45965,35.16527],[-2.43262,35.20652],[-2.40316,35.16893]],[[-5.38491,35.92591],[-5.21179,35.90091],[-5.34379,35.8711],[-5.35844,35.87375],[-5.37338,35.88417],[-5.38491,35.92591]]]]}},{type:"Feature",properties:{iso1A2:"MC",iso1A3:"MCO",iso1N3:"492",wikidata:"Q235",nameEn:"Monaco",groups:["155","150","UN"],callingCodes:["377"]},geometry:{type:"MultiPolygon",coordinates:[[[[7.47823,43.73341],[7.4379,43.74963],[7.4389,43.75151],[7.43708,43.75197],[7.43624,43.75014],[7.43013,43.74895],[7.42809,43.74396],[7.42443,43.74087],[7.42299,43.74176],[7.42062,43.73977],[7.41233,43.73439],[7.41298,43.73311],[7.41291,43.73168],[7.41113,43.73156],[7.40903,43.7296],[7.42422,43.72209],[7.47823,43.73341]]]]}},{type:"Feature",properties:{iso1A2:"MD",iso1A3:"MDA",iso1N3:"498",wikidata:"Q217",nameEn:"Moldova",groups:["151","150","UN"],callingCodes:["373"]},geometry:{type:"MultiPolygon",coordinates:[[[[27.74422,48.45926],[27.6658,48.44034],[27.59027,48.46311],[27.5889,48.49224],[27.46942,48.454],[27.44333,48.41209],[27.37741,48.41026],[27.37604,48.44398],[27.32159,48.4434],[27.27855,48.37534],[27.13434,48.37288],[27.08078,48.43214],[27.0231,48.42485],[27.03821,48.37653],[26.93384,48.36558],[26.85556,48.41095],[26.71274,48.40388],[26.82809,48.31629],[26.79239,48.29071],[26.6839,48.35828],[26.62823,48.25804],[26.81161,48.25049],[26.87708,48.19919],[26.94265,48.1969],[26.98042,48.15752],[26.96119,48.13003],[27.04118,48.12522],[27.02985,48.09083],[27.15622,47.98538],[27.1618,47.92391],[27.29069,47.73722],[27.25519,47.71366],[27.32202,47.64009],[27.3979,47.59473],[27.47942,47.48113],[27.55731,47.46637],[27.60263,47.32507],[27.68706,47.28962],[27.73172,47.29248],[27.81892,47.1381],[28.09095,46.97621],[28.12173,46.82283],[28.24808,46.64305],[28.22281,46.50481],[28.25769,46.43334],[28.18902,46.35283],[28.19864,46.31869],[28.10937,46.22852],[28.13684,46.18099],[28.08612,46.01105],[28.13111,45.92819],[28.16568,45.6421],[28.08927,45.6051],[28.18741,45.47358],[28.21139,45.46895],[28.30201,45.54744],[28.41836,45.51715],[28.43072,45.48538],[28.51449,45.49982],[28.49252,45.56716],[28.54196,45.58062],[28.51587,45.6613],[28.47879,45.66994],[28.52823,45.73803],[28.70401,45.78019],[28.69852,45.81753],[28.78503,45.83475],[28.74383,45.96664],[28.98004,46.00385],[29.00613,46.04962],[28.94643,46.09176],[29.06656,46.19716],[28.94953,46.25852],[28.98478,46.31803],[29.004,46.31495],[28.9306,46.45699],[29.01241,46.46177],[29.02409,46.49582],[29.23547,46.55435],[29.24886,46.37912],[29.35357,46.49505],[29.49914,46.45889],[29.5939,46.35472],[29.6763,46.36041],[29.66359,46.4215],[29.74496,46.45605],[29.88329,46.35851],[29.94114,46.40114],[30.09103,46.38694],[30.16794,46.40967],[30.02511,46.45132],[29.88916,46.54302],[29.94409,46.56002],[29.9743,46.75325],[29.94522,46.80055],[29.98814,46.82358],[29.87405,46.88199],[29.75458,46.8604],[29.72986,46.92234],[29.57056,46.94766],[29.62137,47.05069],[29.61038,47.09932],[29.53044,47.07851],[29.49732,47.12878],[29.57696,47.13581],[29.54996,47.24962],[29.59665,47.25521],[29.5733,47.36508],[29.48678,47.36043],[29.47854,47.30366],[29.39889,47.30179],[29.3261,47.44664],[29.18603,47.43387],[29.11743,47.55001],[29.22414,47.60012],[29.22242,47.73607],[29.27255,47.79953],[29.20663,47.80367],[29.27804,47.88893],[29.19839,47.89261],[29.1723,47.99013],[28.9306,47.96255],[28.8414,48.03392],[28.85232,48.12506],[28.69896,48.13106],[28.53921,48.17453],[28.48428,48.0737],[28.42454,48.12047],[28.43701,48.15832],[28.38712,48.17567],[28.34009,48.13147],[28.30609,48.14018],[28.30586,48.1597],[28.34912,48.1787],[28.36996,48.20543],[28.35519,48.24957],[28.32508,48.23384],[28.2856,48.23202],[28.19314,48.20749],[28.17666,48.25963],[28.07504,48.23494],[28.09873,48.3124],[28.04527,48.32661],[27.95883,48.32368],[27.88391,48.36699],[27.87533,48.4037],[27.81902,48.41874],[27.79225,48.44244],[27.74422,48.45926]]]]}},{type:"Feature",properties:{iso1A2:"ME",iso1A3:"MNE",iso1N3:"499",wikidata:"Q236",nameEn:"Montenegro",groups:["039","150","UN"],callingCodes:["382"]},geometry:{type:"MultiPolygon",coordinates:[[[[19.22807,43.5264],[19.15685,43.53943],[19.13933,43.5282],[19.04934,43.50384],[19.01078,43.55806],[18.91379,43.50299],[18.95469,43.49367],[18.96053,43.45042],[19.01078,43.43854],[19.04071,43.397],[19.08673,43.31453],[19.08206,43.29668],[19.04233,43.30008],[19.00844,43.24988],[18.95001,43.29327],[18.95819,43.32899],[18.90911,43.36383],[18.83912,43.34795],[18.84794,43.33735],[18.85342,43.32426],[18.76538,43.29838],[18.6976,43.25243],[18.71747,43.2286],[18.66605,43.2056],[18.64735,43.14766],[18.66254,43.03928],[18.52232,43.01451],[18.49076,42.95553],[18.49661,42.89306],[18.4935,42.86433],[18.47633,42.85829],[18.45921,42.81682],[18.47324,42.74992],[18.56789,42.72074],[18.55221,42.69045],[18.54603,42.69171],[18.54841,42.68328],[18.57373,42.64429],[18.52232,42.62279],[18.55504,42.58409],[18.53751,42.57376],[18.49778,42.58409],[18.43735,42.55921],[18.44307,42.51077],[18.43588,42.48556],[18.52152,42.42302],[18.54128,42.39171],[18.45131,42.21682],[19.26406,41.74971],[19.37597,41.84849],[19.37451,41.8842],[19.33812,41.90669],[19.34601,41.95675],[19.37691,41.96977],[19.36867,42.02564],[19.37548,42.06835],[19.40687,42.10024],[19.28623,42.17745],[19.42,42.33019],[19.42352,42.36546],[19.4836,42.40831],[19.65972,42.62774],[19.73244,42.66299],[19.77375,42.58517],[19.74731,42.57422],[19.76549,42.50237],[19.82333,42.46581],[19.9324,42.51699],[20.00842,42.5109],[20.01834,42.54622],[20.07761,42.55582],[20.0969,42.65559],[20.02915,42.71147],[20.02088,42.74789],[20.04898,42.77701],[20.2539,42.76245],[20.27869,42.81945],[20.35692,42.8335],[20.34528,42.90676],[20.16415,42.97177],[20.14896,42.99058],[20.12325,42.96237],[20.05431,42.99571],[20.04729,43.02732],[19.98887,43.0538],[19.96549,43.11098],[19.92576,43.08539],[19.79255,43.11951],[19.76918,43.16044],[19.64063,43.19027],[19.62661,43.2286],[19.54598,43.25158],[19.52962,43.31623],[19.48171,43.32644],[19.44315,43.38846],[19.22229,43.47926],[19.22807,43.5264]]]]}},{type:"Feature",properties:{iso1A2:"MF",iso1A3:"MAF",iso1N3:"663",wikidata:"Q126125",nameEn:"Saint-Martin",country:"FR",groups:["Q3320166","EU","029","003","419","019","UN"],callingCodes:["590"]},geometry:{type:"MultiPolygon",coordinates:[[[[-62.93924,18.02904],[-62.62718,18.26185],[-63.35989,18.06012],[-63.33064,17.9615],[-63.13502,18.05445],[-63.11042,18.05339],[-63.09686,18.04608],[-63.07759,18.04943],[-63.0579,18.06614],[-63.04039,18.05619],[-63.02323,18.05757],[-62.93924,18.02904]]]]}},{type:"Feature",properties:{iso1A2:"MG",iso1A3:"MDG",iso1N3:"450",wikidata:"Q1019",nameEn:"Madagascar",aliases:["RM"],groups:["014","202","002","UN"],callingCodes:["261"]},geometry:{type:"MultiPolygon",coordinates:[[[[51.93891,-10.85085],[45.84651,-12.77177],[42.14681,-19.63341],[45.80092,-33.00974],[51.93891,-10.85085]]]]}},{type:"Feature",properties:{iso1A2:"MH",iso1A3:"MHL",iso1N3:"584",wikidata:"Q709",nameEn:"Marshall Islands",groups:["057","009","UN"],roadSpeedUnit:"mph",callingCodes:["692"]},geometry:{type:"MultiPolygon",coordinates:[[[[169,3.9],[173.53711,5.70687],[169.29099,15.77133],[159.04653,10.59067],[169,3.9]]]]}},{type:"Feature",properties:{iso1A2:"MK",iso1A3:"MKD",iso1N3:"807",wikidata:"Q221",nameEn:"North Macedonia",groups:["039","150","UN"],callingCodes:["389"]},geometry:{type:"MultiPolygon",coordinates:[[[[22.34773,42.31725],[22.29275,42.34913],[22.29605,42.37477],[22.16384,42.32103],[22.02908,42.29848],[21.94405,42.34669],[21.91595,42.30392],[21.84654,42.3247],[21.77176,42.2648],[21.70111,42.23789],[21.58992,42.25915],[21.52145,42.24465],[21.50823,42.27156],[21.43882,42.2789],[21.43882,42.23609],[21.38428,42.24465],[21.30496,42.1418],[21.29913,42.13954],[21.31983,42.10993],[21.22728,42.08909],[21.16614,42.19815],[21.11491,42.20794],[20.75464,42.05229],[20.76786,41.91839],[20.68523,41.85318],[20.59524,41.8818],[20.55976,41.87068],[20.57144,41.7897],[20.53405,41.78099],[20.51301,41.72433],[20.52937,41.69292],[20.51769,41.65975],[20.55508,41.58113],[20.52103,41.56473],[20.45809,41.5549],[20.45331,41.51436],[20.49039,41.49277],[20.51301,41.442],[20.55976,41.4087],[20.52119,41.34381],[20.49432,41.33679],[20.51068,41.2323],[20.59715,41.13644],[20.58546,41.11179],[20.59832,41.09066],[20.63454,41.0889],[20.65558,41.08009],[20.71634,40.91781],[20.73504,40.9081],[20.81567,40.89662],[20.83671,40.92752],[20.94305,40.92399],[20.97693,40.90103],[20.97887,40.85475],[21.15262,40.85546],[21.21105,40.8855],[21.25779,40.86165],[21.35595,40.87578],[21.41555,40.9173],[21.53007,40.90759],[21.57448,40.86076],[21.69601,40.9429],[21.7556,40.92525],[21.91102,41.04786],[21.90869,41.09191],[22.06527,41.15617],[22.1424,41.12449],[22.17629,41.15969],[22.26744,41.16409],[22.42285,41.11921],[22.5549,41.13065],[22.58295,41.11568],[22.62852,41.14385],[22.65306,41.18168],[22.71266,41.13945],[22.74538,41.16321],[22.76408,41.32225],[22.81199,41.3398],[22.93334,41.34104],[22.96331,41.35782],[22.95513,41.63265],[23.03342,41.71034],[23.01239,41.76527],[22.96682,41.77137],[22.90254,41.87587],[22.86749,42.02275],[22.67701,42.06614],[22.51224,42.15457],[22.50289,42.19527],[22.47251,42.20393],[22.38136,42.30339],[22.34773,42.31725]]]]}},{type:"Feature",properties:{iso1A2:"ML",iso1A3:"MLI",iso1N3:"466",wikidata:"Q912",nameEn:"Mali",groups:["011","202","002","UN"],callingCodes:["223"]},geometry:{type:"MultiPolygon",coordinates:[[[[-4.83423,24.99935],[-6.57191,25.0002],[-5.60725,16.49919],[-5.33435,16.33354],[-5.50165,15.50061],[-9.32979,15.50032],[-9.31106,15.69412],[-9.33314,15.7044],[-9.44673,15.60553],[-9.40447,15.4396],[-10.71721,15.4223],[-10.90932,15.11001],[-11.43483,15.62339],[-11.70705,15.51558],[-11.94903,14.76143],[-12.23936,14.76324],[-11.93043,13.84505],[-12.06897,13.71049],[-11.83345,13.33333],[-11.63025,13.39174],[-11.39935,12.97808],[-11.37536,12.40788],[-11.50006,12.17826],[-11.24136,12.01286],[-10.99758,12.24634],[-10.80355,12.1053],[-10.71897,11.91552],[-10.30604,12.24634],[-9.714,12.0226],[-9.63938,12.18312],[-9.32097,12.29009],[-9.38067,12.48446],[-9.13689,12.50875],[-8.94784,12.34842],[-8.80854,11.66715],[-8.40058,11.37466],[-8.66923,10.99397],[-8.35083,11.06234],[-8.2667,10.91762],[-8.32614,10.69273],[-8.22711,10.41722],[-8.10207,10.44649],[-7.9578,10.2703],[-7.97971,10.17117],[-7.92107,10.15577],[-7.63048,10.46334],[-7.54462,10.40921],[-7.52261,10.4655],[-7.44555,10.44602],[-7.3707,10.24677],[-7.13331,10.24877],[-7.0603,10.14711],[-7.00966,10.15794],[-6.97444,10.21644],[-7.01186,10.25111],[-6.93921,10.35291],[-6.68164,10.35074],[-6.63541,10.66893],[-6.52974,10.59104],[-6.42847,10.5694],[-6.40646,10.69922],[-6.325,10.68624],[-6.24795,10.74248],[-6.1731,10.46983],[-6.18851,10.24244],[-5.99478,10.19694],[-5.78124,10.43952],[-5.65135,10.46767],[-5.51058,10.43177],[-5.46643,10.56074],[-5.47083,10.75329],[-5.41579,10.84628],[-5.49284,11.07538],[-5.32994,11.13371],[-5.32553,11.21578],[-5.25949,11.24816],[-5.25509,11.36905],[-5.20665,11.43811],[-5.22867,11.60421],[-5.29251,11.61715],[-5.26389,11.75728],[-5.40258,11.8327],[-5.26389,11.84778],[-5.07897,11.97918],[-4.72893,12.01579],[-4.70692,12.06746],[-4.62987,12.06531],[-4.62546,12.13204],[-4.54841,12.1385],[-4.57703,12.19875],[-4.41412,12.31922],[-4.47356,12.71252],[-4.238,12.71467],[-4.21819,12.95722],[-4.34477,13.12927],[-3.96501,13.49778],[-3.90558,13.44375],[-3.96282,13.38164],[-3.7911,13.36665],[-3.54454,13.1781],[-3.4313,13.1588],[-3.43507,13.27272],[-3.23599,13.29035],[-3.28396,13.5422],[-3.26407,13.70699],[-2.88189,13.64921],[-2.90831,13.81174],[-2.84667,14.05532],[-2.66175,14.14713],[-2.47587,14.29671],[-2.10223,14.14878],[-1.9992,14.19011],[-1.97945,14.47709],[-1.68083,14.50023],[-1.32166,14.72774],[-1.05875,14.7921],[-.72004,15.08655],[-.24673,15.07805],[.06588,14.96961],[.23859,15.00135],[.72632,14.95898],[.96711,14.98275],[1.31275,15.27978],[3.01806,15.34571],[3.03134,15.42221],[3.50368,15.35934],[4.19893,16.39923],[4.21787,17.00118],[4.26762,17.00432],[4.26651,19.14224],[3.36082,18.9745],[3.12501,19.1366],[3.24648,19.81703],[1.20992,20.73533],[1.15698,21.12843],[-4.83423,24.99935]]]]}},{type:"Feature",properties:{iso1A2:"MM",iso1A3:"MMR",iso1N3:"104",wikidata:"Q836",nameEn:"Myanmar",aliases:["Burma","BU"],groups:["035","142","UN"],callingCodes:["95"]},geometry:{type:"MultiPolygon",coordinates:[[[[92.62187,21.87037],[92.59775,21.6092],[92.68152,21.28454],[92.60187,21.24615],[92.55105,21.3856],[92.43158,21.37025],[92.37939,21.47764],[92.20087,21.337],[92.17752,21.17445],[92.26071,21.05697],[92.47409,20.38654],[92.61042,13.76986],[94.6371,13.81803],[97.63455,9.60854],[98.12555,9.44056],[98.33094,9.91973],[98.47298,9.95782],[98.52291,9.92389],[98.55174,9.92804],[98.7391,10.31488],[98.81944,10.52761],[98.77275,10.62548],[98.78511,10.68351],[98.86819,10.78336],[99.0069,10.85485],[98.99701,10.92962],[99.02337,10.97217],[99.06938,10.94857],[99.32756,11.28545],[99.31573,11.32081],[99.39485,11.3925],[99.47598,11.62434],[99.5672,11.62732],[99.64108,11.78948],[99.64891,11.82699],[99.53424,12.02317],[99.56445,12.14805],[99.47519,12.1353],[99.409,12.60603],[99.29254,12.68921],[99.18905,12.84799],[99.18748,12.9898],[99.10646,13.05804],[99.12225,13.19847],[99.20617,13.20575],[99.16695,13.72621],[98.97356,14.04868],[98.56762,14.37701],[98.24874,14.83013],[98.18821,15.13125],[98.22,15.21327],[98.30446,15.30667],[98.40522,15.25268],[98.41906,15.27103],[98.39351,15.34177],[98.4866,15.39154],[98.56027,15.33471],[98.58598,15.46821],[98.541,15.65406],[98.59853,15.87197],[98.57019,16.04578],[98.69585,16.13353],[98.8376,16.11706],[98.92656,16.36425],[98.84485,16.42354],[98.68074,16.27068],[98.63817,16.47424],[98.57912,16.55983],[98.5695,16.62826],[98.51113,16.64503],[98.51833,16.676],[98.51472,16.68521],[98.51579,16.69433],[98.51043,16.70107],[98.49713,16.69022],[98.50253,16.7139],[98.46994,16.73613],[98.53833,16.81934],[98.49603,16.8446],[98.52624,16.89979],[98.39441,17.06266],[98.34566,17.04822],[98.10439,17.33847],[98.11185,17.36829],[97.91829,17.54504],[97.76407,17.71595],[97.66794,17.88005],[97.73723,17.97912],[97.60841,18.23846],[97.64116,18.29778],[97.56219,18.33885],[97.50383,18.26844],[97.34522,18.54596],[97.36444,18.57138],[97.5258,18.4939],[97.76752,18.58097],[97.73836,18.88478],[97.66487,18.9371],[97.73654,18.9812],[97.73797,19.04261],[97.83479,19.09972],[97.84024,19.22217],[97.78606,19.26769],[97.84186,19.29526],[97.78769,19.39429],[97.88423,19.5041],[97.84715,19.55782],[98.04364,19.65755],[98.03314,19.80941],[98.13829,19.78541],[98.24884,19.67876],[98.51182,19.71303],[98.56065,19.67807],[98.83661,19.80931],[98.98679,19.7419],[99.0735,20.10298],[99.20328,20.12877],[99.416,20.08614],[99.52943,20.14811],[99.5569,20.20676],[99.46077,20.36198],[99.46008,20.39673],[99.68255,20.32077],[99.81096,20.33687],[99.86383,20.44371],[99.88211,20.44488],[99.88451,20.44596],[99.89168,20.44548],[99.89301,20.44311],[99.89692,20.44789],[99.90499,20.4487],[99.91616,20.44986],[99.95721,20.46301],[100.08404,20.36626],[100.1957,20.68247],[100.36375,20.82783],[100.51079,20.82194],[100.60112,20.8347],[100.64628,20.88279],[100.50974,20.88574],[100.55281,21.02796],[100.63578,21.05639],[100.72716,21.31786],[100.80173,21.2934],[101.00234,21.39612],[101.16198,21.52808],[101.15156,21.56129],[101.11744,21.77659],[100.87265,21.67396],[100.72143,21.51898],[100.57861,21.45637],[100.4811,21.46148],[100.42892,21.54325],[100.35201,21.53176],[100.25863,21.47043],[100.18447,21.51898],[100.1625,21.48704],[100.12542,21.50365],[100.10757,21.59945],[100.17486,21.65306],[100.12679,21.70539],[100.04956,21.66843],[99.98654,21.71064],[99.94003,21.82782],[99.99084,21.97053],[99.96612,22.05965],[99.85351,22.04183],[99.47585,22.13345],[99.33166,22.09656],[99.1552,22.15874],[99.19176,22.16983],[99.17318,22.18025],[99.28771,22.4105],[99.37972,22.50188],[99.38247,22.57544],[99.31243,22.73893],[99.45654,22.85726],[99.43537,22.94086],[99.54218,22.90014],[99.52214,23.08218],[99.34127,23.13099],[99.25741,23.09025],[99.04601,23.12215],[99.05975,23.16382],[98.88597,23.18656],[98.92515,23.29535],[98.93958,23.31414],[98.87573,23.33038],[98.92104,23.36946],[98.87683,23.48995],[98.82877,23.47908],[98.80294,23.5345],[98.88396,23.59555],[98.81775,23.694],[98.82933,23.72921],[98.79607,23.77947],[98.68209,23.80492],[98.67797,23.9644],[98.89632,24.10612],[98.87998,24.15624],[98.85319,24.13042],[98.59256,24.08371],[98.54476,24.13119],[98.20666,24.11406],[98.07806,24.07988],[98.06703,24.08028],[98.0607,24.07812],[98.05671,24.07961],[98.05302,24.07408],[98.04709,24.07616],[97.99583,24.04932],[97.98691,24.03897],[97.93951,24.01953],[97.90998,24.02094],[97.88616,24.00463],[97.88414,23.99405],[97.88814,23.98605],[97.89683,23.98389],[97.89676,23.97931],[97.8955,23.97758],[97.88811,23.97446],[97.86545,23.97723],[97.84328,23.97603],[97.79416,23.95663],[97.79456,23.94836],[97.72302,23.89288],[97.64667,23.84574],[97.5247,23.94032],[97.62363,24.00506],[97.72903,24.12606],[97.75305,24.16902],[97.72799,24.18883],[97.72998,24.2302],[97.76799,24.26365],[97.71941,24.29652],[97.66723,24.30027],[97.65624,24.33781],[97.7098,24.35658],[97.66998,24.45288],[97.60029,24.4401],[97.52757,24.43748],[97.56286,24.54535],[97.56525,24.72838],[97.54675,24.74202],[97.5542,24.74943],[97.56383,24.75535],[97.56648,24.76475],[97.64354,24.79171],[97.70181,24.84557],[97.73127,24.83015],[97.76481,24.8289],[97.79949,24.85655],[97.72903,24.91332],[97.72216,25.08508],[97.77023,25.11492],[97.83614,25.2715],[97.92541,25.20815],[98.14925,25.41547],[98.12591,25.50722],[98.18084,25.56298],[98.16848,25.62739],[98.25774,25.6051],[98.31268,25.55307],[98.40606,25.61129],[98.54064,25.85129],[98.63128,25.79937],[98.70818,25.86241],[98.60763,26.01512],[98.57085,26.11547],[98.63128,26.15492],[98.66884,26.09165],[98.7329,26.17218],[98.67797,26.24487],[98.72741,26.36183],[98.77547,26.61994],[98.7333,26.85615],[98.69582,27.56499],[98.43353,27.67086],[98.42529,27.55404],[98.32641,27.51385],[98.13964,27.9478],[98.15337,28.12114],[97.90069,28.3776],[97.79632,28.33168],[97.70705,28.5056],[97.56835,28.55628],[97.50518,28.49716],[97.47085,28.2688],[97.41729,28.29783],[97.34547,28.21385],[97.31292,28.06784],[97.35412,28.06663],[97.38845,28.01329],[97.35824,27.87256],[97.29919,27.92233],[96.90112,27.62149],[96.91431,27.45752],[97.17422,27.14052],[97.14675,27.09041],[96.89132,27.17474],[96.85287,27.2065],[96.88445,27.25046],[96.73888,27.36638],[96.55761,27.29928],[96.40779,27.29818],[96.15591,27.24572],[96.04949,27.19428],[95.93002,27.04149],[95.81603,27.01335],[95.437,26.7083],[95.30339,26.65372],[95.23513,26.68499],[95.05798,26.45408],[95.12801,26.38397],[95.11428,26.1019],[95.18556,26.07338],[94.80117,25.49359],[94.68032,25.47003],[94.57458,25.20318],[94.74212,25.13606],[94.73937,25.00545],[94.60204,24.70889],[94.5526,24.70764],[94.50729,24.59281],[94.45279,24.56656],[94.32362,24.27692],[94.30215,24.23752],[94.14081,23.83333],[93.92089,23.95812],[93.80279,23.92549],[93.75952,24.0003],[93.62871,24.00922],[93.50616,23.94432],[93.46633,23.97067],[93.41415,24.07854],[93.34735,24.10151],[93.32351,24.04468],[93.36059,23.93176],[93.3908,23.92925],[93.3908,23.7622],[93.43475,23.68299],[93.38805,23.4728],[93.39981,23.38828],[93.38781,23.36139],[93.36862,23.35426],[93.38478,23.13698],[93.2878,23.00464],[93.12988,23.05772],[93.134,22.92498],[93.09417,22.69459],[93.134,22.59573],[93.11477,22.54374],[93.13537,22.45873],[93.18206,22.43716],[93.19991,22.25425],[93.14224,22.24535],[93.15734,22.18687],[93.04885,22.20595],[92.99255,22.05965],[92.99804,21.98964],[92.93899,22.02656],[92.89504,21.95143],[92.86208,22.05456],[92.70416,22.16017],[92.67532,22.03547],[92.60949,21.97638],[92.62187,21.87037]]]]}},{type:"Feature",properties:{iso1A2:"MN",iso1A3:"MNG",iso1N3:"496",wikidata:"Q711",nameEn:"Mongolia",groups:["030","142","UN"],callingCodes:["976"]},geometry:{type:"MultiPolygon",coordinates:[[[[102.14032,51.35566],[101.5044,51.50467],[101.39085,51.45753],[100.61116,51.73028],[99.89203,51.74903],[99.75578,51.90108],[99.27888,51.96876],[98.87768,52.14563],[98.74142,51.8637],[98.33222,51.71832],[98.22053,51.46579],[98.05257,51.46696],[97.83305,51.00248],[98.01472,50.86652],[97.9693,50.78044],[98.06393,50.61262],[98.31373,50.4996],[98.29481,50.33561],[97.85197,49.91339],[97.76871,49.99861],[97.56432,49.92801],[97.56811,49.84265],[97.24639,49.74737],[96.97388,49.88413],[95.80056,50.04239],[95.74757,49.97915],[95.02465,49.96941],[94.97166,50.04725],[94.6121,50.04239],[94.49477,50.17832],[94.39258,50.22193],[94.30823,50.57498],[92.99595,50.63183],[93.01109,50.79001],[92.44714,50.78762],[92.07173,50.69585],[91.86048,50.73734],[89.59711,49.90851],[89.70687,49.72535],[88.82499,49.44808],[88.42449,49.48821],[88.17223,49.46934],[88.15543,49.30314],[87.98977,49.18147],[87.81333,49.17354],[87.88171,48.95853],[87.73822,48.89582],[88.0788,48.71436],[87.96361,48.58478],[88.58939,48.34531],[88.58316,48.21893],[88.8011,48.11302],[88.93186,48.10263],[89.0711,47.98528],[89.55453,48.0423],[89.76624,47.82745],[90.06512,47.88177],[90.10871,47.7375],[90.33598,47.68303],[90.48854,47.41826],[90.48542,47.30438],[90.76108,46.99399],[90.84035,46.99525],[91.03649,46.72916],[91.0147,46.58171],[91.07696,46.57315],[90.89639,46.30711],[90.99672,46.14207],[91.03026,46.04194],[90.70907,45.73437],[90.65114,45.49314],[90.89169,45.19667],[91.64048,45.07408],[93.51161,44.95964],[94.10003,44.71016],[94.71959,44.35284],[95.01191,44.25274],[95.39772,44.2805],[95.32891,44.02407],[95.52594,43.99353],[95.89543,43.2528],[96.35658,42.90363],[96.37926,42.72055],[97.1777,42.7964],[99.50671,42.56535],[100.33297,42.68231],[100.84979,42.67087],[101.80515,42.50074],[102.07645,42.22519],[102.72403,42.14675],[103.92804,41.78246],[104.52258,41.8706],[104.51667,41.66113],[105.0123,41.63188],[106.76517,42.28741],[107.24774,42.36107],[107.29755,42.41395],[107.49681,42.46221],[107.57258,42.40898],[108.84489,42.40246],[109.00679,42.45302],[109.452,42.44842],[109.89402,42.63111],[110.08401,42.6411],[110.4327,42.78293],[111.0149,43.3289],[111.59087,43.51207],[111.79758,43.6637],[111.93776,43.68709],[111.96289,43.81596],[111.40498,44.3461],[111.76275,44.98032],[111.98695,45.09074],[112.4164,45.06858],[112.74662,44.86297],[113.70918,44.72891],[114.5166,45.27189],[114.54801,45.38337],[114.74612,45.43585],[114.94546,45.37377],[115.60329,45.44717],[116.16989,45.68603],[116.27366,45.78637],[116.24012,45.8778],[116.26678,45.96479],[116.58612,46.30211],[116.75551,46.33083],[116.83166,46.38637],[117.36609,46.36335],[117.41782,46.57862],[117.60748,46.59771],[117.69554,46.50991],[118.30534,46.73519],[118.78747,46.68689],[118.8337,46.77742],[118.89974,46.77139],[118.92616,46.72765],[119.00541,46.74273],[119.10448,46.65516],[119.24978,46.64761],[119.32827,46.61433],[119.42827,46.63783],[119.65265,46.62342],[119.68127,46.59015],[119.77373,46.62947],[119.80455,46.67631],[119.89261,46.66423],[119.91242,46.90091],[119.85518,46.92196],[119.71209,47.19192],[119.62403,47.24575],[119.56019,47.24874],[119.54918,47.29505],[119.31964,47.42617],[119.35892,47.48104],[119.13995,47.53997],[119.12343,47.66458],[118.7564,47.76947],[118.55766,47.99277],[118.29654,48.00246],[118.22677,48.03853],[118.11009,48.04],[118.03676,48.00982],[117.80196,48.01661],[117.50181,47.77216],[117.37875,47.63627],[116.9723,47.87285],[116.67405,47.89039],[116.4465,47.83662],[116.21879,47.88505],[115.94296,47.67741],[115.57128,47.91988],[115.52082,48.15367],[115.811,48.25699],[115.78876,48.51781],[116.06565,48.81716],[116.03781,48.87014],[116.71193,49.83813],[116.62502,49.92919],[116.22402,50.04477],[115.73602,49.87688],[115.26068,49.97367],[114.9703,50.19254],[114.325,50.28098],[113.20216,49.83356],[113.02647,49.60772],[110.64493,49.1816],[110.39891,49.25083],[110.24373,49.16676],[109.51325,49.22859],[109.18017,49.34709],[108.53969,49.32325],[108.27937,49.53167],[107.95387,49.66659],[107.96116,49.93191],[107.36407,49.97612],[107.1174,50.04239],[107.00007,50.1977],[106.80326,50.30177],[106.58373,50.34044],[106.51122,50.34408],[106.49628,50.32436],[106.47156,50.31909],[106.07865,50.33474],[106.05562,50.40582],[105.32528,50.4648],[103.70343,50.13952],[102.71178,50.38873],[102.32194,50.67982],[102.14032,51.35566]]]]}},{type:"Feature",properties:{iso1A2:"MO",iso1A3:"MAC",iso1N3:"446",wikidata:"Q14773",nameEn:"Macau",aliases:["Macao"],country:"CN",groups:["030","142","UN"],driveSide:"left",callingCodes:["853"]},geometry:{type:"MultiPolygon",coordinates:[[[[113.54942,22.14519],[113.54839,22.10909],[113.57191,22.07696],[113.63011,22.10782],[113.60504,22.20464],[113.57123,22.20416],[113.56865,22.20973],[113.5508,22.21672],[113.54333,22.21688],[113.54093,22.21314],[113.53593,22.2137],[113.53301,22.21235],[113.53552,22.20607],[113.52659,22.18271],[113.54093,22.15497],[113.54942,22.14519]]]]}},{type:"Feature",properties:{iso1A2:"MP",iso1A3:"MNP",iso1N3:"580",wikidata:"Q16644",nameEn:"Northern Mariana Islands",aliases:["US-MP"],country:"US",groups:["Q1352230","Q153732","057","009","UN"],roadSpeedUnit:"mph",callingCodes:["1 670"]},geometry:{type:"MultiPolygon",coordinates:[[[[135.52896,14.32623],[152.19114,13.63487],[145.05972,21.28731],[135.52896,14.32623]]]]}},{type:"Feature",properties:{iso1A2:"MQ",iso1A3:"MTQ",iso1N3:"474",wikidata:"Q17054",nameEn:"Martinique",country:"FR",groups:["Q3320166","EU","029","003","419","019","UN"],callingCodes:["596"]},geometry:{type:"MultiPolygon",coordinates:[[[[-59.95997,14.20285],[-61.07821,15.25109],[-61.69315,14.26451],[-59.95997,14.20285]]]]}},{type:"Feature",properties:{iso1A2:"MR",iso1A3:"MRT",iso1N3:"478",wikidata:"Q1025",nameEn:"Mauritania",groups:["011","202","002","UN"],callingCodes:["222"]},geometry:{type:"MultiPolygon",coordinates:[[[[-5.60725,16.49919],[-6.57191,25.0002],[-4.83423,24.99935],[-8.66674,27.31569],[-8.66721,25.99918],[-12.0002,25.9986],[-12.00251,23.4538],[-12.14969,23.41935],[-12.36213,23.3187],[-12.5741,23.28975],[-13.00412,23.02297],[-13.10753,22.89493],[-13.15313,22.75649],[-13.08438,22.53866],[-13.01525,21.33343],[-16.95474,21.33997],[-16.99806,21.12142],[-17.0357,21.05368],[-17.0396,20.9961],[-17.06781,20.92697],[-17.0695,20.85742],[-17.0471,20.76408],[-17.15288,16.07139],[-16.50854,16.09032],[-16.48967,16.0496],[-16.44814,16.09753],[-16.4429,16.20605],[-16.27016,16.51565],[-15.6509,16.50315],[-15.00557,16.64997],[-14.32144,16.61495],[-13.80075,16.13961],[-13.43135,16.09022],[-13.11029,15.52116],[-12.23936,14.76324],[-11.94903,14.76143],[-11.70705,15.51558],[-11.43483,15.62339],[-10.90932,15.11001],[-10.71721,15.4223],[-9.40447,15.4396],[-9.44673,15.60553],[-9.33314,15.7044],[-9.31106,15.69412],[-9.32979,15.50032],[-5.50165,15.50061],[-5.33435,16.33354],[-5.60725,16.49919]]]]}},{type:"Feature",properties:{iso1A2:"MS",iso1A3:"MSR",iso1N3:"500",wikidata:"Q13353",nameEn:"Montserrat",country:"GB",groups:["BOTS","029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1 664"]},geometry:{type:"MultiPolygon",coordinates:[[[[-61.91508,16.51165],[-62.1023,16.97277],[-62.58307,16.68909],[-61.91508,16.51165]]]]}},{type:"Feature",properties:{iso1A2:"MT",iso1A3:"MLT",iso1N3:"470",wikidata:"Q233",nameEn:"Malta",groups:["EU","039","150","UN"],driveSide:"left",callingCodes:["356"]},geometry:{type:"MultiPolygon",coordinates:[[[[15.70991,35.79901],[14.07544,36.41525],[13.27636,35.20764],[15.70991,35.79901]]]]}},{type:"Feature",properties:{iso1A2:"MU",iso1A3:"MUS",iso1N3:"480",wikidata:"Q1027",nameEn:"Mauritius",groups:["014","202","002","UN"],driveSide:"left",callingCodes:["230"]},geometry:{type:"MultiPolygon",coordinates:[[[[56.09755,-9.55401],[57.50644,-31.92637],[68.4673,-19.15185],[56.09755,-9.55401]]]]}},{type:"Feature",properties:{iso1A2:"MV",iso1A3:"MDV",iso1N3:"462",wikidata:"Q826",nameEn:"Maldives",groups:["034","142","UN"],driveSide:"left",callingCodes:["960"]},geometry:{type:"MultiPolygon",coordinates:[[[[71.9161,8.55531],[72.57428,-3.7623],[76.59015,5.591],[71.9161,8.55531]]]]}},{type:"Feature",properties:{iso1A2:"MW",iso1A3:"MWI",iso1N3:"454",wikidata:"Q1020",nameEn:"Malawi",groups:["014","202","002","UN"],driveSide:"left",callingCodes:["265"]},geometry:{type:"MultiPolygon",coordinates:[[[[33.48052,-9.62442],[33.31581,-9.48554],[33.14925,-9.49322],[32.99397,-9.36712],[32.95389,-9.40138],[33.00476,-9.5133],[33.00256,-9.63053],[33.05485,-9.61316],[33.10163,-9.66525],[33.12144,-9.58929],[33.2095,-9.61099],[33.31517,-9.82364],[33.36581,-9.81063],[33.37902,-9.9104],[33.31297,-10.05133],[33.53863,-10.20148],[33.54797,-10.36077],[33.70675,-10.56896],[33.47636,-10.78465],[33.28022,-10.84428],[33.25998,-10.88862],[33.39697,-11.15296],[33.29267,-11.3789],[33.29267,-11.43536],[33.23663,-11.40637],[33.24252,-11.59302],[33.32692,-11.59248],[33.33937,-11.91252],[33.25998,-12.14242],[33.3705,-12.34931],[33.47636,-12.32498],[33.54485,-12.35996],[33.37517,-12.54085],[33.28177,-12.54692],[33.18837,-12.61377],[33.05917,-12.59554],[32.94397,-12.76868],[32.96733,-12.88251],[33.02181,-12.88707],[32.98289,-13.12671],[33.0078,-13.19492],[32.86113,-13.47292],[32.84176,-13.52794],[32.73683,-13.57682],[32.68436,-13.55769],[32.66468,-13.60019],[32.68654,-13.64268],[32.7828,-13.64805],[32.84528,-13.71576],[32.76962,-13.77224],[32.79015,-13.80755],[32.88985,-13.82956],[32.99042,-13.95689],[33.02977,-14.05022],[33.07568,-13.98447],[33.16749,-13.93992],[33.24249,-14.00019],[33.66677,-14.61306],[33.7247,-14.4989],[33.88503,-14.51652],[33.92898,-14.47929],[34.08588,-14.48893],[34.18733,-14.43823],[34.22355,-14.43607],[34.34453,-14.3985],[34.35843,-14.38652],[34.39277,-14.39467],[34.4192,-14.43191],[34.44641,-14.47746],[34.45053,-14.49873],[34.47628,-14.53363],[34.48932,-14.53646],[34.49636,-14.55091],[34.52366,-14.5667],[34.53962,-14.59776],[34.55112,-14.64494],[34.53516,-14.67782],[34.52057,-14.68263],[34.54503,-14.74672],[34.567,-14.77345],[34.61522,-14.99583],[34.57503,-15.30619],[34.43126,-15.44778],[34.44981,-15.60864],[34.25195,-15.90321],[34.43126,-16.04737],[34.40344,-16.20923],[35.04805,-16.83167],[35.13771,-16.81687],[35.17017,-16.93521],[35.04805,-17.00027],[35.0923,-17.13235],[35.3062,-17.1244],[35.27065,-16.93817],[35.30929,-16.82871],[35.27219,-16.69402],[35.14235,-16.56812],[35.25828,-16.4792],[35.30157,-16.2211],[35.43355,-16.11371],[35.52365,-16.15414],[35.70107,-16.10147],[35.80487,-16.03907],[35.85303,-15.41913],[35.78799,-15.17428],[35.91812,-14.89514],[35.87212,-14.89478],[35.86945,-14.67481],[35.5299,-14.27714],[35.47989,-14.15594],[34.86229,-13.48958],[34.60253,-13.48487],[34.37831,-12.17408],[34.46088,-12.0174],[34.70739,-12.15652],[34.82903,-12.04837],[34.57917,-11.87849],[34.64241,-11.57499],[34.96296,-11.57354],[34.91153,-11.39799],[34.79375,-11.32245],[34.63305,-11.11731],[34.61161,-11.01611],[34.67047,-10.93796],[34.65946,-10.6828],[34.57581,-10.56271],[34.51911,-10.12279],[34.54499,-10.0678],[34.03865,-9.49398],[33.95829,-9.54066],[33.9638,-9.62206],[33.93298,-9.71647],[33.76677,-9.58516],[33.48052,-9.62442]]]]}},{type:"Feature",properties:{iso1A2:"MX",iso1A3:"MEX",iso1N3:"484",wikidata:"Q96",nameEn:"Mexico",groups:["013","003","419","019","UN"],callingCodes:["52"]},geometry:{type:"MultiPolygon",coordinates:[[[[-117.1243,32.53427],[-118.48109,32.5991],[-120.12904,18.41089],[-92.37213,14.39277],[-92.2261,14.53423],[-92.1454,14.6804],[-92.18161,14.84147],[-92.1423,14.88647],[-92.1454,14.98143],[-92.0621,15.07406],[-92.20983,15.26077],[-91.73182,16.07371],[-90.44567,16.07573],[-90.40499,16.40524],[-90.61212,16.49832],[-90.69064,16.70697],[-91.04436,16.92175],[-91.43809,17.25373],[-90.99199,17.25192],[-90.98678,17.81655],[-89.14985,17.81563],[-89.15105,17.95104],[-89.03839,18.0067],[-88.8716,17.89535],[-88.71505,18.0707],[-88.48242,18.49164],[-88.3268,18.49048],[-88.29909,18.47591],[-88.26593,18.47617],[-88.03238,18.41778],[-88.03165,18.16657],[-87.90671,18.15213],[-87.87604,18.18313],[-87.86657,18.19971],[-87.85693,18.18266],[-87.84815,18.18511],[-86.92368,17.61462],[-85.9092,21.8218],[-96.92418,25.97377],[-97.13927,25.96583],[-97.35946,25.92189],[-97.37332,25.83854],[-97.42511,25.83969],[-97.45669,25.86874],[-97.49828,25.89877],[-97.52025,25.88518],[-97.66511,26.01708],[-97.95155,26.0625],[-97.97017,26.05232],[-98.24603,26.07191],[-98.27075,26.09457],[-98.30491,26.10475],[-98.35126,26.15129],[-99.00546,26.3925],[-99.03053,26.41249],[-99.08477,26.39849],[-99.53573,27.30926],[-99.49744,27.43746],[-99.482,27.47128],[-99.48045,27.49016],[-99.50208,27.50021],[-99.52955,27.49747],[-99.51478,27.55836],[-99.55409,27.61314],[-100.50029,28.66117],[-100.51222,28.70679],[-100.5075,28.74066],[-100.52313,28.75598],[-100.59809,28.88197],[-100.63689,28.90812],[-100.67294,29.09744],[-100.79696,29.24688],[-100.87982,29.296],[-100.94056,29.33371],[-100.94579,29.34523],[-100.96725,29.3477],[-101.01128,29.36947],[-101.05686,29.44738],[-101.47277,29.7744],[-102.60596,29.8192],[-103.15787,28.93865],[-104.37752,29.54255],[-104.39363,29.55396],[-104.3969,29.57105],[-104.5171,29.64671],[-104.77674,30.4236],[-106.00363,31.39181],[-106.09025,31.40569],[-106.20346,31.46305],[-106.23711,31.51262],[-106.24612,31.54193],[-106.28084,31.56173],[-106.30305,31.62154],[-106.33419,31.66303],[-106.34864,31.69663],[-106.3718,31.71165],[-106.38003,31.73151],[-106.41773,31.75196],[-106.43419,31.75478],[-106.45244,31.76523],[-106.46726,31.75998],[-106.47298,31.75054],[-106.48815,31.74769],[-106.50111,31.75714],[-106.50962,31.76155],[-106.51251,31.76922],[-106.52266,31.77509],[-106.529,31.784],[-108.20899,31.78534],[-108.20979,31.33316],[-111.07523,31.33232],[-114.82011,32.49609],[-114.79524,32.55731],[-114.81141,32.55543],[-114.80584,32.62028],[-114.76736,32.64094],[-114.71871,32.71894],[-115.88053,32.63624],[-117.1243,32.53427]]]]}},{type:"Feature",properties:{iso1A2:"MY",iso1A3:"MYS",iso1N3:"458",wikidata:"Q833",nameEn:"Malaysia"},geometry:null},{type:"Feature",properties:{iso1A2:"MZ",iso1A3:"MOZ",iso1N3:"508",wikidata:"Q1029",nameEn:"Mozambique",groups:["014","202","002","UN"],driveSide:"left",callingCodes:["258"]},geometry:{type:"MultiPolygon",coordinates:[[[[40.74206,-10.25691],[40.44265,-10.4618],[40.00295,-10.80255],[39.58249,-10.96043],[39.24395,-11.17433],[38.88996,-11.16978],[38.47258,-11.4199],[38.21598,-11.27289],[37.93618,-11.26228],[37.8388,-11.3123],[37.76614,-11.53352],[37.3936,-11.68949],[36.80309,-11.56836],[36.62068,-11.72884],[36.19094,-11.70008],[36.19094,-11.57593],[35.82767,-11.41081],[35.63599,-11.55927],[34.96296,-11.57354],[34.64241,-11.57499],[34.57917,-11.87849],[34.82903,-12.04837],[34.70739,-12.15652],[34.46088,-12.0174],[34.37831,-12.17408],[34.60253,-13.48487],[34.86229,-13.48958],[35.47989,-14.15594],[35.5299,-14.27714],[35.86945,-14.67481],[35.87212,-14.89478],[35.91812,-14.89514],[35.78799,-15.17428],[35.85303,-15.41913],[35.80487,-16.03907],[35.70107,-16.10147],[35.52365,-16.15414],[35.43355,-16.11371],[35.30157,-16.2211],[35.25828,-16.4792],[35.14235,-16.56812],[35.27219,-16.69402],[35.30929,-16.82871],[35.27065,-16.93817],[35.3062,-17.1244],[35.0923,-17.13235],[35.04805,-17.00027],[35.17017,-16.93521],[35.13771,-16.81687],[35.04805,-16.83167],[34.40344,-16.20923],[34.43126,-16.04737],[34.25195,-15.90321],[34.44981,-15.60864],[34.43126,-15.44778],[34.57503,-15.30619],[34.61522,-14.99583],[34.567,-14.77345],[34.54503,-14.74672],[34.52057,-14.68263],[34.53516,-14.67782],[34.55112,-14.64494],[34.53962,-14.59776],[34.52366,-14.5667],[34.49636,-14.55091],[34.48932,-14.53646],[34.47628,-14.53363],[34.45053,-14.49873],[34.44641,-14.47746],[34.4192,-14.43191],[34.39277,-14.39467],[34.35843,-14.38652],[34.34453,-14.3985],[34.22355,-14.43607],[34.18733,-14.43823],[34.08588,-14.48893],[33.92898,-14.47929],[33.88503,-14.51652],[33.7247,-14.4989],[33.66677,-14.61306],[33.24249,-14.00019],[30.22098,-14.99447],[30.41902,-15.62269],[30.42568,-15.9962],[30.91597,-15.99924],[30.97761,-16.05848],[31.13171,-15.98019],[31.30563,-16.01193],[31.42451,-16.15154],[31.67988,-16.19595],[31.90223,-16.34388],[31.91324,-16.41569],[32.02772,-16.43892],[32.28529,-16.43892],[32.42838,-16.4727],[32.71017,-16.59932],[32.69917,-16.66893],[32.78943,-16.70267],[32.97655,-16.70689],[32.91051,-16.89446],[32.84113,-16.92259],[32.96554,-17.11971],[33.00517,-17.30477],[33.0426,-17.3468],[32.96554,-17.48964],[32.98536,-17.55891],[33.0492,-17.60298],[32.94133,-17.99705],[33.03159,-18.35054],[33.02278,-18.4696],[32.88629,-18.51344],[32.88629,-18.58023],[32.95013,-18.69079],[32.9017,-18.7992],[32.82465,-18.77419],[32.70137,-18.84712],[32.73439,-18.92628],[32.69917,-18.94293],[32.72118,-19.02204],[32.84006,-19.0262],[32.87088,-19.09279],[32.85107,-19.29238],[32.77966,-19.36098],[32.78282,-19.47513],[32.84446,-19.48343],[32.84666,-19.68462],[32.95013,-19.67219],[33.06461,-19.77787],[33.01178,-20.02007],[32.93032,-20.03868],[32.85987,-20.16686],[32.85987,-20.27841],[32.66174,-20.56106],[32.55167,-20.56312],[32.48122,-20.63319],[32.51644,-20.91929],[32.37115,-21.133],[32.48236,-21.32873],[32.41234,-21.31246],[31.38336,-22.36919],[31.30611,-22.422],[31.55779,-23.176],[31.56539,-23.47268],[31.67942,-23.60858],[31.70223,-23.72695],[31.77445,-23.90082],[31.87707,-23.95293],[31.90368,-24.18892],[31.9835,-24.29983],[32.03196,-25.10785],[32.01676,-25.38117],[31.97875,-25.46356],[32.00631,-25.65044],[31.92649,-25.84216],[31.974,-25.95387],[32.00916,-25.999],[32.08599,-26.00978],[32.10435,-26.15656],[32.07352,-26.40185],[32.13409,-26.5317],[32.13315,-26.84345],[32.19409,-26.84032],[32.22302,-26.84136],[32.29584,-26.852],[32.35222,-26.86027],[34.51034,-26.91792],[42.99868,-12.65261],[40.74206,-10.25691]]]]}},{type:"Feature",properties:{iso1A2:"NA",iso1A3:"NAM",iso1N3:"516",wikidata:"Q1030",nameEn:"Namibia",groups:["018","202","002","UN"],driveSide:"left",callingCodes:["264"]},geometry:{type:"MultiPolygon",coordinates:[[[[14.28743,-17.38814],[13.95896,-17.43141],[13.36212,-16.98048],[12.97145,-16.98567],[12.52111,-17.24495],[12.07076,-17.15165],[11.75063,-17.25013],[10.5065,-17.25284],[12.51595,-32.27486],[16.45332,-28.63117],[16.46592,-28.57126],[16.59922,-28.53246],[16.90446,-28.057],[17.15405,-28.08573],[17.4579,-28.68718],[18.99885,-28.89165],[19.99882,-28.42622],[19.99817,-24.76768],[19.99912,-21.99991],[20.99751,-22.00026],[20.99904,-18.31743],[21.45556,-18.31795],[23.0996,-18.00075],[23.29618,-17.99855],[23.61088,-18.4881],[24.19416,-18.01919],[24.40577,-17.95726],[24.57485,-18.07151],[24.6303,-17.9863],[24.71887,-17.9218],[24.73364,-17.89338],[24.95586,-17.79674],[25.05895,-17.84452],[25.16882,-17.78253],[25.26433,-17.79571],[25.00198,-17.58221],[24.70864,-17.49501],[24.5621,-17.52963],[24.38712,-17.46818],[24.32811,-17.49082],[24.23619,-17.47489],[23.47474,-17.62877],[21.42741,-18.02787],[21.14283,-17.94318],[18.84226,-17.80375],[18.39229,-17.38927],[14.28743,-17.38814]]]]}},{type:"Feature",properties:{iso1A2:"NC",iso1A3:"NCL",iso1N3:"540",wikidata:"Q33788",nameEn:"New Caledonia",country:"FR",groups:["EU","Q1451600","054","009","UN"],callingCodes:["687"]},geometry:{type:"MultiPolygon",coordinates:[[[[159.77159,-28.41151],[174.245,-23.1974],[156.73836,-14.50464],[159.77159,-28.41151]]]]}},{type:"Feature",properties:{iso1A2:"NE",iso1A3:"NER",iso1N3:"562",wikidata:"Q1032",nameEn:"Niger",aliases:["RN"],groups:["011","202","002","UN"],callingCodes:["227"]},geometry:{type:"MultiPolygon",coordinates:[[[[14.22918,22.61719],[13.5631,23.16574],[11.96886,23.51735],[7.48273,20.87258],[7.38361,20.79165],[5.8153,19.45101],[4.26651,19.14224],[4.26762,17.00432],[4.21787,17.00118],[4.19893,16.39923],[3.50368,15.35934],[3.03134,15.42221],[3.01806,15.34571],[1.31275,15.27978],[.96711,14.98275],[.72632,14.95898],[.23859,15.00135],[.16936,14.51654],[.38051,14.05575],[.61924,13.68491],[.77377,13.6866],[.77637,13.64442],[.99514,13.5668],[1.02813,13.46635],[1.20088,13.38951],[1.24429,13.39373],[1.28509,13.35488],[1.24516,13.33968],[1.21217,13.37853],[1.18873,13.31771],[.99253,13.37515],[.99167,13.10727],[2.26349,12.41915],[2.05785,12.35539],[2.39723,11.89473],[2.45824,11.98672],[2.39657,12.10952],[2.37783,12.24804],[2.6593,12.30631],[2.83978,12.40585],[3.25352,12.01467],[3.31613,11.88495],[3.48187,11.86092],[3.59375,11.70269],[3.61075,11.69181],[3.67988,11.75429],[3.67122,11.80865],[3.63063,11.83042],[3.61955,11.91847],[3.67775,11.97599],[3.63136,12.11826],[3.66364,12.25884],[3.65111,12.52223],[3.94339,12.74979],[4.10006,12.98862],[4.14367,13.17189],[4.14186,13.47586],[4.23456,13.47725],[4.4668,13.68286],[4.87425,13.78],[4.9368,13.7345],[5.07396,13.75052],[5.21026,13.73627],[5.27797,13.75474],[5.35437,13.83567],[5.52957,13.8845],[6.15771,13.64564],[6.27411,13.67835],[6.43053,13.6006],[6.69617,13.34057],[6.94445,12.99825],[7.0521,13.00076],[7.12676,13.02445],[7.22399,13.1293],[7.39241,13.09717],[7.81085,13.34902],[8.07997,13.30847],[8.25185,13.20369],[8.41853,13.06166],[8.49493,13.07519],[8.60431,13.01768],[8.64251,12.93985],[8.97413,12.83661],[9.65995,12.80614],[10.00373,13.18171],[10.19993,13.27129],[10.46731,13.28819],[10.66004,13.36422],[11.4535,13.37773],[11.88236,13.2527],[12.04209,13.14452],[12.16189,13.10056],[12.19315,13.12423],[12.47095,13.06673],[12.58033,13.27805],[12.6793,13.29157],[12.87376,13.48919],[13.05085,13.53984],[13.19844,13.52802],[13.33213,13.71195],[13.6302,13.71094],[13.47559,14.40881],[13.48259,14.46704],[13.68573,14.55276],[13.67878,14.64013],[13.809,14.72915],[13.78991,14.87519],[13.86301,15.04043],[14.37425,15.72591],[15.50373,16.89649],[15.6032,18.77402],[15.75098,19.93002],[15.99632,20.35364],[15.6721,20.70069],[15.59841,20.74039],[15.56004,20.79488],[15.55382,20.86507],[15.57248,20.92138],[15.62515,20.95395],[15.28332,21.44557],[15.20213,21.49365],[15.19692,21.99339],[14.99751,23.00539],[14.22918,22.61719]]]]}},{type:"Feature",properties:{iso1A2:"NF",iso1A3:"NFK",iso1N3:"574",wikidata:"Q31057",nameEn:"Norfolk Island",country:"AU",groups:["053","009","UN"],driveSide:"left",callingCodes:["672 3"]},geometry:{type:"MultiPolygon",coordinates:[[[[169.82316,-28.16667],[166.29505,-28.29175],[167.94076,-30.60745],[169.82316,-28.16667]]]]}},{type:"Feature",properties:{iso1A2:"NG",iso1A3:"NGA",iso1N3:"566",wikidata:"Q1033",nameEn:"Nigeria",groups:["011","202","002","UN"],callingCodes:["234"]},geometry:{type:"MultiPolygon",coordinates:[[[[6.15771,13.64564],[5.52957,13.8845],[5.35437,13.83567],[5.27797,13.75474],[5.21026,13.73627],[5.07396,13.75052],[4.9368,13.7345],[4.87425,13.78],[4.4668,13.68286],[4.23456,13.47725],[4.14186,13.47586],[4.14367,13.17189],[4.10006,12.98862],[3.94339,12.74979],[3.65111,12.52223],[3.66364,12.25884],[3.63136,12.11826],[3.67775,11.97599],[3.61955,11.91847],[3.63063,11.83042],[3.67122,11.80865],[3.67988,11.75429],[3.61075,11.69181],[3.59375,11.70269],[3.49175,11.29765],[3.71505,11.13015],[3.84243,10.59316],[3.78292,10.40538],[3.6844,10.46351],[3.57275,10.27185],[3.66908,10.18136],[3.54429,9.87739],[3.35383,9.83641],[3.32099,9.78032],[3.34726,9.70696],[3.25093,9.61632],[3.13928,9.47167],[3.14147,9.28375],[3.08017,9.10006],[2.77907,9.06924],[2.67523,7.87825],[2.73095,7.7755],[2.73405,7.5423],[2.78668,7.5116],[2.79442,7.43486],[2.74489,7.42565],[2.76965,7.13543],[2.71702,6.95722],[2.74024,6.92802],[2.73405,6.78508],[2.78823,6.76356],[2.78204,6.70514],[2.7325,6.64057],[2.74334,6.57291],[2.70464,6.50831],[2.70566,6.38038],[2.74181,6.13349],[5.87055,3.78489],[8.34397,4.30689],[8.60302,4.87353],[8.78027,5.1243],[8.92029,5.58403],[8.83687,5.68483],[8.88156,5.78857],[8.84209,5.82562],[9.51757,6.43874],[9.70674,6.51717],[9.77824,6.79088],[9.86314,6.77756],[10.15135,7.03781],[10.21466,6.88996],[10.53639,6.93432],[10.57214,7.16345],[10.59746,7.14719],[10.60789,7.06885],[10.83727,6.9358],[10.8179,6.83377],[10.94302,6.69325],[11.09644,6.68437],[11.09495,6.51717],[11.42041,6.53789],[11.42264,6.5882],[11.51499,6.60892],[11.57755,6.74059],[11.55818,6.86186],[11.63117,6.9905],[11.87396,7.09398],[11.84864,7.26098],[11.93205,7.47812],[12.01844,7.52981],[11.99908,7.67302],[12.20909,7.97553],[12.19271,8.10826],[12.24782,8.17904],[12.26123,8.43696],[12.4489,8.52536],[12.44146,8.6152],[12.68722,8.65938],[12.71701,8.7595],[12.79,8.75361],[12.81085,8.91992],[12.90022,9.11411],[12.91958,9.33905],[12.85628,9.36698],[13.02385,9.49334],[13.22642,9.57266],[13.25472,9.76795],[13.29941,9.8296],[13.25025,9.86042],[13.24132,9.91031],[13.27409,9.93232],[13.286,9.9822],[13.25323,10.00127],[13.25025,10.03647],[13.34111,10.12299],[13.43644,10.13326],[13.5705,10.53183],[13.54964,10.61236],[13.73434,10.9255],[13.70753,10.94451],[13.7403,11.00593],[13.78945,11.00154],[13.97489,11.30258],[14.17821,11.23831],[14.6124,11.51283],[14.64591,11.66166],[14.55207,11.72001],[14.61612,11.7798],[14.6474,12.17466],[14.4843,12.35223],[14.22215,12.36533],[14.17523,12.41916],[14.20204,12.53405],[14.08251,13.0797],[13.6302,13.71094],[13.33213,13.71195],[13.19844,13.52802],[13.05085,13.53984],[12.87376,13.48919],[12.6793,13.29157],[12.58033,13.27805],[12.47095,13.06673],[12.19315,13.12423],[12.16189,13.10056],[12.04209,13.14452],[11.88236,13.2527],[11.4535,13.37773],[10.66004,13.36422],[10.46731,13.28819],[10.19993,13.27129],[10.00373,13.18171],[9.65995,12.80614],[8.97413,12.83661],[8.64251,12.93985],[8.60431,13.01768],[8.49493,13.07519],[8.41853,13.06166],[8.25185,13.20369],[8.07997,13.30847],[7.81085,13.34902],[7.39241,13.09717],[7.22399,13.1293],[7.12676,13.02445],[7.0521,13.00076],[6.94445,12.99825],[6.69617,13.34057],[6.43053,13.6006],[6.27411,13.67835],[6.15771,13.64564]]]]}},{type:"Feature",properties:{iso1A2:"NI",iso1A3:"NIC",iso1N3:"558",wikidata:"Q811",nameEn:"Nicaragua",groups:["013","003","419","019","UN"],callingCodes:["505"]},geometry:{type:"MultiPolygon",coordinates:[[[[-83.13724,15.00002],[-83.49268,15.01158],[-83.62101,14.89448],[-83.89551,14.76697],[-84.10584,14.76353],[-84.48373,14.63249],[-84.70119,14.68078],[-84.82596,14.82212],[-84.90082,14.80489],[-85.1575,14.53934],[-85.18602,14.24929],[-85.32149,14.2562],[-85.45762,14.11304],[-85.73964,13.9698],[-85.75477,13.8499],[-86.03458,13.99181],[-86.00685,14.08474],[-86.14801,14.04317],[-86.35219,13.77157],[-86.76812,13.79605],[-86.71267,13.30348],[-86.87066,13.30641],[-86.93383,13.18677],[-86.93197,13.05313],[-87.03785,12.98682],[-87.06306,13.00892],[-87.37107,12.98646],[-87.55124,13.12523],[-87.7346,13.13228],[-88.11443,12.63306],[-86.14524,11.09059],[-85.71223,11.06868],[-85.60529,11.22607],[-84.92439,10.9497],[-84.68197,11.07568],[-83.90838,10.71161],[-83.66597,10.79916],[-83.68276,11.01562],[-82.56142,11.91792],[-82.06974,14.49418],[-83.04763,15.03256],[-83.13724,15.00002]]]]}},{type:"Feature",properties:{iso1A2:"NL",iso1A3:"NLD",iso1N3:"528",wikidata:"Q29999",nameEn:"Kingdom of the Netherlands"},geometry:null},{type:"Feature",properties:{iso1A2:"NO",iso1A3:"NOR",iso1N3:"578",wikidata:"Q20",nameEn:"Norway"},geometry:null},{type:"Feature",properties:{iso1A2:"NP",iso1A3:"NPL",iso1N3:"524",wikidata:"Q837",nameEn:"Nepal",groups:["034","142","UN"],driveSide:"left",callingCodes:["977"]},geometry:{type:"MultiPolygon",coordinates:[[[[88.13378,27.88015],[87.82681,27.95248],[87.72718,27.80938],[87.56996,27.84517],[87.11696,27.84104],[87.03757,27.94835],[86.75582,28.04182],[86.74181,28.10638],[86.56265,28.09569],[86.51609,27.96623],[86.42736,27.91122],[86.22966,27.9786],[86.18607,28.17364],[86.088,28.09264],[86.08333,28.02121],[86.12069,27.93047],[86.06309,27.90021],[85.94946,27.9401],[85.97813,27.99023],[85.90743,28.05144],[85.84672,28.18187],[85.74864,28.23126],[85.71907,28.38064],[85.69105,28.38475],[85.60854,28.25045],[85.59765,28.30529],[85.4233,28.32996],[85.38127,28.28336],[85.10729,28.34092],[85.18668,28.54076],[85.19135,28.62825],[85.06059,28.68562],[84.85511,28.58041],[84.62317,28.73887],[84.47528,28.74023],[84.2231,28.89571],[84.24801,29.02783],[84.18107,29.23451],[83.97559,29.33091],[83.82303,29.30513],[83.63156,29.16249],[83.44787,29.30513],[83.28131,29.56813],[83.07116,29.61957],[82.73024,29.81695],[82.5341,29.9735],[82.38622,30.02608],[82.16984,30.0692],[82.19475,30.16884],[82.10757,30.23745],[82.10135,30.35439],[81.99082,30.33423],[81.62033,30.44703],[81.5459,30.37688],[81.41018,30.42153],[81.39928,30.21862],[81.33355,30.15303],[81.2623,30.14596],[81.29032,30.08806],[81.24362,30.0126],[81.12842,30.01395],[81.03953,30.20059],[80.92547,30.17193],[80.91143,30.22173],[80.86673,30.17321],[80.8778,30.13384],[80.67076,29.95732],[80.60226,29.95732],[80.57179,29.91422],[80.56247,29.86661],[80.48997,29.79566],[80.43458,29.80466],[80.41554,29.79451],[80.36803,29.73865],[80.38428,29.68513],[80.41858,29.63581],[80.37939,29.57098],[80.24322,29.44299],[80.31428,29.30784],[80.28626,29.20327],[80.24112,29.21414],[80.26602,29.13938],[80.23178,29.11626],[80.18085,29.13649],[80.05743,28.91479],[80.06957,28.82763],[80.12125,28.82346],[80.37188,28.63371],[80.44504,28.63098],[80.52443,28.54897],[80.50575,28.6706],[80.55142,28.69182],[81.03471,28.40054],[81.19847,28.36284],[81.32923,28.13521],[81.38683,28.17638],[81.48179,28.12148],[81.47867,28.08303],[81.91223,27.84995],[81.97214,27.93322],[82.06554,27.92222],[82.46405,27.6716],[82.70378,27.72122],[82.74119,27.49838],[82.93261,27.50328],[82.94938,27.46036],[83.19413,27.45632],[83.27197,27.38309],[83.2673,27.36235],[83.29999,27.32778],[83.35136,27.33885],[83.38872,27.39276],[83.39495,27.4798],[83.61288,27.47013],[83.85595,27.35797],[83.86182,27.4241],[83.93306,27.44939],[84.02229,27.43836],[84.10791,27.52399],[84.21376,27.45218],[84.25735,27.44941],[84.29315,27.39],[84.62161,27.33885],[84.69166,27.21294],[84.64496,27.04669],[84.793,26.9968],[84.82913,27.01989],[84.85754,26.98984],[84.96687,26.95599],[84.97186,26.9149],[85.00536,26.89523],[85.05592,26.88991],[85.02635,26.85381],[85.15883,26.86966],[85.19291,26.86909],[85.18046,26.80519],[85.21159,26.75933],[85.34302,26.74954],[85.47752,26.79292],[85.56471,26.84133],[85.5757,26.85955],[85.59461,26.85161],[85.61621,26.86721],[85.66239,26.84822],[85.73483,26.79613],[85.72315,26.67471],[85.76907,26.63076],[85.83126,26.61134],[85.85126,26.60866],[85.8492,26.56667],[86.02729,26.66756],[86.13596,26.60651],[86.22513,26.58863],[86.26235,26.61886],[86.31564,26.61925],[86.49726,26.54218],[86.54258,26.53819],[86.57073,26.49825],[86.61313,26.48658],[86.62686,26.46891],[86.69124,26.45169],[86.74025,26.42386],[86.76797,26.45892],[86.82898,26.43919],[86.94543,26.52076],[86.95912,26.52076],[87.01559,26.53228],[87.04691,26.58685],[87.0707,26.58571],[87.09147,26.45039],[87.14751,26.40542],[87.18863,26.40558],[87.24682,26.4143],[87.26587,26.40592],[87.26568,26.37294],[87.34568,26.34787],[87.37314,26.40815],[87.46566,26.44058],[87.51571,26.43106],[87.55274,26.40596],[87.59175,26.38342],[87.66803,26.40294],[87.67893,26.43501],[87.76004,26.40711],[87.7918,26.46737],[87.84193,26.43663],[87.89085,26.48565],[87.90115,26.44923],[88.00895,26.36029],[88.09414,26.43732],[88.09963,26.54195],[88.16452,26.64111],[88.1659,26.68177],[88.19107,26.75516],[88.12302,26.95324],[88.13422,26.98705],[88.11719,26.98758],[87.9887,27.11045],[88.01587,27.21388],[88.01646,27.21612],[88.07277,27.43007],[88.04008,27.49223],[88.19107,27.79285],[88.1973,27.85067],[88.13378,27.88015]]]]}},{type:"Feature",properties:{iso1A2:"NR",iso1A3:"NRU",iso1N3:"520",wikidata:"Q697",nameEn:"Nauru",groups:["057","009","UN"],driveSide:"left",callingCodes:["674"]},geometry:{type:"MultiPolygon",coordinates:[[[[166.95155,.14829],[166.21778,-.7977],[167.60042,-.88259],[166.95155,.14829]]]]}},{type:"Feature",properties:{iso1A2:"NU",iso1A3:"NIU",iso1N3:"570",wikidata:"Q34020",nameEn:"Niue",country:"NZ",groups:["061","009","UN"],driveSide:"left",callingCodes:["683"]},geometry:{type:"MultiPolygon",coordinates:[[[[-170.83899,-18.53439],[-170.82274,-20.44429],[-168.63096,-18.60489],[-170.83899,-18.53439]]]]}},{type:"Feature",properties:{iso1A2:"NZ",iso1A3:"NZL",iso1N3:"554",wikidata:"Q664",nameEn:"New Zealand"},geometry:null},{type:"Feature",properties:{iso1A2:"OM",iso1A3:"OMN",iso1N3:"512",wikidata:"Q842",nameEn:"Oman",groups:["145","142","UN"],callingCodes:["968"]},geometry:{type:"MultiPolygon",coordinates:[[[[56.82555,25.7713],[56.79239,26.41236],[56.68954,26.76645],[56.2644,26.58649],[55.81777,26.18798],[56.08666,26.05038],[56.15498,26.06828],[56.19334,25.9795],[56.13963,25.82765],[56.17416,25.77239],[56.13579,25.73524],[56.14826,25.66351],[56.18363,25.65508],[56.20473,25.61119],[56.25365,25.60211],[56.26636,25.60643],[56.25341,25.61443],[56.26534,25.62825],[56.82555,25.7713]]],[[[56.26062,25.33108],[56.23362,25.31253],[56.25008,25.28843],[56.24465,25.27505],[56.20838,25.25668],[56.20872,25.24104],[56.24341,25.22867],[56.27628,25.23404],[56.34438,25.26653],[56.35172,25.30681],[56.3111,25.30107],[56.3005,25.31815],[56.26062,25.33108]],[[56.28423,25.26344],[56.27086,25.26128],[56.2716,25.27916],[56.28102,25.28486],[56.29379,25.2754],[56.28423,25.26344]]],[[[61.45114,22.55394],[56.86325,25.03856],[56.3227,24.97284],[56.34873,24.93205],[56.30269,24.88334],[56.20568,24.85063],[56.20062,24.78565],[56.13684,24.73699],[56.06128,24.74457],[56.03535,24.81161],[55.97836,24.87673],[55.97467,24.89639],[56.05106,24.87461],[56.05715,24.95727],[55.96316,25.00857],[55.90849,24.96771],[55.85094,24.96858],[55.81116,24.9116],[55.81348,24.80102],[55.83408,24.77858],[55.83271,24.68567],[55.76461,24.5287],[55.83271,24.41521],[55.83395,24.32776],[55.80747,24.31069],[55.79145,24.27914],[55.76781,24.26209],[55.75939,24.26114],[55.75382,24.2466],[55.75257,24.23466],[55.76558,24.23227],[55.77658,24.23476],[55.83367,24.20193],[55.95472,24.2172],[56.01799,24.07426],[55.8308,24.01633],[55.73301,24.05994],[55.48677,23.94946],[55.57358,23.669],[55.22634,23.10378],[55.2137,22.71065],[55.66469,21.99658],[54.99756,20.00083],[52.00311,19.00083],[52.78009,17.35124],[52.74267,17.29519],[52.81185,17.28568],[57.49095,8.14549],[61.45114,22.55394]]]]}},{type:"Feature",properties:{iso1A2:"PA",iso1A3:"PAN",iso1N3:"591",wikidata:"Q804",nameEn:"Panama",groups:["013","003","419","019","UN"],callingCodes:["507"]},geometry:{type:"MultiPolygon",coordinates:[[[[-77.32389,8.81247],[-77.58292,9.22278],[-78.79327,9.93766],[-82.51044,9.65379],[-82.56507,9.57279],[-82.61345,9.49881],[-82.66667,9.49746],[-82.77206,9.59573],[-82.87919,9.62645],[-82.84871,9.4973],[-82.93516,9.46741],[-82.93516,9.07687],[-82.72126,8.97125],[-82.88253,8.83331],[-82.91377,8.774],[-82.92068,8.74832],[-82.8794,8.6981],[-82.82739,8.60153],[-82.83975,8.54755],[-82.83322,8.52464],[-82.8382,8.48117],[-82.8679,8.44042],[-82.93056,8.43465],[-83.05209,8.33394],[-82.9388,8.26634],[-82.88641,8.10219],[-82.89137,8.05755],[-82.89978,8.04083],[-82.94503,7.93865],[-82.13751,6.97312],[-78.06168,7.07793],[-77.89178,7.22681],[-77.81426,7.48319],[-77.72157,7.47612],[-77.72514,7.72348],[-77.57185,7.51147],[-77.17257,7.97422],[-77.45064,8.49991],[-77.32389,8.81247]]]]}},{type:"Feature",properties:{iso1A2:"PE",iso1A3:"PER",iso1N3:"604",wikidata:"Q419",nameEn:"Peru",groups:["005","419","019","UN"],callingCodes:["51"]},geometry:{type:"MultiPolygon",coordinates:[[[[-74.26675,-.97229],[-74.42701,-.50218],[-75.18513,-.0308],[-75.25764,-.11943],[-75.40192,-.17196],[-75.61997,-.10012],[-75.60169,-.18708],[-75.53615,-.19213],[-75.22862,-.60048],[-75.22862,-.95588],[-75.3872,-.9374],[-75.57429,-1.55961],[-76.05203,-2.12179],[-76.6324,-2.58397],[-77.94147,-3.05454],[-78.19369,-3.36431],[-78.14324,-3.47653],[-78.22642,-3.51113],[-78.24589,-3.39907],[-78.34362,-3.38633],[-78.68394,-4.60754],[-78.85149,-4.66795],[-79.01659,-5.01481],[-79.1162,-4.97774],[-79.26248,-4.95167],[-79.59402,-4.46848],[-79.79722,-4.47558],[-80.13945,-4.29786],[-80.39256,-4.48269],[-80.46386,-4.41516],[-80.32114,-4.21323],[-80.45023,-4.20938],[-80.4822,-4.05477],[-80.46386,-4.01342],[-80.13232,-3.90317],[-80.19926,-3.68894],[-80.18741,-3.63994],[-80.19848,-3.59249],[-80.21642,-3.5888],[-80.20535,-3.51667],[-80.22629,-3.501],[-80.23651,-3.48652],[-80.24586,-3.48677],[-80.24123,-3.46124],[-80.20647,-3.431],[-80.30602,-3.39149],[-84.52388,-3.36941],[-85.71054,-21.15413],[-70.59118,-18.35072],[-70.378,-18.3495],[-70.31267,-18.31258],[-70.16394,-18.31737],[-69.96732,-18.25992],[-69.81607,-18.12582],[-69.75305,-17.94605],[-69.82868,-17.72048],[-69.79087,-17.65563],[-69.66483,-17.65083],[-69.46897,-17.4988],[-69.46863,-17.37466],[-69.62883,-17.28142],[-69.16896,-16.72233],[-69.00853,-16.66769],[-69.04027,-16.57214],[-68.98358,-16.42165],[-68.79464,-16.33272],[-68.96238,-16.194],[-69.09986,-16.22693],[-69.20291,-16.16668],[-69.40336,-15.61358],[-69.14856,-15.23478],[-69.36254,-14.94634],[-68.88135,-14.18639],[-69.05265,-13.68546],[-68.8864,-13.40792],[-68.85615,-12.87769],[-68.65044,-12.50689],[-68.98115,-11.8979],[-69.57156,-10.94555],[-69.57835,-10.94051],[-69.90896,-10.92744],[-70.38791,-11.07096],[-70.51395,-10.92249],[-70.64134,-11.0108],[-70.62487,-9.80666],[-70.55429,-9.76692],[-70.58453,-9.58303],[-70.53373,-9.42628],[-71.23394,-9.9668],[-72.14742,-9.98049],[-72.31883,-9.5184],[-72.72216,-9.41397],[-73.21498,-9.40904],[-72.92886,-9.04074],[-73.76576,-7.89884],[-73.65485,-7.77897],[-73.96938,-7.58465],[-73.77011,-7.28944],[-73.73986,-6.87919],[-73.12983,-6.43852],[-73.24579,-6.05764],[-72.83973,-5.14765],[-72.64391,-5.0391],[-71.87003,-4.51661],[-70.96814,-4.36915],[-70.77601,-4.15717],[-70.33236,-4.15214],[-70.19582,-4.3607],[-70.11305,-4.27281],[-70.00888,-4.37833],[-69.94708,-4.2431],[-70.3374,-3.79505],[-70.52393,-3.87553],[-70.71396,-3.7921],[-70.04609,-2.73906],[-70.94377,-2.23142],[-71.75223,-2.15058],[-72.92587,-2.44514],[-73.65312,-1.26222],[-74.26675,-.97229]]]]}},{type:"Feature",properties:{iso1A2:"PF",iso1A3:"PYF",iso1N3:"258",wikidata:"Q30971",nameEn:"French Polynesia",country:"FR",groups:["EU","Q1451600","061","009","UN"],callingCodes:["689"]},geometry:{type:"MultiPolygon",coordinates:[[[[-135.59706,-4.70473],[-156.48634,-15.52824],[-156.45576,-31.75456],[-133.59543,-28.4709],[-135.59706,-4.70473]]]]}},{type:"Feature",properties:{iso1A2:"PG",iso1A3:"PNG",iso1N3:"598",wikidata:"Q691",nameEn:"Papua New Guinea",groups:["054","009","UN"],driveSide:"left",callingCodes:["675"]},geometry:{type:"MultiPolygon",coordinates:[[[[141.03157,2.12829],[140.99813,-6.3233],[140.85295,-6.72996],[140.90448,-6.85033],[141.01763,-6.90181],[141.01842,-9.35091],[141.88934,-9.36111],[142.19246,-9.15378],[142.48658,-9.36754],[143.29772,-9.33993],[143.87386,-9.02382],[145.2855,-9.62524],[156.73836,-14.50464],[154.74815,-7.33315],[155.60735,-6.92266],[155.69784,-6.92661],[155.92557,-6.84664],[156.03993,-6.65703],[156.03296,-6.55528],[160.43769,-4.17974],[141.03157,2.12829]]]]}},{type:"Feature",properties:{iso1A2:"PH",iso1A3:"PHL",iso1N3:"608",wikidata:"Q928",nameEn:"Philippines",aliases:["PI","RP"],groups:["035","142","UN"],callingCodes:["63"]},geometry:{type:"MultiPolygon",coordinates:[[[[129.19694,7.84182],[121.8109,21.77688],[120.69238,21.52331],[118.82252,14.67191],[115.39742,10.92666],[116.79524,7.43869],[117.17735,7.52841],[117.93857,6.89845],[117.98544,6.27477],[119.52945,5.35672],[118.93936,4.09009],[118.06469,4.16638],[121.14448,2.12444],[129.19694,7.84182]]]]}},{type:"Feature",properties:{iso1A2:"PK",iso1A3:"PAK",iso1N3:"586",wikidata:"Q843",nameEn:"Pakistan",groups:["034","142","UN"],driveSide:"left",callingCodes:["92"]},geometry:{type:"MultiPolygon",coordinates:[[[[75.72737,36.7529],[75.45562,36.71971],[75.40481,36.95382],[75.13839,37.02622],[74.56453,37.03023],[74.53739,36.96224],[74.43389,37.00977],[74.04856,36.82648],[73.82685,36.91421],[72.6323,36.84601],[72.18135,36.71838],[71.80267,36.49924],[71.60491,36.39429],[71.19505,36.04134],[71.37969,35.95865],[71.55273,35.71483],[71.49917,35.6267],[71.65435,35.4479],[71.54294,35.31037],[71.5541,35.28776],[71.67495,35.21262],[71.52938,35.09023],[71.55273,35.02615],[71.49917,35.00478],[71.50329,34.97328],[71.29472,34.87728],[71.28356,34.80882],[71.08718,34.69034],[71.11602,34.63047],[71.0089,34.54568],[71.02401,34.44835],[71.17662,34.36769],[71.12815,34.26619],[71.13078,34.16503],[71.09453,34.13524],[71.09307,34.11961],[71.06933,34.10564],[71.07345,34.06242],[70.88119,33.97933],[70.54336,33.9463],[69.90203,34.04194],[69.87307,33.9689],[69.85671,33.93719],[70.00503,33.73528],[70.14236,33.71701],[70.14785,33.6553],[70.20141,33.64387],[70.17062,33.53535],[70.32775,33.34496],[70.13686,33.21064],[70.07369,33.22557],[70.02563,33.14282],[69.85259,33.09451],[69.79766,33.13247],[69.71526,33.09911],[69.57656,33.09911],[69.49004,33.01509],[69.49854,32.88843],[69.5436,32.8768],[69.47082,32.85834],[69.38018,32.76601],[69.43649,32.7302],[69.44747,32.6678],[69.38155,32.56601],[69.2868,32.53938],[69.23599,32.45946],[69.27932,32.29119],[69.27032,32.14141],[69.3225,31.93186],[69.20577,31.85957],[69.11514,31.70782],[69.00939,31.62249],[68.95995,31.64822],[68.91078,31.59687],[68.79997,31.61665],[68.6956,31.75687],[68.57475,31.83158],[68.44222,31.76446],[68.27605,31.75863],[68.25614,31.80357],[68.1655,31.82691],[68.00071,31.6564],[67.86887,31.63536],[67.72056,31.52304],[67.58323,31.52772],[67.62374,31.40473],[67.7748,31.4188],[67.78854,31.33203],[67.29964,31.19586],[67.03323,31.24519],[67.04147,31.31561],[66.83273,31.26867],[66.72561,31.20526],[66.68166,31.07597],[66.58175,30.97532],[66.42645,30.95309],[66.39194,30.9408],[66.28413,30.57001],[66.34869,30.404],[66.23609,30.06321],[66.36042,29.9583],[66.24175,29.85181],[65.04005,29.53957],[64.62116,29.58903],[64.19796,29.50407],[64.12966,29.39157],[63.5876,29.50456],[62.47751,29.40782],[60.87231,29.86514],[61.31508,29.38903],[61.53765,29.00507],[61.65978,28.77937],[61.93581,28.55284],[62.40259,28.42703],[62.59499,28.24842],[62.79412,28.28108],[62.7638,28.02992],[62.84905,27.47627],[62.79684,27.34381],[62.80604,27.22412],[63.19649,27.25674],[63.32283,27.14437],[63.25005,27.08692],[63.25005,26.84212],[63.18688,26.83844],[63.1889,26.65072],[62.77352,26.64099],[62.31484,26.528],[62.21304,26.26601],[62.05117,26.31647],[61.89391,26.26251],[61.83831,26.07249],[61.83968,25.7538],[61.683,25.66638],[61.6433,25.27541],[61.46682,24.57869],[68.11329,23.53945],[68.20763,23.85849],[68.39339,23.96838],[68.74643,23.97027],[68.7416,24.31904],[68.90914,24.33156],[68.97781,24.26021],[69.07806,24.29777],[69.19341,24.25646],[69.29778,24.28712],[69.59579,24.29777],[69.73335,24.17007],[70.03428,24.172],[70.11712,24.30915],[70.5667,24.43787],[70.57906,24.27774],[70.71502,24.23517],[70.88393,24.27398],[70.85784,24.30903],[70.94985,24.3791],[71.04461,24.34657],[71.12838,24.42662],[71.00341,24.46038],[70.97594,24.60904],[71.09405,24.69017],[70.94002,24.92843],[70.89148,25.15064],[70.66695,25.39314],[70.67382,25.68186],[70.60378,25.71898],[70.53649,25.68928],[70.37444,25.67443],[70.2687,25.71156],[70.0985,25.93238],[70.08193,26.08094],[70.17532,26.24118],[70.17532,26.55362],[70.05584,26.60398],[69.88555,26.56836],[69.50904,26.74892],[69.58519,27.18109],[70.03136,27.56627],[70.12502,27.8057],[70.37307,28.01208],[70.60927,28.02178],[70.79054,27.68423],[71.89921,27.96035],[71.9244,28.11555],[72.20329,28.3869],[72.29495,28.66367],[72.40402,28.78283],[72.94272,29.02487],[73.01337,29.16422],[73.05886,29.1878],[73.28094,29.56646],[73.3962,29.94707],[73.58665,30.01848],[73.80299,30.06969],[73.97225,30.19829],[73.95736,30.28466],[73.88993,30.36305],[74.5616,31.04153],[74.67971,31.05479],[74.6852,31.12771],[74.60006,31.13711],[74.60281,31.10419],[74.56023,31.08303],[74.51629,31.13829],[74.53223,31.30321],[74.59773,31.4136],[74.64713,31.45605],[74.59319,31.50197],[74.61517,31.55698],[74.57498,31.60382],[74.47771,31.72227],[74.58907,31.87824],[74.79919,31.95983],[74.86236,32.04485],[74.9269,32.0658],[75.00793,32.03786],[75.25649,32.10187],[75.38046,32.26836],[75.28259,32.36556],[75.03265,32.49538],[74.97634,32.45367],[74.84725,32.49075],[74.68362,32.49298],[74.67431,32.56676],[74.65251,32.56416],[74.64424,32.60985],[74.69542,32.66792],[74.65345,32.71225],[74.7113,32.84219],[74.64675,32.82604],[74.6289,32.75561],[74.45312,32.77755],[74.41467,32.90563],[74.31227,32.92795],[74.34875,32.97823],[74.31854,33.02891],[74.17571,33.07495],[74.15374,33.13477],[74.02144,33.18908],[74.01366,33.25199],[74.08782,33.26232],[74.17983,33.3679],[74.18121,33.4745],[74.10115,33.56392],[74.03576,33.56718],[73.97367,33.64061],[73.98968,33.66155],[73.96423,33.73071],[74.00891,33.75437],[74.05898,33.82089],[74.14001,33.83002],[74.26086,33.92237],[74.25262,34.01577],[74.21554,34.03853],[73.91341,34.01235],[73.88732,34.05105],[73.90677,34.10504],[73.98208,34.2522],[73.90517,34.35317],[73.8475,34.32935],[73.74862,34.34183],[73.74999,34.3781],[73.88732,34.48911],[73.89419,34.54568],[73.93951,34.57169],[73.93401,34.63386],[73.96423,34.68244],[74.12897,34.70073],[74.31239,34.79626],[74.58083,34.77386],[74.6663,34.703],[75.01479,34.64629],[75.38009,34.55021],[75.75438,34.51827],[76.04614,34.67566],[76.15463,34.6429],[76.47186,34.78965],[76.67648,34.76371],[76.74377,34.84039],[76.74514,34.92488],[76.87193,34.96906],[76.99251,34.93349],[77.11796,35.05419],[76.93465,35.39866],[76.85088,35.39754],[76.75475,35.52617],[76.77323,35.66062],[76.50961,35.8908],[76.33453,35.84296],[76.14913,35.82848],[76.15325,35.9264],[75.93028,36.13136],[76.00906,36.17511],[76.0324,36.41198],[75.92391,36.56986],[75.72737,36.7529]]]]}},{type:"Feature",properties:{iso1A2:"PL",iso1A3:"POL",iso1N3:"616",wikidata:"Q36",nameEn:"Poland",groups:["EU","151","150","UN"],callingCodes:["48"]},geometry:{type:"MultiPolygon",coordinates:[[[[18.57853,55.25302],[14.20811,54.12784],[14.22634,53.9291],[14.20647,53.91671],[14.18544,53.91258],[14.20823,53.90776],[14.21323,53.8664],[14.27249,53.74464],[14.26782,53.69866],[14.2836,53.67721],[14.27133,53.66613],[14.28477,53.65955],[14.2853,53.63392],[14.31904,53.61581],[14.30416,53.55499],[14.3273,53.50587],[14.35209,53.49506],[14.4215,53.27724],[14.44133,53.27427],[14.45125,53.26241],[14.40662,53.21098],[14.37853,53.20405],[14.36696,53.16444],[14.38679,53.13669],[14.35044,53.05829],[14.25954,53.00264],[14.14056,52.95786],[14.15873,52.87715],[14.12256,52.84311],[14.13806,52.82392],[14.22071,52.81175],[14.61073,52.59847],[14.6289,52.57136],[14.60081,52.53116],[14.63056,52.48993],[14.54423,52.42568],[14.55228,52.35264],[14.56378,52.33838],[14.58149,52.28007],[14.70139,52.25038],[14.71319,52.22144],[14.68344,52.19612],[14.70616,52.16927],[14.67683,52.13936],[14.6917,52.10283],[14.72971,52.09167],[14.76026,52.06624],[14.71339,52.00337],[14.70488,51.97679],[14.7139,51.95643],[14.71836,51.95606],[14.72163,51.95188],[14.7177,51.94048],[14.70601,51.92944],[14.6933,51.9044],[14.6588,51.88359],[14.59089,51.83302],[14.60493,51.80473],[14.64625,51.79472],[14.66386,51.73282],[14.69065,51.70842],[14.75392,51.67445],[14.75759,51.62318],[14.7727,51.61263],[14.71125,51.56209],[14.73047,51.54606],[14.72652,51.53902],[14.73219,51.52922],[14.94749,51.47155],[14.9652,51.44793],[14.96899,51.38367],[14.98008,51.33449],[15.04288,51.28387],[15.01242,51.21285],[15.0047,51.16874],[14.99311,51.16249],[14.99414,51.15813],[15.00083,51.14974],[14.99646,51.14365],[14.99079,51.14284],[14.99689,51.12205],[14.98229,51.11354],[14.97938,51.07742],[14.95529,51.04552],[14.92942,50.99744],[14.89252,50.94999],[14.89681,50.9422],[14.81664,50.88148],[14.82803,50.86966],[14.99852,50.86817],[15.01088,50.97984],[14.96419,50.99108],[15.02433,51.0242],[15.03895,51.0123],[15.06218,51.02269],[15.10152,51.01095],[15.11937,50.99021],[15.16744,51.01959],[15.1743,50.9833],[15.2361,50.99886],[15.27043,50.97724],[15.2773,50.8907],[15.36656,50.83956],[15.3803,50.77187],[15.43798,50.80833],[15.73186,50.73885],[15.81683,50.75666],[15.87331,50.67188],[15.97219,50.69799],[16.0175,50.63009],[15.98317,50.61528],[16.02437,50.60046],[16.10265,50.66405],[16.20839,50.63096],[16.23174,50.67101],[16.33611,50.66579],[16.44597,50.58041],[16.34572,50.49575],[16.31413,50.50274],[16.19526,50.43291],[16.21585,50.40627],[16.22821,50.41054],[16.28118,50.36891],[16.30289,50.38292],[16.36495,50.37679],[16.3622,50.34875],[16.39379,50.3207],[16.42674,50.32509],[16.56407,50.21009],[16.55446,50.16613],[16.63137,50.1142],[16.7014,50.09659],[16.8456,50.20834],[16.98018,50.24172],[17.00353,50.21449],[17.02825,50.23118],[16.99803,50.25753],[17.02138,50.27772],[16.99803,50.30316],[16.94448,50.31281],[16.90877,50.38642],[16.85933,50.41093],[16.89229,50.45117],[17.1224,50.39494],[17.14498,50.38117],[17.19579,50.38817],[17.19991,50.3654],[17.27681,50.32246],[17.34273,50.32947],[17.34548,50.2628],[17.3702,50.28123],[17.58889,50.27837],[17.67764,50.28977],[17.69292,50.32859],[17.74648,50.29966],[17.72176,50.25665],[17.76296,50.23382],[17.70528,50.18812],[17.59404,50.16437],[17.66683,50.10275],[17.6888,50.12037],[17.7506,50.07896],[17.77669,50.02253],[17.86886,49.97452],[18.00191,50.01723],[18.04585,50.01194],[18.04585,50.03311],[18.00396,50.04954],[18.03212,50.06574],[18.07898,50.04535],[18.10628,50.00223],[18.20241,49.99958],[18.21752,49.97309],[18.27107,49.96779],[18.27794,49.93863],[18.31914,49.91565],[18.33278,49.92415],[18.33562,49.94747],[18.41604,49.93498],[18.53423,49.89906],[18.54495,49.9079],[18.54299,49.92537],[18.57697,49.91565],[18.57045,49.87849],[18.60341,49.86256],[18.57183,49.83334],[18.61278,49.7618],[18.61368,49.75426],[18.62645,49.75002],[18.62943,49.74603],[18.62676,49.71983],[18.69817,49.70473],[18.72838,49.68163],[18.80479,49.6815],[18.84786,49.5446],[18.84521,49.51672],[18.94536,49.52143],[18.97283,49.49914],[18.9742,49.39557],[19.18019,49.41165],[19.25435,49.53391],[19.36009,49.53747],[19.37795,49.574],[19.45348,49.61583],[19.52626,49.57311],[19.53313,49.52856],[19.57845,49.46077],[19.64162,49.45184],[19.6375,49.40897],[19.72127,49.39288],[19.78581,49.41701],[19.82237,49.27806],[19.75286,49.20751],[19.86409,49.19316],[19.90529,49.23532],[19.98494,49.22904],[20.08238,49.1813],[20.13738,49.31685],[20.21977,49.35265],[20.31453,49.34817],[20.31728,49.39914],[20.39939,49.3896],[20.46422,49.41612],[20.5631,49.375],[20.61666,49.41791],[20.72274,49.41813],[20.77971,49.35383],[20.9229,49.29626],[20.98733,49.30774],[21.09799,49.37176],[21.041,49.41791],[21.12477,49.43666],[21.19756,49.4054],[21.27858,49.45988],[21.43376,49.41433],[21.62328,49.4447],[21.77983,49.35443],[21.82927,49.39467],[21.96385,49.3437],[22.04427,49.22136],[22.56155,49.08865],[22.89122,49.00725],[22.86336,49.10513],[22.72009,49.20288],[22.748,49.32759],[22.69444,49.49378],[22.64534,49.53094],[22.78304,49.65543],[22.80261,49.69098],[22.83179,49.69875],[22.99329,49.84249],[23.28221,50.0957],[23.67635,50.33385],[23.71382,50.38248],[23.79445,50.40481],[23.99563,50.41289],[24.03668,50.44507],[24.07048,50.5071],[24.0996,50.60752],[24.0595,50.71625],[23.95925,50.79271],[23.99254,50.83847],[24.0952,50.83262],[24.14524,50.86128],[24.04576,50.90196],[23.92217,51.00836],[23.90376,51.07697],[23.80678,51.18405],[23.63858,51.32182],[23.69905,51.40871],[23.62751,51.50512],[23.56236,51.53673],[23.57053,51.55938],[23.53198,51.74298],[23.62691,51.78208],[23.61523,51.92066],[23.68733,51.9906],[23.64066,52.07626],[23.61,52.11264],[23.54314,52.12148],[23.47859,52.18215],[23.20071,52.22848],[23.18196,52.28812],[23.34141,52.44845],[23.45112,52.53774],[23.58296,52.59868],[23.73615,52.6149],[23.93763,52.71332],[23.91805,52.94016],[23.94689,52.95919],[23.92184,53.02079],[23.87548,53.0831],[23.91393,53.16469],[23.85657,53.22923],[23.81995,53.24131],[23.62004,53.60942],[23.51284,53.95052],[23.48261,53.98855],[23.52702,54.04622],[23.49196,54.14764],[23.45223,54.17775],[23.42418,54.17911],[23.39525,54.21672],[23.3494,54.25155],[23.24656,54.25701],[23.15938,54.29894],[23.15526,54.31076],[23.13905,54.31567],[23.104,54.29794],[23.04323,54.31567],[23.05726,54.34565],[22.99649,54.35927],[23.00584,54.38514],[22.83756,54.40827],[22.79705,54.36264],[21.41123,54.32395],[20.63871,54.3706],[19.8038,54.44203],[19.64312,54.45423],[18.57853,55.25302]]]]}},{type:"Feature",properties:{iso1A2:"PM",iso1A3:"SPM",iso1N3:"666",wikidata:"Q34617",nameEn:"Saint Pierre and Miquelon",country:"FR",groups:["EU","Q1451600","021","003","019","UN"],callingCodes:["508"]},geometry:{type:"MultiPolygon",coordinates:[[[[-56.72993,46.65575],[-55.90758,46.6223],[-56.27503,47.39728],[-56.72993,46.65575]]]]}},{type:"Feature",properties:{iso1A2:"PN",iso1A3:"PCN",iso1N3:"612",wikidata:"Q35672",nameEn:"Pitcairn Islands",country:"GB",groups:["BOTS","061","009","UN"],driveSide:"left",callingCodes:["64"]},geometry:{type:"MultiPolygon",coordinates:[[[[-133.59543,-28.4709],[-122.0366,-24.55017],[-133.61511,-21.93325],[-133.59543,-28.4709]]]]}},{type:"Feature",properties:{iso1A2:"PR",iso1A3:"PRI",iso1N3:"630",wikidata:"Q1183",nameEn:"Puerto Rico",aliases:["US-PR"],country:"US",groups:["Q1352230","029","003","419","019","UN"],roadSpeedUnit:"mph",callingCodes:["1 787","1 939"]},geometry:{type:"MultiPolygon",coordinates:[[[[-65.27974,17.56928],[-65.02435,18.73231],[-67.99519,18.97186],[-68.23894,17.84663],[-65.27974,17.56928]]]]}},{type:"Feature",properties:{iso1A2:"PS",iso1A3:"PSE",iso1N3:"275",wikidata:"Q219060",nameEn:"Palestine"},geometry:null},{type:"Feature",properties:{iso1A2:"PT",iso1A3:"PRT",iso1N3:"620",wikidata:"Q45",nameEn:"Portugal"},geometry:null},{type:"Feature",properties:{iso1A2:"PW",iso1A3:"PLW",iso1N3:"585",wikidata:"Q695",nameEn:"Palau",groups:["057","009","UN"],roadSpeedUnit:"mph",callingCodes:["680"]},geometry:{type:"MultiPolygon",coordinates:[[[[128.97621,3.08804],[136.39296,1.54187],[136.04605,12.45908],[128.97621,3.08804]]]]}},{type:"Feature",properties:{iso1A2:"PY",iso1A3:"PRY",iso1N3:"600",wikidata:"Q733",nameEn:"Paraguay",groups:["005","419","019","UN"],callingCodes:["595"]},geometry:{type:"MultiPolygon",coordinates:[[[[-58.16225,-20.16193],[-58.23216,-19.80058],[-59.06965,-19.29148],[-60.00638,-19.2981],[-61.73723,-19.63958],[-61.93912,-20.10053],[-62.26883,-20.55311],[-62.2757,-21.06657],[-62.64455,-22.25091],[-62.51761,-22.37684],[-62.22768,-22.55807],[-61.9756,-23.0507],[-61.0782,-23.62932],[-60.99754,-23.80934],[-60.28163,-24.04436],[-60.03367,-24.00701],[-59.45482,-24.34787],[-59.33886,-24.49935],[-58.33055,-24.97099],[-58.25492,-24.92528],[-57.80821,-25.13863],[-57.57431,-25.47269],[-57.87176,-25.93604],[-58.1188,-26.16704],[-58.3198,-26.83443],[-58.65321,-27.14028],[-58.59549,-27.29973],[-58.04205,-27.2387],[-56.85337,-27.5165],[-56.18313,-27.29851],[-55.89195,-27.3467],[-55.74475,-27.44485],[-55.59094,-27.32444],[-55.62322,-27.1941],[-55.39611,-26.97679],[-55.25243,-26.93808],[-55.16948,-26.96068],[-55.06351,-26.80195],[-55.00584,-26.78754],[-54.80868,-26.55669],[-54.70732,-26.45099],[-54.69333,-26.37705],[-54.67359,-25.98607],[-54.60664,-25.9691],[-54.62063,-25.91213],[-54.59398,-25.59224],[-54.59509,-25.53696],[-54.60196,-25.48397],[-54.62033,-25.46026],[-54.4423,-25.13381],[-54.28207,-24.07305],[-54.32807,-24.01865],[-54.6238,-23.83078],[-55.02691,-23.97317],[-55.0518,-23.98666],[-55.12292,-23.99669],[-55.41784,-23.9657],[-55.44117,-23.9185],[-55.43585,-23.87157],[-55.5555,-23.28237],[-55.52288,-23.2595],[-55.5446,-23.22811],[-55.63849,-22.95122],[-55.62493,-22.62765],[-55.68742,-22.58407],[-55.6986,-22.56268],[-55.72366,-22.5519],[-55.741,-22.52018],[-55.74941,-22.46436],[-55.8331,-22.29008],[-56.23206,-22.25347],[-56.45893,-22.08072],[-56.5212,-22.11556],[-56.6508,-22.28387],[-57.98625,-22.09157],[-57.94642,-21.73799],[-57.88239,-21.6868],[-57.93492,-21.65505],[-57.84536,-20.93155],[-58.16225,-20.16193]]]]}},{type:"Feature",properties:{iso1A2:"QA",iso1A3:"QAT",iso1N3:"634",wikidata:"Q846",nameEn:"Qatar",groups:["145","142","UN"],callingCodes:["974"]},geometry:{type:"MultiPolygon",coordinates:[[[[50.92992,24.54396],[51.09638,24.46907],[51.29972,24.50747],[51.39468,24.62785],[51.58834,24.66608],[51.83108,24.71675],[51.83682,26.70231],[50.93865,26.30758],[50.81266,25.88946],[50.86149,25.6965],[50.7801,25.595],[50.80824,25.54641],[50.57069,25.57887],[50.8133,24.74049],[50.92992,24.54396]]]]}},{type:"Feature",properties:{iso1A2:"RE",iso1A3:"REU",iso1N3:"638",wikidata:"Q17070",nameEn:"R\xE9union",country:"FR",groups:["Q3320166","EU","014","202","002","UN"],callingCodes:["262"]},geometry:{type:"MultiPolygon",coordinates:[[[[53.37984,-21.23941],[56.73473,-21.9174],[56.62373,-20.2711],[53.37984,-21.23941]]]]}},{type:"Feature",properties:{iso1A2:"RO",iso1A3:"ROU",iso1N3:"642",wikidata:"Q218",nameEn:"Romania",groups:["EU","151","150","UN"],callingCodes:["40"]},geometry:{type:"MultiPolygon",coordinates:[[[[27.15622,47.98538],[27.02985,48.09083],[27.04118,48.12522],[26.96119,48.13003],[26.98042,48.15752],[26.94265,48.1969],[26.87708,48.19919],[26.81161,48.25049],[26.62823,48.25804],[26.55202,48.22445],[26.33504,48.18418],[26.17711,47.99246],[26.05901,47.9897],[25.77723,47.93919],[25.63878,47.94924],[25.23778,47.89403],[25.11144,47.75203],[24.88896,47.7234],[24.81893,47.82031],[24.70632,47.84428],[24.61994,47.95062],[24.43578,47.97131],[24.34926,47.9244],[24.22566,47.90231],[24.11281,47.91487],[24.06466,47.95317],[24.02999,47.95087],[24.00801,47.968],[23.98553,47.96076],[23.96337,47.96672],[23.94192,47.94868],[23.89352,47.94512],[23.8602,47.9329],[23.80904,47.98142],[23.75188,47.99705],[23.66262,47.98786],[23.63894,48.00293],[23.5653,48.00499],[23.52803,48.01818],[23.4979,47.96858],[23.33577,48.0237],[23.27397,48.08245],[23.15999,48.12188],[23.1133,48.08061],[23.08858,48.00716],[23.0158,47.99338],[22.92241,48.02002],[22.94301,47.96672],[22.89849,47.95851],[22.77991,47.87211],[22.76617,47.8417],[22.67247,47.7871],[22.46559,47.76583],[22.41979,47.7391],[22.31816,47.76126],[22.00917,47.50492],[22.03389,47.42508],[22.01055,47.37767],[21.94463,47.38046],[21.78395,47.11104],[21.648,47.03902],[21.68645,46.99595],[21.59581,46.91628],[21.59307,46.86935],[21.52028,46.84118],[21.48935,46.7577],[21.5151,46.72147],[21.43926,46.65109],[21.33214,46.63035],[21.26929,46.4993],[21.28061,46.44941],[21.16872,46.30118],[21.06572,46.24897],[20.86797,46.28884],[20.74574,46.25467],[20.76085,46.21002],[20.63863,46.12728],[20.49718,46.18721],[20.45377,46.14405],[20.35573,46.16629],[20.28324,46.1438],[20.26068,46.12332],[20.35862,45.99356],[20.54818,45.89939],[20.65645,45.82801],[20.70069,45.7493],[20.77416,45.75601],[20.78446,45.78522],[20.82364,45.77738],[20.80361,45.65875],[20.76798,45.60969],[20.83321,45.53567],[20.77217,45.49788],[20.86026,45.47295],[20.87948,45.42743],[21.09894,45.30144],[21.17612,45.32566],[21.20392,45.2677],[21.29398,45.24148],[21.48278,45.19557],[21.51299,45.15345],[21.4505,45.04294],[21.35855,45.01941],[21.54938,44.9327],[21.56328,44.89502],[21.48202,44.87199],[21.44013,44.87613],[21.35643,44.86364],[21.38802,44.78133],[21.55007,44.77304],[21.60019,44.75208],[21.61942,44.67059],[21.67504,44.67107],[21.71692,44.65349],[21.7795,44.66165],[21.99364,44.63395],[22.08016,44.49844],[22.13234,44.47444],[22.18315,44.48179],[22.30844,44.6619],[22.45301,44.7194],[22.61917,44.61489],[22.69196,44.61587],[22.76749,44.54446],[22.70981,44.51852],[22.61368,44.55719],[22.56493,44.53419],[22.54021,44.47836],[22.45436,44.47258],[22.56012,44.30712],[22.68166,44.28206],[22.67173,44.21564],[23.04988,44.07694],[23.01674,44.01946],[22.87873,43.9844],[22.83753,43.88055],[22.85314,43.84452],[23.05288,43.79494],[23.26772,43.84843],[23.4507,43.84936],[23.61687,43.79289],[23.73978,43.80627],[24.18149,43.68218],[24.35364,43.70211],[24.50264,43.76314],[24.62281,43.74082],[24.73542,43.68523],[24.96682,43.72693],[25.10718,43.6831],[25.17144,43.70261],[25.39528,43.61866],[25.72792,43.69263],[25.94911,43.85745],[26.05584,43.90925],[26.10115,43.96908],[26.38764,44.04356],[26.62712,44.05698],[26.95141,44.13555],[27.26845,44.12602],[27.39757,44.0141],[27.60834,44.01206],[27.64542,44.04958],[27.73468,43.95326],[27.92008,44.00761],[27.99558,43.84193],[28.23293,43.76],[29.24336,43.70874],[30.04414,45.08461],[29.69272,45.19227],[29.65428,45.25629],[29.68175,45.26885],[29.59798,45.38857],[29.42632,45.44545],[29.24779,45.43388],[28.96077,45.33164],[28.94292,45.28045],[28.81383,45.3384],[28.78911,45.24179],[28.71358,45.22631],[28.5735,45.24759],[28.34554,45.32102],[28.28504,45.43907],[28.21139,45.46895],[28.18741,45.47358],[28.08927,45.6051],[28.16568,45.6421],[28.13111,45.92819],[28.08612,46.01105],[28.13684,46.18099],[28.10937,46.22852],[28.19864,46.31869],[28.18902,46.35283],[28.25769,46.43334],[28.22281,46.50481],[28.24808,46.64305],[28.12173,46.82283],[28.09095,46.97621],[27.81892,47.1381],[27.73172,47.29248],[27.68706,47.28962],[27.60263,47.32507],[27.55731,47.46637],[27.47942,47.48113],[27.3979,47.59473],[27.32202,47.64009],[27.25519,47.71366],[27.29069,47.73722],[27.1618,47.92391],[27.15622,47.98538]]]]}},{type:"Feature",properties:{iso1A2:"RS",iso1A3:"SRB",iso1N3:"688",wikidata:"Q403",nameEn:"Serbia",groups:["039","150","UN"],callingCodes:["381"]},geometry:{type:"MultiPolygon",coordinates:[[[[19.66007,46.19005],[19.56113,46.16824],[19.52473,46.1171],[19.28826,45.99694],[19.14543,45.9998],[19.10388,46.04015],[19.0791,45.96458],[19.01284,45.96529],[18.99712,45.93537],[18.81394,45.91329],[18.85783,45.85493],[18.90305,45.71863],[18.96691,45.66731],[18.88776,45.57253],[18.94562,45.53712],[19.07471,45.53086],[19.08364,45.48804],[18.99918,45.49333],[18.97446,45.37528],[19.10774,45.29547],[19.28208,45.23813],[19.41941,45.23475],[19.43589,45.17137],[19.19144,45.17863],[19.14063,45.12972],[19.07952,45.14668],[19.1011,45.01191],[19.05205,44.97692],[19.15573,44.95409],[19.06853,44.89915],[19.02871,44.92541],[18.98957,44.90645],[19.01994,44.85493],[19.18183,44.92055],[19.36722,44.88164],[19.32543,44.74058],[19.26388,44.65412],[19.16699,44.52197],[19.13369,44.52521],[19.12278,44.50132],[19.14837,44.45253],[19.14681,44.41463],[19.11785,44.40313],[19.10749,44.39421],[19.10704,44.38249],[19.10365,44.37795],[19.10298,44.36924],[19.11865,44.36712],[19.1083,44.3558],[19.11547,44.34218],[19.13556,44.338],[19.13332,44.31492],[19.16741,44.28648],[19.18328,44.28383],[19.20508,44.2917],[19.23306,44.26097],[19.26945,44.26957],[19.32464,44.27185],[19.34773,44.23244],[19.3588,44.18353],[19.40927,44.16722],[19.43905,44.13088],[19.47338,44.15034],[19.48386,44.14332],[19.47321,44.1193],[19.51167,44.08158],[19.55999,44.06894],[19.57467,44.04716],[19.61991,44.05254],[19.61836,44.01464],[19.56498,43.99922],[19.52515,43.95573],[19.38439,43.96611],[19.24363,44.01502],[19.23465,43.98764],[19.3986,43.79668],[19.5176,43.71403],[19.50455,43.58385],[19.42696,43.57987],[19.41941,43.54056],[19.36653,43.60921],[19.33426,43.58833],[19.2553,43.5938],[19.24774,43.53061],[19.22807,43.5264],[19.22229,43.47926],[19.44315,43.38846],[19.48171,43.32644],[19.52962,43.31623],[19.54598,43.25158],[19.62661,43.2286],[19.64063,43.19027],[19.76918,43.16044],[19.79255,43.11951],[19.92576,43.08539],[19.96549,43.11098],[19.98887,43.0538],[20.04729,43.02732],[20.05431,42.99571],[20.12325,42.96237],[20.14896,42.99058],[20.16415,42.97177],[20.34528,42.90676],[20.35692,42.8335],[20.40594,42.84853],[20.43734,42.83157],[20.53484,42.8885],[20.48692,42.93208],[20.59929,43.01067],[20.64557,43.00826],[20.69515,43.09641],[20.59929,43.20492],[20.68688,43.21335],[20.73811,43.25068],[20.82145,43.26769],[20.88685,43.21697],[20.83727,43.17842],[20.96287,43.12416],[21.00749,43.13984],[21.05378,43.10707],[21.08952,43.13471],[21.14465,43.11089],[21.16734,42.99694],[21.2041,43.02277],[21.23877,43.00848],[21.23534,42.95523],[21.2719,42.8994],[21.32974,42.90424],[21.36941,42.87397],[21.44047,42.87276],[21.39045,42.74888],[21.47498,42.74695],[21.59154,42.72643],[21.58755,42.70418],[21.6626,42.67813],[21.75025,42.70125],[21.79413,42.65923],[21.75672,42.62695],[21.7327,42.55041],[21.70522,42.54176],[21.7035,42.51899],[21.62556,42.45106],[21.64209,42.41081],[21.62887,42.37664],[21.59029,42.38042],[21.57021,42.3647],[21.53467,42.36809],[21.5264,42.33634],[21.56772,42.30946],[21.58992,42.25915],[21.70111,42.23789],[21.77176,42.2648],[21.84654,42.3247],[21.91595,42.30392],[21.94405,42.34669],[22.02908,42.29848],[22.16384,42.32103],[22.29605,42.37477],[22.29275,42.34913],[22.34773,42.31725],[22.45919,42.33822],[22.47498,42.3915],[22.51961,42.3991],[22.55669,42.50144],[22.43983,42.56851],[22.4997,42.74144],[22.43309,42.82057],[22.54302,42.87774],[22.74826,42.88701],[22.78397,42.98253],[22.89521,43.03625],[22.98104,43.11199],[23.00806,43.19279],[22.89727,43.22417],[22.82036,43.33665],[22.53397,43.47225],[22.47582,43.6558],[22.41043,43.69566],[22.35558,43.81281],[22.41449,44.00514],[22.61688,44.06534],[22.61711,44.16938],[22.67173,44.21564],[22.68166,44.28206],[22.56012,44.30712],[22.45436,44.47258],[22.54021,44.47836],[22.56493,44.53419],[22.61368,44.55719],[22.70981,44.51852],[22.76749,44.54446],[22.69196,44.61587],[22.61917,44.61489],[22.45301,44.7194],[22.30844,44.6619],[22.18315,44.48179],[22.13234,44.47444],[22.08016,44.49844],[21.99364,44.63395],[21.7795,44.66165],[21.71692,44.65349],[21.67504,44.67107],[21.61942,44.67059],[21.60019,44.75208],[21.55007,44.77304],[21.38802,44.78133],[21.35643,44.86364],[21.44013,44.87613],[21.48202,44.87199],[21.56328,44.89502],[21.54938,44.9327],[21.35855,45.01941],[21.4505,45.04294],[21.51299,45.15345],[21.48278,45.19557],[21.29398,45.24148],[21.20392,45.2677],[21.17612,45.32566],[21.09894,45.30144],[20.87948,45.42743],[20.86026,45.47295],[20.77217,45.49788],[20.83321,45.53567],[20.76798,45.60969],[20.80361,45.65875],[20.82364,45.77738],[20.78446,45.78522],[20.77416,45.75601],[20.70069,45.7493],[20.65645,45.82801],[20.54818,45.89939],[20.35862,45.99356],[20.26068,46.12332],[20.09713,46.17315],[20.03533,46.14509],[20.01816,46.17696],[19.93508,46.17553],[19.81491,46.1313],[19.66007,46.19005]]]]}},{type:"Feature",properties:{iso1A2:"RU",iso1A3:"RUS",iso1N3:"643",wikidata:"Q159",nameEn:"Russia"},geometry:null},{type:"Feature",properties:{iso1A2:"RW",iso1A3:"RWA",iso1N3:"646",wikidata:"Q1037",nameEn:"Rwanda",groups:["014","202","002","UN"],callingCodes:["250"]},geometry:{type:"MultiPolygon",coordinates:[[[[30.47194,-1.0555],[30.35212,-1.06896],[30.16369,-1.34303],[29.912,-1.48269],[29.82657,-1.31187],[29.59061,-1.39016],[29.53062,-1.40499],[29.45038,-1.5054],[29.36322,-1.50887],[29.24323,-1.66826],[29.24458,-1.69663],[29.11847,-1.90576],[29.17562,-2.12278],[29.105,-2.27043],[29.00051,-2.29001],[28.95642,-2.37321],[28.89601,-2.37321],[28.86826,-2.41888],[28.86846,-2.44866],[28.89132,-2.47557],[28.89342,-2.49017],[28.88846,-2.50493],[28.87497,-2.50887],[28.86209,-2.5231],[28.86193,-2.53185],[28.87943,-2.55165],[28.89288,-2.55848],[28.90226,-2.62385],[28.89793,-2.66111],[28.94346,-2.69124],[29.00357,-2.70596],[29.04081,-2.7416],[29.0562,-2.58632],[29.32234,-2.6483],[29.36805,-2.82933],[29.88237,-2.75105],[29.95911,-2.33348],[30.14034,-2.43626],[30.42933,-2.31064],[30.54501,-2.41404],[30.83915,-2.35795],[30.89303,-2.08223],[30.80802,-1.91477],[30.84079,-1.64652],[30.71974,-1.43244],[30.57123,-1.33264],[30.50889,-1.16412],[30.45116,-1.10641],[30.47194,-1.0555]]]]}},{type:"Feature",properties:{iso1A2:"SA",iso1A3:"SAU",iso1N3:"682",wikidata:"Q851",nameEn:"Saudi Arabia",groups:["145","142","UN"],callingCodes:["966"]},geometry:{type:"MultiPolygon",coordinates:[[[[40.01521,32.05667],[39.29903,32.23259],[38.99233,31.99721],[36.99791,31.50081],[37.99354,30.49998],[37.66395,30.33245],[37.4971,29.99949],[36.75083,29.86903],[36.50005,29.49696],[36.07081,29.18469],[34.8812,29.36878],[34.4454,27.91479],[37.8565,22.00903],[39.63762,18.37348],[40.99158,15.81743],[42.15205,16.40211],[42.76801,16.40371],[42.94625,16.39721],[42.94351,16.49467],[42.97215,16.51093],[43.11601,16.53166],[43.15274,16.67248],[43.22066,16.65179],[43.21325,16.74416],[43.25857,16.75304],[43.26303,16.79479],[43.24801,16.80613],[43.22956,16.80613],[43.22012,16.83932],[43.18338,16.84852],[43.1398,16.90696],[43.19328,16.94703],[43.1813,16.98438],[43.18233,17.02673],[43.23967,17.03428],[43.17787,17.14717],[43.20156,17.25901],[43.32653,17.31179],[43.22533,17.38343],[43.29185,17.53224],[43.43005,17.56148],[43.70631,17.35762],[44.50126,17.47475],[46.31018,17.20464],[46.76494,17.29151],[47.00571,16.94765],[47.48245,17.10808],[47.58351,17.50366],[48.19996,18.20584],[49.04884,18.59899],[52.00311,19.00083],[54.99756,20.00083],[55.66469,21.99658],[55.2137,22.71065],[55.13599,22.63334],[52.56622,22.94341],[51.59617,24.12041],[51.58871,24.27256],[51.41644,24.39615],[51.58834,24.66608],[51.39468,24.62785],[51.29972,24.50747],[51.09638,24.46907],[50.92992,24.54396],[50.8133,24.74049],[50.57069,25.57887],[50.302,25.87592],[50.26923,26.08243],[50.38162,26.53976],[50.71771,26.73086],[50.37726,27.89227],[49.98877,27.87827],[49.00421,28.81495],[48.42991,28.53628],[47.70561,28.5221],[47.59863,28.66798],[47.58376,28.83382],[47.46202,29.0014],[46.5527,29.10283],[46.42415,29.05947],[44.72255,29.19736],[42.97796,30.48295],[42.97601,30.72204],[40.01521,32.05667]]]]}},{type:"Feature",properties:{iso1A2:"SB",iso1A3:"SLB",iso1N3:"090",wikidata:"Q685",nameEn:"Solomon Islands",groups:["054","009","UN"],driveSide:"left",callingCodes:["677"]},geometry:{type:"MultiPolygon",coordinates:[[[[172.71443,-12.01327],[160.43769,-4.17974],[156.03296,-6.55528],[156.03993,-6.65703],[155.92557,-6.84664],[155.69784,-6.92661],[155.60735,-6.92266],[154.74815,-7.33315],[156.73836,-14.50464],[172.71443,-12.01327]]]]}},{type:"Feature",properties:{iso1A2:"SC",iso1A3:"SYC",iso1N3:"690",wikidata:"Q1042",nameEn:"Seychelles",groups:["014","202","002","UN"],driveSide:"left",callingCodes:["248"]},geometry:{type:"MultiPolygon",coordinates:[[[[43.75112,-10.38913],[54.83239,-10.93575],[66.3222,5.65313],[43.75112,-10.38913]]]]}},{type:"Feature",properties:{iso1A2:"SD",iso1A3:"SDN",iso1N3:"729",wikidata:"Q1049",nameEn:"Sudan",groups:["015","002","UN"],callingCodes:["249"]},geometry:{type:"MultiPolygon",coordinates:[[[[37.8565,22.00903],[34.0765,22.00501],[33.99686,21.76784],[33.57251,21.72406],[33.17563,22.00405],[24.99885,21.99535],[24.99794,19.99661],[23.99715,20.00038],[23.99539,19.49944],[23.99997,15.69575],[23.62785,15.7804],[23.38812,15.69649],[23.10792,15.71297],[22.93201,15.55107],[22.92579,15.47007],[22.99584,15.40105],[22.99584,15.22989],[22.66115,14.86308],[22.70474,14.69149],[22.38562,14.58907],[22.44944,14.24986],[22.55997,14.23024],[22.5553,14.11704],[22.22995,13.96754],[22.08674,13.77863],[22.29689,13.3731],[22.1599,13.19281],[22.02914,13.13976],[21.94819,13.05637],[21.81432,12.81362],[21.89371,12.68001],[21.98711,12.63292],[22.15679,12.66634],[22.22684,12.74682],[22.46345,12.61925],[22.38873,12.45514],[22.50548,12.16769],[22.48369,12.02766],[22.64092,12.07485],[22.54907,11.64372],[22.7997,11.40424],[22.93124,11.41645],[22.97249,11.21955],[22.87758,10.91915],[23.02221,10.69235],[23.3128,10.45214],[23.67164,9.86923],[23.69155,9.67566],[24.09319,9.66572],[24.12744,9.73784],[24.49389,9.79962],[24.84653,9.80643],[24.97739,9.9081],[25.05688,10.06776],[25.0918,10.33718],[25.78141,10.42599],[25.93163,10.38159],[25.93241,10.17941],[26.21338,9.91545],[26.35815,9.57946],[26.70685,9.48735],[27.14427,9.62858],[27.90704,9.61323],[28.99983,9.67155],[29.06988,9.74826],[29.53844,9.75133],[29.54,10.07949],[29.94629,10.29245],[30.00389,10.28633],[30.53005,9.95992],[30.82893,9.71451],[30.84605,9.7498],[31.28504,9.75287],[31.77539,10.28939],[31.99177,10.65065],[32.46967,11.04662],[32.39358,11.18207],[32.39578,11.70208],[32.10079,11.95203],[32.73921,11.95203],[32.73921,12.22757],[33.25876,12.22111],[33.13988,11.43248],[33.26977,10.83632],[33.24645,10.77913],[33.52294,10.64382],[33.66604,10.44254],[33.80913,10.32994],[33.90159,10.17179],[33.96984,10.15446],[33.99185,9.99623],[33.96323,9.80972],[33.9082,9.762],[33.87958,9.49937],[34.10229,9.50238],[34.08717,9.55243],[34.13186,9.7492],[34.20484,9.9033],[34.22718,10.02506],[34.32102,10.11599],[34.34783,10.23914],[34.2823,10.53508],[34.4372,10.781],[34.59062,10.89072],[34.77383,10.74588],[34.77532,10.69027],[34.86618,10.74588],[34.86916,10.78832],[34.97491,10.86147],[34.97789,10.91559],[34.93172,10.95946],[35.01215,11.19626],[34.95704,11.24448],[35.09556,11.56278],[35.05832,11.71158],[35.11492,11.85156],[35.24302,11.91132],[35.70476,12.67101],[36.01458,12.72478],[36.14268,12.70879],[36.16651,12.88019],[36.13374,12.92665],[36.24545,13.36759],[36.38993,13.56459],[36.48824,13.83954],[36.44653,13.95666],[36.54376,14.25597],[36.44337,15.14963],[36.54276,15.23478],[36.69761,15.75323],[36.76371,15.80831],[36.92193,16.23451],[36.99777,17.07172],[37.42694,17.04041],[37.50967,17.32199],[38.13362,17.53906],[38.37133,17.66269],[38.45916,17.87167],[38.57727,17.98125],[39.63762,18.37348],[37.8565,22.00903]]]]}},{type:"Feature",properties:{iso1A2:"SE",iso1A3:"SWE",iso1N3:"752",wikidata:"Q34",nameEn:"Sweden",groups:["EU","154","150","UN"],callingCodes:["46"]},geometry:{type:"MultiPolygon",coordinates:[[[[24.15791,65.85385],[23.90497,66.15802],[23.71339,66.21299],[23.64982,66.30603],[23.67591,66.3862],[23.63776,66.43568],[23.85959,66.56434],[23.89488,66.772],[23.98059,66.79585],[23.98563,66.84149],[23.56214,67.17038],[23.58735,67.20752],[23.54701,67.25435],[23.75372,67.29914],[23.75372,67.43688],[23.39577,67.46974],[23.54701,67.59306],[23.45627,67.85297],[23.65793,67.9497],[23.40081,68.05545],[23.26469,68.15134],[23.15377,68.14759],[23.10336,68.26551],[22.73028,68.40881],[22.00429,68.50692],[21.03001,68.88969],[20.90649,68.89696],[20.85104,68.93142],[20.91658,68.96764],[20.78802,69.03087],[20.55258,69.06069],[20.0695,69.04469],[20.28444,68.93283],[20.33435,68.80174],[20.22027,68.67246],[19.95647,68.55546],[20.22027,68.48759],[19.93508,68.35911],[18.97255,68.52416],[18.63032,68.50849],[18.39503,68.58672],[18.1241,68.53721],[18.13836,68.20874],[17.90787,67.96537],[17.30416,68.11591],[16.7409,67.91037],[16.38441,67.52923],[16.12774,67.52106],[16.09922,67.4364],[16.39154,67.21653],[16.35589,67.06419],[15.37197,66.48217],[15.49318,66.28509],[15.05113,66.15572],[14.53778,66.12399],[14.50926,65.31786],[13.64276,64.58402],[14.11117,64.46674],[14.16051,64.18725],[13.98222,64.00953],[13.23411,64.09087],[12.74105,64.02171],[12.14928,63.59373],[12.19919,63.47935],[11.98529,63.27487],[12.19919,63.00104],[12.07085,62.6297],[12.29187,62.25699],[12.14746,61.7147],[12.40595,61.57226],[12.57707,61.56547],[12.86939,61.35427],[12.69115,61.06584],[12.2277,61.02442],[12.59133,60.50559],[12.52003,60.13846],[12.36317,59.99259],[12.15641,59.8926],[11.87121,59.86039],[11.92112,59.69531],[11.69297,59.59442],[11.8213,59.24985],[11.65732,58.90177],[11.45199,58.89604],[11.4601,58.99022],[11.34459,59.11672],[11.15367,59.07862],[11.08911,58.98745],[10.64958,58.89391],[10.40861,58.38489],[12.16597,56.60205],[12.07466,56.29488],[12.65312,56.04345],[12.6372,55.91371],[12.88472,55.63369],[12.60345,55.42675],[12.84405,55.13257],[14.28399,55.1553],[14.89259,55.5623],[15.79951,55.54655],[19.64795,57.06466],[19.84909,57.57876],[20.5104,59.15546],[19.08191,60.19152],[19.23413,60.61414],[20.15877,63.06556],[24.14112,65.39731],[24.15107,65.81427],[24.14798,65.83466],[24.15791,65.85385]]]]}},{type:"Feature",properties:{iso1A2:"SG",iso1A3:"SGP",iso1N3:"702",wikidata:"Q334",nameEn:"Singapore",groups:["035","142","UN"],driveSide:"left",callingCodes:["65"]},geometry:{type:"MultiPolygon",coordinates:[[[[104.00131,1.42405],[103.93384,1.42926],[103.89565,1.42841],[103.86383,1.46288],[103.81181,1.47953],[103.76395,1.45183],[103.74161,1.4502],[103.7219,1.46108],[103.67468,1.43166],[103.62738,1.35255],[103.56591,1.19719],[103.66049,1.18825],[103.74084,1.12902],[104.03085,1.26954],[104.12282,1.27714],[104.08072,1.35998],[104.09162,1.39694],[104.08871,1.42015],[104.07348,1.43322],[104.04622,1.44691],[104.02277,1.4438],[104.00131,1.42405]]]]}},{type:"Feature",properties:{iso1A2:"SH",iso1A3:"SHN",iso1N3:"654",wikidata:"Q192184",nameEn:"Saint Helena, Ascension and Tristan da Cunha",country:"GB"},geometry:null},{type:"Feature",properties:{iso1A2:"SI",iso1A3:"SVN",iso1N3:"705",wikidata:"Q215",nameEn:"Slovenia",groups:["EU","039","150","UN"],callingCodes:["386"]},geometry:{type:"MultiPolygon",coordinates:[[[[16.50139,46.56684],[16.39217,46.63673],[16.38594,46.6549],[16.41863,46.66238],[16.42641,46.69228],[16.37816,46.69975],[16.30966,46.7787],[16.31303,46.79838],[16.3408,46.80641],[16.34547,46.83836],[16.2941,46.87137],[16.2365,46.87775],[16.21892,46.86961],[16.15711,46.85434],[16.14365,46.8547],[16.10983,46.867],[16.05786,46.83927],[15.99054,46.82772],[15.99126,46.78199],[15.98432,46.74991],[15.99769,46.7266],[16.02808,46.71094],[16.04347,46.68694],[16.04036,46.6549],[15.99988,46.67947],[15.98512,46.68463],[15.94864,46.68769],[15.87691,46.7211],[15.8162,46.71897],[15.78518,46.70712],[15.76771,46.69863],[15.73823,46.70011],[15.72279,46.69548],[15.69523,46.69823],[15.67411,46.70735],[15.6543,46.70616],[15.6543,46.69228],[15.6365,46.6894],[15.63255,46.68069],[15.62317,46.67947],[15.59826,46.68908],[15.54533,46.66985],[15.55333,46.64988],[15.54431,46.6312],[15.46906,46.61321],[15.45514,46.63697],[15.41235,46.65556],[15.23711,46.63994],[15.14215,46.66131],[15.01451,46.641],[14.98024,46.6009],[14.96002,46.63459],[14.92283,46.60848],[14.87129,46.61],[14.86419,46.59411],[14.83549,46.56614],[14.81836,46.51046],[14.72185,46.49974],[14.66892,46.44936],[14.5942,46.43434],[14.56463,46.37208],[14.52176,46.42617],[14.45877,46.41717],[14.42608,46.44614],[14.314,46.43327],[14.28326,46.44315],[14.15989,46.43327],[14.12097,46.47724],[14.04002,46.49117],[14.00422,46.48474],[13.89837,46.52331],[13.7148,46.5222],[13.68684,46.43881],[13.59777,46.44137],[13.5763,46.42613],[13.5763,46.40915],[13.47019,46.3621],[13.43418,46.35992],[13.44808,46.33507],[13.37671,46.29668],[13.42218,46.20758],[13.47587,46.22725],[13.56114,46.2054],[13.56682,46.18703],[13.64451,46.18966],[13.66472,46.17392],[13.64053,46.13587],[13.57072,46.09022],[13.50104,46.05986],[13.49568,46.04839],[13.50998,46.04498],[13.49702,46.01832],[13.47474,46.00546],[13.50104,45.98078],[13.52963,45.96588],[13.56759,45.96991],[13.58903,45.99009],[13.62074,45.98388],[13.63458,45.98947],[13.64307,45.98326],[13.6329,45.94894],[13.63815,45.93607],[13.61931,45.91782],[13.60857,45.89907],[13.59565,45.89446],[13.58644,45.88173],[13.57563,45.8425],[13.58858,45.83503],[13.59784,45.8072],[13.66986,45.79955],[13.8235,45.7176],[13.83332,45.70855],[13.83422,45.68703],[13.87933,45.65207],[13.9191,45.6322],[13.8695,45.60835],[13.86771,45.59898],[13.84106,45.58185],[13.78445,45.5825],[13.74587,45.59811],[13.7198,45.59352],[13.6076,45.64761],[13.45644,45.59464],[13.56979,45.4895],[13.62902,45.45898],[13.67398,45.4436],[13.7785,45.46787],[13.81742,45.43729],[13.88124,45.42637],[13.90771,45.45149],[13.97309,45.45258],[13.99488,45.47551],[13.96063,45.50825],[14.00578,45.52352],[14.07116,45.48752],[14.20348,45.46896],[14.22371,45.50388],[14.24239,45.50607],[14.26611,45.48239],[14.27681,45.4902],[14.32487,45.47142],[14.36693,45.48642],[14.49769,45.54424],[14.5008,45.60852],[14.53816,45.6205],[14.57397,45.67165],[14.60977,45.66403],[14.59576,45.62812],[14.69694,45.57366],[14.68605,45.53006],[14.71718,45.53442],[14.80124,45.49515],[14.81992,45.45913],[14.90554,45.47769],[14.92266,45.52788],[15.02385,45.48533],[15.05187,45.49079],[15.16862,45.42309],[15.27758,45.46678],[15.33051,45.45258],[15.38188,45.48752],[15.30249,45.53224],[15.29837,45.5841],[15.27747,45.60504],[15.31027,45.6303],[15.34695,45.63382],[15.34214,45.64702],[15.38952,45.63682],[15.4057,45.64727],[15.34919,45.71623],[15.30872,45.69014],[15.25423,45.72275],[15.40836,45.79491],[15.47531,45.79802],[15.47325,45.8253],[15.52234,45.82195],[15.57952,45.84953],[15.64185,45.82915],[15.66662,45.84085],[15.70411,45.8465],[15.68232,45.86819],[15.68383,45.88867],[15.67967,45.90455],[15.70636,45.92116],[15.70327,46.00015],[15.71246,46.01196],[15.72977,46.04682],[15.62317,46.09103],[15.6083,46.11992],[15.59909,46.14761],[15.64904,46.19229],[15.6434,46.21396],[15.67395,46.22478],[15.75436,46.21969],[15.75479,46.20336],[15.78817,46.21719],[15.79284,46.25811],[15.97965,46.30652],[16.07616,46.3463],[16.07314,46.36458],[16.05065,46.3833],[16.05281,46.39141],[16.14859,46.40547],[16.18824,46.38282],[16.30233,46.37837],[16.30162,46.40437],[16.27329,46.41467],[16.27398,46.42875],[16.25124,46.48067],[16.23961,46.49653],[16.26759,46.50566],[16.26733,46.51505],[16.29793,46.5121],[16.37193,46.55008],[16.38771,46.53608],[16.44036,46.5171],[16.5007,46.49644],[16.52604,46.47831],[16.59527,46.47524],[16.52604,46.5051],[16.52885,46.53303],[16.50139,46.56684]]]]}},{type:"Feature",properties:{iso1A2:"SJ",iso1A3:"SJM",iso1N3:"744",wikidata:"Q842829",nameEn:"Svalbard and Jan Mayen",country:"NO"},geometry:null},{type:"Feature",properties:{iso1A2:"SK",iso1A3:"SVK",iso1N3:"703",wikidata:"Q214",nameEn:"Slovakia",groups:["EU","151","150","UN"],callingCodes:["421"]},geometry:{type:"MultiPolygon",coordinates:[[[[19.82237,49.27806],[19.78581,49.41701],[19.72127,49.39288],[19.6375,49.40897],[19.64162,49.45184],[19.57845,49.46077],[19.53313,49.52856],[19.52626,49.57311],[19.45348,49.61583],[19.37795,49.574],[19.36009,49.53747],[19.25435,49.53391],[19.18019,49.41165],[18.9742,49.39557],[18.97283,49.49914],[18.94536,49.52143],[18.84521,49.51672],[18.74761,49.492],[18.67757,49.50895],[18.6144,49.49824],[18.57183,49.51162],[18.53063,49.49022],[18.54848,49.47059],[18.44686,49.39467],[18.4084,49.40003],[18.4139,49.36517],[18.36446,49.3267],[18.18456,49.28909],[18.15022,49.24518],[18.1104,49.08624],[18.06885,49.03157],[17.91814,49.01784],[17.87831,48.92679],[17.77944,48.92318],[17.73126,48.87885],[17.7094,48.86721],[17.5295,48.81117],[17.45671,48.85004],[17.3853,48.80936],[17.29054,48.85546],[17.19355,48.87602],[17.11202,48.82925],[17.00215,48.70887],[16.93955,48.60371],[16.94611,48.53614],[16.85204,48.44968],[16.8497,48.38321],[16.83588,48.3844],[16.83317,48.38138],[16.84243,48.35258],[16.90903,48.32519],[16.89461,48.31332],[16.97701,48.17385],[17.02919,48.13996],[17.05735,48.14179],[17.09168,48.09366],[17.07039,48.0317],[17.16001,48.00636],[17.23699,48.02094],[17.71215,47.7548],[18.02938,47.75665],[18.29305,47.73541],[18.56496,47.76588],[18.66521,47.76772],[18.74074,47.8157],[18.8506,47.82308],[18.76821,47.87469],[18.76134,47.97499],[18.82176,48.04206],[19.01952,48.07052],[19.23924,48.0595],[19.28182,48.08336],[19.47957,48.09437],[19.52489,48.19791],[19.63338,48.25006],[19.92452,48.1283],[20.24312,48.2784],[20.29943,48.26104],[20.5215,48.53336],[20.83248,48.5824],[21.11516,48.49546],[21.44063,48.58456],[21.6068,48.50365],[21.67134,48.3989],[21.72525,48.34628],[21.8279,48.33321],[21.83339,48.36242],[22.14689,48.4005],[22.16023,48.56548],[22.21379,48.6218],[22.34151,48.68893],[22.42934,48.92857],[22.48296,48.99172],[22.54338,49.01424],[22.56155,49.08865],[22.04427,49.22136],[21.96385,49.3437],[21.82927,49.39467],[21.77983,49.35443],[21.62328,49.4447],[21.43376,49.41433],[21.27858,49.45988],[21.19756,49.4054],[21.12477,49.43666],[21.041,49.41791],[21.09799,49.37176],[20.98733,49.30774],[20.9229,49.29626],[20.77971,49.35383],[20.72274,49.41813],[20.61666,49.41791],[20.5631,49.375],[20.46422,49.41612],[20.39939,49.3896],[20.31728,49.39914],[20.31453,49.34817],[20.21977,49.35265],[20.13738,49.31685],[20.08238,49.1813],[19.98494,49.22904],[19.90529,49.23532],[19.86409,49.19316],[19.75286,49.20751],[19.82237,49.27806]]]]}},{type:"Feature",properties:{iso1A2:"SL",iso1A3:"SLE",iso1N3:"694",wikidata:"Q1044",nameEn:"Sierra Leone",groups:["011","202","002","UN"],callingCodes:["232"]},geometry:{type:"MultiPolygon",coordinates:[[[[-10.27575,8.48711],[-10.37257,8.48941],[-10.54891,8.31174],[-10.63934,8.35326],[-10.70565,8.29235],[-10.61422,8.5314],[-10.47707,8.67669],[-10.56197,8.81225],[-10.5783,9.06386],[-10.74484,9.07998],[-10.6534,9.29919],[-11.2118,10.00098],[-11.89624,9.99763],[-11.91023,9.93927],[-12.12634,9.87203],[-12.24262,9.92386],[-12.47254,9.86834],[-12.76788,9.3133],[-12.94095,9.26335],[-13.08953,9.0409],[-13.18586,9.0925],[-13.29911,9.04245],[-14.36218,8.64107],[-12.15048,6.15992],[-11.50429,6.92704],[-11.4027,6.97746],[-11.29417,7.21576],[-10.60422,7.7739],[-10.60492,8.04072],[-10.57523,8.04829],[-10.51554,8.1393],[-10.45023,8.15627],[-10.35227,8.15223],[-10.29839,8.21283],[-10.31635,8.28554],[-10.30084,8.30008],[-10.27575,8.48711]]]]}},{type:"Feature",properties:{iso1A2:"SM",iso1A3:"SMR",iso1N3:"674",wikidata:"Q238",nameEn:"San Marino",groups:["039","150","UN"],callingCodes:["378"]},geometry:{type:"MultiPolygon",coordinates:[[[[12.45648,43.89369],[12.48771,43.89706],[12.49429,43.90973],[12.49247,43.91774],[12.49724,43.92248],[12.50269,43.92363],[12.50496,43.93017],[12.51553,43.94096],[12.51427,43.94897],[12.50655,43.95796],[12.50875,43.96198],[12.50622,43.97131],[12.51109,43.97201],[12.51064,43.98165],[12.5154,43.98508],[12.51463,43.99122],[12.50678,43.99113],[12.49406,43.98492],[12.47853,43.98052],[12.46205,43.97463],[12.44684,43.96597],[12.43662,43.95698],[12.42005,43.9578],[12.41414,43.95273],[12.40415,43.95485],[12.40506,43.94325],[12.41165,43.93769],[12.41551,43.92984],[12.40733,43.92379],[12.41233,43.90956],[12.40935,43.9024],[12.41641,43.89991],[12.44184,43.90498],[12.45648,43.89369]]]]}},{type:"Feature",properties:{iso1A2:"SN",iso1A3:"SEN",iso1N3:"686",wikidata:"Q1041",nameEn:"Senegal",groups:["011","202","002","UN"],callingCodes:["221"]},geometry:{type:"MultiPolygon",coordinates:[[[[-14.32144,16.61495],[-15.00557,16.64997],[-15.6509,16.50315],[-16.27016,16.51565],[-16.4429,16.20605],[-16.44814,16.09753],[-16.48967,16.0496],[-16.50854,16.09032],[-17.15288,16.07139],[-18.35085,14.63444],[-17.43598,13.59273],[-15.47902,13.58758],[-15.36504,13.79313],[-14.93719,13.80173],[-14.34721,13.46578],[-13.8955,13.59126],[-13.79409,13.34472],[-14.36795,13.23033],[-15.14917,13.57989],[-15.26908,13.37768],[-15.80478,13.34832],[-15.80355,13.16729],[-16.69343,13.16791],[-16.74676,13.06025],[-17.43966,13.04579],[-17.4623,11.92379],[-16.70562,12.34803],[-16.38191,12.36449],[-16.20591,12.46157],[-15.67302,12.42974],[-15.17582,12.6847],[-13.70523,12.68013],[-13.05296,12.64003],[-13.06603,12.49342],[-12.87336,12.51892],[-12.35415,12.32758],[-11.91331,12.42008],[-11.46267,12.44559],[-11.37536,12.40788],[-11.39935,12.97808],[-11.63025,13.39174],[-11.83345,13.33333],[-12.06897,13.71049],[-11.93043,13.84505],[-12.23936,14.76324],[-13.11029,15.52116],[-13.43135,16.09022],[-13.80075,16.13961],[-14.32144,16.61495]]]]}},{type:"Feature",properties:{iso1A2:"SO",iso1A3:"SOM",iso1N3:"706",wikidata:"Q1045",nameEn:"Somalia",groups:["014","202","002","UN"],callingCodes:["252"]},geometry:{type:"MultiPolygon",coordinates:[[[[51.12877,12.56479],[43.90659,12.3823],[42.95776,10.98533],[42.69452,10.62672],[42.87643,10.18441],[43.0937,9.90579],[43.23518,9.84605],[43.32613,9.59205],[44.19222,8.93028],[46.99339,7.9989],[47.92477,8.00111],[47.97917,8.00124],[44.98104,4.91821],[44.02436,4.9451],[43.40263,4.79289],[43.04177,4.57923],[42.97746,4.44032],[42.84526,4.28357],[42.55853,4.20518],[42.07619,4.17667],[41.89488,3.97375],[41.31368,3.14314],[40.98767,2.82959],[41.00099,-.83068],[41.56,-1.59812],[41.56362,-1.66375],[41.75542,-1.85308],[57.49095,8.14549],[51.12877,12.56479]]]]}},{type:"Feature",properties:{iso1A2:"SR",iso1A3:"SUR",iso1N3:"740",wikidata:"Q730",nameEn:"Suriname",groups:["005","419","019","UN"],driveSide:"left",callingCodes:["597"]},geometry:{type:"MultiPolygon",coordinates:[[[[-54.26916,5.26909],[-54.01877,5.52789],[-54.01074,5.68785],[-53.7094,6.2264],[-56.84822,6.73257],[-57.31629,5.33714],[-57.22536,5.15605],[-57.37442,5.0208],[-57.8699,4.89394],[-58.0307,3.95513],[-57.35891,3.32121],[-56.70519,2.02964],[-56.55439,2.02003],[-56.47045,1.95135],[-55.99278,1.83137],[-55.89863,1.89861],[-55.92159,2.05236],[-56.13054,2.27723],[-55.96292,2.53188],[-55.71493,2.40342],[-55.01919,2.564],[-54.6084,2.32856],[-54.42864,2.42442],[-54.28534,2.67798],[-53.9849,3.58697],[-53.98914,3.627],[-54.05128,3.63557],[-54.19367,3.84387],[-54.38444,4.13222],[-54.4717,4.91964],[-54.26916,5.26909]]]]}},{type:"Feature",properties:{iso1A2:"SS",iso1A3:"SSD",iso1N3:"728",wikidata:"Q958",nameEn:"South Sudan",groups:["014","202","002","UN"],callingCodes:["211"]},geometry:{type:"MultiPolygon",coordinates:[[[[34.10229,9.50238],[33.87958,9.49937],[33.9082,9.762],[33.96323,9.80972],[33.99185,9.99623],[33.96984,10.15446],[33.90159,10.17179],[33.80913,10.32994],[33.66604,10.44254],[33.52294,10.64382],[33.24645,10.77913],[33.26977,10.83632],[33.13988,11.43248],[33.25876,12.22111],[32.73921,12.22757],[32.73921,11.95203],[32.10079,11.95203],[32.39578,11.70208],[32.39358,11.18207],[32.46967,11.04662],[31.99177,10.65065],[31.77539,10.28939],[31.28504,9.75287],[30.84605,9.7498],[30.82893,9.71451],[30.53005,9.95992],[30.00389,10.28633],[29.94629,10.29245],[29.54,10.07949],[29.53844,9.75133],[29.06988,9.74826],[28.99983,9.67155],[27.90704,9.61323],[27.14427,9.62858],[26.70685,9.48735],[26.35815,9.57946],[26.21338,9.91545],[25.93241,10.17941],[25.93163,10.38159],[25.78141,10.42599],[25.0918,10.33718],[25.05688,10.06776],[24.97739,9.9081],[24.84653,9.80643],[24.49389,9.79962],[24.12744,9.73784],[24.09319,9.66572],[23.69155,9.67566],[23.62179,9.53823],[23.64981,9.44303],[23.64358,9.28637],[23.56263,9.19418],[23.4848,9.16959],[23.44744,8.99128],[23.59065,8.99743],[23.51905,8.71749],[24.25691,8.69288],[24.13238,8.36959],[24.35965,8.26177],[24.85156,8.16933],[24.98855,7.96588],[25.25319,7.8487],[25.29214,7.66675],[25.20649,7.61115],[25.20337,7.50312],[25.35281,7.42595],[25.37461,7.33024],[25.90076,7.09549],[26.38022,6.63493],[26.32729,6.36272],[26.58259,6.1987],[26.51721,6.09655],[27.22705,5.71254],[27.22705,5.62889],[27.28621,5.56382],[27.23017,5.37167],[27.26886,5.25876],[27.44012,5.07349],[27.56656,4.89375],[27.65462,4.89375],[27.76469,4.79284],[27.79551,4.59976],[28.20719,4.35614],[28.6651,4.42638],[28.8126,4.48784],[29.03054,4.48784],[29.22207,4.34297],[29.43341,4.50101],[29.49726,4.7007],[29.82087,4.56246],[29.79666,4.37809],[30.06964,4.13221],[30.1621,4.10586],[30.22374,3.93896],[30.27658,3.95653],[30.47691,3.83353],[30.55396,3.84451],[30.57378,3.74567],[30.56277,3.62703],[30.78512,3.67097],[30.80713,3.60506],[30.85997,3.5743],[30.85153,3.48867],[30.97601,3.693],[31.16666,3.79853],[31.29476,3.8015],[31.50478,3.67814],[31.50776,3.63652],[31.72075,3.74354],[31.81459,3.82083],[31.86821,3.78664],[31.96205,3.6499],[31.95907,3.57408],[32.05187,3.589],[32.08491,3.56287],[32.08866,3.53543],[32.19888,3.50867],[32.20782,3.6053],[32.41337,3.748],[32.72021,3.77327],[32.89746,3.81339],[33.02852,3.89296],[33.18356,3.77812],[33.51264,3.75068],[33.9873,4.23316],[34.47601,4.72162],[35.34151,5.02364],[35.30992,4.90402],[35.47843,4.91872],[35.42366,4.76969],[35.51424,4.61643],[35.9419,4.61933],[35.82118,4.77382],[35.81968,5.10757],[35.8576,5.33413],[35.50792,5.42431],[35.29938,5.34042],[35.31188,5.50106],[35.13058,5.62118],[35.12611,5.68937],[35.00546,5.89387],[34.96227,6.26415],[35.01738,6.46991],[34.87736,6.60161],[34.77459,6.5957],[34.65096,6.72589],[34.53776,6.74808],[34.53925,6.82794],[34.47669,6.91076],[34.35753,6.91963],[34.19369,7.04382],[34.19369,7.12807],[34.01495,7.25664],[34.03878,7.27437],[34.02984,7.36449],[33.87642,7.5491],[33.71407,7.65983],[33.44745,7.7543],[33.32531,7.71297],[33.24637,7.77939],[33.04944,7.78989],[33.0006,7.90333],[33.08401,8.05822],[33.18083,8.13047],[33.1853,8.29264],[33.19721,8.40317],[33.3119,8.45474],[33.54575,8.47094],[33.66938,8.44442],[33.71407,8.3678],[33.87195,8.41938],[33.89579,8.4842],[34.01346,8.50041],[34.14453,8.60204],[34.14304,9.04654],[34.10229,9.50238]]]]}},{type:"Feature",properties:{iso1A2:"ST",iso1A3:"STP",iso1N3:"678",wikidata:"Q1039",nameEn:"S\xE3o Tom\xE9 and Principe",groups:["017","202","002","UN"],callingCodes:["239"]},geometry:{type:"MultiPolygon",coordinates:[[[[4.34149,1.91417],[6.6507,-.28606],[7.9035,1.92304],[4.34149,1.91417]]]]}},{type:"Feature",properties:{iso1A2:"SV",iso1A3:"SLV",iso1N3:"222",wikidata:"Q792",nameEn:"El Salvador",groups:["013","003","419","019","UN"],callingCodes:["503"]},geometry:{type:"MultiPolygon",coordinates:[[[[-89.34776,14.43013],[-89.39028,14.44561],[-89.57441,14.41637],[-89.58814,14.33165],[-89.50614,14.26084],[-89.52397,14.22628],[-89.61844,14.21937],[-89.70756,14.1537],[-89.75569,14.07073],[-89.73251,14.04133],[-89.76103,14.02923],[-89.81807,14.07073],[-89.88937,14.0396],[-90.10505,13.85104],[-90.11344,13.73679],[-90.55276,12.8866],[-88.11443,12.63306],[-87.7346,13.13228],[-87.55124,13.12523],[-87.69751,13.25228],[-87.73714,13.32715],[-87.80177,13.35689],[-87.84675,13.41078],[-87.83467,13.44655],[-87.77354,13.45767],[-87.73841,13.44169],[-87.72115,13.46083],[-87.71657,13.50577],[-87.78148,13.52906],[-87.73106,13.75443],[-87.68821,13.80829],[-87.7966,13.91353],[-88.00331,13.86948],[-88.07641,13.98447],[-88.23018,13.99915],[-88.25791,13.91108],[-88.48982,13.86458],[-88.49738,13.97224],[-88.70661,14.04317],[-88.73182,14.10919],[-88.815,14.11652],[-88.85785,14.17763],[-88.94608,14.20207],[-89.04187,14.33644],[-89.34776,14.43013]]]]}},{type:"Feature",properties:{iso1A2:"SX",iso1A3:"SXM",iso1N3:"534",wikidata:"Q26273",nameEn:"Sint Maarten",aliases:["NL-SX"],country:"NL",groups:["Q1451600","029","003","419","019","UN"],callingCodes:["1 721"]},geometry:{type:"MultiPolygon",coordinates:[[[[-63.33064,17.9615],[-63.1055,17.86651],[-62.93924,18.02904],[-63.02323,18.05757],[-63.04039,18.05619],[-63.0579,18.06614],[-63.07759,18.04943],[-63.09686,18.04608],[-63.11042,18.05339],[-63.13502,18.05445],[-63.33064,17.9615]]]]}},{type:"Feature",properties:{iso1A2:"SY",iso1A3:"SYR",iso1N3:"760",wikidata:"Q858",nameEn:"Syria",groups:["145","142","UN"],callingCodes:["963"]},geometry:{type:"MultiPolygon",coordinates:[[[[42.23683,37.2863],[42.21548,37.28026],[42.20454,37.28715],[42.22381,37.30238],[42.22257,37.31395],[42.2112,37.32491],[42.19301,37.31323],[42.18225,37.28569],[42.00894,37.17209],[41.515,37.08084],[41.21937,37.07665],[40.90856,37.13147],[40.69136,37.0996],[39.81589,36.75538],[39.21538,36.66834],[39.03217,36.70911],[38.74042,36.70629],[38.55908,36.84429],[38.38859,36.90064],[38.21064,36.91842],[37.81974,36.76055],[37.68048,36.75065],[37.49103,36.66904],[37.47253,36.63243],[37.21988,36.6736],[37.16177,36.66069],[37.10894,36.6704],[37.08279,36.63495],[37.02088,36.66422],[37.01647,36.69512],[37.04619,36.71101],[37.04399,36.73483],[36.99886,36.74012],[36.99557,36.75997],[36.66727,36.82901],[36.61581,36.74629],[36.62681,36.71189],[36.57398,36.65186],[36.58829,36.58295],[36.54206,36.49539],[36.6081,36.33772],[36.65653,36.33861],[36.68672,36.23677],[36.6125,36.22592],[36.50463,36.2419],[36.4617,36.20461],[36.39206,36.22088],[36.37474,36.01163],[36.33956,35.98687],[36.30099,36.00985],[36.28338,36.00273],[36.29769,35.96086],[36.27678,35.94839],[36.25366,35.96264],[36.19973,35.95195],[36.17441,35.92076],[36.1623,35.80925],[36.14029,35.81015],[36.13919,35.83692],[36.11827,35.85923],[35.99829,35.88242],[36.01844,35.92403],[36.00514,35.94113],[35.98499,35.94107],[35.931,35.92109],[35.51152,36.10954],[35.48515,34.70851],[35.97386,34.63322],[35.98718,34.64977],[36.29165,34.62991],[36.32399,34.69334],[36.35135,34.68516],[36.35384,34.65447],[36.42941,34.62505],[36.46003,34.6378],[36.45299,34.59438],[36.41429,34.61175],[36.39846,34.55672],[36.3369,34.52629],[36.34745,34.5002],[36.4442,34.50165],[36.46179,34.46541],[36.55853,34.41609],[36.53039,34.3798],[36.56556,34.31881],[36.60778,34.31009],[36.58667,34.27667],[36.59195,34.2316],[36.62537,34.20251],[36.5128,34.09916],[36.50576,34.05982],[36.41078,34.05253],[36.28589,33.91981],[36.38263,33.86579],[36.3967,33.83365],[36.14517,33.85118],[36.06778,33.82927],[35.9341,33.6596],[36.05723,33.57904],[35.94465,33.52774],[35.94816,33.47886],[35.88668,33.43183],[35.82577,33.40479],[35.81324,33.36354],[35.77477,33.33609],[35.813,33.3172],[35.77513,33.27342],[35.81295,33.24841],[35.81647,33.2028],[35.83846,33.19397],[35.84285,33.16673],[35.81911,33.1336],[35.81911,33.11077],[35.84802,33.1031],[35.87188,32.98028],[35.89298,32.9456],[35.87012,32.91976],[35.84021,32.8725],[35.83758,32.82817],[35.78745,32.77938],[35.75983,32.74803],[35.88405,32.71321],[35.93307,32.71966],[35.96633,32.66237],[36.02239,32.65911],[36.08074,32.51463],[36.20379,32.52751],[36.20875,32.49529],[36.23948,32.50108],[36.40959,32.37908],[36.83946,32.31293],[38.79171,33.37328],[40.64314,34.31604],[40.97676,34.39788],[41.12388,34.65742],[41.2345,34.80049],[41.21654,35.1508],[41.26569,35.42708],[41.38184,35.62502],[41.37027,35.84095],[41.2564,36.06012],[41.28864,36.35368],[41.40058,36.52502],[41.81736,36.58782],[42.36697,37.0627],[42.35724,37.10998],[42.32313,37.17814],[42.34735,37.22548],[42.2824,37.2798],[42.26039,37.27017],[42.23683,37.2863]]]]}},{type:"Feature",properties:{iso1A2:"SZ",iso1A3:"SWZ",iso1N3:"748",wikidata:"Q1050",nameEn:"Eswatini",aliases:["Swaziland"],groups:["018","202","002","UN"],driveSide:"left",callingCodes:["268"]},geometry:{type:"MultiPolygon",coordinates:[[[[31.86881,-25.99973],[31.4175,-25.71886],[31.31237,-25.7431],[31.13073,-25.91558],[30.95819,-26.26303],[30.78927,-26.48271],[30.81101,-26.84722],[30.88826,-26.79622],[30.97757,-26.92706],[30.96088,-27.0245],[31.15027,-27.20151],[31.49834,-27.31549],[31.97592,-27.31675],[31.97463,-27.11057],[32.00893,-26.8096],[32.09664,-26.80721],[32.13315,-26.84345],[32.13409,-26.5317],[32.07352,-26.40185],[32.10435,-26.15656],[32.08599,-26.00978],[32.00916,-25.999],[31.974,-25.95387],[31.86881,-25.99973]]]]}},{type:"Feature",properties:{iso1A2:"TA",iso1A3:"TAA",wikidata:"Q220982",nameEn:"Tristan da Cunha",aliases:["SH-TA"],country:"GB",groups:["SH","BOTS","011","202","002","UN"],isoStatus:"excRes",driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["290 8","44 20"]},geometry:{type:"MultiPolygon",coordinates:[[[[-13.38232,-34.07258],[-16.67337,-41.9188],[-5.88482,-41.4829],[-13.38232,-34.07258]]]]}},{type:"Feature",properties:{iso1A2:"TC",iso1A3:"TCA",iso1N3:"796",wikidata:"Q18221",nameEn:"Turks and Caicos Islands",country:"GB",groups:["BOTS","029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1 649"]},geometry:{type:"MultiPolygon",coordinates:[[[[-71.70065,25.7637],[-72.98446,20.4801],[-69.80718,21.35956],[-71.70065,25.7637]]]]}},{type:"Feature",properties:{iso1A2:"TD",iso1A3:"TCD",iso1N3:"148",wikidata:"Q657",nameEn:"Chad",groups:["017","202","002","UN"],callingCodes:["235"]},geometry:{type:"MultiPolygon",coordinates:[[[[23.99539,19.49944],[15.99566,23.49639],[14.99751,23.00539],[15.19692,21.99339],[15.20213,21.49365],[15.28332,21.44557],[15.62515,20.95395],[15.57248,20.92138],[15.55382,20.86507],[15.56004,20.79488],[15.59841,20.74039],[15.6721,20.70069],[15.99632,20.35364],[15.75098,19.93002],[15.6032,18.77402],[15.50373,16.89649],[14.37425,15.72591],[13.86301,15.04043],[13.78991,14.87519],[13.809,14.72915],[13.67878,14.64013],[13.68573,14.55276],[13.48259,14.46704],[13.47559,14.40881],[13.6302,13.71094],[14.08251,13.0797],[14.46881,13.08259],[14.56101,12.91036],[14.55058,12.78256],[14.83314,12.62963],[14.90827,12.3269],[14.89019,12.16593],[14.96952,12.0925],[15.00146,12.1223],[15.0349,12.10698],[15.05786,12.0608],[15.04808,11.8731],[15.11579,11.79313],[15.06595,11.71126],[15.13149,11.5537],[15.0585,11.40481],[15.10021,11.04101],[15.04957,11.02347],[15.09127,10.87431],[15.06737,10.80921],[15.15532,10.62846],[15.14936,10.53915],[15.23724,10.47764],[15.30874,10.31063],[15.50535,10.1098],[15.68761,9.99344],[15.41408,9.92876],[15.24618,9.99246],[15.14043,9.99246],[15.05999,9.94845],[14.95722,9.97926],[14.80082,9.93818],[14.4673,10.00264],[14.20411,10.00055],[14.1317,9.82413],[14.01793,9.73169],[13.97544,9.6365],[14.37094,9.2954],[14.35707,9.19611],[14.83566,8.80557],[15.09484,8.65982],[15.20426,8.50892],[15.50743,7.79302],[15.59272,7.7696],[15.56964,7.58936],[15.49743,7.52179],[15.73118,7.52006],[15.79942,7.44149],[16.40703,7.68809],[16.41583,7.77971],[16.58315,7.88657],[16.59415,7.76444],[16.658,7.75353],[16.6668,7.67281],[16.8143,7.53971],[17.67288,7.98905],[17.93926,7.95853],[18.02731,8.01085],[18.6085,8.05009],[18.64153,8.08714],[18.62612,8.14163],[18.67455,8.22226],[18.79783,8.25929],[19.11044,8.68172],[18.86388,8.87971],[19.06421,9.00367],[20.36748,9.11019],[20.82979,9.44696],[21.26348,9.97642],[21.34934,9.95907],[21.52766,10.2105],[21.63553,10.217],[21.71479,10.29932],[21.72139,10.64136],[22.45889,11.00246],[22.87758,10.91915],[22.97249,11.21955],[22.93124,11.41645],[22.7997,11.40424],[22.54907,11.64372],[22.64092,12.07485],[22.48369,12.02766],[22.50548,12.16769],[22.38873,12.45514],[22.46345,12.61925],[22.22684,12.74682],[22.15679,12.66634],[21.98711,12.63292],[21.89371,12.68001],[21.81432,12.81362],[21.94819,13.05637],[22.02914,13.13976],[22.1599,13.19281],[22.29689,13.3731],[22.08674,13.77863],[22.22995,13.96754],[22.5553,14.11704],[22.55997,14.23024],[22.44944,14.24986],[22.38562,14.58907],[22.70474,14.69149],[22.66115,14.86308],[22.99584,15.22989],[22.99584,15.40105],[22.92579,15.47007],[22.93201,15.55107],[23.10792,15.71297],[23.38812,15.69649],[23.62785,15.7804],[23.99997,15.69575],[23.99539,19.49944]]]]}},{type:"Feature",properties:{iso1A2:"TF",iso1A3:"ATF",iso1N3:"260",wikidata:"Q129003",nameEn:"French Southern Territories",country:"FR",groups:["EU","UN"]},geometry:null},{type:"Feature",properties:{iso1A2:"TG",iso1A3:"TGO",iso1N3:"768",wikidata:"Q945",nameEn:"Togo",groups:["011","202","002","UN"],callingCodes:["228"]},geometry:{type:"MultiPolygon",coordinates:[[[[.50388,11.01011],[-.13493,11.14075],[-.14462,11.10811],[-.05733,11.08628],[-.0275,11.11202],[-.00514,11.10763],[.00342,11.08317],[.02395,11.06229],[.03355,10.9807],[-.0063,10.96417],[-.00908,10.91644],[-.02685,10.8783],[-.0228,10.81916],[-.07183,10.76794],[-.07327,10.71845],[-.09141,10.7147],[-.05945,10.63458],[.12886,10.53149],[.18846,10.4096],[.29453,10.41546],[.33028,10.30408],[.39584,10.31112],[.35293,10.09412],[.41371,10.06361],[.41252,10.02018],[.36366,10.03309],[.32075,9.72781],[.34816,9.71607],[.34816,9.66907],[.32313,9.6491],[.28261,9.69022],[.26712,9.66437],[.29334,9.59387],[.36008,9.6256],[.38153,9.58682],[.23851,9.57389],[.2409,9.52335],[.30406,9.521],[.31241,9.50337],[.2254,9.47869],[.25758,9.42696],[.33148,9.44812],[.36485,9.49749],[.49118,9.48339],[.56388,9.40697],[.45424,9.04581],[.52455,8.87746],[.37319,8.75262],[.47211,8.59945],[.64731,8.48866],[.73432,8.29529],[.63897,8.25873],[.5913,8.19622],[.61156,8.18324],[.6056,8.13959],[.58891,8.12779],[.62943,7.85751],[.58295,7.62368],[.51979,7.58706],[.52455,7.45354],[.57223,7.39326],[.62943,7.41099],[.65327,7.31643],[.59606,7.01252],[.52217,6.9723],[.52098,6.94391],[.56508,6.92971],[.52853,6.82921],[.57406,6.80348],[.58176,6.76049],[.6497,6.73682],[.63659,6.63857],[.74862,6.56517],[.71048,6.53083],[.89283,6.33779],[.99652,6.33779],[1.03108,6.24064],[1.05969,6.22998],[1.09187,6.17074],[1.19966,6.17069],[1.19771,6.11522],[1.27574,5.93551],[1.67336,6.02702],[1.62913,6.24075],[1.79826,6.28221],[1.76906,6.43189],[1.58105,6.68619],[1.61812,6.74843],[1.55877,6.99737],[1.64249,6.99562],[1.61838,9.0527],[1.5649,9.16941],[1.41746,9.3226],[1.33675,9.54765],[1.36624,9.5951],[1.35507,9.99525],[.77666,10.37665],[.80358,10.71459],[.8804,10.803],[.91245,10.99597],[.66104,10.99964],[.4958,10.93269],[.50521,10.98035],[.48852,10.98561],[.50388,11.01011]]]]}},{type:"Feature",properties:{iso1A2:"TH",iso1A3:"THA",iso1N3:"764",wikidata:"Q869",nameEn:"Thailand",groups:["035","142","UN"],driveSide:"left",callingCodes:["66"]},geometry:{type:"MultiPolygon",coordinates:[[[[100.08404,20.36626],[99.95721,20.46301],[99.91616,20.44986],[99.90499,20.4487],[99.89692,20.44789],[99.89301,20.44311],[99.89168,20.44548],[99.88451,20.44596],[99.88211,20.44488],[99.86383,20.44371],[99.81096,20.33687],[99.68255,20.32077],[99.46008,20.39673],[99.46077,20.36198],[99.5569,20.20676],[99.52943,20.14811],[99.416,20.08614],[99.20328,20.12877],[99.0735,20.10298],[98.98679,19.7419],[98.83661,19.80931],[98.56065,19.67807],[98.51182,19.71303],[98.24884,19.67876],[98.13829,19.78541],[98.03314,19.80941],[98.04364,19.65755],[97.84715,19.55782],[97.88423,19.5041],[97.78769,19.39429],[97.84186,19.29526],[97.78606,19.26769],[97.84024,19.22217],[97.83479,19.09972],[97.73797,19.04261],[97.73654,18.9812],[97.66487,18.9371],[97.73836,18.88478],[97.76752,18.58097],[97.5258,18.4939],[97.36444,18.57138],[97.34522,18.54596],[97.50383,18.26844],[97.56219,18.33885],[97.64116,18.29778],[97.60841,18.23846],[97.73723,17.97912],[97.66794,17.88005],[97.76407,17.71595],[97.91829,17.54504],[98.11185,17.36829],[98.10439,17.33847],[98.34566,17.04822],[98.39441,17.06266],[98.52624,16.89979],[98.49603,16.8446],[98.53833,16.81934],[98.46994,16.73613],[98.50253,16.7139],[98.49713,16.69022],[98.51043,16.70107],[98.51579,16.69433],[98.51472,16.68521],[98.51833,16.676],[98.51113,16.64503],[98.5695,16.62826],[98.57912,16.55983],[98.63817,16.47424],[98.68074,16.27068],[98.84485,16.42354],[98.92656,16.36425],[98.8376,16.11706],[98.69585,16.13353],[98.57019,16.04578],[98.59853,15.87197],[98.541,15.65406],[98.58598,15.46821],[98.56027,15.33471],[98.4866,15.39154],[98.39351,15.34177],[98.41906,15.27103],[98.40522,15.25268],[98.30446,15.30667],[98.22,15.21327],[98.18821,15.13125],[98.24874,14.83013],[98.56762,14.37701],[98.97356,14.04868],[99.16695,13.72621],[99.20617,13.20575],[99.12225,13.19847],[99.10646,13.05804],[99.18748,12.9898],[99.18905,12.84799],[99.29254,12.68921],[99.409,12.60603],[99.47519,12.1353],[99.56445,12.14805],[99.53424,12.02317],[99.64891,11.82699],[99.64108,11.78948],[99.5672,11.62732],[99.47598,11.62434],[99.39485,11.3925],[99.31573,11.32081],[99.32756,11.28545],[99.06938,10.94857],[99.02337,10.97217],[98.99701,10.92962],[99.0069,10.85485],[98.86819,10.78336],[98.78511,10.68351],[98.77275,10.62548],[98.81944,10.52761],[98.7391,10.31488],[98.55174,9.92804],[98.52291,9.92389],[98.47298,9.95782],[98.33094,9.91973],[98.12555,9.44056],[97.63455,9.60854],[97.19814,8.18901],[99.31854,5.99868],[99.50117,6.44501],[99.91873,6.50233],[100.0756,6.4045],[100.12,6.42105],[100.19511,6.72559],[100.29651,6.68439],[100.30828,6.66462],[100.31618,6.66781],[100.31884,6.66423],[100.32671,6.66526],[100.32607,6.65933],[100.31929,6.65413],[100.35413,6.54932],[100.41152,6.52299],[100.41791,6.5189],[100.42351,6.51762],[100.43027,6.52389],[100.66986,6.45086],[100.74361,6.50811],[100.74822,6.46231],[100.81045,6.45086],[100.85884,6.24929],[101.10313,6.25617],[101.12618,6.19431],[101.06165,6.14161],[101.12388,6.11411],[101.087,5.9193],[101.02708,5.91013],[100.98815,5.79464],[101.14062,5.61613],[101.25755,5.71065],[101.25524,5.78633],[101.58019,5.93534],[101.69773,5.75881],[101.75074,5.79091],[101.80144,5.74505],[101.89188,5.8386],[101.91776,5.84269],[101.92819,5.85511],[101.94712,5.98421],[101.9714,6.00575],[101.97114,6.01992],[101.99209,6.04075],[102.01835,6.05407],[102.09182,6.14161],[102.07732,6.193],[102.08127,6.22679],[102.09086,6.23546],[102.46318,7.22462],[102.47649,9.66162],[102.52395,11.25257],[102.91449,11.65512],[102.90973,11.75613],[102.83957,11.8519],[102.78427,11.98746],[102.77026,12.06815],[102.70176,12.1686],[102.73134,12.37091],[102.78116,12.40284],[102.7796,12.43781],[102.57567,12.65358],[102.51963,12.66117],[102.4994,12.71736],[102.53053,12.77506],[102.49335,12.92711],[102.48694,12.97537],[102.52275,12.99813],[102.46011,13.08057],[102.43422,13.09061],[102.36146,13.26006],[102.36001,13.31142],[102.34611,13.35618],[102.35692,13.38274],[102.35563,13.47307],[102.361,13.50551],[102.33828,13.55613],[102.36859,13.57488],[102.44601,13.5637],[102.5358,13.56933],[102.57573,13.60461],[102.62483,13.60883],[102.58635,13.6286],[102.5481,13.6589],[102.56848,13.69366],[102.72727,13.77806],[102.77864,13.93374],[102.91251,14.01531],[102.93275,14.19044],[103.16469,14.33075],[103.39353,14.35639],[103.53518,14.42575],[103.71109,14.4348],[103.70175,14.38052],[103.93836,14.3398],[104.27616,14.39861],[104.55014,14.36091],[104.69335,14.42726],[104.97667,14.38806],[105.02804,14.23722],[105.08408,14.20402],[105.14012,14.23873],[105.17748,14.34432],[105.20894,14.34967],[105.43783,14.43865],[105.53864,14.55731],[105.5121,14.80802],[105.61162,15.00037],[105.46661,15.13132],[105.58043,15.32724],[105.50662,15.32054],[105.4692,15.33709],[105.47635,15.3796],[105.58191,15.41031],[105.60446,15.53301],[105.61756,15.68792],[105.46573,15.74742],[105.42285,15.76971],[105.37959,15.84074],[105.34115,15.92737],[105.38508,15.987],[105.42001,16.00657],[105.06204,16.09792],[105.00262,16.25627],[104.88057,16.37311],[104.73349,16.565],[104.76099,16.69302],[104.7397,16.81005],[104.76442,16.84752],[104.7373,16.91125],[104.73712,17.01404],[104.80716,17.19025],[104.80061,17.39367],[104.69867,17.53038],[104.45404,17.66788],[104.35432,17.82871],[104.2757,17.86139],[104.21776,17.99335],[104.10927,18.10826],[104.06533,18.21656],[103.97725,18.33631],[103.93916,18.33914],[103.85642,18.28666],[103.82449,18.33979],[103.699,18.34125],[103.60957,18.40528],[103.47773,18.42841],[103.41044,18.4486],[103.30977,18.4341],[103.24779,18.37807],[103.23818,18.34875],[103.29757,18.30475],[103.17093,18.2618],[103.14994,18.23172],[103.1493,18.17799],[103.07343,18.12351],[103.07823,18.03833],[103.0566,18.00144],[103.01998,17.97095],[102.9912,17.9949],[102.95812,18.0054],[102.86323,17.97531],[102.81988,17.94233],[102.79044,17.93612],[102.75954,17.89561],[102.68538,17.86653],[102.67543,17.84529],[102.69946,17.81686],[102.68194,17.80151],[102.59485,17.83537],[102.5896,17.84889],[102.61432,17.92273],[102.60971,17.95411],[102.59234,17.96127],[102.45523,17.97106],[102.11359,18.21532],[101.88485,18.02474],[101.78087,18.07559],[101.72294,17.92867],[101.44667,17.7392],[101.15108,17.47586],[100.96541,17.57926],[101.02185,17.87637],[101.1793,18.0544],[101.19118,18.2125],[101.15108,18.25624],[101.18227,18.34367],[101.06047,18.43247],[101.27585,18.68875],[101.22832,18.73377],[101.25803,18.89545],[101.35606,19.04716],[101.261,19.12717],[101.24911,19.33334],[101.20604,19.35296],[101.21347,19.46223],[101.26991,19.48324],[101.26545,19.59242],[101.08928,19.59748],[100.90302,19.61901],[100.77231,19.48324],[100.64606,19.55884],[100.58219,19.49164],[100.49604,19.53504],[100.398,19.75047],[100.5094,19.87904],[100.58808,20.15791],[100.55218,20.17741],[100.51052,20.14928],[100.47567,20.19133],[100.4537,20.19971],[100.44992,20.23644],[100.41473,20.25625],[100.37439,20.35156],[100.33383,20.4028],[100.25769,20.3992],[100.22076,20.31598],[100.16668,20.2986],[100.1712,20.24324],[100.11785,20.24787],[100.09337,20.26293],[100.09999,20.31614],[100.08404,20.36626]]]]}},{type:"Feature",properties:{iso1A2:"TJ",iso1A3:"TJK",iso1N3:"762",wikidata:"Q863",nameEn:"Tajikistan",groups:["143","142","UN"],callingCodes:["992"]},geometry:{type:"MultiPolygon",coordinates:[[[[70.45251,41.04438],[70.38028,41.02014],[70.36655,40.90296],[69.69434,40.62615],[69.59441,40.70181],[69.53021,40.77621],[69.38327,40.7918],[69.32834,40.70233],[69.3455,40.57988],[69.2643,40.57506],[69.21063,40.54469],[69.27066,40.49274],[69.28525,40.41894],[69.30774,40.36102],[69.33794,40.34819],[69.32833,40.29794],[69.30808,40.2821],[69.24817,40.30357],[69.25229,40.26362],[69.30104,40.24502],[69.30448,40.18774],[69.2074,40.21488],[69.15659,40.2162],[69.04544,40.22904],[68.85832,40.20885],[68.84357,40.18604],[68.79276,40.17555],[68.77902,40.20492],[68.5332,40.14826],[68.52771,40.11676],[68.62796,40.07789],[69.01523,40.15771],[69.01935,40.11466],[68.96579,40.06949],[68.84906,40.04952],[68.93695,39.91167],[68.88889,39.87163],[68.63071,39.85265],[68.61972,39.68905],[68.54166,39.53929],[68.12053,39.56317],[67.70992,39.66156],[67.62889,39.60234],[67.44899,39.57799],[67.46547,39.53564],[67.39681,39.52505],[67.46822,39.46146],[67.45998,39.315],[67.36522,39.31287],[67.33226,39.23739],[67.67833,39.14479],[67.68915,39.00775],[68.09704,39.02589],[68.19743,38.85985],[68.06948,38.82115],[68.12877,38.73677],[68.05598,38.71641],[68.0807,38.64136],[68.05873,38.56087],[68.11366,38.47169],[68.06274,38.39435],[68.13289,38.40822],[68.40343,38.19484],[68.27159,37.91477],[68.12635,37.93],[67.81566,37.43107],[67.8474,37.31594],[67.78329,37.1834],[67.7803,37.08978],[67.87917,37.0591],[68.02194,36.91923],[68.18542,37.02074],[68.27605,37.00977],[68.29253,37.10621],[68.41201,37.10402],[68.41888,37.13906],[68.61851,37.19815],[68.6798,37.27906],[68.81438,37.23862],[68.80889,37.32494],[68.91189,37.26704],[68.88168,37.33368],[68.96407,37.32603],[69.03274,37.25174],[69.25152,37.09426],[69.39529,37.16752],[69.45022,37.23315],[69.36645,37.40462],[69.44954,37.4869],[69.51888,37.5844],[69.80041,37.5746],[69.84435,37.60616],[69.93362,37.61378],[69.95971,37.5659],[70.15015,37.52519],[70.28243,37.66706],[70.27694,37.81258],[70.1863,37.84296],[70.17206,37.93276],[70.4898,38.12546],[70.54673,38.24541],[70.60407,38.28046],[70.61526,38.34774],[70.64966,38.34999],[70.69189,38.37031],[70.6761,38.39144],[70.67438,38.40597],[70.69807,38.41861],[70.72485,38.4131],[70.75455,38.4252],[70.77132,38.45548],[70.78581,38.45502],[70.78702,38.45031],[70.79766,38.44944],[70.80521,38.44447],[70.81697,38.44507],[70.82538,38.45394],[70.84376,38.44688],[70.88719,38.46826],[70.92728,38.43021],[70.98693,38.48862],[71.03545,38.44779],[71.0556,38.40176],[71.09542,38.42517],[71.10592,38.42077],[71.10957,38.40671],[71.1451,38.40106],[71.21291,38.32797],[71.33114,38.30339],[71.33869,38.27335],[71.37803,38.25641],[71.36444,38.15358],[71.29878,38.04429],[71.28922,38.01272],[71.27622,37.99946],[71.27278,37.96496],[71.24969,37.93031],[71.2809,37.91995],[71.296,37.93403],[71.32871,37.88564],[71.51565,37.95349],[71.58843,37.92425],[71.59255,37.79956],[71.55752,37.78677],[71.54324,37.77104],[71.53053,37.76534],[71.55234,37.73209],[71.54186,37.69691],[71.51972,37.61945],[71.5065,37.60912],[71.49693,37.53527],[71.50616,37.50733],[71.5256,37.47971],[71.49612,37.4279],[71.47685,37.40281],[71.4862,37.33405],[71.49821,37.31975],[71.50674,37.31502],[71.48536,37.26017],[71.4824,37.24921],[71.48339,37.23937],[71.47386,37.2269],[71.4555,37.21418],[71.4494,37.18137],[71.44127,37.11856],[71.43097,37.05855],[71.45578,37.03094],[71.46923,36.99925],[71.48481,36.93218],[71.51502,36.89128],[71.57195,36.74943],[71.67083,36.67346],[71.83229,36.68084],[72.31676,36.98115],[72.54095,37.00007],[72.66381,37.02014],[72.79693,37.22222],[73.06884,37.31729],[73.29633,37.46495],[73.77197,37.4417],[73.76647,37.33913],[73.61129,37.27469],[73.64974,37.23643],[73.82552,37.22659],[73.8564,37.26158],[74.20308,37.34208],[74.23339,37.41116],[74.41055,37.3948],[74.56161,37.37734],[74.68383,37.3948],[74.8294,37.3435],[74.88887,37.23275],[75.12328,37.31839],[75.09719,37.37297],[75.15899,37.41443],[75.06011,37.52779],[74.94338,37.55501],[74.8912,37.67576],[75.00935,37.77486],[74.92416,37.83428],[74.9063,38.03033],[74.82665,38.07359],[74.80331,38.19889],[74.69894,38.22155],[74.69619,38.42947],[74.51217,38.47034],[74.17022,38.65504],[73.97933,38.52945],[73.79806,38.61106],[73.80656,38.66449],[73.7033,38.84782],[73.7445,38.93867],[73.82964,38.91517],[73.81728,39.04007],[73.75823,39.023],[73.60638,39.24534],[73.54572,39.27567],[73.55396,39.3543],[73.5004,39.38402],[73.59241,39.40843],[73.59831,39.46425],[73.45096,39.46677],[73.31912,39.38615],[73.18454,39.35536],[72.85934,39.35116],[72.62027,39.39696],[72.33173,39.33093],[72.23834,39.17248],[72.17242,39.2661],[72.09689,39.26823],[72.04059,39.36704],[71.90601,39.27674],[71.79202,39.27355],[71.7522,39.32031],[71.80164,39.40631],[71.76816,39.45456],[71.62688,39.44056],[71.5517,39.45722],[71.55856,39.57588],[71.49814,39.61397],[71.08752,39.50704],[71.06418,39.41586],[70.7854,39.38933],[70.64087,39.58792],[70.44757,39.60128],[70.2869,39.53141],[70.11111,39.58223],[69.87491,39.53882],[69.68677,39.59281],[69.3594,39.52516],[69.26938,39.8127],[69.35649,40.01994],[69.43134,39.98431],[69.43557,39.92877],[69.53615,39.93991],[69.5057,40.03277],[69.53855,40.0887],[69.53794,40.11833],[69.55555,40.12296],[69.57615,40.10524],[69.64704,40.12165],[69.67001,40.10639],[70.01283,40.23288],[70.58297,40.00891],[70.57384,39.99394],[70.47557,39.93216],[70.55033,39.96619],[70.58912,39.95211],[70.65946,39.9878],[70.65827,40.0981],[70.7928,40.12797],[70.80495,40.16813],[70.9818,40.22392],[70.8607,40.217],[70.62342,40.17396],[70.56394,40.26421],[70.57149,40.3442],[70.37511,40.38605],[70.32626,40.45174],[70.49871,40.52503],[70.80009,40.72825],[70.45251,41.04438]]],[[[70.68112,40.90612],[70.6158,40.97661],[70.56077,41.00642],[70.54223,40.98787],[70.57501,40.98941],[70.6721,40.90555],[70.68112,40.90612]]],[[[70.74189,39.86319],[70.53651,39.89155],[70.52631,39.86989],[70.54998,39.85137],[70.59667,39.83542],[70.63105,39.77923],[70.74189,39.86319]]]]}},{type:"Feature",properties:{iso1A2:"TK",iso1A3:"TKL",iso1N3:"772",wikidata:"Q36823",nameEn:"Tokelau",country:"NZ",groups:["061","009","UN"],driveSide:"left",callingCodes:["690"]},geometry:{type:"MultiPolygon",coordinates:[[[[-168.251,-9.44289],[-174.18635,-7.80441],[-174.17993,-10.13616],[-168.251,-9.44289]]]]}},{type:"Feature",properties:{iso1A2:"TL",iso1A3:"TLS",iso1N3:"626",wikidata:"Q574",nameEn:"East Timor",aliases:["Timor-Leste","TP"],groups:["035","142","UN"],driveSide:"left",callingCodes:["670"]},geometry:{type:"MultiPolygon",coordinates:[[[[124.46701,-9.13002],[124.94011,-8.85617],[124.97742,-9.08128],[125.11764,-8.96359],[125.18632,-9.03142],[125.18907,-9.16434],[125.09434,-9.19669],[125.04044,-9.17093],[124.97892,-9.19281],[125.09025,-9.46406],[125.68138,-9.85176],[127.55165,-9.05052],[127.42116,-8.22471],[125.87691,-8.31789],[125.58506,-7.95311],[124.92337,-8.75859],[124.33472,-9.11416],[124.04628,-9.22671],[124.04286,-9.34243],[124.10539,-9.41206],[124.14517,-9.42324],[124.21247,-9.36904],[124.28115,-9.42189],[124.28115,-9.50453],[124.3535,-9.48493],[124.35258,-9.43002],[124.38554,-9.3582],[124.45971,-9.30263],[124.46701,-9.13002]]]]}},{type:"Feature",properties:{iso1A2:"TM",iso1A3:"TKM",iso1N3:"795",wikidata:"Q874",nameEn:"Turkmenistan",groups:["143","142","UN"],callingCodes:["993"]},geometry:{type:"MultiPolygon",coordinates:[[[[60.5078,41.21694],[60.06581,41.4363],[60.18117,41.60082],[60.06032,41.76287],[60.08504,41.80997],[60.33223,41.75058],[59.95046,41.97966],[60.0356,42.01028],[60.04659,42.08982],[59.96419,42.1428],[60.00539,42.212],[59.94633,42.27655],[59.4341,42.29738],[59.2955,42.37064],[59.17317,42.52248],[58.93422,42.5407],[58.6266,42.79314],[58.57991,42.64988],[58.27504,42.69632],[58.14321,42.62159],[58.29427,42.56497],[58.51674,42.30348],[58.40688,42.29535],[58.3492,42.43335],[57.99214,42.50021],[57.90975,42.4374],[57.92897,42.24047],[57.84932,42.18555],[57.6296,42.16519],[57.30275,42.14076],[57.03633,41.92043],[56.96218,41.80383],[57.03359,41.41777],[57.13796,41.36625],[57.03423,41.25435],[56.00314,41.32584],[55.45471,41.25609],[54.95182,41.92424],[54.20635,42.38477],[52.97575,42.1308],[52.47884,41.78034],[52.26048,41.69249],[51.7708,40.29239],[53.89734,37.3464],[54.24565,37.32047],[54.36211,37.34912],[54.58664,37.45809],[54.67247,37.43532],[54.77822,37.51597],[54.81804,37.61285],[54.77684,37.62264],[54.851,37.75739],[55.13412,37.94705],[55.44152,38.08564],[55.76561,38.12238],[55.97847,38.08024],[56.33278,38.08132],[56.32454,38.18502],[56.43303,38.26054],[56.62255,38.24005],[56.73928,38.27887],[57.03453,38.18717],[57.21169,38.28965],[57.37236,38.09321],[57.35042,37.98546],[57.79534,37.89299],[58.21399,37.77281],[58.22999,37.6856],[58.39959,37.63134],[58.47786,37.6433],[58.5479,37.70526],[58.6921,37.64548],[58.9338,37.67374],[59.22905,37.51161],[59.33507,37.53146],[59.39797,37.47892],[59.39385,37.34257],[59.55178,37.13594],[59.74678,37.12499],[60.00768,37.04102],[60.34767,36.63214],[61.14516,36.64644],[61.18187,36.55348],[61.1393,36.38782],[61.22719,36.12759],[61.12007,35.95992],[61.22444,35.92879],[61.26152,35.80749],[61.22719,35.67038],[61.27371,35.61482],[61.58742,35.43803],[61.77693,35.41341],[61.97743,35.4604],[62.05709,35.43803],[62.15871,35.33278],[62.29191,35.25964],[62.29878,35.13312],[62.48006,35.28796],[62.62288,35.22067],[62.74098,35.25432],[62.90853,35.37086],[63.0898,35.43131],[63.12276,35.53196],[63.10079,35.63024],[63.23262,35.67487],[63.10318,35.81782],[63.12276,35.86208],[63.29579,35.85985],[63.53475,35.90881],[63.56496,35.95106],[63.98519,36.03773],[64.05385,36.10433],[64.43288,36.24401],[64.57295,36.34362],[64.62514,36.44311],[64.61141,36.6351],[64.97945,37.21913],[65.51778,37.23881],[65.64263,37.34388],[65.64137,37.45061],[65.72274,37.55438],[66.30993,37.32409],[66.55743,37.35409],[66.52303,37.39827],[66.65761,37.45497],[66.52852,37.58568],[66.53676,37.80084],[66.67684,37.96776],[66.56697,38.0435],[66.41042,38.02403],[66.24013,38.16238],[65.83913,38.25733],[65.55873,38.29052],[64.32576,38.98691],[64.19086,38.95561],[63.70778,39.22349],[63.6913,39.27666],[62.43337,39.98528],[62.34273,40.43206],[62.11751,40.58242],[61.87856,41.12257],[61.4446,41.29407],[61.39732,41.19873],[61.33199,41.14946],[61.22212,41.14946],[61.03261,41.25691],[60.5078,41.21694]]]]}},{type:"Feature",properties:{iso1A2:"TN",iso1A3:"TUN",iso1N3:"788",wikidata:"Q948",nameEn:"Tunisia",groups:["015","002","UN"],callingCodes:["216"]},geometry:{type:"MultiPolygon",coordinates:[[[[11.2718,37.6713],[7.89009,38.19924],[8.59123,37.14286],[8.64044,36.9401],[8.62972,36.86499],[8.67706,36.8364],[8.57613,36.78062],[8.46537,36.7706],[8.47609,36.66607],[8.16167,36.48817],[8.18936,36.44939],[8.40731,36.42208],[8.2626,35.91733],[8.26472,35.73669],[8.35371,35.66373],[8.36086,35.47774],[8.30329,35.29884],[8.47318,35.23376],[8.3555,35.10007],[8.30727,34.95378],[8.25189,34.92009],[8.29655,34.72798],[8.20482,34.57575],[7.86264,34.3987],[7.81242,34.21841],[7.74207,34.16492],[7.66174,34.20167],[7.52851,34.06493],[7.54088,33.7726],[7.73687,33.42114],[7.83028,33.18851],[8.11433,33.10175],[8.1179,33.05086],[8.31895,32.83483],[8.35999,32.50101],[9.07483,32.07865],[9.55544,30.23971],[9.76848,30.34366],[9.88152,30.34074],[10.29516,30.90337],[10.12239,31.42098],[10.31364,31.72648],[10.48497,31.72956],[10.62788,31.96629],[10.7315,31.97235],[11.04234,32.2145],[11.53898,32.4138],[11.57828,32.48013],[11.46037,32.6307],[11.51549,33.09826],[11.55852,33.1409],[11.58941,33.36891],[11.2718,37.6713]]]]}},{type:"Feature",properties:{iso1A2:"TO",iso1A3:"TON",iso1N3:"776",wikidata:"Q678",nameEn:"Tonga",groups:["061","009","UN"],driveSide:"left",callingCodes:["676"]},geometry:{type:"MultiPolygon",coordinates:[[[[-176.74538,-22.89767],[-180,-22.90585],[-180,-24.21376],[-173.10761,-24.19665],[-173.13438,-14.94228],[-176.76826,-14.95183],[-176.74538,-22.89767]]]]}},{type:"Feature",properties:{iso1A2:"TR",iso1A3:"TUR",iso1N3:"792",wikidata:"Q43",nameEn:"Turkey",groups:["145","142","UN"],callingCodes:["90"]},geometry:{type:"MultiPolygon",coordinates:[[[[41.54366,41.52185],[40.89217,41.72528],[34.8305,42.4581],[28.32297,41.98371],[28.02971,41.98066],[27.91479,41.97902],[27.83492,41.99709],[27.81235,41.94803],[27.69949,41.97515],[27.55191,41.90928],[27.52379,41.93756],[27.45478,41.96591],[27.27411,42.10409],[27.22376,42.10152],[27.19251,42.06028],[27.08486,42.08735],[27.03277,42.0809],[26.95638,42.00741],[26.79143,41.97386],[26.62996,41.97644],[26.56051,41.92995],[26.57961,41.90024],[26.53968,41.82653],[26.36952,41.82265],[26.33589,41.76802],[26.32952,41.73637],[26.35957,41.71149],[26.47958,41.67037],[26.5209,41.62592],[26.59196,41.60491],[26.59742,41.48058],[26.61767,41.42281],[26.62997,41.34613],[26.5837,41.32131],[26.5209,41.33993],[26.39861,41.25053],[26.32259,41.24929],[26.31928,41.07386],[26.3606,41.02027],[26.33297,40.98388],[26.35894,40.94292],[26.32259,40.94042],[26.28623,40.93005],[26.29441,40.89119],[26.26169,40.9168],[26.20856,40.86048],[26.21351,40.83298],[26.15685,40.80709],[26.12854,40.77339],[26.12495,40.74283],[26.08638,40.73214],[26.0754,40.72772],[26.03489,40.73051],[25.94795,40.72797],[26.04292,40.3958],[25.61285,40.17161],[25.94257,39.39358],[26.43357,39.43096],[26.70773,39.0312],[26.61814,38.81372],[26.21136,38.65436],[26.32173,38.48731],[26.24183,38.44695],[26.21136,38.17558],[27.05537,37.9131],[27.16428,37.72343],[26.99377,37.69034],[26.95583,37.64989],[27.14757,37.32],[27.20312,36.94571],[27.45627,36.9008],[27.24613,36.71622],[27.46117,36.53789],[27.89482,36.69898],[27.95037,36.46155],[28.23708,36.56812],[29.30783,36.01033],[29.48192,36.18377],[29.61002,36.1731],[29.61805,36.14179],[29.69611,36.10365],[29.73302,35.92555],[32.82353,35.70297],[35.51152,36.10954],[35.931,35.92109],[35.98499,35.94107],[36.00514,35.94113],[36.01844,35.92403],[35.99829,35.88242],[36.11827,35.85923],[36.13919,35.83692],[36.14029,35.81015],[36.1623,35.80925],[36.17441,35.92076],[36.19973,35.95195],[36.25366,35.96264],[36.27678,35.94839],[36.29769,35.96086],[36.28338,36.00273],[36.30099,36.00985],[36.33956,35.98687],[36.37474,36.01163],[36.39206,36.22088],[36.4617,36.20461],[36.50463,36.2419],[36.6125,36.22592],[36.68672,36.23677],[36.65653,36.33861],[36.6081,36.33772],[36.54206,36.49539],[36.58829,36.58295],[36.57398,36.65186],[36.62681,36.71189],[36.61581,36.74629],[36.66727,36.82901],[36.99557,36.75997],[36.99886,36.74012],[37.04399,36.73483],[37.04619,36.71101],[37.01647,36.69512],[37.02088,36.66422],[37.08279,36.63495],[37.10894,36.6704],[37.16177,36.66069],[37.21988,36.6736],[37.47253,36.63243],[37.49103,36.66904],[37.68048,36.75065],[37.81974,36.76055],[38.21064,36.91842],[38.38859,36.90064],[38.55908,36.84429],[38.74042,36.70629],[39.03217,36.70911],[39.21538,36.66834],[39.81589,36.75538],[40.69136,37.0996],[40.90856,37.13147],[41.21937,37.07665],[41.515,37.08084],[42.00894,37.17209],[42.18225,37.28569],[42.19301,37.31323],[42.2112,37.32491],[42.22257,37.31395],[42.22381,37.30238],[42.20454,37.28715],[42.21548,37.28026],[42.23683,37.2863],[42.26039,37.27017],[42.2824,37.2798],[42.34735,37.22548],[42.32313,37.17814],[42.35724,37.10998],[42.56725,37.14878],[42.78887,37.38615],[42.93705,37.32015],[43.11403,37.37436],[43.30083,37.30629],[43.33508,37.33105],[43.50787,37.24436],[43.56702,37.25675],[43.63085,37.21957],[43.7009,37.23692],[43.8052,37.22825],[43.82699,37.19477],[43.84878,37.22205],[43.90949,37.22453],[44.02002,37.33229],[44.13521,37.32486],[44.2613,37.25055],[44.27998,37.16501],[44.22239,37.15756],[44.18503,37.09551],[44.25975,36.98119],[44.30645,36.97373],[44.35937,37.02843],[44.35315,37.04955],[44.38117,37.05825],[44.42631,37.05825],[44.63179,37.19229],[44.76698,37.16162],[44.78319,37.1431],[44.7868,37.16644],[44.75986,37.21549],[44.81021,37.2915],[44.58449,37.45018],[44.61401,37.60165],[44.56887,37.6429],[44.62096,37.71985],[44.55498,37.783],[44.45948,37.77065],[44.3883,37.85433],[44.22509,37.88859],[44.42476,38.25763],[44.50115,38.33939],[44.44386,38.38295],[44.38309,38.36117],[44.3119,38.37887],[44.3207,38.49799],[44.32058,38.62752],[44.28065,38.6465],[44.26155,38.71427],[44.30322,38.81581],[44.18863,38.93881],[44.20946,39.13975],[44.1043,39.19842],[44.03667,39.39223],[44.22452,39.4169],[44.29818,39.378],[44.37921,39.4131],[44.42832,39.4131],[44.41849,39.56659],[44.48111,39.61579],[44.47298,39.68788],[44.6137,39.78393],[44.65422,39.72163],[44.71806,39.71124],[44.81043,39.62677],[44.80977,39.65768],[44.75779,39.7148],[44.61845,39.8281],[44.46635,39.97733],[44.26973,40.04866],[44.1778,40.02845],[44.1057,40.03555],[43.92307,40.01787],[43.65688,40.11199],[43.65221,40.14889],[43.71136,40.16673],[43.59928,40.34019],[43.60862,40.43267],[43.54791,40.47413],[43.63664,40.54159],[43.7425,40.66805],[43.74872,40.7365],[43.67712,40.84846],[43.67712,40.93084],[43.58683,40.98961],[43.47319,41.02251],[43.44984,41.0988],[43.4717,41.12611],[43.44973,41.17666],[43.36118,41.2028],[43.23096,41.17536],[43.1945,41.25242],[43.13373,41.25503],[43.21707,41.30331],[43.02956,41.37891],[42.8785,41.50516],[42.84899,41.47265],[42.78995,41.50126],[42.84471,41.58912],[42.72794,41.59714],[42.59202,41.58183],[42.51772,41.43606],[42.26387,41.49346],[41.95134,41.52466],[41.81939,41.43621],[41.7124,41.47417],[41.7148,41.4932],[41.54366,41.52185]]]]}},{type:"Feature",properties:{iso1A2:"TT",iso1A3:"TTO",iso1N3:"780",wikidata:"Q754",nameEn:"Trinidad and Tobago",groups:["029","003","419","019","UN"],driveSide:"left",callingCodes:["1 868"]},geometry:{type:"MultiPolygon",coordinates:[[[[-61.62505,11.18974],[-62.08693,10.04435],[-60.89962,9.81445],[-60.07172,11.77667],[-61.62505,11.18974]]]]}},{type:"Feature",properties:{iso1A2:"TV",iso1A3:"TUV",iso1N3:"798",wikidata:"Q672",nameEn:"Tuvalu",groups:["061","009","UN"],driveSide:"left",callingCodes:["688"]},geometry:{type:"MultiPolygon",coordinates:[[[[174,-5],[174,-11.5],[179.99999,-11.5],[179.99999,-5],[174,-5]]]]}},{type:"Feature",properties:{iso1A2:"TW",iso1A3:"TWN",iso1N3:"158",wikidata:"Q865",nameEn:"Taiwan",aliases:["RC"],groups:["030","142"],callingCodes:["886"]},geometry:{type:"MultiPolygon",coordinates:[[[[121.8109,21.77688],[122.26612,25.98197],[120.49232,25.22863],[118.56434,24.49266],[118.42453,24.54644],[118.35291,24.51645],[118.28244,24.51231],[118.11703,24.39734],[120.69238,21.52331],[121.8109,21.77688]]]]}},{type:"Feature",properties:{iso1A2:"TZ",iso1A3:"TZA",iso1N3:"834",wikidata:"Q924",nameEn:"Tanzania",groups:["014","202","002","UN"],driveSide:"left",callingCodes:["255"]},geometry:{type:"MultiPolygon",coordinates:[[[[30.80408,-.99911],[30.76635,-.9852],[30.70631,-1.01175],[30.64166,-1.06601],[30.47194,-1.0555],[30.45116,-1.10641],[30.50889,-1.16412],[30.57123,-1.33264],[30.71974,-1.43244],[30.84079,-1.64652],[30.80802,-1.91477],[30.89303,-2.08223],[30.83915,-2.35795],[30.54501,-2.41404],[30.41789,-2.66266],[30.52747,-2.65841],[30.40662,-2.86151],[30.4987,-2.9573],[30.57926,-2.89791],[30.6675,-2.98987],[30.83823,-2.97837],[30.84165,-3.25152],[30.45915,-3.56532],[30.22042,-4.01738],[30.03323,-4.26631],[29.88172,-4.35743],[29.82885,-4.36153],[29.77289,-4.41733],[29.75109,-4.45836],[29.63827,-4.44681],[29.43673,-4.44845],[29.52552,-6.2731],[30.2567,-7.14121],[30.79243,-8.27382],[31.00796,-8.58615],[31.37533,-8.60769],[31.57147,-8.70619],[31.57147,-8.81388],[31.71158,-8.91386],[31.81587,-8.88618],[31.94663,-8.93846],[31.94196,-9.02303],[31.98866,-9.07069],[32.08206,-9.04609],[32.16146,-9.05993],[32.25486,-9.13371],[32.43543,-9.11988],[32.49147,-9.14754],[32.53661,-9.24281],[32.75611,-9.28583],[32.76233,-9.31963],[32.95389,-9.40138],[32.99397,-9.36712],[33.14925,-9.49322],[33.31581,-9.48554],[33.48052,-9.62442],[33.76677,-9.58516],[33.93298,-9.71647],[33.9638,-9.62206],[33.95829,-9.54066],[34.03865,-9.49398],[34.54499,-10.0678],[34.51911,-10.12279],[34.57581,-10.56271],[34.65946,-10.6828],[34.67047,-10.93796],[34.61161,-11.01611],[34.63305,-11.11731],[34.79375,-11.32245],[34.91153,-11.39799],[34.96296,-11.57354],[35.63599,-11.55927],[35.82767,-11.41081],[36.19094,-11.57593],[36.19094,-11.70008],[36.62068,-11.72884],[36.80309,-11.56836],[37.3936,-11.68949],[37.76614,-11.53352],[37.8388,-11.3123],[37.93618,-11.26228],[38.21598,-11.27289],[38.47258,-11.4199],[38.88996,-11.16978],[39.24395,-11.17433],[39.58249,-10.96043],[40.00295,-10.80255],[40.44265,-10.4618],[40.74206,-10.25691],[40.14328,-4.64201],[39.62121,-4.68136],[39.44306,-4.93877],[39.21631,-4.67835],[37.81321,-3.69179],[37.75036,-3.54243],[37.63099,-3.50723],[37.5903,-3.42735],[37.71745,-3.304],[37.67199,-3.06222],[34.0824,-1.02264],[34.03084,-1.05101],[34.02286,-1.00779],[33.93107,-.99298],[30.80408,-.99911]]]]}},{type:"Feature",properties:{iso1A2:"UA",iso1A3:"UKR",iso1N3:"804",wikidata:"Q212",nameEn:"Ukraine",groups:["151","150","UN"],callingCodes:["380"]},geometry:{type:"MultiPolygon",coordinates:[[[[33.57318,46.10317],[33.61467,46.13561],[33.63854,46.14147],[33.61517,46.22615],[33.646,46.23028],[33.74047,46.18555],[33.79715,46.20482],[33.85234,46.19863],[33.91549,46.15938],[34.05272,46.10838],[34.07311,46.11769],[34.12929,46.10494],[34.181,46.06804],[34.25111,46.0532],[34.33912,46.06114],[34.41221,46.00245],[34.44155,45.95995],[34.48729,45.94267],[34.52011,45.95097],[34.55889,45.99347],[34.60861,45.99347],[34.66679,45.97136],[34.75479,45.90705],[34.80153,45.90047],[34.79905,45.81009],[34.96015,45.75634],[35.23066,45.79231],[37.62608,46.82615],[38.12112,46.86078],[38.3384,46.98085],[38.22955,47.12069],[38.23049,47.2324],[38.32112,47.2585],[38.33074,47.30508],[38.22225,47.30788],[38.28954,47.39255],[38.28679,47.53552],[38.35062,47.61631],[38.76379,47.69346],[38.79628,47.81109],[38.87979,47.87719],[39.73935,47.82876],[39.82213,47.96396],[39.77544,48.04206],[39.88256,48.04482],[39.83724,48.06501],[39.94847,48.22811],[40.00752,48.22445],[39.99241,48.31768],[39.97325,48.31399],[39.9693,48.29904],[39.95248,48.29972],[39.91465,48.26743],[39.90041,48.3049],[39.84273,48.30947],[39.84136,48.33321],[39.94847,48.35055],[39.88794,48.44226],[39.86196,48.46633],[39.84548,48.57821],[39.79764,48.58668],[39.67226,48.59368],[39.71765,48.68673],[39.73104,48.7325],[39.79466,48.83739],[39.97182,48.79398],[40.08168,48.87443],[40.03636,48.91957],[39.98967,48.86901],[39.78368,48.91596],[39.74874,48.98675],[39.72649,48.9754],[39.71353,48.98959],[39.6683,48.99454],[39.6836,49.05121],[39.93437,49.05709],[40.01988,49.1761],[40.22176,49.25683],[40.18331,49.34996],[40.14912,49.37681],[40.1141,49.38798],[40.03087,49.45452],[40.03636,49.52321],[40.16683,49.56865],[40.13249,49.61672],[39.84548,49.56064],[39.65047,49.61761],[39.59142,49.73758],[39.44496,49.76067],[39.27968,49.75976],[39.1808,49.88911],[38.9391,49.79524],[38.90477,49.86787],[38.73311,49.90238],[38.68677,50.00904],[38.65688,49.97176],[38.35408,50.00664],[38.32524,50.08866],[38.18517,50.08161],[38.21675,49.98104],[38.02999,49.90592],[38.02999,49.94482],[37.90776,50.04194],[37.79515,50.08425],[37.75807,50.07896],[37.61113,50.21976],[37.62879,50.24481],[37.62486,50.29966],[37.47243,50.36277],[37.48204,50.46079],[37.08468,50.34935],[36.91762,50.34963],[36.69377,50.26982],[36.64571,50.218],[36.56655,50.2413],[36.58371,50.28563],[36.47817,50.31457],[36.30101,50.29088],[36.20763,50.3943],[36.06893,50.45205],[35.8926,50.43829],[35.80388,50.41356],[35.73659,50.35489],[35.61711,50.35707],[35.58003,50.45117],[35.47463,50.49247],[35.39464,50.64751],[35.48116,50.66405],[35.47704,50.77274],[35.41367,50.80227],[35.39307,50.92145],[35.32598,50.94524],[35.40837,51.04119],[35.31774,51.08434],[35.20375,51.04723],[35.12685,51.16191],[35.14058,51.23162],[34.97304,51.2342],[34.82472,51.17483],[34.6874,51.18],[34.6613,51.25053],[34.38802,51.2746],[34.31661,51.23936],[34.23009,51.26429],[34.33446,51.363],[34.22048,51.4187],[34.30562,51.5205],[34.17599,51.63253],[34.07765,51.67065],[34.42922,51.72852],[34.41136,51.82793],[34.09413,52.00835],[34.11199,52.14087],[34.05239,52.20132],[33.78789,52.37204],[33.55718,52.30324],[33.48027,52.31499],[33.51323,52.35779],[33.18913,52.3754],[32.89937,52.2461],[32.85405,52.27888],[32.69475,52.25535],[32.54781,52.32423],[32.3528,52.32842],[32.38988,52.24946],[32.33083,52.23685],[32.34044,52.1434],[32.2777,52.10266],[32.23331,52.08085],[32.08813,52.03319],[31.92159,52.05144],[31.96141,52.08015],[31.85018,52.11305],[31.81722,52.09955],[31.7822,52.11406],[31.38326,52.12991],[31.25142,52.04131],[31.13332,52.1004],[30.95589,52.07775],[30.90897,52.00699],[30.76443,51.89739],[30.68804,51.82806],[30.51946,51.59649],[30.64992,51.35014],[30.56203,51.25655],[30.36153,51.33984],[30.34642,51.42555],[30.17888,51.51025],[29.77376,51.4461],[29.7408,51.53417],[29.54372,51.48372],[29.49773,51.39814],[29.42357,51.4187],[29.32881,51.37843],[29.25191,51.49828],[29.25603,51.57089],[29.20659,51.56918],[29.16402,51.64679],[29.1187,51.65872],[28.99098,51.56833],[28.95528,51.59222],[28.81795,51.55552],[28.76027,51.48802],[28.78224,51.45294],[28.75615,51.41442],[28.73143,51.46236],[28.69161,51.44695],[28.64429,51.5664],[28.47051,51.59734],[28.37592,51.54505],[28.23452,51.66988],[28.10658,51.57857],[27.95827,51.56065],[27.91844,51.61952],[27.85253,51.62293],[27.76052,51.47604],[27.67125,51.50854],[27.71932,51.60672],[27.55727,51.63486],[27.51058,51.5854],[27.47212,51.61184],[27.24828,51.60161],[27.26613,51.65957],[27.20948,51.66713],[27.20602,51.77291],[26.99422,51.76933],[26.9489,51.73788],[26.80043,51.75777],[26.69759,51.82284],[26.46962,51.80501],[26.39367,51.87315],[26.19084,51.86781],[26.00408,51.92967],[25.83217,51.92587],[25.80574,51.94556],[25.73673,51.91973],[25.46163,51.92205],[25.20228,51.97143],[24.98784,51.91273],[24.37123,51.88222],[24.29021,51.80841],[24.3163,51.75063],[24.13075,51.66979],[23.99907,51.58369],[23.8741,51.59734],[23.91118,51.63316],[23.7766,51.66809],[23.60906,51.62122],[23.6736,51.50255],[23.62751,51.50512],[23.69905,51.40871],[23.63858,51.32182],[23.80678,51.18405],[23.90376,51.07697],[23.92217,51.00836],[24.04576,50.90196],[24.14524,50.86128],[24.0952,50.83262],[23.99254,50.83847],[23.95925,50.79271],[24.0595,50.71625],[24.0996,50.60752],[24.07048,50.5071],[24.03668,50.44507],[23.99563,50.41289],[23.79445,50.40481],[23.71382,50.38248],[23.67635,50.33385],[23.28221,50.0957],[22.99329,49.84249],[22.83179,49.69875],[22.80261,49.69098],[22.78304,49.65543],[22.64534,49.53094],[22.69444,49.49378],[22.748,49.32759],[22.72009,49.20288],[22.86336,49.10513],[22.89122,49.00725],[22.56155,49.08865],[22.54338,49.01424],[22.48296,48.99172],[22.42934,48.92857],[22.34151,48.68893],[22.21379,48.6218],[22.16023,48.56548],[22.14689,48.4005],[22.2083,48.42534],[22.38133,48.23726],[22.49806,48.25189],[22.59007,48.15121],[22.58733,48.10813],[22.66835,48.09162],[22.73427,48.12005],[22.81804,48.11363],[22.87847,48.04665],[22.84276,47.98602],[22.89849,47.95851],[22.94301,47.96672],[22.92241,48.02002],[23.0158,47.99338],[23.08858,48.00716],[23.1133,48.08061],[23.15999,48.12188],[23.27397,48.08245],[23.33577,48.0237],[23.4979,47.96858],[23.52803,48.01818],[23.5653,48.00499],[23.63894,48.00293],[23.66262,47.98786],[23.75188,47.99705],[23.80904,47.98142],[23.8602,47.9329],[23.89352,47.94512],[23.94192,47.94868],[23.96337,47.96672],[23.98553,47.96076],[24.00801,47.968],[24.02999,47.95087],[24.06466,47.95317],[24.11281,47.91487],[24.22566,47.90231],[24.34926,47.9244],[24.43578,47.97131],[24.61994,47.95062],[24.70632,47.84428],[24.81893,47.82031],[24.88896,47.7234],[25.11144,47.75203],[25.23778,47.89403],[25.63878,47.94924],[25.77723,47.93919],[26.05901,47.9897],[26.17711,47.99246],[26.33504,48.18418],[26.55202,48.22445],[26.62823,48.25804],[26.6839,48.35828],[26.79239,48.29071],[26.82809,48.31629],[26.71274,48.40388],[26.85556,48.41095],[26.93384,48.36558],[27.03821,48.37653],[27.0231,48.42485],[27.08078,48.43214],[27.13434,48.37288],[27.27855,48.37534],[27.32159,48.4434],[27.37604,48.44398],[27.37741,48.41026],[27.44333,48.41209],[27.46942,48.454],[27.5889,48.49224],[27.59027,48.46311],[27.6658,48.44034],[27.74422,48.45926],[27.79225,48.44244],[27.81902,48.41874],[27.87533,48.4037],[27.88391,48.36699],[27.95883,48.32368],[28.04527,48.32661],[28.09873,48.3124],[28.07504,48.23494],[28.17666,48.25963],[28.19314,48.20749],[28.2856,48.23202],[28.32508,48.23384],[28.35519,48.24957],[28.36996,48.20543],[28.34912,48.1787],[28.30586,48.1597],[28.30609,48.14018],[28.34009,48.13147],[28.38712,48.17567],[28.43701,48.15832],[28.42454,48.12047],[28.48428,48.0737],[28.53921,48.17453],[28.69896,48.13106],[28.85232,48.12506],[28.8414,48.03392],[28.9306,47.96255],[29.1723,47.99013],[29.19839,47.89261],[29.27804,47.88893],[29.20663,47.80367],[29.27255,47.79953],[29.22242,47.73607],[29.22414,47.60012],[29.11743,47.55001],[29.18603,47.43387],[29.3261,47.44664],[29.39889,47.30179],[29.47854,47.30366],[29.48678,47.36043],[29.5733,47.36508],[29.59665,47.25521],[29.54996,47.24962],[29.57696,47.13581],[29.49732,47.12878],[29.53044,47.07851],[29.61038,47.09932],[29.62137,47.05069],[29.57056,46.94766],[29.72986,46.92234],[29.75458,46.8604],[29.87405,46.88199],[29.98814,46.82358],[29.94522,46.80055],[29.9743,46.75325],[29.94409,46.56002],[29.88916,46.54302],[30.02511,46.45132],[30.16794,46.40967],[30.09103,46.38694],[29.94114,46.40114],[29.88329,46.35851],[29.74496,46.45605],[29.66359,46.4215],[29.6763,46.36041],[29.5939,46.35472],[29.49914,46.45889],[29.35357,46.49505],[29.24886,46.37912],[29.23547,46.55435],[29.02409,46.49582],[29.01241,46.46177],[28.9306,46.45699],[29.004,46.31495],[28.98478,46.31803],[28.94953,46.25852],[29.06656,46.19716],[28.94643,46.09176],[29.00613,46.04962],[28.98004,46.00385],[28.74383,45.96664],[28.78503,45.83475],[28.69852,45.81753],[28.70401,45.78019],[28.52823,45.73803],[28.47879,45.66994],[28.51587,45.6613],[28.54196,45.58062],[28.49252,45.56716],[28.51449,45.49982],[28.43072,45.48538],[28.41836,45.51715],[28.30201,45.54744],[28.21139,45.46895],[28.28504,45.43907],[28.34554,45.32102],[28.5735,45.24759],[28.71358,45.22631],[28.78911,45.24179],[28.81383,45.3384],[28.94292,45.28045],[28.96077,45.33164],[29.24779,45.43388],[29.42632,45.44545],[29.59798,45.38857],[29.68175,45.26885],[29.65428,45.25629],[29.69272,45.19227],[30.04414,45.08461],[31.62627,45.50633],[33.54017,46.0123],[33.59087,46.06013],[33.57318,46.10317]]]]}},{type:"Feature",properties:{iso1A2:"UG",iso1A3:"UGA",iso1N3:"800",wikidata:"Q1036",nameEn:"Uganda",groups:["014","202","002","UN"],driveSide:"left",callingCodes:["256"]},geometry:{type:"MultiPolygon",coordinates:[[[[33.93107,-.99298],[33.9264,-.54188],[33.98449,-.13079],[33.90936,.10581],[34.10067,.36372],[34.08727,.44713],[34.11408,.48884],[34.13493,.58118],[34.20196,.62289],[34.27345,.63182],[34.31516,.75693],[34.40041,.80266],[34.43349,.85254],[34.52369,1.10692],[34.57427,1.09868],[34.58029,1.14712],[34.67562,1.21265],[34.80223,1.22754],[34.82606,1.26626],[34.82606,1.30944],[34.7918,1.36752],[34.87819,1.5596],[34.92734,1.56109],[34.9899,1.6668],[34.98692,1.97348],[34.90947,2.42447],[34.95267,2.47209],[34.77244,2.70272],[34.78137,2.76223],[34.73967,2.85447],[34.65774,2.8753],[34.60114,2.93034],[34.56242,3.11478],[34.45815,3.18319],[34.40006,3.37949],[34.41794,3.44342],[34.39112,3.48802],[34.44922,3.51627],[34.45815,3.67385],[34.15429,3.80464],[34.06046,4.15235],[33.9873,4.23316],[33.51264,3.75068],[33.18356,3.77812],[33.02852,3.89296],[32.89746,3.81339],[32.72021,3.77327],[32.41337,3.748],[32.20782,3.6053],[32.19888,3.50867],[32.08866,3.53543],[32.08491,3.56287],[32.05187,3.589],[31.95907,3.57408],[31.96205,3.6499],[31.86821,3.78664],[31.81459,3.82083],[31.72075,3.74354],[31.50776,3.63652],[31.50478,3.67814],[31.29476,3.8015],[31.16666,3.79853],[30.97601,3.693],[30.85153,3.48867],[30.94081,3.50847],[30.93486,3.40737],[30.84251,3.26908],[30.77101,3.04897],[30.8574,2.9508],[30.8857,2.83923],[30.75612,2.5863],[30.74271,2.43601],[30.83059,2.42559],[30.91102,2.33332],[30.96911,2.41071],[31.06593,2.35862],[31.07934,2.30207],[31.12104,2.27676],[31.1985,2.29462],[31.20148,2.2217],[31.28042,2.17853],[31.30127,2.11006],[30.48503,1.21675],[30.24671,1.14974],[30.22139,.99635],[30.1484,.89805],[29.98307,.84295],[29.95477,.64486],[29.97413,.52124],[29.87284,.39166],[29.81922,.16824],[29.77454,.16675],[29.7224,.07291],[29.72687,-.08051],[29.65091,-.46777],[29.67474,-.47969],[29.67176,-.55714],[29.62708,-.71055],[29.63006,-.8997],[29.58388,-.89821],[29.59061,-1.39016],[29.82657,-1.31187],[29.912,-1.48269],[30.16369,-1.34303],[30.35212,-1.06896],[30.47194,-1.0555],[30.64166,-1.06601],[30.70631,-1.01175],[30.76635,-.9852],[30.80408,-.99911],[33.93107,-.99298]]]]}},{type:"Feature",properties:{iso1A2:"UM",iso1A3:"UMI",iso1N3:"581",wikidata:"Q16645",nameEn:"United States Minor Outlying Islands",country:"US"},geometry:null},{type:"Feature",properties:{iso1A2:"UN",wikidata:"Q1065",nameEn:"United Nations",level:"unitedNations",isoStatus:"excRes"},geometry:null},{type:"Feature",properties:{iso1A2:"US",iso1A3:"USA",iso1N3:"840",wikidata:"Q30",nameEn:"United States of America"},geometry:null},{type:"Feature",properties:{iso1A2:"UY",iso1A3:"URY",iso1N3:"858",wikidata:"Q77",nameEn:"Uruguay",groups:["005","419","019","UN"],callingCodes:["598"]},geometry:{type:"MultiPolygon",coordinates:[[[[-57.65132,-30.19229],[-57.61478,-30.25165],[-57.64859,-30.35095],[-57.89115,-30.49572],[-57.8024,-30.77193],[-57.89476,-30.95994],[-57.86729,-31.06352],[-57.9908,-31.34924],[-57.98127,-31.3872],[-58.07569,-31.44916],[-58.0023,-31.53084],[-58.00076,-31.65016],[-58.20252,-31.86966],[-58.10036,-32.25338],[-58.22362,-32.52416],[-58.1224,-32.98842],[-58.40475,-33.11777],[-58.44442,-33.84033],[-58.34425,-34.15035],[-57.83001,-34.69099],[-54.78916,-36.21945],[-52.83257,-34.01481],[-53.37138,-33.74313],[-53.39593,-33.75169],[-53.44031,-33.69344],[-53.52794,-33.68908],[-53.53459,-33.16843],[-53.1111,-32.71147],[-53.37671,-32.57005],[-53.39572,-32.58596],[-53.76024,-32.0751],[-54.17384,-31.86168],[-55.50821,-30.91349],[-55.50841,-30.9027],[-55.51862,-30.89828],[-55.52712,-30.89997],[-55.53276,-30.90218],[-55.53431,-30.89714],[-55.54572,-30.89051],[-55.55218,-30.88193],[-55.55373,-30.8732],[-55.5634,-30.8686],[-55.58866,-30.84117],[-55.87388,-31.05053],[-56.4619,-30.38457],[-56.4795,-30.3899],[-56.49267,-30.39471],[-56.90236,-30.02578],[-57.22502,-30.26121],[-57.65132,-30.19229]]]]}},{type:"Feature",properties:{iso1A2:"UZ",iso1A3:"UZB",iso1N3:"860",wikidata:"Q265",nameEn:"Uzbekistan",groups:["143","142","UN"],callingCodes:["998"]},geometry:{type:"MultiPolygon",coordinates:[[[[65.85194,42.85481],[65.53277,43.31856],[65.18666,43.48835],[64.96464,43.74748],[64.53885,43.56941],[63.34656,43.64003],[62.01711,43.51008],[61.01475,44.41383],[58.59711,45.58671],[55.97842,44.99622],[55.97832,44.99622],[55.97822,44.99617],[55.97811,44.99617],[55.97801,44.99612],[55.97801,44.99607],[55.97791,44.99607],[55.9778,44.99607],[55.9777,44.99601],[55.9777,44.99596],[55.9776,44.99591],[55.97749,44.99591],[55.97739,44.99591],[55.97739,44.99586],[55.97729,44.99586],[55.97718,44.99581],[55.97708,44.99576],[55.97698,44.9957],[55.97698,44.99565],[55.97687,44.9956],[55.97677,44.9956],[55.97677,44.99555],[55.97677,44.9955],[55.97667,44.99545],[55.97656,44.99539],[55.97646,44.99534],[55.97646,44.99529],[55.97636,44.99524],[55.97636,44.99519],[55.97625,44.99514],[55.97615,44.99508],[55.97615,44.99503],[55.97615,44.99498],[55.97615,44.99493],[55.97615,44.99483],[55.97615,44.99477],[55.97605,44.99477],[55.97605,44.99467],[55.97605,44.99462],[55.97605,44.99457],[55.97605,44.99452],[55.97594,44.99446],[55.97584,44.99441],[55.97584,44.99436],[55.97584,44.99431],[55.97584,44.99426],[55.97584,44.99421],[55.97584,44.99415],[55.97584,44.99405],[55.97584,44.994],[55.97584,44.9939],[55.97584,44.99384],[55.97584,44.99374],[55.97584,44.99369],[55.97584,44.99359],[55.97584,44.99353],[55.97584,44.99348],[55.97584,44.99343],[55.97584,44.99338],[55.97584,44.99328],[55.97584,44.99322],[56.00314,41.32584],[57.03423,41.25435],[57.13796,41.36625],[57.03359,41.41777],[56.96218,41.80383],[57.03633,41.92043],[57.30275,42.14076],[57.6296,42.16519],[57.84932,42.18555],[57.92897,42.24047],[57.90975,42.4374],[57.99214,42.50021],[58.3492,42.43335],[58.40688,42.29535],[58.51674,42.30348],[58.29427,42.56497],[58.14321,42.62159],[58.27504,42.69632],[58.57991,42.64988],[58.6266,42.79314],[58.93422,42.5407],[59.17317,42.52248],[59.2955,42.37064],[59.4341,42.29738],[59.94633,42.27655],[60.00539,42.212],[59.96419,42.1428],[60.04659,42.08982],[60.0356,42.01028],[59.95046,41.97966],[60.33223,41.75058],[60.08504,41.80997],[60.06032,41.76287],[60.18117,41.60082],[60.06581,41.4363],[60.5078,41.21694],[61.03261,41.25691],[61.22212,41.14946],[61.33199,41.14946],[61.39732,41.19873],[61.4446,41.29407],[61.87856,41.12257],[62.11751,40.58242],[62.34273,40.43206],[62.43337,39.98528],[63.6913,39.27666],[63.70778,39.22349],[64.19086,38.95561],[64.32576,38.98691],[65.55873,38.29052],[65.83913,38.25733],[66.24013,38.16238],[66.41042,38.02403],[66.56697,38.0435],[66.67684,37.96776],[66.53676,37.80084],[66.52852,37.58568],[66.65761,37.45497],[66.52303,37.39827],[66.55743,37.35409],[66.64699,37.32958],[66.95598,37.40162],[67.08232,37.35469],[67.13039,37.27168],[67.2224,37.24545],[67.2581,37.17216],[67.51868,37.26102],[67.78329,37.1834],[67.8474,37.31594],[67.81566,37.43107],[68.12635,37.93],[68.27159,37.91477],[68.40343,38.19484],[68.13289,38.40822],[68.06274,38.39435],[68.11366,38.47169],[68.05873,38.56087],[68.0807,38.64136],[68.05598,38.71641],[68.12877,38.73677],[68.06948,38.82115],[68.19743,38.85985],[68.09704,39.02589],[67.68915,39.00775],[67.67833,39.14479],[67.33226,39.23739],[67.36522,39.31287],[67.45998,39.315],[67.46822,39.46146],[67.39681,39.52505],[67.46547,39.53564],[67.44899,39.57799],[67.62889,39.60234],[67.70992,39.66156],[68.12053,39.56317],[68.54166,39.53929],[68.61972,39.68905],[68.63071,39.85265],[68.88889,39.87163],[68.93695,39.91167],[68.84906,40.04952],[68.96579,40.06949],[69.01935,40.11466],[69.01523,40.15771],[68.62796,40.07789],[68.52771,40.11676],[68.5332,40.14826],[68.77902,40.20492],[68.79276,40.17555],[68.84357,40.18604],[68.85832,40.20885],[69.04544,40.22904],[69.15659,40.2162],[69.2074,40.21488],[69.30448,40.18774],[69.30104,40.24502],[69.25229,40.26362],[69.24817,40.30357],[69.30808,40.2821],[69.32833,40.29794],[69.33794,40.34819],[69.30774,40.36102],[69.28525,40.41894],[69.27066,40.49274],[69.21063,40.54469],[69.2643,40.57506],[69.3455,40.57988],[69.32834,40.70233],[69.38327,40.7918],[69.53021,40.77621],[69.59441,40.70181],[69.69434,40.62615],[70.36655,40.90296],[70.38028,41.02014],[70.45251,41.04438],[70.80009,40.72825],[70.49871,40.52503],[70.32626,40.45174],[70.37511,40.38605],[70.57149,40.3442],[70.56394,40.26421],[70.62342,40.17396],[70.8607,40.217],[70.9818,40.22392],[70.95789,40.28761],[71.05901,40.28765],[71.13042,40.34106],[71.36663,40.31593],[71.4246,40.28619],[71.51215,40.26943],[71.51549,40.22986],[71.61725,40.20615],[71.61931,40.26775],[71.68386,40.26984],[71.70569,40.20391],[71.69621,40.18492],[71.71719,40.17886],[71.73054,40.14818],[71.82646,40.21872],[71.85002,40.25647],[72.05464,40.27586],[71.96401,40.31907],[72.18648,40.49893],[72.24368,40.46091],[72.40346,40.4007],[72.44191,40.48222],[72.41513,40.50856],[72.38384,40.51535],[72.41714,40.55736],[72.34406,40.60144],[72.40517,40.61917],[72.47795,40.5532],[72.66713,40.5219],[72.66713,40.59076],[72.69579,40.59778],[72.73995,40.58409],[72.74768,40.58051],[72.74862,40.57131],[72.75982,40.57273],[72.74894,40.59592],[72.74866,40.60873],[72.80137,40.67856],[72.84754,40.67229],[72.85372,40.7116],[72.8722,40.71111],[72.93296,40.73089],[72.99133,40.76457],[73.0612,40.76678],[73.13412,40.79122],[73.13267,40.83512],[73.01869,40.84681],[72.94454,40.8094],[72.84291,40.85512],[72.68157,40.84942],[72.59136,40.86947],[72.55109,40.96046],[72.48742,40.97136],[72.45206,41.03018],[72.38511,41.02785],[72.36138,41.04384],[72.34757,41.06104],[72.34026,41.04539],[72.324,41.03381],[72.18339,40.99571],[72.17594,41.02377],[72.21061,41.05607],[72.1792,41.10621],[72.14864,41.13363],[72.17594,41.15522],[72.16433,41.16483],[72.10745,41.15483],[72.07249,41.11739],[71.85964,41.19081],[71.91457,41.2982],[71.83914,41.3546],[71.76625,41.4466],[71.71132,41.43012],[71.73054,41.54713],[71.65914,41.49599],[71.6787,41.42111],[71.57227,41.29175],[71.46688,41.31883],[71.43814,41.19644],[71.46148,41.13958],[71.40198,41.09436],[71.34877,41.16807],[71.27187,41.11015],[71.25813,41.18796],[71.11806,41.15359],[71.02193,41.19494],[70.9615,41.16393],[70.86263,41.23833],[70.77885,41.24813],[70.78572,41.36419],[70.67586,41.47953],[70.48909,41.40335],[70.17682,41.5455],[70.69777,41.92554],[71.28719,42.18033],[71.13263,42.28356],[70.94483,42.26238],[69.49545,41.545],[69.45751,41.56863],[69.39485,41.51518],[69.45081,41.46246],[69.37468,41.46555],[69.35554,41.47211],[69.29778,41.43673],[69.25059,41.46693],[69.23332,41.45847],[69.22671,41.46298],[69.20439,41.45391],[69.18528,41.45175],[69.17701,41.43769],[69.15137,41.43078],[69.05006,41.36183],[69.01308,41.22804],[68.7217,41.05025],[68.73945,40.96989],[68.65662,40.93861],[68.62221,41.03019],[68.49983,40.99669],[68.58444,40.91447],[68.63,40.59358],[68.49983,40.56437],[67.96736,40.83798],[68.1271,41.0324],[68.08273,41.08148],[67.98511,41.02794],[67.9644,41.14611],[66.69129,41.1311],[66.53302,41.87388],[66.00546,41.94455],[66.09482,42.93426],[65.85194,42.85481]],[[70.68112,40.90612],[70.6721,40.90555],[70.57501,40.98941],[70.54223,40.98787],[70.56077,41.00642],[70.6158,40.97661],[70.68112,40.90612]]],[[[71.21139,40.03369],[71.12218,40.03052],[71.06305,40.1771],[71.00236,40.18154],[71.01035,40.05481],[71.11037,40.01984],[71.11668,39.99291],[71.09063,39.99],[71.10501,39.95568],[71.04979,39.89808],[71.10531,39.91354],[71.16101,39.88423],[71.23067,39.93581],[71.1427,39.95026],[71.21139,40.03369]]],[[[71.86463,39.98598],[71.78838,40.01404],[71.71511,39.96348],[71.7504,39.93701],[71.84316,39.95582],[71.86463,39.98598]]]]}},{type:"Feature",properties:{iso1A2:"VA",iso1A3:"VAT",iso1N3:"336",wikidata:"Q237",nameEn:"Vatican City",aliases:["Holy See"],groups:["039","150"],callingCodes:["379","39 06"]},geometry:{type:"MultiPolygon",coordinates:[[[[12.45181,41.90056],[12.45446,41.90028],[12.45435,41.90143],[12.45626,41.90172],[12.45691,41.90125],[12.4577,41.90115],[12.45834,41.90174],[12.45826,41.90281],[12.45755,41.9033],[12.45762,41.9058],[12.45561,41.90629],[12.45543,41.90738],[12.45091,41.90625],[12.44984,41.90545],[12.44815,41.90326],[12.44582,41.90194],[12.44834,41.90095],[12.45181,41.90056]]]]}},{type:"Feature",properties:{iso1A2:"VC",iso1A3:"VCT",iso1N3:"670",wikidata:"Q757",nameEn:"St. Vincent and the Grenadines",aliases:["WV"],groups:["029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",callingCodes:["1 784"]},geometry:{type:"MultiPolygon",coordinates:[[[[-62.64026,12.69984],[-59.94058,12.34011],[-61.69315,14.26451],[-62.64026,12.69984]]]]}},{type:"Feature",properties:{iso1A2:"VE",iso1A3:"VEN",iso1N3:"862",wikidata:"Q717",nameEn:"Venezuela",aliases:["YV"],groups:["005","419","019","UN"],callingCodes:["58"]},geometry:{type:"MultiPolygon",coordinates:[[[[-71.22331,13.01387],[-70.92579,11.96275],[-71.3275,11.85],[-71.9675,11.65536],[-72.24983,11.14138],[-72.4767,11.1117],[-72.88002,10.44309],[-72.98085,9.85253],[-73.36905,9.16636],[-73.02119,9.27584],[-72.94052,9.10663],[-72.77415,9.10165],[-72.65474,8.61428],[-72.4042,8.36513],[-72.36987,8.19976],[-72.35163,8.01163],[-72.39137,8.03534],[-72.47213,7.96106],[-72.48801,7.94329],[-72.48183,7.92909],[-72.47042,7.92306],[-72.45806,7.91141],[-72.46183,7.90682],[-72.44454,7.86031],[-72.46763,7.79518],[-72.47827,7.65604],[-72.45321,7.57232],[-72.47415,7.48928],[-72.43132,7.40034],[-72.19437,7.37034],[-72.04895,7.03837],[-71.82441,7.04314],[-71.44118,7.02116],[-71.42212,7.03854],[-71.37234,7.01588],[-71.03941,6.98163],[-70.7596,7.09799],[-70.10716,6.96516],[-69.41843,6.1072],[-67.60654,6.2891],[-67.4625,6.20625],[-67.43513,5.98835],[-67.58558,5.84537],[-67.63914,5.64963],[-67.59141,5.5369],[-67.83341,5.31104],[-67.85358,4.53249],[-67.62671,3.74303],[-67.50067,3.75812],[-67.30945,3.38393],[-67.85862,2.86727],[-67.85862,2.79173],[-67.65696,2.81691],[-67.21967,2.35778],[-66.85795,1.22998],[-66.28507,.74585],[-65.6727,1.01353],[-65.50158,.92086],[-65.57288,.62856],[-65.11657,1.12046],[-64.38932,1.5125],[-64.34654,1.35569],[-64.08274,1.64792],[-64.06135,1.94722],[-63.39827,2.16098],[-63.39114,2.4317],[-64.0257,2.48156],[-64.02908,2.79797],[-64.48379,3.7879],[-64.84028,4.24665],[-64.72977,4.28931],[-64.57648,4.12576],[-64.14512,4.12932],[-63.99183,3.90172],[-63.86082,3.94796],[-63.70218,3.91417],[-63.67099,4.01731],[-63.50611,3.83592],[-63.42233,3.89995],[-63.4464,3.9693],[-63.21111,3.96219],[-62.98296,3.59935],[-62.7655,3.73099],[-62.74411,4.03331],[-62.57656,4.04754],[-62.44822,4.18621],[-62.13094,4.08309],[-61.54629,4.2822],[-61.48569,4.43149],[-61.29675,4.44216],[-61.31457,4.54167],[-61.15703,4.49839],[-60.98303,4.54167],[-60.86539,4.70512],[-60.5802,4.94312],[-60.73204,5.20931],[-61.4041,5.95304],[-61.15058,6.19558],[-61.20762,6.58174],[-61.13632,6.70922],[-60.54873,6.8631],[-60.39419,6.94847],[-60.28074,7.1162],[-60.44116,7.20817],[-60.54098,7.14804],[-60.63367,7.25061],[-60.59802,7.33194],[-60.71923,7.55817],[-60.64793,7.56877],[-60.51959,7.83373],[-60.38056,7.8302],[-60.02407,8.04557],[-59.97059,8.20791],[-59.83156,8.23261],[-59.80661,8.28906],[-59.85562,8.35213],[-59.98508,8.53046],[-59.54058,8.6862],[-60.89962,9.81445],[-62.08693,10.04435],[-61.62505,11.18974],[-63.73917,11.92623],[-63.19938,16.44103],[-67.89186,12.4116],[-68.01417,11.77722],[-68.33524,11.78151],[-68.99639,11.79035],[-71.22331,13.01387]]]]}},{type:"Feature",properties:{iso1A2:"VG",iso1A3:"VGB",iso1N3:"092",wikidata:"Q25305",nameEn:"British Virgin Islands",country:"GB",groups:["BOTS","029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1 284"]},geometry:{type:"MultiPolygon",coordinates:[[[[-64.47127,17.55688],[-63.88746,19.15706],[-65.02435,18.73231],[-64.86027,18.39056],[-64.64673,18.36549],[-64.47127,17.55688]]]]}},{type:"Feature",properties:{iso1A2:"VI",iso1A3:"VIR",iso1N3:"850",wikidata:"Q11703",nameEn:"United States Virgin Islands",aliases:["US-VI"],country:"US",groups:["Q1352230","029","003","419","019","UN"],driveSide:"left",roadSpeedUnit:"mph",roadHeightUnit:"ft",callingCodes:["1 340"]},geometry:{type:"MultiPolygon",coordinates:[[[[-65.02435,18.73231],[-65.27974,17.56928],[-64.47127,17.55688],[-64.64673,18.36549],[-64.86027,18.39056],[-65.02435,18.73231]]]]}},{type:"Feature",properties:{iso1A2:"VN",iso1A3:"VNM",iso1N3:"704",wikidata:"Q881",nameEn:"Vietnam",groups:["035","142","UN"],callingCodes:["84"]},geometry:{type:"MultiPolygon",coordinates:[[[[108.10003,21.47338],[108.0569,21.53604],[108.02926,21.54997],[107.97932,21.54503],[107.97383,21.53961],[107.97074,21.54072],[107.96774,21.53601],[107.95232,21.5388],[107.92652,21.58906],[107.90006,21.5905],[107.86114,21.65128],[107.80355,21.66141],[107.66967,21.60787],[107.56537,21.61945],[107.54047,21.5934],[107.49065,21.59774],[107.49532,21.62958],[107.47197,21.6672],[107.41593,21.64839],[107.38636,21.59774],[107.35989,21.60063],[107.35834,21.6672],[107.29296,21.74674],[107.24625,21.7077],[107.20734,21.71493],[107.10771,21.79879],[107.02615,21.81981],[107.00964,21.85948],[107.06101,21.88982],[107.05634,21.92303],[106.99252,21.95191],[106.97228,21.92592],[106.92714,21.93459],[106.9178,21.97357],[106.81038,21.97934],[106.74345,22.00965],[106.72551,21.97923],[106.69276,21.96013],[106.68274,21.99811],[106.70142,22.02409],[106.6983,22.15102],[106.67495,22.1885],[106.69986,22.22309],[106.6516,22.33977],[106.55976,22.34841],[106.57221,22.37],[106.55665,22.46498],[106.58395,22.474],[106.61269,22.60301],[106.65316,22.5757],[106.71698,22.58432],[106.72321,22.63606],[106.76293,22.73491],[106.82404,22.7881],[106.83685,22.8098],[106.81271,22.8226],[106.78422,22.81532],[106.71128,22.85982],[106.71387,22.88296],[106.6734,22.89587],[106.6516,22.86862],[106.60179,22.92884],[106.55976,22.92311],[106.51306,22.94891],[106.49749,22.91164],[106.34961,22.86718],[106.27022,22.87722],[106.19705,22.98475],[106.00179,22.99049],[105.99568,22.94178],[105.90119,22.94168],[105.8726,22.92756],[105.72382,23.06641],[105.57594,23.075],[105.56037,23.16806],[105.49966,23.20669],[105.42805,23.30824],[105.40782,23.28107],[105.32376,23.39684],[105.22569,23.27249],[105.17276,23.28679],[105.11672,23.25247],[105.07002,23.26248],[104.98712,23.19176],[104.96532,23.20463],[104.9486,23.17235],[104.91435,23.18666],[104.87992,23.17141],[104.87382,23.12854],[104.79478,23.12934],[104.8334,23.01484],[104.86765,22.95178],[104.84942,22.93631],[104.77114,22.90017],[104.72755,22.81984],[104.65283,22.83419],[104.60457,22.81841],[104.58122,22.85571],[104.47225,22.75813],[104.35593,22.69353],[104.25683,22.76534],[104.27084,22.8457],[104.11384,22.80363],[104.03734,22.72945],[104.01088,22.51823],[103.99247,22.51958],[103.97384,22.50634],[103.96783,22.51173],[103.96352,22.50584],[103.95191,22.5134],[103.94513,22.52553],[103.93286,22.52703],[103.87904,22.56683],[103.64506,22.79979],[103.56255,22.69499],[103.57812,22.65764],[103.52675,22.59155],[103.43646,22.70648],[103.43179,22.75816],[103.32282,22.8127],[103.28079,22.68063],[103.18895,22.64471],[103.15782,22.59873],[103.17961,22.55705],[103.07843,22.50097],[103.0722,22.44775],[102.9321,22.48659],[102.8636,22.60735],[102.60675,22.73376],[102.57095,22.7036],[102.51802,22.77969],[102.46665,22.77108],[102.42618,22.69212],[102.38415,22.67919],[102.41061,22.64184],[102.25339,22.4607],[102.26428,22.41321],[102.16621,22.43336],[102.14099,22.40092],[102.18712,22.30403],[102.51734,22.02676],[102.49092,21.99002],[102.62301,21.91447],[102.67145,21.65894],[102.74189,21.66713],[102.82115,21.73667],[102.81894,21.83888],[102.85637,21.84501],[102.86077,21.71213],[102.97965,21.74076],[102.98846,21.58936],[102.86297,21.4255],[102.94223,21.46034],[102.88939,21.3107],[102.80794,21.25736],[102.89825,21.24707],[102.97745,21.05821],[103.03469,21.05821],[103.12055,20.89994],[103.21497,20.89832],[103.38032,20.79501],[103.45737,20.82382],[103.68633,20.66324],[103.73478,20.6669],[103.82282,20.8732],[103.98024,20.91531],[104.11121,20.96779],[104.27412,20.91433],[104.63957,20.6653],[104.38199,20.47155],[104.40621,20.3849],[104.47886,20.37459],[104.66158,20.47774],[104.72102,20.40554],[104.62195,20.36633],[104.61315,20.24452],[104.86852,20.14121],[104.91695,20.15567],[104.9874,20.09573],[104.8465,19.91783],[104.8355,19.80395],[104.68359,19.72729],[104.64837,19.62365],[104.53169,19.61743],[104.41281,19.70035],[104.23229,19.70242],[104.06498,19.66926],[104.05617,19.61743],[104.10832,19.51575],[104.06058,19.43484],[103.87125,19.31854],[104.5361,18.97747],[104.64617,18.85668],[105.12829,18.70453],[105.19654,18.64196],[105.1327,18.58355],[105.10408,18.43533],[105.15942,18.38691],[105.38366,18.15315],[105.46292,18.22008],[105.64784,17.96687],[105.60381,17.89356],[105.76612,17.67147],[105.85744,17.63221],[106.09019,17.36399],[106.18991,17.28227],[106.24444,17.24714],[106.29287,17.3018],[106.31929,17.20509],[106.43597,17.01362],[106.50862,16.9673],[106.55045,17.0031],[106.54824,16.92729],[106.51963,16.92097],[106.52183,16.87884],[106.55265,16.86831],[106.55485,16.68704],[106.59013,16.62259],[106.58267,16.6012],[106.61477,16.60713],[106.66052,16.56892],[106.65832,16.47816],[106.74418,16.41904],[106.84104,16.55415],[106.88727,16.52671],[106.88067,16.43594],[106.96638,16.34938],[106.97385,16.30204],[107.02597,16.31132],[107.09091,16.3092],[107.15035,16.26271],[107.14595,16.17816],[107.25822,16.13587],[107.33968,16.05549],[107.44975,16.08511],[107.46296,16.01106],[107.39471,15.88829],[107.34188,15.89464],[107.21419,15.83747],[107.21859,15.74638],[107.27143,15.71459],[107.27583,15.62769],[107.34408,15.62345],[107.3815,15.49832],[107.50699,15.48771],[107.53341,15.40496],[107.62367,15.42193],[107.60605,15.37524],[107.62587,15.2266],[107.58844,15.20111],[107.61926,15.13949],[107.61486,15.0566],[107.46516,15.00982],[107.48277,14.93751],[107.59285,14.87795],[107.51579,14.79282],[107.54361,14.69092],[107.55371,14.628],[107.52102,14.59034],[107.52569,14.54665],[107.48521,14.40346],[107.44941,14.41552],[107.39493,14.32655],[107.40427,14.24509],[107.33577,14.11832],[107.37158,14.07906],[107.35757,14.02319],[107.38247,13.99147],[107.44318,13.99751],[107.46498,13.91593],[107.45252,13.78897],[107.53503,13.73908],[107.61909,13.52577],[107.62843,13.3668],[107.49144,13.01215],[107.49611,12.88926],[107.55993,12.7982],[107.5755,12.52177],[107.55059,12.36824],[107.4463,12.29373],[107.42917,12.24657],[107.34511,12.33327],[107.15831,12.27547],[106.99953,12.08983],[106.92325,12.06548],[106.79405,12.0807],[106.70687,11.96956],[106.4111,11.97413],[106.4687,11.86751],[106.44068,11.86294],[106.44535,11.8279],[106.41577,11.76999],[106.45158,11.68616],[106.44691,11.66787],[106.37219,11.69836],[106.30525,11.67549],[106.26478,11.72122],[106.18539,11.75171],[106.13158,11.73283],[106.06708,11.77761],[106.02038,11.77457],[106.00792,11.7197],[105.95188,11.63738],[105.88962,11.67854],[105.8507,11.66635],[105.80867,11.60536],[105.81645,11.56876],[105.87328,11.55953],[105.88962,11.43605],[105.86782,11.28343],[106.10444,11.07879],[106.1527,11.10476],[106.1757,11.07301],[106.20095,10.97795],[106.14301,10.98176],[106.18539,10.79451],[106.06708,10.8098],[105.94535,10.9168],[105.93403,10.83853],[105.84603,10.85873],[105.86376,10.89839],[105.77751,11.03671],[105.50045,10.94586],[105.42884,10.96878],[105.34011,10.86179],[105.11449,10.96332],[105.08326,10.95656],[105.02722,10.89236],[105.09571,10.72722],[104.95094,10.64003],[104.87933,10.52833],[104.59018,10.53073],[104.49869,10.4057],[104.47963,10.43046],[104.43778,10.42386],[103.99198,10.48391],[102.47649,9.66162],[104.81582,8.03101],[109.55486,8.10026],[111.60491,13.57105],[108.00365,17.98159],[108.10003,21.47338]]]]}},{type:"Feature",properties:{iso1A2:"VU",iso1A3:"VUT",iso1N3:"548",wikidata:"Q686",nameEn:"Vanuatu",groups:["054","009","UN"],callingCodes:["678"]},geometry:{type:"MultiPolygon",coordinates:[[[[156.73836,-14.50464],[174.245,-23.1974],[172.71443,-12.01327],[156.73836,-14.50464]]]]}},{type:"Feature",properties:{iso1A2:"WF",iso1A3:"WLF",iso1N3:"876",wikidata:"Q35555",nameEn:"Wallis and Futuna",country:"FR",groups:["EU","Q1451600","061","009","UN"],callingCodes:["681"]},geometry:{type:"MultiPolygon",coordinates:[[[[-178.66551,-14.32452],[-176.76826,-14.95183],[-175.59809,-12.61507],[-178.66551,-14.32452]]]]}},{type:"Feature",properties:{iso1A2:"WS",iso1A3:"WSM",iso1N3:"882",wikidata:"Q683",nameEn:"Samoa",groups:["061","009","UN"],driveSide:"left",callingCodes:["685"]},geometry:{type:"MultiPolygon",coordinates:[[[[-173.74402,-14.26669],[-170.99605,-15.1275],[-171.39864,-10.21587],[-173.74402,-14.26669]]]]}},{type:"Feature",properties:{iso1A2:"XK",iso1A3:"XKX",wikidata:"Q1246",nameEn:"Kosovo",aliases:["KV"],groups:["039","150"],isoStatus:"usrAssn",callingCodes:["383"]},geometry:{type:"MultiPolygon",coordinates:[[[[21.39045,42.74888],[21.44047,42.87276],[21.36941,42.87397],[21.32974,42.90424],[21.2719,42.8994],[21.23534,42.95523],[21.23877,43.00848],[21.2041,43.02277],[21.16734,42.99694],[21.14465,43.11089],[21.08952,43.13471],[21.05378,43.10707],[21.00749,43.13984],[20.96287,43.12416],[20.83727,43.17842],[20.88685,43.21697],[20.82145,43.26769],[20.73811,43.25068],[20.68688,43.21335],[20.59929,43.20492],[20.69515,43.09641],[20.64557,43.00826],[20.59929,43.01067],[20.48692,42.93208],[20.53484,42.8885],[20.43734,42.83157],[20.40594,42.84853],[20.35692,42.8335],[20.27869,42.81945],[20.2539,42.76245],[20.04898,42.77701],[20.02088,42.74789],[20.02915,42.71147],[20.0969,42.65559],[20.07761,42.55582],[20.17127,42.50469],[20.21797,42.41237],[20.24399,42.32168],[20.34479,42.32656],[20.3819,42.3029],[20.48857,42.25444],[20.56955,42.12097],[20.55633,42.08173],[20.59434,42.03879],[20.63069,41.94913],[20.57946,41.91593],[20.59524,41.8818],[20.68523,41.85318],[20.76786,41.91839],[20.75464,42.05229],[21.11491,42.20794],[21.16614,42.19815],[21.22728,42.08909],[21.31983,42.10993],[21.29913,42.13954],[21.30496,42.1418],[21.38428,42.24465],[21.43882,42.23609],[21.43882,42.2789],[21.50823,42.27156],[21.52145,42.24465],[21.58992,42.25915],[21.56772,42.30946],[21.5264,42.33634],[21.53467,42.36809],[21.57021,42.3647],[21.59029,42.38042],[21.62887,42.37664],[21.64209,42.41081],[21.62556,42.45106],[21.7035,42.51899],[21.70522,42.54176],[21.7327,42.55041],[21.75672,42.62695],[21.79413,42.65923],[21.75025,42.70125],[21.6626,42.67813],[21.58755,42.70418],[21.59154,42.72643],[21.47498,42.74695],[21.39045,42.74888]]]]}},{type:"Feature",properties:{iso1A2:"YE",iso1A3:"YEM",iso1N3:"887",wikidata:"Q805",nameEn:"Yemen",groups:["145","142","UN"],callingCodes:["967"]},geometry:{type:"MultiPolygon",coordinates:[[[[57.49095,8.14549],[52.81185,17.28568],[52.74267,17.29519],[52.78009,17.35124],[52.00311,19.00083],[49.04884,18.59899],[48.19996,18.20584],[47.58351,17.50366],[47.48245,17.10808],[47.00571,16.94765],[46.76494,17.29151],[46.31018,17.20464],[44.50126,17.47475],[43.70631,17.35762],[43.43005,17.56148],[43.29185,17.53224],[43.22533,17.38343],[43.32653,17.31179],[43.20156,17.25901],[43.17787,17.14717],[43.23967,17.03428],[43.18233,17.02673],[43.1813,16.98438],[43.19328,16.94703],[43.1398,16.90696],[43.18338,16.84852],[43.22012,16.83932],[43.22956,16.80613],[43.24801,16.80613],[43.26303,16.79479],[43.25857,16.75304],[43.21325,16.74416],[43.22066,16.65179],[43.15274,16.67248],[43.11601,16.53166],[42.97215,16.51093],[42.94351,16.49467],[42.94625,16.39721],[42.76801,16.40371],[42.15205,16.40211],[40.99158,15.81743],[43.29075,12.79154],[43.32909,12.59711],[43.90659,12.3823],[51.12877,12.56479],[57.49095,8.14549]]]]}},{type:"Feature",properties:{iso1A2:"YT",iso1A3:"MYT",iso1N3:"175",wikidata:"Q17063",nameEn:"Mayotte",country:"FR",groups:["Q3320166","EU","014","202","002","UN"],callingCodes:["262"]},geometry:{type:"MultiPolygon",coordinates:[[[[43.28731,-13.97126],[45.54824,-13.22353],[45.4971,-11.75965],[43.28731,-13.97126]]]]}},{type:"Feature",properties:{iso1A2:"ZA",iso1A3:"ZAF",iso1N3:"710",wikidata:"Q258",nameEn:"South Africa",groups:["018","202","002","UN"],driveSide:"left",callingCodes:["27"]},geometry:{type:"MultiPolygon",coordinates:[[[[31.30611,-22.422],[31.16344,-22.32599],[31.08932,-22.34884],[30.86696,-22.28907],[30.6294,-22.32599],[30.48686,-22.31368],[30.38614,-22.34533],[30.28351,-22.35587],[30.2265,-22.2961],[30.13147,-22.30841],[29.92242,-22.19408],[29.76848,-22.14128],[29.64609,-22.12917],[29.37703,-22.19581],[29.21955,-22.17771],[29.18974,-22.18599],[29.15268,-22.21399],[29.10881,-22.21202],[29.0151,-22.22907],[28.91889,-22.44299],[28.63287,-22.55887],[28.34874,-22.5694],[28.04562,-22.8394],[28.04752,-22.90243],[27.93729,-22.96194],[27.93539,-23.04941],[27.74154,-23.2137],[27.6066,-23.21894],[27.52393,-23.37952],[27.33768,-23.40917],[26.99749,-23.65486],[26.84165,-24.24885],[26.51667,-24.47219],[26.46346,-24.60358],[26.39409,-24.63468],[25.8515,-24.75727],[25.84295,-24.78661],[25.88571,-24.87802],[25.72702,-25.25503],[25.69661,-25.29284],[25.6643,-25.4491],[25.58543,-25.6343],[25.33076,-25.76616],[25.12266,-25.75931],[25.01718,-25.72507],[24.8946,-25.80723],[24.67319,-25.81749],[24.44703,-25.73021],[24.36531,-25.773],[24.18287,-25.62916],[23.9244,-25.64286],[23.47588,-25.29971],[23.03497,-25.29971],[22.86012,-25.50572],[22.70808,-25.99186],[22.56365,-26.19668],[22.41921,-26.23078],[22.21206,-26.3773],[22.06192,-26.61882],[21.90703,-26.66808],[21.83291,-26.65959],[21.77114,-26.69015],[21.7854,-26.79199],[21.69322,-26.86152],[21.37869,-26.82083],[21.13353,-26.86661],[20.87031,-26.80047],[20.68596,-26.9039],[20.63275,-26.78181],[20.61754,-26.4692],[20.86081,-26.14892],[20.64795,-25.47827],[20.29826,-24.94869],[20.03678,-24.81004],[20.02809,-24.78725],[19.99817,-24.76768],[19.99882,-28.42622],[18.99885,-28.89165],[17.4579,-28.68718],[17.15405,-28.08573],[16.90446,-28.057],[16.59922,-28.53246],[16.46592,-28.57126],[16.45332,-28.63117],[12.51595,-32.27486],[38.88176,-48.03306],[34.51034,-26.91792],[32.35222,-26.86027],[32.29584,-26.852],[32.22302,-26.84136],[32.19409,-26.84032],[32.13315,-26.84345],[32.09664,-26.80721],[32.00893,-26.8096],[31.97463,-27.11057],[31.97592,-27.31675],[31.49834,-27.31549],[31.15027,-27.20151],[30.96088,-27.0245],[30.97757,-26.92706],[30.88826,-26.79622],[30.81101,-26.84722],[30.78927,-26.48271],[30.95819,-26.26303],[31.13073,-25.91558],[31.31237,-25.7431],[31.4175,-25.71886],[31.86881,-25.99973],[31.974,-25.95387],[31.92649,-25.84216],[32.00631,-25.65044],[31.97875,-25.46356],[32.01676,-25.38117],[32.03196,-25.10785],[31.9835,-24.29983],[31.90368,-24.18892],[31.87707,-23.95293],[31.77445,-23.90082],[31.70223,-23.72695],[31.67942,-23.60858],[31.56539,-23.47268],[31.55779,-23.176],[31.30611,-22.422]],[[29.33204,-29.45598],[29.28545,-29.58456],[29.12553,-29.76266],[29.16548,-29.91706],[28.9338,-30.05072],[28.80222,-30.10579],[28.68627,-30.12885],[28.399,-30.1592],[28.2319,-30.28476],[28.12073,-30.68072],[27.74814,-30.60635],[27.69467,-30.55862],[27.67819,-30.53437],[27.6521,-30.51707],[27.62137,-30.50509],[27.56781,-30.44562],[27.56901,-30.42504],[27.45452,-30.32239],[27.38108,-30.33456],[27.36649,-30.27246],[27.37293,-30.19401],[27.40778,-30.14577],[27.32555,-30.14785],[27.29603,-30.05473],[27.22719,-30.00718],[27.09489,-29.72796],[27.01016,-29.65439],[27.33464,-29.48161],[27.4358,-29.33465],[27.47254,-29.31968],[27.45125,-29.29708],[27.48679,-29.29349],[27.54258,-29.25575],[27.5158,-29.2261],[27.55974,-29.18954],[27.75458,-28.89839],[27.8907,-28.91612],[27.88933,-28.88156],[27.9392,-28.84864],[27.98675,-28.8787],[28.02503,-28.85991],[28.1317,-28.7293],[28.2348,-28.69471],[28.30518,-28.69531],[28.40612,-28.6215],[28.65091,-28.57025],[28.68043,-28.58744],[29.40524,-29.21246],[29.44883,-29.3772],[29.33204,-29.45598]]]]}},{type:"Feature",properties:{iso1A2:"ZM",iso1A3:"ZMB",iso1N3:"894",wikidata:"Q953",nameEn:"Zambia",groups:["014","202","002","UN"],driveSide:"left",callingCodes:["260"]},geometry:{type:"MultiPolygon",coordinates:[[[[32.95389,-9.40138],[32.76233,-9.31963],[32.75611,-9.28583],[32.53661,-9.24281],[32.49147,-9.14754],[32.43543,-9.11988],[32.25486,-9.13371],[32.16146,-9.05993],[32.08206,-9.04609],[31.98866,-9.07069],[31.94196,-9.02303],[31.94663,-8.93846],[31.81587,-8.88618],[31.71158,-8.91386],[31.57147,-8.81388],[31.57147,-8.70619],[31.37533,-8.60769],[31.00796,-8.58615],[30.79243,-8.27382],[28.88917,-8.4831],[28.9711,-8.66935],[28.38526,-9.23393],[28.36562,-9.30091],[28.52636,-9.35379],[28.51627,-9.44726],[28.56208,-9.49122],[28.68532,-9.78],[28.62795,-9.92942],[28.65032,-10.65133],[28.37241,-11.57848],[28.48357,-11.87532],[29.18592,-12.37921],[29.4992,-12.43843],[29.48404,-12.23604],[29.8139,-12.14898],[29.81551,-13.44683],[29.65078,-13.41844],[29.60531,-13.21685],[29.01918,-13.41353],[28.33199,-12.41375],[27.59932,-12.22123],[27.21025,-11.76157],[27.22541,-11.60323],[27.04351,-11.61312],[26.88687,-12.01868],[26.01777,-11.91488],[25.33058,-11.65767],[25.34069,-11.19707],[24.42612,-11.44975],[24.34528,-11.06816],[24.00027,-10.89356],[24.02603,-11.15368],[23.98804,-12.13149],[24.06672,-12.29058],[23.90937,-12.844],[24.03339,-12.99091],[21.97988,-13.00148],[22.00323,-16.18028],[22.17217,-16.50269],[23.20038,-17.47563],[23.47474,-17.62877],[24.23619,-17.47489],[24.32811,-17.49082],[24.38712,-17.46818],[24.5621,-17.52963],[24.70864,-17.49501],[25.00198,-17.58221],[25.26433,-17.79571],[25.51646,-17.86232],[25.6827,-17.81987],[25.85738,-17.91403],[25.85892,-17.97726],[26.08925,-17.98168],[26.0908,-17.93021],[26.21601,-17.88608],[26.55918,-17.99638],[26.68403,-18.07411],[26.74314,-18.0199],[26.89926,-17.98756],[27.14196,-17.81398],[27.30736,-17.60487],[27.61377,-17.34378],[27.62795,-17.24365],[27.83141,-16.96274],[28.73725,-16.5528],[28.76199,-16.51575],[28.81454,-16.48611],[28.8501,-16.04537],[28.9243,-15.93987],[29.01298,-15.93805],[29.21955,-15.76589],[29.4437,-15.68702],[29.8317,-15.6126],[30.35574,-15.6513],[30.41902,-15.62269],[30.22098,-14.99447],[33.24249,-14.00019],[33.16749,-13.93992],[33.07568,-13.98447],[33.02977,-14.05022],[32.99042,-13.95689],[32.88985,-13.82956],[32.79015,-13.80755],[32.76962,-13.77224],[32.84528,-13.71576],[32.7828,-13.64805],[32.68654,-13.64268],[32.66468,-13.60019],[32.68436,-13.55769],[32.73683,-13.57682],[32.84176,-13.52794],[32.86113,-13.47292],[33.0078,-13.19492],[32.98289,-13.12671],[33.02181,-12.88707],[32.96733,-12.88251],[32.94397,-12.76868],[33.05917,-12.59554],[33.18837,-12.61377],[33.28177,-12.54692],[33.37517,-12.54085],[33.54485,-12.35996],[33.47636,-12.32498],[33.3705,-12.34931],[33.25998,-12.14242],[33.33937,-11.91252],[33.32692,-11.59248],[33.24252,-11.59302],[33.23663,-11.40637],[33.29267,-11.43536],[33.29267,-11.3789],[33.39697,-11.15296],[33.25998,-10.88862],[33.28022,-10.84428],[33.47636,-10.78465],[33.70675,-10.56896],[33.54797,-10.36077],[33.53863,-10.20148],[33.31297,-10.05133],[33.37902,-9.9104],[33.36581,-9.81063],[33.31517,-9.82364],[33.2095,-9.61099],[33.12144,-9.58929],[33.10163,-9.66525],[33.05485,-9.61316],[33.00256,-9.63053],[33.00476,-9.5133],[32.95389,-9.40138]]]]}},{type:"Feature",properties:{iso1A2:"ZW",iso1A3:"ZWE",iso1N3:"716",wikidata:"Q954",nameEn:"Zimbabwe",groups:["014","202","002","UN"],driveSide:"left",callingCodes:["263"]},geometry:{type:"MultiPolygon",coordinates:[[[[30.41902,-15.62269],[30.35574,-15.6513],[29.8317,-15.6126],[29.4437,-15.68702],[29.21955,-15.76589],[29.01298,-15.93805],[28.9243,-15.93987],[28.8501,-16.04537],[28.81454,-16.48611],[28.76199,-16.51575],[28.73725,-16.5528],[27.83141,-16.96274],[27.62795,-17.24365],[27.61377,-17.34378],[27.30736,-17.60487],[27.14196,-17.81398],[26.89926,-17.98756],[26.74314,-18.0199],[26.68403,-18.07411],[26.55918,-17.99638],[26.21601,-17.88608],[26.0908,-17.93021],[26.08925,-17.98168],[25.85892,-17.97726],[25.85738,-17.91403],[25.6827,-17.81987],[25.51646,-17.86232],[25.26433,-17.79571],[25.23909,-17.90832],[25.31799,-18.07091],[25.39972,-18.12691],[25.53465,-18.39041],[25.68859,-18.56165],[25.79217,-18.6355],[25.82353,-18.82808],[25.94326,-18.90362],[25.99837,-19.02943],[25.96226,-19.08152],[26.17227,-19.53709],[26.72246,-19.92707],[27.21278,-20.08244],[27.29831,-20.28935],[27.28865,-20.49873],[27.69361,-20.48531],[27.72972,-20.51735],[27.69171,-21.08409],[27.91407,-21.31621],[28.01669,-21.57624],[28.29416,-21.59037],[28.49942,-21.66634],[28.58114,-21.63455],[29.07763,-21.81877],[29.04023,-21.85864],[29.02191,-21.90647],[29.02191,-21.95665],[29.04108,-22.00563],[29.08495,-22.04867],[29.14501,-22.07275],[29.1974,-22.07472],[29.24648,-22.05967],[29.3533,-22.18363],[29.37703,-22.19581],[29.64609,-22.12917],[29.76848,-22.14128],[29.92242,-22.19408],[30.13147,-22.30841],[30.2265,-22.2961],[30.28351,-22.35587],[30.38614,-22.34533],[30.48686,-22.31368],[30.6294,-22.32599],[30.86696,-22.28907],[31.08932,-22.34884],[31.16344,-22.32599],[31.30611,-22.422],[31.38336,-22.36919],[32.41234,-21.31246],[32.48236,-21.32873],[32.37115,-21.133],[32.51644,-20.91929],[32.48122,-20.63319],[32.55167,-20.56312],[32.66174,-20.56106],[32.85987,-20.27841],[32.85987,-20.16686],[32.93032,-20.03868],[33.01178,-20.02007],[33.06461,-19.77787],[32.95013,-19.67219],[32.84666,-19.68462],[32.84446,-19.48343],[32.78282,-19.47513],[32.77966,-19.36098],[32.85107,-19.29238],[32.87088,-19.09279],[32.84006,-19.0262],[32.72118,-19.02204],[32.69917,-18.94293],[32.73439,-18.92628],[32.70137,-18.84712],[32.82465,-18.77419],[32.9017,-18.7992],[32.95013,-18.69079],[32.88629,-18.58023],[32.88629,-18.51344],[33.02278,-18.4696],[33.03159,-18.35054],[32.94133,-17.99705],[33.0492,-17.60298],[32.98536,-17.55891],[32.96554,-17.48964],[33.0426,-17.3468],[33.00517,-17.30477],[32.96554,-17.11971],[32.84113,-16.92259],[32.91051,-16.89446],[32.97655,-16.70689],[32.78943,-16.70267],[32.69917,-16.66893],[32.71017,-16.59932],[32.42838,-16.4727],[32.28529,-16.43892],[32.02772,-16.43892],[31.91324,-16.41569],[31.90223,-16.34388],[31.67988,-16.19595],[31.42451,-16.15154],[31.30563,-16.01193],[31.13171,-15.98019],[30.97761,-16.05848],[30.91597,-15.99924],[30.42568,-15.9962],[30.41902,-15.62269]]]]}}]},WD=XD,gp={},Vr={},qD=/(?=(?!^(and|the|of|el|la|de)$))(\b(and|the|of|el|la|de)\b)|[-_ .,'()&[\]/]/gi;function Zw(t){let e=t||"";return e.charAt(0)==="."?e.toUpperCase():e.replace(qD,"").toUpperCase()}var Zo=["subterritory","territory","subcountryGroup","country","sharedLandform","intermediateRegion","subregion","region","subunion","union","unitedNations","world"];YD(WD);function YD(t){let e=["iso1A2","iso1A3","m49","wikidata","emojiFlag","ccTLD","nameEn"],r=[];t.features.forEach(v=>{v.properties.id=v.properties.iso1A2||v.properties.m49||v.properties.wikidata,s(v),o(v),a(v),l(v),n(v),m(v),y(v),v.geometry&&r.push(v)}),t.features.forEach(v=>{v.properties.groups=v.properties.groups.map(x=>Vr[x].properties.id),g(v)}),t.features.forEach(v=>{u(v),d(v),h(v),p(v),c(v)}),t.features.forEach(v=>{v.properties.groups.sort((x,_)=>Zo.indexOf(Vr[x].properties.level)-Zo.indexOf(Vr[_].properties.level)),v.properties.members&&v.properties.members.sort((x,_)=>{let b=Zo.indexOf(Vr[x].properties.level)-Zo.indexOf(Vr[_].properties.level);return b===0?t.features.indexOf(Vr[x])-t.features.indexOf(Vr[_]):b})}),gp=(0,Kw.default)({type:"FeatureCollection",features:r});function n(v){let x=v.properties;x.groups||(x.groups=[]),v.geometry&&x.country&&x.groups.push(x.country),x.m49!=="001"&&x.groups.push("001")}function s(v){let x=v.properties;!x.m49&&x.iso1N3&&(x.m49=x.iso1N3)}function o(v){let x=v.properties;x.level!=="unitedNations"&&!x.ccTLD&&x.iso1A2&&(x.ccTLD="."+x.iso1A2.toLowerCase())}function a(v){let x=v.properties;!x.isoStatus&&x.iso1A2&&(x.isoStatus="official")}function l(v){let x=v.properties;x.level||(x.country?!x.iso1A2||x.isoStatus==="official"?x.level="territory":x.level="subterritory":x.level="country")}function c(v){let x=v.properties;if(v.geometry||!x.members)return;let _=Zo.indexOf(x.level),b=[];x.members.forEach((w,E)=>{let T=Vr[w].properties.groups.filter(k=>k!==v.properties.id&&_<Zo.indexOf(Vr[k].properties.level));E===0?b=T:b=b.filter(k=>T.indexOf(k)!==-1)}),x.groups=x.groups.concat(b.filter(w=>x.groups.indexOf(w)===-1)),b.forEach(w=>{let E=Vr[w];E.properties.members.indexOf(x.id)===-1&&E.properties.members.push(x.id)})}function u(v){let x=v.properties;if(v.geometry)x.roadSpeedUnit||(x.roadSpeedUnit="km/h");else if(x.members){let _=Array.from(new Set(x.members.map(b=>{let w=Vr[b];if(w.geometry)return w.properties.roadSpeedUnit||"km/h"}).filter(Boolean)));_.length===1&&(x.roadSpeedUnit=_[0])}}function d(v){let x=v.properties;if(v.geometry)x.roadHeightUnit||(x.roadHeightUnit="m");else if(x.members){let _=Array.from(new Set(x.members.map(b=>{let w=Vr[b];if(w.geometry)return w.properties.roadHeightUnit||"m"}).filter(Boolean)));_.length===1&&(x.roadHeightUnit=_[0])}}function h(v){let x=v.properties;if(v.geometry)x.driveSide||(x.driveSide="right");else if(x.members){let _=Array.from(new Set(x.members.map(b=>{let w=Vr[b];if(w.geometry)return w.properties.driveSide||"right"}).filter(Boolean)));_.length===1&&(x.driveSide=_[0])}}function p(v){let x=v.properties;!v.geometry&&x.members&&(x.callingCodes=Array.from(new Set(x.members.reduce((_,b)=>{let w=Vr[b];return w.geometry&&w.properties.callingCodes?_.concat(w.properties.callingCodes):_},[]))))}function m(v){if(!v.properties.iso1A2)return;let x=v.properties.iso1A2.replace(/./g,function(_){return String.fromCodePoint(_.charCodeAt(0)+127397)});v.properties.emojiFlag=x}function g(v){v.properties.groups.forEach(x=>{let _=Vr[x];_.properties.members||(_.properties.members=[]),_.properties.members.push(v.properties.id)})}function y(v){let x=[];e.forEach(_=>{let b=v.properties[_];b&&x.push(b)}),(v.properties.aliases||[]).forEach(_=>{x.push(_)}),x.forEach(_=>{let b=Zw(_);Vr[b]=v})}}function QD(t){return Array.isArray(t)?t:t.coordinates?t.coordinates:t.geometry.coordinates}function Jw(t){let e=QD(t),r=gp(e);return r?Vr[r.id]:null}function KD(t){let e=Jw(t);if(!e)return null;let r=e.properties.country||e.properties.iso1A2;return Vr[r]||null}var eE={level:void 0,maxLevel:void 0,withProp:void 0};function ZD(t,e){let r=e.level||"country",i=e.maxLevel||"world",n=e.withProp,s=Zo.indexOf(r);if(s===-1)return null;let o=Zo.indexOf(i);if(o===-1||o<s)return null;if(r==="country"){let c=KD(t);if(c&&(!n||c.properties[n]))return c}return eF(t).find(c=>{let u=Zo.indexOf(c.properties.level);return(c.properties.level===r||u>s&&u<=o)&&(!n||c.properties[n])?c:!1})||null}function yp(t){let e;return typeof t=="number"?(e=t.toString(),e.length===1?e="00"+e:e.length===2&&(e="0"+e)):e=Zw(t),Vr[e]||null}function JD(t){return gp.bbox(t).map(e=>Vr[e.id])}function tE(t){return typeof t=="object"?Jw(t):yp(t)}function k2(t,e=eE){return typeof t=="object"?ZD(t,e):yp(t)}function Qa(t,e=eE){e.withProp="iso1A2";let r=k2(t,e);return r&&r.properties.iso1A2||null}function eF(t,e){let r;if(Array.isArray(t)&&t.length===4)r=JD(t);else{let n=tE(t);r=n?[n]:[]}if(!r.length)return[];let i;return!e||typeof t=="object"?i=r.slice():i=[],r.forEach(n=>{n.properties.groups.forEach(o=>{let a=Vr[o];i.indexOf(a)===-1&&i.push(a)})}),i}function tF(t,e){let r=yp(t);if(!r)return[];let i=[];return e||i.push(r),(r.properties.members||[]).forEach(s=>{i.push(Vr[s])}),i}function rE(t){let e=tF(t,!1);if(e.length===0)return null;let r=[];return e.forEach(i=>{i.geometry&&i.geometry.type==="MultiPolygon"&&i.geometry.coordinates&&(r=r.concat(i.geometry.coordinates))}),{type:"Feature",properties:e[0].properties,geometry:{type:"MultiPolygon",coordinates:r}}}function iE(t){let e=tE(t);return e&&e.properties.roadSpeedUnit||null}var I2=dt(bp(),1),NE=dt(AE(),1),Ip=dt(Cp(),1),DE=dt(CE(),1),FE=dt(ME(),1),xd=class{constructor(t){this._cache={},this._strict=!0,t&&t.type==="FeatureCollection"&&Array.isArray(t.features)&&t.features.forEach(r=>{r.properties=r.properties||{};let i=r.properties,n=r.id||i.id;if(!(!n||!/^\S+\.geojson$/i.test(n))){if(n=n.toLowerCase(),r.id=n,i.id=n,!i.area){let s=I2.default.geometry(r.geometry)/1e6;i.area=Number(s.toFixed(2))}this._cache[n]=r}});let e=PE(k2("Q2"));e.geometry={type:"Polygon",coordinates:[[[-180,-90],[180,-90],[180,90],[-180,90],[-180,-90]]]},e.id="Q2",e.properties.id="Q2",e.properties.area=I2.default.geometry(e.geometry)/1e6,this._cache.Q2=e}validateLocation(t){if(Array.isArray(t)&&(t.length===2||t.length===3)){let e=t[0],r=t[1],i=t[2];if(Number.isFinite(e)&&e>=-180&&e<=180&&Number.isFinite(r)&&r>=-90&&r<=90&&(t.length===2||Number.isFinite(i)&&i>0)){let n="["+t.toString()+"]";return{type:"point",location:t,id:n}}}else if(typeof t=="string"&&/^\S+\.geojson$/i.test(t)){let e=t.toLowerCase();if(this._cache[e])return{type:"geojson",location:t,id:e}}else if(typeof t=="string"||typeof t=="number"){let e=k2(t);if(e){let r=e.properties.wikidata;return{type:"countrycoder",location:t,id:r}}}if(this._strict)throw new Error(`validateLocation:  Invalid location: "${t}".`);return null}resolveLocation(t){let e=this.validateLocation(t);if(!e)return null;let r=e.id;if(this._cache[r])return Object.assign(e,{feature:this._cache[r]});if(e.type==="point"){let i=t[0],n=t[1],s=t[2]||25,o=10,a=3,l=Math.PI*s*s,c=this._cache[r]=(0,DE.default)({type:"Feature",id:r,properties:{id:r,area:Number(l.toFixed(2))},geometry:(0,NE.default)([i,n],s*1e3,o)},a);return Object.assign(e,{feature:c})}else if(e.type!=="geojson"){if(e.type==="countrycoder"){let i=PE(k2(r)),n=i.properties;if(Array.isArray(n.members)){let s=rE(r);s.geometry.coordinates=vd([s],"UNION").geometry.coordinates,i.geometry=s.geometry}if(!n.area){let s=I2.default.geometry(i.geometry)/1e6;n.area=Number(s.toFixed(2))}return i.id=r,n.id=r,this._cache[r]=i,Object.assign(e,{feature:i})}}if(this._strict)throw new Error(`resolveLocation:  Couldn't resolve location "${t}".`);return null}validateLocationSet(t){t=t||{};let e=this.validateLocation.bind(this),r=(t.include||[]).map(e).filter(Boolean),i=(t.exclude||[]).map(e).filter(Boolean);if(!r.length){if(this._strict)throw new Error("validateLocationSet:  LocationSet includes nothing.");t.include=["Q2"],r=[{type:"countrycoder",location:"Q2",id:"Q2"}]}r.sort(RE);let n="+["+r.map(s=>s.id).join(",")+"]";return i.length&&(i.sort(RE),n+="-["+i.map(s=>s.id).join(",")+"]"),{type:"locationset",locationSet:t,id:n}}resolveLocationSet(t){t=t||{};let e=this.validateLocationSet(t);if(!e)return null;let r=e.id;if(this._cache[r])return Object.assign(e,{feature:this._cache[r]});let i=this.resolveLocation.bind(this),n=(t.include||[]).map(i).filter(Boolean),s=(t.exclude||[]).map(i).filter(Boolean);if(n.length===1&&s.length===0)return Object.assign(e,{feature:n[0].feature});let o=vd(n.map(u=>u.feature),"UNION"),a=vd(s.map(u=>u.feature),"UNION"),l=a?vd([o,a],"DIFFERENCE"):o,c=I2.default.geometry(l.geometry)/1e6;return l.id=r,l.properties={id:r,area:Number(c.toFixed(2))},this._cache[r]=l,Object.assign(e,{feature:l})}strict(t){return t===void 0?this._strict:(this._strict=t,this)}cache(){return this._cache}stringify(t,e){return(0,FE.default)(t,e)}};function vd(t,e){if(!Array.isArray(t)||!t.length)return null;let r={UNION:Ip.default.union,DIFFERENCE:Ip.default.difference}[e],i=t.map(o=>o.geometry.coordinates),n=r.apply(null,i);return{type:"Feature",properties:{},geometry:{type:s(n),coordinates:n}};function s(o){return Array.isArray(o)&&Array.isArray(o[0])&&Array.isArray(o[0][0])&&Array.isArray(o[0][0][0])?"MultiPolygon":"Polygon"}}function PE(t){return JSON.parse(JSON.stringify(t))}function RE(t,e){let r={countrycoder:1,geojson:2,point:3},i=r[t.type],n=r[e.type];return i>n?1:i<n?-1:t.id.localeCompare(e.id)}var Mp=dt(C2(),1),OE=dt(bp(),1),Jo=new xd,M2=class extends xr.default{constructor(){super(),this._wp=null,this._resolved=new Map,this._knownLocationSets=new Map,this._locationIncludedIn=new Map,this._locationExcludedIn=new Map,this._blocks=[{locationSet:{include:["Q7835","ua"]},text:"Editing has been blocked in this region per request of the OSM Ukrainian community.",url:"https://wiki.openstreetmap.org/wiki/Russian%E2%80%93Ukrainian_war"}];let e=this._blocks.map(i=>{this._resolveLocationSet(i);let n=this._resolved.get(i.locationSetID);return Object.assign(n.properties,i),n});this._wpblocks=(0,Mp.default)({type:"FeatureCollection",features:e});let r={locationSet:{include:["Q2"]}};this._resolveLocationSet(r),this._rebuildIndex()}_validateLocationSet(e){if(!e.locationSetID)try{let r=e.locationSet;if(!r)throw new Error("object missing locationSet property");r.include||(r.include=["Q2"]);let i=Jo.validateLocationSet(r).id;if(e.locationSetID=i,this._knownLocationSets.has(i))return;let n=0;(r.include||[]).forEach(s=>{let o=Jo.validateLocation(s).id,a=this._resolved.get(o);a||(a=Jo.resolveLocation(s).feature,this._resolved.set(o,a)),n+=a.properties.area;let l=this._locationIncludedIn.get(o);l||(l=new Set,this._locationIncludedIn.set(o,l)),l.add(i)}),(r.exclude||[]).forEach(s=>{let o=Jo.validateLocation(s).id,a=this._resolved.get(o);a||(a=Jo.resolveLocation(s).feature,this._resolved.set(o,a)),n-=a.properties.area;let l=this._locationExcludedIn.get(o);l||(l=new Set,this._locationExcludedIn.set(o,l)),l.add(i)}),this._knownLocationSets.set(i,n)}catch{e.locationSet={include:["Q2"]},e.locationSetID="+[Q2]"}}_resolveLocationSet(e){if(this._validateLocationSet(e),!this._resolved.has(e.locationSetID))try{let r=Jo.resolveLocationSet(e.locationSet),i=r.id;if(e.locationSetID=i,!r.feature.geometry.coordinates.length||!r.feature.properties.area)throw new Error(`locationSet ${i} resolves to an empty feature.`);let n=JSON.parse(JSON.stringify(r.feature));n.id=i,n.properties.id=i,this._resolved.set(i,n)}catch{e.locationSet={include:["Q2"]},e.locationSetID="+[Q2]"}}_rebuildIndex(){this._wp=(0,Mp.default)({features:[...this._resolved.values()]}),this.emit("locationchange")}mergeCustomGeoJSON(e){!e||e.type!=="FeatureCollection"||!Array.isArray(e.features)||e.features.forEach(r=>{r.properties=r.properties||{};let i=r.properties,n=r.id||i.id;if(!(!n||!/^\S+\.geojson$/i.test(n))){if(n=n.toLowerCase(),r.id=n,i.id=n,!i.area){let s=OE.default.geometry(r.geometry)/1e6;i.area=Number(s.toFixed(2))}Jo._cache[n]=r}})}mergeLocationSets(e){return Array.isArray(e)?(e.forEach(r=>this._validateLocationSet(r)),this._rebuildIndex(),Promise.resolve(e)):Promise.reject("nothing to do")}locationSetID(e){let r;try{r=Jo.validateLocationSet(e).id}catch{r="+[Q2]"}return r}feature(e="+[Q2]"){return this._resolved.get(e)||this._resolved.get("+[Q2]")}locationSetsAt(e){let r={},i=this._wp(e,!0)||[],n=this;return i.forEach(s=>{if(s.id[0]!=="+")return;let o=s.id,a=n._knownLocationSets.get(o);a&&(r[o]=a)}),i.forEach(s=>{if(s.id[0]==="+")return;let o=s.id;(n._locationIncludedIn.get(o)||[]).forEach(l=>{let c=n._knownLocationSets.get(l);c&&(r[l]=c)})}),i.forEach(s=>{if(s.id[0]==="+")return;let o=s.id;(n._locationExcludedIn.get(o)||[]).forEach(l=>{delete r[l]})}),r}blocksAt(e){return this._blocks.length?this._wpblocks(e,!0)||[]:[]}loco(){return Jo}wpblocks(){return this._wpblocks}},wt=new M2;var se=Pp(),S=se.t;function Pp(){let t={},e={},r={},i={},n=[],s="en-US",o=["en-US","en"],a="en",l="ltr",c=!1,u={},d={};t.localeCode=()=>s,t.localeCodes=()=>o,t.languageCode=()=>a,t.textDirection=()=>l,t.usesMetric=()=>c,t.languageNames=()=>u,t.scriptNames=()=>d,t.preferredLocaleCodes=function(g){return typeof g=="string"?n=g.split(/,|;| /gi).filter(Boolean):n=g||[],t};let h;t.ensureLoaded=()=>{if(h)return h;let g=["languages","locales"],y={general:"locales",tagging:"https://cdn.jsdelivr.net/npm/@openstreetmap/id-tagging-schema@6.0/dist/translations"},v=Qe.fileMap();for(let x in y){let _=`locales_index_${x}`;v[_]||(v[_]=y[x]+"/index.min.json"),g.push(_)}return h=Promise.all(g.map(x=>Qe.get(x))).then(x=>{e=x[0],r=x[1];let _=x.slice(2),b=(n||[]).concat(Rr().browserLocales).concat(["en"]);o=p(b),s=o[0];let w=[];return _.forEach((E,A)=>{o.forEach(T=>{let k=Object.keys(y)[A],C=Object.values(y)[A];E[T]&&w.push(t.loadLocale(T,k,C))})}),Promise.all(w)}).then(()=>m()).catch(x=>console.error(x))};function p(g){let y=new Set;return g.forEach(v=>{if(r[v]&&y.add(v),v.includes("-")){let x=v.split("-")[0];r[x]&&y.add(x)}}),Array.from(y)}function m(){if(!s)return;let[g,y]=s.toLowerCase().split("-",2);a=g,c=y!=="us";let v=Fn(window.location.hash);if(v.rtl==="true")l="rtl";else if(v.rtl==="false")l="ltr";else{let _=r[s]||r[a];l=_&&_.rtl?"rtl":"ltr"}let x=s;x.toLowerCase()==="en-us"&&(x="en"),u=i.general[x].languageNames,d=i.general[x].scriptNames}return t.loadLocale=(g,y,v)=>{if(g.toLowerCase()==="en-us"&&(g="en"),i[y]&&i[y][g])return Promise.resolve(g);let x=Qe.fileMap(),_=`locale_${y}_${g}`;return x[_]||(x[_]=`${v}/${g}.min.json`),Qe.get(_).then(b=>(i[y]||(i[y]={}),i[y][g]=b[g],g))},t.pluralRule=function(g,y=s){let v="Intl"in window&&Intl.PluralRules&&new Intl.PluralRules(y);return v?v.select(g):g===1?"one":"other"},t._getString=function(g,y,v){let x=g.trim(),_="general";if(x[0]==="_"){let k=x.split(".");_=k[0].slice(1),x=k.slice(1).join(".")}v=v||s;let b=x.split(".").map(k=>k.replace(/<TX_DOT>/g,".")).reverse(),w=v;w.toLowerCase()==="en-us"&&(w="en");let E=i[_]&&i[_][w];for(;E!==void 0&&b.length;)E=E[b.pop()];if(E!==void 0){if(y){if(typeof E=="object"&&Object.keys(E).length){let k=Object.values(y).find(C=>typeof C=="number");if(k!==void 0){let C=t.pluralRule(k,v);E[C]?E=E[C]:E=Object.values(E)[0]}}if(typeof E=="string")for(let k in y){let C=y[k];typeof C=="number"&&(C.toLocaleString?C=C.toLocaleString(v,{style:"decimal",useGrouping:!0,minimumFractionDigits:0}):C=C.toString());let I=`{${k}}`,P=new RegExp(I,"g");E=E.replace(P,C)}}if(typeof E=="string")return{text:E,locale:v}}let A=o.indexOf(v);if(A>=0&&A<o.length-1){let k=o[A+1];return t._getString(g,y,k)}if(y&&"default"in y)return{text:y.default,locale:null};let T=`Missing ${v} translation: ${g}`;return typeof console<"u"&&console.error(T),{text:T,locale:"en"}},t.hasTextForStringId=function(g){return!!t._getString(g,{default:"nothing found"}).locale},t.t=function(g,y,v){return t._getString(g,y,v).text},t.t.html=function(g,y,v){let x=t._getString(g,y,v);return x.text?t.htmlForLocalizedText(x.text,x.locale):""},t.t.append=function(g,y,v){let x=function(_){let b=t._getString(g,y,v);return _.append("span").attr("class","localized-text").attr("lang",b.locale||"und").text((y?.prefix||"")+b.text+(y?.suffix||""))};return x.stringId=g,x},t.htmlForLocalizedText=function(g,y){return`<span class="localized-text" lang="${y||"unknown"}">${g}</span>`},t.languageName=(g,y)=>{if(u[g])return u[g];if(y&&y.localOnly)return null;let v=e[g];if(v){if(v.nativeName)return t.t("translate.language_and_code",{language:v.nativeName,code:g});if(v.base&&v.script){let x=v.base;if(u[x]){let _=v.script,b=d[_]||_;return t.t("translate.language_and_code",{language:u[x],code:b})}else if(e[x]&&e[x].nativeName)return t.t("translate.language_and_code",{language:e[x].nativeName,code:g})}}return g},t}function Ii(t){let r={},i={};return r.collection=t,r.item=n=>{if(i[n])return i[n];let s=r.collection.find(o=>o.id===n);return s&&(i[n]=s),s},r.index=n=>r.collection.findIndex(s=>s.id===n),r.matchGeometry=n=>Ii(r.collection.filter(s=>s.matchGeometry(n))),r.matchAllGeometry=n=>Ii(r.collection.filter(s=>s&&s.matchAllGeometry(n))),r.matchAnyGeometry=n=>Ii(r.collection.filter(s=>n.some(o=>s.matchGeometry(o)))),r.fallback=n=>{let s=n;return s==="vertex"&&(s="point"),r.item(s)},r.search=(n,s,o)=>{if(!n)return r;n=n.toLowerCase().trim();function a(T){let k=T.indexOf(n);return k===0||T[k-1]===" "}function l(T){return T.indexOf(n)===0}function c(T){return function(C,I){let P=C[T](),N=I[T]();if(n===P)return-1;if(n===N)return 1;let M=I.originalScore-C.originalScore;return M!==0||(M=P.indexOf(n)-N.indexOf(n),M!==0)?M:P.length-N.length}}let u=r.collection;if(Array.isArray(o)){let T=wt.locationSetsAt(o);u=u.filter(k=>!k.locationSetID||T[k.locationSetID])}let d=u.filter(T=>T.searchable!==!1&&T.suggestion!==!0),h=u.filter(T=>T.suggestion===!0),p=d.filter(T=>a(T.searchName())).sort(c("searchName")),m=h.filter(T=>l(T.searchName())).sort(c("searchName")),g=d.filter(T=>a(T.searchNameStripped())).sort(c("searchNameStripped")),y=h.filter(T=>l(T.searchNameStripped())).sort(c("searchNameStripped")),v=d.filter(T=>(T.terms()||[]).some(a)),x=h.filter(T=>(T.terms()||[]).some(a)),_=d.filter(T=>Object.values(T.tags||{}).filter(k=>k!=="*").some(a)),b=d.map(T=>({preset:T,dist:H5(n,T.searchName())})).filter(T=>T.dist+Math.min(n.length-T.preset.searchName().length,0)<3).sort((T,k)=>T.dist-k.dist).map(T=>T.preset),w=h.map(T=>({preset:T,dist:H5(n,T.searchName())})).filter(T=>T.dist+Math.min(n.length-T.preset.searchName().length,0)<1).sort((T,k)=>T.dist-k.dist).map(T=>T.preset),E=d.filter(T=>(T.terms()||[]).some(k=>H5(n,k)+Math.min(n.length-k.length,0)<3)),A=p.concat(m,g,y,v,x,_,b,w,E).slice(0,50-1);return s&&(typeof s=="string"?A.push(r.fallback(s)):s.forEach(T=>A.push(r.fallback(T)))),Ii($e(A))},r}function Rp(t,e,r){let i=Object.assign({},e),n,s;return i.id=t,i.members=Ii((e.members||[]).map(o=>r[o]).filter(Boolean)),i.geometry=i.members.collection.reduce((o,a)=>{for(let l in a.geometry){let c=a.geometry[l];o.indexOf(c)===-1&&o.push(c)}return o},[]),i.matchGeometry=o=>i.geometry.indexOf(o)>=0,i.matchAllGeometry=o=>i.members.collection.some(a=>a.matchAllGeometry(o)),i.matchScore=()=>-1,i.name=()=>S(`_tagging.presets.categories.${t}.name`,{default:t}),i.nameLabel=()=>S.html(`_tagging.presets.categories.${t}.name`,{default:t}),i.terms=()=>[],i.searchName=()=>(n||(n=(i.suggestion?i.originalName:i.name()).toLowerCase()),n),i.searchNameStripped=()=>(s||(s=i.searchName(),s.normalize&&(s=s.normalize("NFD")),s=s.replace(/[\u0300-\u036f]/g,"")),s),i.searchAliases=()=>[],i.searchAliasesStripped=()=>[],i}function Np(t,e,r){r=r||{};let i=Object.assign({},e);return i.id=t,i.safeid=T4(t),i.matchGeometry=n=>!i.geometry||i.geometry.indexOf(n)!==-1,i.matchAllGeometry=n=>!i.geometry||n.every(s=>i.geometry.indexOf(s)!==-1),i.t=(n,s)=>S(`_tagging.presets.fields.${t}.${n}`,s),i.t.html=(n,s)=>S.html(`_tagging.presets.fields.${t}.${n}`,s),i.t.append=(n,s)=>S.append(`_tagging.presets.fields.${t}.${n}`,s),i.hasTextForStringId=n=>se.hasTextForStringId(`_tagging.presets.fields.${t}.${n}`),i.resolveReference=n=>{let s=/^\{(.*)\}$/,o=(e[n]||"").match(s);if(o){let a=r[o[1]];if(a)return a;console.error(`Unable to resolve referenced field: ${o[1]}`)}return i},i.title=()=>i.resolveReference("label").t("label",{default:t}),i.label=()=>i.resolveReference("label").t.html("label",{default:t}),i.originalPlaceholder=i.placeholder||"",i.placeholder=()=>i.resolveReference("placeholder").t("placeholder",{default:i.originalPlaceholder}),i.originalTerms=(i.terms||[]).join(),i.terms=()=>i.resolveReference("label").t("terms",{default:i.originalTerms}).toLowerCase().trim().split(/\s*,+\s*/),i.increment=i.type==="number"?i.increment||1:void 0,i}function Yl(t,e,r,i,n){i=i||{},n=n||{};let s=Object.assign({},e),o=r||!1,a={fields:null,moreFields:null},l,c,u,d,h=/^\{(.*)\}$/;s.id=t,s.safeid=T4(t),s.originalTerms=(s.terms||[]).join(),s.originalName=s.name||"",s.originalAliases=(s.aliases||[]).join(`
`),s.originalScore=s.matchScore||1,s.originalReference=s.reference||{},s.originalFields=s.fields||[],s.originalMoreFields=s.moreFields||[],s.fields=()=>a.fields||(a.fields=g("fields")),s.moreFields=()=>a.moreFields||(a.moreFields=g("moreFields")),s.resetFields=()=>a={fields:null,moreFields:null},s.tags=s.tags||{},s.addTags=s.addTags||s.tags,s.removeTags=s.removeTags||s.addTags,s.geometry=s.geometry||[],s.matchGeometry=y=>s.geometry.indexOf(y)>=0,s.matchAllGeometry=y=>y.every(s.matchGeometry),s.matchScore=y=>{let v=s.tags,x={},_=0;for(let w in v)if(x[w]=!0,y[w]===v[w])_+=s.originalScore;else if(v[w]==="*"&&w in y)_+=s.originalScore/2;else return-1;let b=s.addTags;for(let w in b)!x[w]&&y[w]===b[w]&&(_+=s.originalScore);return _},s.t=(y,v)=>S(`_tagging.presets.presets.${t}.${y}`,v),s.t.html=(y,v)=>S.html(`_tagging.presets.presets.${t}.${y}`,v),s.t.append=(y,v)=>S.append(`_tagging.presets.presets.${t}.${y}`,v),s.name=()=>m("originalName").t("name",{default:s.originalName||t}),s.nameLabel=()=>m("originalName").t.html("name",{default:s.originalName||t}),s.subtitle=()=>{if(s.suggestion){let y=t.split("/");return y.pop(),S("_tagging.presets.presets."+y.join("/")+".name")}return null},s.subtitleLabel=()=>{if(s.suggestion){let y=t.split("/");return y.pop(),S.html("_tagging.presets.presets."+y.join("/")+".name")}return null},s.aliases=()=>m("originalName").t("aliases",{default:s.originalAliases}).trim().split(/\s*[\r\n]+\s*/),s.terms=()=>m("originalName").t("terms",{default:s.originalTerms}).toLowerCase().trim().split(/\s*,+\s*/),s.searchName=()=>(l||(l=(s.suggestion?s.originalName:s.name()).toLowerCase()),l),s.searchNameStripped=()=>(c||(c=p(s.searchName())),c),s.searchAliases=()=>(u||(u=s.aliases().map(y=>y.toLowerCase())),u),s.searchAliasesStripped=()=>(d||(d=s.searchAliases(),d=d.map(p)),d),s.isFallback=()=>{let y=Object.keys(s.tags).length;return y===0||y===1&&s.tags.hasOwnProperty("area")},s.addable=function(y){return arguments.length?(o=y,s):o},s.reference=()=>{let y=s.tags.wikidata||s.tags["flag:wikidata"]||s.tags["brand:wikidata"]||s.tags["network:wikidata"]||s.tags["operator:wikidata"];if(y)return{qid:y};let v=s.originalReference.key||Object.keys(Fi(s.tags,"name"))[0],x=s.originalReference.value||s.tags[v];return x==="*"?{key:v}:{key:v,value:x}},s.unsetTags=(y,v,x,_)=>{let b=x?Fi(s.removeTags,x):s.removeTags;return y=Fi(y,Object.keys(b)),v&&!_&&s.fields().forEach(w=>{w.matchGeometry(v)&&w.key&&w.default===y[w.key]&&delete y[w.key]}),delete y.area,y},s.setTags=(y,v,x)=>{let _=s.addTags;y=Object.assign({},y);for(let b in _)_[b]==="*"?(s.tags[b]||!y[b]||y[b]==="no")&&(y[b]="yes"):y[b]=_[b];if(!_.hasOwnProperty("area")&&(delete y.area,v==="area")){let b=!0;if(s.geometry.indexOf("line")===-1){for(let w in _)if(w in Uo){b=!1;break}}b&&(y.area="yes")}return v&&!x&&s.fields().forEach(b=>{b.matchGeometry(v)&&b.key&&!y[b.key]&&b.default&&(y[b.key]=b.default)}),y};function p(y){return y.normalize&&(y=y.normalize("NFD")),y=y.replace(/[\u0300-\u036f]/g,""),y}function m(y){let v=(s[y]||"").match(h);if(v){let x=n[v[1]];if(x)return x;console.warn(`Unable to resolve referenced preset: ${v[1]}.${y}`)}return s}function g(y){let v=y==="fields"?s.originalFields:s.originalMoreFields,x=[];if(v.forEach(w=>{let E=w.match(h);E!==null?x=x.concat(_(E[1],y)):i[w]?x.push(i[w]):console.warn(`Cannot resolve "${w}" found in ${s.id}.${y}`)}),!x.length){let w=s.id.lastIndexOf("/"),E=w&&s.id.substring(0,w);E&&(x=_(E,y))}return $e(x);function _(w,E){let A=n[w];return A?E==="fields"?A.fields().filter(b):E==="moreFields"?A.moreFields():[]:[]}function b(w){return!(w.key&&s.tags[w.key]!==void 0&&w.type!=="multiCombo"&&w.type!=="semiCombo"&&w.type!=="manyCombo"&&w.type!=="check")}}return s}function ge(t,e){for(var r=1,i=arguments.length,n;++r<i;)t[n=arguments[r]]=hF(t,e,e[n]);return t}function hF(t,e,r){return function(){var i=r.apply(e,arguments);return i===e?t:i}}function nn(){if(this instanceof nn)arguments.length&&this.initialize(arguments);else return new nn().initialize(arguments)}Te.changeset=nn;nn.prototype=Object.create(Te.prototype);Object.assign(nn.prototype,{type:"changeset",extent:function(){return new new le()},geometry:function(){return"changeset"},asJXON:function(){return{osm:{changeset:{tag:Object.keys(this.tags).map(function(t){return{"@k":t,"@v":this.tags[t]}},this),"@version":.6,"@generator":"Rapid"}}}},osmChangeJXON:function(t){var e=this.id;function r(s,o){for(var a={},l=0;l<s.length;l++){var c=Object.keys(s[l])[0];a[c]||(a[c]=[]),a[c].push(s[l][c])}var u={};return o.forEach(function(d){a[d]&&(u[d]=a[d])}),u}function i(s){function o(g){return u.find(function(y){return g.keyAttributes.type==="relation"&&g.keyAttributes.ref===y["@id"]})}function a(g){return!c[g["@id"]]&&!l.find(function(y){return y["@id"]===g["@id"]})}var l=[],c={},u=s.relation;if(!u)return s;for(var d=0;d<u.length;d++){var h=u[d];for(c[h["@id"]]||l.push(h);l.length>0;){var p=l[0],m=p.member.map(o).filter(Boolean).filter(a);m.length===0?(c[p["@id"]]=p,l.shift()):l=m.concat(l)}}return s.relation=Object.values(c),s}function n(s){return s.asJXON(e)}return{osmChange:{"@version":.6,"@generator":"Rapid",create:i(r(t.created.map(n),["node","way","relation"])),modify:r(t.modified.map(n),["node","way","relation"]),delete:Object.assign(r(t.deleted.map(n),["relation","way","node"]),{"@if-unused":!0})}}},asGeoJSON:function(){return{}}});function je(){if(this instanceof je)arguments.length&&this.initialize(arguments);else return new je().initialize(arguments)}Te.node=je;je.prototype=Object.create(Te.prototype);Object.assign(je.prototype,{type:"node",loc:[9999,9999],extent:function(){return new le(this.loc)},geometry:function(t){return t.transient(this,"geometry",function(){return t.isPoi(this)?"point":"vertex"})},move:function(t){return this.update({loc:t})},isDegenerate:function(){return!(Array.isArray(this.loc)&&this.loc.length===2&&this.loc[0]>=-180&&this.loc[0]<=180&&this.loc[1]>=-90&&this.loc[1]<=90)},directions:function(t,e){var r,i;if(this.isHighwayIntersection(t)&&(this.tags.stop||"").toLowerCase()==="all")r="all";else{r=(this.tags.direction||"").toLowerCase();var n=/:direction$/i,s=Object.keys(this.tags);for(i=0;i<s.length;i++)if(n.test(s[i])){r=this.tags[s[i]].toLowerCase();break}}if(r==="")return[];var o={north:0,n:0,northnortheast:22,nne:22,northeast:45,ne:45,eastnortheast:67,ene:67,east:90,e:90,eastsoutheast:112,ese:112,southeast:135,se:135,southsoutheast:157,sse:157,south:180,s:180,southsouthwest:202,ssw:202,southwest:225,sw:225,westsouthwest:247,wsw:247,west:270,w:270,westnorthwest:292,wnw:292,northwest:315,nw:315,northnorthwest:337,nnw:337},a=r.split(";"),l=[];return a.forEach(function(c){if(o[c]!==void 0&&(c=o[c]),c!==""&&!isNaN(+c)){l.push(+c);return}var u=this.tags["traffic_sign:backward"]||c==="backward"||c==="both"||c==="all",d=this.tags["traffic_sign:forward"]||c==="forward"||c==="both"||c==="all";if(!(!d&&!u)){var h={};t.parentWays(this).forEach(function(p){var m=p.nodes;for(i=0;i<m.length;i++)m[i]===this.id&&(d&&i>0&&(h[m[i-1]]=!0),u&&i<m.length-1&&(h[m[i+1]]=!0))},this),Object.keys(h).forEach(function(p){var m=e.project(this.loc),g=e.project(t.entity(p).loc);l.push(vr(m,g)*180/Math.PI+90)},this)}},this),$e(l)},isCrossing:function(){return this.tags.highway==="crossing"||this.tags.railway&&this.tags.railway.indexOf("crossing")!==-1},isEndpoint:function(t){return t.transient(this,"isEndpoint",function(){var e=this.id;return t.parentWays(this).filter(function(r){return!r.isClosed()&&!!r.affix(e)}).length>0})},isConnected:function(t){return t.transient(this,"isConnected",function(){var e=t.parentWays(this);if(e.length>1){for(var r in e)if(e[r].geometry(t)==="line"&&e[r].hasInterestingTags())return!0}else if(e.length===1){var i=e[0],n=i.nodes.slice();return i.isClosed()&&n.pop(),n.indexOf(this.id)!==n.lastIndexOf(this.id)}return!1})},parentIntersectionWays:function(t){return t.transient(this,"parentIntersectionWays",function(){return t.parentWays(this).filter(function(e){return(e.tags.highway||e.tags.waterway||e.tags.railway||e.tags.aeroway)&&e.geometry(t)==="line"})})},isIntersection:function(t){return this.parentIntersectionWays(t).length>1},isHighwayIntersection:function(t){return t.transient(this,"isHighwayIntersection",function(){return t.parentWays(this).filter(function(e){return e.tags.highway&&e.geometry(t)==="line"}).length>1})},isOnAddressLine:function(t){return t.transient(this,"isOnAddressLine",function(){return t.parentWays(this).filter(function(e){return e.tags.hasOwnProperty("addr:interpolation")&&e.geometry(t)==="line"}).length>0})},asJXON:function(t){var e={node:{"@id":this.osmId(),"@lon":this.loc[0],"@lat":this.loc[1],"@version":this.version||0,tag:Object.keys(this.tags).map(function(r){return{keyAttributes:{k:r,v:this.tags[r]}}},this)}};return t&&(e.node["@changeset"]=t),e},asGeoJSON:function(){return{type:"Point",coordinates:this.loc}}});function Jt(){if(this instanceof Jt)arguments.length&&this.initialize(arguments);else return new Jt().initialize(arguments)}Jt.id=function(){return Jt.id.next--};Jt.id.next=-1;Object.assign(Jt.prototype,{type:"note",initialize:function(t){for(var e=0;e<t.length;++e){var r=t[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(r[i]===void 0?delete this[i]:this[i]=r[i])}return this.id||(this.id=Jt.id().toString()),this},extent:function(){return new le(this.loc)},update:function(t){return Jt(this,t)},isNew:function(){return this.id<0},move:function(t){return this.update({loc:t})}});function Cr(){if(this instanceof Cr)arguments.length&&this.initialize(arguments);else return new Cr().initialize(arguments)}Te.relation=Cr;Cr.prototype=Object.create(Te.prototype);Cr.creationOrder=function(t,e){var r=parseInt(Te.id.toOSM(t.id),10),i=parseInt(Te.id.toOSM(e.id),10);return r<0||i<0?r-i:i-r};Object.assign(Cr.prototype,{type:"relation",members:[],copy:function(t,e){if(e[this.id])return e[this.id];var r=Te.prototype.copy.call(this,t,e),i=this.members.map(function(n){return Object.assign({},n,{id:t.entity(n.id).copy(t,e).id})});return r=r.update({members:i}),e[this.id]=r,r},extent:function(t,e){return t.transient(this,"extent",function(){if(e&&e[this.id])return new le;e=e||{},e[this.id]=!0;for(var r=new le,i=0;i<this.members.length;i++){var n=t.hasEntity(this.members[i].id);n&&(r=r.extend(n.extent(t,e)))}return r})},geometry:function(t){return t.transient(this,"geometry",function(){return this.isMultipolygon()?"area":"relation"})},isDegenerate:function(){return this.members.length===0},indexedMembers:function(){for(var t=new Array(this.members.length),e=0;e<this.members.length;e++)t[e]=Object.assign({},this.members[e],{index:e});return t},memberByRole:function(t){for(var e=0;e<this.members.length;e++)if(this.members[e].role===t)return Object.assign({},this.members[e],{index:e})},membersByRole:function(t){for(var e=[],r=0;r<this.members.length;r++)this.members[r].role===t&&e.push(Object.assign({},this.members[r],{index:r}));return e},memberById:function(t){for(var e=0;e<this.members.length;e++)if(this.members[e].id===t)return Object.assign({},this.members[e],{index:e})},memberByIdAndRole:function(t,e){for(var r=0;r<this.members.length;r++)if(this.members[r].id===t&&this.members[r].role===e)return Object.assign({},this.members[r],{index:r})},addMember:function(t,e){var r=this.members.slice();return r.splice(e===void 0?r.length:e,0,t),this.update({members:r})},updateMember:function(t,e){var r=this.members.slice();return r.splice(e,1,Object.assign({},r[e],t)),this.update({members:r})},removeMember:function(t){var e=this.members.slice();return e.splice(t,1),this.update({members:e})},removeMembersWithID:function(t){var e=this.members.filter(function(r){return r.id!==t});return this.update({members:e})},moveMember:function(t,e){var r=this.members.slice();return r.splice(e,0,r.splice(t,1)[0]),this.update({members:r})},replaceMember:function(t,e,r){if(!this.memberById(t.id))return this;for(var i=[],n=0;n<this.members.length;n++){var s=this.members[n];s.id!==t.id?i.push(s):(r||!this.memberByIdAndRole(e.id,s.role))&&i.push({id:e.id,type:e.type,role:s.role})}return this.update({members:i})},asJXON:function(t){var e={relation:{"@id":this.osmId(),"@version":this.version||0,member:this.members.map(function(r){return{keyAttributes:{type:r.type,role:r.role,ref:Te.id.toOSM(r.id)}}},this),tag:Object.keys(this.tags).map(function(r){return{keyAttributes:{k:r,v:this.tags[r]}}},this)}};return t&&(e.relation["@changeset"]=t),e},asGeoJSON:function(t){return t.transient(this,"GeoJSON",function(){return this.isMultipolygon()?{type:"MultiPolygon",coordinates:this.multipolygon(t)}:{type:"FeatureCollection",properties:this.tags,features:this.members.map(function(e){return Object.assign({role:e.role},t.entity(e.id).asGeoJSON(t))})}})},area:function(t){return t.transient(this,"area",function(){return oo(this.asGeoJSON(t))})},isMultipolygon:function(){return this.tags.type==="multipolygon"},isComplete:function(t){for(var e=0;e<this.members.length;e++)if(!t.hasEntity(this.members[e].id))return!1;return!0},hasFromViaTo:function(){return this.members.some(function(t){return t.role==="from"})&&this.members.some(function(t){return t.role==="via"})&&this.members.some(function(t){return t.role==="to"})},isRestriction:function(){return!!(this.tags.type&&this.tags.type.match(/^restriction:?/))},isValidRestriction:function(){if(!this.isRestriction())return!1;var t=this.members.filter(function(i){return i.role==="from"}),e=this.members.filter(function(i){return i.role==="via"}),r=this.members.filter(function(i){return i.role==="to"});return!(t.length!==1&&this.tags.restriction!=="no_entry"||t.some(function(i){return i.type!=="way"})||r.length!==1&&this.tags.restriction!=="no_exit"||r.some(function(i){return i.type!=="way"})||e.length===0||e.length>1&&e.some(function(i){return i.type!=="way"}))},isConnectivity:function(){return!!(this.tags.type&&this.tags.type.match(/^connectivity:?/))},multipolygon:function(t){var e=this.members.filter(function(c){return(c.role||"outer")==="outer"}),r=this.members.filter(function(c){return c.role==="inner"});e=En(e,t),r=En(r,t);var i=function(c){return c.nodes.length>2&&c.nodes[0]!==c.nodes[c.nodes.length-1]&&c.nodes.push(c.nodes[0]),c.nodes.map(function(u){return u.loc})};e=e.map(i),r=r.map(i);var n=e.map(function(c){return[oo({type:"Polygon",coordinates:[c]})>2*Math.PI?c.reverse():c]});function s(c){var u,d;for(u=0;u<e.length;u++)if(d=e[u],jf(d,c))return u;for(u=0;u<e.length;u++)if(d=e[u],Vf(d,c,!1))return u}for(var o=0;o<r.length;o++){var a=r[o];oo({type:"Polygon",coordinates:[a]})<2*Math.PI&&(a=a.reverse());var l=s(r[o]);l!==void 0?n[l].push(r[o]):n.push([r[o]])}return n}});var Rt=class{constructor(e,r,i,n,s){this.loc=e,this.service=r.title,this.itemType=i,this.id=n||`${Rt.id()}`,this.update(s),r&&typeof r.getIcon=="function"&&(this.icon=r.getIcon(i))}update(e){let{loc:r,service:i,itemType:n,id:s}=this;return Object.keys(e).forEach(o=>this[o]=e[o]),this.loc=r,this.service=i,this.itemType=n,this.id=s,this}static id(){return this.nextId--}};Rt.nextId=-1;function ps(t){function e(i,n){if(n.parentWays(i).length||n.parentRelations(i).length)return!1;var s=Ba(i.tags);return s.point?!1:s.vertex?!0:!i.hasInterestingTags()}var r=function(i){var n=i.entity(t);return i.parentRelations(n).forEach(function(s){s=s.removeMembersWithID(t),i=i.replace(s),s.isDegenerate()&&(i=Qr(s.id)(i))}),new Set(n.nodes).forEach(function(s){i=i.replace(n.removeNode(s));var o=i.entity(s);e(o,i)&&(i=i.remove(o))}),i.remove(n)};return r}function po(t){var e=function(r){var i=r.entity(t);return r.parentWays(i).forEach(function(n){n=n.removeNode(t),r=r.replace(n),n.isDegenerate()&&(r=ps(n.id)(r))}),r.parentRelations(i).forEach(function(n){n=n.removeMembersWithID(t),r=r.replace(n),n.isDegenerate()&&(r=Qr(n.id)(r))}),r.remove(i)};return e}function ea(t){var e={way:ps,node:po,relation:Qr},r=function(i){return t.forEach(function(n){i.hasEntity(n)&&(i=e[i.entity(n).type](n)(i))}),i};return r}function Qr(t,e){function r(n,s){return!s.parentWays(n).length&&!s.parentRelations(n).length&&!n.hasInterestingTags()&&!e}var i=function(n){var s=n.entity(t);n.parentRelations(s).forEach(function(a){a=a.removeMembersWithID(t),n=n.replace(a),a.isDegenerate()&&(n=Qr(a.id)(n))});var o=$e(s.members.map(function(a){return a.id}));return o.forEach(function(a){n=n.replace(s.removeMembersWithID(a));var l=n.entity(a);r(l,n)&&(n=ea([a])(n))}),n.remove(s)};return i}function ta(t,e){typeof t=="string"&&(t=[t]);var r,i="longest",n=[];function s(u,d,h){var p=u.entity(d).loc,m=u.entity(h).loc,g=1e-6;return p&&m?Tt(p,m):g}function o(u,d,h){var p=new Array(u.length),m,g,y=0,v;function x(b){return Kc(b,u.length)}for(m=0,g=x(d+1);g!==d;g=x(g+1))m+=s(h,u[g],u[x(g-1)]),p[g]=m;for(m=0,g=x(d-1);g!==d;g=x(g-1))m+=s(h,u[g],u[x(g+1)]),m<p[g]&&(p[g]=m);for(g=0;g<u.length;g++){var _=p[g]/s(h,u[d],u[g]);_>y&&(v=g,y=_)}return v}function a(u,d){for(var h=0,p=0;p<d.length-1;p++)h+=s(u,d[p],d[p+1]);return h}function l(u,d,h,p){var m=Lt({id:p,tags:h.tags}),g=h.nodes.slice(),y,v,x=h.isArea(),_=Zc(h,u);if(h.isClosed()){var b=h.nodes.slice(0,-1),w=b.indexOf(d),E=o(b,w,u);E<w?(y=b.slice(w).concat(b.slice(0,E+1)),v=b.slice(E,w+1)):(y=b.slice(w,E+1),v=b.slice(E).concat(b.slice(0,w+1)))}else{var A=h.nodes.indexOf(d,1);y=h.nodes.slice(0,A+1),v=h.nodes.slice(A)}var T=a(u,y),k=a(u,v);if(i==="longest"&&k>T){h=h.update({nodes:v}),m=m.update({nodes:y});var C=T;T=k,k=C}else h=h.update({nodes:y}),m=m.update({nodes:v});if(h.tags.step_count){var I=parseFloat(h.tags.step_count);if(I&&isFinite(I)&&I>0&&Math.round(I)===I){var P=Object.assign({},h.tags),N=Object.assign({},m.tags),M=T/(T+k),D=Math.round(I*M);P.step_count=D.toString(),N.step_count=(I-D).toString(),h=h.update({tags:P}),m=m.update({tags:N})}}if(u=u.replace(h),u=u.replace(m),u.parentRelations(h).forEach(function(L){var B;if(L.hasFromViaTo()){var O=L.memberByRole("from"),R=L.membersByRole("via"),U=L.memberByRole("to"),G;if(O.id===h.id||U.id===h.id){var $=!1;if(R.length===1&&R[0].type==="node")$=m.contains(R[0].id);else for(G=0;G<R.length;G++)if(R[G].type==="way"){var q=u.hasEntity(R[G].id);if(q&&Ir(m.nodes,q.nodes).length){$=!0;break}}$&&(L=L.replaceMember(h,m),u=u.replace(L))}else for(G=0;G<R.length;G++)if(R[G].type==="way"&&R[G].id===h.id){B={id:m.id,type:"way",role:"via"},u=Ql(L.id,B,R[G].index+1)(u);break}}else{L===_&&(u=u.replace(L.mergeTags(h.tags)),u=u.replace(h.update({tags:{}})),u=u.replace(m.update({tags:{}}))),B={id:m.id,type:"way",role:L.memberById(h.id).role};var ie={originalID:h.id,insertedID:m.id,nodes:g};u=Ql(L.id,B,void 0,ie)(u)}}),!_&&x){var F=Cr({tags:Object.assign({},h.tags,{type:"multipolygon"}),members:[{id:h.id,role:"outer",type:"way"},{id:m.id,role:"outer",type:"way"}]});u=u.replace(F),u=u.replace(h.update({tags:{}})),u=u.replace(m.update({tags:{}}))}return n.push(m.id),u}var c=function(u){n=[];for(var d=0,h=0;h<t.length;h++)for(var p=t[h],m=c.waysForNode(p,u),g=0;g<m.length;g++)u=l(u,p,m[g],e&&e[d]),d+=1;return u};return c.getCreatedWayIDs=function(){return n},c.waysForNode=function(u,d){var h=d.entity(u),p=d.parentWays(h).filter(g);if(!r){var m=p.some(function(y){return y.geometry(d)==="line"});if(m)return p.filter(function(y){return y.geometry(d)==="line"})}return p;function g(y){if(r&&r.indexOf(y.id)===-1)return!1;if(y.isClosed())return!0;for(var v=1;v<y.nodes.length-1;v++)if(y.nodes[v]===u)return!0;return!1}},c.ways=function(u){return $e([].concat.apply([],t.map(function(d){return c.waysForNode(d,u)})))},c.disabled=function(u){for(var d=0;d<t.length;d++){var h=t[d],p=c.waysForNode(h,u);if(p.length===0||r&&r.length!==p.length)return"not_eligible"}},c.limitWays=function(u){return arguments.length?(r=u,c):r},c.keepHistoryOn=function(u){return arguments.length?(i=u,c):i},c}var Dr=class{constructor(e,r){e instanceof Dr?(this._base=e._base,this._local={entities:new Map(e._local.entities),parentWays:new Map(e._local.parentWays),parentRels:new Map(e._local.parentRels)}):(this._base={entities:new Map,parentWays:new Map,parentRels:new Map},this._local={entities:new Map,parentWays:new Map,parentRels:new Map},this.rebase(e||[],[this])),this._transients=new Map,this._childNodes=new Map,this._frozen=!r}get base(){return this._base}get local(){return this._local}get frozen(){return this._frozen}hasEntity(e){let r=this._base.entities,i=this._local.entities;return i.has(e)?i.get(e):r.get(e)}entity(e){let r=this.hasEntity(e);if(!r)throw new Error(`Entity ${e} not found`);return r}geometry(e){return this.entity(e).geometry(this)}transient(e,r,i){let n=e.id,s=this._transients.get(n);s||(s=new Map,this._transients.set(n,s));let o=s.get(r);return o!==void 0||(o=i.call(e),s.set(r,o)),o}isPoi(e){if(e.type!=="node")return!1;let r=this._base.parentWays;return(this._local.parentWays.get(e.id)??r.get(e.id)??new Set).size===0}isShared(e){if(e.type!=="node")return!1;let r=this._base.parentWays,n=this._local.parentWays.get(e.id)??r.get(e.id)??new Set;if(n.size===0)return!1;if(n.size>1)return!0;let s=[...n][0],o=this.entity(s),a=o.isClosed()?o.nodes.length-1:o.nodes.length;for(let l=0,c=0;l<a;l++)if(e.id===o.nodes[l]&&c++,c>1)return!0;return!1}parentWays(e){let r=this._base.parentWays,n=this._local.parentWays.get(e.id)??r.get(e.id)??new Set;return Array.from(n).map(s=>this.entity(s))}parentRelations(e){let r=this._base.parentRels,n=this._local.parentRels.get(e.id)??r.get(e.id)??new Set;return Array.from(n).map(s=>this.entity(s))}parentMultipolygons(e){return this.parentRelations(e).filter(r=>r.isMultipolygon())}childNodes(e){if(!e.nodes)return[];let r=this._childNodes.get(e.id);if(r)return r;r=new Array(e.nodes.length);for(let i=0;i<e.nodes.length;++i)r[i]=this.entity(e.nodes[i]);return this._childNodes.set(e.id,r),r}rebase(e,r,i){let n=this._base,s=r[r.length-1]._local.entities,o=new Set;for(let a of e)if(!(!a.visible||!i&&n.entities.has(a.id))&&(n.entities.set(a.id,a),this._updateCalculated(void 0,a,n.parentWays,n.parentRels),a.type==="way"))for(let l of a.nodes)s.has(l)&&s.get(l)===void 0&&o.add(l);for(let a of r){let l=a._local.entities;for(let c of o)l.has(c)&&l.get(c)===void 0&&l.delete(c);a._updateRebased()}}_updateRebased(){let e=this._base,r=this._local;for(let[i,n]of r.parentWays){let s=e.parentWays.get(i);if(s)for(let o of s)r.entities.has(o)||n.add(o)}for(let[i,n]of r.parentRels){let s=e.parentRels.get(i);if(s)for(let o of s)r.entities.has(o)||n.add(o)}this._transients=new Map}_updateCalculated(e,r,i,n){let s=this._base,o=this._local;i=i||o.parentWays,n=n||o.parentRels;let a=r??e;if(!a)return;let l,c;if(a.type==="way"){e&&r?(l=si(e.nodes,r.nodes),c=si(r.nodes,e.nodes)):e?(l=e.nodes,c=[]):r&&(l=[],c=r.nodes);for(let u of l){let d=new Set(o.parentWays.get(u)??s.parentWays.get(u)??[]);d.delete(a.id),i.set(u,d)}for(let u of c){let d=new Set(o.parentWays.get(u)??s.parentWays.get(u)??[]);d.add(a.id),i.set(u,d)}}else if(a.type==="relation"){let u=e?e.members.map(h=>h.id):[],d=r?r.members.map(h=>h.id):[];e&&r?(l=si(u,d),c=si(d,u)):e?(l=u,c=[]):r&&(l=[],c=d);for(let h of l){let p=new Set(o.parentRels.get(h)??s.parentRels.get(h)??[]);p.delete(a.id),n.set(h,p)}for(let h of c){let p=new Set(o.parentRels.get(h)??s.parentRels.get(h)??[]);p.add(a.id),n.set(h,p)}}}replace(e){let r=e.id,i=this.hasEntity(r);return i===e?this:this.update(function(){this._updateCalculated(i,e),this._local.entities.set(r,e)})}remove(e){let r=e.id,i=this.hasEntity(r);return i?this.update(function(){this._updateCalculated(i,void 0),this._local.entities.set(r,void 0)}):this}revert(e){let r=this._base.entities.get(e),i=this.hasEntity(e);return i===r?this:this.update(function(){this._updateCalculated(i,r),this._local.entities.delete(e)})}update(...e){let r=this._frozen?new Dr(this,!0):this;for(let i of e)i.call(r,r);return this._frozen&&(r._frozen=!0),r}load(e){let r=this._base,i=this._local;i.entities=new Map;for(let[n,s]of Object.entries(e)){let o=r.entities.get(n);i.entities.set(n,s),this._updateCalculated(o,s)}return this}};function P2(t){if(!(this instanceof P2))return new P2(t);Object.assign(this,t)}function LE(t,e,r){r=r||30;var i=new Dr,n,s,o;function a(G){return t.parentRelations(G).some(function($){return $.isRestriction()})}function l(G){if(G.isArea()||G.isDegenerate())return!1;var $={motorway:!0,motorway_link:!0,trunk:!0,trunk_link:!0,primary:!0,primary_link:!0,secondary:!0,secondary_link:!0,tertiary:!0,tertiary_link:!0,residential:!0,unclassified:!0,living_street:!0,service:!0,road:!0,track:!0};return $[G.tags.highway]}for(var c=t.entity(e),u=[c],d,h=[],p=[],m,g=[],y=[],v,x=[],_,b=[],w,E=[];u.length;){m=u.pop(),d=t.parentWays(m);var A=!1;for(n=0;n<d.length;n++)if(v=d[n],!(!l(v)&&!a(v))){for(g.push(v),A=!0,x=$e(t.childNodes(v)),s=0;s<x.length;s++)if(_=x[s],_!==m&&h.indexOf(_)===-1&&!(Tt(_.loc,c.loc)>r)){var T=!1;for(b=t.parentWays(_),o=0;o<b.length;o++)if(w=b[o],w!==v&&g.indexOf(w)===-1&&l(w)){T=!0;break}T&&u.push(_)}}A&&h.push(m)}h=$e(h),g=$e(g),g.forEach(function(G){t.childNodes(G).forEach(function($){i=i.replace($)}),i=i.replace(G),t.parentRelations(G).forEach(function($){$.isRestriction()&&($.isValidRestriction(t)?i=i.replace($):$.isComplete(t)&&E.push(Qr($.id)))})}),g.forEach(function(G){var $=i.entity(G.id);if($.tags.oneway==="-1"){var q=os($.id,{reverseOneway:!0});E.push(q),i=q(i)}});var k=Te.id.next.way;h.forEach(function(G){var $=ta([G.id]).keepHistoryOn("first");$.disabled(i)||$.ways(i).forEach(function(q){var ie=ta([G.id]).limitWays([q.id]).keepHistoryOn("first");E.push(ie),i=ie(i)})}),Te.id.next.way=k,p=h.map(function(G){return G.id}),h=[],g=[],p.forEach(function(G){var $=i.entity(G),q=i.parentWays($);h.push($),g=g.concat(q)}),h=$e(h),g=$e(g),p=h.map(function(G){return G.id}),y=g.map(function(G){return G.id});function C(G,$){var q=G.isOneWay(),ie=$.indexOf(G.first())!==-1,Q=$.indexOf(G.last())!==-1,re=ie&&Q,ve=ie&&!q||Q,de=ie||Q&&!q;return G.update({__first:ie,__last:Q,__from:ve,__via:re,__to:de,__oneWay:q})}g=[],y.forEach(function(G){var $=C(i.entity(G),p);i=i.replace($),g.push($)});var I,P=[],N=[];do for(I=!1,u=p.slice(),n=0;n<u.length;n++){var M=u[n];if(m=i.hasEntity(M),!m){p.indexOf(M)!==-1&&p.splice(p.indexOf(M),1),N.push(M);continue}if(b=i.parentWays(m),b.length<3&&p.indexOf(M)!==-1&&p.splice(p.indexOf(M),1),b.length===2){var D=b[0],F=b[1],L=D&&!D.__via,B=F&&!F.__via,O,R;L&&!B?(O=D,R=F):!L&&B&&(O=F,R=D),O&&R&&(R=C(R,p),i=i.replace(R).remove(O),P.push(O.id),I=!0)}b=i.parentWays(m),b.length<2&&(p.indexOf(M)!==-1&&p.splice(p.indexOf(M),1),N.push(M),I=!0),b.length<1&&(i=i.remove(m))}while(I);h=h.filter(function(G){return N.indexOf(G.id)===-1}).map(function(G){return i.entity(G.id)}),g=g.filter(function(G){return P.indexOf(G.id)===-1}).map(function(G){return i.entity(G.id)});var U={graph:i,actions:E,vertices:h,ways:g};return U.turns=function(G,$){if(!G)return[];$||($=0);var q=U.graph,ie=U.vertices.map(function(ne){return ne.id}),Q=q.entity(G);if(!Q||!(Q.__from||Q.__via))return[];var re=$*2+3,ve=[];return de(Q),ve;function de(ne,Ie,at,Et){if(Ie=(Ie||[]).slice(),!(Ie.length>=re)){Ie.push(ne.id),at=(at||[]).slice();var $t,Pt;if(ne.type==="node"){var J=q.parentWays(ne),V=[];for($t=0;$t<J.length;$t++){var z=J[$t];if(!(z.__oneWay&&z.nodes[0]!==ne.id)&&!(Ie.indexOf(z.id)!==-1&&Ie.length>=3)){var X=null;for(Pt=0;Pt<at.length;Pt++){var W=at[Pt],Y=W.memberByRole("from"),te=W.membersByRole("via"),ce=W.memberByRole("to"),ye=/^only_/.test(W.tags.restriction),Fe=Y.id===G,He=!1,ae=!1;if(ce.id===z.id)if(te.length===1&&te[0].type==="node")He=te[0].id===ne.id&&(Fe&&Ie.length===2||!Fe&&Ie.length>2);else{var pe=[];for(o=2;o<Ie.length;o+=2)pe.push(Ie[o]);var Ee=[];for(o=0;o<te.length;o++)te[o].type==="way"&&Ee.push(te[o].id);var Me=si(pe,Ee);He=!Me.length}else if(ye){for(o=0;o<te.length;o++)if(te[o].type==="way"&&te[o].id===z.id){ae=!0;break}}if(He?ye?X={id:W.id,direct:Fe,from:Y.id,only:!0,end:!0}:X={id:W.id,direct:Fe,from:Y.id,no:!0,end:!0}:ae?X={id:W.id,direct:!1,from:Y.id,only:!0,end:!1}:ye&&(X={id:W.id,direct:!1,from:Y.id,no:!0,end:!0}),X&&X.direct)break}V.push({way:z,restrict:X})}}V.forEach(function(xi){de(xi.way,Ie,at,xi.restrict)})}else{if(Ie.length>=3){var Pe=Ie.slice();if(Et&&Et.direct===!1){for($t=0;$t<Pe.length;$t++)if(Pe[$t]===Et.from){Pe=Pe.slice($t);break}}var Ze=we(Pe);if(Ze&&(Et&&(Ze.restrictionID=Et.id,Ze.no=Et.no,Ze.only=Et.only,Ze.direct=Et.direct),ve.push(P2(Ze))),Ie[0]===Ie[2])return}if(Et&&Et.end)return;var Zt=q.entity(ne.first()),Ut=q.entity(ne.last()),kr=Tt(Zt.loc,Ut.loc),ii=[];if(Ie.length>1&&(kr>r||!ne.__via))return;!ne.__oneWay&&ie.indexOf(Zt.id)!==-1&&Ie.indexOf(Zt.id)===-1&&ii.push(Zt),ie.indexOf(Ut.id)!==-1&&Ie.indexOf(Ut.id)===-1&&ii.push(Ut),ii.forEach(function(xi){var Fl=q.parentRelations(ne).filter(function(ns){if(!ns.isRestriction())return!1;var so=ns.memberByRole("from");if(!so||so.id!==ne.id)return!1;var Dn=/^only_/.test(ns.tags.restriction);if(!Dn)return!0;var Bo=!1,mn=ns.membersByRole("via");if(mn.length===1&&mn[0].type==="node")Bo=mn[0].id===xi.id;else for(var Da=0;Da<mn.length;Da++)if(mn[Da].type==="way"){var Fa=q.entity(mn[Da].id);if(Fa.first()===xi.id||Fa.last()===xi.id){Bo=!0;break}}return Bo});de(xi,Ie,at.concat(Fl),!1)})}}}function we(ne){if(ne.length<3)return;var Ie,at,Et,$t,Pt,J,V,z,X;if(Ie=ne[0],$t=ne[ne.length-1],ne.length===3&&Ie===$t){var W=q.entity(Ie);if(W.__oneWay)return null;X=!0,z=Et=J=ne[1],at=Pt=Y(Ie,z)}else X=!1,Et=ne[1],at=Y(Ie,Et),J=ne[ne.length-2],Pt=Y($t,J),ne.length===3?z=ne[1]:(V=ne.filter(function(te){return te[0]==="w"}),V=V.slice(1,V.length-1));return{key:ne.join("_"),path:ne,from:{node:at,way:Ie,vertex:Et},via:{node:z,ways:V},to:{node:Pt,way:$t,vertex:J},u:X};function Y(te,ce){var ye=q.entity(te).nodes;return ce===ye[0]?ye[1]:ye[ye.length-2]}}},U}function BE(t,e,r){for(var i=t.entity(e.from.way),n=t.entity(e.from.node),s=t.entity(e.from.vertex),o=t.entity(e.to.way),a=t.entity(e.to.node),l=t.entity(e.to.vertex),c=i.tags.oneway==="yes",u=o.tags.oneway==="yes",d=(vr(r.project(s.loc),r.project(n.loc))-vr(r.project(l.loc),r.project(a.loc)))*(180/Math.PI);d<0;)d+=360;return n===a||(d<23||d>336)&&c&&u||(d<40||d>319)&&c&&u&&e.from.vertex!==e.to.vertex?"no_u_turn":d<158?"no_right_turn":d>202?"no_left_turn":"no_straight_on"}function Z(t,e,r){return function(n){n.selectAll("svg.icon").data([t]).enter().append("svg").attr("class","icon "+(e||"")).append("use").attr("xlink:href",t).attr("class",r)}}function Kl(t,e){var r=fe("change"),i=t.options,n=[],s=[],o,a=H(null),l=H(null),c=H(null),u=H(null),d,h=[],p;if(i)for(var m in i){var g=i[m];n.push(g==="undefined"?void 0:g),s.push(t.t.html("options."+g,{default:g}))}else n=[void 0,"yes"],s=[S.html("inspector.unknown"),S.html("inspector.check.yes")],t.type!=="defaultCheck"&&(n.push("no"),s.push(S.html("inspector.check.no")));function y(){if(d=t.id==="oneway_yes",t.id==="oneway"){var b=e.entity(h[0]);for(var w in b.tags)if(w in Ms&&b.tags[w]in Ms[w]){d=!0,s[0]=S.html("_tagging.presets.fields.oneway_yes.options.undefined");break}}}function v(){return e.container().select("div.inspector-hover").empty()?!(p==="yes"||d&&!p):!0}function x(b){var w=h.length&&e.hasEntity(h[0]);if(v()||!w)return b;var E=w.first(),A=w.isClosed()?w.nodes[w.nodes.length-2]:w.last(),T=E<A,k=T?"#rapid-icon-forward":"#rapid-icon-backward";return b.selectAll(".reverser-span").html(S.html("inspector.check.reverser")).call(Z(k,"inline")),b}var _=function(b){y(),c=b.selectAll(".form-field-input-wrap").data([0]);var w=c.enter().append("label").attr("class","form-field-input-wrap form-field-input-check");w.append("input").property("indeterminate",t.type!=="defaultCheck").attr("type","checkbox").attr("id",t.domId),w.append("span").html(s[0]).attr("class","value"),t.type==="onewayCheck"&&w.append("button").attr("class","reverser"+(v()?" hide":"")).append("span").attr("class","reverser-span"),c=c.merge(w),a=c.selectAll("input"),l=c.selectAll("span.value"),a.on("click",function(E){E.stopPropagation();var A={};Array.isArray(o[t.key])?n.indexOf("yes")!==-1?A[t.key]="yes":A[t.key]=n[0]:A[t.key]=n[(n.indexOf(p)+1)%n.length],(A[t.key]==="reversible"||A[t.key]==="alternating")&&(A[t.key]=n[0]),r.call("change",this,A)}),t.type==="onewayCheck"&&(u=c.selectAll(".reverser"),u.call(x).on("click",function(E){E.preventDefault(),E.stopPropagation(),e.perform(function(A){for(var T in h)A=os(h[T])(A);return A},S("operations.reverse.annotation.line",{n:1})),e.validator().validate(),H(this).call(x)}))};return _.entityIDs=function(b){return arguments.length?(h=b,_):h},_.tags=function(b){o=b;function w(T){return T!=="no"&&T!==""&&T!==void 0&&T!==null}function E(T){T===""&&(T=void 0);var k=n.indexOf(T);return k!==-1?s[k]:'"'+T+'"'}y();var A=Array.isArray(b[t.key]);p=!A&&b[t.key]&&b[t.key].toLowerCase(),t.type==="onewayCheck"&&(p==="1"||p==="-1")&&(p="yes"),a.property("indeterminate",A||t.type!=="defaultCheck"&&!p).property("checked",w(p)),l.html(A?S.html("inspector.multiple_values"):E(p)).classed("mixed",A),c.classed("set",!!p),t.type==="onewayCheck"&&u.classed("hide",v()).call(x)},_.focus=function(){a.node().focus()},ge(_,r,"on")}function pF(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function R2(t,e){return fetch(t,e).then(pF)}function mF(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function It(t,e){return fetch(t,e).then(mF)}function Dp(t){return(e,r)=>R2(e,r).then(i=>new DOMParser().parseFromString(i,t))}var e0=Dp("application/xml"),gF=Dp("text/html"),Fp=Dp("image/svg+xml");function yF(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Zl=yF;var vF=typeof global=="object"&&global&&global.Object===Object&&global,GE=vF;var xF=typeof self=="object"&&self&&self.Object===Object&&self,_F=GE||xF||Function("return this")(),_d=_F;var bF=function(){return _d.Date.now()},bd=bF;var wF=/\s/;function EF(t){for(var e=t.length;e--&&wF.test(t.charAt(e)););return e}var zE=EF;var SF=/^\s+/;function TF(t){return t&&t.slice(0,zE(t)+1).replace(SF,"")}var HE=TF;var AF=_d.Symbol,t0=AF;var $E=Object.prototype,CF=$E.hasOwnProperty,kF=$E.toString,N2=t0?t0.toStringTag:void 0;function IF(t){var e=CF.call(t,N2),r=t[N2];try{t[N2]=void 0;var i=!0}catch{}var n=kF.call(t);return i&&(e?t[N2]=r:delete t[N2]),n}var jE=IF;var MF=Object.prototype,PF=MF.toString;function RF(t){return PF.call(t)}var VE=RF;var NF="[object Null]",DF="[object Undefined]",XE=t0?t0.toStringTag:void 0;function FF(t){return t==null?t===void 0?DF:NF:XE&&XE in Object(t)?jE(t):VE(t)}var WE=FF;function OF(t){return t!=null&&typeof t=="object"}var qE=OF;var LF="[object Symbol]";function BF(t){return typeof t=="symbol"||qE(t)&&WE(t)==LF}var YE=BF;var QE=0/0,UF=/^[-+]0x[0-9a-f]+$/i,GF=/^0b[01]+$/i,zF=/^0o[0-7]+$/i,HF=parseInt;function $F(t){if(typeof t=="number")return t;if(YE(t))return QE;if(Zl(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Zl(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=HE(t);var r=GF.test(t);return r||zF.test(t)?HF(t.slice(2),r?2:8):UF.test(t)?QE:+t}var Op=$F;var jF="Expected a function",VF=Math.max,XF=Math.min;function WF(t,e,r){var i,n,s,o,a,l,c=0,u=!1,d=!1,h=!0;if(typeof t!="function")throw new TypeError(jF);e=Op(e)||0,Zl(r)&&(u=!!r.leading,d="maxWait"in r,s=d?VF(Op(r.maxWait)||0,e):s,h="trailing"in r?!!r.trailing:h);function p(E){var A=i,T=n;return i=n=void 0,c=E,o=t.apply(T,A),o}function m(E){return c=E,a=setTimeout(v,e),u?p(E):o}function g(E){var A=E-l,T=E-c,k=e-A;return d?XF(k,s-T):k}function y(E){var A=E-l,T=E-c;return l===void 0||A>=e||A<0||d&&T>=s}function v(){var E=bd();if(y(E))return x(E);a=setTimeout(v,g(E))}function x(E){return a=void 0,h&&i?p(E):(i=n=void 0,o)}function _(){a!==void 0&&clearTimeout(a),c=0,i=l=n=a=void 0}function b(){return a===void 0?o:x(bd())}function w(){var E=bd(),A=y(E);if(i=arguments,n=this,l=E,A){if(a===void 0)return m(l);if(d)return clearTimeout(a),a=setTimeout(v,e),p(l)}return a===void 0&&(a=setTimeout(v,e)),o}return w.cancel=_,w.flush=b,w}var Gt=WF;function Bi(t,e){return Array.from(t.getElementsByTagName(e))}function Ed(t){return t[0]==="#"?t:`#${t}`}function qF(t,e,r){return Array.from(t.getElementsByTagNameNS(r,e))}function Mi(t){return t?.normalize(),t&&t.textContent||""}function sn(t,e,r){let i=t.getElementsByTagName(e),n=i.length?i[0]:null;return n&&r&&r(n),n}function ms(t,e,r){let i={};if(!t)return i;let n=t.getElementsByTagName(e),s=n.length?n[0]:null;return s&&r?r(s,i):i}function e1(t,e,r){let i=Mi(sn(t,e));return i&&r?r(i)||{}:{}}function KE(t,e,r){let i=parseFloat(Mi(sn(t,e)));if(!isNaN(i))return i&&r?r(i)||{}:{}}function Jl(t,e,r){let i=parseFloat(Mi(sn(t,e)));if(!isNaN(i))return i&&r&&r(i),i}function D2(t,e){let r={};for(let i of e)e1(t,i,n=>{r[i]=n});return r}function Up(t){return t?.nodeType===1}function ZE(t){return ms(t,"line",e=>Object.assign({},e1(e,"color",i=>({stroke:`#${i}`})),KE(e,"opacity",i=>({"stroke-opacity":i})),KE(e,"width",i=>({"stroke-width":i*96/25.4}))))}function JE(t){let e=[];if(t===null)return e;for(let r of Array.from(t.childNodes)){if(!Up(r))continue;let i=YF(r.nodeName);if(i==="gpxtpx:TrackPointExtension")e=e.concat(JE(r));else{let n=Mi(r);e.push([i,QF(n)])}}return e}function YF(t){return["heart","gpxtpx:hr","hr"].includes(t)?"heart":t}function QF(t){let e=parseFloat(t);return isNaN(e)?t:e}function eS(t){let e=[parseFloat(t.getAttribute("lon")||""),parseFloat(t.getAttribute("lat")||"")];if(isNaN(e[0])||isNaN(e[1]))return null;Jl(t,"ele",i=>{e.push(i)});let r=sn(t,"time");return{coordinates:e,time:r?Mi(r):null,extendedValues:JE(sn(t,"extensions"))}}function Gp(t){let e=D2(t,["name","cmt","desc","type","time","keywords"]),r=Array.from(t.getElementsByTagNameNS("http://www.garmin.com/xmlschemas/GpxExtensions/v3","*"));for(let n of r)n.parentNode?.parentNode===t&&(e[n.tagName.replace(":","_")]=Mi(n));let i=Bi(t,"link");return i.length&&(e.links=i.map(n=>Object.assign({href:n.getAttribute("href")},D2(n,["text","type"])))),e}function tS(t,e){let r=Bi(t,e),i=[],n=[],s={};for(let o=0;o<r.length;o++){let a=eS(r[o]);if(a){i.push(a.coordinates),a.time&&n.push(a.time);for(let[l,c]of a.extendedValues){let u=l==="heart"?l:l.replace("gpxtpx:","")+"s";s[u]||(s[u]=Array(r.length).fill(null)),s[u][o]=c}}}if(!(i.length<2))return{line:i,times:n,extendedValues:s}}function KF(t){let e=tS(t,"rtept");if(e)return{type:"Feature",properties:Object.assign({_gpxType:"rte"},Gp(t),ZE(sn(t,"extensions"))),geometry:{type:"LineString",coordinates:e.line}}}function ZF(t){let e=Bi(t,"trkseg"),r=[],i=[],n=[];for(let a of e){let l=tS(a,"trkpt");l&&(n.push(l),l.times&&l.times.length&&i.push(l.times))}if(n.length===0)return null;let s=n.length>1,o=Object.assign({_gpxType:"trk"},Gp(t),ZE(sn(t,"extensions")),i.length?{coordinateProperties:{times:s?i:i[0]}}:{});for(let a of n){r.push(a.line),o.coordinateProperties||(o.coordinateProperties={});let l=o.coordinateProperties,c=Object.entries(a.extendedValues);for(let u=0;u<c.length;u++){let[d,h]=c[u];s?(l[d]||(l[d]=n.map(p=>new Array(p.line.length).fill(null))),l[d][u]=h):l[d]=h}}return{type:"Feature",properties:o,geometry:s?{type:"MultiLineString",coordinates:r}:{type:"LineString",coordinates:r[0]}}}function JF(t){let e=Object.assign(Gp(t),D2(t,["sym"])),r=eS(t);return r?{type:"Feature",properties:e,geometry:{type:"Point",coordinates:r.coordinates}}:null}function*eO(t){for(let e of Bi(t,"trk")){let r=ZF(e);r&&(yield r)}for(let e of Bi(t,"rte")){let r=KF(e);r&&(yield r)}for(let e of Bi(t,"wpt")){let r=JF(e);r&&(yield r)}}function Td(t){return{type:"FeatureCollection",features:Array.from(eO(t))}}function rS(t,e){let r={},i=e=="stroke"||e==="fill"?e:e+"-color";return t[0]==="#"&&(t=t.substring(1)),t.length===6||t.length===3?r[i]="#"+t:t.length===8&&(r[e+"-opacity"]=parseInt(t.substring(0,2),16)/255,r[i]="#"+t.substring(6,8)+t.substring(4,6)+t.substring(2,4)),r}function Sd(t,e,r){let i={};return Jl(t,e,n=>{i[r]=n}),i}function zp(t,e){return ms(t,"color",r=>rS(Mi(r),e))}function iS(t){return ms(t,"Icon",(e,r)=>(e1(e,"href",i=>{r.icon=i}),r))}function tO(t){return ms(t,"IconStyle",e=>Object.assign(zp(e,"icon"),Sd(e,"scale","icon-scale"),Sd(e,"heading","icon-heading"),ms(e,"hotSpot",r=>{let i=parseFloat(r.getAttribute("x")||""),n=parseFloat(r.getAttribute("y")||""),s=r.getAttribute("xunits")||"",o=r.getAttribute("yunits")||"";return!isNaN(i)&&!isNaN(n)?{"icon-offset":[i,n],"icon-offset-units":[s,o]}:{}}),iS(e)))}function rO(t){return ms(t,"LabelStyle",e=>Object.assign(zp(e,"label"),Sd(e,"scale","label-scale")))}function iO(t){return ms(t,"LineStyle",e=>Object.assign(zp(e,"stroke"),Sd(e,"width","stroke-width")))}function nO(t){return ms(t,"PolyStyle",(e,r)=>Object.assign(r,ms(e,"color",i=>rS(Mi(i),"fill")),e1(e,"fill",i=>{if(i==="0")return{"fill-opacity":0}}),e1(e,"outline",i=>{if(i==="0")return{"stroke-opacity":0}})))}function Hp(t){return Object.assign({},nO(t),iO(t),rO(t),tO(t))}var r0=t=>Number(t),Lp={string:t=>t,int:r0,uint:r0,short:r0,ushort:r0,float:r0,double:r0,bool:t=>!!t};function nS(t,e){return ms(t,"ExtendedData",(r,i)=>{for(let n of Bi(r,"Data"))i[n.getAttribute("name")||""]=Mi(sn(n,"value"));for(let n of Bi(r,"SimpleData")){let s=n.getAttribute("name")||"",o=e[s]||Lp.string;i[s]=o(Mi(n))}return i})}function sS(t){let e=sn(t,"description");for(let r of Array.from(e?.childNodes||[]))if(r.nodeType===4)return{description:{"@type":"html",value:Mi(r)}};return{}}function oS(t){return ms(t,"TimeSpan",e=>({timespan:{begin:Mi(sn(e,"begin")),end:Mi(sn(e,"end"))}}))}function aS(t){return ms(t,"TimeStamp",e=>({timestamp:Mi(sn(e,"when"))}))}function lS(t,e){return e1(t,"styleUrl",r=>(r=Ed(r),e[r]?Object.assign({styleUrl:r},e[r]):{styleUrl:r}))}var sO=/\s*/g,oO=/^\s*|\s*$/g,aO=/\s+/;function cS(t){return t.replace(sO,"").split(",").map(parseFloat).filter(e=>!isNaN(e)).slice(0,3)}function Bp(t){return t.replace(oO,"").split(aO).map(cS).filter(e=>e.length>=2)}function lO(t){let e=Bi(t,"coord");e.length===0&&(e=qF(t,"coord","*"));let r=e.map(i=>Mi(i).split(" ").map(parseFloat));return r.length===0?null:{geometry:r.length>2?{type:"LineString",coordinates:r}:{type:"Point",coordinates:r[0]},times:Bi(t,"when").map(i=>Mi(i))}}function uS(t){if(t.length===0)return t;let e=t[0],r=t[t.length-1],i=!0;for(let n=0;n<Math.max(e.length,r.length);n++)if(e[n]!==r[n]){i=!1;break}return i?t:t.concat([t[0]])}function wd(t){return Mi(sn(t,"coordinates"))}function fS(t){let e=[],r=[];for(let i=0;i<t.childNodes.length;i++){let n=t.childNodes.item(i);if(Up(n))switch(n.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{let s=fS(n);e=e.concat(s.geometries),r=r.concat(s.coordTimes);break}case"Point":{let s=cS(wd(n));s.length>=2&&e.push({type:"Point",coordinates:s});break}case"LinearRing":case"LineString":{let s=Bp(wd(n));s.length>=2&&e.push({type:"LineString",coordinates:s});break}case"Polygon":{let s=[];for(let o of Bi(n,"LinearRing")){let a=uS(Bp(wd(o)));a.length>=4&&s.push(a)}s.length&&e.push({type:"Polygon",coordinates:s});break}case"Track":case"gx:Track":{let s=lO(n);if(!s)break;let{times:o,geometry:a}=s;e.push(a),o.length&&r.push(o);break}}}return{geometries:e,coordTimes:r}}function cO(t){return t.length===0?null:t.length===1?t[0]:{type:"GeometryCollection",geometries:t}}function uO(t,e,r){let{coordTimes:i,geometries:n}=fS(t),s={type:"Feature",geometry:cO(n),properties:Object.assign(D2(t,["name","address","visibility","open","phoneNumber","description"]),sS(t),lS(t,e),Hp(t),nS(t,r),oS(t),aS(t),i.length?{coordinateProperties:{times:i.length===1?i[0]:i}}:{})};s.properties?.visibility!==void 0&&(s.properties.visibility=s.properties.visibility!=="0");let o=t.getAttribute("id");return o!==null&&o!==""&&(s.id=o),s}function fO(t){return sn(t,"gx:LatLonQuad")?{type:"Polygon",coordinates:[uS(Bp(wd(t)))]}:pO(t)}var dO=Math.PI/180;function hO(t,e,r){let i=[(t[0]+t[2])/2,(t[1]+t[3])/2];return[e[0].map(n=>{let s=n[1]-i[1],o=n[0]-i[0],a=Math.sqrt(Math.pow(s,2)+Math.pow(o,2)),l=Math.atan2(s,o)-r*dO;return[i[0]+Math.cos(l)*a,i[1]+Math.sin(l)*a]})]}function pO(t){let e=sn(t,"LatLonBox");if(e){let r=Jl(e,"north"),i=Jl(e,"west"),n=Jl(e,"east"),s=Jl(e,"south"),o=Jl(e,"rotation");if(typeof r=="number"&&typeof s=="number"&&typeof i=="number"&&typeof n=="number"){let a=[i,s,n,r],l=[[[i,r],[n,r],[n,s],[i,s],[i,r]]];return typeof o=="number"&&(l=hO(a,l,o)),{type:"Polygon",coordinates:l}}}return null}function mO(t,e,r){let n={type:"Feature",geometry:fO(t),properties:Object.assign({"@geometry-type":"groundoverlay"},D2(t,["name","address","visibility","open","phoneNumber","description"]),sS(t),lS(t,e),Hp(t),iS(t),nS(t,r),oS(t),aS(t))};n.properties?.visibility!==void 0&&(n.properties.visibility=n.properties.visibility!=="0");let s=t.getAttribute("id");return s!==null&&s!==""&&(n.id=s),n}function gO(t){let e=t.getAttribute("id"),r=t.parentNode;return!e&&Up(r)&&r.localName==="CascadingStyle"&&(e=r.getAttribute("kml:id")||r.getAttribute("id")),Ed(e||"")}function yO(t){let e={};for(let r of Bi(t,"Style"))e[gO(r)]=Hp(r);for(let r of Bi(t,"StyleMap")){let i=Ed(r.getAttribute("id")||"");e1(r,"styleUrl",n=>{n=Ed(n),e[n]&&(e[i]=e[n])})}return e}function vO(t){let e={};for(let r of Bi(t,"SimpleField"))e[r.getAttribute("name")||""]=Lp[r.getAttribute("type")||""]||Lp.string;return e}function*xO(t){let e=yO(t),r=vO(t);for(let i of Bi(t,"Placemark")){let n=uO(i,e,r);n&&(yield n)}for(let i of Bi(t,"GroundOverlay")){let n=mO(i,e,r);n&&(yield n)}}function dS(t){return{type:"FeatureCollection",features:Array.from(xO(t))}}function Ad(t){let e=fe("task_extent_set"),r={};r.showPowerUser=t.initialHashParams.poweruser==="true";function i(u,d,h){return h.indexOf(u)===d}let n,s;r.setTaskExtentByGpxData=function(u){let d=new DOMParser().parseFromString(u,"text/xml"),h=Td(d),p=h.features.reduce((m,g)=>m+(g.geometry.type==="LineString"?1:0),0);if(h.type==="FeatureCollection"){let m,g,y,v;h.features.forEach(x=>{if(x.geometry.type==="Point"){let _=x.geometry.coordinates[0],b=x.geometry.coordinates[1];(m===void 0||b<m)&&(m=b),(g===void 0||_<g)&&(g=_),(y===void 0||b>y)&&(y=b),(v===void 0||_>v)&&(v=_)}else if(x.geometry.type==="LineString"&&p===1){let _=x.geometry.coordinates.map(T=>T[0]),b=x.geometry.coordinates.map(T=>T[1]),w=_.filter(i),E=b.filter(i),A=!0;w.forEach(T=>{x.geometry.coordinates.filter(C=>C[0]===T).map(C=>C[1]).filter(i).length!==2&&(A=!1)}),w.length===2&&E.length===2&&A?s=!0:s=!1}}),n=new le([g,m],[v,y]),e.call("task_extent_set")}},r.getTaskExtent=()=>n,r.isTaskRectangular=()=>!!n&&s,r.sources=new Set;let o="#da26d3",a=["#ff0000","#ffa500","#ffd700","#00ff00","#00ffff","#1e90ff","#da26d3","#ffc0cb","#d3d3d3","#faf0e6"];r.colors=()=>a;let l={};r.datasets=()=>l,r.init=()=>{t.urlhash().on("hashchange",c),se.ensureLoaded().then(()=>{l={fbRoads:{id:"fbRoads",beta:!1,added:!0,enabled:!1,conflated:!0,service:"fbml",color:o,label:S("rapid_feature_toggle.fbRoads.label"),license_markdown:S("rapid_feature_toggle.fbRoads.license_markdown")},msBuildings:{id:"msBuildings",beta:!1,added:!0,enabled:!1,conflated:!0,service:"fbml",color:o,label:S("rapid_feature_toggle.msBuildings.label"),license_markdown:S("rapid_feature_toggle.msBuildings.license_markdown")}}})},r.reset=()=>{r.sources=new Set};function c(u){let d=new Set;typeof u.datasets=="string"&&(d=new Set(u.datasets.split(",")));for(let p of Object.keys(l)){let m=l[p];d.has(p)?(m.enabled=!0,d.delete(p)):m.enabled=!1}let h=K.esriData;!h||!d.size||h.loadDatasets().then(p=>{d.forEach(m=>{let g=p[m];if(!g)return;h.loadLayer(g.id);let y=g.groupCategories.some(b=>b.toLowerCase()==="/categories/preview"),v=g.groupCategories.some(b=>b.toLowerCase()==="/categories/buildings"),x=Object.keys(l).length%a.length,_={id:g.id,beta:y,added:!0,enabled:!0,conflated:!1,service:"esri",color:a[x],label:g.title,license_markdown:S("rapid_feature_toggle.esri.license_markdown")};g.extent&&(_.extent=new le(g.extent[0],g.extent[1])),v&&(_.conflated=!0,_.service="fbml"),l[g.id]=_})})}return ge(r,e,"on")}var F2=dt(t1(),1);var Gn=class{constructor(e,r){this._base=e,this._head=r,this._changes=new Map,this.didChange={};let i=new Set([...r.local.entities.keys(),...e.local.entities.keys()]);for(let n of i){let s=r.hasEntity(n),o=e.hasEntity(n);if(s!==o){if(o&&!s){this._changes.set(n,{base:o,head:s}),this.didChange.deletion=!0;continue}if(!o&&s){this._changes.set(n,{base:o,head:s}),this.didChange.addition=!0;continue}if(s&&o){if(s.members&&o.members&&!(0,F2.default)(s.members,o.members)){this._changes.set(n,{base:o,head:s}),this.didChange.geometry=!0,this.didChange.properties=!0;continue}s.loc&&o.loc&&!pt(s.loc,o.loc)&&(this._changes.set(n,{base:o,head:s}),this.didChange.geometry=!0),s.nodes&&o.nodes&&!(0,F2.default)(s.nodes,o.nodes)&&(this._changes.set(n,{base:o,head:s}),this.didChange.geometry=!0),s.tags&&o.tags&&!(0,F2.default)(s.tags,o.tags)&&(this._changes.set(n,{base:o,head:s}),this.didChange.properties=!0)}}}}get changes(){return this._changes}modified(){let e=[];for(let r of this._changes.values())r.base&&r.head&&e.push(r.head);return e}created(){let e=[];for(let r of this._changes.values())!r.base&&r.head&&e.push(r.head);return e}deleted(){let e=[];for(let r of this._changes.values())r.base&&!r.head&&e.push(r.base);return e}summary(){let e=this._base,r=this._head,i=new Map;for(let s of this._changes.values()){let o=s.head,a=s.base;if(o&&o.geometry(r)!=="vertex")n(o,r,a?"modified":"created");else if(a&&a.geometry(e)!=="vertex")n(a,e,"deleted");else if(a&&o){let l=!pt(a.loc,o.loc),c=!(0,F2.default)(a.tags,o.tags);if(l)for(let u of r.parentWays(o))i.has(u.id)||n(u,r,"modified");(c||l&&o.hasInterestingTags())&&n(o,r,"modified")}else o&&o.hasInterestingTags()?n(o,r,"created"):a&&a.hasInterestingTags()&&n(a,e,"deleted")}return i;function n(s,o,a){i.set(s.id,{entity:s,graph:o,changeType:a})}}complete(){let e=this._head,r=new Map;for(let[n,s]of this._changes){let o=s.head,a=s.base,l=o||a;if(r.set(n,o),l.type==="way"){let c=o?o.nodes:[],u=a?a.nodes:[];for(let d of jt(c,u))r.set(d,e.hasEntity(d))}if(l.type==="relation"&&l.isMultipolygon()){let c=o?o.members.map(d=>d.id):[],u=a?a.members.map(d=>d.id):[];for(let d of jt(c,u)){let h=e.hasEntity(d);h&&r.set(d,h)}}i(e.parentWays(l),r),i(e.parentRelations(l),r)}return r;function i(n){for(let s of n)r.has(s.id)||(r.set(s.id,s),i(e.parentRelations(s)))}}};var Vp=dt(Us(),1);var zn=class{constructor(e){this._current=e,this._entityRBush=new Vp.default,this._entityBoxes=new Map,this._entitySegments=new Map,this._segmentRBush=new Vp.default,this._segmentBoxes=new Map}_removeEntity(e){let r=this._entityBoxes.get(e);r&&(this._entityRBush.remove(r),this._entityBoxes.delete(e));let i=this._entitySegments.get(e)??[];for(let n of i){let s=n.id,o=this._segmentBoxes.get(s);o&&(this._segmentRBush.remove(o),this._segmentBoxes.delete(s))}this._entitySegments.delete(e)}_loadEntities(e){let r=this._current,i=[],n=[];for(let[s,o]of e){let a=o.extent(r);if(!a)continue;let l=a.bbox();if(l.id=s,this._entityBoxes.set(s,l),i.push(l),typeof o.segments!="function")continue;let c=o.segments(r)??[];this._entitySegments.set(s,c);for(let u of c){let d=u.id,h=u.extent(r);if(!h)continue;let p=h.bbox();p.id=d,p.segment=u,this._segmentBoxes.set(d,p),n.push(p)}}i.length&&this._entityRBush.load(i),n.length&&this._segmentRBush.load(n)}_includeParents(e,r,i){let n=this._current,s=e.id;if(i||(i=new Set),!i.has(s)){i.add(s);for(let o of n.parentWays(e))this._entityBoxes.has(o.id)&&(this._removeEntity(o.id),r.set(o.id,o)),this._includeParents(o,r,i);for(let o of n.parentRelations(e))this._entityBoxes.has(o.id)&&(this._removeEntity(o.id),r.set(o.id,o)),this._includeParents(o,r,i)}}_setCurrentGraph(e){if(e===this._current)return;let r=new Gn(this._current,e);this._current=e;let i=r.didChange;if(!i.addition&&!i.deletion&&!i.geometry)return;let n=new Map;if(i.deletion)for(let s of r.deleted())this._removeEntity(s.id);if(i.geometry)for(let s of r.modified())this._removeEntity(s.id),n.set(s.id,s),this._includeParents(s,n);if(i.addition)for(let s of r.created())n.set(s.id,s);this._loadEntities(n)}rebase(e,r){let n=this._current.local,s=new Map;for(let o of e){if(!o.visible)continue;let a=o.id;n.entities.has(a)&&n.entities.get(a)===void 0||this._entityBoxes.has(a)&&!r||(this._removeEntity(a),s.set(a,o),this._includeParents(o,s))}this._loadEntities(s)}intersects(e,r){return this._setCurrentGraph(r),this._entityRBush.search(e.bbox()).map(i=>r.entity(i.id))}waySegments(e,r){return this._setCurrentGraph(r),this._segmentRBush.search(e.bbox()).map(i=>i.segment)}};function Er(t,e){let r=rt("modal"),i=t.select("div.modal"),n=i.empty();i.transition().duration(200).style("opacity",0).remove();let s=t.append("div").attr("class","shaded").style("opacity",0);s.close=()=>{s.transition().duration(200).style("opacity",0).remove(),o.transition().duration(200).style("top","0px"),H(document).call(r.unbind)};let o=s.append("div").attr("class","modal fillL");return o.append("input").attr("class","keytrap keytrap-first").on("focus.keytrap",l),e||(s.on("click.remove-modal",c=>{c.target===this&&s.close()}),o.append("button").attr("class","close").on("click",s.close).call(Z("#rapid-icon-close")),r.on("\u232B",s.close).on("\u238B",s.close),H(document).call(r)),o.append("div").attr("class","content"),o.append("input").attr("class","keytrap keytrap-last").on("focus.keytrap",a),n?s.transition().style("opacity",1):s.style("opacity",1),s;function a(){let c=o.select("a, button, input:not(.keytrap), select, textarea").node();c?c.focus():H(this).node().blur()}function l(){let c=o.selectAll("a, button, input:not(.keytrap), select, textarea").nodes();c.length?c[c.length-1].focus():H(this).node().blur()}}function ra(t){let e=H(null),r="",i=!1,n=s=>{e=Er(s,i);let o=e.select(".content").classed("loading-modal",!0).append("div").attr("class","modal-section fillL");return o.append("img").attr("class","loader").attr("src",t.imagePath("loader-white.gif")),o.append("h3").html(r),e.select("button.close").attr("class","hide"),n};return n.message=function(s){return arguments.length?(r=s,n):r},n.blocking=function(s){return arguments.length?(i=s,n):i},n.close=()=>{e.remove()},n.isShown=()=>e&&!e.empty()&&e.node().parentNode,n}function Cd(t){var e=fe("reset","change","merge","restore","undone","redone","storage_error"),r=cx("lock"),i=r.lock()&&!!ee(v("saved_history")),n=150,s=[],o=[],a={},l,c,u,d;function h(_,b){_=Array.prototype.slice.call(_);var w;typeof _[_.length-1]!="function"&&(w=_.pop());for(var E=c[u].graph,A=0;A<_.length;A++)E=_[A](E,b);return{graph:E,annotation:w,imageryUsed:s,photoOverlaysUsed:o,transform:t.projection.transform(),selectedIDs:t.selectedIDs()}}function p(_,b){var w=c[u].graph;c=c.slice(0,u+1);var E=h(_,b);return c.push(E),u++,y(w)}function m(_,b){var w=c[u].graph,E=h(_,b);return c[u]=E,y(w)}function g(_,b){var w=c[u].graph;u>0&&(u--,c.pop()),c=c.slice(0,u+1);var E=h(_,b);return c.push(E),u++,y(w)}function y(_){var b=new Gn(_,x.graph());return l||e.call("change",this,b),b}function v(_){return"Rapid_"+window.location.origin+"_"+_}var x={graph:function(){return c[u].graph},tree:function(){return d},base:function(){return c[0].graph},peekAnnotation:function(){return c[u].annotation},peekAllAnnotations:function(){for(var _=[],b=0;b<=u;b++)c[b].annotation&&_.push(c[b].annotation);return _},merge:function(_,b){let w=this.base(),E=this.graph();b instanceof Set||(b=new Set(_.map(k=>k.id)));let A=new Set;for(let k of _)w.hasEntity(k.id)||A.add(k.id);for(let k of b){let C=E.hasEntity(k);if(C?.type==="relation")for(let I of C.members)A.has(I.id)&&C.touch()}let T=c.map(k=>k.graph);w.rebase(_,T,!1),d.rebase(_,!1),e.call("merge",this,b)},perform:function(){H(document).interrupt("history.perform");var _=!1,b=arguments[0];if((arguments.length===1||arguments.length===2&&typeof arguments[1]!="function")&&(_=!!b.transitionable),_){var w=arguments;H(document).transition("history.perform").duration(n).ease(s2).tween("history.tween",function(){return function(E){E<1&&g([b],E)}}).on("start",function(){p([b],0)}).on("end interrupt",function(){g(w,1)})}else return p(arguments)},replace:function(){return H(document).interrupt("history.perform"),m(arguments,1)},overwrite:function(){return H(document).interrupt("history.perform"),g(arguments,1)},pop:function(_){H(document).interrupt("history.perform");var b=c[u].graph;for((isNaN(+_)||+_<0)&&(_=1);_-- >0&&u>0;)u--,c.pop();return y(b)},undo:function(){H(document).interrupt("history.perform");for(var _=c[u],b=_.graph;u>0&&(u--,!c[u].annotation););return e.call("undone",this,c[u],_),y(b)},redo:function(){H(document).interrupt("history.perform");for(var _=c[u],b=_.graph,w=u;w<c.length-1;)if(w++,c[w].annotation){u=w,e.call("redone",this,c[u],_);break}return y(b)},pauseChangeDispatch:function(){l||(l=c[u].graph)},resumeChangeDispatch:function(){if(l){var _=l;return l=null,y(_)}},undoAnnotation:function(){for(var _=u;_>=0;){if(c[_].annotation)return c[_].annotation;_--}},redoAnnotation:function(){for(var _=u+1;_<=c.length-1;){if(c[_].annotation)return c[_].annotation;_++}},intersects:function(_){return d.intersects(_,c[u].graph)},difference:function(){var _=c[0].graph,b=c[u].graph;return new Gn(_,b)},changes:function(_){var b=c[0].graph,w=c[u].graph;_&&(w=_(w));var E=new Gn(b,w);return{modified:E.modified(),created:E.created(),deleted:E.deleted()}},hasChanges:function(){return this.difference().changes.size>0},imageryUsed:function(_){if(_)return s=_,x;var b=new Set;return c.slice(1,u+1).forEach(function(w){w.imageryUsed.forEach(function(E){E!=="Custom"&&b.add(E)})}),Array.from(b)},photoOverlaysUsed:function(_){if(_)return o=_,x;var b=new Set;return c.slice(1,u+1).forEach(function(w){w.photoOverlaysUsed&&Array.isArray(w.photoOverlaysUsed)&&w.photoOverlaysUsed.forEach(function(E){b.add(E)})}),Array.from(b)},checkpoint:function(_){return a[_]={stack:c,index:u},x},reset:function(_){if(H(document).interrupt("history.perform"),_!==void 0&&a.hasOwnProperty(_)){let b=c[u].graph;c=a[_].stack,u=a[_].index;let w=c[u].graph,E=new Gn(b,w);e.call("reset"),e.call("change",this,E),e.call("restore")}else c=[{graph:new Dr}],u=0,d=new zn(c[0].graph),a={},e.call("reset"),e.call("change"),e.call("restore");return x},toIntroGraph:function(){let _={n:0,r:0,w:0},b={},w=this.graph(),E=new Map;for(let k of w.base.entities.values()){let C=T(k);E.set(C.id,C)}for(let[k,C]of w.local.entities)if(C){let I=T(C);E.set(I.id,I)}else E.delete(k);for(let k of E.values())Array.isArray(k.nodes)&&(k.nodes=k.nodes.map(C=>b[C]??C)),Array.isArray(k.members)&&(k.members=k.members.map(C=>(C.id=b[C.id]||C.id,C)));let A={};for(let[k,C]of E)A[k]=C;return JSON.stringify({dataIntroGraph:A});function T(k){let C=Fi(k,["type","user","v","version","visible"]);C.tags&&!Object.keys(C.tags)&&delete C.tags,Array.isArray(C.loc)&&(C.loc[0]=+C.loc[0].toFixed(6),C.loc[1]=+C.loc[1].toFixed(6));let I=k.id.match(/([nrw])-\d*/);if(I!==null){let P=I[1],N;do N=P+ ++_[P];while(E.has(N));b[k.id]=N,C.id=N}return C}},toJSON:function(){if(!this.hasChanges())return;let _=new Map,b=new Set,w=[];for(let T of c){let k=T.graph,C=[],I=[];for(let[N,M]of k.local.entities)if(b.add(N),M){let D=Te.key(M);_.set(D,M),C.push(D)}else I.push(N);let P={};C.length&&(P.modified=C),I.length&&(P.deleted=I),T.imageryUsed&&(P.imageryUsed=T.imageryUsed),T.photoOverlaysUsed&&(P.photoOverlaysUsed=T.photoOverlaysUsed),T.annotation&&(P.annotation=T.annotation),T.transform&&(P.transform=T.transform),T.selectedIDs&&(P.selectedIDs=T.selectedIDs),w.push(P)}let E=this.base(),A=new Map;for(let T of b){let k=E.hasEntity(T);if(!(!k||A.has(T))){A.set(T,k);for(let C of E.childNodes(k))A.set(C.id,C);for(let C of E.parentWays(k))A.set(C.id,C)}}return JSON.stringify({version:3,entities:[..._.values()],baseEntities:[...A.values()],stack:w,nextIDs:Te.id.next,index:u,timestamp:new Date().getTime()})},fromJSON:function(_,b){let w=this.base(),E=JSON.parse(_),A=!0;if(Te.id.next=E.nextIDs,u=E.index,E.version!==2&&E.version!==3)throw new Error(`History version ${E.version} not supported.`);let T=new Map;for(let I of E.entities)T.set(Te.key(I),Te(I));if(E.version>=3){let I=E.baseEntities.map(N=>Te(N)),P=c.map(N=>N.graph);if(w.rebase(I,P,!0),d.rebase(I,!0),b){let N=t.connection(),F=I.filter(L=>L.type==="way").reduce(function(L,B){return jt(L,B.nodes)},[]).filter(L=>!w.hasEntity(L));if(F.length&&N){A=!1,t.map().redrawEnabled=!1;let L=ra(t).blocking(!0);t.container().call(L);var k=function(B,O){if(!B){let R=yr(O.data,"visible"),U=R.true||[],G=R.false||[];if(U.length){let $=U.map(ie=>ie.id),q=c.map(ie=>ie.graph);F=si(F,$),w.rebase(U,q,!0),d.rebase(U,!0)}G.forEach(function($){N.loadEntityVersion($.id,+$.version-1,k)})}(B||!F.length)&&(L.close(),t.map().redrawEnabled=!0,e.call("change"),e.call("restore",this))};N.loadMultiple(F,k)}}}c=E.stack.map((I,P)=>{if(P===0)return c[0];let N={};if(Array.isArray(I.modified)&&I.modified.forEach(M=>{let D=T.get(M);N[D.id]=D}),Array.isArray(I.deleted)&&I.deleted.forEach(M=>{N[M]=void 0}),I.annotation&&I.annotation.type==="rapid_accept_feature"){let M=t.rapidContext(),D=I.annotation.source;M.sources.add("mapwithai"),D&&/^esri/.test(D)&&M.sources.add("esri")}return{graph:new Dr(w).load(N),annotation:I.annotation,imageryUsed:I.imageryUsed,photoOverlaysUsed:I.photoOverlaysUsed,transform:I.transform,selectedIDs:I.selectedIDs}});let C=c[u].transform;return C&&t.map().transform(C),A&&(e.call("change"),e.call("restore",this)),x},lock:function(){return r.lock()},unlock:function(){r.unlock()},save:function(){return r.locked()&&!i&&(ee(v("saved_history"),x.toJSON()||null)||e.call("storage_error")),x},clearSaved:function(){return t.debouncedSave.cancel(),r.locked()&&(i=!1,ee(v("saved_history"),null),ee("comment",null),ee("hashtags",null),ee("source",null)),x},savedHistoryJSON:function(){return ee(v("saved_history"))},hasRestorableChanges:function(){return i},restore:function(){if(r.locked()){i=!1;var _=this.savedHistoryJSON();_&&x.fromJSON(_,!0)}},_getKey:v};return x.reset(),ge(x,e,"on")}function Xr(t,e){return function(r){r=r.replace(e.move(t.loc));var i=Ir(r.parentWays(r.entity(t.edge[0])),r.parentWays(r.entity(t.edge[1])));return i.forEach(function(n){for(var s=0;s<n.nodes.length-1;s++)if(Fb([n.nodes[s],n.nodes[s+1]],t.edge)){r=r.replace(r.entity(n.id).addNode(e.id,s+1));return}}),r}}function Fr(t,e,r,i){for(var n=ut,s=t.map(function(v){return r.project(v.loc)}),o=t.map(function(v){return v.id}),a=1/0,l,c,u=0;u<s.length-1;u++)if(!(o[u]===i||o[u+1]===i)){var d=s[u],h=St(s[u+1],d),p=St(e,d),m=us(p,h)/us(h,h),g;m<0?g=d:m>1?g=s[u+1]:g=[d[0]+m*h[0],d[1]+m*h[1]];var y=n(g,e);y<a&&(a=y,l=u+1,c=r.invert(g))}return l!==void 0?{index:l,distance:a,loc:c}:null}function pS(t,e,r){var i=[],n=[],s,o,a,l,c;for(s=0;s<t.length-1;s++)a=t[s],l=t[s+1],c=[a.loc,l.loc],(a.id===r||l.id===r)&&i.push(c);for(s=0;s<e.length-1;s++)a=e[s],l=e[s+1],c=[a.loc,l.loc],n.push(c);for(s=0;s<i.length;s++)for(o=0;o<n.length;o++){var u=i[s],d=n[o],h=qo(u,d);if(h)return!0}return!1}function r1(t,e){var r=[],i=[],n,s;for(n=0;n<t.length-1;n++){var o=t[n],a=t[n+1],l=[o.loc,a.loc];o.id===e||a.id===e?r.push(l):i.push(l)}for(n=0;n<r.length;n++)for(s=0;s<i.length;s++){var c=r[n],u=i[s];if(!(pt(c[1],u[0])||pt(c[0],u[1])||pt(c[0],u[0])||pt(c[1],u[1]))){var d=qo(c,u);if(d){var h=1e-8;if(pt(c[1],d,h)||pt(c[0],d,h)||pt(u[1],d,h)||pt(u[0],d,h))continue;return!0}}}return!1}function i1(t,e,r){return pt(r,t)||pt(r,e)?1:Hf(t,e,r)}function mS(t,e,r,i,n){var s=Math.abs(t);return s<e||n&&Math.abs(s-1)<e?0:s<r||s>i?t:null}function kd(t,e,r,i){for(var n=0,s=e?0:1,o=e?t.length:t.length-1,a=t.map(function(g){return g.coord}),l=Math.cos((90-i)*Math.PI/180),c=Math.cos(i*Math.PI/180),u=s;u<o;u++){var d=a[(u-1+a.length)%a.length],h=a[u],p=a[(u+1)%a.length],m=mS(i1(d,p,h),r,l,c);m!==null&&(n=n+2*Math.min(Math.abs(m-1),Math.min(Math.abs(m),Math.abs(m+1))))}return n}function gS(t,e,r){for(var i=-1/0,n=e?0:1,s=e?t.length:t.length-1,o=n;o<s;o++){var a=t[(o-1+t.length)%t.length],l=t[o],c=t[(o+1)%t.length],u=i1(a,c,l),d=Math.acos(Math.abs(u))*180/Math.PI;d>45&&(d=90-d),!(d>=r)&&d>i&&(i=d)}return i===-1/0?null:i}function i0(t,e,r,i,n){for(var s=null,o=e?0:1,a=e?t.length:t.length-1,l=Math.cos((90-i)*Math.PI/180),c=Math.cos(i*Math.PI/180),u=o;u<a;u++){var d=t[(u-1+t.length)%t.length],h=t[u],p=t[(u+1)%t.length],m=mS(i1(d,p,h),r,l,c,n);if(m!==null){if(Math.abs(m)>0)return 1;s=0}}return s}var om={};F5(om,{operationCircularize:()=>Xp,operationContinue:()=>Wp,operationCopy:()=>O2,operationCycleHighwayTag:()=>qp,operationDelete:()=>on,operationDisconnect:()=>Yp,operationDowngrade:()=>B2,operationExtract:()=>Qp,operationMerge:()=>Kp,operationMove:()=>Zp,operationOrthogonalize:()=>Jp,operationPaste:()=>U2,operationReflectLong:()=>tm,operationReflectShort:()=>em,operationReverse:()=>rm,operationRotate:()=>im,operationSplit:()=>nm,operationStraighten:()=>sm});function Id(t,e,r){r=(r||20)*Math.PI/180;var i=function(n,s){(s===null||!isFinite(s))&&(s=1),s=Math.min(Math.max(+s,0),1);var o=n.entity(t),a={};n.childNodes(o).forEach(function(Pt){a[Pt.id]||(a[Pt.id]=Pt)}),o.isConvex(n)||(n=i.makeConvex(n));var l=$e(n.childNodes(o)),c=l.filter(function(Pt){return n.parentWays(Pt).length!==1}),u=l.map(function(Pt){return e.project(Pt.loc)}),d=c.map(function(Pt){return e.project(Pt.loc)}),h=u.length===2?Ct(u[0],u[1],.5):yn(u),p=K5(u,function(Pt){return ut(h,Pt)}),m=bc(u)>0?1:-1,g,y,v,x;if(c.length||(c=[l[0]],d=[u[0]]),c.length===1){var _=l.indexOf(c[0]),b=Math.floor((_+l.length/2)%l.length);c.push(l[b]),d.push(u[b])}for(y=0;y<d.length;y++){var w=(y+1)%c.length,E=c[y],A=c[w],T=l.indexOf(E),k=l.indexOf(A),C=-1,I=k-T,P={},N=[],M,D,F,L,B,O,R,U;I<0&&(I+=l.length);var G=ut(h,d[y])||1e-4;d[y]=[h[0]+(d[y][0]-h[0])/G*p,h[1]+(d[y][1]-h[1])/G*p],O=e.invert(d[y]),R=c[y],U=a[R.id],R=R.move(Ct(U.loc,O,s)),n=n.replace(R),M=Math.atan2(d[y][1]-h[1],d[y][0]-h[0]),D=Math.atan2(d[w][1]-h[1],d[w][0]-h[0]),F=D-M,F*m>0&&(F=-m*(2*Math.PI-Math.abs(F)));do C++,L=F/(I+C);while(Math.abs(L)>r);for(v=1;v<I;v++)B=M+v*L,O=e.invert([h[0]+Math.cos(B)*p,h[1]+Math.sin(B)*p]),R=l[(v+T)%l.length],U=a[R.id],P[R.id]=B,R=R.move(Ct(U.loc,O,s)),n=n.replace(R);for(v=0;v<C;v++){B=M+(I+v)*L,O=e.invert([h[0]+Math.cos(B)*p,h[1]+Math.sin(B)*p]);var $=1/0;for(var q in P){var ie=P[q],Q=Math.abs(ie-B);Q<$&&($=Q,U=a[q])}R=je({loc:Ct(U.loc,O,s)}),n=n.replace(R),l.splice(k+v,0,R),N.push(R.id)}if(I===1&&N.length){var re=o.nodes.lastIndexOf(E.id),ve=o.nodes.lastIndexOf(A.id),de=ve-re;de<-1&&(de=1);var we=n.parentWays(c[y]);for(v=0;v<we.length;v++){var ne=we[v];if(ne!==o&&ne.areAdjacent(E.id,A.id)){var Ie=ne.nodes.lastIndexOf(E.id),at=ne.nodes.lastIndexOf(A.id),Et=at-Ie,$t=at;for(Et<-1&&(Et=1),de!==Et&&(N.reverse(),$t=Ie),x=0;x<N.length;x++)ne=ne.addNode(N[x],$t+x);n=n.replace(ne)}}}}return g=l.map(function(Pt){return Pt.id}),g.push(g[0]),o=o.update({nodes:g}),n=n.replace(o),n};return i.makeConvex=function(n){var s=n.entity(t),o=$e(n.childNodes(s)),a=o.map(function(v){return e.project(v.loc)}),l=bc(a)>0?1:-1,c=Ds(a),u,d;for(l===-1&&(o.reverse(),a.reverse()),u=0;u<c.length-1;u++){var h=a.indexOf(c[u]),p=a.indexOf(c[u+1]),m=p-h;for(m<0&&(m+=o.length),d=1;d<m;d++){var g=Ct(c[u],c[u+1],d/m),y=o[(d+h)%o.length].move(e.invert(g));n=n.replace(y)}}return n},i.disabled=function(n){if(!n.entity(t).isClosed())return"not_closed";var s=n.entity(t),o=$e(n.childNodes(s)),a=o.map(function(b){return e.project(b.loc)}),l=Ds(a),c=Math.PI/180;if(l.length!==a.length||l.length<3)return!1;var u=yn(a),d=O8(u,a[0]),h,p;for(h=0;h<l.length;h++){p=l[h];var m=O8(p,u),g=Math.abs(m-d);if(g>.05*d)return!1}for(h=0;h<l.length;h++){p=l[h];var y=l[(h+1)%l.length],v=Math.atan2(p[1]-u[1],p[0]-u[0]),x=Math.atan2(y[1]-u[1],y[0]-u[0]),_=x-v;if(_<0&&(_=-_),_>Math.PI&&(_=2*Math.PI-_),_>r+c)return!1}return"already_circular"},i.transitionable=!0,i}var ai=class extends xr.default{constructor(e){super(),this.context=e,this._enabled=!1}enable(){this._enabled=!0}disable(){this._enabled=!1}get enabled(){return this._enabled}_getEventData(e){let r={id:e.pointerId??e.pointerType??"unknown",event:e,originalEvent:e.originalEvent,coord:[e.global.x,e.global.y],time:e.timeStamp,isCancelled:!1,target:null};if(!e.target)return r;let i=e.target,n=i?.__feature__;return n?(r.target={displayObject:i,feature:n,featureID:n.id,layer:n.layer,layerID:n.layer.id,data:n.data,dataID:n.data?.id},r):(i=e.target.parent,n=i?.__feature__,n?(r.target={displayObject:i,feature:n,featureID:n.id,layer:n.layer,layerID:n.layer.id,data:n.data,dataID:n.data?.id},r):(r.target={displayObject:e.target,feature:null,featureID:null,layer:null,layerID:null,data:null,dataID:null},r))}};var Ft=class extends ai{constructor(e,r){super(e),this.id=`key-${r.id}`,this._operation=r,window.mocha||(this._keybinding=this.context.keybinding()),this._keydown=this._keydown.bind(this)}enable(){if(this._enabled)return;let e=this._operation;e.available()&&e.keys&&(this._keybinding.on(e.keys,this._keydown),this._enabled=!0)}disable(){if(!this._enabled)return;this._enabled=!1;let e=this._operation;e.keys&&this._keybinding.off(e.keys)}_keydown(e){let r=this.context,i=this._operation;if(i.availableForKeypress&&!i.availableForKeypress())return;e.preventDefault(),i.disabled()?r.ui().flash.duration(4e3).iconName(`#rapid-operation-${i.id}`).iconClass("operation disabled").label(i.tooltip)():(r.ui().flash.duration(2e3).iconName(`#rapid-operation-${i.id}`).iconClass("operation").label(i.annotation()||i.title)(),i.point&&i.point(null),i())}};function Xp(t,e){let r=e.length===1?"single":"multiple",i=e.map(u=>t.hasEntity(u)).filter(Boolean),n=i.every(u=>u.isNew()),s=vt(i,t.graph()),o=i.map(l).filter(Boolean),a=dr(e,t.graph()).map(u=>u.loc);function l(u){return u.type!=="way"||new Set(u.nodes).size<=1?null:Id(u.id,t.projection)}let c=function(){if(!o.length)return;let u=function(d,h){return o.forEach(p=>{p.disabled(d)||(d=p(d,h))}),d};u.transitionable=!0,t.perform(u,c.annotation()),window.setTimeout(()=>t.validator().validate(),300)};return c.available=function(){return o.length&&e.length===o.length},c.disabled=function(){if(!o.length)return"";let u=o.map(p=>p.disabled(t.graph())).filter(Boolean);if(u.length===o.length)return new Set(u).size>1?"multiple_blockers":u[0];if(!n&&d())return"too_large";if(!n&&h())return"not_downloaded";if(e.some(t.hasHiddenConnections))return"connected_to_hidden";return!1;function d(){return!(ee("rapid-internal-feature.allowLargeEdits")==="true")&&s.percentContainedIn(t.map().extent())<.8}function h(){if(t.inIntro())return!1;let p=t.connection();if(p){let m=a.filter(g=>!p.isDataLoaded(g));if(m.length)return m.forEach(g=>t.loadTileAtLoc(g)),!0}return!1}},c.tooltip=function(){let u=c.disabled();return u?S(`operations.circularize.${u}.${r}`):S(`operations.circularize.description.${r}`)},c.annotation=function(){return S("operations.circularize.annotation.feature",{n:o.length})},c.id="circularize",c.keys=[S("operations.circularize.key")],c.title=S("operations.circularize.title"),c.behavior=new Ft(t,c),c}function Wp(t,e){let r=e.map(l=>t.hasEntity(l)).filter(Boolean),i=Object.assign({line:[],vertex:[]},yr(r,l=>l.geometry(t.graph()))),n=i.vertex.length===1&&i.vertex[0],s=o();function o(){return n?t.graph().parentWays(n).filter(l=>l.geometry(t.graph())==="line"&&!l.isClosed()&&l.affix(n.id)&&(i.line.length===0||i.line[0]===l)):[]}let a=function(){s.length&&t.enter("draw-line",{continueWay:s[0],continueNode:n})};return a.relatedEntityIds=function(){return s.length?[s[0].id]:[]},a.available=function(){return i.vertex.length===1&&i.line.length<=1&&!t.features().hasHiddenConnections(n,t.graph())},a.disabled=function(){return s.length===0?"not_eligible":s.length>1?"multiple":!1},a.tooltip=function(){let l=a.disabled();return l?S(`operations.continue.${l}`):S("operations.continue.description")},a.annotation=function(){return S("operations.continue.annotation.line")},a.id="continue",a.keys=[S("operations.continue.key")],a.title=S("operations.continue.title"),a.behavior=new Ft(t,a),a}function hr(){return function(t){return t}}var yS=[],vS=[];function qp(t,e){let r=[/^highway\/(motorway|trunk|primary|secondary|tertiary|unclassified|residential|living_street|service|track)/,/^line$/],i=["highway/residential","highway/service","highway/track","highway/unclassified","highway/tertiary","line"],n=ni(e,yS),s=new Set(n?vS:i),o=e.map(l=>t.hasEntity(l)).filter(l=>{if(l?.type!=="way")return!1;let c=xe.match(l,t.graph());return r.some(u=>u.test(c.id))?(s.has(c.id)||s.add(c.id),!0):!1});yS=e.slice(),vS=Array.from(s);let a=function(){if(!o.length)return;let l=a.annotation();(!n||t.history().undoAnnotation()!==l)&&t.perform(hr(),l);let c=Array.from(s),u=xe.match(o[0],t.graph()),d=u?c.indexOf(u.id):-1,h=c[(d+1)%c.length],p=xe.item(h);for(let m of o){let g=xe.match(m,t.graph()),y=Hn(m.id,g,p,!0);t.replace(y,l)}t.enter(Se(t,e))};return a.available=function(){return o.length>0},a.disabled=function(){return!1},a.tooltip=function(){let l=a.disabled();return l?S(`operations.cycle_highway_tag.${l}`):S("operations.cycle_highway_tag.description")},a.annotation=function(){return S("operations.cycle_highway_tag.annotation")},a.id="cycle_highway_tag",a.keys=["\u21E7"+S("operations.cycle_highway_tag.key")],a.title=S("operations.cycle_highway_tag.title"),a.behavior=new Ft(t,a),a}var et=function(t){let e=Rr();if(e.os==="mac")return t;if(e.os==="win"&&t==="\u2318\u21E7Z")return"Ctrl+Y";let r={"\u2318":"Ctrl","\u21E7":"Shift","\u2325":"Alt","\u232B":"Backspace","\u2326":"Delete"},i="";for(let n=0;n<t.length;n++)t[n]in r?i+=r[t[n]]+(n<t.length-1?"+":""):i+=t[n];return i};et.display=function(t){if(t.length!==1)return t;let r=Rr().os==="mac";return{"\u2318":r?"\u2318 "+S("shortcuts.key.cmd"):S("shortcuts.key.ctrl"),"\u21E7":r?"\u21E7 "+S("shortcuts.key.shift"):S("shortcuts.key.shift"),"\u2325":r?"\u2325 "+S("shortcuts.key.option"):S("shortcuts.key.alt"),"\u2303":r?"\u2303 "+S("shortcuts.key.ctrl"):S("shortcuts.key.ctrl"),"\u232B":r?"\u232B "+S("shortcuts.key.delete"):S("shortcuts.key.backspace"),"\u2326":r?"\u2326 "+S("shortcuts.key.del"):S("shortcuts.key.del"),"\u2196":r?"\u2196 "+S("shortcuts.key.pgup"):S("shortcuts.key.pgup"),"\u2198":r?"\u2198 "+S("shortcuts.key.pgdn"):S("shortcuts.key.pgdn"),"\u21DE":r?"\u21DE "+S("shortcuts.key.home"):S("shortcuts.key.home"),"\u21DF":r?"\u21DF "+S("shortcuts.key.end"):S("shortcuts.key.end"),"\u21B5":r?"\u23CE "+S("shortcuts.key.return"):S("shortcuts.key.enter"),"\u238B":r?"\u238B "+S("shortcuts.key.esc"):S("shortcuts.key.esc"),"\u2630":r?"\u2630 "+S("shortcuts.key.menu"):S("shortcuts.key.menu")}[t]||t};function O2(t,e){let r=e.map(l=>t.hasEntity(l)).filter(l=>l&&(l.hasInterestingTags()||l.geometry(t.graph())!=="vertex")),i=r.every(l=>l.isNew()),n=vt(r,t.graph()),s,o=function(){let l=t.graph(),c=Object.assign({relation:[],way:[],node:[]},yr(r,"type")),u=[],d={},h,p;for(p=0;p<c.relation.length;p++)h=c.relation[p],!d[h.id]&&h.isComplete(l)&&(u.push(h.id),d=a(h.id,l,d));for(p=0;p<c.way.length;p++)h=c.way[p],d[h.id]||(u.push(h.id),d=a(h.id,l,d));for(p=0;p<c.node.length;p++)h=c.node[p],d[h.id]||u.push(h.id);t.copyIDs(u),s&&(u.length!==1||l.entity(u[0]).type!=="node")?t.copyLoc(t.projection.invert(s)):t.copyLoc(null)};function a(l,c,u){let d=c.entity(l),h;u=u||{},d.type==="relation"?h=d.members.map(p=>p.id):d.type==="way"?h=d.nodes:h=[];for(let p=0;p<h.length;p++)u[h[p]]||(u[h[p]]=!0,u=a(h[p],c,u));return u}return o.available=function(){return r.length>0},o.disabled=function(){if(!i&&l())return"too_large";return!1;function l(){return!(ee("rapid-internal-feature.allowLargeEdits")==="true")&&n.percentContainedIn(t.map().extent())<.8}},o.availableForKeypress=function(){let l=window.getSelection&&window.getSelection();return!l||!l.toString()},o.tooltip=function(){let l=o.disabled();return l?S(`operations.copy.${l}`,{n:e.length}):S("operations.copy.description",{n:e.length})},o.annotation=function(){return S("operations.copy.annotation",{n:e.length})},o.point=function(l){return s=l,o},o.id="copy",o.keys=[et("\u2318C")],o.title=S("operations.copy.title"),o.behavior=new Ft(t,o),o}function on(t,e){let r=e.length===1?"single":"multiple",i=e.map(u=>t.hasEntity(u)).filter(Boolean),n=i.every(u=>u.isNew()),s=ea(e),a=dr(e,t.graph()).map(u=>u.loc),l=vt(i,t.graph()),c=function(){let u,d;if(i.length===1){let h=i[0],p=h.geometry(t.graph()),g=t.graph().parentWays(h)[0];if(p==="vertex"){let y=g.nodes,v=y.indexOf(h.id);if(v===0)v++;else if(v===y.length-1)v--;else{let x=Tt(h.loc,t.entity(y[v-1]).loc),_=Tt(h.loc,t.entity(y[v+1]).loc);v=x<_?v-1:v+1}u=y[v],d=t.entity(u).loc}}t.perform(s,c.annotation()),t.validator().validate(),u&&d?t.hasEntity(u)?t.enter(Se(t,[u]).follow(!0)):(t.map().centerEase(d),t.enter("browse")):t.enter("browse")};return c.available=function(){return!0},c.disabled=function(){if(!n&&u())return"too_large";if(!n&&d())return"not_downloaded";if(e.some(t.hasHiddenConnections))return"connected_to_hidden";if(e.some(m))return"part_of_relation";if(e.some(p))return"incomplete_relation";if(e.some(h))return"has_wikidata_tag";return!1;function u(){return!(ee("rapid-internal-feature.allowLargeEdits")==="true")&&l.percentContainedIn(t.map().extent())<.8}function d(){if(t.inIntro())return!1;let g=t.connection();if(g){let y=a.filter(v=>!g.isDataLoaded(v));if(y.length)return y.forEach(v=>t.loadTileAtLoc(v)),!0}return!1}function h(g){let y=t.entity(g);return y.tags.wikidata&&y.tags.wikidata.trim().length>0}function p(g){let y=t.entity(g);return y.type==="relation"&&!y.isComplete(t.graph())}function m(g){let y=t.entity(g);if(y.type!=="way")return!1;let v=t.graph().parentRelations(y);for(let x=0;x<v.length;x++){let _=v[x],b=_.tags.type,w=_.memberById(g).role||"outer";if(b==="route"||b==="boundary"||b==="multipolygon"&&w==="outer")return!0}return!1}},c.tooltip=function(){let u=c.disabled();return u?S(`operations.delete.${u}.${r}`):S(`operations.delete.description.${r}`)},c.annotation=function(){return e.length===1?S("operations.delete.annotation."+t.graph().geometry(e[0])):S("operations.delete.annotation.feature",{n:e.length})},c.id="delete",c.keys=[et("\u2318\u232B"),et("\u2318\u2326"),et("\u2326")],c.title=S("operations.delete.title"),c.behavior=new Ft(t,c),c}function L2(t,e){var r,i=function(n){var s=n.entity(t),o=i.connections(n);return o.forEach(function(a){var l=n.entity(a.wayID),c=je({id:e,loc:s.loc,tags:s.tags});n=n.replace(c),a.index===0&&l.isArea()?n=n.replace(l.replaceNode(l.nodes[0],c.id)):l.isClosed()&&a.index===l.nodes.length-1?n=n.replace(l.unclose().addNode(c.id)):n=n.replace(l.updateNode(c.id,a.index))}),n};return i.connections=function(n){for(var s=[],o=!1,a=n.parentWays(n.entity(t)),l,c,u=0;u<a.length;u++){if(l=a[u],r&&r.indexOf(l.id)===-1){o=!0;continue}if(l.isArea()&&l.nodes[0]===t)s.push({wayID:l.id,index:0});else for(var d=0;d<l.nodes.length;d++)if(c=l.nodes[d],c===t){if(l.isClosed()&&a.length>1&&r&&r.indexOf(l.id)!==-1&&d===l.nodes.length-1)continue;s.push({wayID:l.id,index:d})}}if(o)return s;if(t[1]!=="-"&&s.length>1&&s[0].wayID[1]==="-"){for(var h=1;h<s.length;h++)if(s[h].wayID[1]!=="-")return s.splice(h,1),s}return s.slice(1)},i.disabled=function(n){var s=i.connections(n);if(s.length===0)return"not_connected";var o=n.parentWays(n.entity(t)),a={},l;if(o.forEach(function(c){var u=n.parentRelations(c);u.forEach(function(d){d.id in a?r?(r.indexOf(c.id)!==-1||r.indexOf(a[d.id])!==-1)&&(l=d):l=d:a[d.id]=c.id})}),l)return"relation"},i.limitWays=function(n){return arguments.length?(r=n,i):r},i}function Yp(t,e){let r=e.map(y=>t.hasEntity(y)).filter(Boolean),i=r.every(y=>y.isNew()),n=[],s=[],o=[],a=[];r.forEach(y=>{y.type==="way"?s.push(y.id):y.geometry(t.graph())==="vertex"?n.push(y.id):o.push(y.id)});let l,c="",u="features",d=[],h=[],p=t.graph();if(n.length>0)d=n,n.forEach(y=>{let v=L2(y);if(s.length>0){let x=s.filter(_=>p.entity(_).nodes.indexOf(y)!==-1);v.limitWays(x)}a.push(v),h=h.concat(p.parentWays(p.entity(y)).map(x=>x.id))}),h=$e(h).filter(y=>s.indexOf(y)===-1),c+=a.length===1?"single_point.":"multiple_points.",s.length===1?c+="single_way."+p.geometry(s[0]):c+=s.length===0?"no_ways":"multiple_ways";else if(s.length>0){let y=s.map(E=>p.entity(E)),v=dr(s,p);l=v.map(E=>E.loc);let x=[],_=[],b=[],w=[];v.forEach(E=>{let A=L2(E.id).limitWays(s);if(A.disabled(p)!=="not_connected"){let T=0;for(let k in y)if(y[k].nodes.indexOf(E.id)!==-1&&(T+=1),T>1)break;T>1?(x.push(A),_.push(E)):(b.push(A),w.push(E))}}),c+="no_points.",c+=s.length===1?"single_way.":"multiple_ways.",x.length?(a=x,d=_.map(E=>E.id),c+="conjoined",u="from_each_other"):(a=b,d=w.map(E=>E.id),s.length===1?c+=p.geometry(s[0]):c+="separate")}let m=vt(d,p),g=function(){let y=function(v){return a.forEach(x=>{x.disabled(v)||(v=x(v))}),v};t.perform(y,g.annotation()),t.validator().validate()};return g.relatedEntityIds=function(){return n.length?h:d},g.available=function(){return!(a.length===0||o.length!==0||n.length!==0&&s.length!==0&&!s.every(function(y){return n.some(v=>t.entity(y).nodes.indexOf(v)!==-1)}))},g.disabled=function(){let y;for(let _ of a)if(y=_.disabled(t.graph()),y)return y;if(!i&&v())return"too_large."+((n.length?n:s).length===1?"single":"multiple");if(!i&&l&&x())return"not_downloaded";if(e.some(t.hasHiddenConnections))return"connected_to_hidden";return!1;function v(){return!(ee("rapid-internal-feature.allowLargeEdits")==="true")&&m.percentContainedIn(t.map().extent())<.8}function x(){if(t.inIntro())return!1;let _=t.connection();if(_){let b=l.filter(w=>!_.isDataLoaded(w));if(b.length)return b.forEach(w=>t.loadTileAtLoc(w)),!0}return!1}},g.tooltip=function(){let y=g.disabled();return y?S(`operations.disconnect.${y}`):S(`operations.disconnect.description.${c}`)},g.annotation=function(){return S(`operations.disconnect.annotation.${u}`)},g.id="disconnect",g.keys=[S("operations.disconnect.key")],g.title=S("operations.disconnect.title"),g.behavior=new Ft(t,g),g}function er(t,e){return function(r){var i=r.entity(t);return r.replace(i.update({tags:e}))}}function B2(t,e){let r=0,i=s(e),n=r===1?"single":"multiple";function s(u){let d;r=0;for(let h in u){let p=u[h],m=o(p);m&&(r+=1,d&&m!==d?d!=="generic"&&m!=="generic"?d="building_address":d="generic":d=m)}return d}function o(u){let d=t.graph(),h=d.entity(u),p=xe.match(h,d);if(!p||p.isFallback())return null;if(h.type==="node"&&p.id!=="address"&&Object.keys(h.tags).some(function(g){return g.match(/^addr:.{1,}/)}))return"address";let m=h.geometry(d);return m==="area"&&h.tags.building&&!p.tags.building?"building":m==="vertex"&&Object.keys(h.tags).length?"generic":null}let a=/architect|building|height|layer|nycdoitt:bin|source|type|wheelchair|roof/i,l=["source"],c=function(){t.perform(function(u){for(let d in e){let h=e[d],p=o(h);if(!p)continue;let m=Object.assign({},u.entity(h).tags);for(let g in m)p==="address"&&l.indexOf(g)!==-1||p==="building"&&a.test(g)||p!=="generic"&&(g.match(/^addr:.{1,}/)||g.match(/^source:.{1,}/))||delete m[g];u=er(h,m)(u)}return u},c.annotation()),t.validator().validate(),t.enter(Se(t,e))};return c.available=function(){return i},c.disabled=function(){if(e.some(u))return"has_wikidata_tag";return!1;function u(d){let h=t.entity(d);return h.tags.wikidata&&h.tags.wikidata.trim().length>0}},c.tooltip=function(){let u=c.disabled();return u?S(`operations.downgrade.${u}.${n}`):S(`operations.downgrade.description.${i}`)},c.annotation=function(){let u;return i==="building_address"?u="generic":u=i,S(`operations.downgrade.annotation.${u}`,{n:r})},c.id="downgrade",c.keys=[et("\u232B")],c.title=S("operations.downgrade.title"),c.behavior=new Ft(t,c),c}function n0(t,e){let r,i=function(o){let a=o.entity(t);return a.type==="node"?n(a,o):s(a,o)};function n(o,a){r=o.id;let l=je({loc:o.loc});a=a.replace(l);for(let c of a.parentWays(o))a=a.replace(c.replaceNode(t,l.id));for(let c of a.parentRelations(o))a=a.replace(c.replaceMember(o,l));return a}function s(o,a){let l=o.geometry(a),c=["source","wheelchair"],u=["area"],d=/architect|building|height|layer|nycdoitt:bin|roof/i,h=o.asGeoJSON(a),m=(h.type==="LineString"?h.coordinates:h.type==="Polygon"?h.coordinates[0]:h.type==="MultiPolygon"?h.coordinates[0][0]:[]).map(A=>e.project(A)),g;if(m.length)m.length===1?g=m[0]:m.length===2?g=Ct(m[0],m[1],.5):g=yn(m);else return a;let y=e.invert(g);(!y||!isFinite(y[0])||!isFinite(y[1]))&&(y=o.extent(a).center());let v={area:!0,corridor:!0,elevator:!0,level:!0,room:!0},x=o.tags.building&&o.tags.building!=="no"||o.tags["building:part"]&&o.tags["building:part"]!=="no",_=l==="area"&&o.tags.indoor&&v[o.tags.indoor],b=Object.assign({},o.tags),w={};for(let A in b)o.type==="relation"&&A==="type"||u.indexOf(A)===-1&&(_&&A==="indoor"||x&&d.test(A)||(w[A]=b[A],!(c.indexOf(A)!==-1||A.match(/^addr:.{1,}/))&&(_&&A==="level"||delete b[A])));!x&&!_&&l==="area"&&(b.area="yes");let E=je({loc:y,tags:w});return a=a.replace(E),r=E.id,a.replace(o.update({tags:b}))}return i.getExtractedNodeID=function(){return r},i}function Qp(t,e){let r=e.length===1?"single":"multiple",i=e.map(u=>t.hasEntity(u)).filter(Boolean),n=i.every(u=>u.isNew()),s=vt(i,t.graph()),o=$e(i.map(u=>u.geometry(t.graph()))),a=o.length===1?o[0]:"feature",l=i.map(u=>{if(!u.hasInterestingTags())return null;let d=t.graph();return u.type==="node"&&d.parentWays(u).length===0||u.type!=="node"&&xe.match(u,d).geometry.indexOf("point")===-1?null:n0(u.id,t.projection)}).filter(Boolean),c=function(){let u=function(h){return l.forEach(p=>{p.disabled(h)||(h=p(h))}),h};t.perform(u,c.annotation()),t.validator().validate();let d=l.map(h=>h.getExtractedNodeID());t.enter(Se(t,d))};return c.available=function(){return l.length&&e.length===l.length},c.disabled=function(){if(!n&&u())return"too_large";if(e.some(d=>t.graph().geometry(d)==="vertex"&&t.hasHiddenConnections(d)))return"connected_to_hidden";return!1;function u(){return!(ee("rapid-internal-feature.allowLargeEdits")==="true")&&s.percentContainedIn(t.map().extent())<.8}},c.tooltip=function(){let u=c.disabled();return u?S(`operations.extract.${u}.${r}`):S(`operations.extract.description.${a}.${r}`)},c.annotation=function(){return S("operations.extract.annotation",{n:e.length})},c.id="extract",c.keys=[S("operations.extract.key")],c.title=S("operations.extract.title"),c.behavior=new Ft(t,c),c}function Md(t){function e(i){var n=t.map(function(s){return i.entity(s)});return Object.assign({line:[]},yr(n,function(s){return s.geometry(i)}))}var r=function(i){var n=t.map(i.entity,i);n.sort(function(h,p){var m=h.isSided(),g=p.isSided();return m&&!g?-1:g&&!m?1:0});let s=(n.filter(h=>!h.isNew()).sort((h,p)=>+h.osmId()-+p.osmId())[0]||n[0]).id;var o=En(n,i),a=o[0];i=o.actions.reduce(function(h,p){return p(h)},i);var l=i.entity(s);l=l.update({nodes:a.nodes.map(function(h){return h.id})}),i=i.replace(l),a.forEach(function(h){h.id!==s&&(i.parentRelations(h).forEach(function(p){i=i.replace(p.replaceMember(h,l))}),l=l.mergeTags(h.tags),i=i.replace(l),i=ps(h.id)(i))});var c=ee("rapid-internal-feature.tagnosticRoadCombine")==="true";if(c&&n.length&&n[0].tags.highway){var u=Object.assign({},l.tags);u.highway=n[0].tags.highway,l=l.update({tags:u}),i=i.replace(l)}function d(){if(l.isClosed()){var h=i.parentMultipolygons(l).filter(function(y){return y.members.length===1});if(h.length===1){var p=h[0];for(var m in l.tags)if(p.tags[m]&&p.tags[m]!==l.tags[m])return;l=l.mergeTags(p.tags),i=i.replace(l),i=Qr(p.id,!0)(i);var g=Object.assign({},l.tags);l.geometry(i)!=="area"&&(g.area="yes"),delete g.type,l=l.update({tags:g}),i=i.replace(l)}}}return d(),i};return r.resultingWayNodesLength=function(i){return t.reduce(function(n,s){return n+i.entity(s).nodes.length},0)-t.length-1},r.disabled=function(i){var n=e(i);if(t.length<2||t.length!==n.line.length)return"not_eligible";var s=En(t.map(i.entity,i),i);if(s.length>1)return"not_adjacent";var o,a=function(_){return i.parentRelations(i.entity(_)).filter(b=>!b.isRestriction()&&!b.isConnectivity()).sort((b,w)=>b.id-w.id)},l=a(t[0]);for(o=1;o<t.length;o++){var c=a(t[o]);if(!ni(l,c))return"conflicting_relations"}for(o=0;o<t.length-1;o++)for(var u=o+1;u<t.length;u++){var d=i.childNodes(i.entity(t[o])).map(function(_){return _.loc}),h=i.childNodes(i.entity(t[u])).map(function(_){return _.loc}),p=$f(d,h),m=Ir(s[0].nodes.map(function(_){return _.loc.toString()}),p.map(function(_){return _.toString()}));if(m.length!==p.length)return"paths_intersect"}var g=s[0].nodes.map(function(_){return _.id}).slice(1,-1),y,v={},x=!1;if(s[0].forEach(function(_){var b=i.parentRelations(_);b.forEach(function(A){(A.isRestriction()||A.isConnectivity())&&A.members.some(function(T){return g.indexOf(T.id)>=0})&&(y=A)});for(var w in _.tags)if(!(w in v))v[w]=_.tags[w];else if(v[w]&&$i(w)&&v[w]!==_.tags[w]){x=!0;var E=ee("rapid-internal-feature.tagnosticRoadCombine")==="true";w==="highway"&&E&&!window.mocha&&(x=!1)}}),y)return y.isRestriction()?"restriction":"connectivity";if(x)return"conflicting_tags"},r}function Pd(t){function e(i){var n=t.map(function(s){return i.entity(s)});return Object.assign({point:[],area:[],line:[],relation:[]},yr(n,function(s){return s.geometry(i)}))}var r=function(i){var n=e(i),s=n.area[0]||n.line[0],o=n.point;if(o.forEach(function(l){s=s.mergeTags(l.tags),i=i.replace(s),i.parentRelations(l).forEach(function(p){i=i.replace(p.replaceMember(l,s))});for(var c=$e(i.childNodes(s)),u=l,d=0;d<c.length;d++){var h=c[d];if(!(i.parentWays(h).length>1||i.parentRelations(h).length||h.hasInterestingTags())){i=i.replace(l.update({tags:{},loc:h.loc})),s=s.replaceNode(h.id,l.id),i=i.replace(s),u=h;break}}i=i.remove(u)}),s.tags.area==="yes"){var a=Object.assign({},s.tags);delete a.area,La(a)&&(s=s.update({tags:a}),i=i.replace(s))}return i};return r.disabled=function(i){var n=e(i);if(n.point.length===0||n.area.length+n.line.length!==1||n.relation.length!==0)return"not_eligible"},r}function n1(t){var e=function(r){var i,n,s,o,a;for(o=0;o<t.length&&(i=r.entity(t[o]),!i.version);o++);for(o=0;o<t.length;o++)if(n=r.entity(t[o]),n.id!==i.id){for(s=r.parentWays(n),a=0;a<s.length;a++)r=r.replace(s[a].replaceNode(n.id,i.id));for(s=r.parentRelations(n),a=0;a<s.length;a++)r=r.replace(s[a].replaceMember(n,i));i=i.mergeTags(n.tags),r=po(n.id)(r)}for(r=r.replace(i),s=r.parentWays(i),o=0;o<s.length;o++)s[o].isDegenerate()&&(r=ps(s[o].id)(r));return r};return e.disabled=function(r){var i={},n=[],s,o,a,l,c,u,d,h,p;for(d=0;d<t.length&&(s=r.entity(t[d]),!s.version);d++);for(d=0;d<t.length;d++)for(o=r.entity(t[d]),l=r.parentRelations(o),h=0;h<l.length;h++){if(c=l[h],u=c.memberById(o.id).role||"",c.hasFromViaTo()&&n.push(c.id),i[c.id]!==void 0&&i[c.id]!==u)return"relation";i[c.id]=u}for(d=0;d<t.length;d++){o=r.entity(t[d]);var m=r.parentWays(o);for(h=0;h<m.length;h++){var g=m[h];for(l=r.parentRelations(g),p=0;p<l.length;p++)c=l[p],c.hasFromViaTo()&&n.push(c.id)}}for(n=$e(n),d=0;d<n.length;d++)if(c=r.entity(n[d]),!!c.isComplete(r)){var y=c.members.filter(function(B){return B.type==="way"}).map(function(B){return r.entity(B.id)});y=$e(y);var v=c.memberByRole("from"),x=c.memberByRole("to"),_=v.id===x.id,b={from:[],via:[],to:[],keyfrom:[],keyto:[]};for(h=0;h<c.members.length;h++)L(c.members[h],b);b.keyfrom=$e(b.keyfrom.filter(D)),b.keyto=$e(b.keyto.filter(D));var w=F(b.keyfrom,b.keyto);b.from=b.from.filter(w),b.via=b.via.filter(w),b.to=b.to.filter(w);var E=!1,A=!1,T=!1,k=!1,C=!1;for(h=0;h<t.length;h++){var I=t[h];b.from.indexOf(I)!==-1&&(E=!0),b.via.indexOf(I)!==-1&&(A=!0),b.to.indexOf(I)!==-1&&(T=!0),b.keyfrom.indexOf(I)!==-1&&(k=!0),b.keyto.indexOf(I)!==-1&&(C=!0)}if(E&&T&&!_||E&&A||T&&A)return"restriction";if(k||C){if(t.length!==2)return"restriction";var P=null,N=null;for(h=0;h<y.length;h++)a=y[h],a.contains(t[0])&&(P=t[0]),a.contains(t[1])&&(N=t[1]);if(P&&N){var M=!1;for(h=0;h<y.length;h++)if(a=y[h],a.areAdjacent(P,N)){M=!0;break}if(!M)return"restriction"}}for(h=0;h<y.length;h++){for(a=y[h].update({}),p=0;p<t.length;p++)t[p]!==s.id&&(a.areAdjacent(t[p],s.id)?a=a.removeNode(t[p]):a=a.replaceNode(t[p],s.id));if(a.isDegenerate())return"restriction"}}return!1;function D(B,O,R){return R.indexOf(B)!==R.lastIndexOf(B)}function F(B,O){return function(R){return B.indexOf(R)===-1&&O.indexOf(R)===-1}}function L(B,O){var R=r.hasEntity(B.id);if(R){var U=B.role||"";O[U]||(O[U]=[]),B.type==="node"?(O[U].push(B.id),U==="via"&&(O.keyfrom.push(B.id),O.keyto.push(B.id))):B.type==="way"&&(O[U].push.apply(O[U],R.nodes),(U==="from"||U==="via")&&(O.keyfrom.push(R.first()),O.keyfrom.push(R.last())),(U==="to"||U==="via")&&(O.keyto.push(R.first()),O.keyto.push(R.last())))}}},e}function $n(t,e){function r(n){if(!t.length)return null;for(var s=[0,0],o=0,a,l=0;l<t.length;l++){var c=n.entity(t[l]);c.hasInterestingTags()&&(a=++o===1?c.loc:null),s=Ot(s,c.loc)}return a||Yi(s,1/t.length)}var i=function(n){if(t.length<2)return n;var s=e;s||(s=r(n));for(var o=0;o<t.length;o++){var a=n.entity(t[o]);a.loc!==s&&(n=n.replace(a.move(s)))}return n1(t)(n)};return i.disabled=function(n){if(t.length<2)return"not_eligible";for(var s=0;s<t.length;s++){var o=n.entity(t[s]);if(o.type!=="node")return"not_eligible"}return n1(t).disabled(n)},i}function Rd(t,e){function r(n){var s=t.map(function(a){return n.entity(a)}),o=yr(s,function(a){return a.type==="way"&&a.isClosed()?"closedWay":a.type==="relation"&&a.isMultipolygon()?"multipolygon":"other"});return Object.assign({closedWay:[],multipolygon:[],other:[]},o)}var i=function(n){for(var s=r(n),o=s.multipolygon.reduce(function(m,g){return m.concat(En(g.members,n))},[]).concat(s.closedWay.map(function(m){var g=[{id:m.id}];return g.nodes=n.childNodes(m),g})),a=o.map(function(m,g){return o.map(function(y,v){return g===v?null:jf(y.nodes.map(function(x){return x.loc}),m.nodes.map(function(x){return x.loc}))})}),l=[],c=!0;o.length;)h(o),o=o.filter(u),a=a.filter(u).map(d);function u(m,g){return a[g].some(function(y){return y})}function d(m){return m.filter(u)}function h(m){m.forEach(function(g,y){u(g,y)||g.forEach(function(v){l.push({type:"way",id:v.id,role:c?"outer":"inner"})})}),c=!c}var p=s.multipolygon[0]||Cr({id:e,tags:{type:"multipolygon"}});return s.multipolygon.slice(1).forEach(function(m){p=p.mergeTags(m.tags),n=n.remove(m)}),s.closedWay.forEach(function(m){function g(y){return y.id===m.id&&y.role!=="inner"}l.some(g)&&(p=p.mergeTags(m.tags),n=n.replace(m.update({tags:{}})))}),n.replace(p.update({members:l,tags:Fi(p.tags,["area"])}))};return i.disabled=function(n){var s=r(n);if(s.other.length>0||s.closedWay.length+s.multipolygon.length<2)return"not_eligible";if(!s.multipolygon.every(function(a){return a.isComplete(n)}))return"incomplete_relation";if(s.multipolygon.length){if(s.closedWay.some(function(a){return Ir(n.parentMultipolygons(a),s.multipolygon).length}))return"not_eligible"}else{var o=[];if(s.closedWay.forEach(function(a,l){l===0?o=n.parentMultipolygons(a):o=Ir(o,n.parentMultipolygons(a))}),o=o.filter(function(a){return a.members.length===s.closedWay.length}),o.length)return"not_eligible"}},i}function Kp(t,e){let r=i();function i(){let s=Md(e);if(!s.disabled(t.graph()))return s;let o=Pd(e);if(!o.disabled(t.graph()))return o;let a=Rd(e);if(!a.disabled(t.graph()))return a;let l=$n(e);return l.disabled(t.graph())?s.disabled(t.graph())!=="not_eligible"?s:o.disabled(t.graph())!=="not_eligible"?o:a.disabled(t.graph())!=="not_eligible"?a:l:l}let n=function(){if(n.disabled())return;t.perform(r,n.annotation()),t.validator().validate();let s=e.filter(o=>t.hasEntity(o));if(s.length>1){let o=s.filter(a=>t.entity(a).hasInterestingTags());o.length&&(s=o)}t.enter(Se(t,s))};return n.available=function(){return e.length>=2},n.disabled=function(){let s=r.disabled(t.graph());if(s)return s;let o=t.connection();return o&&r.resultingWayNodesLength&&r.resultingWayNodesLength(t.graph())>o.maxWayNodes()?"too_many_vertices":!1},n.tooltip=function(){let s=n.disabled();if(s){if(s==="conflicting_relations")return S("operations.merge.conflicting_relations");if(s==="restriction"||s==="connectivity"){let o=xe.item("type/"+s);return S("operations.merge.damage_relation",{relation:o.name()})}else return S(`operations.merge.${s}`)}else return S("operations.merge.description")},n.annotation=function(){return S("operations.merge.annotation",{n:e.length})},n.id="merge",n.keys=[S("operations.merge.key")],n.title=S("operations.merge.title"),n.behavior=new Ft(t,n),n}function Zp(t,e){let r=e.length===1?"single":"multiple",i=e.map(c=>t.hasEntity(c)).filter(Boolean),n=i.every(c=>c.isNew()),o=dr(e,t.graph()).map(c=>c.loc),a=vt(i,t.graph()),l=function(){let c=new Map;for(let u of e)c.set(u,t.entity(u));t.enter("move",{selection:c})};return l.available=function(){return i.length>0},l.disabled=function(){if(!n&&c())return"too_large";if(!n&&u())return"not_downloaded";if(e.some(t.hasHiddenConnections))return"connected_to_hidden";if(i.some(d))return"incomplete_relation";return!1;function c(){return!(ee("rapid-internal-feature.allowLargeEdits")==="true")&&a.percentContainedIn(t.map().extent())<.8}function u(){if(t.inIntro())return!1;let h=t.connection();if(h){let p=o.filter(m=>!h.isDataLoaded(m));if(p.length)return p.forEach(m=>t.loadTileAtLoc(m)),!0}return!1}function d(h){return h.type==="relation"&&!h.isComplete(t.graph())}},l.tooltip=function(){let c=l.disabled();return c?S(`operations.move.${c}.${r}`):S(`operations.move.description.${r}`)},l.annotation=function(){return e.length===1?S("operations.move.annotation."+t.graph().geometry(e[0])):S("operations.move.annotation.feature",{n:e.length})},l.id="move",l.keys=[S("operations.move.key")],l.title=S("operations.move.title"),l.behavior=new Ft(t,l),l.mouseOnly=!0,l}function Ka(t,e,r,i,n){var s=n||1e-4,o=i||13,a=Math.cos((90-o)*Math.PI/180),l=Math.cos(o*Math.PI/180),c=function(d,h){(h===null||!isFinite(h))&&(h=1),h=Math.min(Math.max(+h,0),1);var p=d.entity(t);if(p=p.removeNode(""),p.tags.nonsquare){var m=Object.assign({},p.tags);delete m.nonsquare,p=p.update({tags:m})}d=d.replace(p);var g=p.isClosed(),y=d.childNodes(p).slice();if(g&&y.pop(),r!==void 0&&(y=u(y,r,g),y.length!==3))return d;var v={},x=[],_={i:0,dotp:1},b,w,E,A,T,k,C;for(k=0;k<y.length;k++)b=y[k],v[b.id]=(v[b.id]||0)+1,x.push({id:b.id,coord:e.project(b.loc)});if(x.length===3){for(k=0;k<1e3&&(T=x.map(G),x[_.i].coord=Ot(x[_.i].coord,T[_.i]),A=_.dotp,!(A<s));k++);b=d.entity(y[_.i].id),E=e.invert(x[_.i].coord),d=d.replace(b.move(Ct(b.loc,E,h)))}else{var I=[],P=[];for(k=0;k<x.length;k++){w=x[k];var N=0;if(g||k>0&&k<x.length-1){var M=x[(k-1+x.length)%x.length],D=x[(k+1)%x.length];N=Math.abs(i1(M.coord,D.coord,w.coord))}N>l?I.push(w):P.push(w)}var F=U(P),L=U(P);for(A=1/0,k=0;k<1e3;k++){for(T=P.map(G),C=0;C<T.length;C++)P[C].coord=Ot(P[C].coord,T[C]);var B=kd(P,g,s,o);if(B<A&&(F=U(P),A=B),A<s)break}var O=F.map(function($){return $.coord});for(g&&O.push(O[0]),k=0;k<F.length;k++)w=F[k],pt(L[k].coord,w.coord)||(b=d.entity(w.id),E=e.invert(w.coord),d=d.replace(b.move(Ct(b.loc,E,h))));for(k=0;k<I.length;k++)if(w=I[k],!(v[w.id]>1))if(b=d.entity(w.id),h===1&&d.parentWays(b).length===1&&d.parentRelations(b).length===0&&!b.hasInterestingTags())d=po(b.id)(d);else{var R=Db(w.coord,O);R&&(E=e.invert(R.target),d=d.replace(b.move(Ct(b.loc,E,h))))}}return d;function U($){return $.map(function(q){return{id:q.id,coord:[q.coord[0],q.coord[1]]}})}function G($,q,ie){if(!g&&(q===0||q===ie.length-1))return[0,0];if(v[ie[q].id]>1)return[0,0];var Q=ie[(q-1+ie.length)%ie.length].coord,re=$.coord,ve=ie[(q+1)%ie.length].coord,de=St(Q,re),we=St(ve,re),ne=2*Math.min(ut(de),ut(we));de=Mc(de),we=Mc(we);var Ie=de[0]*we[0]+de[1]*we[1],at=Math.abs(Ie);if(at<a){_.i=q,_.dotp=at;var Et=Mc(Ot(de,we));return Yi(Et,.1*Ie*ne)}return[0,0]}};function u(d,h,p){for(var m=p?0:1,g=p?d.length:d.length-1,y=m;y<g;y++)if(d[y].id===h)return[d[(y-1+d.length)%d.length],d[y],d[(y+1)%d.length]];return[]}return c.disabled=function(d){var h=d.entity(t);h=h.removeNode(""),d=d.replace(h);var p=h.isClosed(),m=d.childNodes(h).slice();p&&m.pop();var g=!1;if(r!==void 0&&(g=!0,m=u(m,r,p),m.length!==3))return"end_vertex";var y=m.map(function(x){return e.project(x.loc)}),v=i0(y,p,s,o,g);return v===null?"not_squarish":v===0?"square_enough":!1},c.transitionable=!0,c}function Jp(t,e){let r=e.length===1?"single":"multiple",i=e.map(d=>t.hasEntity(d)).filter(Boolean),n=i.every(d=>d.isNew()),s=vt(i,t.graph()),o,a=i.map(c).filter(Boolean),l=dr(e,t.graph()).map(d=>d.loc);function c(d){let h=t.graph(),p=d.geometry(h);if(d.type==="way"&&new Set(d.nodes).size>2)return o&&o!=="feature"?null:(o="feature",Ka(d.id,t.projection));if(p==="vertex"){if(o&&o!=="corner")return null;o="corner";let m=h.parentWays(d);if(m.length===1){let g=m[0];if(g.nodes.indexOf(d.id)!==-1)return Ka(g.id,t.projection,d.id)}}return null}let u=function(){if(!a.length)return;let d=function(h,p){return a.forEach(m=>{m.disabled(h)||(h=m(h,p))}),h};d.transitionable=!0,t.perform(d,u.annotation()),window.setTimeout(()=>t.validator().validate(),300)};return u.available=function(){return a.length&&e.length===a.length},u.disabled=function(){if(!a.length)return"";let d=a.map(m=>m.disabled(t.graph())).filter(Boolean);if(d.length===a.length)return new Set(d).size>1?"multiple_blockers":d[0];if(!n&&h())return"too_large";if(!n&&p())return"not_downloaded";if(e.some(t.hasHiddenConnections))return"connected_to_hidden";return!1;function h(){return!(ee("rapid-internal-feature.allowLargeEdits")==="true")&&s.percentContainedIn(t.map().extent())<.8}function p(){if(t.inIntro())return!1;let m=t.connection();if(m){let g=l.filter(y=>!m.isDataLoaded(y));if(g.length)return g.forEach(y=>t.loadTileAtLoc(y)),!0}return!1}},u.tooltip=function(){let d=u.disabled();return d?S(`operations.orthogonalize.${d}.${r}`):S(`operations.orthogonalize.description.${o}.${r}`)},u.annotation=function(){return S("operations.orthogonalize.annotation."+o,{n:a.length})},u.id="orthogonalize",u.keys=[S("operations.orthogonalize.key")],u.title=S("operations.orthogonalize.title"),u.behavior=new Ft(t,u),u}function s0(t,e){var r={},i=function(n){t.forEach(function(o){e.entity(o).copy(e,r)});for(var s in r)n=n.replace(r[s]);return n};return i.copies=function(){return r},i}function Za(t,e,r,i){var n=e;function s(h){function p(y){if(t.indexOf(y)!==-1)return!0;var v=h.parentWays(h.entity(y));if(v.length<3)return!0;var x=v.every(function(_){return i.moving[_.id]});return x||delete i.moving[y],x}function m(y){for(var v=0;v<y.length;v++){var x=y[v];if(!i.moving[x]){i.moving[x]=!0;var _=h.hasEntity(x);_&&(_.type==="node"?(i.nodes.push(x),i.startLoc[x]=_.loc):_.type==="way"?(i.ways.push(x),m(_.nodes)):m(_.members.map(function(b){return b.id})))}}}function g(y){function v(P,N){return!P.isClosed()&&!!P.affix(N)}for(var x=0;x<y.length;x++)for(var _=y[x],b=h.childNodes(h.entity(_)),w=0;w<b.length;w++){var E=b[w],A=h.parentWays(E);if(A.length===2){for(var T=h.entity(_),k=null,C=0;C<A.length;C++){var I=A[C];if(!i.moving[I.id]){k=I;break}}k&&(Ir(T.nodes,k.nodes).length>2||T.isArea()||k.isArea()||i.intersections.push({nodeId:E.id,movedId:T.id,unmovedId:k.id,movedIsEP:v(T,E.id),unmovedIsEP:v(k,E.id)}))}}}i||(i={}),i.ok||(i.moving={},i.intersections=[],i.replacedVertex={},i.startLoc={},i.nodes=[],i.ways=[],m(t),g(i.ways),i.nodes=i.nodes.filter(p),i.ok=!0)}function o(h,p,m,g){var y=m.entity(p),v=m.entity(h),x=y.nodes.indexOf(h),_,b,w;y.isClosed()?(_=y.nodes.length-1,b=(x+_-1)%_,w=(x+_+1)%_):(_=y.nodes.length,b=x-1,w=x+1);var E=m.hasEntity(y.nodes[b]),A=m.hasEntity(y.nodes[w]);if(!E||!A)return m;var T=p+"_"+h,k=i.replacedVertex[T];k||(k=je(),i.replacedVertex[T]=k,i.startLoc[k.id]=i.startLoc[h]);var C,I;g?(C=r.project(i.startLoc[h]),I=r.invert(Ot(C,g))):I=i.startLoc[h],k=k.move(I);var P=r.project(k.loc),N=r.project(E.loc),M=r.project(A.loc),D=Math.abs(vr(P,N)-vr(P,M))*(180/Math.PI);if(D>175&&D<185)return m;var F=[E.loc,k.loc,v.loc,A.loc].map(U=>r.project(U)),L=[E.loc,v.loc,k.loc,A.loc].map(U=>r.project(U)),B=L8(F),O=L8(L),R=B<=O?x:w;return y.isClosed()&&R===0&&(R=_),y=y.addNode(k.id,R),m.replace(k).replace(y)}function a(h,p){var m=p.entity(h),g=1e-6,y,v;function x(b,w){return w.parentWays(b).length>1||w.parentRelations(b).length||b.hasInterestingTags()}for(var _=0;_<m.nodes.length;_++)v=p.entity(m.nodes[_]),y&&v&&pt(y.loc,v.loc,g)&&(x(y,p)?x(v,p)||(m=m.removeNode(v.id),p=p.replace(m).remove(v)):(m=m.removeNode(y.id),p=p.replace(m).remove(y))),y=v;return p}function l(h,p){var m=p.entity(h.nodeId),g=p.entity(h.movedId),y=p.entity(h.unmovedId),v=h.movedIsEP,x=h.unmovedIsEP;if(v&&x)return p;var _=p.childNodes(g).filter(function(I){return I!==m}),b=p.childNodes(y).filter(function(I){return I!==m});g.isClosed()&&g.first()===m.id&&_.push(_[0]),y.isClosed()&&y.first()===m.id&&b.push(b[0]);var w=!v&&Fr(_,r.project(m.loc),r),E=!x&&Fr(b,r.project(m.loc),r),A;if(!v&&!x)for(var T=1e-6,k=10,C=0;C<k&&(A=Ct(w.loc,E.loc,.5),w=Fr(_,r.project(A),r),E=Fr(b,r.project(A),r),!(Math.abs(w.distance-E.distance)<T));C++);else v?A=E.loc:A=w.loc;return p=p.replace(m.move(A)),!v&&w.index!==g.nodes.indexOf(m.id)&&(g=g.removeNode(m.id).addNode(m.id,w.index),p=p.replace(g)),!x&&E.index!==y.nodes.indexOf(m.id)&&(y=y.removeNode(m.id).addNode(m.id,E.index),p=p.replace(y)),p}function c(h){for(var p=0;p<i.intersections.length;p++){var m=i.intersections[p];h=o(m.nodeId,m.movedId,h,n),h=o(m.nodeId,m.unmovedId,h,null),h=l(m,h),h=a(m.movedId,h),h=a(m.unmovedId,h)}return h}function u(h){function p(C){return Ot(r.project(C),n)}for(var m=0;m<i.intersections.length;m++){var g=i.intersections[m];if(!(g.movedIsEP&&g.unmovedIsEP)&&g.movedIsEP){for(var y=h.entity(g.nodeId),v=r.project(y.loc),x=Ot(v,n),_=h.childNodes(h.entity(g.movedId)),b=_.map(function(C){return p(C.loc)}),w=h.childNodes(h.entity(g.unmovedId)),E=w.map(function(C){return r.project(C.loc)}),A=$f(b,E),T=0;m<A.length;m++)if(!pt(A[T],x)){var k=Fr(w,x,r);n=St(r.project(k.loc),v)}}}}var d=function(h){if(n[0]===0&&n[1]===0)return h;s(h),i.intersections.length&&u(h);for(var p=0;p<i.nodes.length;p++){var m=h.entity(i.nodes[p]),g=r.project(m.loc),y=Ot(g,n);h=h.replace(m.move(r.invert(y)))}return i.intersections.length&&(h=c(h)),h};return d.delta=function(){return n},d}function U2(t){let e,r=function(){if(!e)return;let i=t.copyIDs();if(!i.length)return;let n=t.projection,s=t.copyGraph(),o=new le,a=[],l=s0(i,s);t.perform(l);let c=l.copies(),u=new Set;Object.values(c).forEach(function(m){u.add(m.id)});for(let m in c){let g=s.entity(m),y=c[m];o=o.extend(g.extent(s)),t.graph().parentWays(y).some(_=>u.has(_.id))||a.push(y.id)}let d=t.copyLoc(),h=d&&n.project(d)||n.project(o.center()),p=St(e,h);t.replace(Za(a,p,n),r.annotation()),t.enter(Se(t,a))};return r.point=function(i){return e=i,r},r.available=function(){return t.mode().id==="browse"},r.disabled=function(){return!t.copyIDs().length},r.tooltip=function(){let i=t.copyGraph(),n=t.copyIDs();return n.length?S("operations.paste.description",{feature:ft(i.entity(n[0]),i),n:n.length}):S("operations.paste.nothing_copied")},r.annotation=function(){let i=t.copyIDs();return S("operations.paste.annotation",{n:i.length})},r.id="paste",r.keys=[et("\u2318V")],r.title=S("operations.paste.title"),r}function Nd(t,e){var r=!0,i=function(n,s){(s===null||!isFinite(s))&&(s=1),s=Math.min(Math.max(+s,0),1);var o=dr(t,n),a=o.map(function(k){return e.project(k.loc)}),l=Rc(a),c=[(l.poly[0][0]+l.poly[1][0])/2,(l.poly[0][1]+l.poly[1][1])/2],u=[(l.poly[2][0]+l.poly[3][0])/2,(l.poly[2][1]+l.poly[3][1])/2],d=[(l.poly[3][0]+l.poly[4][0])/2,(l.poly[3][1]+l.poly[4][1])/2],h=[(l.poly[1][0]+l.poly[2][0])/2,(l.poly[1][1]+l.poly[2][1])/2],p,m,g=ut(c,u)>ut(d,h);r&&g||!r&&!g?(p=c,m=u):(p=d,m=h);for(var y=m[0]-p[0],v=m[1]-p[1],x=(y*y-v*v)/(y*y+v*v),_=2*y*v/(y*y+v*v),b=0;b<o.length;b++){var w=o[b],E=e.project(w.loc),A=[x*(E[0]-p[0])+_*(E[1]-p[1])+p[0],_*(E[0]-p[0])-x*(E[1]-p[1])+p[1]],T=e.invert(A);w=w.move(Ct(w.loc,T,s)),n=n.replace(w)}return n};return i.useLongAxis=function(n){return arguments.length?(r=n,i):r},i.transitionable=!0,i}function em(t,e){return xS(t,e,"short")}function tm(t,e){return xS(t,e,"long")}function xS(t,e,r="long"){let i=e.length===1?"single":"multiple",n=e.map(u=>t.hasEntity(u)).filter(Boolean),s=n.every(u=>u.isNew()),o=vt(n,t.graph()),a=dr(e,t.graph()),l=a.map(u=>u.loc),c=function(){let u=Nd(e,t.projection).useLongAxis(r==="long");t.perform(u,c.annotation()),window.setTimeout(()=>t.validator().validate(),300)};return c.available=function(){return a.length>=3},c.disabled=function(){if(!s&&u())return"too_large";if(!s&&d())return"not_downloaded";if(e.some(t.hasHiddenConnections))return"connected_to_hidden";if(n.some(h))return"incomplete_relation";return!1;function u(){return!(ee("rapid-internal-feature.allowLargeEdits")==="true")&&o.percentContainedIn(t.map().extent())<.8}function d(){if(t.inIntro())return!1;let p=t.connection();if(p){let m=l.filter(g=>!p.isDataLoaded(g));if(m.length)return m.forEach(g=>t.loadTileAtLoc(g)),!0}return!1}function h(p){return p.type==="relation"&&!p.isComplete(t.graph())}},c.tooltip=function(){let u=c.disabled();return u?S(`operations.reflect.${u}.${i}`):S(`operations.reflect.description.${r}.${i}`)},c.annotation=function(){return S(`operations.reflect.annotation.${r}.feature`,{n:e.length})},c.id=`reflect-${r}`,c.keys=[S(`operations.reflect.key.${r}`)],c.title=S(`operations.reflect.title.${r}`),c.behavior=new Ft(t,c),c}function rm(t,e){let r=e.map(n).filter(Boolean),i=s();function n(a){let l=t.hasEntity(a);if(!l)return null;let c=l.geometry(t.graph());if(l.type!=="node"&&c!=="line")return null;let u=os(a);return u.disabled(t.graph())?null:u}function s(){let a=r.filter(l=>t.hasEntity(l.entityID())?.type==="node").length;return a===0?"line":a===r.length?"point":"feature"}let o=function(){if(!r.length)return;let a=function(l){for(let c of r)l=c(l);return l};t.perform(a,o.annotation()),t.validator().validate()};return o.available=function(){return r.length>0},o.disabled=function(){return!1},o.tooltip=function(){return S(`operations.reverse.description.${i}`)},o.annotation=function(){return S(`operations.reverse.annotation.${i}`,{n:r.length})},o.id="reverse",o.keys=[S("operations.reverse.key")],o.title=S("operations.reverse.title"),o.behavior=new Ft(t,o),o}function im(t,e){let r=e.length===1?"single":"multiple",i=e.map(c=>t.hasEntity(c)).filter(Boolean),n=i.every(c=>c.isNew()),s=vt(i,t.graph()),o=dr(e,t.graph()),a=o.map(c=>c.loc),l=function(){let c=new Map;for(let u of e)c.set(u,t.entity(u));t.enter("rotate",{selection:c})};return l.available=function(){return o.length>=2},l.disabled=function(){if(!n&&c())return"too_large";if(!n&&u())return"not_downloaded";if(e.some(t.hasHiddenConnections))return"connected_to_hidden";if(i.some(d))return"incomplete_relation";return!1;function c(){return!(ee("rapid-internal-feature.allowLargeEdits")==="true")&&s.percentContainedIn(t.map().extent())<.8}function u(){if(t.inIntro())return!1;let h=t.connection();if(h){let p=a.filter(m=>!h.isDataLoaded(m));if(p.length)return p.forEach(m=>t.loadTileAtLoc(m)),!0}return!1}function d(h){return h.type==="relation"&&!h.isComplete(t.graph())}},l.tooltip=function(){let c=l.disabled();return c?S(`operations.rotate.${c}.${r}`):S(`operations.rotate.description.${r}`)},l.annotation=function(){return e.length===1?S("operations.rotate.annotation."+t.graph().geometry(e[0])):S("operations.rotate.annotation.feature",{n:e.length})},l.id="rotate",l.keys=[S("operations.rotate.key")],l.title=S("operations.rotate.title"),l.behavior=new Ft(t,l),l.mouseOnly=!0,l}function nm(t,e){let r=t.graph(),i=e.map(g=>t.hasEntity(g)).filter(Boolean),n=i.filter(g=>g.type==="node"&&g.geometry(r)==="vertex"),s=n.map(g=>g.id),o=s.length===1?"single":"multiple",a=i.filter(g=>g.type==="way"),l=a.map(g=>g.id),c=n.length>0&&n.length+a.length===e.length,u=ta(s),d="feature",h=[],p="single";if(c){l.length&&u.limitWays(l),h=u.ways(r);let g=new Set;for(let y of h)g.add(y.geometry(r));g.size===1&&(d=Array.from(g)[0]),p=h.length===1?"single":"multiple"}let m=function(){let g=t.perform(u,m.annotation());t.validator().validate();let y=s.slice();for(let[v,x]of g.changes){let _=x.head;_&&_.type==="way"&&y.push(v)}t.enter(Se(t,y))};return m.relatedEntityIds=function(){return h.map(g=>g.id)},m.available=function(){return c},m.disabled=function(){let g=u.disabled(t.graph());return g||(e.some(t.hasHiddenConnections)?"connected_to_hidden":!1)},m.tooltip=function(){let g=m.disabled();return g?S(`operations.split.${g}`):S(`operations.split.description.${d}.${p}.${o}_node`)},m.annotation=function(){return S(`operations.split.annotation.${d}`,{n:h.length})},m.id="split",m.keys=[S("operations.split.key")],m.title=S("operations.split.title"),m.behavior=new Ft(t,m),m}function Dd(t,e){function r(s,o,a){return us(s,a,o)/us(a,a,o)}function i(s){var o=Rc(s),a=[(o.poly[0][0]+o.poly[1][0])/2,(o.poly[0][1]+o.poly[1][1])/2],l=[(o.poly[2][0]+o.poly[3][0])/2,(o.poly[2][1]+o.poly[3][1])/2],c=[(o.poly[3][0]+o.poly[4][0])/2,(o.poly[3][1]+o.poly[4][1])/2],u=[(o.poly[1][0]+o.poly[2][0])/2,(o.poly[1][1]+o.poly[2][1])/2],d=ut(a,l)>ut(c,u);return d?[a,l]:[c,u]}var n=function(s,o){(o===null||!isFinite(o))&&(o=1),o=Math.min(Math.max(+o,0),1);for(var a=t.map(function(x){return s.entity(x)}),l=a.map(function(x){return e.project(x.loc)}),c=i(l),u=c[0],d=c[1],h=0;h<l.length;h++){var p=a[h],m=l[h],g=r(m,u,d),y=Ct(u,d,g),v=e.invert(y);s=s.replace(p.move(Ct(p.loc,v,o)))}return s};return n.disabled=function(s){for(var o=t.map(function(v){return s.entity(v)}),a=o.map(function(v){return e.project(v.loc)}),l=i(a),c=l[0],u=l[1],d=0,h=0;h<a.length;h++){var p=a[h],m=r(p,c,u),g=Ct(c,u,m),y=ut(g,p);!isNaN(y)&&y>d&&(d=y)}if(d<1e-4)return"straight_enough"},n.transitionable=!0,n}function Fd(t,e){function r(o,a,l){return us(o,l,a)/us(l,l,a)}function i(o){for(var a=[],l=[],c=[],u=[],d=t.filter(function(w){return o.entity(w).type==="way"}),h=t.filter(function(w){return o.entity(w).type==="node"}),p=0;p<d.length;p++){var m=o.entity(d[p]);a=m.nodes.slice(0),u.push(a),l.push(a[0]),c.push(a[a.length-1])}l=l.filter(function(w){return l.indexOf(w)===l.lastIndexOf(w)}),c=c.filter(function(w){return c.indexOf(w)===c.lastIndexOf(w)});var g=si(l,c).concat(si(c,l))[0],y=[];a=[];for(var v=function(w,E){return E.filter(function(A){return A[0]===w||A[A.length-1]===w})[0]};u.length;)y=v(g,u),u=si(u,[y]),y[0]!==g&&y.reverse(),a=a.concat(y),g=a[a.length-1];if(h.length===2){var x=a.indexOf(h[0]),_=a.indexOf(h[1]),b=[x,_];b.sort(function(w,E){return w-E}),a=a.slice(b[0],b[1]+1)}return a.map(function(w){return o.entity(w)})}function n(o,a){return a.parentWays(o).length>1||a.parentRelations(o).length||o.hasInterestingTags()}var s=function(o,a){(a===null||!isFinite(a))&&(a=1),a=Math.min(Math.max(+a,0),1);var l=i(o),c=l.map(function(_){return e.project(_.loc)}),u=c[0],d=c[c.length-1],h=[],p;for(p=1;p<c.length-1;p++){var m=l[p],g=c[p];if(a<1||n(m,o)){var y=r(g,u,d),v=Ct(u,d,y),x=e.invert(v);o=o.replace(m.move(Ct(m.loc,x,a)))}else h.indexOf(m)===-1&&h.push(m)}for(p=0;p<h.length;p++)o=po(h[p].id)(o);return o};return s.disabled=function(o){var a=i(o),l=a.map(function(_){return e.project(_.loc)}),c=l[0],u=l[l.length-1],d=.2*ut(c,u),h;if(d===0)return"too_bendy";var p=0;for(h=1;h<l.length-1;h++){var m=l[h],g=r(m,c,u),y=Ct(c,u,g),v=ut(y,m);if(isNaN(v)||v>d)return"too_bendy";v>p&&(p=v)}var x=a.every(function(_,b){return b===0||b===a.length-1||n(_,o)});if(p<1e-4&&x)return"straight_enough"},s.transitionable=!0,s}function sm(t,e){let r=e.map(g=>t.hasEntity(g)).filter(Boolean),i=r.every(g=>g.isNew()),n=r.filter(g=>g.type==="way"),s=n.map(g=>g.id),o=r.filter(g=>g.type==="node"),a=o.map(g=>g.id),l=(n.length?n:o).length===1?"single":"multiple",c=dr(e,t.graph()).map(g=>g.loc),u=vt(e,t.graph()),d,h=p();function p(){if(n.length===0&&o.length>2)return d="point",Dd(a,t.projection);if(n.length>0&&(o.length===0||o.length===2)){let g=[],y=[];for(let x of r)if(x.type==="way"){if(x.type==="way"&&x.isClosed())return null;g.push(x.first()),y.push(x.last())}if(g=g.filter(x=>g.indexOf(x)===g.lastIndexOf(x)),y=y.filter(x=>y.indexOf(x)===y.lastIndexOf(x)),si(g,y).length+si(y,g).length!==2)return null;let v=dr(s,t.graph()).map(x=>x.id);return v.length<=2||a.length===2&&(v.indexOf(a[0])===-1||v.indexOf(a[1])===-1)?null:(a.length&&(u=vt(a,t.graph())),d="line",Fd(e,t.projection))}return null}let m=function(){h&&(t.perform(h,m.annotation()),window.setTimeout(()=>t.validator().validate(),300))};return m.available=function(){return!!h},m.disabled=function(){let g=h.disabled(t.graph());if(g)return g;if(!i&&y())return"too_large";if(!i&&v())return"not_downloaded";if(e.some(t.hasHiddenConnections))return"connected_to_hidden";return!1;function y(){return!(ee("rapid-internal-feature.allowLargeEdits")==="true")&&u.percentContainedIn(t.map().extent())<.8}function v(){if(t.inIntro())return!1;let x=t.connection();if(x){let _=c.filter(b=>!x.isDataLoaded(b));if(_.length)return _.forEach(b=>t.loadTileAtLoc(b)),!0}return!1}},m.tooltip=function(){let g=m.disabled();return g?S(`operations.straighten.${g}.${l}`):S(`operations.straighten.description.${d}`+(n.length===1?"":"s"))},m.annotation=function(){return S(`operations.straighten.annotation.${d}`,{n:n.length?n.length:o.length})},m.id="straighten",m.keys=[S("operations.straighten.key")],m.title=S("operations.straighten.title"),m.behavior=new Ft(t,m),m}function Se(t,e){var r={id:"select",button:"browse"},i=rt("select"),n=[],s=!1,o=!1,a,l;function c(){if(e&&e.length===1)return t.hasEntity(e[0])}function u(){var y=[];if(Array.isArray(e)&&(y=e.filter(function(v){var x=t.hasEntity(v);return!(!x||x.type==="node"&&wt.blocksAt(x.loc).length)})),y.length){if(e.length>1&&y.length===1||e.length===1&&y.length>1)return t.enter(Se(t,y)),!1}else return t.enter("browse"),!1;return e=y,!0}function d(y){for(var v=t.graph(),x=[],_=0;_<e.length;_++){var b=t.hasEntity(e[_]);if(!b||b.geometry(v)!=="vertex")return[];var w=v.parentWays(b).map(function(E){return E.id});if(!x.length){x=w;continue}if(x=(y?Ir:jt)(x,w),!x.length)return[]}return x}function h(y){for(var v=t.graph(),x=[],_=0;_<e.length;_++){var b=t.hasEntity(e[_]);if(!b||!["area","line"].includes(b.geometry(v)))return[];var w=v.childNodes(b).map(function(E){return E.id});if(!x.length){x=w;continue}if(x=(y?Ir:jt)(x,w),!x.length)return[]}return x}function p(){if(a){var y=d(!0);y.indexOf(a)===-1&&(a=null)}}function m(){var y=d(!0);return a&&y.indexOf(a)!==-1?a:y.length?y[0]:null}r.selectedIDs=function(y){return arguments.length?(e=y,r):e},r.newFeature=function(y){return arguments.length?(s=y,r):s},r.selectBehavior=()=>{console.error("error: do not call modeSelect.selectBehavior anymore")},r.follow=function(y){return arguments.length?(o=y,r):o};function g(){n.forEach(y=>{y.behavior&&y.behavior.disable()}),n=Object.values(om).map(y=>y(t,e)).filter(y=>y.id!=="delete"&&y.id!=="downgrade"&&y.id!=="copy").concat([O2(t,e),B2(t,e),on(t,e)]).filter(y=>y.available()),n.forEach(y=>{y.behavior&&y.behavior.enable()}),t.ui().closeEditMenu()}return r.operations=function(){return n},r.enter=function(){if(!u())return!1;if(t.features().forceVisible(e),g(),t.enableBehaviors(["hover","select","drag","lasso","map-interaction","paste"]),i.on(["[","pgup"],w).on(["]","pgdown"],E).on(["{",et("\u2318["),"home"],_).on(["}",et("\u2318]"),"end"],b).on(["\\","pause"],A).on(et("\u2318\u2191"),T).on(et("\u2318\u2193"),k).on("\u238B",x,!0),H(document).call(i),t.ui().sidebar.select(e,s),t.history().on("change.select",function(){v()}).on("undone.select",u).on("redone.select",u),r.extent=vt(e,t.graph()),o){var y=r.extent.center();t.map().centerEase(y),o=!1}return!0;function v(){if(u()){var C=t.surface();C.selectAll(".selected-member").classed("selected-member",!1),C.selectAll(".selected").classed("selected",!1),C.selectAll(".related").classed("related",!1),p(),a&&C.selectAll(lc([a])).classed("related",!0),C.selectAll(ax(e,t.graph(),!0)).classed("selected-member",!0),C.selectAll(z5(e,t.graph())).classed("selected",!0)}}function x(){t.container().select(".combobox").size()||t.enter("browse")}function _(C){C.preventDefault();var I=c(),P=m(),N;I&&I.type==="way"?N=I:P&&(N=t.entity(P)),a=N&&N.id,N&&t.enter(r.selectedIDs([N.first()]).follow(!0))}function b(C){C.preventDefault();var I=c(),P=m(),N;I&&I.type==="way"?N=I:P&&(N=t.entity(P)),a=N&&N.id,N&&t.enter(r.selectedIDs([N.last()]).follow(!0))}function w(C){C.preventDefault();var I=m();if(a=I,!!I){var P=t.entity(I),N=P.nodes.length,M=P.nodes.indexOf(e[0]),D=-1;M>0?D=M-1:P.isClosed()&&(D=N-2),D!==-1&&t.enter(r.selectedIDs([P.nodes[D]]).follow(!0))}}function E(C){C.preventDefault();var I=m();if(a=I,!!I){var P=t.entity(I),N=P.nodes.length,M=P.nodes.indexOf(e[0]),D=-1;M<N-1?D=M+1:P.isClosed()&&(D=0),D!==-1&&t.enter(r.selectedIDs([P.nodes[D]]).follow(!0))}}function A(C){C.preventDefault();var I=d(!0);if(!(!I||I.length<2)){var P=I.indexOf(a);P<0||P>I.length-2?a=I[0]:a=I[P+1];var N=t.surface();N.selectAll(".related").classed("related",!1),a&&N.selectAll(lc([a])).classed("related",!0)}}function T(C){C.preventDefault();var I=r.selectedIDs(),P=a?[a]:d(!1);P.length&&(t.enter(r.selectedIDs(P)),l=I)}function k(C){C.preventDefault();var I=r.selectedIDs(),P=l?l.filter(N=>t.hasEntity(N)):h(!0);!P||!P.length||(I.length===1&&(a=I[0]),t.enter(r.selectedIDs(P)))}},r.exit=function(){r.extent=null,s=!1,l=null,n.forEach(_=>{_.behavior&&_.behavior.disable()}),n=[],H(document).call(i.unbind),t.ui().closeEditMenu(),t.history().on("change.select",null).on("undone.select",null).on("redone.select",null);var y=t.surface();y.selectAll(".selected-member").classed("selected-member",!1),y.selectAll(".selected").classed("selected",!1),y.selectAll(".highlighted").classed("highlighted",!1),y.selectAll(".related").classed("related",!1),t.ui().sidebar.hide(),t.features().forceVisible([]);var v=c();if(s&&v&&v.type==="relation"&&Object.keys(v.tags).length===0&&t.graph().parentRelations(v).length===0&&(v.members.length===0||v.members.length===1&&!v.members[0].role)){var x=Qr(v.id,!0);t.perform(x,S("operations.delete.annotation.relation")),t.validator().validate()}},r}var Tm={};F5(Tm,{validationAlmostJunction:()=>am,validationCloseNodes:()=>lm,validationCrossingWays:()=>cm,validationDisconnectedWay:()=>um,validationDuplicateWaySegments:()=>fm,validationFormatting:()=>dm,validationHelpRequest:()=>hm,validationImpossibleOneway:()=>pm,validationIncompatibleSource:()=>mm,validationMaprules:()=>gm,validationMismatchedGeometry:()=>ym,validationMissingRole:()=>vm,validationMissingTag:()=>xm,validationOutdatedTags:()=>_m,validationPrivateData:()=>bm,validationSuspiciousName:()=>Em,validationUnsquareWay:()=>Sm,validationYShapedConnection:()=>wm});function _t(t){this.type=t.type,this.subtype=t.subtype,this.severity=t.severity,this.message=t.message,this.reference=t.reference,this.entityIds=t.entityIds,this.loc=t.loc,this.data=t.data,this.dynamicFixes=t.dynamicFixes,this.hash=t.hash,this.id=e.apply(this),this.key=r.apply(this),this.autoArgs=t.autoArgs;function e(){var i=[this.type];if(this.hash&&i.push(this.hash),this.subtype&&i.push(this.subtype),this.entityIds){var n=this.entityIds.slice().sort();i.push.apply(i,n)}return i.join(":")}function r(){return this.id+":"+Date.now().toString()}this.extent=function(i){return this.loc?new le(this.loc):this.entityIds&&this.entityIds.length?vt(this.entityIds,i):null},this.fixes=function(i){var n=this.dynamicFixes?this.dynamicFixes(i):[],s=this;return s.severity==="warning"&&n.push(new Ke({title:S.html("issues.fix.ignore_issue.title"),icon:"rapid-icon-close",onClick:function(){i.validator().ignoreIssue(this.issue.id)}})),n.forEach(function(o){o.id=o.title,o.issue=s}),n}}function Ke(t){this.title=t.title,this.onClick=t.onClick,this.disabledReason=t.disabledReason,this.icon=t.icon,this.entityIds=t.entityIds||[],this.issue=null}function am(t){let e="almost_junction",s=Math.atan(.15);function o(c){return c.type==="way"&&as[c.tags.highway]}function a(c){return c.tags.noexit==="yes"||c.tags.amenity==="parking_entrance"||c.tags.entrance&&c.tags.entrance!=="no"}let l=function(u,d){if(!o(u))return[];if(u.isDegenerate())return[];let h=t.history().tree(),p=x(u),m=[];return p.forEach(T=>{m.push(new _t({type:e,subtype:"highway-highway",severity:"warning",message:function(k){let C=k.hasEntity(this.entityIds[0]);if(this.entityIds[0]===this.entityIds[2])return C?S.html("issues.almost_junction.self.message",{feature:ft(C,k.graph())}):"";{let I=k.hasEntity(this.entityIds[2]);return C&&I?S.html("issues.almost_junction.message",{feature:ft(C,k.graph()),feature2:ft(I,k.graph())}):""}},reference:y,entityIds:[u.id,T.node.id,T.wid],loc:T.node.loc,hash:JSON.stringify(T.node.loc),data:{midId:T.mid.id,edge:T.edge,cross_loc:T.cross_loc},dynamicFixes:g}))}),m;function g(T){let k=[new Ke({icon:"rapid-icon-abutment",title:S.html("issues.fix.connect_features.title"),onClick:function(I){let P=S("issues.fix.connect_almost_junction.annotation"),[,N,M]=this.issue.entityIds,D=I.entity(this.issue.data.midId),F=I.entity(N),L=I.entity(M),B=_(F,L);if(B.length>0){let q=b(D,F,B);if(q){I.perform($n([q.id,F.id],q.loc),P);return}}let O=this.issue.data.edge,R=this.issue.data.cross_loc,G=[I.entity(O[0]),I.entity(O[1])].map(q=>q.loc),$=zf(G,R);$.distance<.75?I.perform($n([$.id,F.id],$.loc),P):I.perform(Xr({loc:R,edge:O},F),P)}})],C=T.hasEntity(this.entityIds[1]);return C&&!C.hasInterestingTags()&&k.push(new Ke({icon:"maki-barrier",title:S.html("issues.fix.tag_as_disconnected.title"),onClick:function(I){let P=this.issue.entityIds[1],N=Object.assign({},I.entity(P).tags);N.noexit="yes",I.perform(er(P,N),S("issues.fix.tag_as_disconnected.annotation"))}})),k}function y(T){T.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.almost_junction.highway-highway.reference"))}function v(T,k){let C=K.osm;if(C&&!C.isDataLoaded(T.loc)||a(T)||d.parentWays(T).length!==1)return!1;let I=0;for(let P in k.nodes)if(k.nodes[P]===T.id&&(I+=1,I>1))return!1;return!0}function x(T){let k=[];if(T.isClosed())return k;let C;return[0,T.nodes.length-1].forEach(P=>{let N=T.nodes[P],M=d.entity(N);if(!v(M,T))return;let D=A(T,P);D&&(C=d.childNodes(T).slice(),C[P]=C[P].move(D.cross_loc),!r1(C,N)&&k.push(D))}),k}function _(T,k){return[k.nodes[0],k.nodes[k.nodes.length-1]].map(C=>d.entity(C)).filter(C=>C.id!==T.id&&Tt(T.loc,C.loc)<=4.25)}function b(T,k,C){let I,P=1/0;return C.forEach(N=>{let M=t.projection.project(T.loc),D=t.projection.project(k.loc),F=t.projection.project(N.loc),L=vr(M,D)+Math.PI,B=vr(M,F)+Math.PI,O=Math.max(L,B)-Math.min(L,B);O<P&&(I=N,P=O)}),P<=s?I:null}function w(T,k){return T[k]!==void 0&&T[k]!=="no"}function E(T,k){if(T.id===k.id)return!0;if((w(T.tags,"bridge")||w(k.tags,"bridge"))&&!(w(T.tags,"bridge")&&w(k.tags,"bridge"))||(w(T.tags,"tunnel")||w(k.tags,"tunnel"))&&!(w(T.tags,"tunnel")&&w(k.tags,"tunnel")))return!1;let C=T.tags.layer||"0",I=k.tags.layer||"0";if(C!==I)return!1;let P=T.tags.level||"0",N=k.tags.level||"0";return P===N}function A(T,k){let C=T.nodes[k],I=k===0?T.nodes[1]:T.nodes[T.nodes.length-2],P=d.entity(C),N=d.entity(I),M=P.loc[0],D=P.loc[1],F=fi(5,D)/2,L=uo(5)/2,B=new le([M-F,D-L],[M+F,D+L]),R=5/Tt(N.loc,P.loc)+1,U=Ct(N.loc,P.loc,R),G=h.waySegments(B,d);for(let $=0;$<G.length;$++){let q=G[$],ie=d.entity(q.wayId);if(!o(ie)||!E(T,ie))continue;let Q=q.nodes[0],re=q.nodes[1];if(Q===C||re===C)continue;let ve=d.entity(Q),de=d.entity(re),we=qo([P.loc,U],[ve.loc,de.loc]);if(we)return{mid:N,node:P,wid:ie.id,edge:[ve.id,de.id],cross_loc:we}}return null}};return l.type=e,l}function lm(t){var e="close_nodes",r=.2,i=function(n,s){if(n.type==="node")return o(n);if(n.type==="way")return c(n);return[];function o(m){var g=s.parentWays(m);return g.length?u(m,g):h(m)}function a(m){if(m.tags.boundary&&m.tags.boundary!=="no")return"boundary";if(m.tags.indoor&&m.tags.indoor!=="no")return"indoor";if(m.tags.building&&m.tags.building!=="no"||m.tags["building:part"]&&m.tags["building:part"]!=="no")return"building";if(Ps[m.tags.highway])return"path";var g=s.parentRelations(m);for(var y in g){var v=g[y];if(v.tags.type==="boundary")return"boundary";if(v.isMultipolygon()){if(v.tags.indoor&&v.tags.indoor!=="no")return"indoor";if(v.tags.building&&v.tags.building!=="no"||v.tags["building:part"]&&v.tags["building:part"]!=="no")return"building"}}return"other"}function l(m){if(m.nodes.length<=2||m.isClosed()&&m.nodes.length<=4)return!1;var g=m.extent(s).bbox(),y=Tt([g.minX,g.minY],[g.maxX,g.maxY]);return!(y<1.5)}function c(m){if(!l(m))return[];for(var g=[],y=s.childNodes(m),v=0;v<y.length-1;v++){var x=y[v],_=y[v+1],b=p(x,_,m);b&&g.push(b)}return g}function u(m,g){var y=[];function v(E,A,T){var k=p(E,A,T);k&&y.push(k)}for(var x=0;x<g.length;x++){var _=g[x];if(l(_))for(var b=_.nodes.length-1,w=0;w<_.nodes.length;w++)w!==0&&_.nodes[w-1]===m.id&&v(m,s.entity(_.nodes[w]),_),w!==b&&_.nodes[w+1]===m.id&&v(s.entity(_.nodes[w]),m,_)}return y}function d(m){if(!l(m))return 0;var g=a(m);return g==="boundary"?0:g==="indoor"?.01:g==="building"?.05:g==="path"?.1:.2}function h(m){for(var g=[],y=m.loc[0],v=m.loc[1],x=fi(r,v)/2,_=uo(r)/2,b=new le([y-x,v-_],[y+x,v+_]),w=t.history().tree().intersects(b,s),E=0;E<w.length;E++){var A=w[E];if(A.id!==m.id&&!(A.type!=="node"||A.geometry(s)!=="point")&&(A.loc===m.loc||Tt(m.loc,A.loc)<r)){if("memorial:type"in m.tags&&"memorial:type"in A.tags&&m.tags["memorial:type"]==="stolperstein"&&A.tags["memorial:type"]==="stolperstein"||"memorial"in m.tags&&"memorial"in A.tags&&m.tags.memorial==="stolperstein"&&A.tags.memorial==="stolperstein")continue;var T={layer:!0,level:!0,"addr:housenumber":!0,"addr:unit":!0},k=!1;for(var C in T){var I=m.tags[C]||"0",P=A.tags[C]||"0";if(I!==P){k=!0;break}}if(k)continue;g.push(new _t({type:e,subtype:"detached",severity:"warning",message:function(M){var D=M.hasEntity(this.entityIds[0]),F=M.hasEntity(this.entityIds[1]);return D&&F?S.html("issues.close_nodes.detached.message",{feature:ft(D,M.graph()),feature2:ft(F,M.graph())}):""},reference:N,entityIds:[m.id,A.id],dynamicFixes:function(){return[new Ke({icon:"rapid-operation-disconnect",title:S.html("issues.fix.move_points_apart.title")}),new Ke({icon:"rapid-icon-layers",title:S.html("issues.fix.use_different_layers_or_levels.title")})]}}))}}return g;function N(M){var D=S("issues.close_nodes.detached.reference");M.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(D)}}function p(m,g,y){if(m.id===g.id||m.hasInterestingTags()&&g.hasInterestingTags())return null;if(m.loc!==g.loc){var v=s.parentWays(m),x=new Set(s.parentWays(g)),_=v.filter(function(T){return x.has(T)}),b=_.map(function(T){return d(T)}),w=Math.min(...b),E=Tt(m.loc,g.loc);if(E>w)return null}return new _t({type:e,subtype:"vertices",severity:"warning",message:function(T){var k=T.hasEntity(this.entityIds[0]);return k?S.html("issues.close_nodes.message",{way:ft(k,T.graph())}):""},reference:A,entityIds:[y.id,m.id,g.id],loc:m.loc,dynamicFixes:function(){return[new Ke({icon:"rapid-icon-plus",title:S.html("issues.fix.merge_points.title"),onClick:function(T){var k=this.issue.entityIds,C=$n([k[1],k[2]]);T.perform(C,S("issues.fix.merge_close_vertices.annotation"))}}),new Ke({icon:"rapid-operation-disconnect",title:S.html("issues.fix.move_points_apart.title")})]}});function A(T){var k=S("issues.close_nodes.reference");T.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(k)}}};return i.type=e,i}function cm(t){var e="crossing_ways";function r(w,E){if(l(w,E)===null)for(var A=E.parentRelations(w),T=0;T<A.length;T++){var k=A[T];if(l(k,E)!==null)return k}return w}function i(w,E){return w[E]!==void 0&&w[E]!=="no"}function n(w){return i(w,"indoor")||i(w,"level")||w.highway==="corridor"}function s(w){return w==="highway"||w==="railway"||w==="waterway"||w==="aeroway"}function o(w){return w==="highway"||w==="railway"||w==="waterway"}var a={demolished:!0,dismantled:!0,proposed:!0,razed:!0};function l(w,E){var A=w.geometry(E);if(A!=="line"&&A!=="area")return null;var T=w.tags;return T.aeroway in fx?"aeroway":i(T,"building")&&!a[T.building]?"building":i(T,"highway")&&as[T.highway]?"highway":A!=="line"?null:i(T,"railway")&&W5[T.railway]?"railway":i(T,"waterway")&&dc[T.waterway]?"waterway":null}function c(w,E,A,T){var k=w.level||"0",C=A.level||"0";if(n(w)&&n(A)&&k!==C)return!0;var I=w.layer||"0",P=A.layer||"0";if(s(E)&&s(T)){if(i(w,"bridge")&&!i(A,"bridge")||!i(w,"bridge")&&i(A,"bridge")||i(w,"bridge")&&i(A,"bridge")&&I!==P)return!0}else{if(s(E)&&i(w,"bridge"))return!0;if(s(T)&&i(A,"bridge"))return!0}if(o(E)&&o(T)){if(i(w,"tunnel")&&!i(A,"tunnel")||!i(w,"tunnel")&&i(A,"tunnel")||i(w,"tunnel")&&i(A,"tunnel")&&I!==P)return!0}else{if(o(E)&&i(w,"tunnel"))return!0;if(o(T)&&i(A,"tunnel"))return!0}return E==="waterway"&&T==="highway"&&A.man_made==="pier"||T==="waterway"&&E==="highway"&&w.man_made==="pier"||(E==="building"||T==="building")&&I!==P}var u={motorway:!0,motorway_link:!0,trunk:!0,trunk_link:!0,primary:!0,primary_link:!0,secondary:!0,secondary_link:!0},d={track:!0};function h(w,E,A){var T=l(w,A),k=l(E,A),C=w.geometry(A),I=E.geometry(A),P=C==="line"&&I==="line";let N=[T,k].sort().join("-");if(N==="aeroway-aeroway")return{};if(N==="aeroway-highway"){let O=w.tags.highway==="service"||E.tags.highway==="service",R=w.tags.highway in Ps||E.tags.highway in Ps;return O||R?{}:{aeroway:"aircraft_crossing"}}if(N==="aeroway-railway")return{aeroway:"aircraft_crossing",railway:"level_crossing"};if(N==="aeroway-waterway")return null;if(T===k){if(T==="highway"){var M=Ps[w.tags.highway],D=Ps[E.tags.highway];if((M||D)&&M!==D){var F=M?E:w;if(d[F.tags.highway])return{};var L=M?w:E;return["marked","unmarked"].indexOf(L.tags.crossing)!==-1?P?{highway:"crossing",crossing:L.tags.crossing}:{}:P?{highway:"crossing"}:{}}return{}}if(T==="waterway")return{};if(T==="railway")return{}}else if(N.indexOf("highway")!==-1){if(N.indexOf("railway")!==-1){if(!P)return{};var B=w.tags.railway==="tram"||E.tags.railway==="tram";return Ps[w.tags.highway]||Ps[E.tags.highway]?B?{railway:"tram_crossing"}:{railway:"crossing"}:B?{railway:"tram_level_crossing"}:{railway:"level_crossing"}}if(N.indexOf("waterway")!==-1)return i(w.tags,"tunnel")&&i(E.tags,"tunnel")||i(w.tags,"bridge")&&i(E.tags,"bridge")||u[w.tags.highway]||u[E.tags.highway]?null:P?{ford:"yes"}:{}}return null}function p(w,E,A){var T=[];if(w.type!=="way")return T;var k=r(w,E),C=l(k,E);if(C===null)return T;var I={},P,N,M,D,F,L,B,O,R,U,G,$,q,ie,Q,re,ve,de=E.childNodes(w),we={};for(P=0;P<de.length-1;P++)for(D=de[P],F=de[P+1],M=new le([Math.min(D.loc[0],F.loc[0]),Math.min(D.loc[1],F.loc[1])],[Math.max(D.loc[0],F.loc[0]),Math.max(D.loc[1],F.loc[1])]),q=A.waySegments(M,E),N=0;N<q.length;N++)if(ie=q[N],ie.wayId!==w.id&&!I[ie.wayId]&&(we[ie.wayId]=!0,Q=E.hasEntity(ie.wayId),!!Q&&(re=r(Q,E),ve=l(re,E),!(ve===null||c(k.tags,C,re.tags,ve))&&($=C==="building"||ve==="building",O=ie.nodes[0],R=ie.nodes[1],!(O===D.id||O===F.id||R===D.id||R===F.id)&&(L=E.hasEntity(O),!!L&&(B=E.hasEntity(R),!!B)))))){U=[D.loc,F.loc],G=[L.loc,B.loc];var ne=qo(U,G);if(ne&&(T.push({wayInfos:[{way:w,featureType:C,edge:[D.id,F.id]},{way:Q,featureType:ve,edge:[L.id,B.id]}],crossPoint:ne}),$)){I[Q.id]=!0;break}}return T}function m(w,E){var A=l(w,E);return A?w.type==="way"?[w]:w.type==="relation"?w.members.reduce(function(T,k){if(k.type==="way"&&(!k.role||k.role==="outer"||k.role==="inner")){var C=E.hasEntity(k.id);C&&T.indexOf(C)===-1&&T.push(C)}return T},[]):[]:[]}var g=function(E,A){var T=t.history().tree(),k=m(E,A),C=[],I,P,N;for(I in k){N=p(k[I],A,T);for(P in N)C.push(y(N[P],A))}return C};function y(w,E){w.wayInfos.sort(function(R,U){var G=R.featureType,$=U.featureType;return G===$?ft(R.way,E)>ft(U.way,E):G==="waterway"?!0:$==="waterway"?!1:G<$});var A=w.wayInfos.map(function(R){return r(R.way,E)}),T=[w.wayInfos[0].edge,w.wayInfos[1].edge],k=[w.wayInfos[0].featureType,w.wayInfos[1].featureType],C=h(A[0],A[1],E),I=w.wayInfos[0].featureType,P=w.wayInfos[1].featureType,N=n(A[0].tags)&&n(A[1].tags),M=o(I)&&i(A[0].tags,"tunnel")&&o(P)&&i(A[1].tags,"tunnel"),D=s(I)&&i(A[0].tags,"bridge")&&s(P)&&i(A[1].tags,"bridge"),F=[I,P].sort().join("-"),L=F;N?L="indoor-indoor":M?L="tunnel-tunnel":D&&(L="bridge-bridge"),C&&(N||M||D)&&(L+="_connectable");var B=""+w.crossPoint[0].toFixed(4)+","+w.crossPoint[1].toFixed(4);return new _t({type:e,subtype:F,severity:"warning",message:function(R){var U=R.graph(),G=U.hasEntity(this.entityIds[0]),$=U.hasEntity(this.entityIds[1]);return G&&$?S.html("issues.crossing_ways.message",{feature:ft(G,U),feature2:ft($,U)}):""},reference:O,entityIds:A.map(function(R){return R.id}),data:{edges:T,featureTypes:k,connectionTags:C},hash:B,loc:w.crossPoint,autoArgs:C&&!C.ford&&x(w.crossPoint,T,C),dynamicFixes:function(R){var U=R.mode(),G=R.selectedIDs();if(!U||U.id!=="select"||G.length!==1)return[];var $=this.entityIds[0]===G[0]?0:1,q=this.data.featureTypes[$],ie=this.data.featureTypes[$===0?1:0],Q=[];if(C&&Q.push(_(this.data.connectionTags)),N)Q.push(new Ke({icon:"rapid-icon-layers",title:S.html("issues.fix.use_different_levels.title")}));else if(M||D||I==="building"||P==="building")Q.push(b("higher")),Q.push(b("lower"));else if(R.graph().geometry(this.entityIds[0])==="line"&&R.graph().geometry(this.entityIds[1])==="line"){s(q)&&q!=="waterway"&&Q.push(v("add_a_bridge","temaki-bridge","bridge"));var re=ie==="waterway"&&q!=="waterway";o(q)&&!re&&Q.push(v("add_a_tunnel","temaki-tunnel","tunnel"))}return Q.push(new Ke({icon:"rapid-operation-move",title:S.html("issues.fix.reposition_features.title")})),Q}});function O(R){R.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.crossing_ways."+L+".reference"))}}function v(w,E,A){return new Ke({icon:E,title:S.html("issues.fix."+w+".title"),onClick:function(T){var k=T.mode();if(!(!k||k.id!=="select")){var C=k.selectedIDs();if(C.length===1){var I=C[0];if(T.hasEntity(I)){var P=[I],N,M,D;this.issue.entityIds[0]===I?(N=this.issue.data.edges[0],M=this.issue.data.edges[1],D=this.issue.entityIds[1]):(N=this.issue.data.edges[1],M=this.issue.data.edges[0],D=this.issue.entityIds[0]);var F=this.issue.loc,L=T.projection,B=function(R){var U=[R.entity(N[0]),R.entity(N[1])],G=R.hasEntity(D),$=G&&G.tags.width&&parseFloat(G.tags.width);$||($=G&&G.impliedLineWidthMeters()),$?l(G,R)==="railway"&&($*=2):$=8;var q=vr(L.project(U[0].loc),L.project(U[1].loc))+Math.PI,ie=vr(L.project(R.entity(M[0]).loc),L.project(R.entity(M[1]).loc))+Math.PI,Q=Math.max(q,ie)-Math.min(q,ie);Q>Math.PI&&(Q-=Math.PI),$=$/2/Math.sin(Q)*2,$+=4,$=Math.min(Math.max($,4),50);function re(ce){return[c2(ce[0],ce[1]),F8(ce[1])]}function ve(ce){var ye=uo(ce[1]);return[fi(ce[0],ye),ye]}var de=re(U[0].loc),we=re(U[1].loc),ne=vr(de,we),Ie=re(F),at=ut(de,we)/Tt(U[0].loc,U[1].loc);function Et(ce,ye){var Fe=ye*at;return ve([Ie[0]+Math.cos(ce)*Fe,Ie[1]+Math.sin(ce)*Fe])}var $t=function(ce){return Et(ne,ce)},Pt=function(ce){return Et(ne+Math.PI,ce)},J=.55;function V(ce,ye,Fe){var He,ae=$/2,pe=Tt(F,ye.loc);if(pe-ae>J){var Ee=Fe(ae);He=je(),R=Xr({loc:Ee,edge:ce},He)(R)}else{var Me=0;if(ye.parentIntersectionWays(R).forEach(function(Ut){Ut.nodes.forEach(function(kr){kr===ye.id&&(ye.id===Ut.first()&&ye.id!==Ut.last()||ye.id===Ut.last()&&ye.id!==Ut.first()?Me+=1:Me+=2)})}),Me>=3){var Pe=pe-J;if(Pe>J){var Ze=Fe(Pe);He=je(),R=Xr({loc:Ze,edge:ce},He)(R)}}}He||(He=ye);var Zt=ta([He.id]).limitWays(P);return R=Zt(R),Zt.getCreatedWayIDs().length&&P.push(Zt.getCreatedWayIDs()[0]),He}var z=V(N,U[1],$t),X=V([U[0].id,z.id],U[0],Pt),W=P.map(function(ce){return R.entity(ce)}).find(function(ce){return ce.nodes.indexOf(z.id)!==-1&&ce.nodes.indexOf(X.id)!==-1}),Y=Object.assign({},W.tags);if(A==="bridge")Y.bridge="yes",Y.layer="1";else{var te="yes";l(W,R)==="waterway"&&(te="culvert"),Y.tunnel=te,Y.layer="-1"}return R=er(W.id,Y)(R),R};T.perform(B,S("issues.fix."+w+".annotation")),T.enter(Se(T,P))}}}}})}function x(w,E,A){var T=function(C){var I=!1,P=je({loc:w,tags:A}),N=C.replace(P),M=[P.id],D=.75;return E.forEach(function(F){var L=N.hasEntity(F[0]),B=N.hasEntity(F[1]);if(!(!L||!B)){var O=!1,R=[L,B],U=zf([L.loc,B.loc],w);if(U&&U.distance<D){var G=R[U.index];(!G.hasInterestingTags()||G.isCrossing())&&(O=!0,M.push(G.id))}O||(N=Xr({loc:w,edge:F},P)(N),I=!0)}}),M.length>1&&(N=$n(M,w)(N),I=!0),I?N:C};return[T,S("issues.fix.connect_crossing_features.annotation")]}function _(w){var E="connect_features";return w.ford&&(E="connect_using_ford"),new Ke({icon:"rapid-icon-crossing",title:S.html("issues.fix."+E+".title"),onClick:function(A){var T=this.issue.loc,k=this.issue.data.edges,C=this.issue.data.connectionTags,I=x(T,k,C);A.perform(I[0],I[1])}})}function b(w){return new Ke({icon:"rapid-icon-"+(w==="higher"?"up":"down"),title:S.html("issues.fix.tag_this_as_"+w+".title"),onClick:function(E){var A=E.mode();if(!(!A||A.id!=="select")){var T=A.selectedIDs();if(T.length===1){var k=T[0];if(this.issue.entityIds.some(function(N){return N===k})){var C=E.hasEntity(k);if(C){var I=Object.assign({},C.tags),P=I.layer&&Number(I.layer);P&&!isNaN(P)?w==="higher"?P+=1:P-=1:w==="higher"?P=1:P=-1,I.layer=P.toString(),E.perform(er(C.id,I),S("operations.change_tags.annotation"))}}}}}})}return g.type=e,g}function um(){var t="disconnected_way";function e(i){return as[i.tags.highway]}var r=function(n,s){var o=c(n);if(!o)return[];return[new _t({type:t,subtype:"highway",severity:"warning",message:function(m){var g=this.entityIds.length&&m.hasEntity(this.entityIds[0]),y=g&&ft(g,m.graph());return S.html("issues.disconnected_way.routable.message",{count:this.entityIds.length,highway:y})},reference:l,entityIds:Array.from(o).map(function(m){return m.id}),dynamicFixes:a})];function a(m){var g=[],y=this.entityIds.length===1&&m.hasEntity(this.entityIds[0]);if(y){if(y.type==="way"&&!y.isClosed()){var v=se.textDirection(),x=p(v,y.first(),"start");x&&g.push(x);var _=p(v,y.last(),"end");_&&g.push(_)}g.length||g.push(new Ke({title:S.html("issues.fix.connect_feature.title")})),g.push(new Ke({icon:"rapid-operation-delete",title:S.html("issues.fix.delete_feature.title"),entityIds:[y.id],onClick:function(b){var w=this.issue.entityIds[0],E=on(b,[w]);E.disabled()||E()}}))}else g.push(new Ke({title:S.html("issues.fix.connect_features.title")}));return g}function l(m){m.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.disconnected_way.routable.reference"))}function c(m){var g=new Set,y=[];function v(E){s.parentWays(E).forEach(function(A){!g.has(A)&&h(A,!1)&&(g.add(A),y.push(A))})}if(m.type==="way"&&h(m,!0))g.add(m),y.push(m);else if(m.type==="node"&&d(m))g.add(m),v(m);else return null;for(;y.length;){var x=y.pop(),_=s.childNodes(x);for(var b in _){var w=_[b];if(u(w))return null;d(w)&&g.add(w),v(w)}}return g}function u(m){var g=K.osm;return!!(g&&!g.isDataLoaded(m.loc)||m.tags.entrance&&m.tags.entrance!=="no"||m.tags.amenity==="parking_entrance")}function d(m){return m.tags.highway==="elevator"}function h(m,g){return e(m)||m.tags.route==="ferry"?!0:s.parentRelations(m).some(function(y){return!!(y.tags.type==="route"&&y.tags.route==="ferry"||y.isMultipolygon()&&e(y)&&(!g||y.memberById(m.id).role!=="inner"))})}function p(m,g,y){var v=s.hasEntity(g);if(!v||v.tags.noexit==="yes")return null;var x=y==="start"&&m==="ltr"||y==="end"&&m==="rtl";return new Ke({icon:"rapid-operation-continue"+(x?"-left":""),title:S.html("issues.fix.continue_from_"+y+".title"),entityIds:[g],onClick:function(_){var b=this.issue.entityIds[0],w=_.hasEntity(b),E=this.entityIds[0],A=_.hasEntity(E);if(!(!w||!A)){var T=_.map();(!_.editable()||!T.trimmedExtent().contains(new le(A.loc)))&&T.zoomToEase(A),_.enter("draw-line",{continueWay:w,continueNode:A})}}})}};return r.type=t,r}function fm(){var t="duplicate_way_segments",e=function(r,i){if(r.type==="way")return a(r);return[];function n(c){return c==="highway"||c==="railway"||c==="waterway"}function s(c){return c.isArea()?!1:Object.keys(c.tags).some(n)}function o(c,u,d){let h=i.childNodes(d);return Math.abs(h.findIndex(p=>p.id===c.id)-h.findIndex(p=>p.id===u.id))===1}function a(c){var u=[];if(!s(c))return u;for(var d=i.childNodes(c),h=0;h<d.length-1;h++){var p=d[h],m=d[h+1],g=l(p,m,c);g&&u.push(g)}return u}function l(c,u,d){if(c.id===u.id)return null;if(c.loc!==u.loc){var h=i.parentWays(c),p=new Set(i.parentWays(u)),m=h.filter(function(x){return p.has(x)}),g=m.filter(x=>s(x)),y=g.filter(x=>o(c,u,x));if(y.length<=1)return null}return new _t({type:t,subtype:"vertices",severity:"warning",message:function(x){var _=x.hasEntity(this.entityIds[0]);return _?S.html("issues.duplicate_way_segments.message",{way:ft(_,x.graph())}):""},reference:v,entityIds:[d.id,c.id,u.id],loc:c.loc,dynamicFixes:function(){return[new Ke({icon:"rapid-icon-plus",title:S.html("issues.fix.merge_points.title")}),new Ke({icon:"rapid-operation-delete",title:S.html("issues.fix.remove_way_segments.title")}),new Ke({icon:"rapid-operation-disconnect",title:S.html("issues.fix.move_way_segments_apart.title")})]}});function v(x){var _=S("issues.duplicate_way_segments.reference");x.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(_)}}};return e.type=t,e}function dm(){var t="invalid_format",e=function(r){var i=[];function n(a){var l=/^[^\(\)\\,":;<>@\[\]]+@[^\(\)\\,":;<>@\[\]\.]+(?:\.[a-z0-9-]+)*$/i;return!a||l.test(a)}function s(a){a.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.invalid_format.email.reference"))}if(r.tags.email){var o=r.tags.email.split(";").map(function(a){return a.trim()}).filter(function(a){return!n(a)});o.length&&i.push(new _t({type:t,subtype:"email",severity:"warning",message:function(a){var l=a.hasEntity(this.entityIds[0]);return l?S.html("issues.invalid_format.email.message"+this.data,{feature:ft(l,a.graph()),email:o.join(", ")}):""},reference:s,entityIds:[r.id],hash:o.join(),data:o.length>1?"_multi":""}))}return i};return e.type=t,e}function hm(t){var e="help_request",r=function(n){if(!n.tags.fixme)return[];if(n.version===void 0)return[];if(n.v!==void 0){var s=t.history().base().hasEntity(n.id);if(!s||!s.tags.fixme)return[]}return[new _t({type:e,subtype:"fixme_tag",severity:"warning",message:function(a){var l=a.hasEntity(this.entityIds[0]);return l?S.html("issues.fixme_tag.message",{feature:ft(l,a.graph(),!0)}):""},dynamicFixes:function(){return[new Ke({title:S.html("issues.fix.address_the_concern.title")})]},reference:o,entityIds:[n.id]})];function o(a){a.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.fixme_tag.reference"))}};return r.type=e,r}function pm(){var t="impossible_oneway",e=function(n,s){if(n.type!=="way"||n.geometry(s)!=="line")return[];if(n.isClosed())return[];if(!l(n))return[];if(!c(n))return[];var o=h(n,n.first()),a=h(n,n.last());return o.concat(a);function l(p){return p.geometry(s)!=="line"?null:as[p.tags.highway]?"highway":dc[p.tags.waterway]?"waterway":null}function c(p){if(p.tags.oneway==="yes")return!0;if(p.tags.oneway)return!1;for(var m in p.tags)if(Ms[m]&&Ms[m][p.tags[m]])return!0;return!1}function u(p,m){var g=0;for(var y in p.nodes)if(p.nodes[y]===m&&(g+=1,g>1))return!0;return!1}function d(p,m){var g=l(p);if(g==="highway"){if(m.tags.entrance&&m.tags.entrance!=="no"||m.tags.amenity==="parking_entrance")return!0}else if(g==="waterway"){if(m.id===p.first()){if(m.tags.natural==="spring")return!0}else if(m.tags.manhole==="drain")return!0}return s.parentWays(m).some(function(y){return y.id===p.id?!1:g==="highway"?y.geometry(s)==="area"&&as[y.tags.highway]||y.tags.route==="ferry"?!0:s.parentRelations(y).some(function(v){return v.tags.type==="route"&&v.tags.route==="ferry"?!0:v.isMultipolygon()&&as[v.tags.highway]}):g==="waterway"&&(y.tags.natural==="water"||y.tags.natural==="coastline")})}function h(p,m){var g=m===p.first(),y=l(p);if(u(p,m))return[];var v=K.osm;if(!v)return[];var x=s.hasEntity(m);if(!x||!v.isDataLoaded(x.loc))return[];if(d(p,x))return[];var _=s.parentWays(x).filter(function(C){return C.id===p.id?!1:l(C)===y});if(y==="waterway"&&_.length===0)return[];var b=_.filter(function(C){return c(C)});if(b.length<_.length)return[];if(b.length){var w=b.some(function(C){return!!((g?C.first():C.last())!==m||u(C,m))});if(w)return[]}var E=g?"start":"end",A=y+".",T=y+".";return y==="waterway"?(A+="connected."+E,T+="connected"):(A+=E,T+=E),[new _t({type:t,subtype:y,severity:"warning",message:function(C){var I=C.hasEntity(this.entityIds[0]);return I?S.html("issues.impossible_oneway."+A+".message",{feature:ft(I,C.graph())}):""},reference:k(T),entityIds:[p.id,x.id],dynamicFixes:function(){var C=[];if(b.length&&C.push(new Ke({icon:"rapid-operation-reverse",title:S.html("issues.fix.reverse_feature.title"),entityIds:[p.id],onClick:function(N){var M=this.issue.entityIds[0];N.perform(os(M),S("operations.reverse.annotation.line",{n:1}))}})),x.tags.noexit!=="yes"){var I=se.textDirection(),P=g&&I==="ltr"||!g&&I==="rtl";C.push(new Ke({icon:"rapid-operation-continue"+(P?"-left":""),title:S.html("issues.fix.continue_from_"+(g?"start":"end")+".title"),onClick:function(N){var M=this.issue.entityIds[0],D=this.issue.entityIds[1],F=N.entity(M),L=N.entity(D);r(F,L,N)}}))}return C},loc:x.loc})];function k(C){return function(P){P.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.impossible_oneway."+C+".reference"))}}}};function r(i,n,s){var o=s.map();(!s.editable()||!o.trimmedExtent().contains(new le(n.loc)))&&o.zoomToEase(n),s.enter("draw-line",{continueWay:i,continueNode:n})}return e.type=t,e}function mm(){let t="incompatible_source",e=[{id:"amap",regex:/(amap|autonavi|mapabc|)/i},{id:"baidu",regex:/(baidu|mapbar|)/i},{id:"google",regex:/google/i,exceptRegex:/((books|drive)\.google|google\s?(books|drive|plus))|(esri\/Google_Africa_Buildings)/i}],r=function(n){let s=n.tags&&n.tags.source&&n.tags.source.split(";");if(!s)return[];let o=n.id;return s.map(l=>{let c=e.find(u=>!(!u.regex.test(l)||u.exceptRegex&&u.exceptRegex.test(l)));return c?new _t({type:t,severity:"warning",message:u=>{let d=u.hasEntity(o);return d?S.html("issues.incompatible_source.feature.message",{feature:ft(d,u.graph(),!0),value:l}):""},reference:a(c.id),entityIds:[o],hash:l,dynamicFixes:()=>[new Ke({title:S.html("issues.fix.remove_proprietary_data.title")})]}):null}).filter(Boolean);function a(l){return function(u){u.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html(`issues.incompatible_source.reference.${l}`))}}};return r.type=t,r}function gm(){var t="maprules",e=function(i,n){if(!K.maprules)return[];for(var s=K.maprules.validationRules(),o=[],a=0;a<s.length;a++){var l=s[a];l.findIssues(i,n,o)}return o};return e.type=t,e}var _S=dt(t1(),1);function Ui(t,e,r){return function(i){return i.replace(i.entity(t).addNode(e,r))}}function ym(){var t="mismatched_geometry";function e(u){if(u.type!=="way"||u.isClosed())return null;var d=u.tagSuggestingArea();if(!d)return null;var h=xe.matchTags(d,"line"),p=xe.matchTags(d,"area");return h&&p&&h===p?null:d}function r(u,d){if(u.nodes.length<3)return null;var h=d.childNodes(u),p,m=Tt(h[0].loc,h[h.length-1].loc);if(m<.75&&(p=h.slice(),p.pop(),p.push(p[0]),!r1(p,p[0].id)))return function(g){var y=g.entity(this.issue.entityIds[0]);g.perform($n([y.nodes[0],y.nodes[y.nodes.length-1]],h[0].loc),S("issues.fix.connect_endpoints.annotation"))};if(p=h.slice(),p.push(p[0]),!r1(p,p[0].id))return function(g){var y=this.issue.entityIds[0],v=g.entity(y),x=v.nodes[0],_=v.nodes.length;g.perform(Ui(y,x,_),S("issues.fix.connect_endpoints.annotation"))}}function i(u){var d=e(u);if(!d)return null;return new _t({type:t,subtype:"area_as_line",severity:"warning",message:function(p){var m=p.hasEntity(this.entityIds[0]);return m?S.html("issues.tag_suggests_area.message",{feature:ft(m,"area",!0),tag:lx({tags:d})}):""},reference:h,entityIds:[u.id],hash:JSON.stringify(d),dynamicFixes:function(p){var m=[],g=p.entity(this.entityIds[0]),y=r(g,p.graph());return m.push(new Ke({title:S.html("issues.fix.connect_endpoints.title"),onClick:y})),m.push(new Ke({icon:"rapid-operation-delete",title:S.html("issues.fix.remove_tag.title"),onClick:function(v){var x=this.issue.entityIds[0],_=v.entity(x),b=Object.assign({},_.tags);for(var w in d)delete b[w];v.perform(er(x,b),S("issues.fix.remove_tag.annotation"))}})),m}});function h(p){p.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.tag_suggests_area.reference"))}}function n(u,d){if(u.type!=="node"||Object.keys(u.tags).length===0||u.isOnAddressLine(d))return null;var h=u.geometry(d),p=Ba(u.tags);return h==="point"&&!p.point&&p.vertex?new _t({type:t,subtype:"vertex_as_point",severity:"warning",message:function(m){var g=m.hasEntity(this.entityIds[0]);return g?S.html("issues.vertex_as_point.message",{feature:ft(g,"vertex",!0)}):""},reference:function(g){g.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.vertex_as_point.reference"))},entityIds:[u.id]}):h==="vertex"&&!p.vertex&&p.point?new _t({type:t,subtype:"point_as_vertex",severity:"warning",message:function(m){var g=m.hasEntity(this.entityIds[0]);return g?S.html("issues.point_as_vertex.message",{feature:ft(g,"point",!0)}):""},reference:function(g){g.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.point_as_vertex.reference"))},entityIds:[u.id],dynamicFixes:a}):null}function s(u,d){if(!u.hasInterestingTags()||u.type!=="node"&&u.type!=="way"||u.type==="node"&&u.isOnAddressLine(d))return null;var h=u.geometry(d),p=u.type==="way"?["point","vertex"]:["line","area"];h==="area"&&p.unshift("line");var m=xe.match(u,d),g=p.find(_=>{var b=xe.matchTags(u.tags,_);if(!m||!b||m===b||(0,_S.default)(m.tags,b.tags)||b.isFallback())return!1;var w=Object.keys(b.tags)[0];return w==="building"||b.tags[w]==="*"?!1:m.isFallback()||m.tags[w]==="*"});if(!g)return null;var y=g+"_as_"+h;g==="vertex"&&(g="point"),h==="vertex"&&(h="point");var v=g+"_as_"+h,x;return g==="point"?x=a:h==="area"&&g==="line"&&(x=o),new _t({type:t,subtype:y,severity:"warning",message:function(_){var b=_.hasEntity(this.entityIds[0]);return b?S.html("issues."+v+".message",{feature:ft(b,g,!0)}):""},reference:function(b){b.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.mismatched_geometry.reference"))},entityIds:[u.id],dynamicFixes:x})}function o(u){var d,h=this.entityIds[0],p=u.entity(h),m=Object.assign({},p.tags);return delete m.area,La(m)||(d=function(g){var y=this.issue.entityIds[0],v=g.entity(y),x=Object.assign({},v.tags);x.area&&delete x.area,g.perform(er(y,x),S("issues.fix.convert_to_line.annotation"))}),[new Ke({icon:"rapid-icon-line",title:S.html("issues.fix.convert_to_line.title"),onClick:d})]}function a(u){var d=this.entityIds[0],h=null;return u.hasHiddenConnections(d)||(h=function(p){var m=this.issue.entityIds[0],g=n0(m,p.projection);p.perform(g,S("operations.extract.annotation",{n:1})),p.enter(Se(p,[g.getExtractedNodeID()]))}),[new Ke({icon:"rapid-operation-extract",title:S.html("issues.fix.extract_point.title"),onClick:h})]}function l(u,d){if(u.type!=="relation"||!u.isMultipolygon()||u.isDegenerate()||!u.isComplete(d))return[];var h=En(u.members,d),p=[];for(var m in h){var g=h[m];if(g.nodes){var y=g.nodes[0],v=g.nodes[g.nodes.length-1];if(y!==v){var x=new _t({type:t,subtype:"unclosed_multipolygon_part",severity:"warning",message:function(b){var w=b.hasEntity(this.entityIds[0]);return w?S.html("issues.unclosed_multipolygon_part.message",{feature:ft(w,b.graph(),!0)}):""},reference:_,loc:g.nodes[0].loc,entityIds:[u.id],hash:g.map(function(b){return b.id}).join()});p.push(x)}}}return p;function _(b){b.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.unclosed_multipolygon_part.reference"))}}var c=function(d,h){var p=n(d,h);if(p)return[p];var m=i(d);if(m)return[m];var g=s(d,h);return g?[g]:l(d,h)};return c.type=t,c}function Ja(t,e,r){return function(i){return i.replace(i.entity(t).updateMember(e,r))}}function el(t,e){return function(r){var i=r.entity(t).removeMember(e);return r=r.replace(i),i.isDegenerate()&&(r=Qr(i.id)(r)),r}}function vm(){var t="missing_role",e=function(o,a){var l=[];return o.type==="way"?a.parentRelations(o).forEach(function(c){if(c.isMultipolygon()){var u=c.memberById(o.id);u&&r(u)&&l.push(i(o,c,u))}}):o.type==="relation"&&o.isMultipolygon()&&o.indexedMembers().forEach(function(c){var u=a.hasEntity(c.id);u&&r(c)&&l.push(i(u,o,c))}),l};function r(s){return!s.role||!s.role.trim().length}function i(s,o,a){return new _t({type:t,severity:"warning",message:function(c){var u=c.hasEntity(this.entityIds[1]),d=c.hasEntity(this.entityIds[0]);return u&&d?S.html("issues.missing_role.message",{member:ft(u,c.graph()),relation:ft(d,c.graph())}):""},reference:l,entityIds:[o.id,s.id],data:{member:a},hash:a.index.toString(),dynamicFixes:function(){return[n("inner"),n("outer"),new Ke({icon:"rapid-operation-delete",title:S.html("issues.fix.remove_from_relation.title"),onClick:function(c){c.perform(el(this.issue.entityIds[0],this.issue.data.member.index),S("operations.delete_member.annotation",{n:1}))}})]}});function l(c){c.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.missing_role.multipolygon.reference"))}}function n(s){return new Ke({title:S.html("issues.fix.set_as_"+s+".title"),onClick:function(o){var a=this.issue.data.member,l={id:this.issue.entityIds[1],type:a.type,role:s};o.perform(Ja(this.issue.entityIds[0],l,a.index),S("operations.change_role.annotation",{n:1}))}})}return e.type=t,e}function xm(t){var e="missing_tag";function r(o,a){var l=["description","name","note","start_date"],c=Object.keys(o.tags).filter(function(u){return u==="area"||!$i(u)?!1:!l.some(function(d){return u===d||u.indexOf(d+":")===0})});return o.type==="relation"&&c.length===1&&o.tags.type==="multipolygon"?Jc(o,a):c.length>0}function i(o){return o.type==="way"&&o.tags.highway==="road"}function n(o){return o.type==="relation"&&!o.tags.type}var s=function(a,l){var c,u=t.connection(),d=a.type==="node"&&u&&!u.isDataLoaded(a.loc);if(!d&&a.geometry(l)!=="vertex"&&!a.hasParentRelations(l)&&(Object.keys(a.tags).length===0?c="any":r(a,l)?n(a)&&(c="relation_type"):c="descriptive"),!c&&i(a)&&(c="highway_classification"),!c)return[];var h=c==="highway_classification"?"unknown_road":"missing_tag."+c,p=c==="highway_classification"?"unknown_road":"missing_tag",m=a.version===void 0||a.v!==void 0,g=m&&c!=="highway_classification"?"error":"warning";return[new _t({type:e,subtype:c,severity:g,message:function(v){var x=v.hasEntity(this.entityIds[0]);return x?S.html("issues."+h+".message",{feature:ft(x,v.graph())}):""},reference:y,entityIds:[a.id],dynamicFixes:function(v){var x=[],_=c==="highway_classification"?"select_road_type":"select_preset";x.push(new Ke({icon:"rapid-icon-search",title:S.html("issues.fix."+_+".title"),onClick:function(T){T.ui().sidebar.showPresetList()}}));var b,w=this.entityIds[0],E=on(v,[w]),A=E.disabled();return A||(b=function(T){var k=this.issue.entityIds[0],C=on(T,[k]);C.disabled()||C()}),x.push(new Ke({icon:"rapid-operation-delete",title:S.html("issues.fix.delete_feature.title"),disabledReason:A?S("operations.delete."+A+".single"):void 0,onClick:b})),x}})];function y(v){v.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues."+p+".reference"))}};return s.type=e,s}function Hn(t,e,r,i){return function(s){var o=s.entity(t),a=o.geometry(s),l=o.tags;return e&&(l=e.unsetTags(l,a,r&&r.addTags?Object.keys(r.addTags):null)),r&&(l=r.setTags(l,a,i)),s.replace(o.update({tags:l}))}}function Od(t,e,r){return function(i){var n=i.entity(t),s=Object.assign({},n.tags),o,a;for(var l in e)if(l in s)if(e[l]==="*")o=s[l],delete s[l];else if(e[l]===s[l])delete s[l];else{var c=s[l].split(";").filter(Boolean),u=c.indexOf(e[l]);c.length===1||u===-1?delete s[l]:(r&&r[l]&&(a=u),c.splice(u,1),s[l]=c.join(";"))}if(r)for(var d in r){var h=r[d];if(h==="*"){if(s[d]&&s[d]!=="no")continue;s[d]="yes"}else if(h==="$1")s[d]=o;else if(s[d]&&e[d]&&a!==void 0){var p=s[d].split(";").filter(Boolean);p.indexOf(h)===-1&&(p.splice(a,0,h),s[d]=p.join(";"))}else s[d]=h}return i.replace(n.update({tags:s}))}}function _m(){let t="outdated_tags",e=!0,r;Qe.get("deprecated").then(o=>r=o).catch(()=>{}).finally(()=>e=!1);function i(o,a){if(!o.hasInterestingTags())return[];let l=xe.match(o,a);if(!l)return[];let c=Object.assign({},o.tags),u="deprecated_tags";if(l.replacement){let T=xe.item(l.replacement);a=Hn(o.id,l,T,!0)(a),o=a.entity(o.id),l=T}if(r){let T=o.deprecatedTags(r);T.length&&(T.forEach(k=>{a=Od(o.id,k.old,k.replace)(a)}),o=a.entity(o.id))}let d=Object.assign({},o.tags);l.tags!==l.addTags&&Object.keys(l.addTags).forEach(T=>{d[T]||(l.addTags[T]==="*"?d[T]="yes":d[T]=l.addTags[T])});let h=K.nsi,p=!1,m;if(h&&(p=h.status()==="loading",!p)){let T=o.extent(a).center();m=h.upgradeTags(d,T),m&&(d=m.newTags,u="noncanonical_brand")}let g=[];g.provisional=e||p;let y=cc(c,d);if(!y.length)return g;let v=y.every(T=>T.type==="+"),x="";m?x="noncanonical_brand.":u==="deprecated_tags"&&v&&(u="incomplete_tags",x="incomplete.");let _=[b,S("issues.fix.upgrade_tags.annotation")];return g.push(new _t({type:t,subtype:u,severity:"warning",message:E,reference:A,entityIds:[o.id],hash:Ll(JSON.stringify(y)),autoArgs:_,dynamicFixes:()=>{let T=[new Ke({autoArgs:_,title:S.html("issues.fix.upgrade_tags.title"),onClick:C=>{C.perform(b,S("issues.fix.upgrade_tags.annotation"))}})],k=m&&m.matched;return k&&T.push(new Ke({title:S.html("issues.fix.tag_as_not.title",{name:k.displayName}),onClick:C=>{C.perform(w,S("issues.fix.tag_as_not.annotation"))}})),T}})),g;function b(T){let k=T.hasEntity(o.id);if(!k)return T;let C=Object.assign({},k.tags);return y.forEach(I=>{I.type==="-"?delete C[I.key]:I.type==="+"&&(C[I.key]=I.newVal)}),er(k.id,C)(T)}function w(T){let k=T.hasEntity(o.id);if(!k)return T;let C=m&&m.matched;if(!C)return T;let I=Object.assign({},k.tags),P=C.mainTag,N=`not:${P}`,M=C.tags[P];if(I[N]=M,I[P]===M){let D=C.mainTag.replace("wikidata","wikipedia");delete I[P],delete I[D]}return er(k.id,I)(T)}function E(T){let k=T.hasEntity(o.id);if(!k)return"";let C=`issues.outdated_tags.${x}message`;return u==="noncanonical_brand"&&v&&(C+="_incomplete"),S.html(C,{feature:ft(k,T.graph(),!0)})}function A(T){let k=T.selectAll(".issue-reference").data([0]).enter();k.append("div").attr("class","issue-reference").html(S.html(`issues.outdated_tags.${x}reference`)),k.append("strong").html(S.html("issues.suggested")),k.append("table").attr("class","tagDiff-table").selectAll(".tagDiff-row").data(y).enter().append("tr").attr("class","tagDiff-row").append("td").attr("class",C=>`tagDiff-cell tagDiff-cell-${C.type==="+"?"add":"remove"}`).html(C=>C.display)}}function n(o,a){let l,c;if(o.type==="relation")c=Jc(o,a),l=o;else if(o.type==="way")l=Zc(o,a),c=o;else return[];if(!l||!c)return[];return[new _t({type:t,subtype:"old_multipolygon",severity:"warning",message:d,reference:h,entityIds:[c.id,l.id],autoArgs:[u,S("issues.fix.move_tags.annotation")],dynamicFixes:()=>[new Ke({title:S("issues.fix.move_tags.title"),onClick:p=>{p.perform(u,S("issues.fix.move_tags.annotation"))}})]})];function u(p){let m=p.hasEntity(l.id),g=p.hasEntity(c.id);return!m||!g?p:(m=m.mergeTags(g.tags),p=p.replace(m),er(g.id,{})(p))}function d(p){let m=p.hasEntity(l.id);return m?S.html("issues.old_multipolygon.message",{multipolygon:ft(m,p.graph(),!0)}):""}function h(p){p.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.old_multipolygon.reference"))}}let s=function(a,l){let c=n(a,l);return c.length||(c=i(a,l)),c};return s.type=t,s}function bm(){var t="private_data",e={detached:!0,farm:!0,house:!0,houseboat:!0,residential:!0,semidetached_house:!0,static_caravan:!0},r={amenity:!0,craft:!0,historic:!0,leisure:!0,office:!0,shop:!0,tourism:!0},i={"contact:email":!0,"contact:fax":!0,"contact:phone":!0,email:!0,fax:!0,phone:!0},n=function(o){var a=o.tags;if(!a.building||!e[a.building])return[];var l={};for(var c in a){if(r[c])return[];i[c]||(l[c]=a[c])}var u=cc(a,l);if(!u.length)return[];var d=u.length===1?"remove_tag":"remove_tags";return[new _t({type:t,severity:"warning",message:p,reference:m,entityIds:[o.id],dynamicFixes:function(){return[new Ke({icon:"rapid-operation-delete",title:S.html("issues.fix."+d+".title"),onClick:function(g){g.perform(h,S("issues.fix.upgrade_tags.annotation"))}})]}})];function h(g){var y=g.hasEntity(o.id);if(!y)return g;var v=Object.assign({},y.tags);return u.forEach(function(x){x.type==="-"?delete v[x.key]:x.type==="+"&&(v[x.key]=x.newVal)}),er(y.id,v)(g)}function p(g){var y=g.hasEntity(this.entityIds[0]);return y?S.html("issues.private_data.contact.message",{feature:ft(y,g.graph())}):""}function m(g){var y=g.selectAll(".issue-reference").data([0]).enter();y.append("div").attr("class","issue-reference").html(S.html("issues.private_data.reference")),y.append("strong").html(S.html("issues.suggested")),y.append("table").attr("class","tagDiff-table").selectAll(".tagDiff-row").data(u).enter().append("tr").attr("class","tagDiff-row").append("td").attr("class",function(v){var x=v.type==="+"?"add":"remove";return"tagDiff-cell tagDiff-cell-"+x}).html(function(v){return v.display})}};return n.type=t,n}function wm(t){var e="y_shaped_connection",r=12,i=5,n={residential:!0,service:!0,track:!0,unclassified:!0,tertiary:!0,secondary:!0,primary:!0,living_street:!0,cycleway:!0,trunk:!0,motorway:!0,road:!0,raceway:!0};function s(u){return n[u.tags.highway]}function o(u,d){var h=d.parentWays(u);return h.filter(function(p){return s(p)})}function a(u,d){var h=!on(d,[u.id]).disabled(),p;return h?p=new Ke({icon:"rapid-operation-delete",title:S("issues.fix.delete_node_around_conn.title"),entityIds:[u.id],onClick:function(){var m=this.entityIds[0],g=on(d,[m]);g.disabled()||g()}}):p=new Ke({icon:"rapid-operation-move",title:S("issues.fix.move_node_around_conn.title"),entityIds:[u.id]}),new _t({type:e,severity:"warning",message:function(){return S("issues.y_shaped_connection.message")},reference:function(m){m.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").text(S("issues.y_shaped_connection.reference"))},entityIds:[u.id],fixes:[p]})}function l(u,d,h,p){if(h<=0||h>=d.nodes.length-1)return!1;var m=d.nodes[h],g=u.entity(m),y=o(g,u);if(y.length<2)return!1;var v=d.nodes[p],x=u.entity(v),_=Tt(g.loc,x.loc);if(_>r)return!1;var b=0,w=0,E=0,A=h<p?h-1:h+1,T=d.nodes[A],k=u.entity(T),C=t.projection.project(k.loc),I=t.projection.project(g.loc),P=t.projection.project(x.loc);return A<p?(b=vr(C,I),w=vr(I,P),E=Math.abs(w-b)/Math.PI*180):(b=vr(P,I),w=vr(I,C),E=Math.abs(w-b)/Math.PI*180),E>i}var c=function(u,d){if(u.type!=="node")return[];var h=o(u,d);if(h.length!==1||!h[0].id.startsWith("w-"))return[];var p=[],m=h[0],g=m.nodes.indexOf(u.id);return g<=0||(l(d,m,g-1,g)||l(d,m,g+1,g))&&p.push(a(u,t)),p};return c.type=e,c}function Em(){let t="suspicious_name",e=["aerialway","aeroway","amenity","building","craft","highway","leisure","railway","man_made","office","shop","tourism","waterway"],r=!1;function i(c){let u=K.nsi;return u&&(r=u.status()==="loading",!r)?u.isGenericName(c):!1}function n(c,u){for(let d=0;d<e.length;d++){let h=e[d],p=u[h];if(p&&(p=p.toLowerCase(),h===c||p===c||h.replace(/\_/g," ")===c||p.replace(/\_/g," ")===c))return!0}return!1}function s(c,u){return c=c.toLowerCase(),n(c,u)||i(u)}function o(c,u,d,h){return new _t({type:t,subtype:"generic_name",severity:"warning",message:function(m){let g=m.hasEntity(this.entityIds[0]);if(!g)return"";let y=xe.match(g,m.graph()),v=h&&se.languageName(h);return S.html("issues.generic_name.message"+(v?"_language":""),{feature:y.name(),name:d,language:v})},reference:p,entityIds:[c],hash:`${u}=${d}`,dynamicFixes:function(){return[new Ke({icon:"rapid-operation-delete",title:S.html("issues.fix.remove_the_name.title"),onClick:function(m){let g=this.issue.entityIds[0],y=m.entity(g),v=Object.assign({},y.tags);delete v[u],m.perform(er(g,v),S("issues.fix.remove_generic_name.annotation"))}})]}});function p(m){m.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.generic_name.reference"))}}function a(c,u,d,h){return new _t({type:t,subtype:"not_name",severity:"warning",message:function(m){let g=m.hasEntity(this.entityIds[0]);if(!g)return"";let y=xe.match(g,m.graph()),v=h&&se.languageName(h);return S.html("issues.incorrect_name.message"+(v?"_language":""),{feature:y.name(),name:d,language:v})},reference:p,entityIds:[c],hash:`${u}=${d}`,dynamicFixes:function(){return[new Ke({icon:"rapid-operation-delete",title:S.html("issues.fix.remove_the_name.title"),onClick:function(m){let g=this.issue.entityIds[0],y=m.entity(g),v=Object.assign({},y.tags);delete v[u],m.perform(er(g,v),S("issues.fix.remove_mistaken_name.annotation"))}})]}});function p(m){m.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.generic_name.reference"))}}let l=function(u){let d=u.tags;if(!!d.wikidata||!!d["brand:wikidata"]||!!d["operator:wikidata"])return[];let p=[],m=(d["not:name"]||"").split(";");for(let g in d){let y=g.match(/^name(?:(?::)([a-zA-Z_-]+))?$/);if(!y)continue;let v=y.length>=2?y[1]:null,x=d[g];if(m.length)for(let _ in m){let b=m[_];if(b&&x===b){p.push(a(u.id,g,x,v));continue}}s(x,d)&&(p.provisional=r,p.push(o(u.id,g,x,v)))}return p};return l.type=t,l}function Sm(t){var e="unsquare_way",r=5,i=.05,n=10;function s(a,l){return a.type!=="way"||a.geometry(l)!=="area"?!1:a.tags.building&&a.tags.building!=="no"}var o=function(l,c){if(!s(l,c))return[];if(l.tags.nonsquare==="yes")return[];var u=l.isClosed();if(!u)return[];var d=c.childNodes(l).slice();if(d.length>n+1)return[];var h=K.osm;if(!h||d.some(function(b){return!h.isDataLoaded(b.loc)}))return[];var p=d.some(function(b){return c.parentWays(b).some(function(w){return w.id===l.id?!1:s(w,c)?!0:c.parentRelations(w).some(function(E){return E.isMultipolygon()&&E.tags.building&&E.tags.building!=="no"})})});if(p)return[];var m=ee("validate-square-degrees"),g=isNaN(m)?r:parseFloat(m),y=d.map(function(b){return t.projection.project(b.loc)});if(!i0(y,u,i,g,!0))return[];var v;if(!l.tags.wikidata){var x=Ka(l.id,t.projection,void 0,g);x.transitionable=!1,v=[x,S("operations.orthogonalize.annotation.feature",{n:1})]}return[new _t({type:e,subtype:"building",severity:"warning",message:function(b){var w=b.hasEntity(this.entityIds[0]);return w?S.html("issues.unsquare_way.message",{feature:ft(w,b.graph())}):""},reference:_,entityIds:[l.id],hash:g,autoArgs:v,dynamicFixes:function(){return[new Ke({icon:"rapid-operation-orthogonalize",title:S("issues.fix.square_feature.title"),onClick:function(b,w){var E=this.issue.entityIds[0];b.perform(Ka(E,b.projection,void 0,g),S("operations.orthogonalize.annotation.feature",{n:1})),window.setTimeout(function(){w()},175)}})]}})];function _(b){b.selectAll(".issue-reference").data([0]).enter().append("div").attr("class","issue-reference").html(S.html("issues.unsquare_way.buildings.reference"))}};return o.type=e,o}function Bd(t){let e=fe("validated","focusedIssue"),r=ge({},e,"on"),i={},n={},s=new Set,o=new Set,a=Ld("base"),l=Ld("head"),c=new Map,u=!1,d={},h=new Set,p,m=5e3,g=x(t.initialHashParams.validationError),y=x(t.initialHashParams.validationWarning),v=x(t.initialHashParams.validationDisable);function x(C){let I=[];return(C||"").split(",").forEach(M=>{M=M.trim();let D=M.split("/",2),F=D[0],L=D[1]||"*";!F||!L||I.push({type:N(F),subtype:N(L)})}),I;function N(M){let D=M.replace(/[-\/\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*");return new RegExp("^"+D+"$")}}r.init=()=>{Object.values(Tm).forEach(I=>{if(typeof I!="function")return;let P=I(t),N=P.type;i[N]=P});let C=ee("validate-disabledRules");C&&C.split(",").forEach(I=>n[I]=!0)};function _(C){a.queue=[],l.queue=[],Object.keys(d).forEach(I=>{window.cancelIdleCallback(I),d[I]()}),d={},h.forEach(window.clearTimeout),h.clear(),C&&s.clear(),o.clear(),a=Ld("base"),l=Ld("head"),c=new Map,u=!1}r.reset=()=>{_(!0)},r.resetIgnoredIssues=()=>{s.clear(),e.call("validated")},r.revalidateUnsquare=()=>{b(l),b(a),e.call("validated")};function b(C){let I=i.unsquare_way;if(!C.graph||typeof I!="function")return;C.uncacheIssuesOfType("unsquare_way"),t.history().tree().intersects(new le([-180,-90],[180,90]),C.graph).filter(N=>N.type==="way"&&N.tags.building&&N.tags.building!=="no").forEach(N=>{let M=I(N,C.graph);M.length&&C.cacheIssues(M)})}r.getIssues=C=>{let I=Object.assign({what:"all",where:"all",includeIgnored:!1,includeDisabledRules:!1},C),P=t.map().extent(),N=new Set,M=[];return l.graph&&l.graph!==a.graph&&Object.values(l.issuesByIssueID).forEach(F=>{let L=(F.entityIds||[]).some(B=>c.has(B));I.what==="edited"&&!L||D(F)&&(N.add(F.id),M.push(F))}),I.what==="all"&&Object.values(a.issuesByIssueID).forEach(F=>{D(F)&&(N.add(F.id),M.push(F))}),M;function D(F){if(!F||N.has(F.id)||o.has(F.id)||I.includeDisabledRules==="only"&&!n[F.type]||!I.includeDisabledRules&&n[F.type]||I.includeIgnored==="only"&&!s.has(F.id)||!I.includeIgnored&&s.has(F.id)||(F.entityIds||[]).some(L=>!t.hasEntity(L)))return!1;if(I.where==="visible"){let L=F.extent(t.graph());if(!P.intersects(L))return!1}return!0}},r.getResolvedIssues=()=>Array.from(o).map(C=>a.issuesByIssueID[C]).filter(Boolean),r.focusIssue=C=>{let I=t.graph(),P,N,M=C.extent(I);if(M&&(N=M.center()),C.entityIds&&C.entityIds.length&&(P=C.entityIds[0],P&&P.charAt(0)==="r")){let D=K9([P],I),F=D.find(L=>L.charAt(0)==="n"&&I.hasEntity(L));if(!F){let L=D.find(B=>B.charAt(0)==="w"&&I.hasEntity(B));L&&(F=I.entity(L).first())}F&&(N=I.entity(F).loc)}if(N){let D=Math.max(t.map().zoom(),19);t.map().centerZoomEase(N,D)}P&&window.setTimeout(()=>{t.enter(Se(t,[P])),e.call("focusedIssue",this,C)},250)},r.getIssuesBySeverity=C=>{let I=yr(r.getIssues(C),"severity");return I.error=I.error||[],I.warning=I.warning||[],I},r.getSharedEntityIssues=(C,I)=>{let P=["missing_tag","missing_role","outdated_tags","mismatched_geometry","crossing_ways","almost_junction","disconnected_way","impossible_oneway"],N=r.getIssues(I),M=new Set(C);return N.filter(D=>(D.entityIds||[]).some(F=>M.has(F))).sort((D,F)=>{if(D.type===F.type)return D.id<F.id?-1:1;let L=P.indexOf(D.type),B=P.indexOf(F.type);return L!==-1&&B!==-1?L-B:L===-1&&B===-1?D.type<F.type?-1:1:L!==-1?-1:1})},r.getEntityIssues=(C,I)=>r.getSharedEntityIssues([C],I),r.getRuleKeys=()=>Object.keys(i),r.isRuleEnabled=C=>!n[C],r.toggleRule=C=>{n[C]?delete n[C]:n[C]=!0,ee("validate-disabledRules",Object.keys(n).join(",")),r.validate()},r.disableRules=C=>{n={},C.forEach(I=>n[I]=!0),ee("validate-disabledRules",Object.keys(n).join(",")),r.validate()},r.ignoreIssue=C=>{s.add(C)},r.validate=()=>{let C=t.history().base();l.graph||(l.graph=C),a.graph||(a.graph=C);let I=l.graph,P=t.graph();if(P===I)return u=!0,e.call("validated"),Promise.resolve();if(p)return u=!1,p;l.graph=P,c=t.history().difference().complete();let M=[...new Gn(I,P).complete().keys()];return M=l.withAllRelatedEntities(M),M.size?(p=A(M,l).then(()=>E(M)).then(()=>e.call("validated")).catch(D=>console.error(D)).then(()=>{p=null,u||r.validate()}),p):(e.call("validated"),Promise.resolve())},t.history().on("restore.validator",r.validate).on("undone.validator",r.validate).on("redone.validator",r.validate).on("reset.validator",()=>{_(!1),r.validate()}),t.on("exit.validator",r.validate),t.history().on("merge.validator",C=>{if(!C)return;let I=t.history().base();l.graph||(l.graph=I),a.graph||(a.graph=I),C=a.withAllRelatedEntities(C),A(C,a)});function w(C,I){let P={issues:[],provisional:!1};return Object.keys(i).forEach(N),P;function N(M){let D=i[M];if(typeof D!="function"){console.error("no such validation rule = "+M);return}let F=D(C,I);F.provisional&&(P.provisional=!0),F=F.filter(L),P.issues=P.issues.concat(F);function L(B){let O=B.type,R=B.subtype||"",U;for(U=0;U<g.length;U++)if(g[U].type.test(O)&&g[U].subtype.test(R))return B.severity="error",!0;for(U=0;U<y.length;U++)if(y[U].type.test(O)&&y[U].subtype.test(R))return B.severity="warning",!0;for(U=0;U<v.length;U++)if(v[U].type.test(O)&&v[U].subtype.test(R))return!1;return!0}}}function E(C){C.forEach(I=>{let P=a.issuesByEntityID[I];P&&P.forEach(N=>{(a.issuesByIssueID[N].entityIds||[]).some(F=>c.has(F))&&!l.issuesByIssueID[N]?o.add(N):o.delete(N)})})}function A(C,I){let P=Array.from(C).map(N=>I.queuedEntityIDs.has(N)?null:(I.queuedEntityIDs.add(N),I.uncacheEntityID(N),()=>{I.queuedEntityIDs.delete(N);let M=I.graph;if(!M)return;let D=M.hasEntity(N);if(!D)return;let F=w(D,M);F.provisional&&I.provisionalEntityIDs.add(N),I.cacheIssues(F.issues)})).filter(Boolean);return I.queue=I.queue.concat(S4(P,100)),I.queuePromise||(I.queuePromise=k(I).then(()=>T(I)).catch(N=>console.error(N)).finally(()=>I.queuePromise=null)),I.queuePromise}function T(C){if(!C.provisionalEntityIDs.size)return;let I=window.setTimeout(()=>{h.delete(I),C.provisionalEntityIDs.size&&A(Array.from(C.provisionalEntityIDs),C)},m);h.add(I)}function k(C){if(!C.queue.length)return Promise.resolve();let I=C.queue.pop();return new Promise((P,N)=>{let M=window.requestIdleCallback(()=>{delete d[M],I.forEach(D=>D()),P()});d[M]=N}).then(()=>{C.queue.length%25===0&&e.call("validated")}).then(()=>k(C))}return r}function Ld(t){let e={which:t,graph:null,queue:[],queuePromise:null,queuedEntityIDs:new Set,provisionalEntityIDs:new Set,issuesByIssueID:{},issuesByEntityID:{}};return e.cacheIssue=r=>{(r.entityIds||[]).forEach(i=>{e.issuesByEntityID[i]||(e.issuesByEntityID[i]=new Set),e.issuesByEntityID[i].add(r.id)}),e.issuesByIssueID[r.id]=r},e.uncacheIssue=r=>{(r.entityIds||[]).forEach(i=>{e.issuesByEntityID[i]&&e.issuesByEntityID[i].delete(r.id)}),delete e.issuesByIssueID[r.id]},e.cacheIssues=r=>{r.forEach(e.cacheIssue)},e.uncacheIssues=r=>{r.forEach(e.uncacheIssue)},e.uncacheIssuesOfType=r=>{let i=Object.values(e.issuesByIssueID).filter(n=>n.type===r);e.uncacheIssues(i)},e.uncacheEntityID=r=>{let i=e.issuesByEntityID[r];i&&i.forEach(n=>{let s=e.issuesByIssueID[n];s?e.uncacheIssue(s):delete e.issuesByIssueID[n]}),delete e.issuesByEntityID[r],e.provisionalEntityIDs.delete(r)},e.withAllRelatedEntities=r=>{let i=new Set;return(r||[]).forEach(n=>{i.add(n);let s=e.issuesByEntityID[n];s&&s.forEach(o=>{let a=e.issuesByIssueID[o];a?(a.entityIds||[]).forEach(l=>i.add(l)):delete e.issuesByIssueID[o]})}),i},e}function ia(t,e){return e=e||{},r=>{return t.modified().forEach(i),t.created().forEach(i),r;function i(n){let s=Object.keys(n.tags),o=!1,a={};for(let l=0;l<s.length;l++){let c=s[l];e[c]||!n.tags[c]?o=!0:a[c]=n.tags[c]}o&&(r=r.replace(n.update({tags:a})))}}}var o0=dt(t1(),1);function _O(t,e){let r={};for(let s=0;s<e.length;s++){let o=e[s];r[o]?r[o].push(s):r[o]=[s]}let n=[{buffer1index:-1,buffer2index:-1,chain:null}];for(let s=0;s<t.length;s++){let o=t[s],a=r[o]||[],l=0,c=n[0];for(let u=0;u<a.length;u++){let d=a[u],h;for(h=l;h<n.length&&!(n[h].buffer2index<d&&(h===n.length-1||n[h+1].buffer2index>d));h++);if(h<n.length){let p={buffer1index:s,buffer2index:d,chain:n[h]};if(l===n.length?n.push(c):n[l]=c,l=h+1,c=p,l===n.length)break}}n[l]=c}return n[n.length-1]}function bS(t,e){let r=_O(t,e),i=[],n=t.length,s=e.length;for(let o=r;o!==null;o=o.chain){let a=n-o.buffer1index-1,l=s-o.buffer2index-1;n=o.buffer1index,s=o.buffer2index,(a||l)&&i.push({buffer1:[n+1,a],buffer1Content:t.slice(n+1,n+1+a),buffer2:[s+1,l],buffer2Content:e.slice(s+1,s+1+l)})}return i.reverse(),i}function bO(t,e,r){let i=[];function n(l,c){i.push({ab:c,oStart:l.buffer1[0],oLength:l.buffer1[1],abStart:l.buffer2[0],abLength:l.buffer2[1]})}bS(e,t).forEach(l=>n(l,"a")),bS(e,r).forEach(l=>n(l,"b")),i.sort((l,c)=>l.oStart-c.oStart);let s=[],o=0;function a(l){l>o&&(s.push({stable:!0,buffer:"o",bufferStart:o,bufferLength:l-o,bufferContent:e.slice(o,l)}),o=l)}for(;i.length;){let l=i.shift(),c=l.oStart,u=l.oStart+l.oLength,d=[l];for(a(c);i.length;){let h=i[0],p=h.oStart;if(p>u)break;u=Math.max(u,p+h.oLength),d.push(i.shift())}if(d.length===1){if(l.abLength>0){let h=l.ab==="a"?t:r;s.push({stable:!0,buffer:l.ab,bufferStart:l.abStart,bufferLength:l.abLength,bufferContent:h.slice(l.abStart,l.abStart+l.abLength)})}}else{let h={a:[t.length,-1,e.length,-1],b:[r.length,-1,e.length,-1]};for(;d.length;){l=d.shift();let x=l.oStart,_=x+l.oLength,b=l.abStart,w=b+l.abLength,E=h[l.ab];E[0]=Math.min(b,E[0]),E[1]=Math.max(w,E[1]),E[2]=Math.min(x,E[2]),E[3]=Math.max(_,E[3])}let p=h.a[0]+(c-h.a[2]),m=h.a[1]+(u-h.a[3]),g=h.b[0]+(c-h.b[2]),y=h.b[1]+(u-h.b[3]),v={stable:!1,aStart:p,aLength:m-p,aContent:t.slice(p,m),oStart:c,oLength:u-c,oContent:e.slice(c,u),bStart:g,bLength:y-g,bContent:r.slice(g,y)};s.push(v)}o=u}return a(e.length),s}function wS(t,e,r,i){i=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},i),typeof t=="string"&&(t=t.split(i.stringSeparator)),typeof e=="string"&&(e=e.split(i.stringSeparator)),typeof r=="string"&&(r=r.split(i.stringSeparator));let s=[],o=bO(t,e,r),a=[];function l(){a.length&&s.push({ok:a}),a=[]}function c(u,d){if(u.length!==d.length)return!1;for(let h=0;h<u.length;h++)if(u[h]!==d[h])return!1;return!0}return o.forEach(u=>{u.stable?a.push(...u.bufferContent):i.excludeFalseConflicts&&c(u.aContent,u.bContent)?a.push(...u.aContent):(l(),s.push({conflict:{a:u.aContent,aIndex:u.aStart,o:u.oContent,oIndex:u.oStart,b:u.bContent,bIndex:u.bStart}}))}),l(),s}function a0(t,e,r,i,n){i=i||{};var s="safe",o=[];function a(g){return typeof n=="function"?n(g):g}function l(g,y){function v(x,_){var b=1e-6;return Math.abs(x[0]-_[0])<b&&Math.abs(x[1]-_[1])<b}return s==="force_local"||v(y.loc,g.loc)?y:s==="force_remote"?y.update({loc:g.loc}):(o.push(S("merge_remote_changes.conflict.location",{user:a(g.user)})),y)}function c(g,y,v){if(s==="force_local"||(0,o0.default)(v.nodes,y.nodes))return v;if(s==="force_remote")return v.update({nodes:y.nodes});for(var x=o.length,_=g.nodes||[],b=v.nodes||[],w=y.nodes||[],E=[],A=wS(b,_,w,{excludeFalseConflicts:!0}),T=0;T<A.length;T++){var k=A[T];if(k.ok)E.push.apply(E,k.ok);else{var C=k.conflict;if((0,o0.default)(C.o,C.a))E.push.apply(E,C.b);else if((0,o0.default)(C.o,C.b))E.push.apply(E,C.a);else{o.push(S("merge_remote_changes.conflict.nodelist",{user:a(y.user)}));break}}}return o.length===x?v.update({nodes:E}):v}function u(g,y,v,x){function _(I,P){var N=x.parentWays(I).some(function(M){return M.id!==P.id});return I.hasInterestingTags()||N||x.parentRelations(I).length>0}for(var b=o.length,w=0;w<y.length;w++){var E=y[w],A=x.hasEntity(E);if(g.nodes.indexOf(E)===-1){A&&!_(A,g)&&v.removeIds.push(E);continue}var T=e.hasEntity(E),k=r.hasEntity(E),C;if(s==="force_remote"&&k&&k.visible)v.replacements.push(k);else if(s==="force_local"&&T)C=Te(T),k&&(C=C.update({version:k.version})),v.replacements.push(C);else if(s==="safe"&&T&&k&&T.version!==k.version){if(C=Te(T,{version:k.version}),k.visible?C=l(k,C):o.push(S("merge_remote_changes.conflict.deleted",{user:a(k.user)})),o.length!==b)break;v.replacements.push(C)}}return g}function d(g,y){for(var v=0;v<g.replacements.length;v++)y=y.replace(g.replacements[v]);return g.removeIds.length&&(y=ea(g.removeIds)(y)),y}function h(g,y){return s==="force_local"||(0,o0.default)(y.members,g.members)?y:s==="force_remote"?y.update({members:g.members}):(o.push(S("merge_remote_changes.conflict.memberlist",{user:a(g.user)})),y)}function p(g,y,v){if(s==="force_local"||(0,o0.default)(v.tags,y.tags))return v;if(s==="force_remote")return v.update({tags:y.tags});for(var x=o.length,_=g.tags||{},b=v.tags||{},w=y.tags||{},E=jt(jt(Object.keys(_),Object.keys(b)),Object.keys(w)).filter(function(I){return!i[I]}),A=Object.assign({},b),T=!1,k=0;k<E.length;k++){var C=E[k];_[C]!==w[C]&&b[C]!==w[C]&&(_[C]!==b[C]?o.push(S("merge_remote_changes.conflict.tags",{tag:C,local:b[C],remote:w[C],user:a(y.user)})):(w.hasOwnProperty(C)?A[C]=w[C]:delete A[C],T=!0))}return T&&o.length===x?v.update({tags:A}):v}var m=function(g){var y={replacements:[],removeIds:[]},v=g.base.entities.get(t),x=e.entity(t),_=r.entity(t),b=Te(x,{version:_.version});return _.visible?(b.type==="node"?b=l(_,b):b.type==="way"?(g.rebase(r.childNodes(_),[g],!1),b=c(v,_,b),b=u(b,jt(x.nodes,_.nodes),y,g)):b.type==="relation"&&(b=h(_,b)),b=p(v,_,b),o.length||(g=d(y,g).replace(b)),g):s==="force_remote"?ea([t])(g):s==="force_local"?(b.type==="way"&&(b=u(b,$e(x.nodes),y,g),g=d(y,g)),g.replace(b)):(o.push(S("merge_remote_changes.conflict.deleted",{user:a(_.user)})),g)};return m.withOption=function(g){return s=g,m},m.conflicts=function(){return o},m}function G2(t){var e=function(r){var i=r.hasEntity(t),n=r.base.entities.get(t);return i&&!n&&(i.type==="node"&&r.parentWays(i).forEach(function(s){s=s.removeNode(t),r=r.replace(s),s.isDegenerate()&&(r=ps(s.id)(r))}),r.parentRelations(i).forEach(function(s){s=s.removeMembersWithID(t),r=r.replace(s),s.isDegenerate()&&(r=Qr(s.id)(r))})),r.revert(t)};return e}function Ud(t){var e=fe("saveStarted","saveEnded","willAttemptUpload","progressChanged","resultNoChanges","resultErrors","resultConflicts","resultSuccess"),r=!1,i=[],n=[],s,o={};Qe.get("discarded").then(function(y){o=y}).catch(function(){});var a=ge({},e,"on");a.isSaving=function(){return r},a.save=function(y,v,x){if(!(r&&!v)){var _=t.connection();if(_){if(!_.authenticated()){_.authenticate(function(w){w||a.save(y,v,x)});return}r||(r=!0,e.call("saveStarted",this));var b=t.history();i=[],n=[],s=b.changes(ia(b.difference(),o)),v||b.perform(hr()),x?l(y):c(y)}}};function l(y){var v=t.connection();if(!v)return;var x=t.history(),_=t.graph(),b=new Dr(x.base(),!0),w=x.difference().summary(),E=[];for(let[M,D]of w)D.changeType==="modified"&&E.push(M);var A=I(E,_),T={},k=0,C=A.length;E.length?(e.call("progressChanged",this,k,C),A.forEach(function(M){T[M]=!1}),v.loadMultiple(A,P)):c(y);return;function I(M,D){var F=new Set(M);return M.forEach(function(L){var B=D.entity(L);B.type==="way"&&D.childNodes(B).forEach(function(O){O.version!==void 0&&F.add(O.id)})}),Array.from(F)}function P(M,D){if(!n.length)if(M)n.push({msg:M.message||M.responseText,details:[S("save.status_code",{code:M.status})]}),h();else{var F=[];D.data.forEach(function(L){if(b.replace(L),T[L.id]=!0,A=A.filter(function(R){return R!==L.id}),!!L.visible){var B,O;if(L.type==="way")for(B=0;B<L.nodes.length;B++)O=L.nodes[B],T[O]===void 0&&(T[O]=!1,F.push(O));else if(L.type==="relation"&&L.isMultipolygon())for(B=0;B<L.members.length;B++)O=L.members[B].id,T[O]===void 0&&(T[O]=!1,F.push(O))}}),k+=D.data.length,C+=F.length,e.call("progressChanged",this,k,C),F.length&&(A.push.apply(A,F),v.loadMultiple(F,P)),A.length||(N(),c(y))}}function N(){function M(B,O,R){return{id:B,text:O,action:function(){x.replace(R)}}}function D(B){return'<a href="'+v.userURL(B)+'" target="_blank">'+B+"</a>"}function F(B){return qt(B)||gs(B.id)+" "+B.id}function L(B,O){if(B.version!==O.version)return!1;if(B.type==="way")for(var R=jt(B.nodes,O.nodes),U=0;U<R.length;U++){var G=_.hasEntity(R[U]),$=b.hasEntity(R[U]);if(G&&$&&G.version!==$.version)return!1}return!0}E.forEach(function(B){var O=_.entity(B),R=b.entity(B);if(!L(O,R)){var U=a0(B,_,b,o,D);x.replace(U);var G=U.conflicts();if(G.length){var $=a0(B,_,b,o).withOption("force_local"),q=a0(B,_,b,o).withOption("force_remote"),ie=S("save.conflict."+(R.visible?"keep_local":"restore")),Q=S("save.conflict."+(R.visible?"keep_remote":"delete"));i.push({id:B,name:F(O),details:G,chosen:1,choices:[M(B,ie,$),M(B,Q,q)]})}}})}}function c(y){var v=t.connection();if(v||n.push({msg:"No OSM Service"}),i.length)p(y);else if(n.length)h();else{var x=t.history(),_=x.changes(ia(x.difference(),o));_.modified.length||_.created.length||_.deleted.length?(e.call("willAttemptUpload",this),v.putChangeset(y,_,u)):d()}}function u(y,v){y?y.status===409?a.save(v,!0,!0):(n.push({msg:y.message||y.responseText,details:[S("save.status_code",{code:y.status})]}),h()):m(v)}function d(){e.call("resultNoChanges",this),g(),t.flush()}function h(){t.history().pop(),e.call("resultErrors",this,n),g()}function p(y){i.sort(function(v,x){return x.id.localeCompare(v.id)}),e.call("resultConflicts",this,y,i,s),g()}function m(y){t.history().clearSaved(),e.call("resultSuccess",this,y),window.setTimeout(function(){g(),t.flush()},2500)}function g(){r=!1,e.call("saveEnded",this)}return a.cancelConflictResolution=function(){t.history().pop()},a.processResolvedConflicts=function(y){for(var v=t.history(),x=0;x<i.length;x++)if(i[x].chosen===1){var _=t.hasEntity(i[x].id);if(_&&_.type==="way")for(var b=$e(_.nodes),w=0;w<b.length;w++)v.replace(G2(b[w]));v.replace(G2(i[x].id))}a.save(y,!0,!1)},a.reset=function(){},a}var wO="Expected a function";function EO(t,e,r){var i=!0,n=!0;if(typeof t!="function")throw new TypeError(wO);return Zl(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),Gt(t,e,{leading:i,maxWait:e,trailing:n})}var Sn=EO;var Gd=class extends xr.default{constructor(e){super(),this.context=e,this.doUpdateTitle=!0,this.titleBase="Rapid";let r=Fn(window.location.hash);this._initParams=new Map(Object.entries(r)),this._initParams.has("datasets")||this._initParams.set("datasets","fbRoads,msBuildings"),this._initParams.has("disable_features")||this._initParams.set("disable_features","boundaries"),this._currParams=new Map(this._initParams),this._prevHash=null,this.setParam=this.setParam.bind(this),this.parseHash=this.parseHash.bind(this),this.updateAll=this.updateAll.bind(this),this.updateHash=this.updateHash.bind(this),this.updateTitle=this.updateTitle.bind(this),this.deferredUpdateAll=Sn(this.updateAll,500,{leading:!1}),this.deferredUpdateHash=Sn(this.updateHash,500,{leading:!1}),this.deferredUpdateTitle=Sn(this.updateTitle,500,{leading:!1})}init(){let e=this._initParams.get("id"),r=this._initParams.has("map");e&&this.context.zoomToEntity(e.split(",")[0],!r),this.enable()}enable(){this._enabled||(this._enabled=!0,this._prevHash=null,this.context.history().on("change.UrlHash",this.deferredUpdateTitle),this.context.on("enter.UrlHash",this.deferredUpdateAll),window.addEventListener("hashchange",this.parseHash),this.parseHash(),this.updateTitle())}disable(){this._enabled&&(this._enabled=!1,this._prevHash=null,this.deferredUpdateAll.cancel(),this.deferredUpdateHash.cancel(),this.deferredUpdateTitle.cancel(),this.context.history().on("change.UrlHash",null),this.context.on("enter.UrlHash",null),window.removeEventListener("hashchange",this.parseHash))}get initialHashParams(){return this._initParams}getParam(e){return this._currParams.get(e)}setParam(e,r){this._enabled&&typeof e=="string"&&(r==null||r==="undefined"||r==="null"?this._currParams.delete(e):this._currParams.set(e,r),this.deferredUpdateHash())}updateAll(){this.updateHash(),this.updateTitle()}updateHash(){if(!this._enabled)return;let e=this.context,r=["id","comment","source","hashtags","walkthrough"],i=Fi(Object.fromEntries(this._currParams),r),n=e.selectedIDs().filter(o=>e.hasEntity(o));n.length&&(i.id=n.join(","));let s="#"+xt(i,!0);s!==this._prevHash&&(window.history.replaceState(null,this.titleBase,s),this._prevHash=s)}updateTitle(){if(!this._enabled||!this.doUpdateTitle)return;let e=this.context,r=e.history().difference().summary().size,i,n=e.selectedIDs().filter(a=>e.hasEntity(a));if(n.length){let a=ft(e.entity(n[0]),e.graph());n.length>1?i=S("title.labeled_and_more",{labeled:a,count:n.length-1}):i=a}let s;r&&i?s="title.format.changes_context":r&&!i?s="title.format.changes":!r&&i&&(s="title.format.context");let o;s?o=S(s,{changes:r,base:this.titleBase,context:i}):o=this.titleBase,document.title!==o&&(document.title=o)}parseHash(){if(!this._enabled||window.location.hash===this._prevHash)return;this._prevHash=window.location.hash;let e=Fn(this._prevHash),r=this.context;if(typeof e.id=="string"){let i=e.id.split(",").filter(s=>r.hasEntity(s)),n=r.mode();i.length&&(n?.id==="browse"||n?.id==="select"&&!ni(n.selectedIDs(),i))&&r.enter(Se(r,i))}this.emit("hashchange",e)}};var SO=1,TO=4,l0=class extends ai{constructor(e){super(e),this.id="drag",this.dragTarget=null,this.lastDown=null,this.lastMove=null,this._doMove=this._doMove.bind(this),this._pointercancel=this._pointercancel.bind(this),this._pointerdown=this._pointerdown.bind(this),this._pointermove=this._pointermove.bind(this),this._pointerup=this._pointerup.bind(this)}enable(){if(this._enabled)return;this._enabled=!0,this.lastDown=null,this.lastMove=null,this.dragTarget=null;let e=this.context.map().renderer.events;e.on("modifierchanged",this._doMove),e.on("pointerover",this._doMove),e.on("pointerout",this._doMove),e.on("pointerdown",this._pointerdown),e.on("pointermove",this._pointermove),e.on("pointerup",this._pointerup),e.on("pointercancel",this._pointercancel)}disable(){if(!this._enabled)return;let e=this.lastMove;e&&this.dragTarget&&(e.target=null,this.dragTarget.feature.active=!1,this.emit("cancel",e)),this._enabled=!1,this.lastDown=null,this.lastMove=null,this.dragTarget=null;let r=this.context.map().renderer.events;r.off("modifierchanged",this._doMove),r.off("pointerover",this._doMove),r.off("pointerout",this._doMove),r.off("pointerdown",this._pointerdown),r.off("pointermove",this._pointermove),r.off("pointerup",this._pointerup),r.off("pointercancel",this._pointercancel)}_pointerdown(e){if(this.lastDown||e.pointerType==="mouse"&&e.button!==0)return;let r=this._getEventData(e),i=r.target?.data instanceof je,n=r.target?.data?.type==="midpoint";(i||n)&&r.target?.layerID==="osm"&&(this.lastDown=r,this.lastMove=null,this.dragTarget=null)}_pointermove(e){let r=this.context.map();if(r.supersurface.select(".edit-menu").size()){this._pointercancel(e);return}if(!r.renderer.events.pointerOverRenderer)return;let s=this.lastDown,o=this._getEventData(e);if(!(!s||s.id!==o.id)){if(this.lastMove=o,this.dragTarget)this._doMove();else if(s.target){let a=ut(s.coord,o.coord),l=e.pointerType==="pen"?TO:SO;if(a>=l){let c=Object.assign({},s.target);this.dragTarget=c,c.feature.active=!0;let u=new Map().set(c.data.id,c.data),d=this.context.selectedIDs();this.context.enter("drag-node",{selection:u,reselectIDs:d}),this.emit("start",s)}}}}_pointerup(e){let r=this.lastDown,i=this._getEventData(e);!r||r.id!==i.id||(this.dragTarget&&(this._snappingDisabled()?i.target=null:i.target=Object.assign({},i.target)),this.lastDown=null,this.lastMove=null,this.dragTarget&&(this.dragTarget.feature.active=!1,this.dragTarget=null,this.emit("end",i)))}_pointercancel(e){let r=this._getEventData(e);this.lastDown=null,this.lastMove=null,this.dragTarget&&(this.dragTarget.feature.active=!1,this.dragTarget=null,this.emit("cancel",r))}_snappingDisabled(){let e=this.context.map().renderer.events;if(!e.pointerOverRenderer)return!1;let r=e.modifierKeys;return r.has("Alt")||r.has("Control")||r.has("Meta")}_doMove(){if(!this._enabled||!this.lastMove)return;let e=Object.assign({},this.lastMove);this._snappingDisabled()&&(e.target=null),this.emit("move",e)}};var ES=4,SS=12,c0=class extends ai{constructor(e){super(e),this.id="draw",this._spaceClickDisabled=!1,this.lastDown=null,this.lastMove=null,this.lastSpace=null,this.lastClick=null,this._doClick=this._doClick.bind(this),this._doMove=this._doMove.bind(this),this._keydown=this._keydown.bind(this),this._keyup=this._keyup.bind(this),this._pointercancel=this._pointercancel.bind(this),this._pointerdown=this._pointerdown.bind(this),this._pointermove=this._pointermove.bind(this),this._pointerup=this._pointerup.bind(this)}enable(){if(this._enabled)return;this._enabled=!0,this.lastDown=null,this.lastMove=null,this.lastSpace=null,this.lastClick=null,this._spaceClickDisabled=!1;let e=this.context.map().renderer.events;e.on("keydown",this._keydown),e.on("keyup",this._keyup),e.on("modifierchanged",this._doMove),e.on("pointerover",this._doMove),e.on("pointerout",this._doMove),e.on("pointerdown",this._pointerdown),e.on("pointermove",this._pointermove),e.on("pointerup",this._pointerup),e.on("pointercancel",this._pointercancel)}disable(){if(!this._enabled)return;this._enabled=!1,this.lastDown=null,this.lastMove=null,this.lastSpace=null,this.lastClick=null,this._spaceClickDisabled=!1;let e=this.context.map().renderer.events;e.off("keydown",this._keydown),e.off("keyup",this._keyup),e.off("modifierchanged",this._doMove),e.off("pointerover",this._doMove),e.off("pointerout",this._doMove),e.off("pointerdown",this._pointerdown),e.off("pointermove",this._pointermove),e.off("pointerup",this._pointerup),e.off("pointercancel",this._pointercancel)}_keydown(e){["Enter","Escape","Esc"].includes(e.key)?(e.preventDefault(),this.emit("finish")):["Backspace","Delete","Del"].includes(e.key)?(e.preventDefault(),this.emit("cancel")):!this._spaceClickDisabled&&[" ","Spacebar"].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),this._spacebar())}_keyup(e){this._spaceClickDisabled&&[" ","Spacebar"].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),this._spaceClickDisabled=!1)}_pointerdown(e){if(this.lastDown)return;let r=this._getEventData(e);this.lastDown=r,this.lastClick=null,this.emit("down",r)}_pointermove(e){let r=this._getEventData(e);this.lastMove=r,this._spaceClickDisabled&&this.lastSpace&&ut(r.coord,this.lastSpace.coord)>SS&&(this._spaceClickDisabled=!1);let i=this.lastDown;i&&!i.isCancelled&&i.id===r.id&&ut(i.coord,r.coord)>=ES&&(i.isCancelled=!0),this._doMove()}_pointerup(e){let r=this.lastDown,i=this._getEventData(e);if(!r||r.id!==i.id||(this.lastDown=null,r.isCancelled))return;let n=ut(r.coord,i.coord);(n<ES||n<SS&&i.time-r.time<500)&&(this.lastClick=i,this._doClick())}_pointercancel(e){this.lastDown=null}_spacebar(){this._spaceClickDisabled||this.lastMove&&(this._spaceClickDisabled=!0,this.lastSpace=this.lastMove,this.lastClick=this.lastMove,this._doClick())}_doMove(){if(!this._enabled||!this.lastMove)return;let r=this.context.map().renderer.events;if(!r.pointerOverRenderer)return;let i=r.modifierKeys,n=i.has("Alt")||i.has("Control")||i.has("Meta"),s=Object.assign({},this.lastMove);(n||!1)&&(s.target=null),this.emit("move",s)}_doClick(){if(!this._enabled||!this.lastClick)return;let i=this.context.map().renderer.events.modifierKeys,n=i.has("Alt")||i.has("Control")||i.has("Meta"),s=Object.assign({},this.lastClick);(n||!1)&&(s.target=null),this.emit("click",s)}};var u0=class extends ai{constructor(e){super(e),this.id="hover",this.lastMove=null,this.hoverTarget=null,this._doHover=this._doHover.bind(this),this._pointermove=this._pointermove.bind(this)}enable(){if(this._enabled)return;this._enabled=!0,this.lastMove=null,this.hoverTarget=null;let e=this.context.map().renderer.events;e.on("modifierchanged",this._doHover),e.on("pointerover",this._doHover),e.on("pointerout",this._doHover),e.on("pointermove",this._pointermove)}disable(){if(!this._enabled)return;let e=this.lastMove;this.hoverTarget&&e&&(e.target=null,this._doHover()),this._enabled=!1,this.lastMove=null,this.hoverTarget=null;let r=this.context.map().renderer.events;r.off("modifierchanged",this._doHover),r.off("pointerover",this._doHover),r.off("pointerout",this._doHover),r.off("pointermove",this._pointermove)}_pointermove(e){this._enabled&&(this.lastMove=this._getEventData(e),this._doHover())}_doHover(){if(!this._enabled||!this.lastMove||this.context.behaviors.get("map-interaction").gesture)return;let i=this.context.map().renderer.events,n=i.modifierKeys,s=n.has("Alt")||n.has("Control")||n.has("Meta"),o=Object.assign({},this.lastMove);(s||!1||!i.pointerOverRenderer)&&(o.target=null);let l=this.hoverTarget?.featureID||null,c=o?.target?.featureID||null;l!==c&&(this.hoverTarget=Object.assign({},o.target),this.emit("hoverchanged",o))}};var f0=class extends ai{constructor(e){super(e),this.id="lasso",this.lasso=null,this._lassoing=!1,this._extent=null,this._coords=[],this._pointerdown=this._pointerdown.bind(this),this._pointermove=this._pointermove.bind(this),this._pointerup=this._pointerup.bind(this)}enable(){if(this._enabled)return;this._enabled=!0,this._lassoing=!1,this._extent=null;let e=this.context.map().renderer.events;e.on("pointerdown",this._pointerdown),e.on("pointermove",this._pointermove),e.on("pointerup",this._pointerup)}disable(){if(!this._enabled)return;this._enabled=!1,this._lassoing=!1,this._extent=null;let e=this.context.map().renderer.events;e.off("pointerdown",this._pointerdown),e.off("pointermove",this._pointermove),e.off("pointerup",this._pointerup)}_pointerdown(){let e=this.context.map().renderer.events;if(!e.pointerOverRenderer)return;if(e.modifierKeys.has("Shift")){this._lassoing=!0;let n=this.context.map().mouseLoc();this._extent=new le(n),this._coords.push(n)}}_pointermove(){if(!this._lassoing||!this.context.map().renderer.events.pointerOverRenderer)return;let r=this.context.map().mouseLoc();this._extent=this._extent.extend(new le(r)),this._coords.push(r);let i=this.context.scene().layers.get("map-ui");i.lassoPolygonData=this._coords,this.context.map().immediateRedraw()}_pointerup(){if(!this._lassoing)return;this._lassoing=!1;let e=this.context.scene().layers.get("map-ui"),r=this._lassoed();this._coords=[],e.lassoPolygonData=this._coords,this._extent=null,r.length&&this.context.enter(Se(this.context,r))}_normalize(e,r){return[[Math.min(e[0],r[0]),Math.min(e[1],r[1])],[Math.max(e[0],r[0]),Math.max(e[1],r[1])]]}_lassoed(){let e=this.context.graph(),r=this.context,i=this._coords;if(!this.context.editable())return[];let n=this.context.history().intersects(this._extent).filter(s=>s.type==="node"&&Pc(s.loc,i)&&!r.features().isHidden(s,e,s.geometry(e))&&!wt.blocksAt(s.loc).length);return n.sort(function(s,o){let a=e.parentWays(s),l=e.parentWays(o);if(a.length&&l.length){let c=Ir(a,l);if(c.length){let u=c[0].nodes;return u.indexOf(s.id)-u.indexOf(o.id)}else return parseFloat(a[0].id.slice(1))-parseFloat(l[0].id.slice(1))}else if(a.length||l.length)return a.length-l.length;return s.loc[0]-o.loc[0]}),n.map(s=>s.id)}};var CS=256,AO=2,CO=24,TS=di(AO,CS),AS=di(CO,CS),kO=1,IO=4,d0=class extends ai{constructor(e){super(e),this.id="map-interaction",this.lastDown=null,this.gesture=null,this.doubleClickEnabled=!0,this._click=this._click.bind(this),this._keydown=this._keydown.bind(this),this._pointerdown=this._pointerdown.bind(this),this._pointermove=this._pointermove.bind(this),this._pointerup=this._pointerup.bind(this),this._pointercancel=this._pointercancel.bind(this),this._wheel=this._wheel.bind(this)}enable(){if(this._enabled)return;this._enabled=!0,this.lastDown=null,this.gesture=null;let e=this.context.map().renderer.events;e.on("click",this._click),e.on("keydown",this._keydown),e.on("pointerdown",this._pointerdown),e.on("pointermove",this._pointermove),e.on("pointerup",this._pointerup),e.on("pointercancel",this._pointercancel),e.on("wheel",this._wheel)}disable(){if(!this._enabled)return;this._enabled=!1,this.lastDown=null,this.gesture=null;let e=this.context.map().renderer.events;e.off("click",this._click),e.off("keydown",this._keydown),e.off("pointerdown",this._pointerdown),e.off("pointermove",this._pointermove),e.off("pointerup",this._pointerup),e.off("pointercancel",this._pointercancel),e.off("wheel",this._wheel)}_keydown(e){if((document.activeElement?.tagName??"BODY")!=="BODY")return;let n=this.context.map(),s=100;if(!e.shiftKey){let[a,l]=n.dimensions,c=e.altKey||e.metaKey||e.ctrlKey,u;e.key==="ArrowLeft"?u=c?[a/2,0]:[80,0]:e.key==="ArrowRight"?u=c?[-a/2,0]:[-80,0]:e.key==="ArrowUp"?u=c?[0,l/2]:[0,80]:e.key==="ArrowDown"&&(u=c?[0,-l/2]:[0,-80]),u&&(e.preventDefault(),n.pan(u,s))}}_click(e){if(!this.doubleClickEnabled||e.detail!==2||e.pointerType==="mouse"&&e.button!==0)return;function r(d,h,p){return Math.max(h,Math.min(d,p))}let[i,n]=[e.global.x,e.global.y],s=this.context.projection.transform(),o=e.getModifierState("Shift"),a=[(i-s.x)/s.k,(n-s.y)/s.k],l=s.k*(o?.5:2);l=r(l,TS,AS);let c=i-a[0]*l,u=n-a[1]*l;this.context.map().transformEase({x:c,y:u,k:l})}_pointerdown(e){if(this.lastDown)return;let r=this.context.map().renderer.events;if(r.modifierKeys.has("Shift"))return;let i=this._getEventData(e);i.target?.data instanceof je&&i.target?.layerID==="osm"&&e.pointerType==="mouse"&&e.button===0||(this.lastDown=i,this.gesture=null,r.setCursor("grabbing"))}_pointermove(e){let r=this.lastDown,i=this._getEventData(e);if(!(!r||r.id!==i.id)){if(!this.gesture){let n=ut(r.coord,i.coord),s=r.originalEvent.pointerType==="pen"?IO:kO;this.was=[i.originalEvent.clientX,i.originalEvent.clientY],n>=s&&(this.gesture="pan")}if(this.gesture==="pan"){let n=i.originalEvent,s=this.context.projection.transform(),o=n.clientX-this.was[0],a=n.clientY-this.was[1];this.was=[n.clientX,n.clientY];let l={x:s.x+o,y:s.y+a,k:s.k};this.context.map().transform(l)}}}_pointerup(e){let r=this.lastDown,i=this._getEventData(e);if(!r||r.id!==i.id)return;this.lastDown=null,this.gesture=null,this.context.map().renderer.events.setCursor("inherit")}_pointercancel(){this.lastDown=null,this.gesture=null,this.context.map().renderer.events.setCursor("inherit")}_wheel(e){let[r,i]=[e.offsetX,e.offsetY],[n,s]=[e._normalizedDeltaX,e._normalizedDeltaY],o=this.context.projection.transform(),a;function l(c,u,d){return Math.max(u,Math.min(c,d))}if(e._gesture==="zoom"){let c=(r-o.x)/o.k,u=(i-o.y)/o.k,d=o.k*Math.pow(2,-s/500);d=l(d,TS,AS);let h=r-c*d,p=i-u*d;a={x:h,y:p,k:d}}else a={x:o.x-n,y:o.y-s,k:o.k};this.context.map().transform(a)}};var kS=.1,zd=class extends ai{constructor(e){super(e),this.id="map-nudging",this._pointermove=this._pointermove.bind(this)}enable(){if(this._enabled)return;this.context.map().renderer.events.on("pointermove",this._pointermove)}allow(){this._enabled=!0}disable(){if(!this._enabled)return;this._enabled=!1,this.context.map().renderer.events.off("pointermove",this._pointermove)}_pointermove(e){if(!this._enabled)return;let r=[e.global.x,e.global.y],i=Xf(r,this.context.map().dimensions);if(i){let[n,s]=[i[0]*kS,i[1]*kS],o=this.context.projection.transform(),a={x:o.x+n,y:o.y+s,k:o.k};this.context.map().transform(a)}}};var IS=Rr().os==="mac",h0=class extends ai{constructor(e){super(e),this.id="paste",this._keydown=this._keydown.bind(this)}enable(){if(this._enabled)return;this._enabled=!0,this.context.map().renderer.events.on("keydown",this._keydown)}disable(){if(!this._enabled)return;this._enabled=!1,this.context.map().renderer.events.off("keydown",this._keydown)}_keydown(e){(IS&&e.metaKey||!IS&&e.ctrlKey)&&e.key==="v"&&this._doPaste(e)}_doPaste(e){let r=this.context,i=r.copyIDs();if(!i.length)return;let n=r.map().renderer.events;if(!n.pointerOverRenderer)return;e.preventDefault(),e.stopPropagation();let s=r.copyGraph(),o=r.projection,a=s0(i,s);r.perform(a);let l=a.copies(),c=new le,u=new Set,d=new Set;Object.values(l).forEach(x=>d.add(x.id));for(let x in l){let _=s.entity(x),b=l[x];c=c.extend(_.extent(s)),r.graph().parentWays(b).some(A=>d.has(A.id))||u.add(b.id)}let h=r.copyLoc(),p=h&&o.project(h)||o.project(c.center()),m=n.coord||r.map().centerPoint(),g=St(m,p),y=S("operations.paste.annotation",{n:u.size});r.perform(Za(Array.from(u),g,o),y);let v=new Map;for(let x of u)v.set(x,r.entity(x));r.enter("move",{selection:v})}};var Am=4,MS=12,p0=class extends ai{constructor(e){super(e),this.id="select",this._multiSelection=new Set,this._spaceClickDisabled=!1,this._longPressTimeout=null,this._showsMenu=!1,this.lastDown=null,this.lastUp=null,this.lastMove=null,this.lastSpace=null,this.lastClick=null,this._cancelLongPress=this._cancelLongPress.bind(this),this._doLongPress=this._doLongPress.bind(this),this._keydown=this._keydown.bind(this),this._keyup=this._keyup.bind(this),this._pointercancel=this._pointercancel.bind(this),this._pointerdown=this._pointerdown.bind(this),this._pointermove=this._pointermove.bind(this),this._pointerup=this._pointerup.bind(this)}enable(){if(this._enabled)return;this._enabled=!0,this._multiSelection.clear(),this._spaceClickDisabled=!1,this._longPressTimeout=null,this._showsMenu=!1,this.lastDown=null,this.lastUp=null,this.lastMove=null,this.lastSpace=null,this.lastClick=null;let e=this.context.map().renderer.events;e.on("keydown",this._keydown),e.on("keyup",this._keyup),e.on("pointerdown",this._pointerdown),e.on("pointermove",this._pointermove),e.on("pointerup",this._pointerup),e.on("pointercancel",this._pointercancel)}disable(){if(!this._enabled)return;this._enabled=!1,this._multiSelection.clear(),this._spaceClickDisabled=!1,this._longPressTimeout=null,this._showsMenu=!1,this.lastDown=null,this.lastUp=null,this.lastMove=null,this.lastSpace=null,this.lastClick=null,this._cancelLongPress();let e=this.context.map().renderer.events;e.off("keydown",this._keydown),e.off("keyup",this._keyup),e.off("pointerdown",this._pointerdown),e.off("pointermove",this._pointermove),e.off("pointerup",this._pointerup),e.off("pointercancel",this._pointercancel)}_keydown(e){if(this._cancelLongPress(),e.key==="ContextMenu"){e.preventDefault(),this._doContextMenu();return}else if(!this._spaceClickDisabled&&[" ","Spacebar"].includes(e.key)){let r=document.activeElement;if(r&&new Set(["INPUT","TEXTAREA"]).has(r.nodeName))return;e.preventDefault(),e.stopPropagation(),this._spacebar()}}_keyup(e){this._spaceClickDisabled&&[" ","Spacebar"].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),this._spaceClickDisabled=!1)}_pointerdown(e){if(this.lastDown)return;this.context.ui().closeEditMenu(),this._showsMenu=!1;let r=this._getEventData(e);this.lastDown=r,this.lastClick=null,this._cancelLongPress(),e.pointerType==="touch"&&(this._longPressTimeout=window.setTimeout(this._doLongPress,750,r))}_pointermove(e){let r=this._getEventData(e);this.lastMove=r,this._spaceClickDisabled&&this.lastSpace&&ut(r.coord,this.lastSpace.coord)>MS&&(this._spaceClickDisabled=!1);let i=this.lastDown;i&&!i.isCancelled&&i.id===r.id&&ut(i.coord,r.coord)>=Am&&(i.isCancelled=!0)}_pointerup(e){let r=this.lastDown,i=this._getEventData(e);if(!r||r.id!==i.id||(this.lastDown=null,r.isCancelled))return;let n=ut(r.coord,i.coord),s=ut(i.coord,this.lastUp?this.lastUp.coord:0);i.event.button===0&&this.lastUp?.target?.dataID&&s<Am&&this.lastUp?.target?.dataID===i.target?.dataID&&i.time-(this.lastUp?this.lastUp.time:0)<500?(this.lastClick=this.lastUp=i,this._doDoubleClick()):(n<Am||n<MS&&i.time-r.time<500)&&(this.lastClick=this.lastUp=i,r.originalEvent.button===2?(this.context.selectedIDs().includes(r.target.dataID)||this._doSelect(),this._doContextMenu()):this._doSelect())}_pointercancel(){this.lastDown=null}_spacebar(){this._spaceClickDisabled||this.lastMove&&(this._spaceClickDisabled=!0,this.lastSpace=this.lastMove,this.lastClick=this.lastMove,this._doSelect())}_doSelect(){if(!this._enabled||!this.lastClick)return;this._cancelLongPress();let e=this.context,i=e.map().renderer.events.modifierKeys,n=i.has("Alt")||i.has("Control")||i.has("Meta"),s=i.has("Shift"),o=Object.assign({},this.lastClick);n&&(o.target=null);let a=o.target,l=a&&a.data;if(l){let c=this.context.behaviors.get("map-interaction");c.doubleClickEnabled=!1,window.setTimeout(()=>c.doubleClickEnabled=!0,500)}if(l&&l.type==="midpoint"&&(l=l.way),!l){e.photos().selectPhoto(null),e.mode().id!=="browse"&&!this._multiSelection.size&&e.enter("browse");return}if(l.__fbid__||l.__featurehash__||l instanceof Jt||l instanceof Rt){let c=new Map().set(l.id,l);e.enter("select",{selection:c});return}if(l instanceof Te){let c=e.selectedIDs();s?c.indexOf(l.id)!==-1?this._showsMenu||(c=c.filter(u=>u!==l.id),e.enter(Se(e,c))):(c=c.concat([l.id]),e.enter(Se(e,c))):(!this._showsMenu||c.length<=1||c.indexOf(l.id)===-1)&&e.enter(Se(e,[l.id]))}if(l.captured_at){let c=a.layer.id;if(!K[c])return;e.map().centerEase(l.loc),e.photos().selectPhoto(c,l.id)}if(l.first_seen_at){let c=K.mapillary;if(!c)return;this.context.map().centerEase(event.loc);let u=c.getActiveImage()&&c.getActiveImage().id;c.getDetections(l.id).then(d=>{if(d.length){let h=d[0].image.id;h===u?c.highlightDetection(d[0]).selectImage(e,h):c.loadViewerAsync(e).then(function(){c.highlightDetection(d[0]).selectImage(e,h).showViewer(e)})}})}}_cancelLongPress(){this._longPressTimeout&&(window.clearTimeout(this._longPressTimeout),this._longPressTimeout=null,this._showsMenu=!1)}_doLongPress(e){this._longPressTimeout=null,this.lastDown===e&&!e.isCancelled&&(this.lastClick=e,e.isCancelled=!0,this._doSelect(),this._doContextMenu())}_doDoubleClick(){if(!this._enabled||!this.lastUp)return;let e=this.context,r=this.lastUp.coord,i=this.lastUp.target?.data,n=i instanceof Lt&&!i.__fbid__,s=i.type==="midpoint";if(n){let o=e.graph(),a=e.projection,l=a.invert(r),c=Fr(o.childNodes(i),r,a),u=[i.nodes[c.index-1],i.nodes[c.index]];e.perform(Xr({loc:l,edge:u},je()),S("operations.add.annotation.vertex")),e.validator().validate()}else if(s){let o=[i.a.id,i.b.id];e.perform(Xr({loc:i.loc,edge:o},je()),S("operations.add.annotation.vertex")),e.validator().validate()}}_doContextMenu(){if(!this._enabled||!this.lastClick)return;let e=this.context,i=e.map().renderer.events.modifierKeys,n=i.has("Alt")||i.has("Control")||i.has("Meta"),s=Object.assign({},this.lastClick);n&&(s.target=null),this._showsMenu?(e.ui().closeEditMenu(),this._showsMenu=!1):(this._showsMenu=!0,e.ui().showEditMenu(s.coord))}};var Wr=class{constructor(e){this.context=e,this._active=!1,this._selectedData=new Map,this.operations=[]}enter(){return this._active=!0,!0}exit(){this._active=!1}get active(){return this._active}get selectedData(){return this._selectedData}get selectedIDs(){return Array.from(this._selectedData.keys())}};var PS=!1,m0=class extends Wr{constructor(e){super(e),this.id="add-note",this._click=this._click.bind(this),this._cancel=this._cancel.bind(this)}enter(){PS&&console.log("ModeAddNote: entering"),this._active=!0;let e=this.context;return e.enableBehaviors(["hover","draw","map-interaction","map-nudging"]),e.behaviors.get("draw").on("click",this._click).on("cancel",this._cancel).on("finish",this._cancel),e.history().on("undone.ModeAddNote redone.ModeAddNote",this._cancel),e.behaviors.get("map-nudging").allow(),!0}exit(){if(!this._active)return;this._active=!1,PS&&console.log("ModeAddNote: exiting");let e=this.context;e.behaviors.get("draw").off("click",this._click).off("cancel",this._cancel).off("finish",this._cancel),e.history().on("undone.ModeAddNote redone.ModeAddNote",null)}_click(e){let r=this.context,i=K.osm,n=r.projection,s=e.coord,o=n.invert(s);if(!i)return;let a=Jt({loc:o,status:"open",comments:[]});i.replaceNote(a);let l=new Map().set(a.id,a);r.enter("select",{selection:l})}_cancel(){this.context.enter("browse")}};var RS=!1,g0=class extends Wr{constructor(e){super(e),this.id="add-point",this.defaultTags={},this._click=this._click.bind(this),this._cancel=this._cancel.bind(this)}enter(){RS&&console.log("ModeAddPoint: entering"),this._active=!0;let e=this.context;return e.enableBehaviors(["hover","draw","map-interaction"]),e.behaviors.get("draw").on("click",this._click).on("cancel",this._cancel).on("finish",this._cancel),e.history().on("undone.ModeAddPoint redone.ModeAddPoint",this._cancel),!0}exit(){if(!this._active)return;RS&&console.log("ModeAddPoint: exiting"),this._active=!1;let e=this.context;e.behaviors.get("draw").off("click",this._click).off("cancel",this._cancel).off("finish",this._cancel),e.history().on("undone.ModeAddPoint redone.ModeAddPoint",null)}_click(e){let r=this.context,i=r.graph(),n=r.projection,s=e.coord,o=n.invert(s);if(wt.blocksAt(o).length)return;let a=e?.target?.data,l=e?.target?.choice,c=a&&i.hasEntity(a.id);if(c?.type==="node"){this._clickNode(c.loc,c);return}if(c?.type==="way"){let u=Fr(i.childNodes(c),s,n),d=6;if(u&&u.distance<d){let h=[c.nodes[u.index-1],c.nodes[u.index]];this._clickWay(u.loc,h);return}}this._clickNothing(o)}_clickNothing(e){let r=this.context,i=je({loc:e,tags:this.defaultTags}),n=S("operations.add.annotation.point");r.perform(Wt(i),n),r.enter(Se(r,[i.id]).newFeature(!0))}_clickWay(e,r){let i=this.context,n=je({tags:this.defaultTags}),s=S("operations.add.annotation.vertex");i.perform(Xr({loc:e,edge:r},n),s),i.enter(Se(i,[n.id]).newFeature(!0))}_clickNode(e,r){let i=this.context;if(Object.keys(this.defaultTags).length===0){i.enter(Se(i,[r.id]));return}let n=Object.assign({},r.tags);for(let o in this.defaultTags)n[o]=this.defaultTags[o];let s=S("operations.add.annotation.point");i.perform(er(r.id,n),s),i.enter(Se(i,[r.id]).newFeature(!0))}_cancel(){this.context.enter("browse")}};var NS=!1,y0=class extends Wr{constructor(e){super(e),this.context=e,this.id="browse"}enter(){return NS&&console.log("ModeBrowse: entering"),this.operations=[U2(this.context)],this._active=!0,this.context.enableBehaviors(["hover","select","drag","paste","lasso","map-interaction"]),document.activeElement&&document.activeElement.blur&&document.activeElement.blur(),!0}exit(){this._active&&(this._active=!1,NS&&console.log("ModeBrowse: exiting"))}selectBehavior(){console.error("error: do not call modeBrowse.selectBehavior anymore")}sidebar(){console.error("error: do not call modeBrowse.sidebar anymore")}};function mo(t,e){var r=function(i,n){(n===null||!isFinite(n))&&(n=1),n=Math.min(Math.max(+n,0),1);var s=i.entity(t);return i.replace(s.move(Ct(s.loc,e,n)))};return r.transitionable=!0,r}var v0=class extends Wr{constructor(e){super(e),this.id="drag-node",this.dragNode=null,this._reselectIDs=[],this._wasMidpoint=!1,this._startLoc=null,this._clickLoc=null,this._move=this._move.bind(this),this._end=this._end.bind(this),this._cancel=this._cancel.bind(this)}enter(e={}){let r=this.context,i=e.selection;if(!(i instanceof Map)||!i.size)return!1;this._reselectIDs=e.reselectIDs??[];let[n]=i.values();if(!r.editable())return!1;if(this._wasMidpoint=n.type==="midpoint",!this._wasMidpoint&&r.features().hasHiddenConnections(n,r.graph()))return r.ui().flash.duration(4e3).iconName("#rapid-icon-no").label(S("modes.drag_node.connected_to_hidden"))(),!1;if(this._active=!0,this._wasMidpoint){let a={loc:n.loc,edge:[n.a.id,n.b.id]};n=je(),r.perform(Xr(a,n)),n=r.entity(n.id)}else r.perform(hr());this.dragNode=n,this._startLoc=n.loc;let s=r.scene();s.classData("osm",this.dragNode.id,"drawing");for(let a of r.graph().parentWays(this.dragNode))s.classData("osm",a.id,"drawing");let o=r.behaviors.get("drag").lastDown.coord;return this._clickLoc=r.projection.invert(o),r.enableBehaviors(["hover","drag"]),r.behaviors.get("drag").on("move",this._move).on("end",this._end).on("cancel",this._cancel),r.history().on("undone.ModeDragNode redone.ModeDragNode",this._cancel),!0}exit(){this._active&&(this._active=!1,this.dragNode=null,this._startLoc=null,this._clickLoc=null,this._wasMidpoint=!1,this._selectedData.clear(),this.context.scene().clearClass("drawing"),this.context.behaviors.get("drag").off("move",this._move).off("end",this._end).off("cancel",this._cancel),this.context.history().on("undone.ModeDragNode redone.ModeDragNode",null))}_refreshEntities(){let r=this.context.graph();if(this._selectedData.clear(),this.dragNode=this.dragNode&&r.hasEntity(this.dragNode.id),!this.dragNode){this._cancel();return}this._selectedData.set(this.dragNode.id,this.dragNode)}_move(e){if(!this.dragNode)return;let r=this.context,i=r.graph(),n=r.projection,s=e.coord,o=e?.target?.data,a=e?.target?.choice,l=o&&i.hasEntity(o.id),c;if(l?.type==="node"&&this._canSnapToNode(l))c=l.loc;else if(l?.type==="way"){let u=Fr(i.childNodes(l),s,n,this.dragNode.id),d=6;u&&u.distance<d&&(c=u.loc)}if(!c){let u=r.projection.project(this._clickLoc),d=r.projection.project(this._startLoc),h=St(d,u),p=Ot(s,h);c=n.invert(p)}if(wt.blocksAt(c).length){this._cancel();return}r.replace(mo(this.dragNode.id,c)),this._refreshEntities()}_end(e){if(!this.dragNode)return;let r=this.context,i=r.graph(),n=this.dragNode.geometry(i)==="point",s=e?.target?.data,o=e?.target?.choice,a=s&&i.hasEntity(s.id);if(a?.type==="node"&&this._canSnapToNode(a))r.replace(n1([a.id,this.dragNode.id]),this._connectAnnotation(a));else if(a?.type==="way"){let l=Fr(i.childNodes(a),e.coord,r.projection,this.dragNode.id),c=6;if(l&&l.distance<c){let u=[a.nodes[l.index-1],a.nodes[l.index]];r.replace(Xr({loc:l.loc,edge:u},this.dragNode),this._connectAnnotation(a))}else r.replace(hr(),this._moveAnnotation())}else this._wasMidpoint?r.replace(hr(),S("operations.add.annotation.vertex")):r.replace(hr(),this._moveAnnotation());n&&r.hasEntity(this.dragNode.id)?r.enter(Se(r,[this.dragNode.id])):this._reselectIDs.length?r.enter(Se(r,this._reselectIDs)):r.enter("browse")}_moveAnnotation(){if(!this.dragNode)return;let e=this.dragNode.geometry(this.context.graph());return S(`operations.move.annotation.${e}`)}_connectAnnotation(e){if(!this.dragNode||!e)return;let r=this.context.graph(),i=this.dragNode.geometry(r),n=e.geometry(r);if(i==="vertex"&&n==="vertex"){let s=r.parentWays(this.dragNode),o=r.parentWays(e),a=Ir(s,o);if(a.length!==0)return a[0].areAdjacent(this.dragNode.id,e.id)?S("operations.connect.annotation.from_vertex.to_adjacent_vertex"):S("operations.connect.annotation.from_vertex.to_sibling_vertex")}return S(`operations.connect.annotation.from_${i}.to_${n}`)}_canSnapToNode(e){if(!this.dragNode)return!1;let r=this.context.graph();return this.dragNode.geometry(r)!=="vertex"||e.geometry(r)==="vertex"||xe.allowsVertex(e,r)}_cancel(){this.context.enter("browse")}};var Gs=!1,x0=class extends Wr{constructor(e){super(e),this.id="draw-area",this.defaultTags={},this.drawWay=null,this.drawNode=null,this.firstNode=null,this.lastNode=null,this._startGraph=null,this._move=this._move.bind(this),this._click=this._click.bind(this),this._finish=this._finish.bind(this),this._cancel=this._cancel.bind(this),this._undoOrRedo=this._undoOrRedo.bind(this)}enter(){Gs&&console.log("ModeDrawArea: entering");let e=this.context;return this._active=!0,this.defaultTags={area:"yes"},this.drawWay=null,this.drawNode=null,this.lastNode=null,this.firstNode=null,this._startGraph=e.graph(),this._selectedData.clear(),e.enableBehaviors(["hover","draw","map-interaction","map-nudging"]),e.behaviors.get("draw").on("move",this._move).on("click",this._click).on("finish",this._finish).on("cancel",this._cancel),e.history().on("undone.ModeDrawArea redone.ModeDrawArea",this._undoOrRedo),e.behaviors.get("map-interaction").doubleClickEnabled=!1,!0}exit(){if(!this._active)return;this._active=!1,Gs&&console.log("ModeDrawArea: exiting");let e=this.context;if(e.pauseChangeDispatch(),this.drawNode&&(e.pop(),this.drawWay&&(this.drawWay=e.hasEntity(this.drawWay.id))),(this.drawWay?.nodes?.length||0)<4)for(Gs&&console.log("ModeDrawArea: draw way invalid, rolling back");e.graph()!==this._startGraph;)e.pop();this.drawWay=null,this.drawNode=null,this.lastNode=null,this.firstNode=null,this._selectedData.clear(),e.scene().clearClass("drawing"),window.setTimeout(()=>{e.behaviors.get("map-interaction").doubleClickEnabled=!0},1e3),e.behaviors.get("draw").off("move",this._move).off("click",this._click).off("finish",this._finish).off("cancel",this._cancel),e.history().on("undone.ModeDrawArea redone.ModeDrawArea",null),e.resumeChangeDispatch()}_refreshEntities(){let e=this.context,r=e.scene(),i=e.graph();if(this._selectedData.clear(),r.clearClass("drawing"),this.drawWay=this.drawWay&&i.hasEntity(this.drawWay.id),this.drawNode=this.drawNode&&i.hasEntity(this.drawNode.id),this.lastNode=this.lastNode&&i.hasEntity(this.lastNode.id),this.firstNode=this.firstNode&&i.hasEntity(this.firstNode.id),!this.drawWay||!this.drawNode||!this.lastNode||!this.firstNode){this._cancel();return}this._selectedData.set(this.drawWay.id,this.drawWay),r.classData("osm",this.drawWay.id,"drawing"),r.classData("osm",this.drawNode.id,"drawing")}_getAnnotation(){let e=this.drawWay?.nodes?.length||0;if(e<4)return;let r=e>4?"continue":"start";return S(`operations.${r}.annotation.area`)}_move(e){if(!this.drawNode)return;let r=this.context,i=r.graph(),n=r.projection,s=e.coord,o=n.invert(s),a=e?.target?.data,l=e?.target?.choice,c=a&&i.hasEntity(a.id);if(c?.type==="node")o=c.loc;else if(c&&c.type==="way"){let u=Fr(i.childNodes(c),s,n,this.drawNode.id),d=6;u&&u.distance<d&&(o=u.loc)}r.replace(mo(this.drawNode.id,o)),this.drawNode=r.entity(this.drawNode.id)}_click(e){let r=this.context,i=r.graph(),n=r.projection,s=e.coord,o=n.invert(s);if(wt.blocksAt(o).length)return;r.behaviors.get("map-nudging").allow();let a=e?.target?.data,l=e?.target?.choice,c=a&&i.hasEntity(a.id);if(c?.type==="node"){this._clickNode(c.loc,c);return}if(c?.type==="way"){let u=Fr(i.childNodes(c),s,n,this.drawNode?.id),d=6;if(u&&u.distance<d){let h=[c.nodes[u.index-1],c.nodes[u.index]];this._clickWay(u.loc,h);return}}this._clickLoc(o)}_clickLoc(e){let i=this.context;if(i.pauseChangeDispatch(),this.drawWay){if(pt(e,this.lastNode.loc,1e-6)||pt(e,this.firstNode.loc,1e-6)){this._finish();return}Gs&&console.log(`ModeDrawArea: _clickLoc, extending area to ${e}`),i.replace(hr(),this._getAnnotation()),this.lastNode=this.drawNode,this.drawNode=je({loc:e}),i.perform(Wt(this.drawNode),Ui(this.drawWay.id,this.drawNode.id))}else Gs&&console.log(`ModeDrawArea: _clickLoc, starting area at ${e}`),this.firstNode=je({loc:e}),this.lastNode=this.firstNode,this.drawNode=je({loc:e}),this.drawWay=Lt({tags:this.defaultTags,nodes:[this.firstNode.id,this.drawNode.id,this.firstNode.id]}),i.perform(Wt(this.drawNode),Wt(this.firstNode),Wt(this.drawWay));this._refreshEntities(),i.resumeChangeDispatch()}_clickWay(e,r){let n=this.context,s={loc:e,edge:r};if(n.pauseChangeDispatch(),this.drawWay){if(pt(e,this.lastNode.loc,1e-6)||pt(e,this.firstNode.loc,1e-6)){this._finish();return}Gs&&console.log(`ModeDrawArea: _clickWay, extending area to edge ${r}`),n.replace(mo(this.drawNode.id,e),Xr(s,this.drawNode),this._getAnnotation()),this.lastNode=this.drawNode,this.drawNode=je({loc:e}),n.perform(Wt(this.drawNode),Ui(this.drawWay.id,this.drawNode.id))}else Gs&&console.log(`ModeDrawArea: _clickWay, starting area at edge ${r}`),this.firstNode=je({loc:e}),this.lastNode=this.firstNode,this.drawNode=je({loc:e}),this.drawWay=Lt({tags:this.defaultTags,nodes:[this.firstNode.id,this.drawNode.id,this.firstNode.id]}),n.perform(Wt(this.firstNode),Wt(this.drawNode),Wt(this.drawWay),Xr(s,this.firstNode));this._refreshEntities(),n.resumeChangeDispatch()}_clickNode(e,r){let n=this.context;if(n.pauseChangeDispatch(),this.drawWay){if(r===this.lastNode||r===this.firstNode||pt(e,this.lastNode.loc,1e-6)||pt(e,this.firstNode.loc,1e-6)){this._finish();return}Gs&&console.log(`ModeDrawArea: _clickNode, extending area to ${r.id}`),n.replace(this._actionRemoveDrawNode(this.drawWay.id,this.drawNode),Ui(this.drawWay.id,r.id),this._getAnnotation()),this.lastNode=r,n.perform(Wt(this.drawNode),Ui(this.drawWay.id,this.drawNode.id))}else Gs&&console.log(`ModeDrawArea: _clickNode, starting line at ${r.id}`),this.firstNode=r,this.lastNode=this.firstNode,this.drawNode=je({loc:e}),this.drawWay=Lt({tags:this.defaultTags,nodes:[this.firstNode.id,this.drawNode.id,this.firstNode.id]}),n.perform(Wt(this.drawNode),Wt(this.drawWay));this._refreshEntities(),n.resumeChangeDispatch()}_actionRemoveDrawNode(e,r){return function(i){return i.replace(i.entity(e).removeNode(r.id)).remove(r)}}_finish(){if(this.drawWay){Gs&&console.log(`ModeDrawArea: _finish, drawWay.id = ${this.drawWay.id}`);let e=this.context;e.enter(Se(e,[this.drawWay.id]).newFeature(!0))}else this._cancel()}_cancel(){Gs&&console.log("ModeDrawArea: _cancel"),this.drawWay=null,this.drawNode=null,this.firstNode=null,this.lastNode=null,this.context.enter("browse")}_undoOrRedo(){this._cancel()}};var ys=!1,_0=class extends Wr{constructor(e){super(e),this.id="draw-line",this.defaultTags={},this.drawWay=null,this.drawNode=null,this.firstNode=null,this.lastNode=null,this._insertIndex=void 0,this._startGraph=null,this._move=this._move.bind(this),this._click=this._click.bind(this),this._finish=this._finish.bind(this),this._cancel=this._cancel.bind(this),this._undoOrRedo=this._undoOrRedo.bind(this)}enter(e={}){let r=e.continueNode,i=e.continueWay;if(r||i){if(!(r instanceof je)||!(i instanceof Lt))return!1;ys&&console.log(`ModeDrawLine: entering, continuing line ${i.id}`)}else ys&&console.log("ModeDrawLine: entering");let n=this.context;if(this._active=!0,this.drawWay=null,this.drawNode=null,this.lastNode=null,this.firstNode=null,this._insertIndex=void 0,this._startGraph=n.graph(),this._selectedData.clear(),n.enableBehaviors(["hover","draw","map-interaction","map-nudging"]),n.behaviors.get("draw").on("move",this._move).on("click",this._click).on("finish",this._finish).on("cancel",this._cancel),n.history().on("undone.ModeDrawLine redone.ModeDrawLine",this._undoOrRedo),n.behaviors.get("map-interaction").doubleClickEnabled=!1,r&&i){let s=i.affix(r.id)==="prefix",o=s?i.last():i.first();this._insertIndex=s?0:void 0,this.lastNode=r,this.firstNode=n.entity(o),this.drawWay=i,this.drawNode=je({loc:n.map().mouseLoc()}),n.perform(Wt(this.drawNode),Ui(this.drawWay.id,this.drawNode.id,this._insertIndex)),this._refreshEntities()}return!0}exit(){if(!this._active)return;this._active=!1,ys&&console.log("ModeDrawLine: exiting");let e=this.context;if(e.pauseChangeDispatch(),this.drawNode&&(e.pop(),this.drawWay&&(this.drawWay=e.hasEntity(this.drawWay.id))),(this.drawWay?.nodes?.length||0)<2)for(ys&&console.log("ModeDrawLine: draw way invalid, rolling back");e.graph()!==this._startGraph;)e.pop();this.drawWay=null,this.drawNode=null,this.lastNode=null,this.firstNode=null,this._insertIndex=void 0,this._selectedData.clear(),e.scene().clearClass("drawing"),window.setTimeout(()=>{e.behaviors.get("map-interaction").doubleClickEnabled=!0},1e3),e.behaviors.get("draw").off("move",this._move).off("click",this._click).off("finish",this._finish).off("cancel",this._cancel),e.history().on("undone.ModeDrawLine redone.ModeDrawLine",null),e.resumeChangeDispatch()}_refreshEntities(){let e=this.context,r=e.scene(),i=e.graph();if(this._selectedData.clear(),r.clearClass("drawing"),this.drawWay=this.drawWay&&i.hasEntity(this.drawWay.id),this.drawNode=this.drawNode&&i.hasEntity(this.drawNode.id),this.lastNode=this.lastNode&&i.hasEntity(this.lastNode.id),this.firstNode=this.firstNode&&i.hasEntity(this.firstNode.id),!this.drawWay||!this.drawNode||!this.lastNode||!this.firstNode){this._cancel();return}this._selectedData.set(this.drawWay.id,this.drawWay),r.classData("osm",this.drawNode.id,"drawing"),r.classData("osm",this.drawWay.id,"drawing")}_getAnnotation(){let e=this.drawWay?.nodes?.length||0;if(e<2)return;let r=e>2?"continue":"start";return S(`operations.${r}.annotation.line`)}_move(e){if(!this.drawNode)return;let r=this.context,i=r.graph(),n=r.projection,s=e.coord,o=n.invert(s),a=e?.target?.data,l=e?.target?.choice,c=a&&i.hasEntity(a.id);if(c?.type==="node")o=c.loc;else if(c?.type==="way"){let u=Fr(i.childNodes(c),s,n,this.drawNode.id),d=6;u&&u.distance<d&&(o=u.loc)}r.replace(mo(this.drawNode.id,o)),this.drawNode=r.entity(this.drawNode.id)}_click(e){let r=this.context,i=r.graph(),n=r.projection,s=e.coord,o=n.invert(s);if(wt.blocksAt(o).length)return;r.behaviors.get("map-nudging").allow();let a=e?.target?.data,l=e?.target?.choice,c=a&&i.hasEntity(a.id);if(c?.type==="node"){this._clickNode(c.loc,c);return}if(c?.type==="way"){let u=Fr(i.childNodes(c),s,n,this.drawNode?.id),d=6;if(u&&u.distance<d){let h=[c.nodes[u.index-1],c.nodes[u.index]];this._clickWay(u.loc,h);return}}this._clickLoc(o)}_clickLoc(e){let i=this.context;if(i.pauseChangeDispatch(),this.drawWay){if(pt(e,this.lastNode.loc,1e-6)||pt(e,this.firstNode.loc,1e-6)){this._finish();return}ys&&console.log(`ModeDrawLine: _clickLoc, extending line to ${e}`),i.replace(hr(),this._getAnnotation()),this.lastNode=this.drawNode,this.drawNode=je({loc:e}),i.perform(Wt(this.drawNode),Ui(this.drawWay.id,this.drawNode.id,this._insertIndex))}else ys&&console.log(`ModeDrawLine: _clickLoc, starting line at ${e}`),this.firstNode=je({loc:e}),this.lastNode=this.firstNode,this.drawNode=je({loc:e}),this.drawWay=Lt({tags:this.defaultTags,nodes:[this.firstNode.id,this.drawNode.id]}),i.perform(Wt(this.firstNode),Wt(this.drawNode),Wt(this.drawWay));this._refreshEntities(),i.resumeChangeDispatch()}_clickWay(e,r){let n=this.context,s={loc:e,edge:r};if(n.pauseChangeDispatch(),this.drawWay){if(pt(e,this.lastNode.loc,1e-6)||pt(e,this.firstNode.loc,1e-6)){this._finish();return}ys&&console.log(`ModeDrawLine: _clickWay, extending line to edge ${r}`),n.replace(mo(this.drawNode.id,e),Xr(s,this.drawNode),this._getAnnotation()),this.lastNode=this.drawNode,this.drawNode=je({loc:e}),n.perform(Wt(this.drawNode),Ui(this.drawWay.id,this.drawNode.id,this._insertIndex))}else ys&&console.log(`ModeDrawLine: _clickWay, starting line at edge ${r}`),this.firstNode=je({loc:e}),this.lastNode=this.firstNode,this.drawNode=je({loc:e}),this.drawWay=Lt({tags:this.defaultTags,nodes:[this.firstNode.id,this.drawNode.id]}),n.perform(Wt(this.firstNode),Wt(this.drawNode),Wt(this.drawWay),Xr(s,this.firstNode));this._refreshEntities(),n.resumeChangeDispatch()}_clickNode(e,r){let n=this.context;if(n.pauseChangeDispatch(),this.drawWay){if(r===this.lastNode||r===this.firstNode||pt(e,this.lastNode.loc,1e-6)||pt(e,this.firstNode.loc,1e-6)){r===this.firstNode&&(n.replace(this._actionRemoveDrawNode(this.drawWay.id,this.drawNode),Ui(this.drawWay.id,r.id,this._insertIndex),this._getAnnotation()),this.drawNode=null),this._finish();return}ys&&console.log(`ModeDrawLine: _clickNode, extending line to ${r.id}`),n.replace(this._actionRemoveDrawNode(this.drawWay.id,this.drawNode),Ui(this.drawWay.id,r.id,this._insertIndex),this._getAnnotation()),this.lastNode=r,n.perform(Wt(this.drawNode),Ui(this.drawWay.id,this.drawNode.id,this._insertIndex))}else ys&&console.log(`ModeDrawLine: _clickNode, starting line at ${r.id}`),this.firstNode=r,this.lastNode=r,this.drawNode=je({loc:e}),this.drawWay=Lt({tags:this.defaultTags,nodes:[r.id,this.drawNode.id]}),n.perform(Wt(this.drawNode),Wt(this.drawWay));this._refreshEntities(),n.resumeChangeDispatch()}_actionRemoveDrawNode(e,r){return function(i){return i.replace(i.entity(e).removeNode(r.id)).remove(r)}}_finish(){if(this.drawWay){ys&&console.log(`ModeDrawLine: _finish, drawWay.id = ${this.drawWay.id}`);let e=this.context;e.enter(Se(e,[this.drawWay.id]).newFeature(!0))}else this._cancel()}_cancel(){ys&&console.log("ModeDrawLine: _cancel"),this.drawWay=null,this.drawNode=null,this.firstNode=null,this.lastNode=null,this.context.enter("browse")}_undoOrRedo(){this._cancel()}};var b0=class extends Wr{constructor(e){super(e),this.id="move",this._entityIDs=[],this._prevGraph=null,this._startLoc=null,this._movementCache=null,this._cancel=this._cancel.bind(this),this._finish=this._finish.bind(this),this._keydown=this._keydown.bind(this),this._pointermove=this._pointermove.bind(this),this._undoOrRedo=this._undoOrRedo.bind(this)}enter(e={}){let r=e.selection;if(!(r instanceof Map)||!r.size)return!1;this._entityIDs=[...r.keys()],this._active=!0;let i=this.context;i.features().forceVisible(this._entityIDs),i.enableBehaviors(["map-interaction","map-nudging"]),i.behaviors.get("map-nudging").allow(),this._prevGraph=null,this._startLoc=null,this._movementCache=null;let n=i.map().renderer.events;return n.on("click",this._finish),n.on("keydown",this._keydown),n.on("pointercancel",this._cancel),n.on("pointermove",this._pointermove),i.history().on("undone.ModeMove redone.ModeMove",this._undoOrRedo),!0}exit(){if(!this._active)return;this._active=!1,this._prevGraph=null,this._startLoc=null,this._movementCache=null;let e=this.context;e.features().forceVisible([]);let r=this.context.map().renderer.events;r.off("click",this._finish),r.off("keydown",this._keydown),r.off("pointercancel",this._cancel),r.off("pointermove",this._pointermove),e.history().on("undone.ModeMove redone.ModeMove",null)}_keydown(e){["Enter"].includes(e.key)?(e.preventDefault(),this._finish()):["Backspace","Delete","Del","Escape","Esc"].includes(e.key)&&(e.preventDefault(),this._cancel())}_pointermove(){let e=this.context,r;this._prevGraph!==e.graph()?(this._startLoc=e.map().mouseLoc(),this._movementCache={},r=e.perform):r=e.overwrite;let i=e.map().mouseLoc();if(wt.blocksAt(i).length){this._cancel();return}let n=e.projection.project(this._startLoc),s=e.projection.project(i),o=St(s,n);r(Za(this._entityIDs,o,e.projection,this._movementCache)),this._prevGraph=e.graph(),this._selectedData.clear();for(let a of this._entityIDs)this._selectedData.set(a,e.entity(a))}_finish(){let e=this.context;if(this._prevGraph){let r=this._entityIDs.length===1?S("operations.move.annotation."+e.graph().geometry(this._entityIDs[0])):S("operations.move.annotation.feature",{n:this._entityIDs.length});e.replace(hr(),r)}e.enter(Se(e,this._entityIDs))}_cancel(){let e=this.context;this._prevGraph&&e.pop(),e.enter(Se(e,this._entityIDs))}_undoOrRedo(){this.context.enter("browse")}};function Hd(t,e,r,i){var n=function(s){return s.update(function(o){dr(t,o).forEach(function(a){var l=Wo([i.project(a.loc)],r,e)[0];o=o.replace(a.move(i.invert(l)))})})};return n}var w0=class extends Wr{constructor(e){super(e),this.id="rotate",this._entityIDs=[],this._prevGraph=null,this._lastPoint=null,this._pivotLoc=null,this._cancel=this._cancel.bind(this),this._finish=this._finish.bind(this),this._keydown=this._keydown.bind(this),this._pointermove=this._pointermove.bind(this),this._undoOrRedo=this._undoOrRedo.bind(this)}enter(e={}){let r=e.selection;if(!(r instanceof Map)||!r.size)return!1;this._entityIDs=[...r.keys()],this._active=!0;let i=this.context;i.features().forceVisible(this._entityIDs),i.enableBehaviors(["map-interaction"]),this._prevGraph=null,this._lastPoint=null,this._pivotLoc=null;let n=i.map().renderer.events;return n.on("click",this._finish),n.on("keydown",this._keydown),n.on("pointercancel",this._cancel),n.on("pointermove",this._pointermove),i.history().on("undone.ModeRotate redone.ModeRotate",this._undoOrRedo),!0}exit(){if(!this._active)return;this._active=!1,this._prevGraph=null,this._lastPoint=null,this._pivotLoc=null;let e=this.context;e.features().forceVisible([]);let r=this.context.map().renderer.events;r.off("click",this._finish),r.off("keydown",this._keydown),r.off("pointercancel",this._cancel),r.off("pointermove",this._pointermove),e.history().on("undone.ModeRotate redone.ModeRotate",null)}_keydown(e){["Enter"].includes(e.key)?(e.preventDefault(),this._finish()):["Backspace","Delete","Del","Escape","Esc"].includes(e.key)&&(e.preventDefault(),this._cancel())}_pointermove(){let e=this.context,i=e.map().renderer.events.coord,n;if(this._prevGraph!==e.graph()?(this._pivotLoc=this._calcPivotLoc(),n=e.perform):n=e.replace,this._lastPoint){let s=e.projection.project(this._pivotLoc),[o,a]=St(i,this._lastPoint),[l,c]=[i[0]>s[0]?1:-1,i[1]>s[1]?-1:1],u=c*o+l*a,d=.3,h=u*(Math.PI/180)*d;n(Hd(this._entityIDs,s,h,e.projection)),this._prevGraph=e.graph()}this._lastPoint=i.slice(),this._selectedData.clear();for(let s of this._entityIDs)this._selectedData.set(s,e.entity(s))}_calcPivotLoc(){let e=this.context.projection,i=dr(this._entityIDs,this.context.graph()).map(s=>e.project(s.loc)),n;return i.length===1?n=i[0]:i.length===2?n=Ct(i[0],i[1],.5):Ds(i).length===2?n=Ct(i[0],i[1],.5):n=yn(Ds(i)),e.invert(n)}_finish(){let e=this.context;if(this._prevGraph){let r=this._entityIDs.length===1?S("operations.rotate.annotation."+e.graph().geometry(this._entityIDs[0])):S("operations.rotate.annotation.feature",{n:this._entityIDs.length});e.replace(hr(),r)}e.enter(Se(e,this._entityIDs))}_cancel(){let e=this.context;this._prevGraph&&e.pop(),e.enter(Se(e,this._entityIDs))}_undoOrRedo(){this.context.enter("browse")}};var go=new function(){var t="keyValue",e="keyAttributes",r="@",i=[],n=/^\s*$/,s=/^(?:true|false)$/i;function o(d){return n.test(d)?null:s.test(d)?d.toLowerCase()==="true":isFinite(d)?parseFloat(d):isFinite(Date.parse(d))?new Date(d):d}function a(){}a.prototype.toString=function(){return"null"},a.prototype.valueOf=function(){return null};function l(d){return d===null?new a:d instanceof Object?d:new d.constructor(d)}function c(d,h,p,m){var g=i.length,y=d.hasChildNodes(),v=d.hasAttributes(),x=!!(h&2),_,b,w=0,E="",A=x?{}:!0;if(y)for(var T,k=0;k<d.childNodes.length;k++)T=d.childNodes.item(k),T.nodeType===4?E+=T.nodeValue:T.nodeType===3?E+=T.nodeValue.trim():T.nodeType===1&&!T.prefix&&i.push(T);var C=i.length,I=o(E);!x&&(y||v)&&(A=h===0?l(I):{});for(var P=g;P<C;P++)_=i[P].nodeName.toLowerCase(),b=c(i[P],h,p,m),A.hasOwnProperty(_)?(A[_].constructor!==Array&&(A[_]=[A[_]]),A[_].push(b)):(A[_]=b,w++);if(v){for(var N=d.attributes.length,M=m?"":r,D=m?{}:A,F,L=0;L<N;w++,L++)F=d.attributes.item(L),D[M+F.name.toLowerCase()]=o(F.value.trim());m&&(p&&Object.freeze(D),A[e]=D,w-=N-1)}return h===3||(h===2||h===1&&w>0)&&E?A[t]=I:!x&&w===0&&E&&(A=I),p&&(x||w>0)&&Object.freeze(A),i.length=g,A}function u(d,h,p){var m,g;p instanceof String||p instanceof Number||p instanceof Boolean?h.appendChild(d.createTextNode(p.toString())):p.constructor===Date&&h.appendChild(d.createTextNode(p.toGMTString()));for(var y in p)if(m=p[y],!(isFinite(y)||m instanceof Function))if(y===t)m!==null&&m!==!0&&h.appendChild(d.createTextNode(m.constructor===Date?m.toGMTString():String(m)));else if(y===e)for(var v in m)h.setAttribute(v,m[v]);else if(y.charAt(0)===r)h.setAttribute(y.slice(1),m);else if(m.constructor===Array)for(var x=0;x<m.length;x++)g=d.createElement(y),u(d,g,m[x]),h.appendChild(g);else g=d.createElement(y),m instanceof Object?u(d,g,m):m!==null&&m!==!0&&g.appendChild(d.createTextNode(m.toString())),h.appendChild(g)}this.build=function(d,h,p,m){var g=arguments.length>1&&typeof h=="number"?h&3:1;return c(d,g,p||!1,arguments.length>3?m:g===3)},this.unbuild=function(d){var h=document.implementation.createDocument("","",null);return u(h,h,d),h},this.stringify=function(d){return new XMLSerializer().serializeToString(go.unbuild(d))}};function $d(t){var e=fe("cancel","save"),r=rt("conflicts"),i,n,s;function o(){H(document).call(r.on("\u238B",c,!0))}function a(){H(document).call(r.unbind)}function l(){a(),e.call("save")}function c(){a(),e.call("cancel")}function u(g){o();var y=g.selectAll(".header").data([0]).enter().append("div").attr("class","header fillL");y.append("button").attr("class","fr").on("click",c).call(Z("#rapid-icon-close")),y.append("h3").html(S.html("save.conflict.header"));var v=g.selectAll(".body").data([0]).enter().append("div").attr("class","body fillL"),x=v.append("div").attr("class","conflicts-help").html(S.html("save.conflict.help")),_=Rr(),b=new nn;delete b.id;var w=go.stringify(b.osmChangeJXON(i)),E=new Blob([w],{type:"text/xml;charset=utf-8;"}),A="changes.osc",T=x.selectAll(".download-changes").append("a").attr("class","download-changes");_.download?T.attr("href",window.URL.createObjectURL(E)).attr("download",A):T.attr("target","_blank").on("click.download",function(){navigator.msSaveBlob(E,A)}),T.call(Z("#rapid-icon-load","inline")).append("span").html(S.html("save.conflict.download_changes")),v.append("div").attr("class","conflict-container fillL3").call(d,0),v.append("div").attr("class","conflicts-done").attr("opacity",0).style("display","none").html(S.html("save.conflict.done"));var k=v.append("div").attr("class","buttons col12 joined conflicts-buttons");k.append("button").attr("disabled",n.length>1).attr("class","action conflicts-button col6").html(S.html("save.title")).on("click.try_again",l),k.append("button").attr("class","secondary-action conflicts-button col6").html(S.html("confirm.cancel")).on("click.cancel",c)}function d(g,y){y=Kc(y,n.length),s=y;var v=H(g.node().parentNode);y===n.length-1&&window.setTimeout(function(){v.select(".conflicts-button").attr("disabled",null),v.select(".conflicts-done").transition().attr("opacity",1).style("display","block")},250);var x=g.selectAll(".conflict").data([n[y]]);x.exit().remove();var _=x.enter().append("div").attr("class","conflict");_.append("h4").attr("class","conflict-count").html(S.html("save.conflict.count",{num:y+1,total:n.length})),_.append("a").attr("class","conflict-description").attr("href","#").html(function(w){return w.name}).on("click",function(w,E){w.preventDefault(),m(E.id)});var b=_.append("div").attr("class","conflict-detail-container");b.append("ul").attr("class","conflict-detail-list").selectAll("li").data(function(w){return w.details||[]}).enter().append("li").attr("class","conflict-detail-item").html(function(w){return w}),b.append("div").attr("class","conflict-choices").call(h),b.append("div").attr("class","conflict-nav-buttons joined cf").selectAll("button").data(["previous","next"]).enter().append("button").html(function(w){return S.html("save.conflict."+w)}).attr("class","conflict-nav-button action col6").attr("disabled",function(w,E){return E===0&&y===0||E===1&&y===n.length-1||null}).on("click",function(w,E){w.preventDefault();var A=v.selectAll(".conflict-container"),T=E==="previous"?-1:1;A.selectAll(".conflict").remove(),A.call(d,y+T)})}function h(g){var y=g.append("ul").attr("class","layer-list").selectAll("li").data(function(_){return _.choices||[]}),v=y.enter().append("li").attr("class","layer"),x=v.append("label");x.append("input").attr("type","radio").attr("name",function(_){return _.id}).on("change",function(_,b){var w=this.parentNode.parentNode.parentNode;w.__data__.chosen=b.id,p(_,w,b)}),x.append("span").html(function(_){return _.text}),v.merge(y).each(function(_){var b=this.parentNode;b.__data__.chosen===_.id&&p(null,b,_)})}function p(g,y,v){g&&g.preventDefault(),H(y).selectAll("li").classed("active",function(b){return b===v}).selectAll("input").property("checked",function(b){return b===v});var x=new le,_;_=t.graph().hasEntity(v.id),_&&(x=x.extend(_.extent(t.graph()))),v.action(),_=t.graph().hasEntity(v.id),_&&(x=x.extend(_.extent(t.graph()))),m(v.id,x)}function m(g,y){t.surface().selectAll(".hover").classed("hover",!1);var v=t.graph().hasEntity(g);v&&(y?t.map().trimmedExtent(y):t.map().zoomToEase(v),t.surface().selectAll(Ol([v.id],t.graph())).classed("hover",!0))}return u.conflictList=function(g){return arguments.length?(n=g,u):n},u.origChanges=function(g){return arguments.length?(i=g,u):i},u.shownEntityIds=function(){return n&&typeof s=="number"?[n[s].id]:[]},ge(u,e,"on")}function tl(t){var e=Er(t);e.select(".modal").classed("modal-alert",!0);var r=e.select(".content");r.append("div").attr("class","modal-section header"),r.append("div").attr("class","modal-section message-text");var i=r.append("div").attr("class","modal-section buttons cf");return e.okButton=function(){return i.append("button").attr("class","button ok-button action").on("click.confirm",function(){e.remove()}).html(S.html("confirm.okay")).node().focus(),e},e}var OS=dt(t1(),1);var MO=0;function jd(t){var e=MO++,r=H(null),i=function(v){r=v,v.each(d)},n=tr(!1),s=tr("top"),o=tr("center"),a=tr(H(null)),l,c=tr(""),u=tr(!0);i.displayType=function(v){return arguments.length?(c=tr(v),i):c},i.hasArrow=function(v){return arguments.length?(u=tr(v),i):u},i.placement=function(v){return arguments.length?(s=tr(v),i):s},i.alignment=function(v){return arguments.length?(o=tr(v),i):o},i.scrollContainer=function(v){return arguments.length?(a=tr(v),i):a},i.content=function(v){return arguments.length?(l=v,i):l},i.isShown=function(){var v=r.select(".popover-"+e);return!v.empty()&&v.classed("in")},i.show=function(){r.each(h)},i.updateContent=function(){r.each(p)},i.hide=function(){r.each(g)},i.toggle=function(){r.each(y)},i.destroy=function(v,x){x=x||".popover-"+e,v.on("pointerenter.popover",null).on("pointerleave.popover",null).on("pointerup.popover",null).on("pointerdown.popover",null).on("click.popover",null).attr("title",function(){return this.getAttribute("data-original-title")||this.getAttribute("title")}).attr("data-original-title",null).selectAll(x).remove()},i.destroyAny=function(v){v.call(i.destroy,".popover")};function d(){var v=H(this),x=n.apply(this,arguments),_=v.selectAll(".popover-"+e).data([0]),b=_.enter().append("div").attr("class","popover popover-"+e+" "+(t||"")).classed("arrowed",u.apply(this,arguments));b.append("div").attr("class","popover-arrow"),b.append("div").attr("class","popover-inner"),_=b.merge(_),x&&_.classed("fade",!0);var w=c.apply(this,arguments);if(w==="hover"){var E;v.on("pointerenter.popover",function(A){if(A.pointerType){if(A.pointerType!=="mouse"){E=A.timeStamp;return}else if(E&&A.timeStamp-E<1500)return}A.buttons===0&&h.apply(this,arguments)}).on("pointerleave.popover",function(){g.apply(this,arguments)}).on("focus.popover",function(){h.apply(this,arguments)}).on("blur.popover",function(){g.apply(this,arguments)})}else w==="clickFocus"&&(v.on("pointerdown.popover",function(A){A.preventDefault(),A.stopPropagation()}).on("pointerup.popover",function(A){A.preventDefault(),A.stopPropagation()}).on("click.popover",y),_.attr("tabindex",0).on("blur.popover",function(){v.each(function(){g.apply(this,arguments)})}))}function h(){var v=H(this),x=v.selectAll(".popover-"+e);x.empty()&&(v.call(i.destroy),v.each(d),x=v.selectAll(".popover-"+e)),x.classed("in",!0);var _=c.apply(this,arguments);_==="clickFocus"&&(v.classed("active",!0),x.node().focus()),v.each(p)}function p(){var v=H(this);l&&v.selectAll(".popover-"+e+" > .popover-inner").call(l.apply(this,arguments)),m.apply(this,arguments),m.apply(this,arguments),m.apply(this,arguments)}function m(){var v=H(this),x=v.selectAll(".popover-"+e),_=a&&a.apply(this,arguments),b=_&&!_.empty()&&_.node(),w=b?b.scrollLeft:0,E=b?b.scrollTop:0,A=s.apply(this,arguments);x.classed("left",!1).classed("right",!1).classed("top",!1).classed("bottom",!1).classed(A,!0);var T=o.apply(this,arguments),k=.5;T==="leading"?k=0:T==="trailing"&&(k=1);var C=F(v.node()),I=F(x.node()),P;switch(A){case"top":P={x:C.x+(C.w-I.w)*k,y:C.y-I.h};break;case"bottom":P={x:C.x+(C.w-I.w)*k,y:C.y+C.h};break;case"left":P={x:C.x-I.w,y:C.y+(C.h-I.h)*k};break;case"right":P={x:C.x+C.w,y:C.y+(C.h-I.h)*k};break}if(P){if(b&&(A==="top"||A==="bottom")){var N=P.x;P.x+I.w>b.offsetWidth-10?P.x=b.offsetWidth-10-I.w:P.x<10&&(P.x=10);var M=v.selectAll(".popover-"+e+" > .popover-arrow"),D=Math.min(Math.max(I.w/2-(P.x-N),10),I.w-10);M.style("left",~~D+"px")}x.style("left",~~P.x+"px").style("top",~~P.y+"px")}else x.style("left",null).style("top",null);function F(L){var B=H(L).style("position");return B==="absolute"||B==="static"?{x:L.offsetLeft-w,y:L.offsetTop-E,w:L.offsetWidth,h:L.offsetHeight}:{x:0,y:0,w:L.offsetWidth,h:L.offsetHeight}}}function g(){var v=H(this);c.apply(this,arguments)==="clickFocus"&&v.classed("active",!1),v.selectAll(".popover-"+e).classed("in",!1)}function y(){H(this).select(".popover-"+e).classed("in")?g.apply(this,arguments):h.apply(this,arguments)}return i}function Ae(t){var e=jd((t||"")+" tooltip").displayType("hover"),r=function(){var s=this.getAttribute("data-original-title");return s||(s=this.getAttribute("title"),this.removeAttribute("title"),this.setAttribute("data-original-title",s),s)},i=tr(null),n=tr(null);return e.title=function(s){return arguments.length?(r=tr(s),e):r},e.heading=function(s){return arguments.length?(i=tr(s),e):i},e.keys=function(s){return arguments.length?(n=tr(s),e):n},e.content(function(){var s=i.apply(this,arguments),o=r.apply(this,arguments),a=n.apply(this,arguments);return function(l){var c=l.selectAll(".tooltip-heading").data(s?[s]:[]);c.exit().remove(),c.enter().append("div").attr("class","tooltip-heading").merge(c).html(s);var u=l.selectAll(".tooltip-text").data(o?[o]:[]);u.exit().remove(),u.enter().append("div").attr("class","tooltip-text").merge(u).html(o);var d=l.selectAll(".keyhint-wrap").data(a&&a.length?[0]:[]);d.exit().remove();var h=d.enter().append("div").attr("class","keyhint-wrap");h.append("span").html(S.html("tooltip_keyhint")),d=h.merge(d),d.selectAll("kbd.shortcut").data(a&&a.length?a:[]).enter().append("kbd").attr("class","shortcut").html(function(p){return p})}}),e}var Vd;function At(t,e){var r=fe("accept","cancel"),i=t.container(),n=[],s=[],o={},a=null,l=!0,c=!1,u=!1,d=2,h=0,p,m,g=function(v,x){x(s.filter(function(_){var b=_.terms||[];return b.push(_.value),b.some(function(w){return w.toString().toLowerCase().indexOf(v.toLowerCase())!==-1})}))},y=function(v,x){if(!v||v.empty())return;v.classed("combobox-input",!0).on("focus.combo-input",w).on("blur.combo-input",E).on("keydown.combo-input",k).on("keyup.combo-input",C).on("input.combo-input",I).on("mousedown.combo-input",_).each(function(){var R=this.parentNode,U=this.nextSibling;H(R).selectAll(".combobox-caret").filter(function(G){return G===v.node()}).data([v.node()]).enter().insert("div",function(){return U}).attr("class","combobox-caret").on("mousedown.combo-caret",function(G){G.preventDefault(),v.node().focus(),_(G)}).on("mouseup.combo-caret",function(G){G.preventDefault(),b(G)})});function _(R){if(R.button===0){h=+new Date;var U=v.property("selectionStart"),G=v.property("selectionEnd");if(U!==G){var $=De(v);v.node().setSelectionRange($.length,$.length);return}v.on("mouseup.combo-input",b)}}function b(R){if(v.on("mouseup.combo-input",null),R.button===0&&v.node()===document.activeElement){var U=v.property("selectionStart"),G=v.property("selectionEnd");if(U===G){var $=i.selectAll(".combobox");if($.empty()||$.datum()!==v.node()){var q=h;window.setTimeout(function(){q===h&&D("",function(){A(),L()})},250)}else T()}}}function w(){D("")}function E(){Vd=window.setTimeout(T,75)}function A(){T(),i.insert("div",":first-child").datum(v.node()).attr("class","combobox"+(e?" combobox-"+e:"")).style("position","absolute").style("display","block").style("left","0px").on("mousedown.combo-container",function(R){R.preventDefault()}),i.on("scroll.combo-scroll",L,!0)}function T(){Vd&&(window.clearTimeout(Vd),Vd=void 0),i.selectAll(".combobox").remove(),i.on("scroll.combo-scroll",null)}function k(R){var U=!i.selectAll(".combobox").empty(),G=v.node()?v.node().tagName.toLowerCase():"";switch(R.keyCode){case 8:case 46:R.stopPropagation(),a=null,L(),v.on("input.combo-input",function(){var $=v.property("selectionStart");v.node().setSelectionRange($,$),v.on("input.combo-input",I)});break;case 9:B(R);break;case 13:R.preventDefault(),R.stopPropagation();break;case 38:if(G==="textarea"&&!U)return;R.preventDefault(),G==="input"&&!U&&A(),P(-1);break;case 40:if(G==="textarea"&&!U)return;R.preventDefault(),G==="input"&&!U&&A(),P(1);break}}function C(R){switch(R.keyCode){case 27:O();break;case 13:B(R);break}}function I(){D(M(),function(){a=null;var R=v.property("value");if(n.length&&(v.property("selectionEnd")===R.length&&(a=F()),a||(a=R)),R.length){var U=i.selectAll(".combobox");U.empty()&&A()}else T();L()})}function P(R){if(n.length){for(var U=-1,G=0;G<n.length;G++)if(a&&n[G].value===a){U=G;break}U=Math.max(Math.min(U+R,n.length-1),0),a=n[U].value,v.property("value",a)}L(),N()}function N(){var R=i.selectAll(".combobox");if(!R.empty()){var U=i.node().getBoundingClientRect(),G=R.node().getBoundingClientRect();if(G.bottom>U.bottom){var $=x?x.node():v.node();$.scrollIntoView({behavior:"instant",block:"center"}),L()}var q=R.selectAll(".combobox-option.selected").node();q&&q.scrollIntoView({behavior:"smooth",block:"nearest"})}}function M(){var R=v.property("value"),U=v.property("selectionStart"),G=v.property("selectionEnd");return U&&G&&(R=R.substring(0,U)),R}function D(R,U){u=!1,g.call(v,R,function(G){u||(n=G,G.forEach(function($){o[$.value]=$}),U&&U())})}function F(){if(l){var R=c?M():M().toLowerCase();if(R&&!(!isNaN(parseFloat(R))&&isFinite(R))){for(var U=-1,G=0;G<n.length;G++){var $=n[G].value,q=c?$:$.toLowerCase();if(q===R){U=G;break}else U===-1&&q.indexOf(R)===0&&(U=G)}if(U!==-1){var ie=n[U].value;return v.property("value",ie),v.node().setSelectionRange(R.length,ie.length),ie}}}}function L(){if(n.length<d||document.activeElement!==v.node()){T();return}var R=!i.selectAll(".combobox").empty();if(R){var U=i.selectAll(".combobox"),G=U.selectAll(".combobox-option").data(n,function(Q){return Q.value});G.exit().remove(),G.enter().append("a").attr("class",function(Q){return"combobox-option "+(Q.klass||"")}).attr("title",function(Q){return Q.title}).html(function(Q){return Q.display||Q.value}).on("mouseenter",p).on("mouseleave",m).merge(G).classed("selected",function(Q){return Q.value===a}).on("click.combo-option",B).order();var $=x?x.node():v.node(),q=i.node().getBoundingClientRect(),ie=$.getBoundingClientRect();U.style("left",ie.left+5-q.left+"px").style("width",ie.width-10+"px").style("top",ie.height+ie.top-q.top+"px")}}function B(R,U){u=!0;var G=v.node();U&&(De(v,U.value),E0(v,"change"));var $=De(v);G.setSelectionRange($.length,$.length),U=o[$],r.call("accept",G,U,$),T()}function O(){u=!0;var R=v.node(),U=De(v),G=v.property("selectionStart"),$=v.property("selectionEnd");U=U.slice(0,G)+U.slice($),De(v,U),R.setSelectionRange(U.length,U.length),r.call("cancel",R),T()}};return y.canAutocomplete=function(v){return arguments.length?(l=v,y):l},y.caseSensitive=function(v){return arguments.length?(c=v,y):c},y.data=function(v){return arguments.length?(s=v,y):s},y.fetcher=function(v){return arguments.length?(g=v,y):g},y.minItems=function(v){return arguments.length?(d=v,y):d},y.itemsMouseEnter=function(v){return arguments.length?(p=v,y):p},y.itemsMouseLeave=function(v){return arguments.length?(m=v,y):m},ge(y,r,"on")}At.off=function(t,e){t.on("focus.combo-input",null).on("blur.combo-input",null).on("keydown.combo-input",null).on("keyup.combo-input",null).on("input.combo-input",null).on("mousedown.combo-input",null).on("mouseup.combo-input",null),e.container().on("scroll.combo-scroll",null)};function yo(t){var e=t.qid?K.wikidata:K.osmWikibase,r={},i=H(null),n=H(null),s,o;function a(){e&&(i.classed("tag-reference-loading",!0),e.getDocs(t,l))}function l(d,h){if(n.html(""),!h||!h.title){n.append("p").attr("class","tag-reference-description").html(S.html("inspector.no_documentation_key")),c();return}h.imageURL?n.append("img").attr("class","tag-reference-wiki-image").attr("src",h.imageURL).on("load",function(){c()}).on("error",function(){H(this).remove(),c()}):c(),n.append("p").attr("class","tag-reference-description").html(h.description?se.htmlForLocalizedText(h.description,h.descriptionLocaleCode):S.html("inspector.no_documentation_key")).append("a").attr("class","tag-reference-edit").attr("target","_blank").attr("title",S("inspector.edit_reference")).attr("href",h.editURL).call(Z("#rapid-icon-edit","inline")),h.wiki&&n.append("a").attr("class","tag-reference-link").attr("target","_blank").attr("href",h.wiki.url).call(Z("#rapid-icon-out-link","inline")).append("span").html(S.html(h.wiki.text)),t.key==="comment"&&n.append("a").attr("class","tag-reference-comment-link").attr("target","_blank").call(Z("#rapid-icon-out-link","inline")).attr("href",S("commit.about_changeset_comments_link")).append("span").html(S.html("commit.about_changeset_comments"))}function c(){s=!0,i.classed("tag-reference-loading",!1),n.classed("expanded",!0).transition().duration(200).style("max-height","200px").style("opacity","1"),o=!0,i.selectAll("svg.icon use").each(function(){var d=H(this);d.attr("href")==="#rapid-icon-info"&&d.attr("href","#rapid-icon-info-filled")})}function u(){n.transition().duration(200).style("max-height","0px").style("opacity","0").on("end",function(){n.classed("expanded",!1)}),o=!1,i.selectAll("svg.icon use").each(function(){var d=H(this);d.attr("href")==="#rapid-icon-info-filled"&&d.attr("href","#rapid-icon-info")})}return r.button=function(d,h,p){i=d.selectAll(".tag-reference-button").data([0]),i=i.enter().append("button").attr("class","tag-reference-button "+(h||"")).attr("title",S("icons.information")).call(Z("#rapid-icon-"+(p||"inspect"))).merge(i),i.on("click",function(m){m.stopPropagation(),m.preventDefault(),this.blur(),o?u():s?c():a()})},r.body=function(d){var h=t.qid||t.key+"-"+(t.value||"");n=d.selectAll(".tag-reference-body").data([h],function(p){return p}),n.exit().remove(),n=n.enter().append("div").attr("class","tag-reference-body").style("max-height","0").style("opacity","0").merge(n),o===!1&&u()},r.showing=function(d){return arguments.length?(o=d,r):o},r}function vs(t,e,r,i){i=Object.assign({show:!0,wrap:!0,remove:!0,revert:!0,info:!0},i);var n=r?r.some(function(x){return x.__fbid__&&(x.tags.source==="maxar"||x.tags.source==="digitalglobe")}):!1;n&&(i.remove=!1,i.revert=!1);var s=fe("change","revert"),o=Object.assign({},e);o.domId=ss("form-field-"+o.safeid);var a=i.show,l="",c={},u=null;r&&r.length&&(u=vt(r,t.graph()));var d=!1,h=Ae().title(S.html("inspector.lock.suggestion",{label:o.label})).placement("bottom");o.keys=o.keys||[o.key],a&&!o.impl&&p();function p(){o.impl=S0[o.type](o,t).on("change",function(x,_){s.call("change",o,x,_)}),r&&(o.entityIDs=r,o.impl.entityIDs&&o.impl.entityIDs(r))}function m(){return!r||!r.length?!1:r.some(function(x){var _=t.graph().base.entities.get(x),b=t.graph().entity(x);return o.keys.some(function(w){return _?b.tags[w]!==_.tags[w]:b.tags[w]})})}function g(){return o.keys.some(function(x){if(o.type==="multiCombo"){for(var _ in c)if(_.indexOf(x)===0)return!0;return!1}return c[x]!==void 0})}function y(x,_){x.stopPropagation(),x.preventDefault(),!(!r||d)&&s.call("revert",_,_.keys)}function v(x,_){if(x.stopPropagation(),x.preventDefault(),!d){var b={};_.keys.forEach(function(w){b[w]=void 0}),s.call("change",_,b)}}return o.render=function(x){var _=x.selectAll(".form-field").data([o]),b=_.enter().append("div").attr("class",function(k){return"form-field form-field-"+k.safeid}).classed("nowrap",!i.wrap);if(i.wrap){var w=b.append("label").attr("class","field-label").attr("for",function(k){return k.domId}),E=w.append("span").attr("class","label-text");E.append("span").attr("class","label-textvalue").html(function(k){return k.label()}),E.append("span").attr("class","label-textannotation"),i.remove&&w.append("button").attr("class","remove-icon").attr("title",S("icons.remove")).call(Z("#rapid-operation-delete")),i.revert&&w.append("button").attr("class","modified-icon").attr("title",S("icons.undo")).call(Z(se.textDirection()==="rtl"?"#rapid-icon-redo":"#rapid-icon-undo"))}_=_.merge(b),_.select(".field-label > .remove-icon").on("click",v),_.select(".field-label > .modified-icon").on("click",y),_.each(function(k){var C=H(this);k.impl||p();var I,P;if(i.wrap&&i.info){var N=k.key||"";k.type==="multiCombo"&&(N=N.replace(/:$/,"")),I=yo(k.reference||{key:N},t),l==="hover"&&I.showing(!1)}C.call(k.impl),P&&C.call(P.body).select(".field-label").call(P.button),I&&C.call(I.body).select(".field-label").call(I.button),k.impl.tags(c)}),_.classed("locked",d).classed("modified",m()).classed("present",g());var A=_.selectAll(".field-label .label-textannotation"),T=A.selectAll(".icon").data(d?[0]:[]);T.exit().remove(),T.enter().append("svg").attr("class","icon").append("use").attr("xlink:href","#fas-lock"),_.call(d?h:h.destroy)},o.state=function(x){return arguments.length?(l=x,o):l},o.tags=function(x){return arguments.length?(c=x,g()&&!a&&(a=!0,o.impl||p()),o):c},o.locked=function(x){return arguments.length?(d=x,o):d},o.show=function(){if(a=!0,o.impl||p(),o.default&&o.key&&c[o.key]!==o.default){var x={};x[o.key]=o.default,s.call("change",this,x)}},o.isShown=function(){return a},o.isAllowed=function(){if(r&&r.length>1&&S0[o.type].supportsMultiselection===!1||o.geometry&&!r.every(function(b){return o.matchGeometry(t.graph().geometry(b))}))return!1;if(r&&u&&o.locationSetID){var x=wt.locationSetsAt(u.center());if(!x[o.locationSetID])return!1}var _=o.prerequisiteTag;return!(r&&!g()&&_&&!r.every(function(b){var w=t.graph().entity(b);if(_.key){var E=w.tags[_.key];if(!E)return!1;if(_.valueNot)return _.valueNot!==E;if(_.value)return _.value===E}else if(_.keyNot&&w.tags[_.keyNot])return!1;return!0}))},o.focus=function(){o.impl&&o.impl.focus()},ge(o,s,"on")}function T0(t){var e=At(t,"more-fields").minItems(1),r=[],i="",n="",s="";function o(a){var l=r.filter(function(b){return b.isAllowed()}),c=l.filter(function(b){return b.isShown()}),u=l.filter(function(b){return!b.isShown()}),d=a.selectAll(".form-fields-container").data([0]);d=d.enter().append("div").attr("class","form-fields-container "+(s||"")).merge(d);var h=d.selectAll(".wrap-form-field").data(c,function(b){return b.id+(b.entityIDs?b.entityIDs.join():"")});h.exit().remove();var p=h.enter().append("div").attr("class",function(b){return"wrap-form-field wrap-form-field-"+b.safeid});h=h.merge(p),h.order().each(function(b){H(this).call(b.render)});var m=[],g=u.map(function(b){var w=b.title();m.push(w);var E=b.terms();return b.key&&E.push(b.key),b.keys&&(E=E.concat(b.keys)),{display:b.label(),value:w,title:w,field:b,terms:E}}),y=m.slice(0,3).join(", ")+(m.length>3?"\u2026":""),v=a.selectAll(".more-fields").data(n==="hover"||g.length===0?[]:[0]);v.exit().remove();var x=v.enter().append("div").attr("class","more-fields").append("label");x.append("span").html(S.html("inspector.add_fields")),v=x.merge(v);var _=v.selectAll(".value").data([0]);_.exit().remove(),_=_.enter().append("input").attr("class","value").attr("type","text").attr("placeholder",y).call(qe).merge(_),_.call(De,"").call(e.data(g).on("accept",function(b){if(b){var w=b.field;w.show(),a.call(o),w.focus()}})),i!==y&&(_.attr("placeholder",y),i=y)}return o.fieldsArr=function(a){return arguments.length?(r=a||[],o):r},o.state=function(a){return arguments.length?(n=a,o):n},o.klass=function(a){return arguments.length?(s=a,o):s},o}function Xd(t){var e=fe("change"),r=T0(t),i=At(t,"comment").caseSensitive(!0),n,s,o;function a(c){l(c)}function l(c){var u=!1;if(!n){u=!0;var d=xe;n=[vs(t,d.field("comment"),null,{show:!0,revert:!1}),vs(t,d.field("source"),null,{show:!1,revert:!1}),vs(t,d.field("hashtags"),null,{show:!1,revert:!1})],n.forEach(function(x){x.on("change",function(_,b){e.call("change",x,void 0,_,b)})})}if(n.forEach(function(x){x.tags(s)}),c.call(r.fieldsArr(n)),u){var h=c.select(".form-field-comment textarea"),p=h.node();p&&(p.focus(),p.select()),E0(h,"blur");var m=t.connection();m&&m.userChangesets(function(x,_){if(!x){var b=_.map(function(w){var E=w.tags.comment;return E?{title:E,value:E}:null}).filter(Boolean);h.call(i.data(ac(b,"title")))}})}var g=s.comment.match(/google/i),y=c.select(".form-field-comment").selectAll(".comment-warning").data(g?[0]:[]);y.exit().transition().duration(200).style("opacity",0).remove();var v=y.enter().insert("div",".tag-reference-body").attr("class","field-warning comment-warning").style("opacity",0);v.append("a").attr("target","_blank").call(Z("#rapid-icon-alert","inline")).attr("href",S("commit.google_warning_link")).append("span").html(S.html("commit.google_warning")),v.transition().duration(200).style("opacity",1)}return a.tags=function(c){return arguments.length?(s=c,a):s},a.changesetID=function(c){return arguments.length?(o===c||(o=c,n=null),a):o},ge(a,e,"on")}function A0(t,e){return function(r){r.style("opacity",t?0:1).classed("hide",!1).transition().style("opacity",t?1:0).on("end",function(){H(this).classed("hide",!t).style("opacity",null),e&&e.apply(this)})}}function s1(t,e,r){let i=fe("toggled"),n,s=tr(""),o=!0,a=function(){},l=function(c){if(n==null){let m=ee(`disclosure.${e}.expanded`);n=m===null?!!r:m==="true"}let u=c.selectAll(`.hide-toggle-${e}`).data([0]),d=u.enter().append("a").attr("href","#").attr("class",`hide-toggle hide-toggle-${e}`).call(Z("","pre-text","hide-toggle-icon"));d.append("span").attr("class","hide-toggle-text"),u=d.merge(u),u.on("click",p).classed("expanded",n),u.selectAll(".hide-toggle-text").html(s()),u.selectAll(".hide-toggle-icon").attr("xlink:href",n?"#rapid-icon-down":se.textDirection()==="rtl"?"#rapid-icon-backward":"#rapid-icon-forward");let h=c.selectAll(".disclosure-wrap").data([0]);h=h.enter().append("div").attr("class",`disclosure-wrap disclosure-wrap-${e}`).merge(h).classed("hide",!n),n&&h.call(a);function p(m){m.preventDefault(),n=!n,o&&ee(`disclosure.${e}.expanded`,n),u.classed("expanded",n),u.selectAll(".hide-toggle-icon").attr("xlink:href",n?"#rapid-icon-down":se.textDirection()==="rtl"?"#rapid-icon-backward":"#rapid-icon-forward"),h.call(A0(n)),n&&h.call(a),i.call("toggled",this,n)}};return l.label=c=>arguments.length?(s=tr(c),l):s,l.expanded=c=>arguments.length?(n=c,l):n,l.updatePreference=c=>arguments.length?(o=c,l):o,l.content=c=>arguments.length?(a=c,l):a,ge(l,i,"on")}function mt(t,e){let r=tr(""),i,n,s,o,a=tr(!0),l,c,u=H(null),d={id:t};d.classes=function(p){return arguments.length?(r=tr(p),d):r},d.label=function(p){return arguments.length?(o=tr(p),d):o},d.expandedByDefault=function(p){return arguments.length?(a=tr(p),d):a},d.shouldDisplay=function(p){return arguments.length?(i=tr(p),d):i},d.content=function(p){return arguments.length?(n=p,d):n},d.disclosureContent=function(p){return arguments.length?(l=p,d):l},d.disclosureExpanded=function(p){return arguments.length?(c=p,d):c},d.render=function(p){u=p.selectAll(`.section-${t}`).data([0]),u=u.enter().append("div").attr("class",`section section-${t} `+(r&&r()||"")).merge(u),u.call(h)},d.reRender=function(){u.call(h)},d.selection=function(){return u},d.disclosure=function(){return s};function h(p){if(i){let m=i();if(p.classed("hide",!m),!m){p.html("");return}}if(l){s||(s=s1(e,t.replace(/-/g,"_"),a()).label(o||"").content(l)),c!==void 0&&(s.expanded(c),c=void 0),p.call(s);return}n&&p.call(n)}return d}function Wd(t){var e=Rr(),r={};Qe.get("discarded").then(function(s){r=s}).catch(function(){});var i=mt("changes-list",t).label(function(){var s=t.history(),o=s.difference().summary();return S("inspector.title_count",{title:S.html("commit.changes"),count:o.size})}).disclosureContent(n);function n(s){var o=t.history(),a=[...o.difference().summary().values()],l=s.selectAll(".commit-section").data([0]),c=l.enter().append("div").attr("class","commit-section");c.append("ul").attr("class","changeset-list"),l=c.merge(l);var u=l.select("ul").selectAll("li").data(a),d=u.enter().append("li").attr("class","change-item"),h=d.append("button").on("mouseover",_).on("mouseout",b).on("click",w);h.each(function(E){H(this).call(Z("#rapid-icon-"+E.entity.geometry(E.graph),"pre-text "+E.changeType))}),h.append("span").attr("class","change-type").html(function(E){return S.html("commit."+E.changeType)+" "}),h.append("strong").attr("class","entity-type").html(function(E){var A=xe.match(E.entity,E.graph);return A&&A.name()||gs(E.entity.id)}),h.append("span").attr("class","entity-name").html(function(E){var A=qt(E.entity)||"",T="";return A!==""&&(T+=":"),T+=" "+A}),u=d.merge(u);var p=new nn().update({id:void 0}),m=o.changes(ia(o.difference(),r));delete p.id;var g=go.stringify(p.osmChangeJXON(m)),y=new Blob([g],{type:"text/xml;charset=utf-8;"}),v="changes.osc",x=l.selectAll(".download-changes").data([0]).enter().append("a").attr("class","download-changes");e.download?x.attr("href",window.URL.createObjectURL(y)).attr("download",v):x.attr("target","_blank").on("click.download",function(){navigator.msSaveBlob(y,v)}),x.call(Z("#rapid-icon-load","inline")).append("span").html(S.html("commit.download_changes"));function _(E){E.entity&&t.surface().selectAll(Ol([E.entity.id],t.graph())).classed("hover",!0)}function b(){t.surface().selectAll(".hover").classed("hover",!1)}function w(E,A){if(A.changeType!=="deleted"){var T=A.entity;t.map().zoomToEase(T),t.surface().selectAll(Ol([T.id],t.graph())).classed("hover",!0)}}}return i}function qd(t){function e(r){var i=t.validator().getIssuesBySeverity({what:"edited",where:"all",includeDisabledRules:!0});for(var n in i){var s=i[n];n!=="error"&&(s=s.filter(function(p){return p.type!=="help_request"}));var o=n+"-section",a=n+"-item",l=r.selectAll("."+o).data(s.length?[0]:[]);l.exit().remove();var c=l.enter().append("div").attr("class","modal-section "+o+" fillL2");c.append("h3").html(n==="warning"?S.html("commit.warnings"):S.html("commit.errors")),c.append("ul").attr("class","changeset-list"),l=c.merge(l);var u=l.select("ul").selectAll("li").data(s,function(p){return p.key});u.exit().remove();var d=u.enter().append("li").attr("class",a),h=d.append("button").on("mouseover",function(p,m){m.entityIds&&t.surface().selectAll(Ol(m.entityIds,t.graph())).classed("hover",!0)}).on("mouseout",function(){t.surface().selectAll(".hover").classed("hover",!1)}).on("click",function(p,m){t.validator().focusIssue(m)});h.call(Z("#rapid-icon-alert","pre-text")),h.append("strong").attr("class","issue-message"),h.filter(function(p){return p.tooltip}).call(Ae().title(function(p){return p.tooltip}).placement("top")),u=d.merge(u),u.selectAll(".issue-message").html(function(p){return p.message(t)})}}return e}function rl(t,e){var r=mt(t,e).classes("raw-tag-editor").label(function(){var F=Object.keys(p).filter(function(L){return L}).length;return S("inspector.title_count",{title:S.html("inspector.tags"),count:F})}).expandedByDefault(!1).disclosureContent(v),i=K.taginfo,n=fe("change"),s=[{id:"list",icon:"#fas-th-list"},{id:"text",icon:"#fas-i-cursor"}],o=ee("raw-tag-editor-view")||"list",a=[],l=[],c=!1,u=null,d,h,p,m,g=!1;function y(){g=!0}function v(F){l=l.filter(function(ne){return p[ne]!==void 0});var L=Object.keys(p).sort(),B=si(L,l);for(var O in B)l.push(B[O]);var R=l.map(function(ne,Ie){return{index:Ie,key:ne,value:p[ne]}});(!R.length||c)&&(c=!1,R.push({index:R.length,key:"",value:""}));var U=F.selectAll(".raw-tag-options").data([0]);U.exit().remove();var G=U.enter().insert("div",":first-child").attr("class","raw-tag-options"),$=G.selectAll(".raw-tag-option").data(s,function(ne){return ne.id}).enter();$.append("button").attr("class",function(ne){return"raw-tag-option raw-tag-option-"+ne.id+(o===ne.id?" selected":"")}).attr("title",function(ne){return S("icons."+ne.id)}).on("click",function(ne,Ie){o=Ie.id,ee("raw-tag-editor-view",Ie.id),F.selectAll(".raw-tag-option").classed("selected",function(at){return at===Ie}),F.selectAll(".tag-text").classed("hide",Ie.id!=="text").each(_),F.selectAll(".tag-list, .add-row").classed("hide",Ie.id!=="list")}).each(function(ne){H(this).call(Z(ne.icon))});var q=E(R),ie=F.selectAll(".tag-text").data([0]);ie=ie.enter().append("textarea").attr("class","tag-text"+(o!=="text"?" hide":"")).call(qe).attr("placeholder",S("inspector.key_value")).attr("spellcheck","false").merge(ie),ie.call(De,q).each(_).on("input",_).on("focus",y).on("blur",A).on("change",A);var Q=F.selectAll(".tag-list").data([0]);Q=Q.enter().append("ul").attr("class","tag-list"+(o!=="list"?" hide":"")).merge(Q);var re=F.selectAll(".add-row").data([0]).enter().append("div").attr("class","add-row"+(o!=="list"?" hide":""));re.append("button").attr("class","add-tag").call(Z("#rapid-icon-plus","light")).on("click",M),re.append("div").attr("class","space-value"),re.append("div").attr("class","space-buttons");var ve=Q.selectAll(".tag-row").data(R,function(ne){return ne.key});ve.exit().each(C).remove();var de=ve.enter().append("li").attr("class","tag-row").classed("readonly",x),we=de.append("div").attr("class","inner-wrap");we.append("div").attr("class","key-wrap").append("input").property("type","text").attr("class","key").call(qe).on("focus",y).on("blur",I).on("change",I),we.append("div").attr("class","value-wrap").append("input").property("type","text").attr("class","value").call(qe).on("focus",y).on("blur",P).on("change",P).on("keydown.push-more",T),we.append("button").attr("class","form-field-button remove").attr("title",S("icons.remove")).call(Z("#rapid-operation-delete")),ve=ve.merge(de).sort(function(ne,Ie){return ne.index-Ie.index}),ve.each(function(ne){var Ie=H(this),at=Ie.select("input.key"),Et=Ie.select("input.value");m&&i&&d!=="hover"&&k(at,Et);var $t={key:ne.key};typeof ne.value=="string"&&($t.value=ne.value);var Pt=yo($t,e);d==="hover"&&Pt.showing(!1),Ie.select(".inner-wrap").call(Pt.button),Ie.call(Pt.body),Ie.select("button.remove")}),ve.selectAll("input.key").attr("title",function(ne){return ne.key}).call(De,function(ne){return ne.key}).attr("readonly",function(ne){return x(ne)||typeof ne.value!="string"||null}),ve.selectAll("input.value").attr("title",function(ne){return Array.isArray(ne.value)?ne.value.filter(Boolean).join(`
`):ne.value}).classed("mixed",function(ne){return Array.isArray(ne.value)}).attr("placeholder",function(ne){return typeof ne.value=="string"?null:S("inspector.multiple_values")}).call(De,function(ne){return typeof ne.value=="string"?ne.value:""}).attr("readonly",function(ne){return x(ne)||null}),ve.selectAll("button.remove").on(("PointerEvent"in window?"pointer":"mouse")+"down",N)}function x(F){for(var L=0;L<a.length;L++)if(F.key.match(a[L])!==null)return!0;return!1}function _(){if(o==="text"){var F=H(this),L=F.node().value.match(/\n/g),B=2+Number(L&&L.length),O=20;F.style("height",B*O+"px")}}function b(F){return JSON.stringify(F).slice(1,-1)}function w(F){var L="",B="";return(F.length<1||F.charAt(0)!=='"')&&(L='"'),(F.length<2||F.charAt(F.length-1)!=='"'||F.charAt(F.length-1)==='"'&&F.charAt(F.length-2)==="\\")&&(B='"'),JSON.parse(L+F+B)}function E(F){var L=F.filter(function(B){return B.key&&B.key.trim()!==""}).map(function(B){var O=B.value;typeof O!="string"&&(O="*");var R=O?b(O):"";return b(B.key)+"="+R}).join(`
`);return d!=="hover"&&L.length?L+`
`:L}function A(){var F=this.value.trim(),L={};F.split(`
`).forEach(function(O){var R=O.match(/^\s*([^=]+)=(.*)$/);if(R!==null){var U=e.cleanTagKey(w(R[1].trim())),G=e.cleanTagValue(w(R[2].trim()));L[U]=G}});var B=cc(p,L);if(B.length){if(u=u||{},B.forEach(function(O){x({key:O.key})||O.newVal==="*"&&typeof O.oldVal!="string"||(O.type==="-"?u[O.key]=void 0:O.type==="+"&&(u[O.key]=O.newVal||""))}),Object.keys(u).length===0){u=null;return}D()}}function T(F){F.keyCode===9&&!F.shiftKey&&r.selection().selectAll(".tag-list li:last-child input.value").node()===this&&De(H(this))&&M()}function k(F,L){if(x(F.datum()))return;if(Array.isArray(L.datum().value)){L.call(At(e,"tag-value").minItems(1).fetcher(function(R,U){var G=De(F);if(p[G]){var $=p[G].filter(Boolean).map(function(q){return{value:q,title:q}});U($)}}));return}var B=e.graph().geometry(m[0]);F.call(At(e,"tag-key").fetcher(function(R,U){i.keys({debounce:!0,geometry:B,query:R},function(G,$){if(!G){var q=$.filter(function(ie){return p[ie.value]===void 0});U(O(R,q))}})})),L.call(At(e,"tag-value").fetcher(function(R,U){i.values({debounce:!0,key:De(F),geometry:B,query:R},function(G,$){G||U(O(R,$))})}));function O(R,U){for(var G=[],$=[],q=0;q<U.length;q++)U[q].value.substring(0,R.length)===R?G.push(U[q]):$.push(U[q]);return G.concat($)}}function C(){var F=H(this);F.selectAll("input.key").call(At.off,e),F.selectAll("input.value").call(At.off,e)}function I(F,L){if(!H(this).attr("readonly")){var B=L.key;if(!(u&&u.hasOwnProperty(B)&&u[B]===void 0)){var O=e.cleanTagKey(this.value.trim());if(x({key:O})){this.value=B;return}if(O&&O!==B&&p[O]!==void 0){this.value=B,r.selection().selectAll(".tag-list input.value").each(function(q){if(q.key===O){var ie=H(this).node();ie.focus(),ie.select()}});return}var R=this.parentNode.parentNode,U=H(R).selectAll("input.value"),G=e.cleanTagValue(De(U));u=u||{},B&&(u[B]=void 0),u[O]=G;var $=l.indexOf(B);$!==-1&&(l[$]=O),L.key=O,L.value=G,this.value=O,De(U,G),D()}}}function P(F,L){x(L)||typeof L.value!="string"&&!this.value||u&&u.hasOwnProperty(L.key)&&u[L.key]===void 0||(u=u||{},u[L.key]=e.cleanTagValue(this.value),D())}function N(F,L){x(L)||(L.key===""?(c=!1,r.reRender()):(l=l.filter(function(B){return B!==L.key}),u=u||{},u[L.key]=void 0,D()))}function M(){window.setTimeout(function(){c=!0,r.reRender(),r.selection().selectAll(".tag-list li:last-child input.key").node().focus()},20)}function D(){var F=m;window.setTimeout(function(){u&&(n.call("change",this,F,u),u=null)},10)}return r.state=function(F){return arguments.length?(d!==F&&(l=[],d=F),r):d},r.presets=function(F){return arguments.length?(h=F,h&&h.length&&h[0].isFallback()?r.disclosureExpanded(!0):g||r.disclosureExpanded(null),r):h},r.tags=function(F){return arguments.length?(p=F,r):p},r.entityIDs=function(F){return arguments.length?((!m||!F||!ni(m,F))&&(m=F,l=[]),r):m},r.readOnlyTags=function(F){return arguments.length?(a=F,r):a},ge(r,n,"on")}var DS=[/^changesets_count$/,/^created_by$/,/^ideditor:/,/^imagery_used$/,/^host$/,/^locale$/,/^warnings:/,/^resolved:/,/^closed:note$/,/^closed:keepright$/,/^closed:improveosm:/,/^closed:osmose:/],FS=/(#[^\u2000-\u206F\u2E00-\u2E7F\s\\'!"#$%()*,.\/:;<=>?@\[\]^`{|}~]+)/g;function Yd(t){var e=fe("cancel"),r,i,n=Xd(t).on("change",p),s=rl("changeset-tag-editor",t).on("change",p).readOnlyTags(DS),o=Wd(t),a=qd(t);function l(v){i=v,t.changeset||c(),u(),v.call(d)}function c(){var v=+ee("commentDate")||0,x=Date.now(),_=2*86400*1e3;(v>x||x-v>_)&&(ee("comment",null),ee("hashtags",null),ee("source",null)),t.defaultChangesetComment()&&(ee("comment",t.defaultChangesetComment()),ee("commentDate",Date.now())),t.defaultChangesetSource()&&(ee("source",t.defaultChangesetSource()),ee("commentDate",Date.now())),t.defaultChangesetHashtags()&&(ee("hashtags",t.defaultChangesetHashtags()),ee("commentDate",Date.now()));var b=Rr(),w={comment:ee("comment")||"",created_by:t.cleanTagValue("Rapid "+t.version),host:t.cleanTagValue(b.host),locale:t.cleanTagValue(se.localeCode())};m(w,!0);var E=ee("hashtags");E&&(w.hashtags=E);var A=ee("source");A&&(w.source=A),t.changeset=new nn({tags:w})}function u(){var v=t.connection();if(!v)return;var x=Object.assign({},t.changeset.tags),_=new Set((x.source||"").split(";")),b=new Set(t.history().photoOverlaysUsed()),w=["streetside","mapillary","mapillary-map-features","mapillary-signs","kartaview"];w.forEach(function(R){_.delete(R)}),b.size?(_.add("streetlevel imagery"),b.forEach(function(R){_.add(R)})):_.delete("streetlevel imagery");var E=t.rapidContext().sources,A=["mapwithai","esri"];A.forEach(function(R){_.delete(R)}),E.forEach(function(R){_.add(R)});var T=t.cleanTagValue(Array.from(_).filter(Boolean).join(";"));T?x.source=T:delete x.source;var k=new Set(t.history().imageryUsed()),C=t.cleanTagValue(Array.from(k).filter(Boolean).join(";"));x.imagery_used=C||"None";var I=v.getClosedIDs(),P;if(I.length&&(x["closed:note"]=t.cleanTagValue(I.join(";"))),K.keepRight){var N=K.keepRight.getClosedIDs();N.length&&(x["closed:keepright"]=t.cleanTagValue(N.join(";")))}if(K.improveOSM){var M=K.improveOSM.getClosedCounts();for(P in M)x["closed:improveosm:"+P]=t.cleanTagValue(M[P].toString())}if(K.osmose){var D=K.osmose.getClosedCounts();for(P in D)x["closed:osmose:"+P]=t.cleanTagValue(D[P].toString())}for(var F in x)F.match(/(^warnings:)|(^resolved:)/)&&delete x[F];function L(R,U){var G=yr(R,"type");for(var $ in G){var q=G[$];if(q[0].subtype){var ie=yr(q,"subtype");for(var Q in ie){var re=ie[Q];x[U+":"+$+":"+Q]=t.cleanTagValue(re.length.toString())}}else x[U+":"+$]=t.cleanTagValue(q.length.toString())}}var B=t.validator().getIssuesBySeverity({what:"edited",where:"all",includeIgnored:!0,includeDisabledRules:!0}).warning.filter(function(R){return R.type!=="help_request"});L(B,"warnings");var O=t.validator().getResolvedIssues();L(O,"resolved"),t.changeset=t.changeset.update({tags:x})}function d(v){var x=t.connection();if(!x)return;var _=v.selectAll(".header").data([0]),b=_.enter().append("div").attr("class","header fillL");b.append("div").append("h3").html(S.html("commit.title")),b.append("button").attr("class","close").on("click",function(){e.call("cancel",this)}).call(Z("#rapid-icon-close"));var w=v.selectAll(".body").data([0]);w=w.enter().append("div").attr("class","body").merge(w);var E=w.selectAll(".changeset-editor").data([0]);E=E.enter().append("div").attr("class","modal-section changeset-editor").merge(E),E.call(n.changesetID(t.changeset.id).tags(t.changeset.tags)),w.call(a);var A=w.selectAll(".save-section").data([0]);A=A.enter().append("div").attr("class","modal-section save-section fillL").merge(A);var T=A.selectAll(".commit-info").data([0]);T.enter().size()&&(r=null),T=T.enter().append("p").attr("class","commit-info").html(S.html("commit.upload_explanation")).merge(T),x.userDetails(function(U,G){if(!U&&r!==G){r=G;var $=H(document.createElement("div"));G.image_url&&$.append("img").attr("src",G.image_url).attr("class","icon pre-text user-icon"),$.append("a").attr("class","user-info").html(G.display_name).attr("href",x.userURL(G.display_name)).attr("target","_blank"),T.html(S.html("commit.upload_explanation_with_user",{user:$.html()}))}});var k=A.selectAll(".request-review").data([0]),C=k.enter().append("div").attr("class","request-review"),I=ss("commit-input-request-review"),P=C.append("label").attr("for",I);P.empty()||P.call(Ae().title(S.html("commit.request_review_info")).placement("top")),P.append("input").attr("type","checkbox").attr("id",I),P.append("span").html(S.html("commit.request_review")),k=k.merge(C);var N=k.selectAll("input").property("checked",g(t.changeset.tags)).on("change",R),M=A.selectAll(".buttons").data([0]),D=M.enter().append("div").attr("class","buttons fillL");D.append("button").attr("class","secondary-action button cancel-button").append("span").attr("class","label").html(S.html("commit.cancel"));var F=D.append("button").attr("class","action button save-button");F.append("span").attr("class","label").html(S.html("commit.save"));var L=h();M=M.merge(D),M.selectAll(".cancel-button").on("click.cancel",function(){e.call("cancel",this)}),M.selectAll(".save-button").classed("disabled",L!==null).on("click.save",function(){if(!H(this).classed("disabled")){this.blur();for(var U in t.changeset.tags)U||delete t.changeset.tags[U];t.uploader().save(t.changeset)}}),Ae().destroyAny(M.selectAll(".save-button")),L&&M.selectAll(".save-button").call(Ae().title(L).placement("top"));var B=w.selectAll(".tag-section.raw-tag-editor").data([0]);B=B.enter().append("div").attr("class","modal-section tag-section raw-tag-editor").merge(B),B.call(s.tags(Object.assign({},t.changeset.tags)).render);var O=w.selectAll(".commit-changes-section").data([0]);O=O.enter().append("div").attr("class","modal-section commit-changes-section").merge(O),O.call(o.render);function R(){var U=N.property("checked");y({review_requested:U?"yes":void 0}),B.call(s.tags(Object.assign({},t.changeset.tags)).render)}}function h(){var v=t.validator().getIssuesBySeverity({what:"edited",where:"all"}).error;if(v.length)return S("commit.outstanding_errors_message",{count:v.length});var x=t.changeset&&t.changeset.tags.comment&&t.changeset.tags.comment.trim().length;return x?null:S("commit.comment_needed_message")}function p(v,x,_){x.hasOwnProperty("comment")&&(x.comment===void 0&&(x.comment=""),_||(ee("comment",x.comment),ee("commentDate",Date.now()))),x.hasOwnProperty("source")&&(x.source===void 0?ee("source",null):_||(ee("source",x.source),ee("commentDate",Date.now()))),y(x,_),i&&i.call(d)}function m(v,x){var _=w();_.length&&ee("hashtags",null),(!_.length||!x)&&(_=_.concat(E()));var b=new Set;return _.filter(function(A){var T=A.toLowerCase();return b.has(T)?!1:(b.add(T),!0)});function w(){var A=(v.comment||"").replace(/http\S*/g,"").match(FS);return A||[]}function E(){var A=(v.hashtags||"").split(/[,;\s]+/).map(function(T){T[0]!=="#"&&(T="#"+T);var k=T.match(FS);return k&&k[0]}).filter(Boolean);return A||[]}}function g(v){var x=v.review_requested;return x===void 0?!1:(x=x.trim().toLowerCase(),!(x===""||x==="no"))}function y(v,x){var _=Object.assign({},t.changeset.tags);if(Object.keys(v).forEach(function(T){var k=v[T];T=t.cleanTagKey(T),DS.indexOf(T)===-1&&(k===void 0?delete _[T]:x?_[T]=k:_[T]=t.cleanTagValue(k))}),!x){var b=v.hasOwnProperty("comment")&&v.comment!=="",w=m(_,b);w.length?(_.hashtags=t.cleanTagValue(w.join(";")),ee("hashtags",_.hashtags)):(delete _.hashtags,ee("hashtags",null))}if(r&&r.changesets_count!==void 0){var E=parseInt(r.changesets_count,10)+1;if(_.changesets_count=String(E),E<=100){var A;A=ee("walkthrough_completed"),A&&(_["ideditor:walkthrough_completed"]=A),A=ee("walkthrough_progress"),A&&(_["ideditor:walkthrough_progress"]=A),A=ee("walkthrough_started"),A&&(_["ideditor:walkthrough_started"]=A)}}else delete _.changesets_count;(0,OS.default)(t.changeset.tags,_)||(t.changeset=t.changeset.update({tags:_}))}return l.reset=function(){t.changeset=null},ge(l,e,"on")}var LS=dt(U5(),1);function BS(t){return typeof t!="string"?"":LS.default.remove(t.replace(/&/g,"and").replace(//ig,"i").replace(/[\s\-=_!"#%'*{},.\/:;?\(\)\[\]@\\$\^*+<>~`\u00a1\u00a7\u00b6\u00b7\u00bf\u037e\u0387\u055a-\u055f\u0589\u05c0\u05c3\u05c6\u05f3\u05f4\u0609\u060a\u060c\u060d\u061b\u061e\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0830-\u083e\u085e\u0964\u0965\u0970\u0af0\u0df4\u0e4f\u0e5a\u0e5b\u0f04-\u0f12\u0f14\u0f85\u0fd0-\u0fd4\u0fd9\u0fda\u104a-\u104f\u10fb\u1360-\u1368\u166d\u166e\u16eb-\u16ed\u1735\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u1805\u1807-\u180a\u1944\u1945\u1a1e\u1a1f\u1aa0-\u1aa6\u1aa8-\u1aad\u1b5a-\u1b60\u1bfc-\u1bff\u1c3b-\u1c3f\u1c7e\u1c7f\u1cc0-\u1cc7\u1cd3\u200b-\u200f\u2016\u2017\u2020-\u2027\u2030-\u2038\u203b-\u203e\u2041-\u2043\u2047-\u2051\u2053\u2055-\u205e\u2cf9-\u2cfc\u2cfe\u2cff\u2d70\u2e00\u2e01\u2e06-\u2e08\u2e0b\u2e0e-\u2e16\u2e18\u2e19\u2e1b\u2e1e\u2e1f\u2e2a-\u2e2e\u2e30-\u2e39\u3001-\u3003\u303d\u30fb\ua4fe\ua4ff\ua60d-\ua60f\ua673\ua67e\ua6f2-\ua6f7\ua874-\ua877\ua8ce\ua8cf\ua8f8-\ua8fa\ua92e\ua92f\ua95f\ua9c1-\ua9cd\ua9de\ua9df\uaa5c-\uaa5f\uaade\uaadf\uaaf0\uaaf1\uabeb\ufe10-\ufe16\ufe19\ufe30\ufe45\ufe46\ufe49-\ufe4c\ufe50-\ufe52\ufe54-\ufe57\ufe5f-\ufe61\ufe68\ufe6a\ufe6b\ufeff\uff01-\uff03\uff05-\uff07\uff0a\uff0c\uff0e\uff0f\uff1a\uff1b\uff1f\uff20\uff3c\uff61\uff64\uff65]+/g,"").toLowerCase())}function Cm(t,e,r){let i=Object.assign({},t.strings),n=Object.assign({},e[t.type]),s=new RegExp(/(\{\w+\})/,"gi");if(r){if(i.community){let u=BS(i.community);i.community=r(`_communities.${u}`)}["name","description","extendedDescription"].forEach(u=>{n[u]&&(n[u]=r(`_defaults.${t.type}.${u}`)),i[u]&&(i[u]=r(`${t.id}.${u}`))})}let o={account:t.account,community:i.community,signupUrl:i.signupUrl,url:i.url};o.signupUrl||(o.signupUrl=l(i.signupUrl||n.signupUrl)),o.url||(o.url=l(i.url||n.url));let a={name:l(i.name||n.name),url:l(i.url||n.url),signupUrl:l(i.signupUrl||n.signupUrl),description:l(i.description||n.description),extendedDescription:l(i.extendedDescription||n.extendedDescription)};return a.nameHTML=c(a.url,a.name),a.urlHTML=c(a.url),a.signupUrlHTML=c(a.signupUrl),a.descriptionHTML=l(i.description||n.description,!0),a.extendedDescriptionHTML=l(i.extendedDescription||n.extendedDescription,!0),a;function l(u,d){if(!u)return;let h=u;for(let m in o){let g=`{${m}}`,y=new RegExp(g,"g");if(y.test(h)){let v=o[m];if(v)d&&(m==="signupUrl"||m==="url")&&(v=c(v)),h=h.replace(y,v);else throw new Error(`Cannot resolve token: ${g}`)}}let p=h.match(s);if(p)throw new Error(`Cannot resolve tokens: ${p}`);return d&&t.type==="reddit"&&(h=h.replace(/(\/r\/\w+\/*)/i,m=>c(a.url,m))),h}function c(u,d){if(u)return d=d||u,`<a target="_blank" href="${u}">${d}</a>`}}var C0=null;function Qd(t){let r=fe("cancel"),i,n;s();function s(){let u=Qe;return Promise.all([u.get("oci_features"),u.get("oci_resources"),u.get("oci_defaults")]).then(d=>{if(C0)return C0;d[0]&&Array.isArray(d[0].features)&&wt.mergeCustomGeoJSON(d[0]);let h=Object.values(d[1].resources);return h.length?wt.mergeLocationSets(h).then(()=>(C0={resources:h,defaults:d[2].defaults},C0)):(C0={resources:[],defaults:d[2].defaults},C0)})}function o(u){if(!u)return;let d=u.trim();if(!d)return;/Z$/.test(d)||(d+="Z");let h=new Date(d);return new Date(h.toUTCString().slice(0,25))}function a(u){let d=u.append("div").attr("class","header fillL");d.append("h3").html(S.html("success.just_edited")),d.append("button").attr("class","close").on("click",()=>r.call("cancel")).call(Z("#rapid-icon-close"));let h=u.append("div").attr("class","body save-success fillL"),p=h.append("div").attr("class","save-summary");p.append("h3").html(S.html("success.thank_you"+(n?"_location":""),{where:n})),p.append("p").html(S.html("success.help_html")).append("a").attr("class","link-out").attr("target","_blank").attr("href",S("success.help_link_url")).call(Z("#rapid-icon-out-link","inline")).append("span").html(S.html("success.help_link_text"));let m=t.connection();if(!m)return;let g=m.changesetURL(i.id),v=p.append("table").attr("class","summary-table").append("tr").attr("class","summary-row");v.append("td").attr("class","cell-icon summary-icon").append("a").attr("target","_blank").attr("href",g).append("svg").attr("class","logo-small").append("use").attr("xlink:href","#rapid-logo-osm");let x=v.append("td").attr("class","cell-detail summary-detail");x.append("a").attr("class","cell-detail summary-view-on-osm").attr("target","_blank").attr("href",g).html(S.html("success.view_on_osm")),x.append("div").html(S.html("success.changeset_id",{changeset_id:`<a href="${g}" target="_blank">${i.id}</a>`})),s().then(_=>{let b=t.map().center(),w=wt.locationSetsAt(b),E=[];_.resources.forEach(A=>{let T=w[A.locationSetID];if(!T)return;let k=C=>S.html(`community.${C}`);A.resolved=Cm(A,_.defaults,k),E.push({area:T,order:A.order||0,resource:A})}),E.sort((A,T)=>A.area-T.area||T.order-A.order),h.call(l,E.map(A=>A.resource))})}function l(u,d){let h=u.append("div").attr("class","save-communityLinks");h.append("h3").html(S.html("success.like_osm"));let g=h.append("table").attr("class","community-table").selectAll(".community-row").data(d).enter().append("tr").attr("class","community-row");g.append("td").attr("class","cell-icon community-icon").append("a").attr("target","_blank").attr("href",v=>v.resolved.url).append("svg").attr("class","logo-small").append("use").attr("xlink:href",v=>`#community-${v.type}`),g.append("td").attr("class","cell-detail community-detail").each(c),h.append("div").attr("class","community-missing").html(S.html("success.missing")).append("a").attr("class","link-out").attr("target","_blank").call(Z("#rapid-icon-out-link","inline")).attr("href","https://github.com/osmlab/osm-community-index/issues").append("span").html(S.html("success.tell_us"))}function c(u){let d=H(this),h=u.id;d.append("div").attr("class","community-name").html(u.resolved.nameHTML),d.append("div").attr("class","community-description").html(u.resolved.descriptionHTML),(u.resolved.extendedDescriptionHTML||u.languageCodes&&u.languageCodes.length)&&d.append("div").call(s1(t,`community-more-${u.id}`,!1).expanded(!1).updatePreference(!1).label(S.html("success.more")).content(m));let p=(u.events||[]).map(y=>(y.date=o(y.when),y)).filter(y=>{let v=y.date.getTime(),x=new Date().setHours(0,0,0,0);return!isNaN(v)&&v>=x}).sort((y,v)=>y.date<v.date?-1:y.date>v.date?1:0).slice(0,2);p.length&&d.append("div").call(s1(t,`community-events-${u.id}`,!1).expanded(!1).updatePreference(!1).label(S.html("success.events")).content(g)).select(".hide-toggle").append("span").attr("class","badge-text").html(p.length);function m(y){let x=y.selectAll(".community-more").data([0]).enter().append("div").attr("class","community-more");if(u.resolved.extendedDescriptionHTML&&x.append("div").attr("class","community-extended-description").html(u.resolved.extendedDescriptionHTML),u.languageCodes&&u.languageCodes.length){let _=u.languageCodes.map(b=>se.languageName(b)).join(", ");x.append("div").attr("class","community-languages").html(S.html("success.languages",{languages:_}))}}function g(y){let _=y.append("div").attr("class","community-events").selectAll(".community-event").data(p).enter().append("div").attr("class","community-event");_.append("div").attr("class","community-event-name").append("a").attr("target","_blank").attr("href",b=>b.url).html(b=>{let w=b.name;return b.i18n&&b.id&&(w=S(`community.${h}.events.${b.id}.name`,{default:w})),w}),_.append("div").attr("class","community-event-when").html(b=>{let w={weekday:"short",day:"numeric",month:"short",year:"numeric"};return(b.date.getHours()||b.date.getMinutes())&&(w.hour="numeric",w.minute="numeric"),b.date.toLocaleString(se.localeCode(),w)}),_.append("div").attr("class","community-event-where").html(b=>{let w=b.where;return b.i18n&&b.id&&(w=S(`community.${h}.events.${b.id}.where`,{default:w})),w}),_.append("div").attr("class","community-event-description").html(b=>{let w=b.description;return b.i18n&&b.id&&(w=S(`community.${h}.events.${b.id}.description`,{default:w})),w})}}return a.changeset=function(u){return arguments.length?(i=u,a):i},a.location=function(u){return arguments.length?(n=u,a):n},ge(a,r,"on")}var US=!1,k0=class extends Wr{constructor(e){super(e),this.id="save",this._keybinding=rt("modeSave"),this._cancel=this._cancel.bind(this),this._keybindingOff=this._keybindingOff.bind(this),this._keybindingOn=this._keybindingOn.bind(this),this._prepareForSuccess=this._prepareForSuccess.bind(this),this._showConflicts=this._showConflicts.bind(this),this._showErrors=this._showErrors.bind(this),this._showProgress=this._showProgress.bind(this),this._showSuccess=this._showSuccess.bind(this),this._location=null,this._successUI=null,this._conflictsUI=null,this._commitUI=Yd(e).on("cancel",this._cancel),this.uploader=e.uploader().on("saveStarted.modeSave",this._keybindingOff).on("willAttemptUpload.modeSave",this._prepareForSuccess).on("progressChanged.modeSave",this._showProgress).on("resultNoChanges.modeSave",this._cancel).on("resultErrors.modeSave",this._showErrors).on("resultConflicts.modeSave",this._showConflicts).on("resultSuccess.modeSave",this._showSuccess)}enter(){US&&console.log("ModeSave: entering");let e=this.context;e.ui().sidebar.expand();let r=this;function i(){e.ui().sidebar.show(r._commitUI)}let n=e.connection();return n?(n.authenticated()?i():n.authenticate(s=>{s?r._cancel():i()}),this._active=!0,e.container().selectAll(".main-content").classed("active",!1).classed("inactive",!0),this._keybindingOn(),this.context.enableBehaviors(["map-interaction"]),!0):!1}exit(){this._active&&(this._active=!1,US&&console.log("ModeSave: exiting"),this._keybindingOff(),this.context.container().selectAll(".main-content").classed("active",!0).classed("inactive",!1),this.context.ui().sidebar.hide())}_cancel(){this.context.enter("browse")}_showProgress(e,r){let n=this.context.container().select(".loading-modal .modal-section").selectAll(".progress").data([0]);n.enter().append("div").attr("class","progress").merge(n).text(S("save.conflict_progress",{num:e,total:r}))}_showConflicts(e,r,i){let n=this.context.container().select(".sidebar").append("div").attr("class","sidebar-component"),s=this.context.container().selectAll(".main-content");s.classed("active",!0).classed("inactive",!1),this._conflictsUI=$d(this.context).conflictList(r).origChanges(i).on("cancel",()=>{s.classed("active",!1).classed("inactive",!0),n.remove(),this._keybindingOn(),this.uploader.cancelConflictResolution()}).on("save",()=>{s.classed("active",!1).classed("inactive",!0),n.remove(),this.uploader.processResolvedConflicts(e)}),n.call(this._conflictsUI)}_showErrors(e){this._keybindingOn();let r=tl(this.context.container());r.select(".modal-section.header").append("h3").text(S("save.error")),this._addErrors(r,e),r.okButton()}_addErrors(e,r){let n=e.select(".modal-section.message-text").selectAll(".error-container").data(r),s=n.enter().append("div").attr("class","error-container");s.append("a").attr("class","error-description").attr("href","#").classed("hide-toggle",!0).text(a=>a.msg||S("save.unknown_error_details")).on("click",function(a){a.preventDefault();var l=H(this),c=H(this.nextElementSibling),u=l.classed("expanded");c.style("display",u?"none":"block"),l.classed("expanded",!u)}),s.append("div").attr("class","error-detail-container").style("display","none").append("ul").attr("class","error-detail-list").selectAll("li").data(a=>a.details||[]).enter().append("li").attr("class","error-detail-item").text(a=>a),n.exit().remove()}_showSuccess(e){this._commitUI.reset();let r=this._successUI.changeset(e).location(this._location).on("cancel",()=>{this.context.ui().sidebar.hide()});this.context.enter("browse"),this.context.ui().sidebar.show(r)}_keybindingOn(){H(document).call(this._keybinding.on("\u238B",this._cancel,!0))}_keybindingOff(){H(document).call(this._keybinding.unbind)}_prepareForSuccess(){this._successUI=Qd(this.context),this._location=null,K.geocoder&&K.geocoder.reverse(this.context.map().center(),(e,r)=>{if(e||!r||!r.address)return;let i=r.address,n=i&&(i.town||i.city||i.county)||"",s=i&&(i.state||i.country)||"",o=n&&s?S("success.thank_you_where.separator"):"";this._location=S("success.thank_you_where.format",{place:n,separator:o,region:s})})}};function Kd(){var t;function e(r){var i=r.selectAll(".data-header").data(t?[t]:[],function(o){return o.__featurehash__});i.exit().remove();var n=i.enter().append("div").attr("class","data-header"),s=n.append("div").attr("class","data-header-icon");s.append("div").call(Z("#rapid-icon-data","note-fill")),n.append("div").attr("class","data-header-label").html(S.html("map_data.layers.custom.title"))}return e.datum=function(r){return arguments.length?(t=r,this):t},e}function I0(t){var e=Kd(),r=rl("custom-data-tag-editor",t).expandedByDefault(!0).readOnlyTags([/./]),i;function n(s){var o=s.selectAll(".header").data([0]),a=o.enter().append("div").attr("class","header fillL");a.append("button").attr("class","close").on("click",function(){t.enter("browse")}).call(Z("#rapid-icon-close")),a.append("h3").html(S.html("map_data.title"));var l=s.selectAll(".body").data([0]);l=l.enter().append("div").attr("class","body").merge(l);var c=l.selectAll(".data-editor").data([0]);c.enter().append("div").attr("class","modal-section data-editor").merge(c).call(e.datum(i));var u=l.selectAll(".raw-tag-editor").data([0]);u.enter().append("div").attr("class","raw-tag-editor data-editor").merge(u).call(r.tags(i&&i.properties||{}).state("hover").render).selectAll("textarea.tag-text").attr("readonly",!0).classed("readonly",!0)}return n.datum=function(s){return arguments.length?(i=s,this):i},n}function Zd(){let t;function e(i){let n=i.selectAll(".comments-container").data([0]);n=n.enter().append("div").attr("class","comments-container").merge(n),K.improveOSM.getComments(t).then(s=>{if(!s.comments)return;let o=n.selectAll(".comment").data(s.comments).enter().append("div").attr("class","comment");o.append("div").attr("class","comment-avatar").call(Z("#rapid-icon-avatar","comment-avatar-icon"));let a=o.append("div").attr("class","comment-main"),l=a.append("div").attr("class","comment-metadata");l.append("div").attr("class","comment-author").each(function(c){let u=K.osm,d=H(this);u&&c.username&&(d=d.append("a").attr("class","comment-author-link").attr("href",u.userURL(c.username)).attr("target","_blank")),d.html(h=>h.username)}),l.append("div").attr("class","comment-date").html(c=>S.html("note.status.commented",{when:r(c.timestamp)})),a.append("div").attr("class","comment-text").append("p").html(c=>c.text)}).catch(s=>console.log(s))}function r(i){if(!i)return null;let n={day:"numeric",month:"short",year:"numeric"},s=new Date(i*1e3);return isNaN(s.getTime())?null:s.toLocaleDateString(se.localeCode(),n)}return e.issue=function(i){return arguments.length?(t=i,e):t},e}function Jd(t){let e;function r(n){if(n.desc)return n.desc;let s=n.issueKey;return n.replacements=n.replacements||{},n.replacements.default=S.html("inspector.unknown"),S.html(`QA.improveOSM.error_types.${s}.description`,n.replacements)}function i(n){let s=n.selectAll(".error-details").data(e?[e]:[],c=>`${c.id}-${c.status||0}`);s.exit().remove();let a=s.enter().append("div").attr("class","error-details qa-details-container").append("div").attr("class","qa-details-subsection");a.append("h4").html(S.html("QA.keepRight.detail_description")),a.append("div").attr("class","qa-details-description-text").html(r);let l=[];a.selectAll(".error_entity_link, .error_object_link").attr("href","#").each(function(){let c=H(this),u=c.classed("error_object_link"),d=u?e.objectType.charAt(0)+e.objectId:this.textContent,h=t.hasEntity(d);if(l.push(d),c.on("mouseenter",()=>{ct([d],!0,t)}).on("mouseleave",()=>{ct([d],!1,t)}).on("click",p=>{p.preventDefault(),ct([d],!1,t),t.scene().enableLayers("osm"),t.map().centerZoom(e.loc,20),h?t.enter(Se(t,[d])):t.loadEntity(d,(m,g)=>{if(m)return;g.data.find(v=>v.id===d)&&t.enter(Se(t,[d]))})}),h){let p=qt(h);if(!p&&!u){let m=xe.match(h,t.graph());p=m&&!m.isFallback()&&m.name()}p&&(this.innerText=p)}}),t.features().forceVisible(l),t.map().immediateRedraw()}return i.issue=function(n){return arguments.length?(e=n,i):e},i}Hc([$c]);var M0=class{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof M0)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){let r=typeof t;if(r!==typeof e)return!1;if(r==="number"||r==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((n,s)=>n===e[s]);if(t!==null&&e!==null){let n=Object.keys(t),s=Object.keys(e);return n.length!==s.length?!1:n.every(o=>t[o]===e[o])}return t===e}toRgba(){let[t,e,r,i]=this._components;return{r:t,g:e,b:r,a:i}}toRgb(){let[t,e,r]=this._components;return{r:t,g:e,b:r}}toRgbaString(){let[t,e,r]=this.toUint8RgbArray();return`rgba(${t},${e},${r},${this.alpha})`}toUint8RgbArray(t){let[e,r,i]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(r*255),t[2]=Math.round(i*255),t}toRgbArray(t){t=t??[];let[e,r,i]=this._components;return t[0]=e,t[1]=r,t[2]=i,t}toNumber(){return this._int}toLittleEndianNumber(){let t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){let[e,r,i,n]=M0.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=r,this._components[2]*=i,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,n=this._int&255;return e&&(r=r*t+.5|0,i=i*t+.5|0,n=n*t+.5|0),(t*255<<24)+(r<<16)+(i<<8)+n}toHex(){let t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){let e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){let[e,r,i]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(r*t)/t,this._components[2]=Math.round(i*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];let[e,r,i,n]=this._components;return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}normalize(t){let e,r,i,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){let s=t;e=(s>>16&255)/255,r=(s>>8&255)/255,i=(s&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,r,i,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,r,i,n=255]=t,e/=255,r/=255,i/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){let o=M0.HEX_PATTERN.exec(t);o&&(t=`#${o[2]}`)}let s=Ji(t);s.isValid()&&({r:e,g:r,b:i,a:n}=s.rgba,e/=255,r/=255,i/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=r,this._components[2]=i,this._components[3]=n,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);let[t,e,r]=this._components;this._int=(t*255<<16)+(e*255<<8)+(r*255|0)}_clamp(t,e=0,r=1){return typeof t=="number"?Math.min(Math.max(t,e),r):(t.forEach((i,n)=>{t[n]=Math.min(Math.max(i,e),r)}),t)}},bt=M0;bt.shared=new M0;bt.temp=new M0;bt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;var me=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(me||{}),km=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},GS=(t,e)=>km(t).priority??e,_e={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(km).forEach(e=>{e.type.forEach(r=>this._removeHandlers[r]?.(e))}),this},add(...t){return t.map(km).forEach(e=>{e.type.forEach(r=>{let i=this._addHandlers,n=this._queue;i[r]?i[r](e):(n[r]=n[r]||[],n[r].push(e))})}),this},handle(t,e,r){let i=this._addHandlers,n=this._removeHandlers;if(i[t]||n[t])throw new Error(`Extension type ${t} already has a handler`);i[t]=e,n[t]=r;let s=this._queue;return s[t]&&(s[t].forEach(o=>e(o)),delete s[t]),this},handleByMap(t,e){return this.handle(t,r=>{e[r.name]=r.ref},r=>{delete e[r.name]})},handleByList(t,e,r=-1){return this.handle(t,i=>{e.includes(i.ref)||(e.push(i.ref),e.sort((n,s)=>GS(s,r)-GS(n,r)))},i=>{let n=e.indexOf(i.ref);n!==-1&&e.splice(n,1)})}};var il=class{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}};var PO=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function RO(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function eh(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let r=e.createShader(e.FRAGMENT_SHADER);for(;;){let i=PO.replace(/%forloop%/gi,RO(t));if(e.shaderSource(r,i),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}return t}var Im=0,Mm=1,Pm=2,Rm=3,Nm=4,Dm=5,hi=class{constructor(){this.data=0,this.blendMode=We.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Im)}set blend(e){!!(this.data&1<<Im)!==e&&(this.data^=1<<Im)}get offsets(){return!!(this.data&1<<Mm)}set offsets(e){!!(this.data&1<<Mm)!==e&&(this.data^=1<<Mm)}get culling(){return!!(this.data&1<<Pm)}set culling(e){!!(this.data&1<<Pm)!==e&&(this.data^=1<<Pm)}get depthTest(){return!!(this.data&1<<Rm)}set depthTest(e){!!(this.data&1<<Rm)!==e&&(this.data^=1<<Rm)}get depthMask(){return!!(this.data&1<<Dm)}set depthMask(e){!!(this.data&1<<Dm)!==e&&(this.data^=1<<Dm)}get clockwiseFrontFace(){return!!(this.data&1<<Nm)}set clockwiseFrontFace(e){!!(this.data&1<<Nm)!==e&&(this.data^=1<<Nm)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==We.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){let e=new hi;return e.depthTest=!1,e.blend=!0,e}};var P0=[];function R0(t,e){if(!t)return null;let r="";if(typeof t=="string"){let i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(let i=P0.length-1;i>=0;--i){let n=P0[i];if(n.test&&n.test(t,r))return new n(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}var Kr=class{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,r,i,n,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");let{name:c,items:u}=this;this._aliasCount++;for(let d=0,h=u.length;d<h;d++)u[d][c](e,r,i,n,s,o,a,l);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){let r=this.items.indexOf(e);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}};Object.defineProperties(Kr.prototype,{dispatch:{value:Kr.prototype.emit},run:{value:Kr.prototype.emit}});var an=class{constructor(e=0,r=0){this._width=e,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new Kr("setRealSize"),this.onUpdate=new Kr("update"),this.onError=new Kr("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,r){(e!==this._width||r!==this._height)&&(this._width=e,this._height=r,this.onResize.emit(e,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,r,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,r){return!1}};var Tn=class extends an{constructor(e,r){let{width:i,height:n}=r||{};if(!i||!n)throw new Error("BufferResource width or height invalid");super(i,n),this.data=e}upload(e,r,i){let n=e.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===$r.UNPACK);let s=r.realWidth,o=r.realHeight;return i.width===s&&i.height===o?n.texSubImage2D(r.target,0,0,0,s,o,r.format,i.type,this.data):(i.width=s,i.height=o,n.texImage2D(r.target,0,i.internalFormat,s,o,0,r.format,i.type,this.data)),!0}dispose(){this.data=null}static test(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array}};var NO={scaleMode:ki.NEAREST,format:Ce.RGBA,alphaMode:$r.NPM},N0=class extends xr.default{constructor(t=null,e=null){super(),e=Object.assign({},N0.defaultOptions,e);let{alphaMode:r,mipmap:i,anisotropicLevel:n,scaleMode:s,width:o,height:a,wrapMode:l,format:c,type:u,target:d,resolution:h,resourceOptions:p}=e;t&&!(t instanceof an)&&(t=R0(t,p),t.internal=!0),this.resolution=h||ue.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=n,this._wrapMode=l,this._scaleMode=s,this.format=c,this.type=u,this.target=d,this.alphaMode=r,this.uid=ho(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let r;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this}setSize(t,e,r){return r=r||this.resolution,this.setRealSize(t*r,e*r,r)}setRealSize(t,e,r){return this.resolution=r||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=_2(this.realWidth)&&_2(this.realHeight)}setResolution(t){let e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete rn[this.cacheId],delete bi[this.cacheId],this.cacheId=null),this.dispose(),N0.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,r=ue.STRICT_TEXTURE_CACHE){let i=typeof t=="string",n=null;if(i)n=t;else{if(!t._pixiId){let o=e?.pixiIdPrefix||"pixiid";t._pixiId=`${o}_${ho()}`}n=t._pixiId}let s=rn[n];if(i&&r&&!s)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return s||(s=new N0(t,e),s.cacheId=n,N0.addToCache(s,n)),s}static fromBuffer(t,e,r,i){t=t||new Float32Array(e*r*4);let n=new Tn(t,{width:e,height:r}),s=t instanceof Float32Array?Ge.FLOAT:Ge.UNSIGNED_BYTE;return new N0(n,Object.assign({},NO,{type:s},i))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),rn[e]&&rn[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),rn[e]=t)}static removeFromCache(t){if(typeof t=="string"){let e=rn[t];if(e){let r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete rn[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete rn[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}},Le=N0;Le.defaultOptions={mipmap:oi.POW2,anisotropicLevel:0,scaleMode:ki.LINEAR,wrapMode:bn.CLAMP,alphaMode:$r.UNPACK,target:Ko.TEXTURE_2D,format:Ce.RGBA,type:Ge.UNSIGNED_BYTE};Le._globalBatch=0;var nl=class{constructor(){this.texArray=null,this.blend=0,this.type=_n.TRIANGLES,this.start=0,this.size=0,this.data=null}};var DO=0,rr=class{constructor(e,r=!0,i=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=r,this.id=DO++,this.disposeRunner=new Kr("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?wn.ELEMENT_ARRAY_BUFFER:wn.ARRAY_BUFFER}get index(){return this.type===wn.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new rr(e)}};var sl=class{constructor(e,r=0,i=!1,n=Ge.FLOAT,s,o,a,l=1){this.buffer=e,this.size=r,this.normalized=i,this.type=n,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,r,i,n,s){return new sl(e,r,i,n,s)}};var FO={Float32Array,Uint32Array,Int32Array,Uint8Array};function zS(t,e){let r=0,i=0,n={};for(let l=0;l<t.length;l++)i+=e[l],r+=t[l].length;let s=new ArrayBuffer(r*4),o=null,a=0;for(let l=0;l<t.length;l++){let c=e[l],u=t[l],d=qa(u);n[d]||(n[d]=new FO[d](s)),o=n[d];for(let h=0;h<u.length;h++){let p=(h/c|0)*i+a,m=h%c;o[p+m]=u[h]}a+=c}return new Float32Array(s)}var HS={5126:4,5123:2,5121:1},OO=0,LO={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},wi=class{constructor(e=[],r={}){this.buffers=e,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=OO++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Kr("disposeGeometry"),this.refCount=0}addAttribute(e,r,i=0,n=!1,s,o,a,l=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof rr||(r instanceof Array&&(r=new Float32Array(r)),r=new rr(r));let c=e.split("|");if(c.length>1){for(let d=0;d<c.length;d++)this.addAttribute(c[d],r,i,n,s);return this}let u=this.buffers.indexOf(r);return u===-1&&(this.buffers.push(r),u=this.buffers.length-1),this.attributes[e]=new sl(u,i,n,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof rr||(e instanceof Array&&(e=new Uint16Array(e)),e=new rr(e)),e.type=wn.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;let e=[],r=[],i=new rr,n;for(n in this.attributes){let s=this.attributes[n],o=this.buffers[s.buffer];e.push(o.data),r.push(s.size*HS[s.type]/4),s.buffer=0}for(i.data=zS(e,r),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let e in this.attributes){let r=this.attributes[e];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let e=new wi;for(let r=0;r<this.buffers.length;r++)e.buffers[r]=new rr(this.buffers[r].data.slice(0));for(let r in this.attributes){let i=this.attributes[r];e.attributes[r]=new sl(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=wn.ELEMENT_ARRAY_BUFFER),e}static merge(e){let r=new wi,i=[],n=[],s=[],o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)n[l]=n[l]||0,n[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new LO[qa(o.buffers[a].data)](n[a]),r.buffers[a]=new rr(i[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(r.attributes=o.attributes,o.indexBuffer){r.indexBuffer=r.buffers[o.buffers.indexOf(o.indexBuffer)],r.indexBuffer.type=wn.ELEMENT_ARRAY_BUFFER;let a=0,l=0,c=0,u=0;for(let d=0;d<o.buffers.length;d++)if(o.buffers[d]!==o.indexBuffer){u=d;break}for(let d in o.attributes){let h=o.attributes[d];(h.buffer|0)===u&&(l+=h.size*HS[h.type]/4)}for(let d=0;d<e.length;d++){let h=e[d].indexBuffer.data;for(let p=0;p<h.length;p++)r.indexBuffer.data[p+c]+=a;a+=e[d].buffers[u].data.length/l,c+=h.length}}return r}};var o1=class extends wi{constructor(e=!1){super(),this._buffer=new rr(null,e,!1),this._indexBuffer=new rr(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Ge.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,Ge.FLOAT).addAttribute("aColor",this._buffer,4,!0,Ge.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Ge.FLOAT).addIndex(this._indexBuffer)}};var ol=Math.PI*2,Fm=180/Math.PI,zs=Math.PI/180,pr=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(pr||{});var Ne=class{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new Ne(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}};var th=[new Ne,new Ne,new Ne,new Ne],Re=class{constructor(e=0,r=0,i=0,n=0){this.x=Number(e),this.y=Number(r),this.width=Number(i),this.height=Number(n),this.type=pr.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Re(0,0,0,0)}clone(){return new Re(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(e,r){if(!r){let T=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=T)return!1;let C=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>C}let i=this.left,n=this.right,s=this.top,o=this.bottom;if(n<=i||o<=s)return!1;let a=th[0].set(e.left,e.top),l=th[1].set(e.left,e.bottom),c=th[2].set(e.right,e.top),u=th[3].set(e.right,e.bottom);if(c.x<=a.x||l.y<=a.y)return!1;let d=Math.sign(r.a*r.d-r.b*r.c);if(d===0||(r.apply(a,a),r.apply(l,l),r.apply(c,c),r.apply(u,u),Math.max(a.x,l.x,c.x,u.x)<=i||Math.min(a.x,l.x,c.x,u.x)>=n||Math.max(a.y,l.y,c.y,u.y)<=s||Math.min(a.y,l.y,c.y,u.y)>=o))return!1;let h=d*(l.y-a.y),p=d*(a.x-l.x),m=h*i+p*s,g=h*n+p*s,y=h*i+p*o,v=h*n+p*o;if(Math.max(m,g,y,v)<=h*a.x+p*a.y||Math.min(m,g,y,v)>=h*u.x+p*u.y)return!1;let x=d*(a.y-c.y),_=d*(c.x-a.x),b=x*i+_*s,w=x*n+_*s,E=x*i+_*o,A=x*n+_*o;return!(Math.max(b,w,E,A)<=x*a.x+_*a.y||Math.min(b,w,E,A)>=x*u.x+_*u.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){let r=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(i-r,0),this.y=n,this.height=Math.max(s-n,0),this}ceil(e=1,r=.001){let i=Math.ceil((this.x+this.width-r)*e)/e,n=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=i-this.x,this.height=n-this.y,this}enlarge(e){let r=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=i-r,this.y=n,this.height=s-n,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var vo=class{constructor(e=0,r=0,i=0){this.x=e,this.y=r,this.radius=i,this.type=pr.CIRC}clone(){return new vo(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;let i=this.radius*this.radius,n=this.x-e,s=this.y-r;return n*=n,s*=s,n+s<=i}getBounds(){return new Re(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}};var a1=class{constructor(e=0,r=0,i=0,n=0){this.x=e,this.y=r,this.width=i,this.height=n,this.type=pr.ELIP}clone(){return new a1(this.x,this.y,this.width,this.height)}contains(e,r){if(this.width<=0||this.height<=0)return!1;let i=(e-this.x)/this.width,n=(r-this.y)/this.height;return i*=i,n*=n,i+n<=1}getBounds(){return new Re(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var Ei=class{constructor(...e){let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){let i=[];for(let n=0,s=r.length;n<s;n++)i.push(r[n].x,r[n].y);r=i}this.points=r,this.type=pr.POLY,this.closeStroke=!0}clone(){let e=this.points.slice(),r=new Ei(e);return r.closeStroke=this.closeStroke,r}contains(e,r){let i=!1,n=this.points.length/2;for(let s=0,o=n-1;s<n;o=s++){let a=this.points[s*2],l=this.points[s*2+1],c=this.points[o*2],u=this.points[o*2+1];l>r!=u>r&&e<(c-a)*((r-l)/(u-l))+a&&(i=!i)}return i}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((e,r)=>`${e}, ${r}`,"")}]`}};var l1=class{constructor(e=0,r=0,i=0,n=0,s=20){this.x=e,this.y=r,this.width=i,this.height=n,this.radius=s,this.type=pr.RREC}clone(){return new l1(this.x,this.y,this.width,this.height,this.radius)}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){let i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+i&&r<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let n=e-(this.x+i),s=r-(this.y+i),o=i*i;if(n*n+s*s<=o||(n=e-(this.x+this.width-i),n*n+s*s<=o)||(s=r-(this.y+this.height-i),n*n+s*s<=o)||(n=e-(this.x+i),n*n+s*s<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}};var gt=class{constructor(e=1,r=0,i=0,n=1,s=0,o=0){this.array=null,this.a=e,this.b=r,this.c=i,this.d=n,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,i,n,s,o){return this.a=e,this.b=r,this.c=i,this.d=n,this.tx=s,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));let i=r||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,r){r=r||new Ne;let i=e.x,n=e.y;return r.x=this.a*i+this.c*n+this.tx,r.y=this.b*i+this.d*n+this.ty,r}applyInverse(e,r){r=r||new Ne;let i=1/(this.a*this.d+this.c*-this.b),n=e.x,s=e.y;return r.x=this.d*i*n+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,r.y=this.a*i*s+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){let r=Math.cos(e),i=Math.sin(e),n=this.a,s=this.c,o=this.tx;return this.a=n*r-this.b*i,this.b=n*i+this.b*r,this.c=s*r-this.d*i,this.d=s*i+this.d*r,this.tx=o*r-this.ty*i,this.ty=o*i+this.ty*r,this}append(e){let r=this.a,i=this.b,n=this.c,s=this.d;return this.a=e.a*r+e.b*n,this.b=e.a*i+e.b*s,this.c=e.c*r+e.d*n,this.d=e.c*i+e.d*s,this.tx=e.tx*r+e.ty*n+this.tx,this.ty=e.tx*i+e.ty*s+this.ty,this}setTransform(e,r,i,n,s,o,a,l,c){return this.a=Math.cos(a+c)*s,this.b=Math.sin(a+c)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(i*this.a+n*this.c),this.ty=r-(i*this.b+n*this.d),this}prepend(e){let r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){let i=this.a,n=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){let r=this.a,i=this.b,n=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-n,s),l=Math.atan2(i,r),c=Math.abs(a+l);return c<1e-5||Math.abs(ol-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(r*r+i*i),e.scale.y=Math.sqrt(n*n+s*s),e.position.x=this.tx+(o.x*r+o.y*n),e.position.y=this.ty+(o.x*i+o.y*s),e}invert(){let e=this.a,r=this.b,i=this.c,n=this.d,s=this.tx,o=e*n-r*i;return this.a=n/o,this.b=-r/o,this.c=-i/o,this.d=e/o,this.tx=(i*this.ty-n*s)/o,this.ty=-(e*this.ty-r*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let e=new gt;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new gt}static get TEMP_MATRIX(){return new gt}};var c1=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],u1=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],f1=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],d1=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Om=[],$S=[],rh=Math.sign;function BO(){for(let t=0;t<16;t++){let e=[];Om.push(e);for(let r=0;r<16;r++){let i=rh(c1[t]*c1[r]+f1[t]*u1[r]),n=rh(u1[t]*c1[r]+d1[t]*u1[r]),s=rh(c1[t]*f1[r]+f1[t]*d1[r]),o=rh(u1[t]*f1[r]+d1[t]*d1[r]);for(let a=0;a<16;a++)if(c1[a]===i&&u1[a]===n&&f1[a]===s&&d1[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){let e=new gt;e.set(c1[t],u1[t],f1[t],d1[t],0,0),$S.push(e)}}BO();var Sr={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>c1[t],uY:t=>u1[t],vX:t=>f1[t],vY:t=>d1[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>Om[t][e],sub:(t,e)=>Om[t][Sr.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?Sr.S:Sr.N:Math.abs(e)*2<=Math.abs(t)?t>0?Sr.E:Sr.W:e>0?t>0?Sr.SE:Sr.SW:t>0?Sr.NE:Sr.NW,matrixAppendRotationInv:(t,e,r=0,i=0)=>{let n=$S[Sr.inv(e)];n.tx=r,n.ty=i,t.append(n)}};var Pi=class{constructor(e,r,i=0,n=0){this._x=i,this._y=n,this.cb=e,this.scope=r}clone(e=this.cb,r=this.scope){return new Pi(e,r,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}};var jS=class{constructor(){this.worldTransform=new gt,this.localTransform=new gt,this.position=new Pi(this.onChange,this,0,0),this.scale=new Pi(this.onChange,this,1,1),this.pivot=new Pi(this.onChange,this,0,0),this.skew=new Pi(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){let t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){let e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){let r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}},h1=jS;h1.IDENTITY=new jS;var VS=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`;var XS=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function ih(t,e,r){let i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function Lm(t){let e=new Array(t);for(let r=0;r<e.length;r++)e[r]=!1;return e}function z2(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Lm(2*e);case"bvec3":return Lm(3*e);case"bvec4":return Lm(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var xo=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}];var UO={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},GO={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Bm(t,e){let r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let i in t.uniforms){let n=e[i];if(!n){t.uniforms[i]?.group&&(t.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}let s=t.uniforms[i],o=!1;for(let a=0;a<xo.length;a++)if(xo[a].test(n,s)){r.push(xo[a].code(i,s)),o=!0;break}if(!o){let l=(n.size===1&&!n.isArray?UO:GO)[n.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}var WS={},nh=WS;function sh(){if(nh===WS||nh?.isContextLost()){let t=ue.ADAPTER.createCanvas(),e;ue.PREFER_ENV>=en.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),nh=e}return nh}var oh;function Um(){if(!oh){oh=tn.MEDIUM;let t=sh();t&&t.getShaderPrecisionFormat&&(oh=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?tn.HIGH:tn.MEDIUM)}return oh}function qS(t,e){let r=t.getShaderSource(e).split(`
`).map((c,u)=>`${u}: ${c}`),i=t.getShaderInfoLog(e),n=i.split(`
`),s={},o=n.map(c=>parseFloat(c.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(c=>c&&!s[c]?(s[c]=!0,!0):!1),a=[""];o.forEach(c=>{r[c-1]=`%c${r[c-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});let l=r.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function Gm(t,e,r,i){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||qS(t,r),t.getShaderParameter(i,t.COMPILE_STATUS)||qS(t,i),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}var zO={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function H2(t){return zO[t]}var ah=null,YS={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function $2(t,e){if(!ah){let r=Object.keys(YS);ah={};for(let i=0;i<r.length;++i){let n=r[i];ah[t[n]]=YS[n]}}return ah[e]}function lh(t,e,r){if(t.substring(0,9)!=="precision"){let i=e;return e===tn.HIGH&&r!==tn.HIGH&&(i=tn.MEDIUM),`precision ${i} float;
${t}`}else if(r!==tn.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}var j2;function ch(){if(typeof j2=="boolean")return j2;try{j2=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{j2=!1}return j2}var HO=0,uh={},D0=class{constructor(t,e,r="pixi-shader",i={}){this.extra={},this.id=HO++,this.vertexSrc=t||D0.defaultVertexSrc,this.fragmentSrc=e||D0.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),uh[r]?(uh[r]++,r+=`-${uh[r]}`):uh[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=lh(this.vertexSrc,D0.defaultVertexPrecision,tn.HIGH),this.fragmentSrc=lh(this.fragmentSrc,D0.defaultFragmentPrecision,Um())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return XS}static get defaultFragmentSrc(){return VS}static from(t,e,r){let i=t+e,n=w2[i];return n||(w2[i]=n=new D0(t,e,r)),n}},Si=D0;Si.defaultVertexPrecision=tn.HIGH;Si.defaultFragmentPrecision=fs.apple.device?tn.HIGH:tn.MEDIUM;var $O=0,pi=class{constructor(e,r,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=$O++,this.static=!!r,this.ubo=!!i,e instanceof rr?(this.buffer=e,this.buffer.type=wn.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new rr(new Float32Array(1)),this.buffer.type=wn.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,r,i){if(!this.ubo)this.uniforms[e]=new pi(r,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,r,i){return new pi(e,r,i)}static uboFrom(e,r){return new pi(e,r??!0,!0)}};var mi=class{constructor(e,r){this.uniformBindCount=0,this.program=e,r?r instanceof pi?this.uniformGroup=r:this.uniformGroup=new pi(r):this.uniformGroup=new pi({}),this.disposeRunner=new Kr("disposeShader")}checkUniformExists(e,r){if(r.uniforms[e])return!0;for(let i in r.uniforms){let n=r.uniforms[i];if(n.group&&this.checkUniformExists(e,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,r,i){let n=Si.from(e,r);return new mi(n,i)}};var V2=class{constructor(e,r){if(this.vertexSrc=e,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){let i=new Int32Array(e);for(let s=0;s<e;s++)i[s]=s;this.defaultGroupCache[e]=pi.from({uSamplers:i},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${e}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Si(this.vertexSrc,n)}let r={tint:new Float32Array([1,1,1,1]),translationMatrix:new gt,default:this.defaultGroupCache[e]};return new mi(this.programCache[e],r)}generateSampleSrc(e){let r="";r+=`
`,r+=`
`;for(let i=0;i<e;i++)i>0&&(r+=`
else `),i<e-1&&(r+=`if(vTextureId < ${i}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}};var al=class{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}};function QS(){return!fs.apple.device}function KS(t){let e=!0,r=ue.ADAPTER.getNavigator();if(fs.tablet||fs.phone){if(fs.apple.device){let i=r.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(e=!1)}if(fs.android.device){let i=r.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(e=!1)}}return e?t:4}var Hs=class{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}};var ZS=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;var JS=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;var $s=class extends Hs{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=o1,this.vertexSize=6,this.state=hi.for2d(),this.size=$s.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??KS(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??QS(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return ht("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return JS}static get defaultFragmentTemplate(){return ZS}setShaderGenerator({vertex:t=$s.defaultVertexSrc,fragment:e=$s.defaultFragmentTemplate}={}){this.shaderGenerator=new V2(t,e)}contextChange(){let t=this.renderer.gl;ue.PREFER_ENV===en.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),$s.defaultMaxTextures),this.maxTextures=eh(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:t,_textureArrayPool:e}=$s,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;t.length<r;)t.push(new nl);for(;e.length<i;)e.push(new al);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){let{_bufferedTextures:t,maxTextures:e}=this,r=$s._textureArrayPool,i=this.renderer.batch,n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++Le._globalBatch,a=0,l=r[0],c=0;i.copyBoundTextures(n,e);for(let u=0;u<this._bufferSize;++u){let d=t[u];t[u]=null,d._batchEnabled!==o&&(l.count>=e&&(i.boundArray(l,n,o,e),this.buildDrawCalls(l,c,u),c=u,l=r[++a],++o),d._batchEnabled=o,d.touched=s,l.elements[l.count++]=d)}l.count>0&&(i.boundArray(l,n,o,e),this.buildDrawCalls(l,c,this._bufferSize),++a,++o);for(let u=0;u<n.length;u++)n[u]=null;Le._globalBatch=o}buildDrawCalls(t,e,r){let{_bufferedElements:i,_attributeBuffer:n,_indexBuffer:s,vertexSize:o}=this,a=$s._drawCallPool,l=this._dcIndex,c=this._aIndex,u=this._iIndex,d=a[l];d.start=this._iIndex,d.texArray=t;for(let h=e;h<r;++h){let p=i[h],m=p._texture.baseTexture,g=x2[m.alphaMode?1:0][p.blendMode];i[h]=null,e<h&&d.blend!==g&&(d.size=u-d.start,e=h,d=a[++l],d.texArray=t,d.start=u),this.packInterleavedGeometry(p,n,s,c,u),c+=p.vertexData.length/2*o,u+=p.indices.length,d.blend=g}e<r&&(d.size=u-d.start,++l),this._dcIndex=l,this._aIndex=c,this._iIndex=u}bindAndClearTexArray(t){let e=this.renderer.texture;for(let r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0}updateGeometry(){let{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:r}=this;$s.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let t=this._dcIndex,{gl:e,state:r}=this.renderer,i=$s._drawCallPool,n=null;for(let s=0;s<t;s++){let{texArray:o,type:a,size:l,start:c,blend:u}=i[s];n!==o&&(n=o,this.bindAndClearTexArray(o)),this.state.blendMode=u,r.set(this.state),e.drawElements(a,l,e.UNSIGNED_SHORT,c*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),$s.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){let e=Ya(Math.ceil(t/8)),r=b2(e),i=e*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new il(i*this.vertexSize*4)),n}getIndexBuffer(t){let e=Ya(Math.ceil(t/12)),r=b2(e),i=e*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n}packInterleavedGeometry(t,e,r,i,n){let{uint32View:s,float32View:o}=e,a=i/this.vertexSize,l=t.uvs,c=t.indices,u=t.vertexData,d=t._texture.baseTexture._batchLocation,h=Math.min(t.worldAlpha,1),p=bt.shared.setValue(t._tintRGB).toPremultiplied(h,t._texture.baseTexture.alphaMode>0);for(let m=0;m<u.length;m+=2)o[i++]=u[m],o[i++]=u[m+1],o[i++]=l[m],o[i++]=l[m+1],s[i++]=p,o[i++]=d;for(let m=0;m<c.length;m++)r[n++]=a+c[m]}},jn=$s;jn.defaultBatchSize=4096;jn.extension={name:"batch",type:me.RendererPlugin};jn._drawCallPool=[];jn._textureArrayPool=[];_e.add(jn);var eT=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`;var tT=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var X2=class extends mi{constructor(t,e,r){let i=Si.from(t||X2.defaultVertexSrc,e||X2.defaultFragmentSrc);super(i,r),this.padding=0,this.resolution=X2.defaultResolution,this.multisample=X2.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new hi}apply(t,e,r,i,n){t.applyFilter(this,e,r,i)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return tT}static get defaultFragmentSrc(){return eT}},ke=X2;ke.defaultResolution=1;ke.defaultMultisample=ar.NONE;var na=class{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new bt(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;let{backgroundColor:r,background:i,backgroundAlpha:n}=e,s=i??r;s!==void 0&&(this.color=s),this.alpha=n}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}};na.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};na.extension={type:[me.RendererSystem,me.CanvasRendererSystem],name:"background"};_e.add(na);var F0=class{constructor(e){this.renderer=e,this.emptyRenderer=new Hs(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,r){let{boundTextures:i}=this.renderer.texture;for(let n=r-1;n>=0;--n)e[n]=i[n]||null,e[n]&&(e[n]._batchLocation=n)}boundArray(e,r,i,n){let{elements:s,ids:o,count:a}=e,l=0;for(let c=0;c<a;c++){let u=s[c],d=u._batchLocation;if(d>=0&&d<n&&r[d]===u){o[c]=d;continue}for(;l<n;){let h=r[l];if(h&&h._batchEnabled===i&&h._batchLocation===l){l++;continue}o[c]=l,u._batchLocation=l,r[l]=u;break}}}destroy(){this.renderer=null}};F0.extension={type:me.RendererSystem,name:"batch"};_e.add(F0);var rT=0,sa=class{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=rT++}init(e){if(e.context)this.initFromContext(e.context);else{let r=this.renderer.background.alpha<1,i=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:i,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=rT++,this.renderer.runners.contextChange.emit(e);let r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){let r=this.createContext(this.renderer.view,e);this.initFromContext(r)}createContext(e,r){let i;if(ue.PREFER_ENV>=en.WEBGL2&&(i=e.getContext("webgl2",r)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=e.getContext("webgl",r)||e.getContext("experimental-webgl",r),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){let{gl:e}=this,r={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){let r=e.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");let n=i||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}};sa.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};sa.extension={type:me.RendererSystem,name:"context"};_e.add(sa);var fh=class extends Tn{upload(e,r,i){let n=e.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===$r.UNPACK);let s=r.realWidth,o=r.realHeight;return i.width===s&&i.height===o?n.texSubImage2D(r.target,0,0,0,s,o,r.format,i.type,this.data):(i.width=s,i.height=o,n.texImage2D(r.target,0,i.internalFormat,s,o,0,r.format,i.type,this.data)),!0}};var ll=class{constructor(e,r){this.width=Math.round(e||100),this.height=Math.round(r||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Kr("disposeFramebuffer"),this.multisample=ar.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,r){return this.colorTextures[e]=r||new Le(null,{scaleMode:ki.NEAREST,resolution:1,mipmap:oi.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new Le(new fh(null,{width:this.width,height:this.height}),{scaleMode:ki.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:oi.OFF,format:Ce.DEPTH_COMPONENT,type:Ge.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,r){if(e=Math.round(e),r=Math.round(r),!(e===this.width&&r===this.height)){this.width=e,this.height=r,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){let n=this.colorTextures[i],s=n.resolution;n.setSize(e/s,r/s)}if(this.depthTexture){let i=this.depthTexture.resolution;this.depthTexture.setSize(e/i,r/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}};var cl=class extends Le{constructor(e={}){if(typeof e=="number"){let r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}e.width=e.width||100,e.height=e.height||100,e.multisample??(e.multisample=ar.NONE),super(null,e),this.mipmap=oi.OFF,this.valid=!0,this._clear=new bt([0,0,0,0]),this.framebuffer=new ll(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(e,r){this.framebuffer.resize(e*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}};var Ri=class extends an{constructor(e){let r=e,i=r.naturalWidth||r.videoWidth||r.width,n=r.naturalHeight||r.videoHeight||r.height;super(i,n),this.source=e,this.noSubImage=!1}static crossOrigin(e,r,i){i===void 0&&!r.startsWith("data:")?e.crossOrigin=fd(r):i!==!1&&(e.crossOrigin=typeof i=="string"?i:"anonymous")}upload(e,r,i,n){let s=e.gl,o=r.realWidth,a=r.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1&&n.buffered.length===0)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===$r.UNPACK),!this.noSubImage&&r.target===s.TEXTURE_2D&&i.width===o&&i.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,r.format,i.type,n):(i.width=o,i.height=a,s.texImage2D(r.target,0,i.internalFormat,r.format,i.type,n)),!0}update(){if(this.destroyed)return;let e=this.source,r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(r,i),super.update()}dispose(){this.source=null}};var ul=class extends Ri{constructor(e,r){if(r=r||{},typeof e=="string"){let i=new Image;Ri.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??ue.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((r,i)=>{let n=this.source;this.url=n.src;let s=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.resize(n.width,n.height),this._load=null,this.createBitmap?r(this.process()):r(this))};n.complete&&n.src?s():(n.onload=s,n.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){let e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);let r=globalThis.createImageBitmap,i=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then(n=>n.blob()).then(n=>r(n,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===$r.UNPACK?"premultiply":"none"})).then(n=>this.destroyed?Promise.reject():(this.bitmap=n,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,r,i){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,r,i,this.bitmap),!this.preserveBitmap){let n=!0,s=r._glTextures;for(let o in s){let a=s[o];if(a!==i&&a.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}};var O0=class{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,r,i){let n=r.width,s=r.height;if(i){let o=e.width/2/n,a=e.height/2/s,l=e.x/n+o,c=e.y/s+a;i=Sr.add(i,Sr.NW),this.x0=l+o*Sr.uX(i),this.y0=c+a*Sr.uY(i),i=Sr.add(i,2),this.x1=l+o*Sr.uX(i),this.y1=c+a*Sr.uY(i),i=Sr.add(i,2),this.x2=l+o*Sr.uX(i),this.y2=c+a*Sr.uY(i),i=Sr.add(i,2),this.x3=l+o*Sr.uX(i),this.y3=c+a*Sr.uY(i)}else this.x0=e.x/n,this.y0=e.y/s,this.x1=(e.x+e.width)/n,this.y1=e.y/s,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/s,this.x3=e.x/n,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}};var iT=new O0;function dh(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}var be=class extends xr.default{constructor(e,r,i,n,s,o,a){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new Re(0,0,1,1)),e instanceof be&&(e=e.baseTexture),this.baseTexture=e,this._frame=r,this.trim=n,this.valid=!1,this._uvs=iT,this.uvMatrix=null,this.orig=i||r,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Ne(o.x,o.y):new Ne(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=r:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){let{resource:r}=this.baseTexture;r?.url&&bi[r.url]&&be.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,be.removeFromCache(this),this.textureCacheIds=null}clone(){let e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),i=new be(this.baseTexture,!this.noFrame&&e,r,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=e),i}updateUvs(){this._uvs===iT&&(this._uvs=new O0),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,r={},i=ue.STRICT_TEXTURE_CACHE){let n=typeof e=="string",s=null;if(n)s=e;else if(e instanceof Le){if(!e.cacheId){let a=r?.pixiIdPrefix||"pixiid";e.cacheId=`${a}-${ho()}`,Le.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){let a=r?.pixiIdPrefix||"pixiid";e._pixiId=`${a}_${ho()}`}s=e._pixiId}let o=bi[s];if(n&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof Le)?(r.resolution||(r.resolution=E2(e)),o=new be(new Le(e,r)),o.baseTexture.cacheId=s,Le.addToCache(o.baseTexture,s),be.addToCache(o,s)):!o&&e instanceof Le&&(o=new be(e),be.addToCache(o,s)),o}static fromURL(e,r){let i=Object.assign({autoLoad:!1},r?.resourceOptions),n=be.from(e,Object.assign({resourceOptions:i},r),!1),s=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):s.load().then(()=>Promise.resolve(n))}static fromBuffer(e,r,i,n){return new be(Le.fromBuffer(e,r,i,n))}static fromLoader(e,r,i,n){let s=new Le(e,Object.assign({scaleMode:Le.defaultOptions.scaleMode,resolution:E2(r)},n)),{resource:o}=s;o instanceof ul&&(o.url=r);let a=new be(s);return i||(i=r),Le.addToCache(a.baseTexture,i),be.addToCache(a,i),i!==r&&(Le.addToCache(a.baseTexture,r),be.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),bi[r]&&bi[r]!==e&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),bi[r]=e)}static removeFromCache(e){if(typeof e=="string"){let r=bi[e];if(r){let i=r.textureCacheIds.indexOf(e);return i>-1&&r.textureCacheIds.splice(i,1),delete bi[e],r}}else if(e?.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)bi[e.textureCacheIds[r]]===e&&delete bi[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;let{x:r,y:i,width:n,height:s}=e,o=r+n>this.baseTexture.width,a=i+s>this.baseTexture.height;if(o||a){let l=o&&a?"and":"or",c=`X: ${r} + ${n} = ${r+n} > ${this.baseTexture.width}`,u=`Y: ${i} + ${s} = ${i+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${c} ${l} ${u}`)}this.valid=n&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return be._EMPTY||(be._EMPTY=new be(new Le),dh(be._EMPTY),dh(be._EMPTY.baseTexture)),be._EMPTY}static get WHITE(){if(!be._WHITE){let e=ue.ADAPTER.createCanvas(16,16),r=e.getContext("2d");e.width=16,e.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),be._WHITE=new be(Le.from(e)),dh(be._WHITE),dh(be._WHITE.baseTexture)}return be._WHITE}};var ln=class extends be{constructor(e,r){super(e,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r,i=!0){let n=this.baseTexture.resolution,s=Math.round(e*n)/n,o=Math.round(r*n)/n;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){let{baseTexture:r}=this;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))}static create(e){return new ln(new cl(e))}};var L0=class{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,r,i=ar.NONE){let n=new cl(Object.assign({width:e,height:r,resolution:1,multisample:i},this.textureOptions));return new ln(n)}getOptimalTexture(e,r,i=1,n=ar.NONE){let s;e=Math.ceil(e*i-1e-6),r=Math.ceil(r*i-1e-6),!this.enableFullScreen||e!==this._pixelsWidth||r!==this._pixelsHeight?(e=Ya(e),r=Ya(r),s=((e&65535)<<16|r&65535)>>>0,n>1&&(s+=n*4294967296)):s=n>1?-n:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,r,n)),o.filterPoolKey=s,o.setResolution(i),o}getFilterTexture(e,r,i){let n=this.getOptimalTexture(e.width,e.height,r||e.resolution,i||ar.NONE);return n.filterFrame=e.filterFrame,n}returnTexture(e){let r=e.filterPoolKey;e.filterFrame=null,this.texturePool[r].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(let r in this.texturePool){let i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(let r in this.texturePool){if(!(Number(r)<0))continue;let i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}};L0.SCREEN_KEY=-1;var W2=class extends wi{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}};var p1=class extends wi{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new rr(this.vertices),this.uvBuffer=new rr(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,r){let i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+r.width/e.width,this.uvs[3]=n,this.uvs[4]=i+r.width/e.width,this.uvs[5]=n+r.height/e.height,this.uvs[6]=i,this.uvs[7]=n+r.height/e.height,i=r.x,n=r.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+r.width,this.vertices[3]=n,this.vertices[4]=i+r.width,this.vertices[5]=n+r.height,this.vertices[6]=i,this.vertices[7]=n+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}};var q2=class{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=ar.NONE,this.sourceFrame=new Re,this.destinationFrame=new Re,this.bindingSourceFrame=new Re,this.bindingDestinationFrame=new Re,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}};var hh=[new Ne,new Ne,new Ne,new Ne],zm=new gt,B0=class{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new L0,this.statePool=[],this.quad=new W2,this.quadUv=new p1,this.tempRect=new Re,this.activeState={},this.globalUniforms=new pi({outputFrame:new Re,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,r){let i=this.renderer,n=this.defaultFilterStack,s=this.statePool.pop()||new q2,o=this.renderer.renderTexture,a=r[0].resolution,l=r[0].multisample,c=r[0].padding,u=r[0].autoFit,d=r[0].legacy??!0;for(let m=1;m<r.length;m++){let g=r[m];a=Math.min(a,g.resolution),l=Math.min(l,g.multisample),c=this.useMaxPadding?Math.max(c,g.padding):c+g.padding,u=u&&g.autoFit,d=d||(g.legacy??!0)}n.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),n.push(s),s.resolution=a,s.multisample=l,s.legacy=d,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(c);let h=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(zm.copyFrom(i.projection.transform).invert(),h),u?(s.sourceFrame.fit(h),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(h)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,a,l),s.filters=r,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;let p=this.tempRect;p.x=0,p.y=0,p.width=s.sourceFrame.width,p.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=i.projection.transform,i.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,p),i.framebuffer.clear(0,0,0,0)}pop(){let e=this.defaultFilterStack,r=e.pop(),i=r.filters;this.activeState=r;let n=this.globalUniforms.uniforms;n.outputFrame=r.sourceFrame,n.resolution=r.resolution;let s=n.inputSize,o=n.inputPixel,a=n.inputClamp;if(s[0]=r.destinationFrame.width,s[1]=r.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*r.resolution),o[1]=Math.round(s[1]*r.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=r.sourceFrame.width*s[2]-.5*o[2],a[3]=r.sourceFrame.height*s[3]-.5*o[3],r.legacy){let c=n.filterArea;c[0]=r.destinationFrame.width,c[1]=r.destinationFrame.height,c[2]=r.sourceFrame.x,c[3]=r.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();let l=e[e.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,r.renderTexture,l.renderTexture,Un.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let c=r.renderTexture,u=this.getOptimalFilterTexture(c.width,c.height,r.resolution);u.filterFrame=c.filterFrame;let d=0;for(d=0;d<i.length-1;++d){d===1&&r.multisample>1&&(u=this.getOptimalFilterTexture(c.width,c.height,r.resolution),u.filterFrame=c.filterFrame),i[d].apply(this,c,u,Un.CLEAR,r);let h=c;c=u,u=h}i[d].apply(this,c,l.renderTexture,Un.BLEND,r),d>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(c),this.returnFilterTexture(u)}r.clear(),this.statePool.push(r)}bindAndClear(e,r=Un.CLEAR){let{renderTexture:i,state:n}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e?.filterFrame){let o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,i.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);let s=n.stateId&1||this.forceClear;(r===Un.CLEAR||r===Un.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,r,i,n){let s=this.renderer;s.state.set(e.state),this.bindAndClear(i,n),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(r._frame,r.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(_n.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(_n.TRIANGLE_STRIP))}calculateSpriteMatrix(e,r){let{sourceFrame:i,destinationFrame:n}=this.activeState,{orig:s}=r._texture,o=e.set(n.width,0,0,n.height,i.x,i.y),a=r.worldTransform.copyTo(gt.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(r.anchor.x,r.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,r,i=1,n=ar.NONE){return this.texturePool.getOptimalTexture(e,r,i,n)}getFilterTexture(e,r,i){if(typeof e=="number"){let s=e;e=r,r=s}e=e||this.activeState.renderTexture;let n=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution,i||ar.NONE);return n.filterFrame=e.filterFrame,n}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,r){let i=hh[0],n=hh[1],s=hh[2],o=hh[3];i.set(r.left,r.top),n.set(r.left,r.bottom),s.set(r.right,r.top),o.set(r.right,r.bottom),e.apply(i,i),e.apply(n,n),e.apply(s,s),e.apply(o,o);let a=Math.min(i.x,n.x,s.x,o.x),l=Math.min(i.y,n.y,s.y,o.y),c=Math.max(i.x,n.x,s.x,o.x),u=Math.max(i.y,n.y,s.y,o.y);r.x=a,r.y=l,r.width=c-a,r.height=u-l}roundFrame(e,r,i,n,s){if(!(e.width<=0||e.height<=0||i.width<=0||i.height<=0)){if(s){let{a:o,b:a,c:l,d:c}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(c)>1e-4))return}s=s?zm.copyFrom(s):zm.identity(),s.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.transformAABB(s,e),e.ceil(r),this.transformAABB(s.invert(),e)}}};B0.extension={type:me.RendererSystem,name:"filter"};_e.add(B0);var Y2=class{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=ar.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}};var jO=new Re,U0=class{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new ll(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Re,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;ue.PREFER_ENV===en.WEBGL_LEGACY&&(r=null,i=null),r?e.drawBuffers=n=>r.drawBuffersWEBGL(n):(this.hasMRT=!1,e.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,r,i=0){let{gl:n}=this;if(e){let s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,n.bindFramebuffer(n.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==i&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=i),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,i)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){let a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r){let o=r.width>>i,a=r.height>>i,l=o/r.width;this.setViewport(r.x*l,r.y*l,o,a)}else{let o=e.width>>i,a=e.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,r,i,n){let s=this.viewport;e=Math.round(e),r=Math.round(r),i=Math.round(i),n=Math.round(n),(s.width!==i||s.height!==n||s.x!==e||s.y!==r)&&(s.x=e,s.y=r,s.width=i,s.height=n,this.gl.viewport(e,r,i,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,r,i,n,s=id.COLOR|id.DEPTH){let{gl:o}=this;o.clearColor(e,r,i,n),o.clear(s)}initFramebuffer(e){let{gl:r}=this,i=new Y2(r.createFramebuffer());return i.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(e),e.disposeRunner.add(this),i}resizeFramebuffer(e){let{gl:r}=this,i=e.glFramebuffers[this.CONTEXT_UID];i.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e.width,e.height));let n=e.colorTextures,s=n.length;r.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){let a=n[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&i.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,r){let{gl:i}=this,n=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures,o=s.length;i.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&this.canMultisampleFramebuffer(e)?n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer():n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));let a=[];for(let l=0;l<o;l++){let c=s[l],u=c.parentTextureArray||c;this.renderer.texture.bind(u,0),l===0&&n.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,c.target,u._glTextures[this.CONTEXT_UID].texture,r),a.push(i.COLOR_ATTACHMENT0+l))}if(a.length>1&&i.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){let c=e.depthTexture;this.renderer.texture.bind(c,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,c._glTextures[this.CONTEXT_UID].texture,r)}(e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)?(n.stencil=n.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,i.DEPTH24_STENCIL8,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,n.stencil)):n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){let{msaaSamples:r}=this,i=ar.NONE;if(e<=1||r===null)return i;for(let n=0;n<r.length;n++)if(r[n]<=e){i=r[n];break}return i===1&&(i=ar.NONE),i}blit(e,r,i){let{current:n,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!n)return;let l=n.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;let u=n.colorTextures[0];if(!u)return;l.blitFramebuffer||(l.blitFramebuffer=new ll(n.width,n.height),l.blitFramebuffer.addColorTexture(0,u)),e=l.blitFramebuffer,e.colorTextures[0]!==u&&(e.colorTextures[0]=u,e.dirtyId++,e.dirtyFormat++),(e.width!==n.width||e.height!==n.height)&&(e.width=n.width,e.height=n.height,e.dirtyId++,e.dirtySize++)}r||(r=jO,r.width=n.width,r.height=n.height),i||(i=r);let c=r.width===i.width&&r.height===i.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(r.left,r.top,r.right,r.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,c?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,r){let i=e.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!i)return;delete e.glFramebuffers[this.CONTEXT_UID];let s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),r||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,r)}disposeAll(e){let r=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<r.length;i++)this.disposeFramebuffer(r[i],e)}forceStencil(){let e=this.current;if(!e)return;let r=e.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil)return;e.stencil=!0;let i=e.width,n=e.height,s=this.gl,o=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,s.DEPTH24_STENCIL8,i,n):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,i,n),r.stencil=o,s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Re}destroy(){this.renderer=null}};U0.extension={type:me.RendererSystem,name:"framebuffer"};_e.add(U0);var Hm={5126:4,5123:2,5121:1},G0=class{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;ue.PREFER_ENV===en.WEBGL_LEGACY&&(i=null),i?(e.createVertexArray=()=>i.createVertexArrayOES(),e.bindVertexArray=n=>i.bindVertexArrayOES(n),e.deleteVertexArray=n=>i.deleteVertexArrayOES(n)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){let i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=(n,s)=>i.vertexAttribDivisorANGLE(n,s),e.drawElementsInstanced=(n,s,o,a,l)=>i.drawElementsInstancedANGLE(n,s,o,a,l),e.drawArraysInstanced=(n,s,o,a)=>i.drawArraysInstancedANGLE(n,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(e,r){r=r||this.renderer.shader.shader;let{gl:i}=this,n=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;n||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=n={},s=!0);let o=n[r.program.id]||this.initGeometryVao(e,r,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(e,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let e=this._activeGeometry,r=this.renderer.buffer;for(let i=0;i<e.buffers.length;i++){let n=e.buffers[i];r.update(n)}}checkCompatibility(e,r){let i=e.attributes,n=r.attributeData;for(let s in n)if(!i[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,r){let i=e.attributes,n=r.attributeData,s=["g",e.id];for(let o in i)n[o]&&s.push(o,n[o].location);return s.join("-")}initGeometryVao(e,r,i=!0){let n=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=r.program;a.glPrograms[s]||this.renderer.shader.generateProgram(r),this.checkCompatibility(e,a);let l=this.getSignature(e,a),c=e.glVertexArrayObjects[this.CONTEXT_UID],u=c[l];if(u)return c[a.id]=u,u;let d=e.buffers,h=e.attributes,p={},m={};for(let g in d)p[g]=0,m[g]=0;for(let g in h)!h[g].size&&a.attributeData[g]?h[g].size=a.attributeData[g].size:h[g].size||console.warn(`PIXI Geometry attribute '${g}' size cannot be determined (likely the bound shader does not have the attribute)`),p[h[g].buffer]+=h[g].size*Hm[h[g].type];for(let g in h){let y=h[g],v=y.size;y.stride===void 0&&(p[y.buffer]===v*Hm[y.type]?y.stride=0:y.stride=p[y.buffer]),y.start===void 0&&(y.start=m[y.buffer],m[y.buffer]+=v*Hm[y.type])}u=n.createVertexArray(),n.bindVertexArray(u);for(let g=0;g<d.length;g++){let y=d[g];o.bind(y),i&&y._glBuffers[s].refCount++}return this.activateVao(e,a),c[a.id]=u,c[l]=u,n.bindVertexArray(null),o.unbind(wn.ARRAY_BUFFER),u}disposeGeometry(e,r){if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];let i=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,s=e.buffers,o=this.renderer?.buffer;if(e.disposeRunner.remove(this),!!i){if(o)for(let a=0;a<s.length;a++){let l=s[a]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!r&&o.dispose(s[a],r))}if(!r){for(let a in i)if(a[0]==="g"){let l=i[a];this._activeVao===l&&this.unbind(),n.deleteVertexArray(l)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){let r=Object.keys(this.managedGeometries);for(let i=0;i<r.length;i++)this.disposeGeometry(this.managedGeometries[r[i]],e)}activateVao(e,r){let i=this.gl,n=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(let c in a){let u=a[c],d=o[u.buffer],h=d._glBuffers[n];if(r.attributeData[c]){l!==h&&(s.bind(d),l=h);let p=r.attributeData[c].location;if(i.enableVertexAttribArray(p),i.vertexAttribPointer(p,u.size,u.type||i.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)i.vertexAttribDivisor(p,u.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,r,i,n){let{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){let a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,r||o.indexBuffer.data.length,l,(i||0)*a,n||1):s.drawElements(e,r||o.indexBuffer.data.length,l,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,i,r||o.getSize(),n||1):s.drawArrays(e,i,r||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}};G0.extension={type:me.RendererSystem,name:"geometry"};_e.add(G0);var nT=new gt,fl=class{constructor(e,r){this._texture=e,this.mapCoord=new gt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,r){r===void 0&&(r=e);let i=this.mapCoord;for(let n=0;n<e.length;n+=2){let s=e[n],o=e[n+1];r[n]=s*i.a+o*i.c+i.tx,r[n+1]=s*i.b+o*i.d+i.ty}return r}update(e){let r=this._texture;if(!r||!r.valid||!e&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;let i=r._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);let n=r.orig,s=r.trim;s&&(nT.set(n.width/s.width,0,0,n.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(nT));let o=r.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,c=this.clampOffset;return a[0]=(r._frame.x+l+c)/o.width,a[1]=(r._frame.y+l+c)/o.height,a[2]=(r._frame.x+r._frame.width-l+c)/o.width,a[3]=(r._frame.y+r._frame.height-l+c)/o.height,this.uClampOffset[0]=c/o.realWidth,this.uClampOffset[1]=c/o.realHeight,this.isSimple=r._frame.width===o.width&&r._frame.height===o.height&&r.rotate===0,!0}};var sT=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`;var oT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;var Q2=class extends ke{constructor(e,r,i){let n=null;typeof e!="string"&&r===void 0&&i===void 0&&(n=e,e=void 0,r=void 0,i=void 0),super(e||oT,r||sT,i),this.maskSprite=n,this.maskMatrix=new gt}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,r,i,n){let s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new fl(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,r,i,n))}};var K2=class{constructor(e=null){this.type=jr.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=ke.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=jr.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}};var z0=class{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,r){let i=r;if(!i.isMaskData){let s=this.maskDataPool.pop()||new K2;s.pooled=!0,s.maskObject=r,i=s}let n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(n),i._colorMask=n?n._colorMask:15,i.autoDetect&&this.detect(i),i._target=e,i.type!==jr.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case jr.SCISSOR:this.renderer.scissor.push(i);break;case jr.STENCIL:this.renderer.stencil.push(i);break;case jr.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case jr.COLOR:this.pushColorMask(i);break;default:break}i.type===jr.SPRITE&&this.maskStack.push(i)}pop(e){let r=this.maskStack.pop();if(!(!r||r._target!==e)){if(r.enabled)switch(r.type){case jr.SCISSOR:this.renderer.scissor.pop(r);break;case jr.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case jr.SPRITE:this.popSpriteMask(r);break;case jr.COLOR:this.popColorMask(r);break;default:break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){let i=this.maskStack[this.maskStack.length-1];i.type===jr.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(e){let r=e.maskObject;r?r.isSprite?e.type=jr.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=jr.SCISSOR:e.type=jr.STENCIL:e.type=jr.COLOR}pushSpriteMask(e){let{maskObject:r}=e,i=e._target,n=e._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new Q2]));let s=this.renderer,o=s.renderTexture,a,l;if(o.current){let u=o.current;a=e.resolution||u.resolution,l=e.multisample??u.multisample}else a=e.resolution||s.resolution,l=e.multisample??s.multisample;n[0].resolution=a,n[0].multisample=l,n[0].maskSprite=r;let c=i.filterArea;i.filterArea=r.getBounds(!0),s.filter.push(i,n),i.filterArea=c,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){let r=e._colorMask,i=e._colorMask=r&e.colorMask;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(e){let r=e._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}};z0.extension={type:me.RendererSystem,name:"mask"};_e.add(z0);var H0=class{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){let{gl:r}=this.renderer,i=this.getStackLength();this.maskStack=e;let n=this.getStackLength();n!==i&&(n===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}};var aT=new gt,lT=[],ph=class extends H0{constructor(t){super(t),this.glConst=ue.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;let e=t._scissorRect,{maskObject:r}=t,{renderer:i}=this,n=i.renderTexture,s=r.getBounds(!0,lT.pop()??new Re);this.roundFrameToPixels(s,n.current?n.current.resolution:i.resolution,n.sourceFrame,n.destinationFrame,i.projection.transform),e&&s.fit(e),t._scissorRectLocal=s}static isMatrixRotated(t){if(!t)return!1;let{a:e,b:r,c:i,d:n}=t;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4)}testScissor(t){let{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||ph.isMatrixRotated(e.worldTransform)||ph.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);let r=t._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(t,e,r,i,n){ph.isMatrixRotated(n)||(n=n?aT.copyFrom(n):aT.identity(),n.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(n,t),t.fit(i),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);let{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){let{gl:e}=this.renderer;t&&lT.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){let t=this.maskStack[this.maskStack.length-1]._scissorRect,e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}},mh=ph;mh.extension={type:me.RendererSystem,name:"scissor"};_e.add(mh);var $0=class extends H0{constructor(e){super(e),this.glConst=ue.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){let r=e.maskObject,{gl:i}=this.renderer,n=e._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),e._stencilCounter++;let s=e._colorMask;s!==0&&(e._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,s!==0&&(e._colorMask=s,i.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){let r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{let i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(i._colorMask=n,r.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}}_useCurrent(){let e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}};$0.extension={type:me.RendererSystem,name:"stencil"};_e.add($0);var j0=class{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return ht("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return ht("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return ht("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){let e=this.rendererPlugins;for(let r in e)this.plugins[r]=new e[r](this.renderer)}destroy(){for(let e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}};j0.extension={type:[me.RendererSystem,me.CanvasRendererSystem],name:"_plugin"};_e.add(j0);var V0=class{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new gt,this.transform=null}update(e,r,i,n){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,n),this.transform&&this.projectionMatrix.append(this.transform);let s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,r,i,n){let s=this.projectionMatrix,o=n?-1:1;s.identity(),s.a=1/r.width*2,s.d=o*(1/r.height*2),s.tx=-1-r.x*s.a,s.ty=-o-r.y*s.d}setTransform(e){}destroy(){this.renderer=null}};V0.extension={type:me.RendererSystem,name:"projection"};_e.add(V0);var VO=new h1,X0=class{constructor(e){this.renderer=e,this._tempMatrix=new gt}generateTexture(e,r){let{region:i,...n}=r||{},s=i||e.getLocalBounds(null,!0);s.width===0&&(s.width=1),s.height===0&&(s.height=1);let o=ln.create({width:s.width,height:s.height,...n});this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;let a=e.transform;return e.transform=VO,this.renderer.render(e,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=a,o}destroy(){}};X0.extension={type:[me.RendererSystem,me.CanvasRendererSystem],name:"textureGenerator"};_e.add(X0);var m1=new Re,Z2=new Re,W0=class{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Re,this.destinationFrame=new Re,this.viewportFrame=new Re}contextChange(){let e=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,r,i){let n=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,r||(m1.width=e.frame.width,m1.height=e.frame.height,r=m1),i||(Z2.x=e.frame.x,Z2.y=e.frame.y,Z2.width=r.width,Z2.height=r.height,i=Z2),o=s.framebuffer):(a=n.resolution,r||(m1.width=n._view.screen.width,m1.height=n._view.screen.height,r=m1),i||(i=m1,i.width=r.width,i.height=r.height));let l=this.viewportFrame;l.x=i.x*a,l.y=i.y*a,l.width=i.width*a,l.height=i.height*a,e||(l.y=n.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(i,r,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(i)}clear(e,r){let i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=bt.shared.setValue(e||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&n.premultiply(n.alpha);let s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:c,width:u,height:d}=this.viewportFrame;l=Math.round(l),c=Math.round(c),u=Math.round(u),d=Math.round(d),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,c,u,d)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,r),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}};W0.extension={type:me.RendererSystem,name:"renderTexture"};_e.add(W0);var J2=class{constructor(e,r){this.program=e,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}};function cT(t,e){let r={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){let s=e.getActiveAttrib(t,n);if(s.name.startsWith("gl_"))continue;let o=$2(e,s.type),a={type:o,name:s.name,size:H2(o),location:e.getAttribLocation(t,s.name)};r[s.name]=a}return r}function uT(t,e){let r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){let s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=$2(e,s.type);r[o]={name:o,index:n,type:l,size:s.size,isArray:a,value:z2(l,s.size)}}return r}function $m(t,e){let r=ih(t,t.VERTEX_SHADER,e.vertexSrc),i=ih(t,t.FRAGMENT_SHADER,e.fragmentSrc),n=t.createProgram();t.attachShader(n,r),t.attachShader(n,i);let s=e.extra?.transformFeedbackVaryings;if(s&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(n,s.names,s.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)||Gm(t,n,r,i),e.attributeData=cT(n,t),e.uniformData=uT(n,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){let l=Object.keys(e.attributeData);l.sort((c,u)=>c>u?1:-1);for(let c=0;c<l.length;c++)e.attributeData[l[c]].location=c,t.bindAttribLocation(n,c,l[c]);t.linkProgram(n)}t.deleteShader(r),t.deleteShader(i);let o={};for(let l in e.uniformData){let c=e.uniformData[l];o[l]={location:t.getUniformLocation(n,l),value:z2(c.type,c.size)}}return new J2(n,o)}function XO(t,e,r,i,n){r.buffer.update(n)}var WO={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},fT={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function dT(t){let e=t.map(s=>({data:s,offset:0,dataLen:0,dirty:0})),r=0,i=0,n=0;for(let s=0;s<e.length;s++){let o=e[s];if(r=fT[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,i%r!==0&&i<16){let a=i%r%16;i+=a,n+=a}i+r>16?(n=Math.ceil(n/16)*16,o.offset=n,n+=r,i=r):(o.offset=n,i+=r,n+=r)}return n=Math.ceil(n/16)*16,{uboElements:e,size:n}}function hT(t,e){let r=[];for(let i in t)e[i]&&r.push(e[i]);return r.sort((i,n)=>i.index-n.index),r}function jm(t,e){if(!t.autoManage)return{size:0,syncFunc:XO};let r=hT(t.uniforms,e),{uboElements:i,size:n}=dT(r),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){let a=i[o],l=t.uniforms[a.data.name],c=a.data.name,u=!1;for(let d=0;d<xo.length;d++){let h=xo[d];if(h.codeUbo&&h.test(a.data,l)){s.push(`offset = ${a.offset/4};`,xo[d].codeUbo(a.data.name,l)),u=!0;break}}if(!u)if(a.data.size>1){let d=H2(a.data.type),h=Math.max(fT[a.data.type]/16,1),p=d/h,m=(4-p%4)%4;s.push(`
                cv = ud.${c}.value;
                v = uv.${c};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*h}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{let d=WO[a.data.type];s.push(`
                cv = ud.${c}.value;
                v = uv.${c};
                offset = ${a.offset/4};
                ${d};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}var qO=0,gh={textureCount:0,uboCount:0},q0=class{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=qO++}systemCheck(){if(!ch())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,r){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;let i=e.program,n=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==i&&(this.program=i,this.gl.useProgram(n.program)),r||(gh.textureCount=0,gh.uboCount=0,this.syncUniformGroup(e.uniformGroup,gh)),n}setUniforms(e){let r=this.shader.program,i=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(i.uniformData,e,this.renderer)}syncUniformGroup(e,r){let i=this.getGlProgram();(!e.static||e.dirtyId!==i.uniformDirtyGroups[e.id])&&(i.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,i,r))}syncUniforms(e,r,i){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,i)}createSyncGroups(e){let r=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=Bm(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,r){let i=this.getGlProgram();if(!e.static||e.dirtyId!==0||!i.uniformGroups[e.id]){e.dirtyId=0;let n=i.uniformGroups[e.id]||this.createSyncBufferGroup(e,i,r);e.buffer.update(),n(i.uniformData,e.uniforms,this.renderer,gh,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,i.uniformBufferBindings[r])}createSyncBufferGroup(e,r,i){let{gl:n}=this.renderer;this.renderer.buffer.bind(e.buffer);let s=this.gl.getUniformBlockIndex(r.program,i);r.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(r.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;let o=this.getSignature(e,this.shader.program.uniformData,"ubo"),a=this._uboCache[o];if(a||(a=this._uboCache[o]=jm(e,this.shader.program.uniformData)),e.autoManage){let l=new Float32Array(a.size/4);e.buffer.update(l)}return r.uniformGroups[e.id]=a.syncFunc,r.uniformGroups[e.id]}getSignature(e,r,i){let n=e.uniforms,s=[`${i}-`];for(let o in n)s.push(o),r[o]&&s.push(r[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){let r=this.gl,i=e.program,n=$m(r,i);return i.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}};q0.extension={type:me.RendererSystem,name:"shader"};_e.add(q0);var oa=class{constructor(e){this.renderer=e}run(e){let{renderer:r}=this;r.runners.init.emit(r.options),e.hello&&console.log(`PixiJS 7.2.4 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}};oa.defaultOptions={hello:!1};oa.extension={type:[me.RendererSystem,me.CanvasRendererSystem],name:"startup"};_e.add(oa);function pT(t,e=[]){return e[We.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.ADD]=[t.ONE,t.ONE],e[We.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.NONE]=[0,0],e[We.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[We.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[We.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[We.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[We.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[We.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[We.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[We.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[We.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[We.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[We.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}var YO=0,QO=1,KO=2,ZO=3,JO=4,eL=5,Vm=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=We.NONE,this._blendEq=!1,this.map=[],this.map[YO]=this.setBlend,this.map[QO]=this.setOffset,this.map[KO]=this.setCullFace,this.map[ZO]=this.setDepthTest,this.map[JO]=this.setFrontFace,this.map[eL]=this.setDepthMask,this.checks=[],this.defaultState=new hi,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=pT(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,r=0;for(;e;)e&1&&this.map[r].call(this,!!(t.data&1<<r)),e=e>>1,r++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(Vm.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(Vm.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;let e=this.blendModes[t],r=this.gl;e.length===2?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){let r=this.checks.indexOf(t);e&&r===-1?this.checks.push(t):!e&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}},yh=Vm;yh.extension={type:me.RendererSystem,name:"state"};_e.add(yh);var Y0=class extends xr.default{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);let r=(e.priority??[]).filter(n=>e.systems[n]),i=[...r,...Object.keys(e.systems).filter(n=>!r.includes(n))];for(let n of i)this.addSystem(e.systems[n],n)}addRunners(...e){e.forEach(r=>{this.runners[r]=new Kr(r)})}addSystem(e,r){let i=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=i,this._systemsHash[r]=i;for(let n in this.runners)this.runners[n].add(i);return this}emitWithCustomOptions(e,r){let i=Object.keys(this._systemsHash);e.items.forEach(n=>{let s=i.find(o=>this._systemsHash[o]===n);n[e.name](r[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}};var vh=class{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=vh.defaultMaxIdle,this.checkCountMax=vh.defaultCheckCountMax,this.mode=vh.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==sd.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let t=this.renderer.texture,e=t.managedTextures,r=!1;for(let i=0;i<e.length;i++){let n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){let i=0;for(let n=0;n<e.length;n++)e[n]!==null&&(e[i++]=e[n]);e.length=i}}unload(t){let e=this.renderer.texture,r=t._texture;r&&!r.framebuffer&&e.destroyTexture(r);for(let i=t.children.length-1;i>=0;i--)this.unload(t.children[i])}destroy(){this.renderer=null}},An=vh;An.defaultMode=sd.AUTO;An.defaultMaxIdle=60*60;An.defaultCheckCountMax=60*10;An.extension={type:me.RendererSystem,name:"textureGC"};_e.add(An);var g1=class{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=Ge.UNSIGNED_BYTE,this.internalFormat=Ce.RGBA,this.samplerType=0}};function mT(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[Ge.UNSIGNED_BYTE]:{[Ce.RGBA]:t.RGBA8,[Ce.RGB]:t.RGB8,[Ce.RG]:t.RG8,[Ce.RED]:t.R8,[Ce.RGBA_INTEGER]:t.RGBA8UI,[Ce.RGB_INTEGER]:t.RGB8UI,[Ce.RG_INTEGER]:t.RG8UI,[Ce.RED_INTEGER]:t.R8UI,[Ce.ALPHA]:t.ALPHA,[Ce.LUMINANCE]:t.LUMINANCE,[Ce.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[Ge.BYTE]:{[Ce.RGBA]:t.RGBA8_SNORM,[Ce.RGB]:t.RGB8_SNORM,[Ce.RG]:t.RG8_SNORM,[Ce.RED]:t.R8_SNORM,[Ce.RGBA_INTEGER]:t.RGBA8I,[Ce.RGB_INTEGER]:t.RGB8I,[Ce.RG_INTEGER]:t.RG8I,[Ce.RED_INTEGER]:t.R8I},[Ge.UNSIGNED_SHORT]:{[Ce.RGBA_INTEGER]:t.RGBA16UI,[Ce.RGB_INTEGER]:t.RGB16UI,[Ce.RG_INTEGER]:t.RG16UI,[Ce.RED_INTEGER]:t.R16UI,[Ce.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[Ge.SHORT]:{[Ce.RGBA_INTEGER]:t.RGBA16I,[Ce.RGB_INTEGER]:t.RGB16I,[Ce.RG_INTEGER]:t.RG16I,[Ce.RED_INTEGER]:t.R16I},[Ge.UNSIGNED_INT]:{[Ce.RGBA_INTEGER]:t.RGBA32UI,[Ce.RGB_INTEGER]:t.RGB32UI,[Ce.RG_INTEGER]:t.RG32UI,[Ce.RED_INTEGER]:t.R32UI,[Ce.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[Ge.INT]:{[Ce.RGBA_INTEGER]:t.RGBA32I,[Ce.RGB_INTEGER]:t.RGB32I,[Ce.RG_INTEGER]:t.RG32I,[Ce.RED_INTEGER]:t.R32I},[Ge.FLOAT]:{[Ce.RGBA]:t.RGBA32F,[Ce.RGB]:t.RGB32F,[Ce.RG]:t.RG32F,[Ce.RED]:t.R32F,[Ce.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[Ge.HALF_FLOAT]:{[Ce.RGBA]:t.RGBA16F,[Ce.RGB]:t.RGB16F,[Ce.RG]:t.RG16F,[Ce.RED]:t.R16F},[Ge.UNSIGNED_SHORT_5_6_5]:{[Ce.RGB]:t.RGB565},[Ge.UNSIGNED_SHORT_4_4_4_4]:{[Ce.RGBA]:t.RGBA4},[Ge.UNSIGNED_SHORT_5_5_5_1]:{[Ce.RGBA]:t.RGB5_A1},[Ge.UNSIGNED_INT_2_10_10_10_REV]:{[Ce.RGBA]:t.RGB10_A2,[Ce.RGBA_INTEGER]:t.RGB10_A2UI},[Ge.UNSIGNED_INT_10F_11F_11F_REV]:{[Ce.RGB]:t.R11F_G11F_B10F},[Ge.UNSIGNED_INT_5_9_9_9_REV]:{[Ce.RGB]:t.RGB9_E5},[Ge.UNSIGNED_INT_24_8]:{[Ce.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[Ge.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[Ce.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[Ge.UNSIGNED_BYTE]:{[Ce.RGBA]:t.RGBA,[Ce.RGB]:t.RGB,[Ce.ALPHA]:t.ALPHA,[Ce.LUMINANCE]:t.LUMINANCE,[Ce.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[Ge.UNSIGNED_SHORT_5_6_5]:{[Ce.RGB]:t.RGB},[Ge.UNSIGNED_SHORT_4_4_4_4]:{[Ce.RGBA]:t.RGBA},[Ge.UNSIGNED_SHORT_5_5_5_1]:{[Ce.RGBA]:t.RGBA}},e}var Q0=class{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Le,this.hasIntegerTextures=!1}contextChange(){let e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=mT(e);let r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let n=0;n<r;n++)this.boundTextures[n]=null;this.emptyTextures={};let i=new g1(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new g1(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let n=0;n<6;n++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let n=0;n<this.boundTextures.length;n++)this.bind(null,n)}bind(e,r=0){let{gl:i}=this;if(e=e?.castToBaseTexture(),e?.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;let n=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(e.target,n.texture)),n.dirtyId!==e.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),this.updateTexture(e)):n.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[r]=e}else this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){let{gl:r,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(let n=0;n<i.length;n++)i[n]===e&&(this.currentLocation!==n&&(r.activeTexture(r.TEXTURE0+n),this.currentLocation=n),r.bindTexture(e.target,this.emptyTextures[e.target].texture),i[n]=null)}ensureSamplerType(e){let{boundTextures:r,hasIntegerTextures:i,CONTEXT_UID:n}=this;if(i)for(let s=e-1;s>=0;--s){let o=r[s];o&&o._glTextures[n].samplerType!==nd.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){let r=new g1(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r}initTextureType(e,r){r.internalFormat=this.internalFormats[e.type]?.[e.format]??e.format,this.webGLVersion===2&&e.type===Ge.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=e.type}updateTexture(e){let r=e._glTextures[this.CONTEXT_UID];if(!r)return;let i=this.renderer;if(this.initTextureType(e,r),e.resource?.upload(i,e,r))r.samplerType!==nd.FLOAT&&(this.hasIntegerTextures=!0);else{let n=e.realWidth,s=e.realHeight,o=i.gl;(r.width!==n||r.height!==s||r.dirtyId<0)&&(r.width=n,r.height=s,o.texImage2D(e.target,0,r.internalFormat,n,s,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}destroyTexture(e,r){let{gl:i}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),i.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){let n=this.managedTextures.indexOf(e);n!==-1&&ad(this.managedTextures,n,1)}}updateTextureStyle(e){let r=e._glTextures[this.CONTEXT_UID];r&&((e.mipmap===oi.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?r.mipmap=!1:r.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?r.wrapMode=bn.CLAMP:r.wrapMode=e.wrapMode,e.resource?.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)}setStyle(e,r){let i=this.gl;if(r.mipmap&&e.mipmap!==oi.ON_MANUAL&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,r.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===ki.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);let n=this.renderer.context.extensions.anisotropicFiltering;if(n&&e.anisotropicLevel>0&&e.scaleMode===ki.LINEAR){let s=Math.min(e.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===ki.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===ki.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}};Q0.extension={type:me.RendererSystem,name:"texture"};_e.add(Q0);var K0=class{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){let{gl:r,CONTEXT_UID:i}=this,n=e._glTransformFeedbacks[i]||this.createGLTransformFeedback(e);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n)}unbind(){let{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,r){let{gl:i,renderer:n}=this;r&&n.shader.bind(r),i.beginTransformFeedback(e)}endTransformFeedback(){let{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){let{gl:r,renderer:i,CONTEXT_UID:n}=this,s=r.createTransformFeedback();e._glTransformFeedbacks[n]=s,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){let a=e.buffers[o];a&&(i.buffer.update(a),a._glBuffers[n].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[n].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,r){let i=e._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this);let s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){let a=e.buffers[o];if(!a)continue;let l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!r&&s.dispose(a,r))}i&&(r||n.deleteTransformFeedback(i),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}};K0.extension={type:me.RendererSystem,name:"transformFeedback"};_e.add(K0);var aa=class{constructor(e){this.renderer=e}init(e){this.screen=new Re(0,0,e.width,e.height),this.element=e.view||ue.ADAPTER.createCanvas(),this.resolution=e.resolution||ue.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,r){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(r*this.resolution);let i=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",i,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){e&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}};aa.defaultOptions={width:800,height:600,resolution:ue.RESOLUTION,autoDensity:!1};aa.extension={type:[me.RendererSystem,me.CanvasRendererSystem],name:"_view"};_e.add(aa);ue.PREFER_ENV=en.WEBGL2;ue.STRICT_TEXTURE_CACHE=!1;ue.RENDER_OPTIONS={...sa.defaultOptions,...na.defaultOptions,...aa.defaultOptions,...oa.defaultOptions};Object.defineProperties(ue,{WRAP_MODE:{get(){return Le.defaultOptions.wrapMode},set(t){ht("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Le.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return Le.defaultOptions.scaleMode},set(t){ht("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Le.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return Le.defaultOptions.mipmap},set(t){ht("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Le.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return Le.defaultOptions.anisotropicLevel},set(t){ht("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Le.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return ht("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),ke.defaultResolution},set(t){ke.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return ht("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),ke.defaultMultisample},set(t){ke.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return jn.defaultMaxTextures},set(t){ht("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),jn.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return jn.defaultBatchSize},set(t){ht("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),jn.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return jn.canUploadSameBuffer},set(t){ht("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),jn.canUploadSameBuffer=t}},GC_MODE:{get(){return An.defaultMode},set(t){ht("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),An.defaultMode=t}},GC_MAX_IDLE:{get(){return An.defaultMaxIdle},set(t){ht("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),An.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return An.defaultCheckCountMax},set(t){ht("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),An.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return Si.defaultVertexPrecision},set(t){ht("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Si.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return Si.defaultFragmentPrecision},set(t){ht("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Si.defaultFragmentPrecision=t}}});var Vn=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Vn||{});var Z0=class{constructor(e,r=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=r,this.priority=i,this.once=n}match(e,r=null){return this.fn===e&&this.context===r}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));let r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let r=this.next;return this.next=e?null:r,this.previous=null,r}};var Xn=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Z0(null,null,1/0),this.deltaMS=1/Xn.targetFPMS,this.elapsedMS=1/Xn.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,r=Vn.NORMAL){return this._addListener(new Z0(t,e,r))}addOnce(t,e,r=Vn.NORMAL){return this._addListener(new Z0(t,e,r,!0))}_addListener(t){let e=this._head.next,r=this._head;if(!e)t.connect(r);else{for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}return this._startIfPossible(),this}remove(t,e){let r=this._head.next;for(;r;)r.match(t,e)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){let n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Xn.targetFPMS;let r=this._head,i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){let e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,Xn.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{let e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!Xn._shared){let t=Xn._shared=new Xn;t.autoStart=!0,t._protected=!0}return Xn._shared}static get system(){if(!Xn._system){let t=Xn._system=new Xn;t.autoStart=!0,t._protected=!0}return Xn._system}},Or=Xn;Or.targetFPMS=.06;Object.defineProperties(ue,{TARGET_FPMS:{get(){return Or.targetFPMS},set(t){ht("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Or.targetFPMS=t}}});var e3=class{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,Vn.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Or.shared:new Or,e.autoStart&&this.start()}static destroy(){if(this._ticker){let e=this._ticker;this.ticker=null,e.destroy()}}};e3.extension=me.Application;_e.add(e3);var gT=[];_e.handleByList(me.Renderer,gT);function Xm(t){for(let e of gT)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}var yT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`;var vT=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var Wm=yT,t3=vT;var r3=class{constructor(e){this.renderer=e}contextChange(e){let r;if(this.renderer.context.webGLVersion===1){let i=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,i)}else{let i=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,i)}r>=ar.HIGH?this.multisample=ar.HIGH:r>=ar.MEDIUM?this.multisample=ar.MEDIUM:r>=ar.LOW?this.multisample=ar.LOW:this.multisample=ar.NONE}destroy(){}};r3.extension={type:me.RendererSystem,name:"_multisample"};_e.add(r3);var xh=class{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}};var i3=class{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){let{gl:r,CONTEXT_UID:i}=this,n=e._glBuffers[i]||this.createGLBuffer(e);r.bindBuffer(e.type,n.buffer)}unbind(e){let{gl:r}=this;r.bindBuffer(e,null)}bindBufferBase(e,r){let{gl:i,CONTEXT_UID:n}=this;if(this.boundBufferBases[r]!==e){let s=e._glBuffers[n]||this.createGLBuffer(e);this.boundBufferBases[r]=e,i.bindBufferBase(i.UNIFORM_BUFFER,r,s.buffer)}}bindBufferRange(e,r,i){let{gl:n,CONTEXT_UID:s}=this;i=i||0;let o=e._glBuffers[s]||this.createGLBuffer(e);n.bindBufferRange(n.UNIFORM_BUFFER,r||0,o.buffer,i*256,256)}update(e){let{gl:r,CONTEXT_UID:i}=this,n=e._glBuffers[i]||this.createGLBuffer(e);if(e._updateID!==n.updateID)if(n.updateID=e._updateID,r.bindBuffer(e.type,n.buffer),n.byteLength>=e.data.byteLength)r.bufferSubData(e.type,0,e.data);else{let s=e.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;n.byteLength=e.data.byteLength,r.bufferData(e.type,e.data,s)}}dispose(e,r){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];let i=e._glBuffers[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this),i&&(r||n.deleteBuffer(i.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){let r=Object.keys(this.managedBuffers);for(let i=0;i<r.length;i++)this.dispose(this.managedBuffers[r[i]],e)}createGLBuffer(e){let{CONTEXT_UID:r,gl:i}=this;return e._glBuffers[r]=new xh(i.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[r]}};i3.extension={type:me.RendererSystem,name:"buffer"};_e.add(i3);var n3=class{constructor(e){this.renderer=e}render(e,r){let i=this.renderer,n,s,o,a;if(r&&(n=r.renderTexture,s=r.clear,o=r.transform,a=r.skipUpdateTransform),this.renderingToScreen=!n,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(n||(this.lastObjectRendered=e),!a){let l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}i.renderTexture.bind(n),i.batch.currentRenderer.start(),(s??i.background.clearBeforeRender)&&i.renderTexture.clear(),e.render(i),i.batch.currentRenderer.flush(),n&&(r.blit&&i.framebuffer.blit(),n.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}};n3.extension={type:me.RendererSystem,name:"objectRenderer"};_e.add(n3);var qm=class extends Y0{constructor(t){super(),this.type=cp.WEBGL,t=Object.assign({},ue.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new pi({projectionMatrix:new gt},!0);let e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:qm.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(ht("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=qm.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t?.forceCanvas?!1:td()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return ht("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return ht("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return ht("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return ht("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){ht("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return ht("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){ht("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return ht("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}},y1=qm;y1.extension={type:me.Renderer,priority:1};y1.__plugins={};y1.__systems={};_e.handleByMap(me.RendererPlugin,y1.__plugins);_e.handleByMap(me.RendererSystem,y1.__systems);_e.add(y1);var dl=class extends an{constructor(e,r){let{width:i,height:n}=r||{};super(i,n),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){let o=new Le;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,r){for(let i=0;i<this.length;i++)e[i]&&(e[i].castToBaseTexture?this.addBaseTextureAt(e[i].castToBaseTexture(),i):e[i]instanceof an?this.addResourceAt(e[i],i):this.addResourceAt(R0(e[i],r),i))}dispose(){for(let e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)}unbind(e){super.unbind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)}load(){if(this._load)return this._load;let r=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(r).then(()=>{let{realWidth:i,realHeight:n}=this.items[0];return this.resize(i,n),Promise.resolve(this)}),this._load}};var J0=class extends dl{constructor(e,r){let{width:i,height:n}=r||{},s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:i,height:n}),s&&this.initFromArray(s,r)}addBaseTextureAt(e,r){if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Ko.TEXTURE_2D_ARRAY}upload(e,r,i){let{length:n,itemDirtyIds:s,items:o}=this,{gl:a}=e;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,n,0,r.format,i.type,null);for(let l=0;l<n;l++){let c=o[l];s[l]<c.dirtyId&&(s[l]=c.dirtyId,c.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,c.resource.width,c.resource.height,1,r.format,i.type,c.resource.source))}return!0}};var eu=class extends Ri{constructor(e){super(e)}static test(e){let{OffscreenCanvas:r}=globalThis;return r&&e instanceof r?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}};var s3=class extends dl{constructor(t,e){let{width:r,height:i,autoLoad:n,linkBaseTexture:s}=e||{};if(t&&t.length!==s3.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:r,height:i});for(let o=0;o<s3.SIDES;o++)this.items[o].target=Ko.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=s!==!1,t&&this.initFromArray(t,e),n!==!1&&this.load()}bind(t){super.bind(t),t.target=Ko.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=Ko.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,r){let i=this.itemDirtyIds;for(let n=0;n<s3.SIDES;n++){let s=this.items[n];(i[n]<s.dirtyId||r.dirtyId<e.dirtyId)&&(s.valid&&s.resource?(s.resource.upload(t,s,r),i[n]=s.dirtyId):i[n]<-1&&(t.gl.texImage2D(s.target,0,r.internalFormat,e.realWidth,e.realHeight,0,e.format,r.type,null),i[n]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===s3.SIDES}},o3=s3;o3.SIDES=6;var js=class extends Ri{constructor(e,r){r=r||{};let i,n;typeof e=="string"?(i=js.EMPTY,n=e):(i=e,n=null),super(i),this.url=n,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,r)=>{if(this.url===null){e(this);return}try{let i=await ue.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;let n=await i.blob();if(this.destroyed)return;let s=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===$r.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=s,this.update(),e(this)}catch(i){if(this.destroyed)return;r(i),this.onError.emit(i)}}),this._load)}upload(e,r,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(e,r,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return js._EMPTY=js._EMPTY??ue.ADAPTER.createCanvas(0,0),js._EMPTY}};var _h=class extends Ri{constructor(t,e){e=e||{},super(ue.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),t(this)},_h.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){let t=new Image;Ri.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;let e=t.width,r=t.height;if(!e||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=e*this.scale,n=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/r*e,n=this._overrideHeight||this._overrideWidth/e*r),i=Math.round(i),n=Math.round(n);let s=this.source;s.width=i,s.height=n,s._pixiId=`canvas_${ho()}`,s.getContext("2d").drawImage(t,0,0,e,r,0,0,i,n),this._resolve(),this._resolve=null}}static getSize(t){let e=_h.SVG_SIZE.exec(t),r={};return e&&(r[e[1]]=Math.round(parseFloat(e[3])),r[e[5]]=Math.round(parseFloat(e[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&_h.SVG_XML.test(t)}},la=_h;la.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;la.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Ym=class extends Ri{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){let r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),typeof t=="string"&&(t=[t]);let i=t[0].src||t[0];Ri.crossOrigin(r,i,e.crossorigin);for(let n=0;n<t.length;++n){let s=document.createElement("source"),{src:o,mime:a}=t[n];o=o||t[n];let l=o.split("?").shift().toLowerCase(),c=l.slice(l.lastIndexOf(".")+1);a=a||Ym.MIME_TYPES[c]||`video/${c}`,s.src=o,s.type=a,r.appendChild(s)}t=r}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){let e=Or.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;let t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise(e=>{this.valid?e(this):(this._resolve=e,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)}_isSourcePlaying(){let t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Or.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Or.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){let t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);let e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._isConnectedToTicker&&(Or.shared.remove(this.update,this),this._isConnectedToTicker=!1);let t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Or.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Or.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t)}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||Ym.TYPES.includes(e)}},tu=Ym;tu.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];tu.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};P0.push(js,ul,eu,tu,la,Tn,o3,J0);var _o=class{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?Re.EMPTY:(e=e||new Re(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,r){let{a:i,b:n,c:s,d:o,tx:a,ty:l}=e,c=i*r.x+s*r.y+a,u=n*r.x+o*r.y+l;this.minX=Math.min(this.minX,c),this.maxX=Math.max(this.maxX,c),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)}addQuad(e){let r=this.minX,i=this.minY,n=this.maxX,s=this.maxY,o=e[0],a=e[1];r=o<r?o:r,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=e[2],a=e[3],r=o<r?o:r,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=e[4],a=e[5],r=o<r?o:r,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=e[6],a=e[7],r=o<r?o:r,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,this.minX=r,this.minY=i,this.maxX=n,this.maxY=s}addFrame(e,r,i,n,s){this.addFrameMatrix(e.worldTransform,r,i,n,s)}addFrameMatrix(e,r,i,n,s){let o=e.a,a=e.b,l=e.c,c=e.d,u=e.tx,d=e.ty,h=this.minX,p=this.minY,m=this.maxX,g=this.maxY,y=o*r+l*i+u,v=a*r+c*i+d;h=y<h?y:h,p=v<p?v:p,m=y>m?y:m,g=v>g?v:g,y=o*n+l*i+u,v=a*n+c*i+d,h=y<h?y:h,p=v<p?v:p,m=y>m?y:m,g=v>g?v:g,y=o*r+l*s+u,v=a*r+c*s+d,h=y<h?y:h,p=v<p?v:p,m=y>m?y:m,g=v>g?v:g,y=o*n+l*s+u,v=a*n+c*s+d,h=y<h?y:h,p=v<p?v:p,m=y>m?y:m,g=v>g?v:g,this.minX=h,this.minY=p,this.maxX=m,this.maxY=g}addVertexData(e,r,i){let n=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let l=r;l<i;l+=2){let c=e[l],u=e[l+1];n=c<n?c:n,s=u<s?u:s,o=c>o?c:o,a=u>a?u:a}this.minX=n,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,r,i,n){this.addVerticesMatrix(e.worldTransform,r,i,n)}addVerticesMatrix(e,r,i,n,s=0,o=s){let a=e.a,l=e.b,c=e.c,u=e.d,d=e.tx,h=e.ty,p=this.minX,m=this.minY,g=this.maxX,y=this.maxY;for(let v=i;v<n;v+=2){let x=r[v],_=r[v+1],b=a*x+c*_+d,w=u*_+l*x+h;p=Math.min(p,b-s),g=Math.max(g,b+s),m=Math.min(m,w-o),y=Math.max(y,w+o)}this.minX=p,this.minY=m,this.maxX=g,this.maxY=y}addBounds(e){let r=this.minX,i=this.minY,n=this.maxX,s=this.maxY;this.minX=e.minX<r?e.minX:r,this.minY=e.minY<i?e.minY:i,this.maxX=e.maxX>n?e.maxX:n,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,r){let i=e.minX>r.minX?e.minX:r.minX,n=e.minY>r.minY?e.minY:r.minY,s=e.maxX<r.maxX?e.maxX:r.maxX,o=e.maxY<r.maxY?e.maxY:r.maxY;if(i<=s&&n<=o){let a=this.minX,l=this.minY,c=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=n<l?n:l,this.maxX=s>c?s:c,this.maxY=o>u?o:u}}addBoundsMatrix(e,r){this.addFrameMatrix(r,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,r){let i=e.minX>r.x?e.minX:r.x,n=e.minY>r.y?e.minY:r.y,s=e.maxX<r.x+r.width?e.maxX:r.x+r.width,o=e.maxY<r.y+r.height?e.maxY:r.y+r.height;if(i<=s&&n<=o){let a=this.minX,l=this.minY,c=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=n<l?n:l,this.maxX=s>c?s:c,this.maxY=o>u?o:u}}pad(e=0,r=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r)}addFramePad(e,r,i,n,s,o){e-=s,r-=o,i+=s,n+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>n?this.maxY:n}};var Vt=class extends he.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new h1,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new _o,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){let r=Object.keys(e);for(let i=0;i<r.length;++i){let n=r[i];Object.defineProperty(Vt.prototype,n,Object.getOwnPropertyDescriptor(e,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new Re),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new Re),e=this._localBoundsRect),this._localBounds||(this._localBounds=new _o);let r=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;let n=this._bounds,s=this._boundsID;this._bounds=this._localBounds;let o=this.getBounds(!1,e);return this.parent=i,this.transform=r,this._bounds=n,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,r,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)}toLocal(e,r,i,n){return r&&(e=r.toGlobal(e,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,i)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){this.parent?.removeChild(this)}setTransform(e=0,r=0,i=1,n=1,s=0,o=0,a=0,l=0,c=0){return this.position.x=e,this.position.y=r,this.scale.x=i||1,this.scale.y=n||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=c,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new bh),this.tempDisplayObjectParent}enableTempParent(){let e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*Fm}set angle(e){this.transform.rotation=e*zs}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){let r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=e,this._mask){let r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}},bh=class extends Vt{constructor(){super(...arguments),this.sortDirty=null}};Vt.prototype.displayObjectUpdateTransform=Vt.prototype.updateTransform;var tL=new gt;function rL(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}var Qm=class extends Vt{constructor(){super(),this.children=[],this.sortableChildren=Qm.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{let e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;let r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}getChildIndex(t){let e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);let r=this.getChildIndex(t);he.removeItems(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{let e=t[0],r=this.children.indexOf(e);if(r===-1)return null;e.parent=null,e.transform._parentID=-1,he.removeItems(this.children,r,1),this._boundsID++,this.onChildrenChange(r),e.emit("removed",this),this.emit("childRemoved",e,this,r)}return t[0]}removeChildAt(t){let e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,he.removeItems(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){let r=t,i=e,n=i-r,s;if(n>0&&n<=i){s=this.children.splice(r,n);for(let o=0;o<s.length;++o)s[o].parent=null,s[o].transform&&(s[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let o=0;o<s.length;++o)s[o].emit("removed",this),this.emit("childRemoved",s[o],this,o);return s}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,r=this.children.length;e<r;++e){let i=this.children[e];i._lastSortedIndex=e,!t&&i.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(rL),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){let r=this.children[t];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){let e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){let r=e._mask.isMaskData?e._mask.maskObject:e._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){let r=super.getLocalBounds(t);if(!e)for(let i=0,n=this.children.length;i<n;++i){let s=this.children[i];s.visible&&s.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(t){let e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==Qm.prototype._render&&(r=this.getBounds(!0));let n=t.projection.transform;if(n&&(i?(i=tL.copyFrom(i),i.prepend(n)):i=n),r&&e.intersects(r,i))this._render(t);else if(this.cullArea)return;for(let s=0,o=this.children.length;s<o;++s){let a=this.children[s],l=a.cullable;a.cullable=l||!this.cullArea,a.render(t),a.cullable=l}}render(t){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters?.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}}renderAdvanced(t){let e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let n=0;n<e.length;n++)e[n].enabled&&this._enabledFilters.push(e[n])}let i=e&&this._enabledFilters?.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==jr.NONE));if(i&&t.batch.flush(),e&&this._enabledFilters?.length&&t.filter.push(this,this._enabledFilters),r&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let n=0,s=this.children.length;n<s;++n)this.children[n].render(t)}i&&t.batch.flush(),r&&t.mask.pop(this),e&&this._enabledFilters?.length&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;let e=typeof t=="boolean"?t:t?.children,r=this.removeChildren(0,this.children.length);if(e)for(let i=0;i<r.length;++i)r[i].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){let e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){let e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}},st=Qm;st.defaultSortableChildren=!1;st.prototype.containerUpdateTransform=st.prototype.updateTransform;Object.defineProperties(ue,{SORTABLE_CHILDREN:{get(){return st.defaultSortableChildren},set(t){he.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),st.defaultSortableChildren=t}}});var a3=new Ne,iL=new Uint16Array([0,1,2,0,2,3]),ir=class extends st{constructor(e){super(),this._anchor=new Pi(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new bt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=We.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||be.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=iL,this.pluginName="batch",this.isSprite=!0,this._roundPixels=ue.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=he.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=he.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){let e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;let r=this.transform.worldTransform,i=r.a,n=r.b,s=r.c,o=r.d,a=r.tx,l=r.ty,c=this.vertexData,u=e.trim,d=e.orig,h=this._anchor,p=0,m=0,g=0,y=0;if(u?(m=u.x-h._x*d.width,p=m+u.width,y=u.y-h._y*d.height,g=y+u.height):(m=-h._x*d.width,p=m+d.width,y=-h._y*d.height,g=y+d.height),c[0]=i*m+s*y+a,c[1]=o*y+n*m+l,c[2]=i*p+s*y+a,c[3]=o*y+n*p+l,c[4]=i*p+s*g+a,c[5]=o*g+n*p+l,c[6]=i*m+s*g+a,c[7]=o*g+n*m+l,this._roundPixels){let v=ue.RESOLUTION;for(let x=0;x<c.length;++x)c[x]=Math.round(c[x]*v)/v}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;let e=this._texture,r=this.vertexTrimmedData,i=e.orig,n=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,c=s.d,u=s.tx,d=s.ty,h=-n._x*i.width,p=h+i.width,m=-n._y*i.height,g=m+i.height;r[0]=o*h+l*m+u,r[1]=c*m+a*h+d,r[2]=o*p+l*m+u,r[3]=c*m+a*p+d,r[4]=o*p+l*g+u,r[5]=c*g+a*p+d,r[6]=o*h+l*g+u,r[7]=c*g+a*h+d}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){let e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new _o),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Re),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,a3);let r=this._texture.orig.width,i=this._texture.orig.height,n=-r*this.anchor.x,s=0;return a3.x>=n&&a3.x<n+r&&(s=-i*this.anchor.y,a3.y>=s&&a3.y<s+i)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e?.texture){let i=typeof e=="boolean"?e:e?.baseTexture;this._texture.destroy(!!i)}this._texture=null}static from(e,r){let i=e instanceof be?e:be.from(e,r);return new ir(i)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){let r=he.sign(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){let r=he.sign(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||be.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}};var xT=new gt;Vt.prototype._cacheAsBitmap=!1;Vt.prototype._cacheData=null;Vt.prototype._cacheAsBitmapResolution=null;Vt.prototype._cacheAsBitmapMultisample=null;var Km=class{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}};Object.defineProperties(Vt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;let e;t?(this._cacheData||(this._cacheData=new Km),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});Vt.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))};Vt.prototype._initCachedDisplayObject=function(e){if(this._cacheData?.sprite)return;let r=this.alpha;this.alpha=1,e.batch.flush();let i=this.getLocalBounds(null,!0).clone();if(this.filters?.length){let h=this.filters[0].padding;i.pad(h)}i.ceil(ue.RESOLUTION);let n=e.renderTexture.current,s=e.renderTexture.sourceFrame.clone(),o=e.renderTexture.destinationFrame.clone(),a=e.projection.transform,l=ln.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||e.resolution,multisample:this.cacheAsBitmapMultisample??e.multisample}),c=`cacheAsBitmap_${he.uid()}`;this._cacheData.textureCacheId=c,Le.addToCache(l.baseTexture,c),be.addToCache(l,c);let u=this.transform.localTransform.copyTo(xT).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:l,clear:!0,transform:u,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=a,e.renderTexture.bind(n,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;let d=new ir(l);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(i.x/i.width),d.anchor.y=-(i.y/i.height),d.alpha=r,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)};Vt.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))};Vt.prototype._initCachedDisplayObjectCanvas=function(e){if(this._cacheData?.sprite)return;let r=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;let n=e.canvasContext.activeContext,s=e._projTransform;r.ceil(ue.RESOLUTION);let o=ln.create({width:r.width,height:r.height}),a=`cacheAsBitmap_${he.uid()}`;this._cacheData.textureCacheId=a,Le.addToCache(o.baseTexture,a),be.addToCache(o,a);let l=xT;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=r.x,l.ty-=r.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),e.canvasContext.activeContext=n,e._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;let c=new ir(o);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(r.x/r.width),c.anchor.y=-(r.y/r.height),c.alpha=i,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=c.containsPoint.bind(c)};Vt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Vt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Vt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Le.removeFromCache(this._cacheData.textureCacheId),be.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Vt.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)};Vt.prototype.name=null;st.prototype.getChildByName=function(e,r){for(let i=0,n=this.children.length;i<n;i++)if(this.children[i].name===e)return this.children[i];if(r)for(let i=0,n=this.children.length;i<n;i++){let s=this.children[i];if(!s.getChildByName)continue;let o=s.getChildByName(e,!0);if(o)return o}return null};Vt.prototype.getGlobalPosition=function(e=new Ne,r=!1){return this.parent?this.parent.toGlobal(this.position,e,r):(e.x=this.position.x,e.y=this.position.y),e};var _T=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;var ru=class extends ke{constructor(e=1){super(Wm,_T,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}};var nL={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},sL=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function bT(t){let e=nL[t],r=e.length,i=sL,n="",s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",o;for(let a=0;a<t;a++){let l=s.replace("%index%",a.toString());o=a,a>=r&&(o=t-a-1),l=l.replace("%value%",e[o].toString()),n+=l,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",t.toString()),i}var oL=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function wT(t,e){let r=Math.ceil(t/2),i=oL,n="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<t;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(r-1)}.0`),n+=a,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",t.toString()),i}var ca=class extends ke{constructor(e,r=8,i=4,n=ke.defaultResolution,s=5){let o=wT(s,e),a=bT(s);super(o,a),this.horizontal=e,this.resolution=n,this._quality=0,this.quality=i,this.blur=r}apply(e,r,i,n){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/r.width):this.uniforms.strength=1/i.height*(i.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,i,n);else{let s=e.getFilterTexture(),o=e.renderer,a=r,l=s;this.state.blend=!1,e.applyFilter(this,a,l,Un.CLEAR);for(let c=1;c<this.passes-1;c++){e.bindAndClear(a,Un.BLIT),this.uniforms.uSampler=l;let u=l;l=a,a=u,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,i,n),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}};var l3=class extends ke{constructor(e=8,r=4,i=ke.defaultResolution,n=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new ca(!0,e,r,i,n),this.blurYFilter=new ca(!1,e,r,i,n),this.resolution=i,this.quality=r,this.blur=e,this.repeatEdgePixels=!1}apply(e,r,i,n){let s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){let a=e.getFilterTexture();this.blurXFilter.apply(e,r,a,Un.CLEAR),this.blurYFilter.apply(e,a,i,n),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,r,i,n):this.blurXFilter.apply(e,r,i,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}};var ET=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;var v1=class extends ke{constructor(){let e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(t3,ET,e),this.alpha=1}_loadMatrix(e,r=!1){let i=e;r&&(this._multiply(i,this.uniforms.m,e),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(e,r,i){return e[0]=r[0]*i[0]+r[1]*i[5]+r[2]*i[10]+r[3]*i[15],e[1]=r[0]*i[1]+r[1]*i[6]+r[2]*i[11]+r[3]*i[16],e[2]=r[0]*i[2]+r[1]*i[7]+r[2]*i[12]+r[3]*i[17],e[3]=r[0]*i[3]+r[1]*i[8]+r[2]*i[13]+r[3]*i[18],e[4]=r[0]*i[4]+r[1]*i[9]+r[2]*i[14]+r[3]*i[19]+r[4],e[5]=r[5]*i[0]+r[6]*i[5]+r[7]*i[10]+r[8]*i[15],e[6]=r[5]*i[1]+r[6]*i[6]+r[7]*i[11]+r[8]*i[16],e[7]=r[5]*i[2]+r[6]*i[7]+r[7]*i[12]+r[8]*i[17],e[8]=r[5]*i[3]+r[6]*i[8]+r[7]*i[13]+r[8]*i[18],e[9]=r[5]*i[4]+r[6]*i[9]+r[7]*i[14]+r[8]*i[19]+r[9],e[10]=r[10]*i[0]+r[11]*i[5]+r[12]*i[10]+r[13]*i[15],e[11]=r[10]*i[1]+r[11]*i[6]+r[12]*i[11]+r[13]*i[16],e[12]=r[10]*i[2]+r[11]*i[7]+r[12]*i[12]+r[13]*i[17],e[13]=r[10]*i[3]+r[11]*i[8]+r[12]*i[13]+r[13]*i[18],e[14]=r[10]*i[4]+r[11]*i[9]+r[12]*i[14]+r[13]*i[19]+r[14],e[15]=r[15]*i[0]+r[16]*i[5]+r[17]*i[10]+r[18]*i[15],e[16]=r[15]*i[1]+r[16]*i[6]+r[17]*i[11]+r[18]*i[16],e[17]=r[15]*i[2]+r[16]*i[7]+r[17]*i[12]+r[18]*i[17],e[18]=r[15]*i[3]+r[16]*i[8]+r[17]*i[13]+r[18]*i[18],e[19]=r[15]*i[4]+r[16]*i[9]+r[17]*i[14]+r[18]*i[19]+r[19],e}_colorMatrix(e){let r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(e,r){let i=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(i,r)}tint(e,r){let[i,n,s]=bt.shared.setValue(e).toArray(),o=[i,0,0,0,0,0,n,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,r)}greyscale(e,r){let i=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(i,r)}blackAndWhite(e){let r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,e)}hue(e,r){e=(e||0)/180*Math.PI;let i=Math.cos(e),n=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),l=i+(1-i)*o,c=o*(1-i)-a*n,u=o*(1-i)+a*n,d=o*(1-i)+a*n,h=i+o*(1-i),p=o*(1-i)-a*n,m=o*(1-i)-a*n,g=o*(1-i)+a*n,y=i+o*(1-i),v=[l,c,u,0,0,d,h,p,0,0,m,g,y,0,0,0,0,0,1,0];this._loadMatrix(v,r)}contrast(e,r){let i=(e||0)+1,n=-.5*(i-1),s=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(s,r)}saturate(e=0,r){let i=e*2/3+1,n=(i-1)*-.5,s=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(s,r)}desaturate(){this.saturate(-1)}negative(e){let r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,e)}sepia(e){let r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,e)}technicolor(e){let r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,e)}polaroid(e){let r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,e)}toBGR(e){let r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,e)}kodachrome(e){let r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,e)}browni(e){let r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,e)}vintage(e){let r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,e)}colorTone(e,r,i,n,s){e=e||.2,r=r||.15,i=i||16770432,n=n||3375104;let o=bt.shared,[a,l,c]=o.setValue(i).toArray(),[u,d,h]=o.setValue(n).toArray(),p=[.3,.59,.11,0,0,a,l,c,e,0,u,d,h,r,0,a-u,l-d,c-h,0,0];this._loadMatrix(p,s)}night(e,r){e=e||.1;let i=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(i,r)}predator(e,r){let i=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(i,r)}lsd(e){let r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,e)}reset(){let e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}};v1.prototype.grayscale=v1.prototype.greyscale;var ST=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`;var TT=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;var c3=class extends ke{constructor(e,r){let i=new gt;e.renderable=!1,super(TT,ST,{mapSampler:e._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=i,r==null&&(r=20),this.scale=new Ne(r,r)}apply(e,r,i,n){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;let s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,r,i,n)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}};var AT=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`;var CT=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;var u3=class extends ke{constructor(){super(CT,AT)}};var kT=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;var f3=class extends ke{constructor(e=.5,r=Math.random()){super(t3,kT,{uNoise:0,uSeed:0}),this.noise=e,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}};var d3={AlphaFilter:ru,BlurFilter:l3,BlurFilterPass:ca,ColorMatrixFilter:v1,DisplacementFilter:c3,FXAAFilter:u3,NoiseFilter:f3};Object.entries(d3).forEach(([t,e])=>{Object.defineProperty(d3,t,{get(){return he.deprecation("7.1.0",`filters.${t} has moved to ${t}`),e}})});var Zm=class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(Or.system.add(this.tickerUpdate,this,Vn.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Or.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}let e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}},bo=new Zm;var Vs=class{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Vs.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Ne,this.page=new Ne,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,r,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,r,i,n,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}};var wo=class extends Vs{constructor(){super(...arguments),this.client=new Ne,this.movement=new Ne,this.offset=new Ne,this.global=new Ne,this.screen=new Ne}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,r,i){return e.worldTransform.applyInverse(i||this.global,r)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,r,i,n,s,o,a,l,c,u,d,h,p,m,g){throw new Error("Method not implemented.")}};var Gi=class extends wo{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}};var Xs=class extends wo{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}};Xs.DOM_DELTA_PIXEL=0;Xs.DOM_DELTA_LINE=1;Xs.DOM_DELTA_PAGE=2;var aL=2048,lL=new Ne,Jm=new Ne,h3=class{constructor(e){this.dispatch=new he.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,r){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:r,priority:0}),this.mappingTable[e].sort((i,n)=>i.priority-n.priority)}dispatchEvent(e,r){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,r),this.dispatch.emit(r||e.type,e)}mapEvent(e){if(!this.rootTarget)return;let r=this.mappingTable[e.type];if(r)for(let i=0,n=r.length;i<n;i++)r[i].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,r){bo.pauseUpdate=!0;let n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",s=this[n](this.rootTarget,this.rootTarget.eventMode,lL.set(e,r),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(e,r){if(!e.target)return;let i=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let n=0,s=i.length-1;n<s;n++)if(e.currentTarget=i[n],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,r),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let n=i.length-2;n>=0;n--)if(e.currentTarget=i[n],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,r,i=this._allInteractiveElements){if(i.length===0)return;e.eventPhase=e.BUBBLING_PHASE;let n=Array.isArray(r)?r:[r];for(let s=i.length-1;s>=0;s--)n.forEach(o=>{e.currentTarget=i[s],this.notifyTarget(e,o)})}propagationPath(e){let r=[e];for(let i=0;i<aL&&e!==this.rootTarget;i++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(e.parent),e=e.parent}return r.reverse(),r}hitTestMoveRecursive(e,r,i,n,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(bo.pauseUpdate=!1),e.interactiveChildren&&e.children){let u=e.children;for(let d=u.length-1;d>=0;d--){let h=u[d],p=this.hitTestMoveRecursive(h,this._isInteractive(r)?r:h.eventMode,i,n,s,o||s(e,i));if(p){if(p.length>0&&!p[p.length-1].parent)continue;let m=e.isInteractive();(p.length>0||m)&&(m&&this._allInteractiveElements.push(e),p.push(e)),this._hitElements.length===0&&(this._hitElements=p),a=!0}}}let l=this._isInteractive(r),c=e.isInteractive();return c&&c&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,i)&&n(e,i)?c?[e]:[]:null}hitTestRecursive(e,r,i,n,s){if(this._interactivePrune(e)||s(e,i))return null;if((e.eventMode==="dynamic"||r==="dynamic")&&(bo.pauseUpdate=!1),e.interactiveChildren&&e.children){let l=e.children;for(let c=l.length-1;c>=0;c--){let u=l[c],d=this.hitTestRecursive(u,this._isInteractive(r)?r:u.eventMode,i,n,s);if(d){if(d.length>0&&!d[d.length-1].parent)continue;let h=e.isInteractive();return(d.length>0||h)&&d.push(e),d}}}let o=this._isInteractive(r),a=e.isInteractive();return o&&n(e,i)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,r){if(e.hitArea&&(e.worldTransform.applyInverse(r,Jm),!e.hitArea.contains(Jm.x,Jm.y)))return!0;if(e._mask){let i=e._mask.isMaskData?e._mask.maskObject:e._mask;if(i&&!i.containsPoint?.(r))return!0}return!1}hitTestFn(e,r){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(r):!1}notifyTarget(e,r){r=r??e.type;let i=`on${r}`;e.currentTarget[i]?.(e);let n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${r}capture`:r;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,r)}mapPointerDown(e){if(!(e instanceof Gi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){let n=r.button===2;this.dispatchEvent(r,n?"rightdown":"mousedown")}let i=this.trackingData(e.pointerId);i.pressTargetsByButton[e.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(e){if(!(e instanceof Gi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;let r=this.createPointerEvent(e);this._isPointerMoveEvent=!1;let i=r.pointerType==="mouse"||r.pointerType==="pen",n=this.trackingData(e.pointerId),s=this.findMountedTarget(n.overTargets);if(n.overTargets?.length>0&&s!==r.target){let l=e.type==="mousemove"?"mouseout":"pointerout",c=this.createPointerEvent(e,l,s);if(this.dispatchEvent(c,"pointerout"),i&&this.dispatchEvent(c,"mouseout"),!r.composedPath().includes(s)){let u=this.createPointerEvent(e,"pointerleave",s);for(u.eventPhase=u.AT_TARGET;u.target&&!r.composedPath().includes(u.target);)u.currentTarget=u.target,this.notifyTarget(u),i&&this.notifyTarget(u,"mouseleave"),u.target=u.target.parent;this.freeEvent(u)}this.freeEvent(c)}if(s!==r.target){let l=e.type==="mousemove"?"mouseover":"pointerover",c=this.clonePointerEvent(r,l);this.dispatchEvent(c,"pointerover"),i&&this.dispatchEvent(c,"mouseover");let u=s?.parent;for(;u&&u!==this.rootTarget.parent&&u!==r.target;)u=u.parent;if(!u||u===this.rootTarget.parent){let h=this.clonePointerEvent(r,"pointerenter");for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==s&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),i&&this.notifyTarget(h,"mouseenter"),h.target=h.target.parent;this.freeEvent(h)}this.freeEvent(c)}let o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(r,"pointermove"),a&&o.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),a&&o.push("globaltouchmove")),i&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),a&&o.push("globalmousemove"),this.cursor=r.target?.cursor),o.length>0&&this.all(r,o),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(e){if(!(e instanceof Gi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(e.pointerId),i=this.createPointerEvent(e),n=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),n&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=i.target?.cursor);let s=this.clonePointerEvent(i,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;r.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof Gi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(e.pointerId);if(r.overTargets){let i=e.pointerType==="mouse"||e.pointerType==="pen",n=this.findMountedTarget(r.overTargets),s=this.createPointerEvent(e,"pointerout",n);this.dispatchEvent(s),i&&this.dispatchEvent(s,"mouseout");let o=this.createPointerEvent(e,"pointerleave",n);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;r.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof Gi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=performance.now(),i=this.createPointerEvent(e);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}let n=this.trackingData(e.pointerId),s=this.findMountedTarget(n.pressTargetsByButton[e.button]),o=s;if(s&&!i.composedPath().includes(s)){let a=s;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let l=i.button===2;this.notifyTarget(i,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete n.pressTargetsByButton[e.button],o=a}if(o){let a=this.clonePointerEvent(i,"click");a.target=o,a.path=null,n.clicksByButton[e.button]||(n.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:r});let l=n.clicksByButton[e.button];if(l.target===a.target&&r-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=r,a.detail=l.clickCount,a.pointerType==="mouse"){let c=a.button===2;this.dispatchEvent(a,c?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(e){if(!(e instanceof Gi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(e.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[e.button]),n=this.createPointerEvent(e);if(i){let s=i;for(;s;)n.currentTarget=s,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch"?this.notifyTarget(n,"touchendoutside"):(n.pointerType==="mouse"||n.pointerType==="pen")&&this.notifyTarget(n,n.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete r.pressTargetsByButton[e.button]}this.freeEvent(n)}mapWheel(e){if(!(e instanceof Xs)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}let r=this.createWheelEvent(e);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(e){if(!e)return null;let r=e[0];for(let i=1;i<e.length&&e[i].parent===r;i++)r=e[i];return r}createPointerEvent(e,r,i){let n=this.allocateEvent(Gi);return this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,n.target=i??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],typeof r=="string"&&(n.type=r),n}createWheelEvent(e){let r=this.allocateEvent(Xs);return this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(e,r){let i=this.allocateEvent(Gi);return i.nativeEvent=e.nativeEvent,i.originalEvent=e.originalEvent,this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.target=e.target,i.path=e.composedPath().slice(),i.type=r??i.type,i}copyWheelData(e,r){r.deltaMode=e.deltaMode,r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ}copyPointerData(e,r){e instanceof Gi&&r instanceof Gi&&(r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist)}copyMouseData(e,r){e instanceof wo&&r instanceof wo&&(r.altKey=e.altKey,r.button=e.button,r.buttons=e.buttons,r.client.copyFrom(e.client),r.ctrlKey=e.ctrlKey,r.metaKey=e.metaKey,r.movement.copyFrom(e.movement),r.screen.copyFrom(e.screen),r.shiftKey=e.shiftKey,r.global.copyFrom(e.global))}copyData(e,r){r.isTrusted=e.isTrusted,r.srcElement=e.srcElement,r.timeStamp=performance.now(),r.type=e.type,r.detail=e.detail,r.view=e.view,r.which=e.which,r.layer.copyFrom(e.layer),r.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);let r=this.eventPool.get(e).pop()||new e(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");let r=e.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(e)}notifyListeners(e,r){let i=e.currentTarget._events[r];if(i&&e.currentTarget.isInteractive())if("fn"in i)i.once&&e.currentTarget.removeListener(r,i.fn,void 0,!0),i.fn.call(i.context,e);else for(let n=0,s=i.length;n<s&&!e.propagationImmediatelyStopped;n++)i[n].once&&e.currentTarget.removeListener(r,i[n].fn,void 0,!0),i[n].fn.call(i[n].context,e)}};var cL=1,uL={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},eg=class{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new h3(null),bo.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Gi(null),this.rootWheelEvent=new Xs(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...eg.defaultEventFeatures},{set:(e,r,i)=>(r==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),e[r]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){let{view:e,resolution:r}=this.renderer;this.setTargetElement(e),this.resolution=r,eg._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;let r=this.cursorStyles[t];if(r)switch(typeof r){case"string":e&&(this.domElement.style.cursor=r);break;case"function":r(t);break;case"object":e&&Object.assign(this.domElement.style,r);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch"))return;let e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let r=0,i=e.length;r<i;r++){let n=e[r],s=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch"))return;bo.pointerMoved();let e=this.normalizeToPointerData(t);for(let r=0,i=e.length;r<i;r++){let n=this.bootstrapEvent(this.rootPointerEvent,e[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch"))return;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);let r=e!==this.domElement?"outside":"",i=this.normalizeToPointerData(t);for(let n=0,s=i.length;n<s;n++){let o=this.bootstrapEvent(this.rootPointerEvent,i[n]);o.type+=r,this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch"))return;let e=this.normalizeToPointerData(t);for(let r=0,i=e.length;r<i;r++){let n=this.bootstrapEvent(this.rootPointerEvent,e[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;let e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,bo.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;bo.addTickerListener();let t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;bo.removeTickerListener();let t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,r){let i;this.domElement.parentElement?i=this.domElement.getBoundingClientRect():i={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};let n=1/this.resolution;t.x=(e-i.left)*(this.domElement.width/i.width)*n,t.y=(r-i.top)*(this.domElement.height/i.height)*n}normalizeToPointerData(t){let e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let r=0,i=t.changedTouches.length;r<i;r++){let n=t.changedTouches[r];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=t.type,e.push(n)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){let r=t;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=cL),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,e.push(r)}else e.push(t);return e}normalizeWheelEvent(t){let e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=uL[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}},x1=eg;x1.extension={name:"events",type:[me.RendererSystem,me.CanvasRendererSystem]};x1.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};_e.add(x1);function IT(t){return t==="dynamic"||t==="static"}var MT={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??IT(x1.defaultEventMode)},set interactive(t){he.deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??x1.defaultEventMode},set eventMode(t){this._internalInteractive=IT(t),this._internalEventMode=t},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(t,e,r){let i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,n=typeof e=="function"?void 0:e;t=i?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.on(t,e,n)},removeEventListener(t,e,r){let i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,n=typeof e=="function"?void 0:e;t=i?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,n)},dispatchEvent(t){if(!(t instanceof Vs))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};Vt.mixin(MT);var tg={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Vt.mixin(tg);var fL=9,wh=100,dL=0,hL=0,PT=2,RT=1,pL=-1e3,mL=-1e3,gL=2,p3=class{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(he.isMobile.tablet||he.isMobile.phone)&&this.createTouchHook();let r=document.createElement("div");r.style.width=`${wh}px`,r.style.height=`${wh}px`,r.style.position="absolute",r.style.top=`${dL}px`,r.style.left=`${hL}px`,r.style.zIndex=PT.toString(),this.div=r,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){let e=document.createElement("button");e.style.width=`${RT}px`,e.style.height=`${RT}px`,e.style.position="absolute",e.style.top=`${pL}px`,e.style.left=`${mL}px`,e.style.zIndex=gL.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);let r=e.children;if(r)for(let i=0;i<r.length;i++)this.updateAccessibleObjects(r[i])}update(){let e=performance.now();if(he.isMobile.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);let{x:r,y:i,width:n,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,c=n/o*l,u=s/a*l,d=this.div;d.style.left=`${r}px`,d.style.top=`${i}px`,d.style.width=`${o}px`,d.style.height=`${a}px`;for(let h=0;h<this.children.length;h++){let p=this.children[h];if(p.renderId!==this.renderId)p._accessibleActive=!1,he.removeItems(this.children,h,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,h--;else{d=p._accessibleDiv;let m=p.hitArea,g=p.worldTransform;p.hitArea?(d.style.left=`${(g.tx+m.x*g.a)*c}px`,d.style.top=`${(g.ty+m.y*g.d)*u}px`,d.style.width=`${m.width*g.a*c}px`,d.style.height=`${m.height*g.d*u}px`):(m=p.getBounds(),this.capHitArea(m),d.style.left=`${m.x*c}px`,d.style.top=`${m.y*u}px`,d.style.width=`${m.width*c}px`,d.style.height=`${m.height*u}px`,d.title!==p.accessibleTitle&&p.accessibleTitle!==null&&(d.title=p.accessibleTitle),d.getAttribute("aria-label")!==p.accessibleHint&&p.accessibleHint!==null&&d.setAttribute("aria-label",p.accessibleHint)),(p.accessibleTitle!==d.title||p.tabIndex!==d.tabIndex)&&(d.title=p.accessibleTitle,d.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);let{width:r,height:i}=this.renderer;e.x+e.width>r&&(e.width=r-e.x),e.y+e.height>i&&(e.height=i-e.y)}addChild(e){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${wh}px`,r.style.height=`${wh}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=PT.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=e.accessiblePointerEvents,r.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?r.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(r.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&r.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(r),e._accessibleActive=!0,e._accessibleDiv=r,r.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,r){let{displayObject:i}=e.target,n=this.renderer.events.rootBoundary,s=Object.assign(new Vs(n),{target:i});n.rootTarget=this.renderer.lastObjectRendered,r.forEach(o=>n.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===fL&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}};p3.extension={name:"accessibility",type:[me.RendererPlugin,me.CanvasRendererPlugin]};_e.add(p3);var rg=class{constructor(t){this.stage=new st,t=Object.assign({forceCanvas:!1},t),this.renderer=Xm(t),rg._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(t,e){let r=rg._plugins.slice(0);r.reverse(),r.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}},_1=rg;_1._plugins=[];_e.handleByList(me.Application,_1._plugins);var m3=class{static init(e){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,i;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,i=globalThis.innerHeight;else{let{clientWidth:n,clientHeight:s}=this._resizeTo;r=n,i=s}this.renderer.resize(r,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}};m3.extension=me.Application;_e.add(m3);var NT={loader:me.LoadParser,resolver:me.ResolveParser,cache:me.CacheParser,detection:me.DetectionParser};_e.handle(me.Asset,t=>{let e=t.ref;Object.entries(NT).filter(([r])=>!!e[r]).forEach(([r,i])=>_e.add(Object.assign(e[r],{extension:e[r].extension??i})))},t=>{let e=t.ref;Object.keys(NT).filter(r=>!!e[r]).forEach(r=>_e.remove(e[r]))});var Eh=class{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<r;i++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}};function xs(t,e){if(Array.isArray(e)){for(let r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function zi(t,e){let r=t.split("?")[0],i=he.path.extname(r).toLowerCase();return Array.isArray(e)?e.includes(i):i===e}var cn=(t,e)=>(Array.isArray(t)||(t=[t]),e?t.map(r=>typeof r=="string"?e(r):r):t);var b1=(t,e)=>{let r=e.split("?")[1];return r&&(t+=`?${r}`),t};function DT(t,e,r,i,n){let s=e[r];for(let o=0;o<s.length;o++){let a=s[o];r<e.length-1?DT(t.replace(i[r],a),e,r+1,i,n):n.push(t.replace(i[r],a))}}function Sh(t){let e=/\{(.*?)\}/g,r=t.match(e),i=[];if(r){let n=[];r.forEach(s=>{let o=s.substring(1,s.length-1).split(",");n.push(o)}),DT(t,n,0,r,i)}else i.push(t);return i}var ua=t=>!Array.isArray(t);var ig=class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){let r=this._cache.get(e);return r||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){let i=cn(e),n;for(let a=0;a<this.parsers.length;a++){let l=this.parsers[a];if(l.test(r)){n=l.getCacheableAssets(i,r);break}}n||(n={},i.forEach(a=>{n[a]=r}));let s=Object.keys(n),o={cacheKeys:s,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==r&&console.warn("[Cache] already has key:",a),this._cache.set(a,n[a])}),r instanceof be){let a=r;i.forEach(l=>{a.baseTexture!==be.EMPTY.baseTexture&&Le.addToCache(a.baseTexture,l),be.addToCache(a,l)})}}remove(e){if(this._cacheMap.get(e),!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}let r=this._cacheMap.get(e);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}},hl=new ig;var Th=class{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,r,i)=>(this._parsersValidated=!1,e[r]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,r){let i={promise:null,parser:null};return i.promise=(async()=>{let n=null,s=null;if(r.loadParser&&(s=this._parserHash[r.loadParser],s||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${e}`)),!s){for(let o=0;o<this.parsers.length;o++){let a=this.parsers[o];if(a.load&&a.test?.(e,r,this)){s=a;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await s.load(e,r,this),i.parser=s;for(let o=0;o<this.parsers.length;o++){let a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(n,r,this)&&(n=await a.parse(n,r,this)||n,i.parser=a)}return n})(),i}async load(e,r){this._parsersValidated||this._validateParsers();let i=0,n={},s=ua(e),o=cn(e,c=>({src:c})),a=o.length,l=o.map(async c=>{let u=he.path.toAbsolute(c.src);if(!n[c.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,c)),n[c.src]=await this.promiseCache[u].promise,r&&r(++i/a)}catch(d){throw delete this.promiseCache[u],delete n[c.src],new Error(`[Loader.load] Failed to load ${u}.
${d}`)}});return await Promise.all(l),s?n[o[0].src]:n}async unload(e){let i=cn(e,n=>({src:n})).map(async n=>{let s=he.path.toAbsolute(n.src),o=this.promiseCache[s];if(o){let a=await o.promise;o.parser?.unload?.(a,n,this),delete this.promiseCache[s]}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,r)=>(e[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...e,[r.name]:r}),{})}};var Zr=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(Zr||{});var yL=".json",vL="application/json",ng={extension:{type:me.LoadParser,priority:Zr.Low},name:"loadJson",test(t){return xs(t,vL)||zi(t,yL)},async load(t){return await(await ue.ADAPTER.fetch(t)).json()}};_e.add(ng);var xL=".txt",_L="text/plain",sg={name:"loadTxt",extension:{type:me.LoadParser,priority:Zr.Low},test(t){return xs(t,_L)||zi(t,xL)},async load(t){return await(await ue.ADAPTER.fetch(t)).text()}};_e.add(sg);var bL=["normal","bold","100","200","300","400","500","600","700","800","900"],wL=[".ttf",".otf",".woff",".woff2"],EL=["font/ttf","font/otf","font/woff","font/woff2"],SL=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function og(t){let e=he.path.extname(t),n=he.path.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)),s=n.length>0;for(let a of n)if(!a.match(SL)){s=!1;break}let o=n.join(" ");return s||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}var ag={extension:{type:me.LoadParser,priority:Zr.Low},name:"loadWebFont",test(t){return xs(t,EL)||zi(t,wL)},async load(t,e){let r=ue.ADAPTER.getFontFaceSet();if(r){let i=[],n=e.data?.family??og(t),s=e.data?.weights?.filter(a=>bL.includes(a))??["normal"],o=e.data??{};for(let a=0;a<s.length;a++){let l=s[a],c=new FontFace(n,`url(${encodeURI(t)})`,{...o,weight:l});await c.load(),r.add(c),i.push(c)}return i.length===1?i[0]:i}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>ue.ADAPTER.getFontFaceSet().delete(e))}};_e.add(ag);var FT=0,lg,TL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",AL={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${TL}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},CL={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`},cg,ug=class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{let r=URL.createObjectURL(new Blob([AL.code],{type:"application/javascript"})),i=new Worker(r);i.addEventListener("message",n=>{i.terminate(),URL.revokeObjectURL(r),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){lg===void 0&&(lg=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<lg&&(cg||(cg=URL.createObjectURL(new Blob([CL.code],{type:"application/javascript"}))),this._createdWorkers++,e=new Worker(cg),e.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();let i=new Promise((n,s)=>{this.queue.push({id:e,arguments:r,resolve:n,reject:s})});return this.next(),i}next(){if(!this.queue.length)return;let e=this.getWorker();if(!e)return;let r=this.queue.pop(),i=r.id;this.resolveHash[FT]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:FT++,id:i})}},fg=new ug;function Eo(t,e,r){let i=new be(t);return i.baseTexture.on("dispose",()=>{delete e.promiseCache[r]}),i}var kL=[".jpeg",".jpg",".png",".webp",".avif"],IL=["image/jpeg","image/png","image/webp","image/avif"];async function dg(t){let e=await ue.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);let r=await e.blob();return await createImageBitmap(r)}var fa={name:"loadTextures",extension:{type:me.LoadParser,priority:Zr.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return xs(t,IL)||zi(t,kL)},async load(t,e,r){let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await fg.isImageBitmapSupported()?i=await fg.loadImageBitmap(t):i=await dg(t):i=await new Promise(s=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=t,i.complete?s(i):i.onload=()=>{s(i)}});let n=new Le(i,{resolution:he.getResolutionOfUrl(t),...e.data});return n.resource.src=t,Eo(n,r,t)},unload(t){t.destroy(!0)}};_e.add(fa);var ML=".svg",PL="image/svg+xml",hg={extension:{type:me.LoadParser,priority:Zr.High},name:"loadSVG",test(t){return xs(t,PL)||zi(t,ML)},async testParse(t){return la.test(t)},async parse(t,e,r){let i=new la(t,e?.data?.resourceOptions);await i.load();let n=new Le(i,{resolution:he.getResolutionOfUrl(t),...e?.data});return n.resource.src=t,Eo(n,r,t)},async load(t,e){return(await ue.ADAPTER.fetch(t)).text()},unload:fa.unload};_e.add(hg);var Ah=class{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,r)=>`${e}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{let r=e;this._defaultSearchParams=Object.keys(r).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(r[i])}`).join("&")}}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){let i=[];Array.isArray(r)?r.forEach(n=>{if(typeof n.name=="string"){let s=this._createBundleAssetId(e,n.name);i.push(s),this.add([n.name,s],n.srcs,n.data)}else{let s=n.name.map(o=>this._createBundleAssetId(e,o));s.forEach(o=>{i.push(o)}),this.add([...n.name,...s],n.srcs)}}):Object.keys(r).forEach(n=>{i.push(this._createBundleAssetId(e,n)),this.add([n,this._createBundleAssetId(e,n)],r[n])}),this._bundles[e]=i}add(e,r,i){let n=cn(e);n.forEach(o=>{this.hasKey(o)&&console.warn(`[Resolver] already has key: ${o} overwriting`)}),Array.isArray(r)||(typeof r=="string"?r=Sh(r):r=[r]);let s=r.map(o=>{let a=o;if(typeof o=="string"){let l=!1;for(let c=0;c<this._parsers.length;c++){let u=this._parsers[c];if(u.test(o)){a=u.parse(o),l=!0;break}}l||(a={src:o})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=n),(this._basePath||this._rootPath)&&(a.src=he.path.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=a.data??i,a});n.forEach(o=>{this._assetMap[o]=s})}resolveBundle(e){let r=ua(e);e=cn(e);let i={};return e.forEach(n=>{let s=this._bundles[n];if(s){let o=this.resolve(s),a={};for(let l in o){let c=o[l];a[this._extractAssetIdFromBundle(n,l)]=c}i[n]=a}}),r?i[e[0]]:i}resolveUrl(e){let r=this.resolve(e);if(typeof e!="string"){let i={};for(let n in r)i[n]=r[n].src;return i}return r.src}resolve(e){let r=ua(e);e=cn(e);let i={};return e.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let s=this._assetMap[n],o=this._getPreferredOrder(s),a=s[0];o?.priority.forEach(l=>{o.params[l].forEach(c=>{let u=s.filter(d=>d[l]?d[l]===c:!1);u.length&&(s=u)})}),this._resolverHash[n]=s[0]??a}else{let s=n;(this._basePath||this._rootPath)&&(s=he.path.toAbsolute(s,this._basePath,this._rootPath)),s=this._appendDefaultSearchParams(s),this._resolverHash[n]={src:s}}i[n]=this._resolverHash[n]}),r?i[e[0]]:i}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let r=0;r<e.length;r++){let i=e[0],n=this._preferredOrder.find(s=>s.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;let r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}};var Ch=class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Ah,this.loader=new Th,this.cache=hl,this._backgroundLoader=new Eh(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let s=e.manifest;typeof s=="string"&&(s=await this.load(s)),this.resolver.addManifest(s)}let r=e.texturePreference?.resolution??1,i=typeof r=="number"?[r]:r,n=[];if(e.texturePreference?.format){let s=e.texturePreference?.format;n=typeof s=="string"?[s]:s;for(let o of this._detections)await o.test()||(n=await o.remove(n))}else for(let s of this._detections)await s.test()&&(n=await s.add(n));this.resolver.prefer({params:{format:n,resolution:i}}),e.preferences&&this.setPreferences(e.preferences)}add(e,r,i){this.resolver.add(e,r,i)}async load(e,r){this._initialized||await this.init();let i=ua(e),n=cn(e).map(a=>typeof a!="string"?(this.resolver.add(a.src,a),a.src):(this.resolver.hasKey(a)||this.resolver.add(a,a),a)),s=this.resolver.resolve(n),o=await this._mapLoadToResolve(s,r);return i?o[n[0]]:o}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let i=!1;typeof e=="string"&&(i=!0,e=[e]);let n=this.resolver.resolveBundle(e),s={},o=Object.keys(n),a=0,l=0,c=()=>{r?.(++a/l)},u=o.map(d=>{let h=n[d];return l+=Object.keys(h).length,this._mapLoadToResolve(h,c).then(p=>{s[d]=p})});return await Promise.all(u),i?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);let r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);let r=this.resolver.resolveBundle(e);Object.values(r).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return hl.get(e);let r={};for(let i=0;i<e.length;i++)r[i]=hl.get(e[i]);return r}async _mapLoadToResolve(e,r){let i=Object.values(e),n=Object.keys(e);this._backgroundLoader.active=!1;let s=await this.loader.load(i,r);this._backgroundLoader.active=!0;let o={};return i.forEach((a,l)=>{let c=s[a.src],u=[a.src];a.alias&&u.push(...a.alias),o[n[l]]=c,hl.set(u,c)}),o}async unload(e){this._initialized||await this.init();let r=cn(e).map(n=>typeof n!="string"?n.src:n),i=this.resolver.resolve(r);await this._unloadFromResolved(i)}async unloadBundle(e){this._initialized||await this.init(),e=cn(e);let r=this.resolver.resolveBundle(e),i=Object.keys(r).map(n=>this._unloadFromResolved(r[n]));await Promise.all(i)}async _unloadFromResolved(e){let r=Object.values(e);r.forEach(i=>{hl.remove(i.src)}),await this.loader.unload(r)}get detections(){return this._detections}get preferWorkers(){return fa.config.preferWorkers}set preferWorkers(e){he.deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(i=>i in e).forEach(i=>{r.config[i]=e[i]})})}},da=new Ch;_e.handleByList(me.LoadParser,da.loader.parsers).handleByList(me.ResolveParser,da.resolver.parsers).handleByList(me.CacheParser,da.cache.parsers).handleByList(me.DetectionParser,da.detections);var pg={extension:me.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof be),getCacheableAssets:(t,e)=>{let r={};return t.forEach(i=>{e.forEach((n,s)=>{r[i+(s===0?"":s+1)]=n})}),r}};_e.add(pg);var mg={extension:{type:me.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;let t="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",e=await ue.ADAPTER.fetch(t).then(r=>r.blob());return createImageBitmap(e).then(()=>!0,()=>!1)},add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};_e.add(mg);var gg={extension:{type:me.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;let t="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",e=await ue.ADAPTER.fetch(t).then(r=>r.blob());return createImageBitmap(e).then(()=>!0,()=>!1)},add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};_e.add(gg);var OT=["png","jpg","jpeg"],yg={extension:{type:me.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...OT],remove:async t=>t.filter(e=>!OT.includes(e))};_e.add(yg);var vg={extension:me.ResolveParser,test:fa.test,parse:t=>({resolution:parseFloat(ue.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})};_e.add(vg);var un=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t))(un||{}),pl={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};var ha,iu;function LT(){iu={s3tc:ha.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:ha.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:ha.getExtension("WEBGL_compressed_texture_etc"),etc1:ha.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:ha.getExtension("WEBGL_compressed_texture_pvrtc")||ha.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:ha.getExtension("WEBGL_compressed_texture_atc"),astc:ha.getExtension("WEBGL_compressed_texture_astc")}}var xg={extension:{type:me.DetectionParser,priority:2},test:async()=>{let e=ue.ADAPTER.createCanvas().getContext("webgl");return e?(ha=e,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{iu||LT();let e=[];for(let r in iu)iu[r]&&e.push(r);return[...e,...t]},remove:async t=>(iu||LT(),t.filter(e=>!(e in iu)))};_e.add(xg);var nu=class extends Tn{constructor(e,r={width:1,height:1,autoLoad:!0}){let i,n;typeof e=="string"?(i=e,n=new Uint8Array):(i=null,n=e),super(n,r),this.origin=i,this.buffer=n?new il(n):null,this._load=null,this.loaded=!1,this.origin!==null&&r.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new il(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}};var Wn=class extends nu{constructor(e,r){super(e,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=Wn._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||Wn._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,r,i){let n=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let o=0,a=this.levels;o<a;o++){let{levelID:l,levelWidth:c,levelHeight:u,levelBuffer:d}=this._levelBuffers[o];n.compressedTexImage2D(n.TEXTURE_2D,l,this.format,c,u,0,d)}return!0}onBlobLoaded(){this._levelBuffers=Wn._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(e,r,i,n,s,o,a){let l=new Array(i),c=e.byteOffset,u=o,d=a,h=u+n-1&~(n-1),p=d+s-1&~(s-1),m=h*p*pl[r];for(let g=0;g<i;g++)l[g]={levelID:g,levelWidth:i>1?u:h,levelHeight:i>1?d:p,levelBuffer:new Uint8Array(e.buffer,c,m)},c+=m,u=u>>1||1,d=d>>1||1,h=u+n-1&~(n-1),p=d+s-1&~(s-1),m=h*p*pl[r];return l}};var _g=4,kh=124,RL=32,BT=20,NL=542327876,Ih={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},DL={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Mh={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4};var FL=1,OL=2,LL=4,BL=64,UL=512,GL=131072,zL=827611204,HL=861165636,$L=894720068,jL=808540228,VL=4,XL={[zL]:un.COMPRESSED_RGBA_S3TC_DXT1_EXT,[HL]:un.COMPRESSED_RGBA_S3TC_DXT3_EXT,[$L]:un.COMPRESSED_RGBA_S3TC_DXT5_EXT},WL={[70]:un.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:un.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:un.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:un.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:un.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:un.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:un.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:un.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:un.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function Ph(t){let e=new Uint32Array(t);if(e[0]!==NL)throw new Error("Invalid DDS file magic word");let i=new Uint32Array(t,0,kh/Uint32Array.BYTES_PER_ELEMENT),n=i[Ih.HEIGHT],s=i[Ih.WIDTH],o=i[Ih.MIPMAP_COUNT],a=new Uint32Array(t,Ih.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,RL/Uint32Array.BYTES_PER_ELEMENT),l=a[FL];if(l&LL){let c=a[DL.FOURCC];if(c!==jL){let _=XL[c],b=_g+kh,w=new Uint8Array(t,b);return[new Wn(w,{format:_,width:s,height:n,levels:o})]}let u=_g+kh,d=new Uint32Array(e.buffer,u,BT/Uint32Array.BYTES_PER_ELEMENT),h=d[Mh.DXGI_FORMAT],p=d[Mh.RESOURCE_DIMENSION],m=d[Mh.MISC_FLAG],g=d[Mh.ARRAY_SIZE],y=WL[h];if(y===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${h}`);if(m===VL)throw new Error("DDSParser does not support cubemap textures");if(p===6)throw new Error("DDSParser does not supported 3D texture data");let v=new Array,x=_g+kh+BT;if(g===1)v.push(new Uint8Array(t,x));else{let _=pl[y],b=0,w=s,E=n;for(let T=0;T<o;T++){let k=Math.max(1,w+3&-4),C=Math.max(1,E+3&-4),I=k*C*_;b+=I,w=w>>>1,E=E>>>1}let A=x;for(let T=0;T<g;T++)v.push(new Uint8Array(t,A,b)),A+=b}return v.map(_=>new Wn(_,{format:y,width:s,height:n,levels:o}))}throw l&BL?new Error("DDSParser does not support uncompressed texture data."):l&UL?new Error("DDSParser does not supported YUV uncompressed texture data."):l&GL?new Error("DDSParser does not support single-channel (lumninance) texture data!"):l&OL?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}var UT=[171,75,84,88,32,49,49,187,13,10,26,10],qL=67305985,Ws={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},bg=64,Rh={[Ge.UNSIGNED_BYTE]:1,[Ge.UNSIGNED_SHORT]:2,[Ge.INT]:4,[Ge.UNSIGNED_INT]:4,[Ge.FLOAT]:4,[Ge.HALF_FLOAT]:8},wg={[Ce.RGBA]:4,[Ce.RGB]:3,[Ce.RG]:2,[Ce.RED]:1,[Ce.LUMINANCE]:1,[Ce.LUMINANCE_ALPHA]:2,[Ce.ALPHA]:1},Eg={[Ge.UNSIGNED_SHORT_4_4_4_4]:2,[Ge.UNSIGNED_SHORT_5_5_5_1]:2,[Ge.UNSIGNED_SHORT_5_6_5]:2};function Nh(t,e,r=!1){let i=new DataView(e);if(!YL(t,i))return null;let n=i.getUint32(Ws.ENDIANNESS,!0)===qL,s=i.getUint32(Ws.GL_TYPE,n),o=i.getUint32(Ws.GL_FORMAT,n),a=i.getUint32(Ws.GL_INTERNAL_FORMAT,n),l=i.getUint32(Ws.PIXEL_WIDTH,n),c=i.getUint32(Ws.PIXEL_HEIGHT,n)||1,u=i.getUint32(Ws.PIXEL_DEPTH,n)||1,d=i.getUint32(Ws.NUMBER_OF_ARRAY_ELEMENTS,n)||1,h=i.getUint32(Ws.NUMBER_OF_FACES,n),p=i.getUint32(Ws.NUMBER_OF_MIPMAP_LEVELS,n),m=i.getUint32(Ws.BYTES_OF_KEY_VALUE_DATA,n);if(c===0||u!==1)throw new Error("Only 2D textures are supported");if(h!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(d!==1)throw new Error("WebGL does not support array textures");let g=4,y=4,v=l+3&-4,x=c+3&-4,_=new Array(d),b=l*c;s===0&&(b=v*x);let w;if(s!==0?Rh[s]?w=Rh[s]*wg[o]:w=Eg[s]:w=pl[a],w===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");let E=r?KL(i,m,n):null,T=b*w,k=l,C=c,I=v,P=x,N=bg+m;for(let M=0;M<p;M++){let D=i.getUint32(N,n),F=N+4;for(let L=0;L<d;L++){let B=_[L];B||(B=_[L]=new Array(p)),B[M]={levelID:M,levelWidth:p>1||s!==0?k:I,levelHeight:p>1||s!==0?C:P,levelBuffer:new Uint8Array(e,F,T)},F+=T}N+=D+4,N=N%4!==0?N+4-N%4:N,k=k>>1||1,C=C>>1||1,I=k+g-1&~(g-1),P=C+y-1&~(y-1),T=I*P*w}return s!==0?{uncompressed:_.map(M=>{let D=M[0].levelBuffer,F=!1;return s===Ge.FLOAT?D=new Float32Array(M[0].levelBuffer.buffer,M[0].levelBuffer.byteOffset,M[0].levelBuffer.byteLength/4):s===Ge.UNSIGNED_INT?(F=!0,D=new Uint32Array(M[0].levelBuffer.buffer,M[0].levelBuffer.byteOffset,M[0].levelBuffer.byteLength/4)):s===Ge.INT&&(F=!0,D=new Int32Array(M[0].levelBuffer.buffer,M[0].levelBuffer.byteOffset,M[0].levelBuffer.byteLength/4)),{resource:new Tn(D,{width:M[0].levelWidth,height:M[0].levelHeight}),type:s,format:F?QL(o):o}}),kvData:E}:{compressed:_.map(M=>new Wn(null,{format:a,width:l,height:c,levels:p,levelBuffers:M})),kvData:E}}function YL(t,e){for(let r=0;r<UT.length;r++)if(e.getUint8(r)!==UT[r])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}function QL(t){switch(t){case Ce.RGBA:return Ce.RGBA_INTEGER;case Ce.RGB:return Ce.RGB_INTEGER;case Ce.RG:return Ce.RG_INTEGER;case Ce.RED:return Ce.RED_INTEGER;default:return t}}function KL(t,e,r){let i=new Map,n=0;for(;n<e;){let s=t.getUint32(bg+n,r),o=bg+n+4,a=3-(s+3)%4;if(s===0||s>e-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&t.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}let c=new TextDecoder().decode(new Uint8Array(t.buffer,o,l)),u=new DataView(t.buffer,o+l+1,s-l-1);i.set(c,u),n+=4+s+a}return i}var Sg={extension:{type:me.LoadParser,priority:Zr.High},name:"loadDDS",test(t){return zi(t,".dds")},async load(t,e,r){let n=await(await ue.ADAPTER.fetch(t)).arrayBuffer(),o=Ph(n).map(a=>{let l=new Le(a,{mipmap:oi.OFF,alphaMode:$r.NO_PREMULTIPLIED_ALPHA,resolution:he.getResolutionOfUrl(t),...e.data});return Eo(l,r,t)});return o.length===1?o[0]:o},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};_e.add(Sg);var Tg={extension:{type:me.LoadParser,priority:Zr.High},name:"loadKTX",test(t){return zi(t,".ktx")},async load(t,e,r){let n=await(await ue.ADAPTER.fetch(t)).arrayBuffer(),{compressed:s,uncompressed:o,kvData:a}=Nh(t,n),l=s??o,c={mipmap:oi.OFF,alphaMode:$r.NO_PREMULTIPLIED_ALPHA,resolution:he.getResolutionOfUrl(t),...e.data},u=l.map(d=>{l===o&&Object.assign(c,{type:d.type,format:d.format});let h=new Le(d,c);return h.ktxKeyValueData=a,Eo(h,r,t)});return u.length===1?u[0]:u},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};_e.add(Tg);var Ag={extension:me.ResolveParser,test:t=>{let r=t.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(r)},parse:t=>{if(t.split("?")[0].split(".").pop()==="ktx"){let i=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(i.some(n=>t.endsWith(n)))return{resolution:parseFloat(ue.RETINA_PREFIX.exec(t)?.[1]??"1"),format:i.find(n=>t.endsWith(n)),src:t}}return{resolution:parseFloat(ue.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t}}};_e.add(Ag);var ZL=new Re,JL=4,g3=class{constructor(t){this.renderer=t}async image(t,e,r){let i=new Image;return i.src=await this.base64(t,e,r),i}async base64(t,e,r){let i=this.canvas(t);if(i.toBlob!==void 0)return new Promise((n,s)=>{i.toBlob(o=>{if(!o){s(new Error("ICanvas.toBlob failed!"));return}let a=new FileReader;a.onload=()=>n(a.result),a.onerror=s,a.readAsDataURL(o)},e,r)});if(i.toDataURL!==void 0)return i.toDataURL(e,r);if(i.convertToBlob!==void 0){let n=await i.convertToBlob({type:e,quality:r});return new Promise((s,o)=>{let a=new FileReader;a.onload=()=>s(a.result),a.onerror=o,a.readAsDataURL(n)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,e){let{pixels:r,width:i,height:n,flipY:s}=this._rawPixels(t,e);s&&g3._flipY(r,i,n),g3._unpremultiplyAlpha(r);let o=new he.CanvasRenderTarget(i,n,1),a=new ImageData(new Uint8ClampedArray(r.buffer),i,n);return o.context.putImageData(a,0,0),o.canvas}pixels(t,e){let{pixels:r,width:i,height:n,flipY:s}=this._rawPixels(t,e);return s&&g3._flipY(r,i,n),g3._unpremultiplyAlpha(r),r}_rawPixels(t,e){let r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let i,n=!1,s,o=!1;if(t&&(t instanceof ln?s=t:(s=r.generateTexture(t,{resolution:r.resolution,multisample:r.multisample}),o=!0)),s){if(i=s.baseTexture.resolution,e=e??s.frame,n=!1,!o){r.renderTexture.bind(s);let d=s.framebuffer.glFramebuffers[r.CONTEXT_UID];d.blitFramebuffer&&r.framebuffer.bind(d.blitFramebuffer)}}else i=r.resolution,e||(e=ZL,e.width=r.width/i,e.height=r.height/i),n=!0,r.renderTexture.bind();let a=Math.round(e.width*i),l=Math.round(e.height*i),c=new Uint8Array(JL*a*l),u=r.gl;return u.readPixels(Math.round(e.x*i),Math.round(e.y*i),a,l,u.RGBA,u.UNSIGNED_BYTE,c),o&&s?.destroy(!0),{pixels:c,width:a,height:l,flipY:n}}destroy(){this.renderer=null}static _flipY(t,e,r){let i=e<<2,n=r>>1,s=new Uint8Array(i);for(let o=0;o<n;o++){let a=o*i,l=(r-o-1)*i;s.set(t.subarray(a,a+i)),t.copyWithin(a,l,l+i),t.set(s,l)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));let e=t.length;for(let r=0;r<e;r+=4){let i=t[r+3];if(i!==0){let n=255.001/i;t[r]=t[r]*n+.5,t[r+1]=t[r+1]*n+.5,t[r+2]=t[r+2]*n+.5}}}},Cg=g3;Cg.extension={name:"extract",type:me.RendererSystem};_e.add(Cg);var pa={build(t){let e=t.points,r,i,n,s,o,a;if(t.type===pr.CIRC){let m=t.shape;r=m.x,i=m.y,o=a=m.radius,n=s=0}else if(t.type===pr.ELIP){let m=t.shape;r=m.x,i=m.y,o=m.width,a=m.height,n=s=0}else{let m=t.shape,g=m.width/2,y=m.height/2;r=m.x+g,i=m.y+y,o=a=Math.max(0,Math.min(m.radius,Math.min(g,y))),n=g-o,s=y-a}if(!(o>=0&&a>=0&&n>=0&&s>=0)){e.length=0;return}let l=Math.ceil(2.3*Math.sqrt(o+a)),c=l*8+(n?4:0)+(s?4:0);if(e.length=c,c===0)return;if(l===0){e.length=8,e[0]=e[6]=r+n,e[1]=e[3]=i+s,e[2]=e[4]=r-n,e[5]=e[7]=i-s;return}let u=0,d=l*4+(n?2:0)+2,h=d,p=c;{let m=n+o,g=s,y=r+m,v=r-m,x=i+g;if(e[u++]=y,e[u++]=x,e[--d]=x,e[--d]=v,s){let _=i-g;e[h++]=v,e[h++]=_,e[--p]=_,e[--p]=y}}for(let m=1;m<l;m++){let g=Math.PI/2*(m/l),y=n+Math.cos(g)*o,v=s+Math.sin(g)*a,x=r+y,_=r-y,b=i+v,w=i-v;e[u++]=x,e[u++]=b,e[--d]=b,e[--d]=_,e[h++]=_,e[h++]=w,e[--p]=w,e[--p]=x}{let m=n,g=s+a,y=r+m,v=r-m,x=i+g,_=i-g;e[u++]=y,e[u++]=x,e[--p]=_,e[--p]=y,n&&(e[u++]=v,e[u++]=x,e[--p]=_,e[--p]=v)}},triangulate(t,e){let r=t.points,i=e.points,n=e.indices;if(r.length===0)return;let s=i.length/2,o=s,a,l;if(t.type!==pr.RREC){let u=t.shape;a=u.x,l=u.y}else{let u=t.shape;a=u.x+u.width/2,l=u.y+u.height/2}let c=t.matrix;i.push(t.matrix?c.a*a+c.c*l+c.tx:a,t.matrix?c.b*a+c.d*l+c.ty:l),s++,i.push(r[0],r[1]);for(let u=2;u<r.length;u+=2)i.push(r[u],r[u+1]),n.push(s++,o,s);n.push(o+1,o,s)}};function GT(t,e=!1){let r=t.length;if(r<6)return;let i=0;for(let n=0,s=t[r-2],o=t[r-1];n<r;n+=2){let a=t[n],l=t[n+1];i+=(a-s)*(l+o),s=a,o=l}if(!e&&i>0||e&&i<=0){let n=r/2;for(let s=n+n%2;s<r;s+=2){let o=r-s-2,a=r-s-1,l=s,c=s+1;[t[o],t[l]]=[t[l],t[o]],[t[a],t[c]]=[t[c],t[a]]}}}var w1={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let r=t.points,i=t.holes,n=e.points,s=e.indices;if(r.length>=6){GT(r,!1);let o=[];for(let c=0;c<i.length;c++){let u=i[c];GT(u.points,!0),o.push(r.length/2),r=r.concat(u.points)}let a=he.earcut(r,o,2);if(!a)return;let l=n.length/2;for(let c=0;c<a.length;c+=3)s.push(a[c]+l),s.push(a[c+1]+l),s.push(a[c+2]+l);for(let c=0;c<r.length;c++)n.push(r[c])}}};var y3={build(t){let e=t.shape,r=e.x,i=e.y,n=e.width,s=e.height,o=t.points;o.length=0,n>=0&&s>=0&&o.push(r,i,r+n,i,r+n,i+s,r,i+s)},triangulate(t,e){let r=t.points,i=e.points;if(r.length===0)return;let n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};var v3={build(t){pa.build(t)},triangulate(t,e){pa.triangulate(t,e)}};var Yt=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(Yt||{}),tt=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(tt||{}),_s={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};var ml=class{static curveTo(e,r,i,n,s,o){let a=o[o.length-2],c=o[o.length-1]-r,u=a-e,d=n-r,h=i-e,p=Math.abs(c*h-u*d);if(p<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==r)&&o.push(e,r),null;let m=c*c+u*u,g=d*d+h*h,y=c*d+u*h,v=s*Math.sqrt(m)/p,x=s*Math.sqrt(g)/p,_=v*y/m,b=x*y/g,w=v*h+x*u,E=v*d+x*c,A=u*(x+_),T=c*(x+_),k=h*(v+b),C=d*(v+b),I=Math.atan2(T-E,A-w),P=Math.atan2(C-E,k-w);return{cx:w+e,cy:E+r,radius:s,startAngle:I,endAngle:P,anticlockwise:u*d>h*c}}static arc(e,r,i,n,s,o,a,l,c){let u=a-o,d=_s._segmentsCount(Math.abs(u)*s,Math.ceil(Math.abs(u)/ol)*40),h=u/(d*2),p=h*2,m=Math.cos(h),g=Math.sin(h),y=d-1,v=y%1/y;for(let x=0;x<=y;++x){let _=x+v*x,b=h+o+p*_,w=Math.cos(b),E=-Math.sin(b);c.push((m*w+g*E)*s+i,(m*-E+g*w)*s+n)}}};var E1=class{constructor(){this.reset()}begin(e,r,i){this.reset(),this.style=e,this.start=r,this.attribStart=i}end(e,r){this.attribSize=r-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}};var ma=class{static curveLength(e,r,i,n,s,o,a,l){let u=0,d=0,h=0,p=0,m=0,g=0,y=0,v=0,x=0,_=0,b=0,w=e,E=r;for(let A=1;A<=10;++A)d=A/10,h=d*d,p=h*d,m=1-d,g=m*m,y=g*m,v=y*e+3*g*d*i+3*m*h*s+p*a,x=y*r+3*g*d*n+3*m*h*o+p*l,_=w-v,b=E-x,w=v,E=x,u+=Math.sqrt(_*_+b*b);return u}static curveTo(e,r,i,n,s,o,a){let l=a[a.length-2],c=a[a.length-1];a.length-=2;let u=_s._segmentsCount(ma.curveLength(l,c,e,r,i,n,s,o)),d=0,h=0,p=0,m=0,g=0;a.push(l,c);for(let y=1,v=0;y<=u;++y)v=y/u,d=1-v,h=d*d,p=h*d,m=v*v,g=m*v,a.push(p*l+3*h*v*e+3*d*m*i+g*s,p*c+3*h*v*r+3*d*m*n+g*o)}};function zT(t,e,r,i,n,s,o,a){let l=t-r*n,c=e-i*n,u=t+r*s,d=e+i*s,h,p;o?(h=i,p=-r):(h=-i,p=r);let m=l+h,g=c+p,y=u+h,v=d+p;return a.push(m,g,y,v),2}function S1(t,e,r,i,n,s,o,a){let l=r-t,c=i-e,u=Math.atan2(l,c),d=Math.atan2(n-t,s-e);a&&u<d?u+=Math.PI*2:!a&&u>d&&(d+=Math.PI*2);let h=u,p=d-u,m=Math.abs(p),g=Math.sqrt(l*l+c*c),y=(15*m*Math.sqrt(g)/Math.PI>>0)+1,v=p/y;if(h+=v,a){o.push(t,e,r,i);for(let x=1,_=h;x<y;x++,_+=v)o.push(t,e,t+Math.sin(_)*g,e+Math.cos(_)*g);o.push(t,e,n,s)}else{o.push(r,i,t,e);for(let x=1,_=h;x<y;x++,_+=v)o.push(t+Math.sin(_)*g,e+Math.cos(_)*g,t,e);o.push(n,s,t,e)}return y*2}function eB(t,e){let r=t.shape,i=t.points||r.points.slice(),n=e.closePointEps;if(i.length===0)return;let s=t.lineStyle,o=new Ne(i[0],i[1]),a=new Ne(i[i.length-2],i[i.length-1]),l=r.type!==pr.POLY||r.closeStroke,c=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(l){i=i.slice(),c&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));let L=(o.x+a.x)*.5,B=(a.y+o.y)*.5;i.unshift(L,B),i.push(L,B)}let u=e.points,d=i.length/2,h=i.length,p=u.length/2,m=s.width/2,g=m*m,y=s.miterLimit*s.miterLimit,v=i[0],x=i[1],_=i[2],b=i[3],w=0,E=0,A=-(x-b),T=v-_,k=0,C=0,I=Math.sqrt(A*A+T*T);A/=I,T/=I,A*=m,T*=m;let P=s.alignment,N=(1-P)*2,M=P*2;l||(s.cap===tt.ROUND?h+=S1(v-A*(N-M)*.5,x-T*(N-M)*.5,v-A*N,x-T*N,v+A*M,x+T*M,u,!0)+2:s.cap===tt.SQUARE&&(h+=zT(v,x,A,T,N,M,!0,u))),u.push(v-A*N,x-T*N,v+A*M,x+T*M);for(let L=1;L<d-1;++L){v=i[(L-1)*2],x=i[(L-1)*2+1],_=i[L*2],b=i[L*2+1],w=i[(L+1)*2],E=i[(L+1)*2+1],A=-(x-b),T=v-_,I=Math.sqrt(A*A+T*T),A/=I,T/=I,A*=m,T*=m,k=-(b-E),C=_-w,I=Math.sqrt(k*k+C*C),k/=I,C/=I,k*=m,C*=m;let B=_-v,O=x-b,R=_-w,U=E-b,G=B*R+O*U,$=O*R-U*B,q=$<0;if(Math.abs($)<.001*Math.abs(G)){u.push(_-A*N,b-T*N,_+A*M,b+T*M),G>=0&&(s.join===Yt.ROUND?h+=S1(_,b,_-A*N,b-T*N,_-k*N,b-C*N,u,!1)+4:h+=2,u.push(_-k*M,b-C*M,_+k*N,b+C*N));continue}let ie=(-A+v)*(-T+b)-(-A+_)*(-T+x),Q=(-k+w)*(-C+b)-(-k+_)*(-C+E),re=(B*Q-R*ie)/$,ve=(U*ie-O*Q)/$,de=(re-_)*(re-_)+(ve-b)*(ve-b),we=_+(re-_)*N,ne=b+(ve-b)*N,Ie=_-(re-_)*M,at=b-(ve-b)*M,Et=Math.min(B*B+O*O,R*R+U*U),$t=q?N:M,Pt=Et+$t*$t*g,J=de<=Pt,V=s.join;if(V===Yt.MITER&&de/g>y&&(V=Yt.BEVEL),J)switch(V){case Yt.MITER:{u.push(we,ne,Ie,at);break}case Yt.BEVEL:{q?u.push(we,ne,_+A*M,b+T*M,we,ne,_+k*M,b+C*M):u.push(_-A*N,b-T*N,Ie,at,_-k*N,b-C*N,Ie,at),h+=2;break}case Yt.ROUND:{q?(u.push(we,ne,_+A*M,b+T*M),h+=S1(_,b,_+A*M,b+T*M,_+k*M,b+C*M,u,!0)+4,u.push(we,ne,_+k*M,b+C*M)):(u.push(_-A*N,b-T*N,Ie,at),h+=S1(_,b,_-A*N,b-T*N,_-k*N,b-C*N,u,!1)+4,u.push(_-k*N,b-C*N,Ie,at));break}}else{switch(u.push(_-A*N,b-T*N,_+A*M,b+T*M),V){case Yt.MITER:{q?u.push(Ie,at,Ie,at):u.push(we,ne,we,ne),h+=2;break}case Yt.ROUND:{q?h+=S1(_,b,_+A*M,b+T*M,_+k*M,b+C*M,u,!0)+2:h+=S1(_,b,_-A*N,b-T*N,_-k*N,b-C*N,u,!1)+2;break}}u.push(_-k*N,b-C*N,_+k*M,b+C*M),h+=2}}v=i[(d-2)*2],x=i[(d-2)*2+1],_=i[(d-1)*2],b=i[(d-1)*2+1],A=-(x-b),T=v-_,I=Math.sqrt(A*A+T*T),A/=I,T/=I,A*=m,T*=m,u.push(_-A*N,b-T*N,_+A*M,b+T*M),l||(s.cap===tt.ROUND?h+=S1(_-A*(N-M)*.5,b-T*(N-M)*.5,_-A*N,b-T*N,_+A*M,b+T*M,u,!1)+2:s.cap===tt.SQUARE&&(h+=zT(_,b,A,T,N,M,!1,u)));let D=e.indices,F=_s.epsilon*_s.epsilon;for(let L=p;L<h+p-2;++L)v=u[L*2],x=u[L*2+1],_=u[(L+1)*2],b=u[(L+1)*2+1],w=u[(L+2)*2],E=u[(L+2)*2+1],!(Math.abs(v*(b-E)+_*(E-x)+w*(x-b))<F)&&D.push(L,L+1,L+2)}function tB(t,e){let r=0,i=t.shape,n=t.points||i.points,s=i.type!==pr.POLY||i.closeStroke;if(n.length===0)return;let o=e.points,a=e.indices,l=n.length/2,c=o.length/2,u=c;for(o.push(n[0],n[1]),r=1;r<l;r++)o.push(n[r*2],n[r*2+1]),a.push(u,u+1),u++;s&&a.push(u,c)}function su(t,e){t.lineStyle.native?tB(t,e):eB(t,e)}var ga=class{static curveLength(e,r,i,n,s,o){let a=e-2*i+s,l=r-2*n+o,c=2*i-2*e,u=2*n-2*r,d=4*(a*a+l*l),h=4*(a*c+l*u),p=c*c+u*u,m=2*Math.sqrt(d+h+p),g=Math.sqrt(d),y=2*d*g,v=2*Math.sqrt(p),x=h/g;return(y*m+g*h*(m-v)+(4*p*d-h*h)*Math.log((2*g+x+m)/(x+v)))/(4*y)}static curveTo(e,r,i,n,s){let o=s[s.length-2],a=s[s.length-1],l=_s._segmentsCount(ga.curveLength(o,a,e,r,i,n)),c=0,u=0;for(let d=1;d<=l;++d){let h=d/l;c=o+(e-o)*h,u=a+(r-a)*h,s.push(c+(e+(i-e)*h-c)*h,u+(r+(n-r)*h-u)*h)}}};var ou={[pr.POLY]:w1,[pr.CIRC]:pa,[pr.ELIP]:pa,[pr.RECT]:y3,[pr.RREC]:v3},x3=[],T1=[];var gl=class{constructor(e,r=null,i=null,n=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=i,this.fillStyle=r,this.matrix=n,this.type=e.type}clone(){return new gl(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}};var au=new Ne,HT=class extends o1{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new _o,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),T1.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){let e=this.batches[t];e.reset(),x3.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,r=null,i=null){let n=new gl(t,e,r,i);return this.graphicsData.push(n),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;let r=new gl(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){let e=this.graphicsData;for(let r=0;r<e.length;++r){let i=e[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(t,au):au.copyFrom(t),i.shape.contains(au.x,au.y))){let n=!1;if(i.holes){for(let s=0;s<i.holes.length;s++)if(i.holes[s].shape.contains(au.x,au.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;let t=this.uvs,e=this.graphicsData,r=null,i=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],i=r.style);for(let a=this.shapeIndex;a<e.length;a++){this.shapeIndex++;let l=e[a],c=l.fillStyle,u=l.lineStyle;ou[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(c.visible||u.visible)&&this.processHoles(l.holes);for(let h=0;h<2;h++){let p=h===0?c:u;if(!p.visible)continue;let m=p.texture.baseTexture,g=this.indices.length,y=this.points.length/2;m.wrapMode=bn.REPEAT,h===0?this.processFill(l):this.processLine(l);let v=this.points.length/2-y;v!==0&&(r&&!this._compareStyles(i,p)&&(r.end(g,y),r=null),r||(r=x3.pop()||new E1,r.begin(p,g,y),this.batches.push(r),i=p),this.addUvs(this.points,t,p.texture,y,v,p.matrix))}}let n=this.indices.length,s=this.points.length/2;if(r&&r.end(n,s),this.batches.length===0){this.batchable=!0;return}let o=s>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){let r=this.graphicsData[t],i=r.fillStyle,n=r.lineStyle;if(i&&!i.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);let t=this.batches;for(let e=0,r=t.length;e<r;e++){let i=t[e];for(let n=0;n<i.size;n++){let s=i.start+n;this.indicesUint16[s]=this.indicesUint16[s]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;let t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<HT.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++Le._globalBatch;for(let u=0;u<this.drawCalls.length;u++)this.drawCalls[u].texArray.clear(),T1.push(this.drawCalls[u]);this.drawCalls.length=0;let e=this.colors,r=this.textureIds,i=T1.pop();i||(i=new nl,i.texArray=new al),i.texArray.count=0,i.start=0,i.size=0,i.type=_n.TRIANGLES;let n=0,s=null,o=0,a=!1,l=_n.TRIANGLES,c=0;this.drawCalls.push(i);for(let u=0;u<this.batches.length;u++){let d=this.batches[u],h=8,p=d.style,m=p.texture.baseTexture;a!==!!p.native&&(a=!!p.native,l=a?_n.LINES:_n.TRIANGLES,s=null,n=h,t++),s!==m&&(s=m,m._batchEnabled!==t&&(n===h&&(t++,n=0,i.size>0&&(i=T1.pop(),i||(i=new nl,i.texArray=new al),this.drawCalls.push(i)),i.start=c,i.size=0,i.texArray.count=0,i.type=l),m.touched=1,m._batchEnabled=t,m._batchLocation=n,m.wrapMode=bn.REPEAT,i.texArray.elements[i.texArray.count++]=m,n++)),i.size+=d.size,c+=d.size,o=m._batchLocation,this.addColors(e,p.color,p.alpha,d.attribSize,d.attribStart),this.addTextureIds(r,o,d.attribSize,d.attribStart)}Le._globalBatch=t,this.packAttributes()}packAttributes(){let t=this.points,e=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(t.length*3*4),s=new Float32Array(n),o=new Uint32Array(n),a=0;for(let l=0;l<t.length/2;l++)s[a++]=t[l*2],s[a++]=t[l*2+1],s[a++]=e[l*2],s[a++]=e[l*2+1],o[a++]=r[l],s[a++]=i[l];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?w1.triangulate(t,this):ou[t.type].triangulate(t,this)}processLine(t){su(t,this);for(let e=0;e<t.holes.length;e++)su(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){let r=t[e];ou[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){let t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let r=0;r<t.length/2;r++){let i=t[r*2],n=t[r*2+1];t[r*2]=e.a*i+e.c*n+e.tx,t[r*2+1]=e.b*i+e.d*n+e.ty}}addColors(t,e,r,i,n=0){let s=bt.shared.setValue(e).toLittleEndianNumber(),o=bt.shared.setValue(s).toPremultiplied(r);t.length=Math.max(t.length,n+i);for(let a=0;a<i;a++)t[n+a]=o}addTextureIds(t,e,r,i=0){t.length=Math.max(t.length,i+r);for(let n=0;n<r;n++)t[i+n]=e}addUvs(t,e,r,i,n,s=null){let o=0,a=e.length,l=r.frame;for(;o<n;){let u=t[(i+o)*2],d=t[(i+o)*2+1];if(s){let h=s.a*u+s.c*d+s.tx;d=s.b*u+s.d*d+s.ty,u=h}o++,e.push(u/l.width,d/l.height)}let c=r.baseTexture;(l.width<c.width||l.height<c.height)&&this.adjustUvs(e,r,a,n)}adjustUvs(t,e,r,i){let n=e.baseTexture,s=1e-6,o=r+i*2,a=e.frame,l=a.width/n.width,c=a.height/n.height,u=a.x/a.width,d=a.y/a.height,h=Math.floor(t[r]+s),p=Math.floor(t[r+1]+s);for(let m=r+2;m<o;m+=2)h=Math.min(h,Math.floor(t[m]+s)),p=Math.min(p,Math.floor(t[m+1]+s));u-=h,d-=p;for(let m=r;m<o;m+=2)t[m]=(t[m]+u)*l,t[m+1]=(t[m+1]+d)*c}},Dh=HT;Dh.BATCHABLE_SIZE=100;var ya=class{constructor(){this.color=16777215,this.alpha=1,this.texture=be.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){let e=new ya;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=be.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}};var A1=class extends ya{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=tt.BUTT,this.join=Yt.MITER,this.miterLimit=10}clone(){let e=new A1;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}};var kg={},Fh=class extends st{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new ya,this._lineStyle=new A1,this._matrix=null,this._holeMode=!1,this.state=hi.for2d(),this._geometry=t||new Dh,this._geometry.refCount++,this._transformID=-1,this._tintColor=new bt(16777215),this.blendMode=We.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Fh(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,r,i=.5,n=!1){return typeof t=="number"&&(t={width:t,color:e,alpha:r,alignment:i,native:n}),this.lineTextureStyle(t)}lineTextureStyle(t){let e={width:0,texture:be.WHITE,color:t?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:tt.BUTT,join:Yt.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();let r=t.width>0&&t.alpha>0;return r?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:r},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){let t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Ei,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Ei,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);let r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return(i!==t||n!==e)&&r.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,r,i){this._initCurve();let n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),ga.curveTo(t,e,r,i,n),this}bezierCurveTo(t,e,r,i,n,s){return this._initCurve(),ma.curveTo(t,e,r,i,n,s,this.currentPath.points),this}arcTo(t,e,r,i,n){this._initCurve(t,e);let s=this.currentPath.points,o=ml.curveTo(t,e,r,i,n,s);if(o){let{cx:a,cy:l,radius:c,startAngle:u,endAngle:d,anticlockwise:h}=o;this.arc(a,l,c,u,d,h)}return this}arc(t,e,r,i,n,s=!1){if(i===n)return this;if(!s&&n<=i?n+=ol:s&&i<=n&&(i+=ol),n-i===0)return this;let a=t+Math.cos(i)*r,l=e+Math.sin(i)*r,c=this._geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){let d=Math.abs(u[u.length-2]-a),h=Math.abs(u[u.length-1]-l);d<c&&h<c||u.push(a,l)}else this.moveTo(a,l),u=this.currentPath.points;return ml.arc(a,l,t,e,r,i,n,s,u),this}beginFill(t=0,e){return this.beginTextureFill({texture:be.WHITE,color:t,alpha:e})}normalizeColor(t){let e=bt.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){let e={texture:be.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();let r=t.alpha>0;return r?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:r},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,r,i){return this.drawShape(new Re(t,e,r,i))}drawRoundedRect(t,e,r,i,n){return this.drawShape(new l1(t,e,r,i,n))}drawCircle(t,e,r){return this.drawShape(new vo(t,e,r))}drawEllipse(t,e,r,i){return this.drawShape(new a1(t,e,r,i))}drawPolygon(...t){let e,r=!0,i=t[0];i.points?(r=i.closeStroke,e=i.points):Array.isArray(t[0])?e=t[0]:e=t;let n=new Ei(e);return n.closeStroke=r,this.drawShape(n),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){let t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===pr.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();let e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){let t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(let i=0;i<r;i++){let n=t.batches[i],s=n.style.color,o=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),a=new Float32Array(t.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),l=new Uint16Array(t.indicesUint16.buffer,n.start*2,n.size),c={vertexData:o,blendMode:e,indices:l,uvs:a,_batchRGB:bt.shared.setValue(s).toRgbArray(),_tintRGB:s,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[i]=c}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,r=this.batches.length;e<r;e++){let i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}}_renderDirect(t){let e=this._resolveDirectShader(t),r=this._geometry,i=this.worldAlpha,n=e.uniforms,s=r.drawCalls;n.translationMatrix=this.transform.worldTransform,bt.shared.setValue(this._tintColor).premultiply(i).toArray(n.tint),t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(let o=0,a=s.length;o<a;o++)this._renderDrawCallDirect(t,r.drawCalls[o])}_renderDrawCallDirect(t,e){let{texArray:r,type:i,size:n,start:s}=e,o=r.count;for(let a=0;a<o;a++)t.texture.bind(r.elements[a],a);t.geometry.draw(i,n,s)}_resolveDirectShader(t){let e=this.shader,r=this.pluginName;if(!e){if(!kg[r]){let{maxTextures:i}=t.plugins[r],n=new Int32Array(i);for(let a=0;a<i;a++)n[a]=a;let s={tint:new Float32Array([1,1,1,1]),translationMatrix:new gt,default:pi.from({uSamplers:n},!0)},o=t.plugins[r]._shader.program;kg[r]=new mi(o,s)}e=kg[r]}return e}_calculateBounds(){this.finishPoly();let t=this._geometry;if(!t.graphicsData.length)return;let{minX:e,minY:r,maxX:i,maxY:n}=t.bounds;this._bounds.addFrame(this.transform,e,r,i,n)}containsPoint(t){return this.worldTransform.applyInverse(t,Fh._TEMP_POINT),this._geometry.containsPoint(Fh._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){let e=this.batches[t];e._tintRGB=bt.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){let t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;let e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,s=e.d,o=e.tx,a=e.ty,l=this._geometry.points,c=this.vertexData,u=0;for(let d=0;d<l.length;d+=2){let h=l[d],p=l[d+1];c[u++]=r*h+n*p+o,c[u++]=s*p+i*h+a}}closePath(){let t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}},it=Fh;it.curves=_s;it._TEMP_POINT=new Ne;var $T={buildPoly:w1,buildCircle:pa,buildRectangle:y3,buildRoundedRectangle:v3,buildLine:su,ArcUtils:ml,BezierUtils:ma,QuadraticUtils:ga,BatchPart:E1,FILL_COMMANDS:ou,BATCH_POOL:x3,DRAW_CALL_POOL:T1};var _3=class{constructor(e,r){this.uvBuffer=e,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;let r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}};var Ig=new Ne,jT=new Ei,VT=class extends st{constructor(t,e,r,i=_n.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=r||hi.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=ue.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){let e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===_n.TRIANGLES&&e.length<VT.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){let e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){let e=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;let i=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[i]),t.plugins[i].render(this)}calculateVertices(){let e=this.geometry.buffers[0],r=e.data,i=e._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));let n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,l=n.d,c=n.tx,u=n.ty,d=this.vertexData;for(let h=0;h<d.length/2;h++){let p=r[h*2],m=r[h*2+1];d[h*2]=s*p+a*m+c,d[h*2+1]=o*p+l*m+u}if(this._roundPixels){let h=ue.RESOLUTION;for(let p=0;p<d.length;++p)d[p]=Math.round(d[p]*h)/h}this.vertexDirty=i}calculateUvs(){let t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new _3(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Ig);let e=this.geometry.getBuffer("aVertexPosition").data,r=jT.points,i=this.geometry.getIndex().data,n=i.length,s=this.drawMode===4?3:1;for(let o=0;o+2<n;o+=s){let a=i[o]*2,l=i[o+1]*2,c=i[o+2]*2;if(r[0]=e[a],r[1]=e[a+1],r[2]=e[l],r[3]=e[l+1],r[4]=e[c],r[5]=e[c+1],jT.contains(Ig.x,Ig.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}},qs=VT;qs.BATCHABLE_SIZE=100;var va=class extends wi{constructor(e,r,i){super();let n=new rr(e),s=new rr(r,!0),o=new rr(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,Ge.FLOAT).addAttribute("aTextureCoord",s,2,!1,Ge.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}};var XT=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`;var WT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;var bs=class extends mi{constructor(e,r){let i={uSampler:e,alpha:1,uTextureMatrix:gt.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(i,r.uniforms),super(r.program||Si.from(WT,XT),i),this._colorDirty=!1,this.uvMatrix=new fl(e),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new bt(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;let r=this.texture.baseTexture.alphaMode;bt.shared.setValue(this._tintColor).premultiply(this._alpha,r).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}};var b3=class extends va{constructor(e=200,r,i=0){super(new Float32Array(r.length*4),new Float32Array(r.length*4),new Uint16Array((r.length-1)*6)),this.points=r,this._width=e,this.textureScale=i,this.build()}get width(){return this._width}build(){let e=this.points;if(!e)return;let r=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),n=this.getIndex();if(e.length<1)return;r.data.length/4!==e.length&&(r.data=new Float32Array(e.length*4),i.data=new Float32Array(e.length*4),n.data=new Uint16Array((e.length-1)*6));let s=i.data,o=n.data;s[0]=0,s[1]=0,s[2]=0,s[3]=1;let a=0,l=e[0],c=this._width*this.textureScale,u=e.length;for(let h=0;h<u;h++){let p=h*4;if(this.textureScale>0){let m=l.x-e[h].x,g=l.y-e[h].y,y=Math.sqrt(m*m+g*g);l=e[h],a+=y/c}else a=h/(u-1);s[p]=a,s[p+1]=0,s[p+2]=a,s[p+3]=1}let d=0;for(let h=0;h<u-1;h++){let p=h*2;o[d++]=p,o[d++]=p+1,o[d++]=p+2,o[d++]=p+2,o[d++]=p+1,o[d++]=p+3}i.update(),n.update(),this.updateVertices()}updateVertices(){let e=this.points;if(e.length<1)return;let r=e[0],i,n=0,s=0,o=this.buffers[0].data,a=e.length,l=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let c=0;c<a;c++){let u=e[c],d=c*4;c<e.length-1?i=e[c+1]:i=u,s=-(i.x-r.x),n=i.y-r.y;let h=(1-c/(a-1))*10;h>1&&(h=1);let p=Math.sqrt(n*n+s*s);p<1e-6?(n=0,s=0):(n/=p,s/=p,n*=l,s*=l),o[d]=u.x+n,o[d+1]=u.y+s,o[d+2]=u.x-n,o[d+3]=u.y-s,r=u}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}};var w3=class extends qs{constructor(e,r,i=0){let n=new b3(e.height,r,i),s=new bs(e);i>0&&(e.baseTexture.wrapMode=bn.REPEAT),super(n,s),this.autoUpdate=!0}_render(e){let r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),super._render(e)}};var E3=class extends st{constructor(e=1500,r,i=16384,n=!1){super();let s=16384;i>s&&(i=s),this._properties=[!1,!0,!1,!1,!1],this._maxSize=e,this._batchSize=i,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=We.NORMAL,this.autoResize=n,this.roundPixels=!0,this.baseTexture=null,this.setProperties(r),this._tintColor=new bt(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintColor.toRgbArray(this.tintRgb)}render(e){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",()=>this.onChildrenChange(0))),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))}onChildrenChange(e){let r=Math.floor(e/this._batchSize);for(;this._bufferUpdateIDs.length<r;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[r]=++this._updateID}dispose(){if(this._buffers){for(let e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}}destroy(e){super.destroy(e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}};var S3=class{constructor(e,r,i){this.geometry=new wi,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<e.length;++n){let s=e[n];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||Ge.FLOAT,offset:s.offset},r[n]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){let e=this.geometry,r=0;this.indexBuffer=new rr(he.createIndicesForQuads(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){let a=this.dynamicProperties[o];a.offset=r,r+=a.size,this.dynamicStride+=a.size}let i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new rr(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){let a=this.staticProperties[o];a.offset=n,n+=a.size,this.staticStride+=a.size}let s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new rr(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){let a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===Ge.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){let a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===Ge.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,r,i){for(let n=0;n<this.dynamicProperties.length;n++){let s=this.dynamicProperties[n];s.uploadFunction(e,r,i,s.type===Ge.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,r,i){for(let n=0;n<this.staticProperties.length;n++){let s=this.staticProperties[n];s.uploadFunction(e,r,i,s.type===Ge.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}};var qT=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`;var YT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;var T3=class extends Hs{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new gt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Ge.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=mi.from(YT,qT,{}),this.state=hi.for2d()}render(e){let r=e.children,i=e._maxSize,n=e._batchSize,s=this.renderer,o=r.length;if(o===0)return;o>i&&!e.autoResize&&(o=i);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));let l=r[0]._texture.baseTexture,c=l.alphaMode>0;this.state.blendMode=he.correctBlendMode(e.blendMode,c),s.state.set(this.state);let u=s.gl,d=e.worldTransform.copyTo(this.tempMatrix);d.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=bt.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,c).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let h=!1;for(let p=0,m=0;p<o;p+=n,m+=1){let g=o-p;g>n&&(g=n),m>=a.length&&a.push(this._generateOneMoreBuffer(e));let y=a[m];y.uploadDynamic(r,p,g);let v=e._bufferUpdateIDs[m]||0;h=h||y._updateID<v,h&&(y._updateID=e._updateID,y.uploadStatic(r,p,g)),s.geometry.bind(y.geometry),u.drawElements(u.TRIANGLES,g*6,u.UNSIGNED_SHORT,0)}}generateBuffers(e){let r=[],i=e._maxSize,n=e._batchSize,s=e._properties;for(let o=0;o<i;o+=n)r.push(new S3(this.properties,s,n));return r}_generateOneMoreBuffer(e){let r=e._batchSize,i=e._properties;return new S3(this.properties,i,r)}uploadVertices(e,r,i,n,s,o){let a=0,l=0,c=0,u=0;for(let d=0;d<i;++d){let h=e[r+d],p=h._texture,m=h.scale.x,g=h.scale.y,y=p.trim,v=p.orig;y?(l=y.x-h.anchor.x*v.width,a=l+y.width,u=y.y-h.anchor.y*v.height,c=u+y.height):(a=v.width*(1-h.anchor.x),l=v.width*-h.anchor.x,c=v.height*(1-h.anchor.y),u=v.height*-h.anchor.y),n[o]=l*m,n[o+1]=u*g,n[o+s]=a*m,n[o+s+1]=u*g,n[o+s*2]=a*m,n[o+s*2+1]=c*g,n[o+s*3]=l*m,n[o+s*3+1]=c*g,o+=s*4}}uploadPosition(e,r,i,n,s,o){for(let a=0;a<i;a++){let l=e[r+a].position;n[o]=l.x,n[o+1]=l.y,n[o+s]=l.x,n[o+s+1]=l.y,n[o+s*2]=l.x,n[o+s*2+1]=l.y,n[o+s*3]=l.x,n[o+s*3+1]=l.y,o+=s*4}}uploadRotation(e,r,i,n,s,o){for(let a=0;a<i;a++){let l=e[r+a].rotation;n[o]=l,n[o+s]=l,n[o+s*2]=l,n[o+s*3]=l,o+=s*4}}uploadUvs(e,r,i,n,s,o){for(let a=0;a<i;++a){let l=e[r+a]._texture._uvs;l?(n[o]=l.x0,n[o+1]=l.y0,n[o+s]=l.x1,n[o+s+1]=l.y1,n[o+s*2]=l.x2,n[o+s*2+1]=l.y2,n[o+s*3]=l.x3,n[o+s*3+1]=l.y3,o+=s*4):(n[o]=0,n[o+1]=0,n[o+s]=0,n[o+s+1]=0,n[o+s*2]=0,n[o+s*2+1]=0,n[o+s*3]=0,n[o+s*3+1]=0,o+=s*4)}}uploadTint(e,r,i,n,s,o){for(let a=0;a<i;++a){let l=e[r+a],c=bt.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);n[o]=c,n[o+s]=c,n[o+s*2]=c,n[o+s*3]=c,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}};T3.extension={name:"particle",type:me.RendererPlugin};_e.add(T3);var yl=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(yl||{});var Oh={willReadFrequently:!0},Xe=class{static get experimentalLetterSpacingSupported(){let t=Xe._experimentalLetterSpacingSupported;if(t!==void 0){let e=ue.ADAPTER.getCanvasRenderingContext2D().prototype;t=Xe._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,r,i,n,s,o,a,l){this.text=t,this.style=e,this.width=r,this.height=i,this.lines=n,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=l}static measureText(t,e,r,i=Xe._canvas){r=r??e.wordWrap;let n=e.toFontString(),s=Xe.measureFont(n);s.fontSize===0&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);let o=i.getContext("2d",Oh);o.font=n;let l=(r?Xe.wordWrap(t,e,i):t).split(/(?:\r\n|\r|\n)/),c=new Array(l.length),u=0;for(let m=0;m<l.length;m++){let g=Xe._measureText(l[m],e.letterSpacing,o);c[m]=g,u=Math.max(u,g)}let d=u+e.strokeThickness;e.dropShadow&&(d+=e.dropShadowDistance);let h=e.lineHeight||s.fontSize+e.strokeThickness,p=Math.max(h,s.fontSize+e.strokeThickness*2)+(l.length-1)*(h+e.leading);return e.dropShadow&&(p+=e.dropShadowDistance),new Xe(t,e,d,p,l,c,h+e.leading,u,s)}static _measureText(t,e,r){let i=!1;Xe.experimentalLetterSpacingSupported&&(Xe.experimentalLetterSpacing?(r.letterSpacing=`${e}px`,r.textLetterSpacing=`${e}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let n=r.measureText(t).width;return n>0&&(i?n-=e:n+=(Xe.graphemeSegmenter(t).length-1)*e),n}static wordWrap(t,e,r=Xe._canvas){let i=r.getContext("2d",Oh),n=0,s="",o="",a=Object.create(null),{letterSpacing:l,whiteSpace:c}=e,u=Xe.collapseSpaces(c),d=Xe.collapseNewlines(c),h=!u,p=e.wordWrapWidth+l,m=Xe.tokenize(t);for(let g=0;g<m.length;g++){let y=m[g];if(Xe.isNewline(y)){if(!d){o+=Xe.addLine(s),h=!u,s="",n=0;continue}y=" "}if(u){let x=Xe.isBreakingSpace(y),_=Xe.isBreakingSpace(s[s.length-1]);if(x&&_)continue}let v=Xe.getFromCache(y,l,a,i);if(v>p)if(s!==""&&(o+=Xe.addLine(s),s="",n=0),Xe.canBreakWords(y,e.breakWords)){let x=Xe.wordWrapSplit(y);for(let _=0;_<x.length;_++){let b=x[_],w=b,E=1;for(;x[_+E];){let T=x[_+E];if(!Xe.canBreakChars(w,T,y,_,e.breakWords))b+=T;else break;w=T,E++}_+=E-1;let A=Xe.getFromCache(b,l,a,i);A+n>p&&(o+=Xe.addLine(s),h=!1,s="",n=0),s+=b,n+=A}}else{s.length>0&&(o+=Xe.addLine(s),s="",n=0);let x=g===m.length-1;o+=Xe.addLine(y,!x),h=!1,s="",n=0}else v+n>p&&(h=!1,o+=Xe.addLine(s),s="",n=0),(s.length>0||!Xe.isBreakingSpace(y)||h)&&(s+=y,n+=v)}return o+=Xe.addLine(s,!1),o}static addLine(t,e=!0){return t=Xe.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,r,i){let n=r[t];return typeof n!="number"&&(n=Xe._measureText(t,e,i)+e,r[t]=n),n}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){let r=t[e];if(!Xe.isBreakingSpace(r))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:Xe._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:Xe._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){let e=[],r="";if(typeof t!="string")return e;for(let i=0;i<t.length;i++){let n=t[i],s=t[i+1];if(Xe.isBreakingSpace(n,s)||Xe.isNewline(n)){r!==""&&(e.push(r),r=""),e.push(n);continue}r+=n}return r!==""&&e.push(r),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,r,i,n){return!0}static wordWrapSplit(t){return Xe.graphemeSegmenter(t)}static measureFont(t){if(Xe._fonts[t])return Xe._fonts[t];let e={ascent:0,descent:0,fontSize:0},r=Xe._canvas,i=Xe._context;i.font=t;let n=Xe.METRICS_STRING+Xe.BASELINE_SYMBOL,s=Math.ceil(i.measureText(n).width),o=Math.ceil(i.measureText(Xe.BASELINE_SYMBOL).width),a=Math.ceil(Xe.HEIGHT_MULTIPLIER*o);if(o=o*Xe.BASELINE_MULTIPLIER|0,s===0||a===0)return Xe._fonts[t]=e,e;r.width=s,r.height=a,i.fillStyle="#f00",i.fillRect(0,0,s,a),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,o);let l=i.getImageData(0,0,s,a).data,c=l.length,u=s*4,d=0,h=0,p=!1;for(d=0;d<o;++d){for(let m=0;m<u;m+=4)if(l[h+m]!==255){p=!0;break}if(!p)h+=u;else break}for(e.ascent=o-d,h=c-u,p=!1,d=a;d>o;--d){for(let m=0;m<u;m+=4)if(l[h+m]!==255){p=!0;break}if(!p)h-=u;else break}return e.descent=d-o,e.fontSize=e.ascent+e.descent,Xe._fonts[t]=e,e}static clearMetrics(t=""){t?delete Xe._fonts[t]:Xe._fonts={}}static get _canvas(){if(!Xe.__canvas){let t;try{let e=new OffscreenCanvas(0,0);if(e.getContext("2d",Oh)?.measureText)return Xe.__canvas=e,e;t=ue.ADAPTER.createCanvas()}catch{t=ue.ADAPTER.createCanvas()}t.width=t.height=10,Xe.__canvas=t}return Xe.__canvas}static get _context(){return Xe.__context||(Xe.__context=Xe._canvas.getContext("2d",Oh)),Xe.__context}},Jr=Xe;Jr.METRICS_STRING="|\xC9q\xC5";Jr.BASELINE_SYMBOL="M";Jr.BASELINE_MULTIPLIER=1.4;Jr.HEIGHT_MULTIPLIER=2;Jr.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){let t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})();Jr.experimentalLetterSpacing=!1;Jr._fonts={};Jr._newlines=[10,13];Jr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var nB=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],A3=class{constructor(t){this.styleID=0,this.reset(),Pg(this,t,t)}clone(){let t={};return Pg(t,this,A3.defaultStyle),new A3(t)}reset(){Pg(this,A3.defaultStyle,A3.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){let e=Mg(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){let e=Mg(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){sB(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){let e=Mg(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){let t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let r=e.length-1;r>=0;r--){let i=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!nB.includes(i)&&(i=`"${i}"`),e[r]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}},gi=A3;gi.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:yl.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function Mg(t){let e=bt.shared;return Array.isArray(t)?t.map(r=>e.setValue(r).toHex()):e.setValue(t).toHex()}function sB(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}function Pg(t,e,r){for(let i in r)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i]}var oB={texture:!0,children:!1,baseTexture:!0},Rg=class extends ir{constructor(t,e,r){let i=!1;r||(r=ue.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;let n=be.from(r);n.orig=new Re,n.trim=new Re,super(n),this._ownCanvas=i,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=Rg.defaultResolution??ue.RESOLUTION,this._autoResolution=Rg.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return Jr.experimentalLetterSpacing}static set experimentalLetterSpacing(t){he.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Jr.experimentalLetterSpacing=t}updateText(t){let e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();let r=this.context,i=Jr.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=i.width,s=i.height,o=i.lines,a=i.lineHeight,l=i.lineWidths,c=i.maxLineWidth,u=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,s)+e.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=e.strokeThickness,r.textBaseline=e.textBaseline,r.lineJoin=e.lineJoin,r.miterLimit=e.miterLimit;let d,h,p=e.dropShadow?2:1;for(let m=0;m<p;++m){let g=e.dropShadow&&m===0,y=g?Math.ceil(Math.max(1,s)+e.padding*2):0,v=y*this._resolution;if(g){r.fillStyle="black",r.strokeStyle="black";let _=e.dropShadowColor,b=e.dropShadowBlur*this._resolution,w=e.dropShadowDistance*this._resolution;r.shadowColor=bt.shared.setValue(_).setAlpha(e.dropShadowAlpha).toRgbaString(),r.shadowBlur=b,r.shadowOffsetX=Math.cos(e.dropShadowAngle)*w,r.shadowOffsetY=Math.sin(e.dropShadowAngle)*w+v}else r.fillStyle=this._generateFillStyle(e,o,i),r.strokeStyle=e.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let x=(a-u.fontSize)/2;a-u.fontSize<0&&(x=0);for(let _=0;_<o.length;_++)d=e.strokeThickness/2,h=e.strokeThickness/2+_*a+u.ascent+x,e.align==="right"?d+=c-l[_]:e.align==="center"&&(d+=(c-l[_])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(o[_],d+e.padding,h+e.padding-y,!0),e.fill&&this.drawLetterSpacing(o[_],d+e.padding,h+e.padding-y)}this.updateTexture()}drawLetterSpacing(t,e,r,i=!1){let s=this._style.letterSpacing,o=!1;if(Jr.experimentalLetterSpacingSupported&&(Jr.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){i?this.context.strokeText(t,e,r):this.context.fillText(t,e,r);return}let a=e,l=Jr.graphemeSegmenter(t),c=this.context.measureText(t).width,u=0;for(let d=0;d<l.length;++d){let h=l[d];i?this.context.strokeText(h,a,r):this.context.fillText(h,a,r);let p="";for(let m=d+1;m<l.length;++m)p+=l[m];u=this.context.measureText(p).width,a+=c-u+s,c=u}}updateTexture(){let t=this.canvas;if(this._style.trim){let s=he.trimCanvas(t);s.data&&(t.width=s.width,t.height=s.height,this.context.putImageData(s.data,0,0))}let e=this._texture,r=this._style,i=r.trim?0:r.padding,n=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-i,e.trim.y=-i,e.orig.width=e._frame.width-i*2,e.orig.height=e._frame.height-i*2,this._onTextureUpdate(),n.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,r){let i=t.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let n,s=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,a=this.canvas.width/this._resolution-s-o*2,l=this.canvas.height/this._resolution-s-o*2,c=i.slice(),u=t.fillGradientStops.slice();if(!u.length){let d=c.length+1;for(let h=1;h<d;++h)u.push(h/d)}if(c.unshift(i[0]),u.unshift(0),c.push(i[i.length-1]),u.push(1),t.fillGradientType===yl.LINEAR_VERTICAL){n=this.context.createLinearGradient(a/2,o,a/2,l+o);let d=r.fontProperties.fontSize+t.strokeThickness;for(let h=0;h<e.length;h++){let p=r.lineHeight*(h-1)+d,m=r.lineHeight*h,g=m;h>0&&p>m&&(g=(m+p)/2);let y=m+d,v=r.lineHeight*(h+1),x=y;h+1<e.length&&v<y&&(x=(y+v)/2);let _=(x-g)/l;for(let b=0;b<c.length;b++){let w=0;typeof u[b]=="number"?w=u[b]:w=b/c.length;let E=Math.min(1,Math.max(0,g/l+w*_));E=Number(E.toFixed(5)),n.addColorStop(E,c[b])}}}else{n=this.context.createLinearGradient(o,l/2,a+o,l/2);let d=c.length+1,h=1;for(let p=0;p<c.length;p++){let m;typeof u[p]=="number"?m=u[p]:m=h/d,n.addColorStop(m,c[p]),h++}}return n}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},oB,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);let e=he.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);let e=he.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof gi?this._style=t:this._style=new gi(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}},C1=Rg;C1.defaultAutoResolution=!0;var C3=class{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}};function aB(t,e){let r=!1;if(t?._textures?.length){for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof be){let n=t._textures[i].baseTexture;e.includes(n)||(e.push(n),r=!0)}}return r}function lB(t,e){if(t.baseTexture instanceof Le){let r=t.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function cB(t,e){if(t._texture&&t._texture instanceof be){let r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function uB(t,e){return e instanceof C1?(e.updateText(!0),!0):!1}function fB(t,e){if(e instanceof gi){let r=e.toFontString();return Jr.measureFont(r),!0}return!1}function dB(t,e){if(t instanceof C1){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);let r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function hB(t,e){return t instanceof gi?(e.includes(t)||e.push(t),!0):!1}var QT=class{constructor(t){this.limiter=new C3(QT.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(dB),this.registerFindHook(hB),this.registerFindHook(aB),this.registerFindHook(lB),this.registerFindHook(cB),this.registerUploadHook(uB),this.registerUploadHook(fB)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,Or.system.addOnce(this.tick,this,Vn.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){let t=this.queue[0],e=!1;if(t&&!t._destroyed){for(let r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)Or.system.addOnce(this.tick,this,Vn.UTILITY);else{this.ticking=!1;let t=this.completes.slice(0);this.completes.length=0;for(let e=0,r=t.length;e<r;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof st)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&Or.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}},k1=QT;k1.uploadsPerFrame=4;Object.defineProperties(ue,{UPLOADS_PER_FRAME:{get(){return k1.uploadsPerFrame},set(t){he.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),k1.uploadsPerFrame=t}}});function KT(t,e){return e instanceof Le?(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0):!1}function pB(t,e){if(!(e instanceof it))return!1;let{geometry:r}=e;e.finishPoly(),r.updateBatches();let{batches:i}=r;for(let n=0;n<i.length;n++){let{texture:s}=i[n].style;s&&KT(t,s.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function mB(t,e){return t instanceof it?(e.push(t),!0):!1}var k3=class extends k1{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(mB),this.registerUploadHook(KT),this.registerUploadHook(pB)}};k3.extension={name:"prepare",type:me.RendererSystem};_e.add(k3);var yCe=new Ne;var ZT=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`;var JT=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var eA=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`;var Ng=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var tA=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;var Lh=new gt,I3=class extends Hs{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new p1,this.state=hi.for2d()}contextChange(){let e=this.renderer,r={globals:e.globalUniforms};this.simpleShader=mi.from(Ng,tA,r),this.shader=e.context.webGLVersion>1?mi.from(JT,ZT,r):mi.from(Ng,eA,r)}render(e){let r=this.renderer,i=this.quad,n=i.vertices;n[0]=n[6]=e._width*-e.anchor.x,n[1]=n[3]=e._height*-e.anchor.y,n[2]=n[4]=e._width*(1-e.anchor.x),n[5]=n[7]=e._height*(1-e.anchor.y);let s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;n=i.uvs,n[0]=n[6]=-s,n[1]=n[3]=-o,n[2]=n[4]=1-s,n[5]=n[7]=1-o,i.invalidate();let a=e._texture,l=a.baseTexture,c=l.alphaMode>0,u=e.tileTransform.localTransform,d=e.uvMatrix,h=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;h&&(l._glTextures[r.CONTEXT_UID]?h=l.wrapMode!==bn.CLAMP:l.wrapMode===bn.CLAMP&&(l.wrapMode=bn.REPEAT));let p=h?this.simpleShader:this.shader,m=a.width,g=a.height,y=e._width,v=e._height;Lh.set(u.a*m/y,u.b*m/v,u.c*g/y,u.d*g/v,u.tx/y,u.ty/v),Lh.invert(),h?Lh.prepend(d.mapCoord):(p.uniforms.uMapCoord=d.mapCoord.toArray(!0),p.uniforms.uClampFrame=d.uClampFrame,p.uniforms.uClampOffset=d.uClampOffset),p.uniforms.uTransform=Lh.toArray(!0),p.uniforms.uColor=bt.shared.setValue(e.tint).premultiply(e.worldAlpha,c).toArray(p.uniforms.uColor),p.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),p.uniforms.uSampler=a,r.shader.bind(p),r.geometry.bind(i),this.state.blendMode=he.correctBlendMode(e.blendMode,c),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}};I3.extension={name:"tilingSprite",type:me.RendererPlugin};_e.add(I3);var M3=class{constructor(t,e,r=null){this.linkedSheets=[],this._texture=t instanceof be?t:null,this.baseTexture=t instanceof Le?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;let i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){let{scale:e}=this.data.meta,r=he.getResolutionOfUrl(t,null);return r===null&&(r=parseFloat(e??"1")),r!==1&&this.baseTexture.setResolution(r),r}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=M3.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t,r=M3.BATCH_SIZE;for(;e-t<r&&e<this._frameKeys.length;){let i=this._frameKeys[e],n=this._frames[i],s=n.frame;if(s){let o=null,a=null,l=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,c=new Re(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);n.rotated?o=new Re(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):o=new Re(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(a=new Re(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[i]=new be(this.baseTexture,o,c,a,n.rotated?2:0,n.anchor,n.borders),be.addToCache(this.textures[i],i)}e++}}_processAnimations(){let t=this.data.animations||{};for(let e in t){this.animations[e]=[];for(let r=0;r<t[e].length;r++){let i=t[e][r];this.animations[e].push(this.textures[i])}}}_parseComplete(){let t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*M3.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*M3.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){for(let e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}},P3=M3;P3.BATCH_SIZE=1e3;var gB=["jpg","png","jpeg","avif","webp"];function rA(t,e,r){let i={};if(t.forEach(n=>{i[n]=e}),Object.keys(e.textures).forEach(n=>{i[n]=e.textures[n]}),!r){let n=he.path.dirname(t[0]);e.linkedSheets.forEach((s,o)=>{let a=rA([`${n}/${e.data.meta.related_multi_packs[o]}`],s,!0);Object.assign(i,a)})}return i}var iA={extension:me.Asset,cache:{test:t=>t instanceof P3,getCacheableAssets:(t,e)=>rA(t,e,!1)},resolver:{test:t=>{let r=t.split("?")[0].split("."),i=r.pop(),n=r.pop();return i==="json"&&gB.includes(n)},parse:t=>{let e=t.split(".");return{resolution:parseFloat(ue.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:me.LoadParser,priority:Zr.Normal},async testParse(t,e){return he.path.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){let i=he.path.dirname(e.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let n=i+t.meta.image;n=b1(n,e.src);let o=(await r.load([n]))[n],a=new P3(o.baseTexture,t,e.src);await a.parse();let l=t?.meta?.related_multi_packs;if(Array.isArray(l)){let c=[];for(let d of l){if(typeof d!="string")continue;let h=i+d;e.data?.ignoreMultiPack||(h=b1(h,e.src),c.push(r.load({src:h,data:{ignoreMultiPack:!0}})))}let u=await Promise.all(c);a.linkedSheets=u,u.forEach(d=>{d.linkedSheets=[a].concat(a.linkedSheets.filter(h=>h!==d))})}return a},unload(t){t.destroy(!0)}}};_e.add(iA);var So=class{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}};var To=class{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){let r=e.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let s in r){let o=r[s].match(/^[a-z]+/gm)[0],a=r[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(let c in a){let u=a[c].split("="),d=u[0],h=u[1].replace(/"/gm,""),p=parseFloat(h),m=isNaN(p)?h:p;l[d]=m}i[o].push(l)}let n=new So;return i.info.forEach(s=>n.info.push({face:s.face,size:parseInt(s.size,10)})),i.common.forEach(s=>n.common.push({lineHeight:parseInt(s.lineHeight,10)})),i.page.forEach(s=>n.page.push({id:parseInt(s.id,10),file:s.file})),i.char.forEach(s=>n.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),i.kerning.forEach(s=>n.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),i.distanceField.forEach(s=>n.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),n}};var xa=class{static test(e){let r=e;return"getElementsByTagName"in r&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){let r=new So,i=e.getElementsByTagName("info"),n=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let c=0;c<i.length;c++)r.info.push({face:i[c].getAttribute("face"),size:parseInt(i[c].getAttribute("size"),10)});for(let c=0;c<n.length;c++)r.common.push({lineHeight:parseInt(n[c].getAttribute("lineHeight"),10)});for(let c=0;c<s.length;c++)r.page.push({id:parseInt(s[c].getAttribute("id"),10)||0,file:s[c].getAttribute("file")});for(let c=0;c<o.length;c++){let u=o[c];r.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(let c=0;c<a.length;c++)r.kerning.push({first:parseInt(a[c].getAttribute("first"),10),second:parseInt(a[c].getAttribute("second"),10),amount:parseInt(a[c].getAttribute("amount"),10)});for(let c=0;c<l.length;c++)r.distanceField.push({fieldType:l[c].getAttribute("fieldType"),distanceRange:parseInt(l[c].getAttribute("distanceRange"),10)});return r}};var _a=class{static test(e){return typeof e=="string"&&e.includes("<font>")?xa.test(ue.ADAPTER.parseXML(e)):!1}static parse(e){return xa.parse(ue.ADAPTER.parseXML(e))}};var Dg=[To,xa,_a];function Fg(t){for(let e=0;e<Dg.length;e++)if(Dg[e].test(t))return Dg[e];return null}function Og(t,e,r,i,n,s){let o=r.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a,l=r.dropShadow?r.dropShadowDistance:0,c=r.padding||0,u=t.width/i-l-c*2,d=t.height/i-l-c*2,h=o.slice(),p=r.fillGradientStops.slice();if(!p.length){let m=h.length+1;for(let g=1;g<m;++g)p.push(g/m)}if(h.unshift(o[0]),p.unshift(0),h.push(o[o.length-1]),p.push(1),r.fillGradientType===yl.LINEAR_VERTICAL){a=e.createLinearGradient(u/2,c,u/2,d+c);let m=0,y=(s.fontProperties.fontSize+r.strokeThickness)/d;for(let v=0;v<n.length;v++){let x=s.lineHeight*v;for(let _=0;_<h.length;_++){let b=0;typeof p[_]=="number"?b=p[_]:b=_/h.length;let w=x/d+b*y,E=Math.max(m,w);E=Math.min(E,1),a.addColorStop(E,h[_]),m=E}}}else{a=e.createLinearGradient(c,d/2,u+c,d/2);let m=h.length+1,g=1;for(let y=0;y<h.length;y++){let v;typeof p[y]=="number"?v=p[y]:v=g/m,a.addColorStop(v,h[y]),g++}}return a}function Lg(t,e,r,i,n,s,o){let a=r.text,l=r.fontProperties;e.translate(i,n),e.scale(s,s);let c=o.strokeThickness/2,u=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=Og(t,e,o,s,[a],r),e.strokeStyle=o.stroke,o.dropShadow){let d=o.dropShadowColor,h=o.dropShadowBlur*s,p=o.dropShadowDistance*s;e.shadowColor=bt.shared.setValue(d).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=h,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*p,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*p}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,c,u+r.lineHeight-l.descent),o.fill&&e.fillText(a,c,u+r.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function I1(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function R3(t){return Array.from?Array.from(t):t.split("")}function Bg(t){typeof t=="string"&&(t=[t]);let e=[];for(let r=0,i=t.length;r<i;r++){let n=t[r];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);let s=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...R3(n))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}var Ys=class{constructor(t,e,r){let[i]=t.info,[n]=t.common,[s]=t.page,[o]=t.distanceField,a=he.getResolutionOfUrl(s.file),l={};this._ownsTextures=r,this.font=i.face,this.size=i.size,this.lineHeight=n.lineHeight/a,this.chars={},this.pageTextures=l;for(let c=0;c<t.page.length;c++){let{id:u,file:d}=t.page[c];l[u]=e instanceof Array?e[c]:e[d],o?.fieldType&&o.fieldType!=="none"&&(l[u].baseTexture.alphaMode=$r.NO_PREMULTIPLIED_ALPHA,l[u].baseTexture.mipmap=oi.OFF)}for(let c=0;c<t.char.length;c++){let{id:u,page:d}=t.char[c],{x:h,y:p,width:m,height:g,xoffset:y,yoffset:v,xadvance:x}=t.char[c];h/=a,p/=a,m/=a,g/=a,y/=a,v/=a,x/=a;let _=new Re(h+l[d].frame.x/a,p+l[d].frame.y/a,m,g);this.chars[u]={xOffset:y,yOffset:v,xAdvance:x,kerning:{},texture:new be(l[d].baseTexture,_),page:d}}for(let c=0;c<t.kerning.length;c++){let{first:u,second:d,amount:h}=t.kerning[c];u/=a,d/=a,h/=a,this.chars[d]&&(this.chars[d].kerning[u]=h)}this.distanceFieldRange=o?.distanceRange,this.distanceFieldType=o?.fieldType?.toLowerCase()??"none"}destroy(){for(let t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(let t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,r){let i;if(t instanceof So)i=t;else{let s=Fg(t);if(!s)throw new Error("Unrecognized data format for font.");i=s.parse(t)}e instanceof be&&(e=[e]);let n=new Ys(i,e,r);return Ys.available[n.font]=n,n}static uninstall(t){let e=Ys.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete Ys.available[t]}static from(t,e,r){if(!t)throw new Error("[BitmapFont] Property `name` is required.");let{chars:i,padding:n,resolution:s,textureWidth:o,textureHeight:a,...l}=Object.assign({},Ys.defaultOptions,r),c=Bg(i),u=e instanceof gi?e:new gi(e),d=o,h=new So;h.info[0]={face:u.fontFamily,size:u.fontSize},h.common[0]={lineHeight:u.fontSize};let p=0,m=0,g,y,v,x=0,_=[],b=[];for(let E=0;E<c.length;E++){g||(g=ue.ADAPTER.createCanvas(),g.width=o,g.height=a,y=g.getContext("2d"),v=new Le(g,{resolution:s,...l}),_.push(v),b.push(new be(v)),h.page.push({id:b.length-1,file:""}));let A=c[E],T=Jr.measureText(A,u,!1,g),k=T.width,C=Math.ceil(T.height),I=Math.ceil((u.fontStyle==="italic"?2:1)*k);if(m>=a-C*s){if(m===0)throw new Error(`[BitmapFont] textureHeight ${a}px is too small (fontFamily: '${u.fontFamily}', fontSize: ${u.fontSize}px, char: '${A}')`);--E,g=null,y=null,v=null,m=0,p=0,x=0;continue}if(x=Math.max(C+T.fontProperties.descent,x),I*s+p>=d){if(p===0)throw new Error(`[BitmapFont] textureWidth ${o}px is too small (fontFamily: '${u.fontFamily}', fontSize: ${u.fontSize}px, char: '${A}')`);--E,m+=x*s,m=Math.ceil(m),p=0,x=0;continue}Lg(g,y,T,p,m,s,u);let P=I1(T.text);h.char.push({id:P,page:b.length-1,x:p/s,y:m/s,width:I,height:C,xoffset:0,yoffset:0,xadvance:k-(u.dropShadow?u.dropShadowDistance:0)-(u.stroke?u.strokeThickness:0)}),p+=(I+2*n)*s,p=Math.ceil(p)}for(let E=0,A=c.length;E<A;E++){let T=c[E];for(let k=0;k<A;k++){let C=c[k],I=y.measureText(T).width,P=y.measureText(C).width,M=y.measureText(T+C).width-(I+P);M&&h.kerning.push({first:I1(T),second:I1(C),amount:M})}}let w=new Ys(h,b,!0);return Ys.available[t]!==void 0&&Ys.uninstall(t),Ys.available[t]=w,w}},Lr=Ys;Lr.ALPHA=[["a","z"],["A","Z"]," "];Lr.NUMERIC=[["0","9"]];Lr.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Lr.ASCII=[[" ","~"]];Lr.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Ys.ALPHANUMERIC};Lr.available={};var nA=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`;var sA=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;var oA=[],aA=[],lA=[],cA=class extends st{constructor(t,e={}){super();let{align:r,tint:i,maxWidth:n,letterSpacing:s,fontName:o,fontSize:a}=Object.assign({},cA.styleDefaults,e);if(!Lr.available[o])throw new Error(`Missing BitmapFont "${o}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new bt(i),this._font=void 0,this._fontName=o,this._fontSize=a,this.text=t,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=s,this._anchor=new Pi(()=>{this.dirty=!0},this,0,0),this._roundPixels=ue.ROUND_PIXELS,this.dirty=!0,this._resolution=ue.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){let t=Lr.available[this._fontName],e=this.fontSize,r=e/t.size,i=new Ne,n=[],s=[],o=[],a=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",l=R3(a),c=this._maxWidth*t.size/e,u=t.distanceFieldType==="none"?oA:aA,d=null,h=0,p=0,m=0,g=-1,y=0,v=0,x=0,_=0;for(let C=0;C<l.length;C++){let I=l[C],P=I1(I);if(/(?:\s)/.test(I)&&(g=C,y=h,_++),I==="\r"||I===`
`){s.push(h),o.push(-1),p=Math.max(p,h),++m,++v,i.x=0,i.y+=t.lineHeight,d=null,_=0;continue}let N=t.chars[P];if(!N)continue;d&&N.kerning[d]&&(i.x+=N.kerning[d]);let M=lA.pop()||{texture:be.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ne};M.texture=N.texture,M.line=m,M.charCode=P,M.position.x=Math.round(i.x+N.xOffset+this._letterSpacing/2),M.position.y=Math.round(i.y+N.yOffset),M.prevSpaces=_,n.push(M),h=M.position.x+Math.max(N.xAdvance-N.xOffset,N.texture.orig.width),i.x+=N.xAdvance+this._letterSpacing,x=Math.max(x,N.yOffset+N.texture.height),d=P,g!==-1&&c>0&&i.x>c&&(++v,he.removeItems(n,1+g-v,1+C-g),C=g,g=-1,s.push(y),o.push(n.length>0?n[n.length-1].prevSpaces:0),p=Math.max(p,y),m++,i.x=0,i.y+=t.lineHeight,d=null,_=0)}let b=l[l.length-1];b!=="\r"&&b!==`
`&&(/(?:\s)/.test(b)&&(h=y),s.push(h),p=Math.max(p,h),o.push(-1));let w=[];for(let C=0;C<=m;C++){let I=0;this._align==="right"?I=p-s[C]:this._align==="center"?I=(p-s[C])/2:this._align==="justify"&&(I=o[C]<0?0:(p-s[C])/o[C]),w.push(I)}let E=n.length,A={},T=[],k=this._activePagesMeshData;u.push(...k);for(let C=0;C<E;C++){let I=n[C].texture,P=I.baseTexture.uid;if(!A[P]){let N=u.pop();if(!N){let D=new va,F,L;t.distanceFieldType==="none"?(F=new bs(be.EMPTY),L=We.NORMAL):(F=new bs(be.EMPTY,{program:Si.from(sA,nA),uniforms:{uFWidth:0}}),L=We.NORMAL_NPM);let B=new qs(D,F);B.blendMode=L,N={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:B,vertices:null,uvs:null,indices:null}}N.index=0,N.indexCount=0,N.vertexCount=0,N.uvsCount=0,N.total=0;let{_textureCache:M}=this;M[P]=M[P]||new be(I.baseTexture),N.mesh.texture=M[P],N.mesh.tint=this._tintColor.value,T.push(N),A[P]=N}A[P].total++}for(let C=0;C<k.length;C++)T.includes(k[C])||this.removeChild(k[C].mesh);for(let C=0;C<T.length;C++)T[C].mesh.parent!==this&&this.addChild(T[C].mesh);this._activePagesMeshData=T;for(let C in A){let I=A[C],P=I.total;if(!(I.indices?.length>6*P)||I.vertices.length<qs.BATCHABLE_SIZE*2)I.vertices=new Float32Array(4*2*P),I.uvs=new Float32Array(4*2*P),I.indices=new Uint16Array(6*P);else{let N=I.total,M=I.vertices;for(let D=N*4*2;D<M.length;D++)M[D]=0}I.mesh.size=6*P}for(let C=0;C<E;C++){let I=n[C],P=I.position.x+w[I.line]*(this._align==="justify"?I.prevSpaces:1);this._roundPixels&&(P=Math.round(P));let N=P*r,M=I.position.y*r,D=I.texture,F=A[D.baseTexture.uid],L=D.frame,B=D._uvs,O=F.index++;F.indices[O*6+0]=0+O*4,F.indices[O*6+1]=1+O*4,F.indices[O*6+2]=2+O*4,F.indices[O*6+3]=0+O*4,F.indices[O*6+4]=2+O*4,F.indices[O*6+5]=3+O*4,F.vertices[O*8+0]=N,F.vertices[O*8+1]=M,F.vertices[O*8+2]=N+L.width*r,F.vertices[O*8+3]=M,F.vertices[O*8+4]=N+L.width*r,F.vertices[O*8+5]=M+L.height*r,F.vertices[O*8+6]=N,F.vertices[O*8+7]=M+L.height*r,F.uvs[O*8+0]=B.x0,F.uvs[O*8+1]=B.y0,F.uvs[O*8+2]=B.x1,F.uvs[O*8+3]=B.y1,F.uvs[O*8+4]=B.x2,F.uvs[O*8+5]=B.y2,F.uvs[O*8+6]=B.x3,F.uvs[O*8+7]=B.y3}this._textWidth=p*r,this._textHeight=(i.y+t.lineHeight)*r;for(let C in A){let I=A[C];if(this.anchor.x!==0||this.anchor.y!==0){let D=0,F=this._textWidth*this.anchor.x,L=this._textHeight*this.anchor.y;for(let B=0;B<I.total;B++)I.vertices[D++]-=F,I.vertices[D++]-=L,I.vertices[D++]-=F,I.vertices[D++]-=L,I.vertices[D++]-=F,I.vertices[D++]-=L,I.vertices[D++]-=F,I.vertices[D++]-=L}this._maxLineHeight=x*r;let P=I.mesh.geometry.getBuffer("aVertexPosition"),N=I.mesh.geometry.getBuffer("aTextureCoord"),M=I.mesh.geometry.getIndex();P.data=I.vertices,N.data=I.uvs,M.data=I.indices,P.update(),N.update(),M.update()}for(let C=0;C<n.length;C++)lA.push(n[C]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);let{distanceFieldRange:e,distanceFieldType:r,size:i}=Lr.available[this._fontName];if(r!=="none"){let{a:n,b:s,c:o,d:a}=this.worldTransform,l=Math.sqrt(n*n+s*s),c=Math.sqrt(o*o+a*a),u=(Math.abs(l)+Math.abs(c))/2,d=this.fontSize/i,h=t._view.resolution;for(let p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=u*e*d*h}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){let t=Lr.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!Lr.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??Lr.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){let{_textureCache:e}=this,i=Lr.available[this._fontName].distanceFieldType==="none"?oA:aA;i.push(...this._activePagesMeshData);for(let n of this._activePagesMeshData)this.removeChild(n.mesh);this._activePagesMeshData=[],i.filter(n=>e[n.mesh.texture.baseTexture.uid]).forEach(n=>{n.mesh.texture=be.EMPTY});for(let n in e)e[n].destroy(),delete e[n];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}},lu=cA;lu.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};var yB=[".xml",".fnt"],uA={extension:{type:me.LoadParser,priority:Zr.Normal},name:"loadBitmapFont",test(t){return yB.includes(he.path.extname(t).toLowerCase())},async testParse(t){return To.test(t)||_a.test(t)},async parse(t,e,r){let i=To.test(t)?To.parse(t):_a.parse(t),{src:n}=e,{page:s}=i,o=[];for(let c=0;c<s.length;++c){let u=s[c].file,d=he.path.join(he.path.dirname(n),u);d=b1(d,n),o.push(d)}let a=await r.load(o),l=o.map(c=>a[c]);return Lr.install(i,l,!0)},async load(t,e){return(await ue.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};_e.add(uA);var cu=class extends gi{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new cu(Object.keys(cu.defaultOptions).reduce((e,r)=>({...e,[r]:t[r]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,t.refs===0&&(t.fontFace&&document.fonts.delete(t.fontFace),delete cu.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){let{availableFonts:r}=cu;if(r[t]){let i=r[t];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return ue.ADAPTER.fetch(t).then(i=>i.blob()).then(async i=>new Promise((n,s)=>{let o=URL.createObjectURL(i),a=new FileReader;a.onload=()=>n([o,a.result]),a.onerror=s,a.readAsDataURL(i)})).then(async([i,n])=>{let s=Object.assign({family:he.path.basename(t,he.path.extname(t)),weight:"normal",style:"normal",src:i,dataSrc:n,refs:1,originalUrl:t,fontFace:null},e);r[t]=s,this._fonts.push(s),this.styleID++;let o=new FontFace(s.family,`url(${s.src})`,{weight:s.weight,style:s.style});s.fontFace=o,await o.load(),document.fonts.add(o),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...t){let e=t.filter(r=>!this._overrides.includes(r));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){let e=t.filter(r=>this._overrides.includes(r));e.length>0&&(this._overrides=this._overrides.filter(r=>!e.includes(r)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,e)=>`${t}
            @font-face {
                font-family: "${e.family}";
                src: url('${e.dataSrc}');
                font-weight: ${e.weight};
                font-style: ${e.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=he.rgb2hex(t)),typeof t=="number"?he.hex2string(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor),e=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(e*255|0).toString(16).padStart(2,"0"));let n=`${r}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${n} ${t}`}reset(){Object.assign(this,cu.defaultOptions)}onBeforeDraw(){let{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){let{userAgent:t}=ue.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}},M1=cu;M1.availableFonts={};M1.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};var uu=class extends ir{constructor(t="",e={}){super(be.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;let r=new Image,i=be.from(r,{scaleMode:ue.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new Re,i.trim=new Re,this.texture=i;let n="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xhtml",o=document.createElementNS(n,"svg"),a=document.createElementNS(n,"foreignObject"),l=document.createElementNS(s,"div"),c=document.createElementNS(s,"style");a.setAttribute("width","10000"),a.setAttribute("height","10000"),a.style.overflow="hidden",o.appendChild(a),this.maxWidth=uu.defaultMaxWidth,this.maxHeight=uu.defaultMaxHeight,this._domElement=l,this._styleElement=c,this._svgRoot=o,this._foreignObject=a,this._foreignObject.appendChild(c),this._foreignObject.appendChild(l),this._image=r,this._loadImage=new Image,this._autoResolution=uu.defaultAutoResolution,this._resolution=uu.defaultResolution??ue.RESOLUTION,this.text=t,this.style=e}measureText(t){let{text:e,style:r,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:r.toCSS(i)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);let n=this._domElement.getBoundingClientRect();this._svgRoot.remove();let s=Math.min(this.maxWidth,Math.ceil(n.width)),o=Math.min(this.maxHeight,Math.ceil(n.height));return this._svgRoot.setAttribute("width",s.toString()),this._svgRoot.setAttribute("height",o.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(i)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:s+r.padding*2,height:o+r.padding*2}}async updateText(t=!0){let{style:e,_image:r,_loadImage:i}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;let{width:n,height:s}=this.measureText();r.width=i.width=Math.ceil(Math.max(1,n)),r.height=i.height=Math.ceil(Math.max(1,s)),this._loading||(this._loading=!0,await new Promise(o=>{i.onload=async()=>{await e.onBeforeDraw(),this._loading=!1,r.src=i.src,i.onload=null,i.src="",this.updateTexture(),o()};let a=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(a)}`}))}get source(){return this._image}updateTexture(){let{style:t,texture:e,_image:r,resolution:i}=this,{padding:n}=t,{baseTexture:s}=e;e.trim.width=e._frame.width=r.width/i,e.trim.height=e._frame.height=r.height/i,e.trim.x=-n,e.trim.y=-n,e.orig.width=e._frame.width-n*2,e.orig.height=e._frame.height-n*2,this._onTextureUpdate(),s.setRealSize(r.width,r.height,i),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},uu.defaultDestroyOptions,t),super.destroy(t);let e=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=e,this._svgRoot?.remove(),this._svgRoot=e,this._domElement?.remove(),this._domElement=e,this._foreignObject?.remove(),this._foreignObject=e,this._styleElement?.remove(),this._styleElement=e,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=e,this._image.src="",this._image=e}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);let e=he.sign(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);let e=he.sign(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&(t=t||{},t instanceof M1?(this.ownsStyle=!1,this._style=t):t instanceof gi?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=M1.from(t)):(this.ownsStyle=!0,this._style=new M1(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(t===""||t===null||t===void 0?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}},N3=uu;N3.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};N3.defaultMaxWidth=2024;N3.defaultMaxHeight=2024;N3.defaultAutoResolution=!0;function Bh(){let t;function e(i){let n=i.issueKey;return i.replacements=i.replacements||{},i.replacements.default=S.html("inspector.unknown"),S.html(`QA.improveOSM.error_types.${n}.title`,i.replacements)}function r(i){let n=16777215,s=K.improveOSM;s&&(n=s.getColor(t?.itemType));let o=i.selectAll(".qa-header").data(t?[t]:[],c=>`${c.id}-${c.status||0}`);o.exit().remove();let a=o.enter().append("div").attr("class","qa-header"),l=a.append("div").attr("class","qa-header-icon").append("svg").attr("width","20px").attr("height","27px").attr("viewbox","0 0 20 27").attr("class",c=>`qaItem ${c.service}`);l.append("polygon").attr("fill",he.hex2string(n)).attr("stroke","#333").attr("points","16,3 4,3 1,6 1,17 4,20 7,20 10,27 13,20 16,20 19,17.033 19,6"),l.append("use").attr("class","icon-annotation").attr("width","13px").attr("height","13px").attr("transform","translate(3.5, 5)").attr("xlink:href",c=>c.icon?`#${c.icon}`:""),a.append("div").attr("class","qa-header-label").html(e)}return r.issue=function(i){return arguments.length?(t=i,r):t},r}function fu(t){let e=fe("change"),r=Jd(t),i=Zd(t),n=Bh(t),s;function o(c){let u=c.selectAll(".header").data([0]).enter().append("div").attr("class","header fillL");u.append("button").attr("class","close").on("click",()=>t.enter("browse")).call(Z("#rapid-icon-close")),u.append("h3").html(S.html("QA.improveOSM.title"));let d=c.selectAll(".body").data([0]);d=d.enter().append("div").attr("class","body").merge(d);let h=d.selectAll(".qa-editor").data([0]);h.enter().append("div").attr("class","modal-section qa-editor").merge(h).call(n.issue(s)).call(r.issue(s)).call(i.issue(s)).call(a)}function a(c){let u=s?.id,d=u&&t.selectedData().has(u),h=s&&(d||s.newComment||s.comment),p=c.selectAll(".qa-save").data(h?[s]:[],y=>`${y.id}-${y.status||0}`);p.exit().remove();let m=p.enter().append("div").attr("class","qa-save save-section cf");m.append("h4").attr("class",".qa-save-header").html(S.html("note.newComment")),m.append("textarea").attr("class","new-comment-input").attr("placeholder",S("QA.keepRight.comment_placeholder")).attr("maxlength",1e3).property("value",y=>y.newComment).call(qe).on("input",g).on("blur",g),p=m.merge(p).call(l);function g(){let v=H(this).property("value").trim();v===""&&(v=void 0),s=s.update({newComment:v});let x=K.improveOSM;x&&x.replaceItem(s),p.call(l)}}function l(c){let u=s?.id,d=u&&t.selectedData().has(u),h=c.selectAll(".buttons").data(d?[s]:[],m=>m.status+m.id);h.exit().remove();let p=h.enter().append("div").attr("class","buttons");p.append("button").attr("class","button comment-button action").html(S.html("QA.keepRight.save_comment")),p.append("button").attr("class","button close-button action"),p.append("button").attr("class","button ignore-button action"),h=h.merge(p),h.select(".comment-button").attr("disabled",m=>m.newComment?null:!0).on("click.comment",function(m,g){this.blur();let y=K.improveOSM;y&&y.postUpdate(g,(v,x)=>e.call("change",x))}),h.select(".close-button").html(m=>{let g=m.newComment?"_comment":"";return S.html(`QA.keepRight.close${g}`)}).on("click.close",function(m,g){this.blur();let y=K.improveOSM;y&&(g.newStatus="SOLVED",y.postUpdate(g,(v,x)=>e.call("change",x)))}),h.select(".ignore-button").html(m=>{let g=m.newComment?"_comment":"";return S.html(`QA.keepRight.ignore${g}`)}).on("click.ignore",function(m,g){this.blur();let y=K.improveOSM;y&&(g.newStatus="INVALID",y.postUpdate(g,(v,x)=>e.call("change",x)))})}return o.error=function(c){return arguments.length?(s=c,o):s},ge(o,e,"on")}function Uh(t){let e;function r(n){let{itemType:s,parentIssueType:o}=n,a=S.html("inspector.unknown"),l=n.replacements||{};l.default=a;let c=S.html(`QA.keepRight.errorTypes.${s}.description`,l);return c===a&&(c=S.html(`QA.keepRight.errorTypes.${o}.description`,l)),c}function i(n){let s=n.selectAll(".error-details").data(e?[e]:[],c=>`${c.id}-${c.status||0}`);s.exit().remove();let a=s.enter().append("div").attr("class","error-details qa-details-container").append("div").attr("class","qa-details-subsection");a.append("h4").html(S.html("QA.keepRight.detail_description")),a.append("div").attr("class","qa-details-description-text").html(r);let l=[];a.selectAll(".error_entity_link, .error_object_link").attr("href","#").each(function(){let c=H(this),u=c.classed("error_object_link"),d=u?e.objectType.charAt(0)+e.objectId:this.textContent,h=t.hasEntity(d);if(l.push(d),c.on("mouseenter",()=>{ct([d],!0,t)}).on("mouseleave",()=>{ct([d],!1,t)}).on("click",p=>{p.preventDefault(),ct([d],!1,t),t.scene().enableLayers("osm"),t.map().centerZoomEase(e.loc,20),h?t.enter(Se(t,[d])):t.loadEntity(d,(m,g)=>{if(m)return;g.data.find(v=>v.id===d)&&t.enter(Se(t,[d]))})}),h){let p=qt(h);if(!p&&!u){let m=xe.match(h,t.graph());p=m&&!m.isFallback()&&m.name()}p&&(this.innerText=p)}}),t.features().forceVisible(l),t.map().immediateRedraw()}return i.issue=function(n){return arguments.length?(e=n,i):e},i}function Gh(){let t;function e(i){let n=S.html("inspector.unknown"),s=i.replacements||{};s.default=n;let o=S.html(`QA.keepRight.errorTypes.${i.itemType}.title`,s);return o===n&&(o=S.html(`QA.keepRight.errorTypes.${i.parentIssueType}.title`,s)),o}function r(i){let n=16777215,s=K.keepRight;s&&(n=s.getColor(t?.parentIssueType));let o=i.selectAll(".qa-header").data(t?[t]:[],l=>`${l.id}-${l.status||0}`);o.exit().remove();let a=o.enter().append("div").attr("class","qa-header");a.append("div").attr("class","qa-header-icon").append("div").attr("class",l=>`qaItem ${l.service}`).call(Z("#rapid-icon-bolt")),a.append("div").attr("class","qa-header-label").html(e),a.selectAll(".qaItem svg.icon").attr("stroke","#333").attr("stroke-width","1.3px").attr("color",he.hex2string(n))}return r.issue=function(i){return arguments.length?(t=i,r):t},r}function zh(){let t;function e(r){let i;K.keepRight&&t instanceof Rt&&(i=K.keepRight.issueURL(t));let n=r.selectAll(".view-on-keepRight").data(i?[i]:[]);n.exit().remove(),n.enter().append("a").attr("class","view-on-keepRight").attr("target","_blank").attr("rel","noopener").attr("href",o=>o).call(Z("#rapid-icon-out-link","inline")).append("span").html(S.html("inspector.view_on_keepRight"))}return e.what=function(r){return arguments.length?(t=r,e):t},e}function du(t){let e=fe("change"),r=Uh(t),i=Gh(t),n;function s(l){let c=l.selectAll(".header").data([0]).enter().append("div").attr("class","header fillL");c.append("button").attr("class","close").on("click",()=>t.enter("browse")).call(Z("#rapid-icon-close")),c.append("h3").html(S.html("QA.keepRight.title"));let u=l.selectAll(".body").data([0]);u=u.enter().append("div").attr("class","body").merge(u);let d=u.selectAll(".qa-editor").data([0]);d.enter().append("div").attr("class","modal-section qa-editor").merge(d).call(i.issue(n)).call(r.issue(n)).call(o);let h=l.selectAll(".footer").data([0]);h.enter().append("div").attr("class","footer").merge(h).call(zh(t).what(n))}function o(l){let c=n?.id,u=c&&t.selectedData().has(c),d=n&&(u||n.newComment||n.comment),h=l.selectAll(".qa-save").data(d?[n]:[],g=>`${g.id}-${g.status||0}`);h.exit().remove();let p=h.enter().append("div").attr("class","qa-save save-section cf");p.append("h4").attr("class",".qa-save-header").html(S.html("QA.keepRight.comment")),p.append("textarea").attr("class","new-comment-input").attr("placeholder",S("QA.keepRight.comment_placeholder")).attr("maxlength",1e3).property("value",g=>g.newComment||g.comment).call(qe).on("input",m).on("blur",m),h=p.merge(h).call(a);function m(){let y=H(this).property("value").trim();y===n.comment&&(y=void 0),n=n.update({newComment:y});let v=K.keepRight;v&&v.replaceItem(n),h.call(a)}}function a(l){let c=n?.id,u=c&&t.selectedData().has(c),d=l.selectAll(".buttons").data(u?[n]:[],p=>p.status+p.id);d.exit().remove();let h=d.enter().append("div").attr("class","buttons");h.append("button").attr("class","button comment-button action").html(S.html("QA.keepRight.save_comment")),h.append("button").attr("class","button close-button action"),h.append("button").attr("class","button ignore-button action"),d=d.merge(h),d.select(".comment-button").attr("disabled",p=>p.newComment?null:!0).on("click.comment",function(p,m){this.blur();let g=K.keepRight;g&&g.postUpdate(m,(y,v)=>e.call("change",v))}),d.select(".close-button").html(p=>{let m=p.newComment?"_comment":"";return S.html(`QA.keepRight.close${m}`)}).on("click.close",function(p,m){this.blur();let g=K.keepRight;g&&(m.newStatus="ignore_t",g.postUpdate(m,(y,v)=>e.call("change",v)))}),d.select(".ignore-button").html(p=>{let m=p.newComment?"_comment":"";return S.html(`QA.keepRight.ignore${m}`)}).on("click.ignore",function(p,m){this.blur();let g=K.keepRight;g&&(m.newStatus="ignore",g.postUpdate(m,(y,v)=>e.call("change",v)))})}return s.error=function(l){return arguments.length?(n=l,s):n},ge(s,e,"on")}function Hh(){var t;function e(n){if(!t.isNew()){var s=n.selectAll(".comments-container").data([0]);s=s.enter().append("div").attr("class","comments-container").merge(s);var o=s.selectAll(".comment").data(t.comments).enter().append("div").attr("class","comment");o.append("div").attr("class",function(c){return"comment-avatar user-"+c.uid}).call(Z("#rapid-icon-avatar","comment-avatar-icon"));var a=o.append("div").attr("class","comment-main"),l=a.append("div").attr("class","comment-metadata");l.append("div").attr("class","comment-author").each(function(c){var u=H(this),d=K.osm;d&&c.user&&(u=u.append("a").attr("class","comment-author-link").attr("href",d.userURL(c.user)).attr("target","_blank")),u.html(function(h){return h.user||S.html("note.anonymous")})}),l.append("div").attr("class","comment-date").html(function(c){return S("note.status."+c.action,{when:i(c.date)})}),a.append("div").attr("class","comment-text").html(function(c){return c.html}).selectAll("a").attr("rel","noopener nofollow").attr("target","_blank"),s.call(r)}}function r(n){var s=ee("preferences.privacy.thirdpartyicons")||"true",o=K.osm;if(!(s!=="true"||!o)){var a={};t.comments.forEach(function(l){l.uid&&(a[l.uid]=!0)}),Object.keys(a).forEach(function(l){o.loadUser(l,function(c,u){!u||!u.image_url||n.selectAll(".comment-avatar.user-"+l).html("").append("img").attr("class","icon comment-avatar-icon").attr("src",u.image_url).attr("alt",u.display_name)})})}}function i(n){if(!n)return null;var s={day:"numeric",month:"short",year:"numeric"};n=n.replace(/-/g,"/");var o=new Date(n);return isNaN(o.getTime())?null:o.toLocaleDateString(se.localeCode(),s)}return e.note=function(n){return arguments.length?(t=n,e):t},e}function $h(){var t;function e(r){var i=r.selectAll(".note-header").data(t?[t]:[],function(o){return o.status+o.id});i.exit().remove();var n=i.enter().append("div").attr("class","note-header"),s=n.append("div").attr("class",function(o){return"note-header-icon "+o.status}).classed("new",function(o){return o.id<0});s.append("div").call(Z("#rapid-icon-note","note-fill")),s.each(function(o){var a;o.id<0?a="#rapid-icon-plus":o.status==="open"?a="#rapid-icon-close":a="#rapid-icon-apply",s.append("div").attr("class","note-icon-annotation").call(Z(a,"icon-annotation"))}),n.append("div").attr("class","note-header-label").html(function(o){return t.isNew()?S("note.new"):S("note.note")+" "+o.id+" "+(o.status==="closed"?S("note.closed"):"")})}return e.note=function(r){return arguments.length?(t=r,e):t},e}function jh(){var t;function e(r){var i;K.osm&&t instanceof Jt&&!t.isNew()&&(i=K.osm.noteReportURL(t));var n=r.selectAll(".note-report").data(i?[i]:[]);n.exit().remove();var s=n.enter().append("a").attr("class","note-report").attr("target","_blank").attr("href",function(o){return o}).call(Z("#rapid-icon-out-link","inline"));s.append("span").html(S.html("note.report"))}return e.note=function(r){return arguments.length?(t=r,e):t},e}function hu(t){var e;function r(i){var n;e instanceof Te?n=t.connection().entityURL(e):e instanceof Jt&&(n=t.connection().noteURL(e));var s=!e||e.isNew()?[]:[e],o=i.selectAll(".view-on-osm").data(s,function(l){return l.id});o.exit().remove();var a=o.enter().append("a").attr("class","view-on-osm").attr("target","_blank").attr("href",n).call(Z("#rapid-icon-out-link","inline"));a.append("span").html(S.html("inspector.view_on_osm"))}return r.what=function(i){return arguments.length?(e=i,r):e},r}function pu(t){var e=fe("change"),r=Hh(t),i=$h(),n,s;function o(m){var g=m.selectAll(".header").data([0]),y=g.enter().append("div").attr("class","header fillL");y.append("button").attr("class","close").on("click",function(){t.enter("browse")}).call(Z("#rapid-icon-close")),y.append("h3").html(S.html("note.title"));var v=m.selectAll(".body").data([0]);v=v.enter().append("div").attr("class","body").merge(v);var x=v.selectAll(".note-editor").data([0]);x.enter().append("div").attr("class","modal-section note-editor").merge(x).call(i.note(n)).call(r.note(n)).call(a);var _=m.selectAll(".footer").data([0]);_.enter().append("div").attr("class","footer").merge(_).call(hu(t).what(n)).call(jh(t).note(n));var b=K.osm;b&&b.on("change.note-save",function(){m.call(o)})}function a(m){var g=n&&n.id===t.selectedIDs()[0],y=m.selectAll(".note-save").data(g?[n]:[],function(w){return w.status+w.id});y.exit().remove();var v=y.enter().append("div").attr("class","note-save save-section cf");v.append("h4").attr("class",".note-save-header").html(function(){return n.isNew()?S("note.newDescription"):S("note.newComment")});var x=v.append("textarea").attr("class","new-comment-input").attr("placeholder",S("note.inputPlaceholder")).attr("maxlength",1e3).property("value",function(w){return w.newComment}).call(qe).on("keydown.note-input",_).on("input.note-input",b).on("blur.note-input",b);!x.empty()&&s&&x.node().focus(),y=v.merge(y).call(l).call(c);function _(w){if(w.keyCode===13&&w.metaKey){var E=K.osm;if(E){var A=E.authenticated();A&&n.newComment&&(w.preventDefault(),H(this).on("keydown.note-input",null),window.setTimeout(function(){n.isNew()?(y.selectAll(".save-button").node().focus(),d(n)):(y.selectAll(".comment-button").node().focus(),p(n))},10))}}}function b(){var w=H(this),E=w.property("value").trim()||void 0;n=n.update({newComment:E});var A=K.osm;A&&A.replaceNote(n),y.call(c)}}function l(m){var g=m.selectAll(".detail-section").data([0]);g=g.enter().append("div").attr("class","detail-section").merge(g);var y=K.osm;if(y){var v=y.authenticated(),x=g.selectAll(".auth-warning").data(v?[]:[0]);x.exit().transition().duration(200).style("opacity",0).remove();var _=x.enter().insert("div",".tag-reference-body").attr("class","field-warning auth-warning").style("opacity",0);_.call(Z("#rapid-icon-alert","inline")),_.append("span").html(S.html("note.login")),_.append("a").attr("target","_blank").call(Z("#rapid-icon-out-link","inline")).append("span").html(S.html("login")).on("click.note-login",function(w){w.preventDefault(),y.authenticate()}),_.transition().duration(200).style("opacity",1);var b=g.selectAll(".note-save-prose").data(v?[0]:[]);b.exit().remove(),b=b.enter().append("p").attr("class","note-save-prose").html(S.html("note.upload_explanation")).merge(b),y.userDetails(function(w,E){if(!w){var A=H(document.createElement("div"));E.image_url&&A.append("img").attr("src",E.image_url).attr("class","icon pre-text user-icon"),A.append("a").attr("class","user-info").html(E.display_name).attr("href",y.userURL(E.display_name)).attr("target","_blank"),b.html(S.html("note.upload_explanation_with_user",{user:A.html()}))}})}}function c(m){var g=K.osm,y=g&&g.authenticated(),v=n&&n.id===t.selectedIDs()[0],x=m.selectAll(".buttons").data(v?[n]:[],function(w){return w.status+w.id});x.exit().remove();var _=x.enter().append("div").attr("class","buttons");n.isNew()?(_.append("button").attr("class","button cancel-button secondary-action").html(S.html("confirm.cancel")),_.append("button").attr("class","button save-button action").html(S.html("note.save"))):(_.append("button").attr("class","button status-button action"),_.append("button").attr("class","button comment-button action").html(S.html("note.comment"))),x=x.merge(_),x.select(".cancel-button").on("click.cancel",u),x.select(".save-button").attr("disabled",b).on("click.save",d),x.select(".status-button").attr("disabled",y?null:!0).html(function(w){var E=w.status==="open"?"close":"open",A=w.newComment?"_comment":"";return S("note."+E+A)}).on("click.status",h),x.select(".comment-button").attr("disabled",b).on("click.comment",p);function b(w){return y&&w.status==="open"&&w.newComment?null:!0}}function u(m,g){this.blur();var y=K.osm;y&&y.removeNote(g),t.enter("browse"),e.call("change")}function d(m,g){this.blur();var y=K.osm;y&&y.postNoteCreate(g,function(v,x){e.call("change",x)})}function h(m,g){this.blur();var y=K.osm;if(y){var v=g.status==="open"?"closed":"open";y.postNoteUpdate(g,v,function(x,_){e.call("change",_)})}}function p(m,g){this.blur();var y=K.osm;y&&y.postNoteUpdate(g,g.status,function(v,x){e.call("change",x)})}return o.note=function(m){return arguments.length?(n=m,o):n},o.newNote=function(m){return arguments.length?(s=m,o):s},ge(o,e,"on")}function fA(t){let e;function r(n,s){if(!n)return"";let o=K.osmose.getStrings(n.itemType);return s in o?o[s]:""}function i(n){let s=n.selectAll(".error-details").data(e?[e]:[],c=>`${c.id}-${c.status||0}`);s.exit().remove();let o=s.enter().append("div").attr("class","error-details qa-details-container");if(r(e,"detail")){let c=o.append("div").attr("class","qa-details-subsection");c.append("h4").html(S.html("QA.keepRight.detail_description")),c.append("p").attr("class","qa-details-description-text").html(u=>r(u,"detail")).selectAll("a").attr("rel","noopener").attr("target","_blank")}let a=o.append("div").attr("class","qa-details-subsection"),l=o.append("div").attr("class","qa-details-subsection");if(r(e,"fix")){let c=o.append("div").attr("class","qa-details-subsection");c.append("h4").html(S.html("QA.osmose.fix_title")),c.append("p").html(u=>r(u,"fix")).selectAll("a").attr("rel","noopener").attr("target","_blank")}if(r(e,"trap")){let c=o.append("div").attr("class","qa-details-subsection");c.append("h4").html(S.html("QA.osmose.trap_title")),c.append("p").html(u=>r(u,"trap")).selectAll("a").attr("rel","noopener").attr("target","_blank")}K.osmose.loadIssueDetailAsync(e).then(c=>{e.id===c.id&&(!c.elems||c.elems.length===0||(c.detail&&(a.append("h4").html(S.html("QA.osmose.detail_title")),a.append("p").html(u=>u.detail).selectAll("a").attr("rel","noopener").attr("target","_blank")),l.append("h4").html(S.html("QA.osmose.elems_title")),l.append("ul").selectAll("li").data(c.elems).enter().append("li").append("a").attr("href","#").attr("class","error_entity_link").html(u=>u).each(function(){let u=H(this),d=this.textContent,h=t.hasEntity(d);if(u.on("mouseenter",()=>{ct([d],!0,t)}).on("mouseleave",()=>{ct([d],!1,t)}).on("click",p=>{p.preventDefault(),ct([d],!1,t),t.scene().enableLayers("osm"),t.map().centerZoom(c.loc,20),h?t.enter(Se(t,[d])):t.loadEntity(d,(m,g)=>{if(m)return;g.data.find(v=>v.id===d)&&t.enter(Se(t,[d]))})}),h){let p=qt(h);if(!p){let m=xe.match(h,t.graph());p=m&&!m.isFallback()&&m.name()}p&&(this.innerText=p)}}),t.features().forceVisible(c.elems),t.map().immediateRedraw()))}).catch(c=>console.error(c))}return i.issue=function(n){return arguments.length?(e=n,i):e},i}function dA(){let t;function e(i){let n=S("inspector.unknown");if(!i)return n;let s=K.osmose.getStrings(i.itemType);return"title"in s?s.title:n}function r(i){let n=16777215,s=K.osmose;s&&(n=s.getColor(t?.item));let o=i.selectAll(".qa-header").data(t?[t]:[],c=>`${c.id}-${c.status||0}`);o.exit().remove();let a=o.enter().append("div").attr("class","qa-header"),l=a.append("div").attr("class","qa-header-icon").append("svg").attr("width","20px").attr("height","27px").attr("viewbox","0 0 20 27").attr("class",c=>`qaItem ${c.service}`);l.append("polygon").attr("fill",he.hex2string(n)).attr("stroke","#333").attr("points","16,3 4,3 1,6 1,17 4,20 7,20 10,27 13,20 16,20 19,17.033 19,6"),l.append("use").attr("class","icon-annotation").attr("width","13px").attr("height","13px").attr("transform","translate(3.5, 5)").attr("xlink:href",c=>c.icon?`#${c.icon}`:""),a.append("div").attr("class","qa-header-label").html(e)}return r.issue=function(i){return arguments.length?(t=i,r):t},r}function hA(){let t;function e(r){let i;K.osmose&&t instanceof Rt&&(i=K.osmose.itemURL(t));let n=r.selectAll(".view-on-osmose").data(i?[i]:[]);n.exit().remove(),n.enter().append("a").attr("class","view-on-osmose").attr("target","_blank").attr("rel","noopener").attr("href",o=>o).call(Z("#rapid-icon-out-link","inline")).append("span").html(S.html("inspector.view_on_osmose"))}return e.what=function(r){return arguments.length?(t=r,e):t},e}function Vh(t){let e=fe("change"),r=fA(t),i=dA(t),n;function s(l){let u=l.selectAll(".header").data([0]).enter().append("div").attr("class","header fillL");u.append("button").attr("class","close").on("click",()=>t.enter("browse")).call(Z("#rapid-icon-close")),u.append("h3").html(S.html("QA.osmose.title"));let d=l.selectAll(".body").data([0]);d=d.enter().append("div").attr("class","body").merge(d);let h=d.selectAll(".qa-editor").data([0]);h.enter().append("div").attr("class","modal-section qa-editor").merge(h).call(i.issue(n)).call(r.issue(n)).call(o);let p=l.selectAll(".footer").data([0]);p.enter().append("div").attr("class","footer").merge(p).call(hA(t).what(n))}function o(l){let c=n?.id,u=c&&t.selectedData().has(c),d=n&&u,h=l.selectAll(".qa-save").data(d?[n]:[],m=>`${m.id}-${m.status||0}`);h.exit().remove(),h=h.enter().append("div").attr("class","qa-save save-section cf").merge(h).call(a)}function a(l){let c=n?.id,u=c&&t.selectedData().has(c),d=l.selectAll(".buttons").data(u?[n]:[],p=>p.status+p.id);d.exit().remove();let h=d.enter().append("div").attr("class","buttons");h.append("button").attr("class","button close-button action"),h.append("button").attr("class","button ignore-button action"),d=d.merge(h),d.select(".close-button").html(S.html("QA.keepRight.close")).on("click.close",function(p,m){this.blur();let g=K.osmose;g&&(m.newStatus="done",g.postUpdate(m,(y,v)=>e.call("change",v)))}),d.select(".ignore-button").html(S.html("QA.keepRight.ignore")).on("click.ignore",function(p,m){this.blur();let g=K.osmose;g&&(m.newStatus="false",g.postUpdate(m,(y,v)=>e.call("change",v)))})}return s.error=function(l){return arguments.length?(n=l,s):n},ge(s,e,"on")}function pA(t){var e={id:"drag-note",button:"browse"};let r=t.behaviors.get("drag").on("start",c).on("move",u).on("end",h);var i,n,s;function o(p,m){i&&window.clearInterval(i),i=window.setInterval(function(){t.map().pan(m),d(p,m)},50)}function a(){i&&(window.clearInterval(i),i=null)}function l(p){return t.projection.project(p.loc)}function c(p,m){s=m;var g=K.osm;g&&(s=g.getNote(s.id)),s.id&&(t.surface().selectAll(".note-"+s.id).classed("active",!0),t.perform(hr()),t.enter(e))}function u(p,m,g){p.stopPropagation(),n=t.projection.invert(g),d(p);var y=Xf(g,t.map().dimensions);y?o(p,y):a()}function d(p,m){m=m||[0,0];var g=p&&p.point||t.projection.project(n),y=St(g,m),v=t.projection.invert(y);s=s.move(v);var x=K.osm;x&&x.replaceNote(s),t.replace(hr())}function h(){t.replace(hr());let p=new Map().set(s.id,s);t.enter("select",p)}return e.enter=function(){return t.enableBehaviors(["hover","drag","map-interaction"]),!0},e.exit=function(){t.ui().sidebar.hover.cancel(),t.surface().selectAll(".active").classed("active",!1),a()},e}function gu(t){var e,r=2e3,i="#rapid-icon-no",n="disabled",s="";function o(){e&&e.stop(),t.container().select(".main-footer-wrap").classed("footer-hide",!0).classed("footer-show",!1),t.container().select(".flash-wrap").classed("footer-hide",!1).classed("footer-show",!0);var a=t.container().select(".flash-wrap").selectAll(".flash-content").data([0]),l=a.enter().append("div").attr("class","flash-content"),c=l.append("svg").attr("class","flash-icon icon").append("g").attr("transform","translate(10,10)");return c.append("circle").attr("r",9),c.append("use").attr("transform","translate(-7,-7)").attr("width","14").attr("height","14"),l.append("div").attr("class","flash-text"),a=a.merge(l),a.selectAll(".flash-icon").attr("class","icon flash-icon "+(n||"")),a.selectAll(".flash-icon use").attr("xlink:href",i),a.selectAll(".flash-text").attr("class","flash-text").html(s),e=Ac(function(){e=null,t.container().select(".main-footer-wrap").classed("footer-hide",!1).classed("footer-show",!0),t.container().select(".flash-wrap").classed("footer-hide",!0).classed("footer-show",!1)},r),a}return o.duration=function(a){return arguments.length?(r=a,o):r},o.label=function(a){return arguments.length?(s=a,o):s},o.iconName=function(a){return arguments.length?(i=a,o):i},o.iconClass=function(a){return arguments.length?(n=a,o):n},o}function Be(t,e,r){return'<svg class="icon '+(e||"")+'"><use xlink:href="'+t+'"'+(r?' class="'+r+'"':"")+"></use></svg>"}function Br(t){t.stopPropagation(),t.preventDefault()}var Xh;function oe(t,e){Xh||(Xh={point_icon:Be("#rapid-icon-point","inline"),line_icon:Be("#rapid-icon-line","inline"),area_icon:Be("#rapid-icon-area","inline"),note_icon:Be("#rapid-icon-note","inline add-note"),plus:Be("#rapid-icon-plus","inline"),minus:Be("#rapid-icon-minus","inline"),layers_icon:Be("#rapid-icon-layers","inline"),data_icon:Be("#rapid-icon-data","inline"),inspect:Be("#rapid-icon-inspect","inline"),help_icon:Be("#rapid-icon-help","inline"),undo_icon:Be(se.textDirection()==="rtl"?"#rapid-icon-redo":"#rapid-icon-undo","inline"),redo_icon:Be(se.textDirection()==="rtl"?"#rapid-icon-undo":"#rapid-icon-redo","inline"),save_icon:Be("#rapid-icon-save","inline"),circularize_icon:Be("#rapid-operation-circularize","inline operation"),continue_icon:Be("#rapid-operation-continue","inline operation"),copy_icon:Be("#rapid-operation-copy","inline operation"),delete_icon:Be("#rapid-operation-delete","inline operation"),disconnect_icon:Be("#rapid-operation-disconnect","inline operation"),downgrade_icon:Be("#rapid-operation-downgrade","inline operation"),extract_icon:Be("#rapid-operation-extract","inline operation"),merge_icon:Be("#rapid-operation-merge","inline operation"),move_icon:Be("#rapid-operation-move","inline operation"),orthogonalize_icon:Be("#rapid-operation-orthogonalize","inline operation"),paste_icon:Be("#rapid-operation-paste","inline operation"),reflect_long_icon:Be("#rapid-operation-reflect-long","inline operation"),reflect_short_icon:Be("#rapid-operation-reflect-short","inline operation"),reverse_icon:Be("#rapid-operation-reverse","inline operation"),rotate_icon:Be("#rapid-operation-rotate","inline operation"),split_icon:Be("#rapid-operation-split","inline operation"),straighten_icon:Be("#rapid-operation-straighten","inline operation"),leftclick:Be("#rapid-walkthrough-mouse-left","inline operation"),rightclick:Be("#rapid-walkthrough-mouse-right","inline operation"),mousewheel_icon:Be("#rapid-walkthrough-mousewheel","inline operation"),tap_icon:Be("#rapid-walkthrough-tap","inline operation"),doubletap_icon:Be("#rapid-walkthrough-doubletap","inline operation"),longpress_icon:Be("#rapid-walkthrough-longpress","inline operation"),touchdrag_icon:Be("#rapid-walkthrough-touchdrag","inline operation"),pinch_icon:Be("#rapid-walkthrough-pinch-apart","inline operation"),shift:et.display("\u21E7"),alt:et.display("\u2325"),return:et.display("\u21B5"),esc:S.html("shortcuts.key.esc"),space:S.html("shortcuts.key.space"),add_note_key:S.html("modes.add_note.key"),help_key:S.html("help.key"),shortcuts_key:S.html("shortcuts.toggle.key"),save:S.html("save.title"),undo:S.html("undo.title"),redo:S.html("redo.title"),upload:S.html("commit.save"),point:S.html("modes.add_point.title"),line:S.html("modes.add_line.title"),area:S.html("modes.add_area.title"),note:S.html("modes.add_note.label"),circularize:S.html("operations.circularize.title"),continue:S.html("operations.continue.title"),copy:S.html("operations.copy.title"),delete:S.html("operations.delete.title"),disconnect:S.html("operations.disconnect.title"),downgrade:S.html("operations.downgrade.title"),extract:S.html("operations.extract.title"),merge:S.html("operations.merge.title"),move:S.html("operations.move.title"),orthogonalize:S.html("operations.orthogonalize.title"),paste:S.html("operations.paste.title"),reflect_long:S.html("operations.reflect.title.long"),reflect_short:S.html("operations.reflect.title.short"),reverse:S.html("operations.reverse.title"),rotate:S.html("operations.rotate.title"),split:S.html("operations.split.title"),straighten:S.html("operations.straighten.title"),map_data:S.html("map_data.title"),osm_notes:S.html("map_data.layers.notes.title"),fields:S.html("inspector.fields"),tags:S.html("inspector.tags"),relations:S.html("inspector.relations"),new_relation:S.html("inspector.new_relation"),turn_restrictions:S.html("_tagging.presets.fields.restrictions.label"),background_settings:S.html("background.description"),imagery_offset:S.html("background.fix_misalignment"),start_the_walkthrough:S.html("splash.walkthrough"),help:S.html("help.title"),ok:S.html("intro.ok")});var r;return e?r=Object.assign(e,Xh):r=Xh,S.html(t,r).replace(/\`(.*?)\`/g,"<kbd>$1</kbd>")}function mA(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}var gA={};function yA(t,e){if(S(t,{default:void 0})===void 0){if(gA.hasOwnProperty(t))return;gA[t]=e;let r=`${t}: ${e}`;typeof console<"u"&&console.log(r)}}function Ug(t){let e,r=t.tags&&t.tags.name;r&&(e="intro.graph.name."+mA(r),t.tags.name=S(e,{default:r}),yA(e,r));let i=t.tags&&t.tags["addr:street"];return i&&(e="intro.graph.name."+mA(i),t.tags["addr:street"]=S(e,{default:i}),yA(e,i),["block_number","city","county","district","hamlet","neighbourhood","postcode","province","quarter","state","subdistrict","suburb"].forEach(s=>{let o=`intro.graph.${s}`,a=`addr:${s}`,l=t.tags&&t.tags[a],c=S(o,{default:l});c&&(c.match(/^<.*>$/)!==null?delete t.tags[a]:t.tags[a]=c)})),t}function vA(t){let r=Math.cos(75*Math.PI/180),i=Math.cos(15*Math.PI/180);for(let n=0;n<t.length;n++){let s=t[(n-1+t.length)%t.length],o=t[n],a=t[(n+1)%t.length],l=Hf(s,a,o),c=Math.abs(l);if(c>r&&c<i)return!1}return!0}function ei(t,e){let r=Tt(t,e);return r<1e-4?0:r<200?500:1e3}function zt(t=300){return new Promise(e=>window.setTimeout(e,t))}function yi(t){t.select(".inspector-wrap .entity-editor-pane").classed("hide",!1),t.select(".inspector-wrap .preset-list-pane").classed("hide",!0),t.select(".inspector-wrap .panewrap").style("right","0%")}function ws(t){t.select(".inspector-wrap .entity-editor-pane").classed("hide",!0),t.select(".inspector-wrap .preset-list-pane").classed("hide",!1),t.select(".inspector-wrap .panewrap").style("right","-100%")}function vl(t,e,r){return Math.max(e,Math.min(t,r))}var Wh=class{constructor(e){this.context=e,this._enabled=!1,this._revealOptions=null,this._containerRect=null,this._mapRect=null,this._revealRect=null,this._darknessDirty=!0,this._tooltipDirty=!0,this._inTransition=!1,this._curtain=H(null),this._tooltip=H(null),this.enable=this.enable.bind(this),this.disable=this.disable.bind(this),this.redraw=this.redraw.bind(this),this.resize=this.resize.bind(this)}enable(e){this._enabled||(this._enabled=!0,this._revealOptions=null,this._containerRect=null,this._mapRect=null,this._revealRect=null,this._darknessDirty=!0,this._tooltipDirty=!0,this._inTransition=!1,this._curtain=e.append("svg").attr("class","curtain").style("top",0).style("left",0),this._tooltip=e.append("div").attr("class","tooltip"),this._tooltip.append("div").attr("class","popover-arrow"),this._tooltip.append("div").attr("class","popover-inner"),H(window).on("resize.curtain",this.resize),this.context.map().on("move",this.redraw),this.resize())}disable(){this._enabled&&(this._enabled=!1,this._curtain.remove(),this._curtain=H(null),this._tooltip.remove(),this._tooltip=H(null),this._revealOptions=null,this._containerRect=null,this._mapRect=null,this._revealRect=null,H(window).on("resize.curtain",null),this.context.map().off("move",this.redraw))}resize(){let e=this.context.container().node();this._containerRect=this._copyRect(e.getBoundingClientRect());let r=this.context.container().select(".main-map").node();this._mapRect=this._copyRect(r.getBoundingClientRect());let[i,n]=[this._containerRect.width,this._containerRect.height];this._curtain.attr("width",i).attr("height",n),this._revealRect=null,this._darknessDirty=!0,this._curtain.selectAll("path").interrupt(),this._inTransition=!1,this.redraw()}hide(){this.reveal({duration:0})}reveal(e={}){return this._revealOptions=Object.assign({},e,{duration:250}),this._revealRect=null,this._darknessDirty=!0,this._tooltipDirty=!0,this.redrawDarkness(this._revealOptions.duration),this.redrawTooltip(),this._tooltip}redraw(){this._inTransition||(this.redrawDarkness(),this.redrawTooltip())}redrawDarkness(e=0){if(!this._darknessDirty)return;let r=this._containerRect,i=this._mapRect;if(!r||!i)return;let n=this._revealOptions,s=n?.revealPadding??0,o,a;if(n){if(n.revealExtent instanceof le){let m=this.context.projection,g=m.project([n.revealExtent.min[0],n.revealExtent.max[1]]),y=m.project([n.revealExtent.max[0],n.revealExtent.min[1]]);g=Ot(g,[i.left,i.top]),y=Ot(y,[i.left,i.top]),a=i,o={left:g[0],top:g[1],right:y[0],bottom:y[1],width:y[0]-g[0],height:y[1]-g[1]}}else n.revealSelector&&!n.revealNode&&(n.revealNode=H(n.revealSelector).node()),n.revealNode instanceof Element&&(a=r,o=this._copyRect(n.revealNode.getBoundingClientRect()));o&&(o.left=vl(o.left-s,a.left,a.right),o.top=vl(o.top-s,a.top,a.bottom),o.right=vl(o.right+s,a.left,a.right),o.bottom=vl(o.bottom+s,a.top,a.bottom),o.width=o.right-o.left,o.height=o.bottom-o.top,this._revealRect=o)}let l=r,c=o,u=`M${l.left},${l.top} L${l.left},${l.bottom} L${l.right},${l.bottom}, L${l.right},${l.top} Z`;c&&(u+=` M${c.left},${c.top} L${c.left},${c.bottom} L${c.right},${c.bottom}, L${c.right},${c.top} Z`);let d=this._curtain.selectAll("path").data([0]).interrupt(),h=d.enter().append("path").attr("x",0).attr("y",0).attr("class","curtain-darkness"),p=d.merge(h);e>0?(this._inTransition=!0,p=p.transition().duration(e).ease(s2).on("end interrupt",()=>this._inTransition=!1)):this._inTransition=!1,p.attr("d",u),this._darknessDirty=n?.revealExtent}redrawTooltip(){let e=this._containerRect;if(!e)return;let r=this._revealOptions,i;r&&(r.tipSelector&&!r.tipNode&&(r.tipNode=H(r.tipSelector).node()),r.tipNode instanceof Element&&(i=this._copyRect(r.tipNode.getBoundingClientRect())),!i&&this._revealRect&&(i=this._copyRect(this._revealRect)));let n=r?.tipHtml;if(i&&n){let s="curtain-tooltip popover tooltip arrowed in "+(r.tooltipClass||"");this._tooltipDirty&&(n.indexOf("**")!==-1&&(n.indexOf("<span")===0?n=n.replace(/^(<span.*?>)(.+?)(\*\*)/,"$1<span>$2</span>$3"):n=n.replace(/^(.+?)(\*\*)/,"<span>$1</span>$2"),n=n.replace(/\*\*(.*?)\*\*/g,'<span class="instruction">$1</span>')),n=n.replace(/\*(.*?)\*/g,"<em>$1</em>"),n=n.replace(/\{br\}/g,"<br/><br/>"),r.buttonText&&r.buttonCallback&&(n+=`<div class="button-section"><button href="#" class="button action">${r.buttonText}</button></div>`),this._tooltip.attr("class",s).selectAll(".popover-inner").html(n),r.buttonText&&r.buttonCallback&&this._tooltip.selectAll("button.action").on("click",h=>{h.preventDefault(),r.buttonCallback()}),this._tooltipDirty=!1);let o=5,a=this._copyRect(this._tooltip.node().getBoundingClientRect()),l,c,u;i.left=vl(i.left,e.left,e.right),i.top=vl(i.top,e.top,e.bottom),i.right=vl(i.right,e.left,e.right),i.bottom=vl(i.bottom,e.top,e.bottom),i.width=i.right-i.left,i.height=i.bottom-i.top,i.bottom<100?(l="bottom",c=i.left+i.width/2-a.width/2,u=i.bottom):i.top>e.height-140?(l="top",c=i.left+i.width/2-a.width/2,u=i.top-a.height):(u=i.top+i.height/2-a.height/2,se.textDirection()==="rtl"?i.left-a.width-o<70?(l="right",c=i.right+o):(l="left",c=i.left-a.width-o):i.right+o+a.width>e.width-70?(l="left",c=i.left-a.width-o):(l="right",c=i.right+o)),this._tooltip.style("left",`${c}px`).style("top",`${u}px`).attr("class",s+" "+l);let d=0;(l==="left"||l==="right")&&(u<60?d=60-u:u+a.height>e.height-100&&(d=e.height-u-a.height-100)),this._tooltip.selectAll(".popover-inner").style("top",`${d}px`)}else this._tooltip.classed("in",!1).call(A0(!1)),this._tooltipDirty=!1}_copyRect(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}};function xA(t,e){let r=fe("done"),i={title:"intro.welcome.title"},n=new le([-85.63654,41.9429],[-85.63632,41.94307]),s=!1,o=null;function a(h){return s?Promise.reject():typeof h!="function"?Promise.resolve():h().then(p=>a(p)).catch(p=>(p instanceof Error&&console.error(p),a(h)))}function l(){return t.map().setCenterZoomAsync(n.center(),19).then(()=>new Promise((h,p)=>{o=p,e.reveal({revealSelector:".intro-nav-wrap .chapter-welcome",tipHtml:oe("intro.welcome.welcome"),buttonText:S.html("intro.ok"),buttonCallback:()=>h(c)})}))}function c(){return new Promise((h,p)=>{o=p,e.reveal({revealSelector:".intro-nav-wrap .chapter-welcome",tipHtml:oe("intro.welcome.practice"),buttonText:S.html("intro.ok"),buttonCallback:()=>h(u)})})}function u(){return new Promise((h,p)=>{o=p,e.reveal({revealSelector:".intro-nav-wrap .chapter-welcome",tipHtml:oe("intro.welcome.words"),buttonText:S.html("intro.ok"),buttonCallback:()=>h(d)})})}function d(){return r.call("done"),e.reveal({revealSelector:".intro-nav-wrap .chapter-navigation",tipHtml:oe("intro.welcome.chapters",{next:S("intro.navigation.title")})}),Promise.resolve()}return i.enter=()=>{s=!1,o=null,a(l).catch(h=>{h instanceof Error&&console.error(h)})},i.exit=()=>{s=!0,o&&(o(),o=null)},i.restart=()=>{i.exit(),i.enter()},ge(i,r,"on")}function _A(t,e){let r=fe("done"),i={title:"intro.navigation.title"},n=t.container(),s=t.history(),o=t.map(),a="n2061",l=new le([-85.63654,41.9429],[-85.63632,41.94307]),c="w397",u=new le([-85.63588,41.94155],[-85.63574,41.94278]),d=xe.field("oneway"),h=xe.field("maxspeed"),p=!1,m=null;function g(){if(!t.hasEntity(a)||t.mode().id!=="select")return!1;let O=t.selectedIDs();return O.length===1&&O[0]===a}function y(){return t.hasEntity(c)}function v(){if(!t.hasEntity(c)||t.mode().id!=="select")return!1;let O=t.selectedIDs();return O.length===1&&O[0]===c}function x(O){return p?Promise.reject():typeof O!="function"?Promise.resolve():O().then(R=>x(R)).catch(R=>(R instanceof Error&&console.error(R),x(O)))}function _(){t.enter("browse"),s.reset("initial");let O,R=l.center(),U=ei(R,o.center());return U>0&&e.hide(),o.setCenterZoomAsync(R,19,U).then(()=>new Promise((G,$)=>{m=$;let q=o.center(),ie=t.lastPointerType()==="mouse"?"drag":"drag_touch",Q=oe("intro.navigation.map_info")+"{br}"+oe(`intro.navigation.${ie}`);O=()=>{pt(q,o.center())||G(b)},e.reveal({revealSelector:".main-map",tipHtml:Q}),o.on("move",O)})).finally(()=>{O&&o.off("move",O)}).then(G=>zt(2e3).then(G))}function b(){let O;return new Promise((R,U)=>{m=U;let G=o.zoom(),$=t.lastPointerType()==="mouse"?"zoom":"zoom_touch",q=oe(`intro.navigation.${$}`);O=()=>{G!==o.zoom()&&R(w)},e.reveal({revealSelector:".main-map",tipHtml:q}),o.on("move",O)}).finally(()=>{O&&o.off("move",O)}).then(R=>zt(2e3).then(R))}function w(){return new Promise((O,R)=>{m=R,e.reveal({revealSelector:".main-map",tipHtml:oe("intro.navigation.features"),buttonText:S.html("intro.ok"),buttonCallback:()=>O(E)})})}function E(){return new Promise((O,R)=>{m=R,e.reveal({revealSelector:".main-map",tipHtml:oe("intro.navigation.points_lines_areas"),buttonText:S.html("intro.ok"),buttonCallback:()=>O(A)})})}function A(){return new Promise((O,R)=>{m=R,e.reveal({revealSelector:".main-map",tipHtml:oe("intro.navigation.nodes_ways"),buttonText:S.html("intro.ok"),buttonCallback:()=>O(T)})})}function T(){t.enter("browse"),s.reset("initial");let O=l.center(),R=ei(O,o.center());return R>0&&e.hide(),o.setCenterZoomAsync(O,19,R).then(()=>new Promise((U,G)=>{m=G;let $=t.lastPointerType()==="mouse"?"click_townhall":"tap_townhall";e.reveal({revealExtent:l,tipHtml:oe(`intro.navigation.${$}`)}),t.on("enter.intro",()=>U(k))})).finally(()=>{t.on("enter.intro",null)})}function k(){return g()?new Promise((O,R)=>{m=R,e.reveal({revealExtent:l,tipHtml:oe("intro.navigation.selected_townhall"),buttonText:S.html("intro.ok"),buttonCallback:()=>O(C)}),t.on("enter.intro",R)}).finally(()=>{t.on("enter.intro",null)}):Promise.resolve(T)}function C(){return g()?new Promise((O,R)=>{m=R,yi(n),n.select(".inspector-wrap").on("wheel.intro",Br),e.reveal({revealSelector:".entity-editor-pane",tipHtml:oe("intro.navigation.editor_townhall"),buttonText:S.html("intro.ok"),buttonCallback:()=>O(I)}),t.on("enter.intro",R)}).finally(()=>{t.on("enter.intro",null),n.select(".inspector-wrap").on("wheel.intro",null)}):Promise.resolve(T)}function I(){return g()?new Promise((O,R)=>{m=R,yi(n),n.select(".inspector-wrap").on("wheel.intro",Br);let U=t.entity(t.selectedIDs()[0]),G=xe.match(U,t.graph());e.reveal({revealSelector:".entity-editor-pane .section-feature-type",revealPadding:5,tipHtml:oe("intro.navigation.preset_townhall",{preset:G.name()}),buttonText:S.html("intro.ok"),buttonCallback:()=>O(P)}),t.on("enter.intro",R)}).finally(()=>{t.on("enter.intro",null),n.select(".inspector-wrap").on("wheel.intro",null)}):Promise.resolve(T)}function P(){return g()?new Promise((O,R)=>{m=R,yi(n),n.select(".inspector-wrap").on("wheel.intro",Br),e.reveal({revealSelector:".entity-editor-pane .section-preset-fields",revealPadding:5,tipHtml:oe("intro.navigation.fields_townhall"),buttonText:S.html("intro.ok"),buttonCallback:()=>O(N)}),t.on("enter.intro",R)}).finally(()=>{t.on("enter.intro",null),n.select(".inspector-wrap").on("wheel.intro",null)}):Promise.resolve(T)}function N(){return g()?new Promise((O,R)=>{m=R,yi(n);let G=H(".entity-editor-pane button.close svg use").attr("href")||"#rapid-icon-close";e.reveal({revealSelector:".entity-editor-pane",tipSelector:".entity-editor-pane button.close",tipHtml:oe("intro.navigation.close_townhall",{button:Be(G,"inline")})}),t.on("enter.intro",()=>O(M))}).finally(()=>{t.on("enter.intro",null)}):Promise.resolve(T)}function M(){t.enter("browse"),s.reset("initial");let O=u.center(),R=ei(O,o.center());return R>0&&e.hide(),o.setCenterZoomAsync(O,19,R).then(()=>new Promise((U,G)=>{m=G,e.reveal({revealSelector:".search-header input",tipHtml:oe("intro.navigation.search_street",{name:S("intro.graph.name.spring-street")})}),n.select(".search-header input").on("keyup.intro",()=>U(D))})).finally(()=>{n.select(".search-header input").on("keyup.intro",null)})}function D(){return y()?new Promise((O,R)=>{m=R,t.on("enter.intro",()=>O(F)),n.select(".search-header input").on("keyup.intro",()=>{let U=n.select(".feature-list-item:nth-child(0n+2)"),G=U.select(".entity-name"),$=S("intro.graph.name.spring-street");!G.empty()&&G.html()===$&&(e.reveal({revealNode:U.node(),revealPadding:5,tipHtml:oe("intro.navigation.choose_street",{name:$})}),n.select(".search-header input").on("keydown.intro",Br,!0).on("keyup.intro",null))})}).finally(()=>{t.on("enter.intro",null),n.select(".search-header input").on("keydown.intro",null).on("keyup.intro",null)}):Promise.resolve(M)}function F(){let O=u.center();return o.setCenterZoomAsync(O,19,0).then(()=>new Promise((R,U)=>{if(m=U,!v()){R(M);return}e.reveal({revealExtent:u,revealPadding:40,tipHtml:oe("intro.navigation.selected_street",{name:S("intro.graph.name.spring-street")}),buttonText:S.html("intro.ok"),buttonCallback:()=>R(L)}),t.on("enter.intro",U)})).finally(()=>{t.on("enter.intro",null)})}function L(){return v()?new Promise((O,R)=>{m=R,yi(n);let G=H(".entity-editor-pane button.close svg use").attr("href")||"#rapid-icon-close",$=oe("intro.navigation.street_different_fields")+"{br}"+oe("intro.navigation.editor_street",{button:Be(G,"inline"),field1:d.label(),field2:h.label()});e.reveal({revealSelector:".entity-editor-pane",tipHtml:$}),t.on("enter.intro",()=>O(B))}).finally(()=>{t.on("enter.intro",null)}):Promise.resolve(M)}function B(){return r.call("done"),e.reveal({revealSelector:".ideditor",tipSelector:".intro-nav-wrap .chapter-point",tipHtml:oe("intro.navigation.play",{next:S("intro.points.title")}),buttonText:S.html("intro.ok"),buttonCallback:()=>e.reveal({revealSelector:".ideditor"})}),Promise.resolve()}return i.enter=()=>{p=!1,m=null,x(_).catch(O=>{O instanceof Error&&console.error(O)})},i.exit=()=>{p=!0,m&&(m(),m=null)},i.restart=()=>{i.exit(),i.enter()},ge(i,r,"on")}function bA(t,e){let r=fe("done"),i={title:"intro.points.title"},n=t.ui().editMenu(),s=t.container(),o=t.history(),a=t.map(),l=new le([-85.63261,41.94391],[-85.63222,41.94419]),c=xe.item("amenity/cafe"),u=!1,d=null,h=null;function p(){return h&&t.hasEntity(h)}function m(){if(t.mode().id!=="select")return!1;let M=t.selectedIDs();return M.length===1&&M[0]===h}function g(M){return u?Promise.reject():typeof M!="function"?Promise.resolve():M().then(D=>g(D)).catch(D=>(D instanceof Error&&console.error(D),g(M)))}function y(){t.enter("browse"),o.reset("initial"),h=null;let M=l.center(),D=ei(M,a.center());return D>0&&e.hide(),a.setCenterZoomAsync(M,20,D).then(()=>new Promise((F,L)=>{d=L,e.reveal({revealSelector:"button.add-point",tipHtml:oe("intro.points.points_info")+"{br}"+oe("intro.points.add_point")}).selectAll(".popover-inner").insert("svg","span").attr("class","tooltip-illustration").append("use").attr("xlink:href","#rapid-graphic-points"),t.on("enter.intro",()=>F(v))})).finally(()=>{t.on("enter.intro",null)})}function v(){return t.mode().id!=="add-point"?Promise.resolve(y):(h=null,new Promise((M,D)=>{d=D;let F=t.lastPointerType()==="mouse"?"place_point":"place_point_touch";e.reveal({revealExtent:l,tipHtml:oe(`intro.points.${F}`)}),o.on("change.intro",L=>{if(!L)return;let B=L.created();B.length===1&&(h=B[0].id)}),t.on("enter.intro",()=>M(x))}).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null)}))}function x(){return zt().then(()=>new Promise((M,D)=>{if(d=D,!p()){M(y);return}m()||t.enter(Se(t,[h])),s.select(".inspector-wrap").on("wheel.intro",Br),ws(s),e.reveal({revealSelector:".preset-search-input",tipHtml:oe("intro.points.search_cafe",{preset:c.name()})}),s.select(".preset-search-input").on("keydown.intro",null).on("keyup.intro",F);function F(){let L=s.select(".preset-list-item:first-child");L.classed("preset-amenity-cafe")&&(e.reveal({revealNode:L.select(".preset-list-button").node(),revealPadding:5,tipHtml:oe("intro.points.choose_cafe",{preset:c.name()})}),s.select(".preset-search-input").on("keydown.intro",Br,!0).on("keyup.intro",null))}o.on("change.intro",L=>{if(!L)return;let B=L.modified();B.length===1&&(xe.match(B[0],t.graph())===c?M(_):D())}),t.on("enter.intro",D)})).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null),s.select(".inspector-wrap").on("wheel.intro",null),s.select(".preset-search-input").on("keydown.intro keyup.intro",null)})}function _(){return zt().then(()=>new Promise((M,D)=>{if(d=D,!p()){M(y);return}m()||t.enter(Se(t,[h])),yi(s),e.reveal({revealSelector:".entity-editor-pane",tipHtml:oe("intro.points.feature_editor"),tipClass:"intro-points-describe",buttonText:S.html("intro.ok"),buttonCallback:()=>M(b)}),t.on("enter.intro",()=>M(b))})).finally(()=>{t.on("enter.intro",null)})}function b(){return zt().then(()=>new Promise((M,D)=>{if(d=D,!p()){M(y);return}m()||t.enter(Se(t,[h])),yi(s),t.hasEntity(h).tags.name?e.reveal({revealSelector:".entity-editor-pane",tipHtml:oe("intro.points.fields_info"),buttonText:S.html("intro.ok"),buttonCallback:()=>M(w)}).select(".instruction").style("display","none"):e.reveal({revealSelector:".entity-editor-pane",tipHtml:oe("intro.points.fields_info")+"{br}"+oe("intro.points.add_name"),tipClass:"intro-points-describe"}),o.on("change.intro",()=>M(w)),t.on("enter.intro",()=>M(E))})).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null)})}function w(){return p()?(m()||t.enter(Se(t,[h])),new Promise((M,D)=>{d=D,yi(s);let L=H(".entity-editor-pane button.close svg use").attr("href")||"#rapid-icon-close";e.reveal({revealSelector:".entity-editor-pane",tipHtml:oe("intro.points.add_close",{button:Be(L,"inline")})}),t.on("enter.intro",()=>M(E))}).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null)})):Promise.resolve(y)}function E(){if(!p())return Promise.resolve(y);let M=t.entity(h),D=xe.match(M,t.graph());return t.replace(Hn(h,D,c)),o.checkpoint("hasPoint"),Promise.resolve(A)}function A(){t.enter("browse"),o.reset("hasPoint");let M=l.center(),D=ei(M,a.center());return D>0&&e.hide(),a.setCenterZoomAsync(M,20,D).then(()=>new Promise((F,L)=>{d=L,e.reveal({revealExtent:l,tipHtml:oe("intro.points.reselect")}),t.on("enter.intro",()=>F(T))})).finally(()=>{t.on("enter.intro",null)})}function T(){return zt().then(()=>new Promise((M,D)=>{if(d=D,!p()||!m()){M(A);return}yi(s),e.reveal({revealSelector:".entity-editor-pane",tipHtml:oe("intro.points.update"),tipClass:"intro-points-describe"}),o.on("change.intro",()=>M(k)),t.on("enter.intro",D)})).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null)})}function k(){return!p()||!m()?Promise.resolve(A):new Promise((M,D)=>{d=D,yi(s),e.reveal({revealSelector:".entity-editor-pane",tipHtml:oe("intro.points.update_close",{button:Be("#rapid-icon-close","inline")})}),t.on("enter.intro",()=>M(C))}).finally(()=>{t.on("enter.intro",null)})}function C(){return p()?(["browse","select"].includes(t.mode().id)||t.enter("browse"),new Promise((M,D)=>{d=D;let F=t.lastPointerType()==="mouse"?"rightclick":"edit_menu_touch";e.reveal({revealExtent:l,tipHtml:oe(`intro.points.${F}`)}),n.on("toggled.intro",L=>{L&&M(I)}),o.on("change.intro",D)}).finally(()=>{n.on("toggled.intro",null),o.on("change.intro",null)})):Promise.resolve(A)}function I(){return s.select(".edit-menu-item-delete").node()?zt().then(()=>new Promise((D,F)=>{if(d=F,!p()||!m()){D(C);return}e.reveal({revealSelector:".edit-menu",revealPadding:50,tipHtml:oe("intro.points.delete")}),o.on("change.intro",L=>{if(!L)return;let B=L.deleted();B.length===1&&B[0].id===h&&D(P)}),t.on("enter.intro",()=>{p()&&F()})})).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null)}):Promise.resolve(C)}function P(){return new Promise((M,D)=>{d=D,e.reveal({revealSelector:".top-toolbar button.undo-button",tipHtml:oe("intro.points.undo")}),o.on("change.intro",()=>M(N))}).finally(()=>{o.on("change.intro",null)})}function N(){return r.call("done"),e.reveal({revealSelector:".ideditor",tipSelector:".intro-nav-wrap .chapter-area",tipHtml:oe("intro.points.play",{next:S("intro.areas.title")}),buttonText:S.html("intro.ok"),buttonCallback:()=>e.reveal({revealSelector:".ideditor"})}),Promise.resolve()}return i.enter=()=>{u=!1,d=null,g(y).catch(M=>{M instanceof Error&&console.error(M)})},i.exit=()=>{u=!0,d&&(d(),d=null)},i.restart=()=>{i.exit(),i.enter()},ge(i,r,"on")}function wA(t,e){let r=fe("done"),i={title:"intro.areas.title"},n=t.container(),s=t.history(),o=t.map(),a=new le([-85.63575,41.94137],[-85.63526,41.9418]),l=xe.item("leisure/playground"),c=xe.field("name"),u=xe.field("description"),d=!1,h=null,p=null;function m(){return p&&t.hasEntity(p)}function g(){if(t.mode().id!=="select")return!1;let I=t.selectedIDs();return I.length===1&&I[0]===p}function y(I){return d?Promise.reject():typeof I!="function"?Promise.resolve():I().then(P=>y(P)).catch(P=>(P instanceof Error&&console.error(P),y(I)))}function v(){t.enter("browse"),s.reset("initial"),p=null;let I=a.center(),P=ei(I,o.center());return P>0&&e.hide(),o.setCenterZoomAsync(I,19.5,P).then(()=>new Promise((N,M)=>{h=M,e.reveal({revealSelector:"button.draw-area",tipHtml:oe("intro.areas.add_playground")}).selectAll(".popover-inner").insert("svg","span").attr("class","tooltip-illustration").append("use").attr("xlink:href","#rapid-graphic-areas"),t.on("enter.intro",()=>N(x))})).finally(()=>{t.on("enter.intro",null)})}function x(){return t.mode().id!=="draw-area"?Promise.resolve(v):(p=null,new Promise((I,P)=>{h=P;let N=t.lastPointerType()==="mouse"?"click":"tap",M=oe("intro.areas.start_playground")+oe(`intro.areas.starting_node_${N}`);e.reveal({revealExtent:a,tipHtml:M}),s.on("change.intro",D=>{if(D)for(let F of D.created())F.type==="way"&&(p=F.id,I(_))}),t.on("enter.intro",P)}).finally(()=>{s.on("change.intro",null),t.on("enter.intro",null)}))}function _(){return!m()||t.mode().id!=="draw-area"?Promise.resolve(v):new Promise((I,P)=>{h=P,e.reveal({revealExtent:a,tipHtml:oe("intro.areas.continue_playground")}),s.on("change.intro",N=>{if(N)for(let M of N.modified())M.id===p&&M.nodes.length>5&&I(b)}),t.on("enter.intro",P)}).finally(()=>{s.on("change.intro",null),t.on("enter.intro",null)})}function b(){return!m()||t.mode().id!=="draw-area"?Promise.resolve(v):new Promise((I,P)=>{h=P;let N=t.lastPointerType()==="mouse"?"click":"tap",M=oe(`intro.areas.finish_area_${N}`)+oe("intro.areas.finish_playground");e.reveal({revealExtent:a,tipHtml:M}),t.on("enter.intro",()=>I(w))}).finally(()=>{t.on("enter.intro",null)})}function w(){return zt().then(()=>new Promise((I,P)=>{if(h=P,!m()){I(v);return}g()||t.enter(Se(t,[p])),ws(n),n.select(".inspector-wrap").on("wheel.intro",Br),e.reveal({revealSelector:".preset-search-input",tipHtml:oe("intro.areas.search_playground",{preset:l.name()})}),n.select(".preset-search-input").on("keydown.intro",null).on("keyup.intro",N);function N(){let M=n.select(".preset-list-item:first-child");M.classed("preset-leisure-playground")&&(e.reveal({revealNode:M.select(".preset-list-button").node(),revealPadding:5,tipHtml:oe("intro.areas.search_playground",{preset:l.name()})}),n.select(".preset-search-input").on("keydown.intro",Br,!0).on("keyup.intro",null))}s.on("change.intro",M=>{if(!M)return;let D=M.modified();D.length===1&&(xe.match(D[0],t.graph())===l?I(E):P())}),t.on("enter.intro",P)})).finally(()=>{s.on("change.intro",null),t.on("enter.intro",null),n.select(".inspector-wrap").on("wheel.intro",null),n.select(".preset-search-input").on("keydown.intro keyup.intro",null)})}function E(){return zt().then(()=>new Promise((I,P)=>{if(h=P,!m()){I(v);return}if(g()||t.enter(Se(t,[p])),!n.select(".form-field-description").empty()){I(T);return}if(yi(n),n.select(".inspector-wrap").on("wheel.intro",Br),t.entity(p).tags.description){I(C);return}let M=n.select(".more-fields").node().getBoundingClientRect();if(M.top>300){let D=n.select(".entity-editor-pane .inspector-body"),F=D.node().scrollTop,L=F+(M.top-300);D.transition().duration(250).tween("scroll.inspector",()=>{let B=this,O=Hr(F,L);return function(R){B.scrollTop=O(R)}})}window.setTimeout(()=>{e.reveal({revealSelector:".more-fields .combobox-input",revealPadding:5,tipHtml:oe("intro.areas.add_field",{name:c.label(),description:u.label()})}),n.select(".more-fields .combobox-input").on("click.intro",()=>{let D=window.setInterval(()=>{n.select("div.combobox").empty()||(window.clearInterval(D),I(A))},300)})},300),t.on("enter.intro",P)})).finally(()=>{t.on("enter.intro",null),n.select(".inspector-wrap").on("wheel.intro",null),n.select(".more-fields .combobox-input").on("click.intro",null)})}function A(){if(!m())return Promise.resolve(v);if(!g())return Promise.resolve(w);if(!n.select(".form-field-description").empty())return Promise.resolve(T);if(n.select("div.combobox").empty())return Promise.resolve(E);let I;return new Promise((P,N)=>{h=N,I=window.setInterval(()=>{n.select("div.combobox").empty()&&(window.clearInterval(I),window.setTimeout(()=>{n.select(".form-field-description").empty()?P(k):P(T)},300))},300),yi(n),e.reveal({revealSelector:"div.combobox",revealPadding:5,tipHtml:oe("intro.areas.choose_field",{field:u.label()})}),t.on("enter.intro",N)}).finally(()=>{I&&window.clearInterval(I),t.on("enter.intro",null)})}function T(){return m()?g()?n.select(".form-field-description").empty()?Promise.resolve(k):new Promise((I,P)=>{h=P,yi(n),e.reveal({revealSelector:".entity-editor-pane",tipHtml:oe("intro.areas.describe_playground",{button:Be("#rapid-icon-close","inline")})}),t.on("enter.intro",()=>I(C))}).finally(()=>{t.on("enter.intro",null)}):Promise.resolve(w):Promise.resolve(v)}function k(){return m()?g()?new Promise((I,P)=>{h=P,yi(n),e.reveal({revealSelector:".entity-editor-pane",tipHtml:oe("intro.areas.retry_add_field",{field:u.label()}),buttonText:S.html("intro.ok"),buttonCallback:()=>I(E)}),t.on("enter.intro",P)}).finally(()=>{t.on("enter.intro",null)}):Promise.resolve(w):Promise.resolve(v)}function C(){return r.call("done"),e.reveal({revealSelector:".ideditor",tipSelector:".intro-nav-wrap .chapter-line",tipHtml:oe("intro.areas.play",{next:S("intro.lines.title")}),buttonText:S.html("intro.ok"),buttonCallback:()=>e.reveal({revealSelector:".ideditor"})}),Promise.resolve()}return i.enter=()=>{d=!1,h=null,y(v).catch(I=>{I instanceof Error&&console.error(I)})},i.exit=()=>{d=!0,h&&(h(),h=null)},i.restart=()=>{i.exit(),i.enter()},ge(i,r,"on")}function EA(t,e){let r=fe("done"),i={title:"intro.lines.title"},n=t.ui().editMenu(),s=t.container(),o=t.history(),a=t.map(),l="w646",c=new le([-85.63016,41.95749],[-85.62937,41.95843]),u=new le([-85.63044,41.95686],[-85.629,41.95843]),d=[-85.629745,41.95742],h=xe.item("category-road_minor"),p=xe.item("highway/residential"),m="w525",g="n2862",y=new le([-85.62457,41.95381],[-85.62326,41.9548]),v=[-85.6239,41.95397],x=[-85.62387,41.95467],_=[-85.62386,41.9543],b="w522",w="w1",E="n3550",A=new le([-85.62304,41.95084],[-85.62087,41.95336]),T=t.entity(E).loc,k=!1,C=null,I=null,P=null;function N(){return P&&t.hasEntity(P)}function M(){if(t.mode().id!=="select")return!1;let ae=t.selectedIDs();return ae.length===1&&ae[0]===P}function D(){let ae=P&&t.hasEntity(P),pe=l&&t.hasEntity(l);if(!ae||!pe)return!1;let Ee=t.graph();return Ee.childNodes(ae).some(Pe=>Ee.parentWays(Pe).some(Ze=>Ze.id===l))}function F(){return t.hasEntity(m)&&t.hasEntity(g)}function L(){if(t.mode().id!=="select")return!1;let ae=t.selectedIDs();return ae.length===1&&ae[0]===m}function B(){return t.hasEntity(b)&&t.hasEntity(w)&&t.hasEntity(E)}function O(){return I&&t.hasEntity(I)}function R(){if(t.mode().id!=="select")return!1;let ae=t.selectedIDs();return ae.length===1&&ae[0]===E}function U(ae){return k?Promise.reject():typeof ae!="function"?Promise.resolve():ae().then(pe=>U(pe)).catch(pe=>(pe instanceof Error&&console.error(pe),U(ae)))}function G(){t.enter("browse"),o.reset("initial"),P=null;let ae=c.center(),pe=ei(ae,a.center());return pe>0&&e.hide(),a.setCenterZoomAsync(ae,18.5,pe).then(()=>new Promise((Ee,Me)=>{C=Me,e.reveal({revealSelector:"button.draw-line",tipHtml:oe("intro.lines.add_line")}).selectAll(".popover-inner").insert("svg","span").attr("class","tooltip-illustration").append("use").attr("xlink:href","#rapid-graphic-lines"),t.on("enter.intro",()=>Ee($))})).finally(()=>{t.on("enter.intro",null)})}function $(){return t.mode().id!=="draw-line"?Promise.resolve(G):(P=null,new Promise((ae,pe)=>{C=pe;let Ee=t.lastPointerType()==="mouse"?"start_line":"start_line_tap",Me=oe("intro.lines.missing_road")+"{br}"+oe("intro.lines.line_draw_info")+oe(`intro.lines.${Ee}`);e.reveal({revealExtent:c,tipHtml:Me}),o.on("change.intro",Pe=>{if(Pe)for(let Ze of Pe.created())Ze.type==="way"&&(P=Ze.id,ae(q))}),t.on("enter.intro",pe)}).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null)}))}function q(){let ae=u.center(),pe=ei(ae,a.center());return a.setCenterZoomAsync(ae,18.5,pe).then(()=>new Promise((Ee,Me)=>{if(C=Me,!N()||t.mode().id!=="draw-line"){Ee(G);return}e.reveal({revealExtent:u,tipHtml:oe("intro.lines.intersect",{name:S("intro.graph.name.flower-street")})}),o.on("change.intro",()=>{D()&&Ee(Q)}),t.on("enter.intro",()=>Ee(ie))})).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null)})}function ie(){return new Promise((ae,pe)=>{C=pe,e.reveal({revealExtent:new le(d).padByMeters(15),tipHtml:oe("intro.lines.retry_intersect",{name:S("intro.graph.name.flower-street")}),buttonText:S.html("intro.ok"),buttonCallback:()=>ae(G)})})}function Q(){let ae=u.center(),pe=ei(ae,a.center());return a.setCenterZoomAsync(ae,18.5,pe).then(()=>new Promise((Ee,Me)=>{if(C=Me,!N()||t.mode().id!=="draw-line"){Ee(G);return}let Pe=t.lastPointerType()==="mouse"?"click":"tap",Ze=oe("intro.lines.continue_line")+"{br}"+oe(`intro.lines.finish_line_${Pe}`)+oe("intro.lines.finish_road");e.reveal({revealSelector:".main-map",tipHtml:Ze}),t.on("enter.intro",()=>Ee(re))})).finally(()=>{t.on("enter.intro",null)})}function re(){let ae;return zt().then(()=>new Promise((pe,Ee)=>{if(C=Ee,!N()){pe(G);return}if(M()||t.enter(Se(t,[P])),ws(s),s.select(".inspector-wrap").on("wheel.intro",Br),ae=s.select(".preset-category-road_minor .preset-list-button"),ae.empty()){Ee(new Error("no minor roads category?"));return}if(ae.classed("expanded")){pe(ve);return}e.reveal({revealNode:ae.node(),revealPadding:5,tipHtml:oe("intro.lines.choose_category_road",{category:h.name()})}),ae.on("click.intro",()=>pe(ve)),t.on("enter.intro",Ee)})).finally(()=>{ae&&ae.on("click.intro",null),s.select(".inspector-wrap").on("wheel.intro",null),t.on("enter.intro",null)})}function ve(){return zt().then(()=>new Promise((ae,pe)=>{if(C=pe,!N()){ae(G);return}M()||t.enter(Se(t,[P])),ws(s),s.select(".inspector-wrap").on("wheel.intro",Br);let Ee=s.select(".preset-category-road_minor .preset-list-button");if(Ee.empty()){pe(new Error("no minor roads category?"));return}if(!Ee.classed("expanded")){ae(re);return}let Me=s.select(".preset-category-road_minor .subgrid");if(Me.empty()){pe(new Error("no minor roads presets?"));return}e.reveal({revealNode:Me.node(),revealPadding:5,tipSelector:".preset-highway-residential .preset-list-button",tipHtml:oe("intro.lines.choose_preset_residential",{preset:p.name()})}),o.on("change.intro",Pe=>{if(!Pe)return;let Ze=Pe.modified();Ze.length===1&&(xe.match(Ze[0],t.graph())===p?ae(we):ae(de))}),t.on("enter.intro",pe)})).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null),s.select(".inspector-wrap").on("wheel.intro",null)})}function de(){return zt().then(()=>new Promise((ae,pe)=>{if(C=pe,!N()){ae(G);return}M()||t.enter(Se(t,[P])),ws(s),s.select(".inspector-wrap").on("wheel.intro",Br);let Ee=s.select(".preset-category-road_minor .preset-list-button");if(Ee.empty()){pe(new Error("no minor roads category?"));return}if(!Ee.classed("expanded")){ae(re);return}let Me=s.select(".preset-highway-residential .preset-list-button");if(Me.empty()){pe(new Error("no residential road preset?"));return}e.reveal({revealNode:Me.node(),revealPadding:5,tipHtml:oe("intro.lines.retry_preset_residential",{preset:p.name()})}),o.on("change.intro",Pe=>{if(!Pe)return;let Ze=Pe.modified();Ze.length===1&&(xe.match(Ze[0],t.graph())===p?ae(we):ae(re))}),t.on("enter.intro",pe)})).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null),s.select(".inspector-wrap").on("wheel.intro",null)})}function we(){return zt().then(()=>new Promise((ae,pe)=>{if(C=pe,!N()){ae(G);return}M()||t.enter(Se(t,[P])),yi(s),e.reveal({revealSelector:".entity-editor-pane",tipHtml:oe("intro.lines.name_road",{button:Be("#rapid-icon-close","inline")}),tooltipClass:"intro-lines-name_road"}),t.on("enter.intro",()=>ae(ne))})).finally(()=>{t.on("enter.intro",null)})}function ne(){return N()?(o.checkpoint("doneAddLine"),new Promise((ae,pe)=>{C=pe,e.reveal({revealSelector:".main-map",tipHtml:oe("intro.lines.did_name_road"),buttonText:S.html("intro.ok"),buttonCallback:()=>ae(Ie)})})):Promise.resolve(G)}function Ie(){t.enter("browse"),o.reset("doneAddLine"),F()||o.reset("initial");let ae=y.center(),pe=ei(ae,a.center());return pe>0&&e.hide(),a.setCenterZoomAsync(ae,19,pe).then(()=>new Promise((Ee,Me)=>{C=Me,e.reveal({revealExtent:y,tipHtml:oe("intro.lines.update_line"),buttonText:S.html("intro.ok"),buttonCallback:()=>Ee(at)})}))}function at(){return t.enter("browse"),F()?new Promise((ae,pe)=>{C=pe;let Ee=t.lastPointerType()==="mouse"?"":"_touch";e.reveal({revealExtent:new le(v).padByMeters(15),tipHtml:oe(`intro.lines.add_node${Ee}`)}),o.on("change.intro",Me=>{Me&&Me.created().length===1?ae(Et):pe()}),t.on("enter.intro",Me=>{Me.id!=="browse"&&Me.id!=="select"&&pe()})}).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null)}):Promise.resolve(Ie)}function Et(){if(!F())return Promise.resolve(Ie);let ae;return new Promise((pe,Ee)=>{C=Ee;let Me=t.lastPointerType()==="mouse"?"":"_touch",Pe=oe(`intro.lines.start_drag_endpoint${Me}`)+oe("intro.lines.drag_to_intersection");e.reveal({revealExtent:new le(x).padByMeters(20),tipHtml:Pe}),ae=()=>{if(!F())Ee();else{let Ze=t.entity(g);Tt(Ze.loc,x)<=4&&pe($t)}},t.behaviors.get("drag").on("move",ae)}).finally(()=>{ae&&t.behaviors.get("drag").off("move",ae)})}function $t(){if(!F())return Promise.resolve(Ie);let ae;return new Promise((pe,Ee)=>{C=Ee;let Me=t.lastPointerType()==="mouse"?"":"_touch",Pe=oe("intro.lines.spot_looks_good")+oe(`intro.lines.finish_drag_endpoint${Me}`);e.reveal({revealExtent:new le(x).padByMeters(20),tipHtml:Pe}),t.on("enter.intro",()=>pe(Pt)),ae=()=>{if(!F())Ee();else{let Ze=t.entity(g);Tt(Ze.loc,x)>4&&pe(Et)}},t.behaviors.get("drag").on("move",ae)}).finally(()=>{t.on("enter.intro",null),ae&&t.behaviors.get("drag").off("move",ae)})}function Pt(){return F()?(L()||t.enter(Se(t,[m])),new Promise((ae,pe)=>{C=pe,e.reveal({revealExtent:new le(_).padByMeters(20),tipHtml:oe("intro.lines.start_drag_midpoint")}),o.on("change.intro",Ee=>{Ee&&Ee.created().length===1&&ae(J)}),t.on("enter.intro",pe)}).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null)})):Promise.resolve(Ie)}function J(){return F()?new Promise((ae,pe)=>{C=pe,e.reveal({revealExtent:y,tipHtml:oe("intro.lines.continue_drag_midpoint"),buttonText:S.html("intro.ok"),buttonCallback:()=>{o.checkpoint("doneUpdateLine"),ae(V)}})}):Promise.resolve(Ie)}function V(){t.enter("browse"),o.reset("doneUpdateLine"),B()||o.reset("initial");let ae=A.center(),pe=ei(ae,a.center());return pe>0&&e.hide(),a.setCenterZoomAsync(ae,18,pe).then(()=>new Promise((Ee,Me)=>{C=Me,e.reveal({revealExtent:A,tipHtml:oe("intro.lines.delete_lines",{street:S("intro.graph.name.12th-avenue")}),buttonText:S.html("intro.ok"),buttonCallback:()=>Ee(z)})}))}function z(){return t.enter("browse"),o.reset("doneUpdateLine"),B()||o.reset("initial"),I=null,new Promise((ae,pe)=>{C=pe;let Ee=t.lastPointerType()==="mouse"?"rightclick_intersection":"edit_menu_intersection_touch",Me=oe("intro.lines.split_street",{street1:S("intro.graph.name.11th-avenue"),street2:S("intro.graph.name.washington-street")})+oe(`intro.lines.${Ee}`);e.reveal({revealExtent:new le(T).padByMeters(10),tipHtml:Me}),n.on("toggled.intro",Pe=>{Pe&&ae(X)}),o.on("change.intro",pe)}).finally(()=>{n.on("toggled.intro",null),o.on("change.intro",null)})}function X(){if(!s.select(".edit-menu-item-split").node())return Promise.resolve(z);let pe;return I=null,zt().then(()=>new Promise((Ee,Me)=>{if(C=Me,!B()){Ee(V);return}R()||t.enter(Se(t,[E])),pe=(Pe=0)=>{let Ze=s.select(".edit-menu").node();Ze?e.reveal({duration:Pe,revealNode:Ze,revealPadding:50,tipHtml:oe("intro.lines.split_intersection",{street:S("intro.graph.name.washington-street")})}):Me()},pe(250),a.on("move",pe),o.on("change.intro",Pe=>{a.off("move",pe),o.on("change.intro",null),Pe&&Pe.created()?(I=Pe.created()[0].id,Ee()):Me()}),t.on("enter.intro",Me)})).then(zt).then(()=>o.undoAnnotation()===S("operations.split.annotation.line",{n:1})?Y:W).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null),pe&&a.off("move",pe)})}function W(){return t.enter("browse"),new Promise((ae,pe)=>{C=pe,e.reveal({revealExtent:A,tipHtml:oe("intro.lines.retry_split"),buttonText:S.html("intro.ok"),buttonCallback:()=>ae(z)})})}function Y(){return B()?O()?new Promise((ae,pe)=>{C=pe;let Me="intro.lines.did_split_"+(t.selectedIDs().length>1?"multi":"single"),Pe=S("intro.graph.name.washington-street");e.reveal({revealExtent:A,tipHtml:oe(Me,{street1:Pe,street2:Pe})}),t.on("enter.intro",()=>ae(te)),o.on("change.intro",pe)}).finally(()=>{t.on("enter.intro",null),o.on("change.intro",null)}):Promise.resolve(z):Promise.resolve(V)}function te(){if(!B())return Promise.resolve(V);if(!O())return Promise.resolve(z);let ae=t.selectedIDs(),pe=ae.indexOf(I)!==-1,Ee=ae.indexOf(w)!==-1;if(pe&&Ee)return Promise.resolve(ce);if(!pe&&!Ee)return Promise.resolve(Y);let Me,Pe;pe?(Me=S("intro.graph.name.washington-street"),Pe=S("intro.graph.name.12th-avenue")):(Me=S("intro.graph.name.12th-avenue"),Pe=S("intro.graph.name.washington-street"));let Ze=t.lastPointerType()==="mouse"?"click":"touch",Zt=oe("intro.lines.multi_select",{selected:Me,other1:Pe})+" "+oe(`intro.lines.add_to_selection_${Ze}`,{selected:Me,other2:Pe});return e.reveal({revealExtent:A,tipHtml:Zt}),new Promise((Ut,kr)=>{C=kr,t.on("enter.intro",kr),o.on("change.intro",kr)}).finally(()=>{t.on("enter.intro",null),o.on("change.intro",null)})}function ce(){if(!B())return Promise.resolve(V);if(!O())return Promise.resolve(z);let ae=t.selectedIDs(),pe=ae.indexOf(I)!==-1,Ee=ae.indexOf(w)!==-1;return!pe||!Ee?Promise.resolve(te):new Promise((Me,Pe)=>{C=Pe;let Ze=t.lastPointerType()==="mouse"?"rightclick":"edit_menu_touch",Zt=oe("intro.lines.multi_select_success")+oe(`intro.lines.multi_${Ze}`);e.reveal({revealExtent:A,tipHtml:Zt}),n.on("toggled.intro",Ut=>{Ut&&Me(ye)}),o.on("change.intro",Pe),t.on("enter.intro",Pe)}).finally(()=>{n.on("toggled.intro",null),o.on("change.intro",null),t.on("enter.intro",null)})}function ye(){if(!s.select(".edit-menu-item-delete").node())return Promise.resolve(te);let pe;return zt().then(()=>new Promise((Ee,Me)=>{if(C=Me,!B()){Ee(V);return}if(!O()){Ee(z);return}let Pe=t.selectedIDs(),Ze=Pe.indexOf(I)!==-1,Zt=Pe.indexOf(w)!==-1;if(!Ze||!Zt){Ee(te);return}pe=(Ut=0)=>{let kr=s.select(".edit-menu").node();kr?e.reveal({duration:Ut,revealNode:kr,revealPadding:50,tipHtml:oe("intro.lines.multi_delete")}):Me()},pe(250),a.on("move",pe),o.on("change.intro",()=>{o.on("change.intro",null),t.on("enter.intro",null),!t.hasEntity(I)&&!t.hasEntity(w)?Ee(He):Ee(Fe)}),t.on("enter.intro",Ut=>{Ut.id==="browse"&&!t.hasEntity(I)&&!t.hasEntity(w)?Ee(He):Ee(te)})})).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null),pe&&a.off("move",pe)})}function Fe(){return t.enter("browse"),new Promise((ae,pe)=>{C=pe,e.reveal({revealExtent:A,tipHtml:oe("intro.lines.retry_delete"),buttonText:S.html("intro.ok"),buttonCallback:()=>ae(te)})})}function He(){return r.call("done"),e.reveal({revealSelector:".ideditor",tipSelector:".intro-nav-wrap .chapter-building",tipHtml:oe("intro.lines.play",{next:S("intro.buildings.title")}),buttonText:S.html("intro.ok"),buttonCallback:()=>e.reveal({revealSelector:".ideditor"})}),Promise.resolve()}return i.enter=()=>{k=!1,C=null,U(G).catch(ae=>{ae instanceof Error&&console.error(ae)})},i.exit=()=>{k=!0,C&&(C(),C=null)},i.restart=()=>{i.exit(),i.enter()},ge(i,r,"on")}function SA(t,e){let r=fe("done"),i={title:"intro.buildings.title"},n=t.ui().editMenu(),s=t.container(),o=t.history(),a=t.map(),l=new le([-85.62836,41.95622],[-85.62791,41.95654]),c=new le([-85.62766,41.95324],[-85.62695,41.95372]),u=xe.item("category-building"),d=xe.item("building/house"),h=xe.item("man_made/storage_tank"),p=!1,m=null,g=null,y=null;function v(){return g&&t.hasEntity(g)}function x(){if(t.mode().id!=="select")return!1;let Q=t.selectedIDs();return Q.length===1&&Q[0]===g}function _(){return y&&t.hasEntity(y)}function b(){if(t.mode().id!=="select")return!1;let Q=t.selectedIDs();return Q.length===1&&Q[0]===y}function w(Q){return p?Promise.reject():typeof Q!="function"?Promise.resolve():Q().then(re=>w(re)).catch(re=>(re instanceof Error&&console.error(re),w(Q)))}function E(){t.enter("browse"),o.reset("initial"),g=null;let Q=l.center(),re=ei(Q,a.center());return re>0&&e.hide(),a.setCenterZoomAsync(Q,19,re).then(()=>new Promise((ve,de)=>{m=de,e.reveal({revealSelector:"button.draw-area",tipHtml:oe("intro.buildings.add_building")}).selectAll(".popover-inner").insert("svg","span").attr("class","tooltip-illustration").append("use").attr("xlink:href","#rapid-graphic-buildings"),t.on("enter.intro",()=>ve(A))})).finally(()=>{t.on("enter.intro",null)})}function A(){return g=null,a.setCenterZoomAsync(l.center(),20,200).then(()=>new Promise((Q,re)=>{if(m=re,t.mode().id!=="draw-area"){Q(E);return}let ve=t.lastPointerType()==="mouse"?"click":"tap",de=oe("intro.buildings.start_building")+oe(`intro.buildings.building_corner_${ve}`);e.reveal({revealExtent:l,tipHtml:de}),o.on("change.intro",we=>{if(we)for(let ne of we.created())ne.type==="way"&&(g=ne.id,Q(T))}),t.on("enter.intro",re)})).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null)})}function T(){return!v()||t.mode().id!=="draw-area"?Promise.resolve(E):new Promise((Q,re)=>{m=re;let ve=t.lastPointerType()==="mouse"?"click":"tap",de=oe("intro.buildings.continue_building")+"{br}"+oe(`intro.areas.finish_area_${ve}`)+oe("intro.buildings.finish_building");e.reveal({revealExtent:l,tipHtml:de}),t.on("enter.intro",()=>{if(v()&&x()){let we=t.graph(),ne=t.entity(g),Ie=we.childNodes(ne),at=$e(Ie).map(Et=>t.projection.project(Et.loc));vA(at)?Q(C):Q(k)}else re()})}).finally(()=>{t.on("enter.intro",null)})}function k(){return new Promise((Q,re)=>{m=re,e.reveal({revealExtent:l,tipHtml:oe("intro.buildings.retry_building"),buttonText:S.html("intro.ok"),buttonCallback:()=>Q(E)})})}function C(){return zt().then(()=>new Promise((Q,re)=>{if(m=re,!v()){Q(E);return}x()||t.enter(Se(t,[g])),ws(s),s.select(".inspector-wrap").on("wheel.intro",Br);let ve=s.select(".preset-category-building .preset-list-button");e.reveal({revealNode:ve.node(),revealPadding:5,tipHtml:oe("intro.buildings.choose_category_building",{category:u.name()})}),ve.on("click.intro",()=>Q(I)),t.on("enter.intro",re)})).finally(()=>{s.select(".inspector-wrap").on("wheel.intro",null),s.select(".preset-list-button").on("click.intro",null),t.on("enter.intro",null)})}function I(){return zt().then(()=>new Promise((Q,re)=>{if(m=re,!v()){Q(E);return}x()||t.enter(Se(t,[g])),ws(s),s.select(".inspector-wrap").on("wheel.intro",Br);let ve=s.select(".preset-building-house .preset-list-button");e.reveal({revealNode:ve.node(),revealPadding:5,tipHtml:oe("intro.buildings.choose_preset_house",{preset:d.name()})}),o.on("change.intro",de=>{if(!de)return;let we=de.modified();we.length===1&&(xe.match(we[0],t.graph())===d?Q(P):Q(C))}),t.on("enter.intro",re)})).finally(()=>{s.select(".inspector-wrap").on("wheel.intro",null),s.select(".preset-list-button").on("click.intro",null),o.on("change.intro",null),t.on("enter.intro",null)})}function P(){if(!v())return Promise.resolve(E);let Q=t.entity(g),re=xe.match(Q,t.graph());return t.replace(Hn(g,re,d)),o.checkpoint("hasHouse"),Promise.resolve(N)}function N(){["browse","select"].includes(t.mode().id)||t.enter("browse"),o.reset("hasHouse");let Q=Math.max(a.zoom(),20);return a.setCenterZoomAsync(l.center(),Q,100).then(()=>new Promise((re,ve)=>{m=ve;let de=t.lastPointerType()==="mouse"?"rightclick_building":"edit_menu_building_touch";e.reveal({revealExtent:l,tipHtml:oe(`intro.buildings.${de}`)}),n.on("toggled.intro",we=>{we&&re(M)}),o.on("change.intro",ve)})).finally(()=>{n.on("toggled.intro",null),o.on("change.intro",null)})}function M(){if(!s.select(".edit-menu-item-orthogonalize").node())return Promise.resolve(N);let re;return zt().then(()=>new Promise((ve,de)=>{if(m=de,!v()||!x()){ve(N);return}re=(we=0)=>{let ne=s.select(".edit-menu").node();ne?e.reveal({duration:we,revealNode:ne,revealPadding:50,tipHtml:oe("intro.buildings.square_building")}):de()},re(250),a.on("move",re),o.on("change.intro",()=>{a.off("move",re),o.on("change.intro",null),e.reveal({revealExtent:l}),ve()}),t.on("enter.intro",de)})).then(zt).then(()=>o.undoAnnotation()===S("operations.orthogonalize.annotation.feature",{n:1})?F:D).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null),re&&a.off("move",re)})}function D(){return t.enter("browse"),new Promise((Q,re)=>{m=re,e.reveal({revealExtent:l,tipHtml:oe("intro.buildings.retry_square"),buttonText:S.html("intro.ok"),buttonCallback:()=>Q(N)})})}function F(){return o.checkpoint("doneSquare"),new Promise((Q,re)=>{m=re,e.reveal({revealExtent:l,tipHtml:oe("intro.buildings.done_square"),buttonText:S.html("intro.ok"),buttonCallback:()=>Q(L)})})}function L(){t.enter("browse"),o.reset("doneSquare"),y=null;let Q=c.center(),re=ei(Q,a.center());return re>0&&e.hide(),a.setCenterZoomAsync(Q,19.5,re).then(()=>new Promise((ve,de)=>{m=de,e.reveal({revealSelector:"button.draw-area",tipHtml:oe("intro.buildings.add_tank")}),t.on("enter.intro",()=>ve(B))})).finally(()=>{t.on("enter.intro",null)})}function B(){return t.mode().id!=="draw-area"?Promise.resolve(L):(y=null,new Promise((Q,re)=>{m=re;let ve=t.lastPointerType()==="mouse"?"click":"tap",de=oe("intro.buildings.start_tank")+oe(`intro.buildings.tank_edge_${ve}`);e.reveal({revealExtent:c,tipHtml:de}),o.on("change.intro",we=>{if(we)for(let ne of we.created())ne.type==="way"&&(y=ne.id,Q(O))}),t.on("enter.intro",re)}).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null)}))}function O(){return t.mode().id!=="draw-area"?Promise.resolve(L):new Promise((Q,re)=>{m=re;let ve=t.lastPointerType()==="mouse"?"click":"tap",de=oe("intro.buildings.continue_tank")+"{br}"+oe(`intro.areas.finish_area_${ve}`)+oe("intro.buildings.finish_tank");e.reveal({revealExtent:c,tipHtml:de}),t.on("enter.intro",()=>{_()&&b()?Q(R):re()})}).finally(()=>{t.on("enter.intro",null)})}function R(){return zt().then(()=>new Promise((Q,re)=>{if(m=re,!_()){Q(L);return}b()||t.enter(Se(t,[y])),s.select(".inspector-wrap").on("wheel.intro",Br),ws(s),e.reveal({revealSelector:".preset-search-input",tipHtml:oe("intro.buildings.search_tank",{preset:h.name()})}),s.select(".preset-search-input").on("keydown.intro",null).on("keyup.intro",ve);function ve(){let de=s.select(".preset-list-item:first-child");de.classed("preset-man_made-storage_tank")&&(e.reveal({revealNode:de.select(".preset-list-button").node(),revealPadding:5,tipHtml:oe("intro.buildings.choose_tank",{preset:h.name()})}),s.select(".preset-search-input").on("keydown.intro",Br,!0).on("keyup.intro",null))}o.on("change.intro",de=>{if(!de)return;let we=de.modified();we.length===1&&(xe.match(we[0],t.graph())===h?Q(U):re())}),t.on("enter.intro",re)})).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null),s.select(".inspector-wrap").on("wheel.intro",null),s.select(".preset-search-input").on("keydown.intro keyup.intro",null)})}function U(){if(!_())return Promise.resolve(L);let Q=t.entity(y),re=xe.match(Q,t.graph());return t.replace(Hn(y,re,h)),o.checkpoint("hasTank"),Promise.resolve(G)}function G(){return["browse","select"].includes(t.mode().id)||t.enter("browse"),o.reset("hasTank"),new Promise((Q,re)=>{m=re;let ve=t.lastPointerType()==="mouse"?"rightclick_tank":"edit_menu_tank_touch";e.reveal({revealExtent:c,tipHtml:oe(`intro.buildings.${ve}`)}),n.on("toggled.intro",de=>{de&&Q($)}),o.on("change.intro",re)}).finally(()=>{n.on("toggled.intro",null),o.on("change.intro",null)})}function $(){if(!s.select(".edit-menu-item-circularize").node())return Promise.resolve(G);let re;return zt().then(()=>new Promise((ve,de)=>{if(m=de,!_()||!b()){ve(G);return}re=(we=0)=>{let ne=s.select(".edit-menu").node();ne?e.reveal({duration:we,revealNode:ne,revealPadding:50,tipHtml:oe("intro.buildings.circle_tank")}):de()},re(250),a.on("move",re),o.on("change.intro",()=>{a.off("move",re),o.on("change.intro",null),e.reveal({revealExtent:c}),ve()}),t.on("enter.intro",de)})).then(zt).then(()=>o.undoAnnotation()===S("operations.circularize.annotation.feature",{n:1})?ie:q).finally(()=>{o.on("change.intro",null),t.on("enter.intro",null),re&&a.off("move",re)})}function q(){return t.enter("browse"),new Promise((Q,re)=>{m=re,e.reveal({revealExtent:c,tipHtml:oe("intro.buildings.retry_circle"),buttonText:S.html("intro.ok"),buttonCallback:()=>Q(G)})})}function ie(){return r.call("done"),e.reveal({revealSelector:".ideditor",tipSelector:".intro-nav-wrap .chapter-rapid",tipHtml:oe("intro.buildings.play",{next:S("intro.rapid.title")}),buttonText:S.html("intro.ok"),buttonCallback:()=>e.reveal({revealSelector:".ideditor"})}),Promise.resolve()}return i.enter=()=>{p=!1,m=null,w(E).catch(Q=>{Q instanceof Error&&console.error(Q)})},i.exit=()=>{p=!0,m&&(m(),m=null)},i.restart=()=>{i.exit(),i.enter()},ge(i,r,"on")}function TA(t,e){let r=fe("done","startEditing"),i={title:"intro.startediting.title"},n=t.container(),s=!1,o=null;function a(h){return s?Promise.reject():typeof h!="function"?Promise.resolve():h().then(p=>a(p)).catch(p=>(p instanceof Error&&console.error(p),a(h)))}function l(){return new Promise((h,p)=>{o=p,e.reveal({revealSelector:".map-control.help-control",tipHtml:oe("intro.startediting.help"),buttonText:S.html("intro.ok"),buttonCallback:()=>h(c)})})}function c(){return new Promise((h,p)=>{o=p,e.reveal({revealSelector:".map-control.help-control",tipHtml:oe("intro.startediting.shortcuts"),buttonText:S.html("intro.ok"),buttonCallback:()=>h(u)})})}function u(){return n.selectAll(".shaded").remove(),new Promise((h,p)=>{o=p,e.reveal({revealSelector:".top-toolbar button.save",tipHtml:oe("intro.startediting.save"),buttonText:S.html("intro.ok"),buttonCallback:()=>h(d)})})}function d(){n.selectAll(".shaded").remove();let h=Er(n);return h.select(".modal").attr("class","modal-splash modal"),h.selectAll(".close").remove(),new Promise((p,m)=>{o=m,r.call("startEditing");let g=h.select(".content").attr("class","fillL").append("button").attr("class","modal-section huge-modal-button").on("click",p);g.append("svg").attr("class","illustration").append("use").attr("xlink:href","#rapid-logo-walkthrough"),g.append("h2").html(S.html("intro.startediting.start"))}).finally(()=>{h.remove()})}return i.enter=()=>{s=!1,o=null,a(l).catch(h=>{h instanceof Error&&console.error(h)})},i.exit=()=>{n.selectAll(".shaded").remove(),s=!0,o&&(o(),o=null)},ge(i,r,"on")}function AA(t,e){let r=fe("done"),i={title:"intro.rapid.title"},n=t.history(),s=t.map(),o="w-516",a=new le([-85.62991,41.95568],[-85.627,41.95638]),l=!1,c=null;function u(){if(t.mode().id!=="select")return!1;let C=t.selectedIDs();return C.length===1&&C[0]===o}function d(){return t.hasEntity(o)}function h(C){return l?Promise.reject():typeof C!="function"?Promise.resolve():C().then(I=>h(I)).catch(I=>(I instanceof Error&&console.error(I),h(C)))}function p(){t.enter("browse"),n.reset("initial");let C=a.center(),I=ei(C,s.center());return I>0&&e.hide(),s.setCenterZoomAsync(C,18.5,I).then(()=>new Promise((P,N)=>{c=N,e.reveal({revealSelector:".intro-nav-wrap .chapter-rapid",tipHtml:oe("intro.rapid.start",{rapid:Be("#rapid-logo-rapid-wordmark","pre-text rapid")}),buttonText:S.html("intro.ok"),buttonCallback:()=>P(m)})}))}function m(){return new Promise((C,I)=>{c=I,e.reveal({revealSelector:"button.rapid-features",tipHtml:oe("intro.rapid.ai_roads",{rapid:Be("#rapid-logo-rapid-wordmark","pre-text rapid")}),buttonText:S.html("intro.ok"),buttonCallback:()=>C(g)})})}function g(){return t.enter("browse"),n.reset("initial"),t.scene().enableLayers("rapid"),t.ui().togglePanes(),new Promise((C,I)=>{c=I,H(".inspector-wrap").on("wheel.intro",Br),e.reveal({revealExtent:a,tipHtml:oe("intro.rapid.select_road")}),t.on("enter.intro",()=>C(y))}).finally(()=>{H(".inspector-wrap").on("wheel.intro",null),t.on("enter.intro",null)})}function y(){return zt().then(()=>new Promise((C,I)=>{if(c=I,!u()){C();return}e.reveal({revealSelector:".rapid-inspector-choice-accept",tipHtml:oe("intro.rapid.add_road")}),t.on("enter.intro",C)})).then(()=>n.undoAnnotation()?.type==="rapid_accept_feature"?v:g).finally(()=>{t.on("enter.intro",null)})}function v(){return zt().then(()=>new Promise((C,I)=>{if(c=I,!d()){C(g);return}u()||t.enter(Se(t,[o])),e.reveal({revealExtent:a,tipHtml:oe("intro.rapid.add_road_not_saved_yet",{rapid:Be("#rapid-logo-rapid-wordmark","pre-text rapid")}),buttonText:S("intro.ok"),buttonCallback:()=>C(x)}),t.on("enter.intro",I)})).finally(()=>{t.on("enter.intro",null)})}function x(){if(!d())return Promise.resolve(g);u()||t.enter(Se(t,[o]));let C=H("div.map-control.issues-control > button");return new Promise((I,P)=>{c=P,e.reveal({revealNode:C.node(),tipHtml:oe("intro.rapid.open_issues")}),t.on("enter.intro",P),C.on("click.intro",()=>I(_))}).finally(()=>{t.on("enter.intro",null),C.on("click.intro",null)})}function _(){return zt().then(()=>new Promise((C,I)=>{if(c=I,!d()){C(g);return}u()||t.enter(Se(t,[o]));let P=H("li.issue.severity-warning");e.reveal({revealNode:P.node(),revealPadding:5,tipHtml:oe("intro.rapid.new_lints"),buttonText:S("intro.ok"),buttonCallback:()=>C(b)})}))}function b(){if(!d())return Promise.resolve(g);u()||t.enter(Se(t,[o]));let C=H(".top-toolbar button.undo-button");return new Promise((I,P)=>{c=P,e.reveal({revealNode:C.node(),tipHtml:oe("intro.rapid.undo_road_add",{button:Be("#rapid-icon-undo","pre-text")})}),C.on("click.intro",()=>I(w))}).finally(()=>{C.on("click.intro",null)})}function w(){return d()?Promise.resolve(g):(t.ui().togglePanes(),new Promise((C,I)=>{c=I,e.reveal({revealExtent:a,tipHtml:oe("intro.rapid.undo_road_add_aftermath"),buttonText:S("intro.ok"),buttonCallback:()=>C(E)})}))}function E(){t.enter("browse"),n.reset("initial");let C=a.center(),I=ei(C,s.center());return I>0&&e.hide(),s.setCenterZoomAsync(C,18.5,I).then(()=>new Promise((P,N)=>{c=N,e.reveal({revealExtent:a,tipHtml:oe("intro.rapid.select_road_again")}),t.on("enter.intro",()=>{t.selectedIDs().indexOf(o)!==-1&&P(A)})})).finally(()=>{t.on("enter.intro",null)})}function A(){return zt().then(()=>new Promise((C,I)=>{if(c=I,!u()){C();return}e.reveal({revealSelector:".rapid-inspector-choice-ignore",tipHtml:oe("intro.rapid.ignore_road")}),t.on("enter.intro",C)})).then(()=>n.undoAnnotation()?.type==="rapid_ignore_feature"?T:E).finally(()=>{t.on("enter.intro",null)})}function T(){return new Promise((C,I)=>{c=I,e.reveal({revealSelector:".map-control.help-control",tipHtml:oe("intro.rapid.help",{rapid:Be("#rapid-logo-rapid-wordmark","pre-text rapid"),button:Be("#rapid-icon-help","pre-text"),key:S("help.key")}),buttonText:S("intro.ok"),buttonCallback:()=>C(k)})})}function k(){return r.call("done"),e.reveal({revealSelector:".ideditor",tipSelector:".intro-nav-wrap .chapter-startEditing",tipHtml:oe("intro.rapid.done",{next:S("intro.startediting.title")}),buttonText:S.html("intro.ok"),buttonCallback:()=>e.reveal({revealSelector:".ideditor"})}),Promise.resolve()}return i.enter=()=>{t.scene().enableLayers("rapid"),l=!1,c=null,h(p).catch(C=>{C instanceof Error&&console.error(C)})},i.exit=()=>{t.scene().disableLayers("rapid"),l=!0,c&&(c(),c=null)},i.restart=()=>{i.exit(),i.enter()},ge(i,r,"on")}var vB={welcome:xA,navigation:_A,point:bA,area:wA,line:EA,building:SA,rapid:AA,startEditing:TA},D3=["welcome","navigation","point","area","line","building","rapid","startEditing"];function Qs(t,e){let r="EsriWorldImageryClarity",i={},n={},s;function o(l){Promise.all([Qe.get("intro_rapid_graph"),Qe.get("intro_graph")]).then(c=>{let u=c[0],d=c[1];for(let h in u)n[h]||(n[h]=Te(Ug(u[h])));for(let h in d)i[h]||(i[h]=Te(Ug(d[h])));l.call(a,e)})}function a(l){t.inIntro(!0),t.enter("browse");let c=t.connection(),u=t.imagery(),d=t.history(),h={hash:window.location.hash,transform:t.map().transform(),brightness:u.brightness,baseLayer:u.baseLayerSource(),overlayLayers:u.overlayLayerSources(),layerEnabled:new Map,historyJSON:d.toJSON()};for(let[T,k]of t.scene().layers)h.layerEnabled.set(T,k.enabled);t.scene().onlyLayers(["background","osm","labels"]),t.ui().sidebar.expand(),t.container().selectAll("button.sidebar-toggle").classed("disabled",!0),c&&c.toggle(!1).reset(),d.reset(),d.merge(Object.values(i)),d.checkpoint("initial");let p=u.findSource(r)||u.findSource("Bing");u.baseLayerSource(p),h.overlayLayers.forEach(T=>u.toggleOverlayLayer(T)),u.brightness=1;let m=t.rapidContext().datasets(),g=JSON.parse(JSON.stringify(m));Object.keys(m).forEach(T=>m[T].enabled=!1),m.rapid_intro_graph={id:"rapid_intro_graph",beta:!1,added:!0,enabled:!0,conflated:!1,service:"fbml",color:"#da26d3",label:"Rapid Walkthrough"},K.fbMLRoads&&(K.fbMLRoads.toggle(!1),K.fbMLRoads.merge("rapid_intro_graph",Object.values(n)));let y=new Wh(t);l.call(y.enable),ee("walkthrough_started","yes");let x=(ee("walkthrough_progress")||"").split(";").filter(Boolean),_=D3.map((T,k)=>{let C=vB[T](t,y).on("done",()=>{if(E.filter(I=>I.title===C.title).classed("finished",!0),k<D3.length-1){let I=D3[k+1];t.container().select(`button.chapter-${I}`).classed("next",!0)}x.push(T),ee("walkthrough_progress",$e(x).join(";"))});return C});_[_.length-1].on("startEditing",()=>{x.push("startEditing"),ee("walkthrough_progress",$e(x).join(";")),si(D3,x).length||ee("walkthrough_completed","yes");let k=t.rapidContext().datasets();delete k.rapid_intro_graph,Object.keys(g).forEach(C=>k[C].enabled=g[C].enabled),Object.assign(k,g),K.fbMLRoads&&K.fbMLRoads.toggle(!0),y.disable(),b.remove(),t.container().selectAll("button.sidebar-toggle").classed("disabled",!1);for(let[C,I]of t.scene().layers)I.enabled=h.layerEnabled.get(C);u.baseLayerSource(h.baseLayer),h.overlayLayers.forEach(C=>u.toggleOverlayLayer(C)),u.brightness=h.brightness,t.map().transform(h.transform),window.location.replace(h.hash),d.reset(),h.historyJSON&&d.fromJSON(h.historyJSON,!0),c&&c.toggle(!0).reset(),t.inIntro(!1)});let b=l.append("div").attr("class","intro-nav-wrap fillD");b.append("svg").attr("class","intro-nav-wrap-logo").append("use").attr("xlink:href","#rapid-logo-walkthrough");let E=b.append("div").attr("class","joined").selectAll("button.chapter").data(_).enter().append("button").attr("class",(T,k)=>`chapter chapter-${D3[k]}`).on("click",A);E.append("span").html(T=>S.html(T.title)),E.append("span").attr("class","status").call(Z(se.textDirection()==="rtl"?"#rapid-icon-backward":"#rapid-icon-forward","inline")),A(null,_[e?6:0]);function A(T,k){s&&s.exit(),t.enter("browse"),s=k,s.enter(),E.classed("next",!1).classed("active",C=>C.title===s.title)}}return o}function qh(t){return function(e){if(ee("sawRapidSplash"))return;ee("sawRapidSplash",!0);let r=Er(e);r.select(".modal").attr("class","modal rapid-modal modal-splash");let i=r.select(".content");i.append("div").attr("class","modal-section").append("h3").text(S("rapid_splash.welcome")),i.append("div").attr("class","modal-section").append("p").html(S("rapid_splash.text",{rapidicon:Be("#rapid-logo-rapid-wordmark","logo-rapid"),walkthrough:Be("#rapid-logo-walkthrough","logo-walkthrough"),edit:Be("#rapid-logo-features","logo-features")}));let n=i.append("div").attr("class","modal-actions"),s=n.append("button").attr("class","walkthrough").on("click",()=>{t.container().call(Qs(t,!1)),r.close()});s.append("svg").attr("class","logo logo-features").append("use").attr("xlink:href","#rapid-logo-walkthrough"),s.append("div").text(S("rapid_splash.walkthrough"));let o=n.append("button").attr("class","rapid-walkthrough").on("click",()=>{t.container().call(Qs(t,!0)),r.close()});o.append("svg").attr("class","logo logo-rapid").append("use").attr("xlink:href","#rapid-logo-rapid-wordmark"),o.append("div").text(S("rapid_splash.skip_to_rapid"));let a=n.append("button").attr("class","start-editing").on("click",()=>{r.close()});a.append("svg").attr("class","logo logo-features").append("use").attr("xlink:href","#rapid-logo-features"),a.append("div").text(S("rapid_splash.start")),r.select("button.close").attr("class","hide")}}function Yh(t){return function(e){let r=Er(e);r.select(".modal").attr("class","modal rapid-modal");let i=r.select(".content");i.append("div").attr("class","modal-section").append("h3").html(S("rapid_first_edit.nice",{rapidicon:Be("#rapid-logo-rapid-wordmark","logo-rapid")})),i.append("div").attr("class","modal-section").append("p").text(S("rapid_first_edit.text"));let n=i.append("div").attr("class","modal-actions");n.append("button").attr("class","rapid-explore").on("click",()=>{r.close()}).append("div").text(S("rapid_first_edit.exploring")),n.append("button").attr("class","rapid-login-to-osm").on("click",()=>{r.close();let a=t.connection();a&&a.authenticate(()=>t.container().call(qh(t)))}).append("div").text(S("rapid_first_edit.login_with_osm")),r.select("button.close").attr("class","hide")}}function yu(t,e){let r=t.rapidContext(),n=r.showPowerUser?1/0:50,s;function o(){return t.initialHashParams.hasOwnProperty("gpx")?!1:t.history().peekAllAnnotations().filter(v=>v.type==="rapid_accept_feature").length>=n}function a(){if(!s)return;if(o()){gu(t).duration(5e3).label(S("rapid_feature_inspector.option_accept.disabled_flash",{n}))();return}let m={type:"rapid_accept_feature",description:S("rapid_feature_inspector.option_accept.annotation"),id:s.id,origid:s.__origid__},y=(s.__service__==="esri"?K.esriData:K.fbMLRoads).graph(s.__datasetid__),v=s.tags&&s.tags.source;if(v&&(m.source=v),t.perform(Qh(s.id,y),m),t.enter(Se(t,[s.id])),t.inIntro()||(r.sources.add("mapwithai"),v&&/^esri/.test(v)&&r.sources.add("esri"),window.sessionStorage.getItem("acknowledgedLogin")==="true"))return;window.sessionStorage.setItem("acknowledgedLogin","true"),t.connection().authenticated()||t.container().call(Yh(t))}function l(){if(!s)return;let m={type:"rapid_ignore_feature",description:S("rapid_feature_inspector.option_ignore.annotation"),id:s.id,origid:s.__origid__};t.perform(hr(),m),t.enter("browse")}function c(m){let g=m.length<6,y=parseInt(g?m[1]+m[1]:m[1]+m[2],16),v=parseInt(g?m[2]+m[2]:m[3]+m[4],16),x=parseInt(g?m[3]+m[3]:m[5]+m[6],16);return(y*299+v*587+x*114)/1e3}function u(m){if(!s)return;let g=s.__datasetid__.replace("-conflated",""),y=r.datasets()[g],v=y.color,x=m.selectAll(".feature-info").data([v]),_=x.enter().append("div").attr("class","feature-info");_.append("div").attr("class","dataset-label").text(y.label||y.id),y.beta&&_.append("div").attr("class","dataset-beta beta").attr("title",S("rapid_poweruser_features.beta")),x=x.merge(_).style("background",b=>b).style("color",b=>c(b)>140.5?"#333":"#fff")}function d(m){let g=s&&s.tags;if(!g)return;let v=m.selectAll(".tag-info").data([0]).enter().append("div").attr("class","tag-info").append("div").attr("class","tag-bag");v.append("div").attr("class","tag-heading").text(S("rapid_feature_inspector.tags")),Object.keys(g).map(_=>({key:_,value:g[_]})).forEach(_=>{let b=v.append("div").attr("class","tag-entry");b.append("div").attr("class","tag-key").text(_.key),b.append("div").attr("class","tag-value").text(_.value)})}function h(m){let g=m.selectAll(".rapid-inspector").data([0]),y=g.enter().append("div").attr("class","rapid-inspector");g=g.merge(y);let v=g.selectAll(".header").data([0]).enter().append("div").attr("class","header");v.append("h3").append("svg").attr("class","logo-rapid").append("use").attr("xlink:href","#rapid-logo-rapid-wordmark"),v.append("button").attr("class","fr rapid-inspector-close").on("click",()=>{t.enter("browse")}).call(Z("#rapid-icon-close"));let x=g.selectAll(".body").data([0]),_=x.enter().append("div").attr("class","body");x=x.merge(_).call(u).call(d);let b=[{key:"accept",iconName:"#rapid-icon-rapid-plus-circle",label:S("rapid_feature_inspector.option_accept.label"),description:S("rapid_feature_inspector.option_accept.description"),onClick:a},{key:"ignore",iconName:"#rapid-icon-rapid-minus-circle",label:S("rapid_feature_inspector.option_ignore.label"),description:S("rapid_feature_inspector.option_ignore.description"),onClick:l}],E=x.selectAll(".rapid-inspector-choices").data([0]).enter().append("div").attr("class","rapid-inspector-choices");E.append("p").text(S("rapid_feature_inspector.prompt")),E.selectAll(".rapid-inspector-choice").data(b,A=>A.key).enter().append("div").attr("class",A=>`rapid-inspector-choice rapid-inspector-choice-${A.key}`).each(p)}function p(m,g,y){let v=H(y[g]),x=m.key==="accept"&&o()?"secondary disabled":"",_=v.append("div").attr("class",`choice-wrap choice-wrap-${m.key}`),b=v.append("div").attr("class","tag-reference-body");b.text(m.description);let w=m.onClick,E=_.append("button").attr("class",`choice-button choice-button-${m.key} ${x}`).on("click",w),A,T;m.key==="accept"?o()?(A=S("rapid_feature_inspector.option_accept.disabled",{n}),T=[]):(A=S("rapid_feature_inspector.option_accept.tooltip"),T=[S("rapid_feature_inspector.option_accept.key")]):m.key==="ignore"&&(A=S("rapid_feature_inspector.option_ignore.tooltip"),T=[S("rapid_feature_inspector.option_ignore.key")]),A&&T&&(E=E.call(Ae().placement("bottom").title(A).keys(T))),E.append("svg").attr("class","choice-icon icon").append("use").attr("xlink:href",m.iconName),E.append("div").attr("class","choice-label").text(m.label),_.append("button").attr("class",`tag-reference-button ${x}`).attr("title","info").attr("tabindex","-1").on("click",()=>{b.classed("expanded",!b.classed("expanded"))}).call(Z("#rapid-icon-inspect"))}return h.datum=function(m){return arguments.length?(s=m,this):s},e&&e().on(S("rapid_feature_inspector.option_accept.key"),a).on(S("rapid_feature_inspector.option_ignore.key"),l),h}var CA=!1,mu=class extends Wr{constructor(e){super(e),this.id="select",this.keybinding=null,this.extent=null}enter(e={}){let r=e.selection;if(!(r instanceof Map)||!r.size)return!1;let[[i,n]]=r.entries();CA&&console.log(`ModeSelect: entering, selected ${i}`),this._selectedData=r,this._active=!0;let s=this.context;s.enableBehaviors(["hover","select","drag","map-interaction","lasso","paste"]);let o=s.ui().sidebar,a=null;this.extent=new le;for(let l of r.values()){let c;if(l.loc)c=new le(l.loc);else if(l.__featurehash__){let u=N4(l);c=new le(u[0],u[1])}else if(l.__fbid__){let u=l.__service__==="esri"?K.esriData:K.fbMLRoads;if(!u)continue;let d=u.graph(l.__datasetid__);if(!d)continue;c=l.extent(d)}c&&(this.extent=this.extent.extend(c))}return n instanceof Jt?(a=pu(s).note(n),a.on("change",()=>{if(s.map().immediateRedraw(),!K.osm)return;let l=K.osm.getNote(i);l instanceof Jt&&(s.ui().sidebar.show(a.note(l)),this._selectedData.set(i,l))})):n instanceof Rt&&n.service==="improveOSM"?(a=fu(s).error(n),a.on("change",()=>{if(s.map().immediateRedraw(),!K.improveOSM)return;let l=K.improveOSM.getError(i);l instanceof Rt&&(s.ui().sidebar.show(a.error(l)),this._selectedData.set(i,l))})):n instanceof Rt&&n.service==="keepRight"?(a=du(s).error(n),a.on("change",()=>{if(s.map().immediateRedraw(),!K.keepRight)return;let l=K.keepRight.getError(i);l instanceof Rt&&(s.ui().sidebar.show(a.error(l)),this._selectedData.set(i,l))})):n instanceof Rt&&n.service==="osmose"?(a=Vh(s).error(n),a.on("change",()=>{if(s.map().immediateRedraw(),!K.osmose)return;let l=K.osmose.getError(i);l instanceof Rt&&(s.ui().sidebar.show(a.error(l)),this._selectedData.set(i,l))})):n.__featurehash__?a=I0(s).datum(n):n.__fbid__&&(this.keybinding=rt("select-ai-features"),a=yu(s,this.keybinding).datum(n)),a&&o.show(a),!0}exit(){this._active&&(this._active=!1,this.extent=null,this.keybinding&&(H(document).call(this.keybinding.unbind),this.keybinding=null),CA&&console.log("ModeSelect: exiting"),this._selectedData.clear(),this.context.ui().sidebar.hide())}};var kA=dt(C2(),1);var Es=class{constructor(e){this._id=e.id,this._idtx=e.id.replace(/\./g,"<TX_DOT>"),this._name=e.name,this._description=e.description,this._template=e.encrypted?ox(e.template):e.template,this.best=!!e.best,this.endDate=e.endDate,this.icon=e.icon,this.overlay=e.overlay,this.overzoom=e.overzoom!==!1,this.polygon=e.polygon,this.projection=e.projection,this.startDate=e.startDate,this.terms_html=e.terms_html,this.terms_text=e.terms_text,this.terms_url=e.terms_url,this.tileSize=e.tileSize||256,this.type=e.type,this.zoomExtent=e.zoomExtent||[0,22],this.isBlocked=!1,this.offset=[0,0]}get id(){return this._id}get idtx(){return this._idtx}get name(){return S(`imagery.${this._idtx}.name`,{default:this._name})}get label(){return S.html(`imagery.${this._idtx}.name`,{default:this._name})}get description(){return S.html(`imagery.${this._idtx}.description`,{default:this._description})}get imageryUsed(){return this._name||this._id}get template(){return this._template}get area(){if(!this.polygon)return Number.MAX_VALUE;let e=oo({type:"MultiPolygon",coordinates:[this.polygon]});return isNaN(e)?0:e}validZoom(e){return this.zoomExtent[0]<=e&&(this.overzoom||this.zoomExtent[1]>e)}isLocatorOverlay(){return this._id==="mapbox_locator_overlay"}isHidden(){return this._id==="DigitalGlobe-Premium-vintage"||this._id==="DigitalGlobe-Standard-vintage"}copyrightNotices(){}getMetadata(e,r,i){let n={start:this._localeDateString(this.startDate),end:this._localeDateString(this.endDate)};n.range=this._vintageRange(n),i(null,{vintage:n})}nudge(e,r){return this.offset[0]+=e[0]/Math.pow(2,r),this.offset[1]+=e[1]/Math.pow(2,r),this}url(e){let r=this._template;if(r==="")return r;function i(n,s,o,a){let l=Math.pow(2,a),c=s/l*Math.PI*2-Math.PI,u=Math.atan(Math.sinh(Math.PI*(1-2*o/l))),d;switch(n){case"EPSG:4326":return{x:c*180/Math.PI,y:u*180/Math.PI};default:return d=_c(c,u),{x:2003750834e-2/Math.PI*d[0],y:2003750834e-2/Math.PI*d[1]}}}if(this.type||(/SERVICE=WMS|\{(proj|wkid|bbox)\}/.test(this._template)?(this.type="wms",this.projection="EPSG:3857"):/\{(x|y)\}/.test(this._template)?this.type="tms":/\{u\}/.test(this._template)&&(this.type="bing")),this.type==="wms"){let n=this.tileSize,s=this.projection,o=i(s,e[0],e[1],e[2]),a=i(s,e[0]+1,e[1]+1,e[2]);r=r.replace(/\{(\w+)\}/g,(l,c)=>{switch(c){case"width":case"height":return n;case"proj":return s;case"wkid":return s.replace(/^EPSG:/,"");case"bbox":return s==="EPSG:4326"&&/VERSION=1.3|CRS={proj}/.test(this._template.toUpperCase())?a.y+","+o.x+","+o.y+","+a.x:o.x+","+a.y+","+a.x+","+o.y;case"w":return o.x;case"s":return a.y;case"n":return a.x;case"e":return o.y;default:return l}})}else if(this.type==="tms"){let n=window.devicePixelRatio&&window.devicePixelRatio>=2;r=r.replace("{x}",e[0]).replace("{y}",e[1]).replace(/\{[t-]y\}/,Math.pow(2,e[2])-e[1]-1).replace(/\{z(oom)?\}/,e[2]).replace(/\{@2x\}|\{r\}/,n?"@2x":"")}else this.type==="bing"&&(r=r.replace("{u}",()=>{let n="";for(let s=e[2];s>0;s--){let o=0,a=1<<s-1;e[0]&a&&o++,e[1]&a&&(o+=2),n+=o.toString()}return n}));return r=r.replace(/\{switch:([^}]+)\}/,(n,s)=>{let o=s.split(",");return o[(e[0]+e[1])%o.length]}),r}_localeDateString(e){if(!e)return null;let r={day:"numeric",month:"short",year:"numeric"},i=new Date(e);return isNaN(i.getTime())?null:i.toLocaleDateString(se.localeCode(),r)}_vintageRange(e){let r;return(e.start||e.end)&&(r=e.start||"?",e.start!==e.end&&(r+=" - "+(e.end||"?"))),r}},Kh=class extends Es{constructor(){super({id:"none",template:""})}get name(){return S("background.none")}get label(){return S.html("background.none")}get area(){return-1}get imageryUsed(){return null}},Zh=class extends Es{constructor(){super({id:"custom",template:""})}get name(){return S("background.custom")}get label(){return S.html("background.custom")}get area(){return-2}get imageryUsed(){let e=this._template;if(e.indexOf("?")!==-1){let r=e.split("?",2),i=Fn(r[1]);["access_token","connectId","token"].forEach(n=>{i[n]&&(i[n]="{apikey}")}),e=r[0]+"?"+xt(i,!0)}return e=e.replace(/token\/(\w+)/,"token/{apikey}"),`Custom (${e} )`}set template(e){this._template=e}get template(){return this._template}},Jh=class extends Es{constructor(e){super(e),this._template="https://ecn.t{switch:0,1,2,3}.tiles.virtualearth.net/tiles/a{u}.jpeg?g=1&pr=odbl&n=z",this.terms_url="https://blog.openstreetmap.org/2010/11/30/microsoft-imagery-details"}},e6=class extends Es{constructor(e){super(e),/blankTile/.test(this._template)||(this._template+="?blankTile=false"),this._cache={},this._inflight={},this._prevCenter=null}fetchTilemap(e){if(this._prevCenter&&Tt(e,this._prevCenter)<5e3)return;this._prevCenter=e;let r=this.url([1,2,3]),i=20,n=Math.floor((e[0]+180)/360*Math.pow(2,i)),s=Math.floor((1-Math.log(Math.tan(e[1]*Math.PI/180)+1/Math.cos(e[1]*Math.PI/180))/Math.PI)/2*Math.pow(2,i)),o=r.replace(/tile\/[0-9]+\/[0-9]+\/[0-9]+\?blankTile=false/,"tilemap")+"/"+i+"/"+s+"/"+n+"/8/8";It(o).then(a=>{if(!a)throw new Error("Unknown Error");let l=!0;for(let c=0;c<a.data.length;c++)if(!a.data[c]){l=!1;break}this.zoomExtent[1]=l?22:19}).catch(a=>console.error(a))}getMetadata(e,r,i){let n=r.slice(0,3).join("/"),s=Math.min(r[2],this.zoomExtent[1]),o=e[0]+","+e[1],a=S("info_panels.background.unknown");if(this._inflight[n])return;let l;switch(!0){case(s>=20&&this._id==="EsriWorldImageryClarity"):l=4;break;case s>=19:l=3;break;case s>=17:l=2;break;case s>=13:l=0;break;default:l=99}let c;if(this._id==="EsriWorldImagery")c="https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/";else if(this._id==="EsriWorldImageryClarity")c="https://serviceslab.arcgisonline.com/arcgis/rest/services/Clarity_World_Imagery/MapServer/";else return;if(c+=l+"/query?returnGeometry=false&geometry="+o+"&inSR=4326&geometryType=esriGeometryPoint&outFields=*&f=json",this._cache[n]||(this._cache[n]={}),this._cache[n]&&this._cache[n].metadata)return i(null,this._cache[n].metadata);let u={},d={};l===99?(u={start:null,end:null,range:null},d={vintage:null,source:a,description:a,resolution:a,accuracy:a},i(null,d)):(this._inflight[n]=!0,It(c).then(p=>{if(delete this._inflight[n],p){if(p.features&&p.features.length<1)throw new Error("No Results");if(p.error&&p.error.message)throw new Error(p.error.message)}else throw new Error("Unknown Error");var m=this._localeDateString(p.features[0].attributes.SRC_DATE2);u={start:m,end:m,range:m},d={vintage:u,source:h(p.features[0].attributes.NICE_NAME),description:h(p.features[0].attributes.NICE_DESC),resolution:h(+parseFloat(p.features[0].attributes.SRC_RES).toFixed(4)),accuracy:h(+parseFloat(p.features[0].attributes.SRC_ACC).toFixed(4))},isFinite(d.resolution)&&(d.resolution+=" m"),isFinite(d.accuracy)&&(d.accuracy+=" m"),this._cache[n].metadata=d,i&&i(null,d)}).catch(p=>{delete this._inflight[n],i&&i(p.message)}));function h(p){return String(p).trim()||a}}};var vu=class extends xr.default{constructor(e){super(),this.context=e,this._setupPromise=null,this._imageryIndex=null,this._baseLayer=null,this._overlayLayers=[],this._checkedBlocklists=[],this._isValid=!0,this._brightness=1,this._contrast=1,this._saturation=1,this._sharpness=1,this._numGridSplits=0,this._hashchange=this._hashchange.bind(this)}init(){this._setupPromise=this._setupImageryAsync(),this.context.urlhash().on("hashchange",this._hashchange)}_hashchange(e){this._setupPromise&&this._setupPromise.then(()=>{let r;typeof e.background=="string"&&(r=this.findSource(e.background)),r||(r=this.chooseDefaultSource()),this.baseLayerSource(r);let i=new Set;typeof e.overlays=="string"&&(i=new Set(e.overlays.split(",")));for(let o of this.overlayLayerSources())o.isLocatorOverlay()||i.has(o.id)||this.toggleOverlayLayer(o);let n,s;typeof e.offset=="string"&&([n,s]=e.offset.replace(/;/g,",").split(",").map(Number)),(isNaN(n)||!isFinite(n))&&(n=0),(isNaN(s)||!isFinite(s))&&(s=0),this.offset=Uf([n,s])})}updateImagery(){let e=this._baseLayer;if(this.context.inIntro()||!e)return;let r=[],i=[],n=e.imageryUsed;n&&this._isValid&&r.push(n);let s=e.id;s==="custom"&&(s=`custom:${e.template}`);let o=this._overlayLayers.filter(h=>!h.isLocatorOverlay()&&!h.isHidden());for(let h of o)i.push(h.id),r.push(h.imageryUsed);this.context.history().imageryUsed(r);let a=this.context.urlhash();a.setParam("background",s),a.setParam("overlays",i.length?i.join(","):null);let l=Gf(e.offset),c=.01,u=+l[0].toFixed(2),d=+l[1].toFixed(2);a.setParam("offset",Math.abs(u)>c||Math.abs(d)>c?`${u},${d}`:null)}sources(e,r){if(!this._imageryIndex)return[];let i=new Set;(this._imageryIndex.query.bbox(e.rectangle(),!0)||[]).forEach(c=>i.add(c.id));let n=this._baseLayer,s=[...this._imageryIndex.sources.values()],o=this.context.connection(),a=o&&o.imageryBlocklists()||[];if(a.length!==this._checkedBlocklists.length||a.some((c,u)=>String(c)!==this._checkedBlocklists[u])){for(let c of s)c.isBlocked=a.some(u=>u.test(c.template));this._checkedBlocklists=a.map(c=>String(c))}return s.filter(c=>n===c?!0:c.isBlocked?!1:c.polygon?r&&r<6?!1:i.has(c.id):!0)}baseLayerSource(e){if(!arguments.length)return this._baseLayer;let r=this.context.connection();if(!r)return this;let i=r.imageryBlocklists(),n=e.template,s=!1,o=0,a;for(a of i)if(s=a.test(n),o++,s)break;return o||(a=/.*\.google(apis)?\..*\/(vt|kh)[\?\/].*([xyz]=.*){3}.*/,s=a.test(n)),this._baseLayer=s?this.findSource("none"):e,this.updateImagery(),this.emit("imagerychange"),this}chooseDefaultSource(){let e=this.context.map(),r=this.sources(e.extent(),e.zoom()),i=r[0];return r.find(s=>s.best)||this.findSource(ee("background-last-used"))||this.findSource("Bing")||this.findSource("Maxar-Premium")||i||this.findSource("none")}findSource(e){return this._imageryIndex?this._imageryIndex.sources.get(e):null}showsLayer(e){let r=this._baseLayer;return!e||!r?!1:e.id===r.id||this._overlayLayers.some(i=>e.id===i.id)}overlayLayerSources(){return this._overlayLayers}toggleOverlayLayer(e){let r;for(let i=0;i<this._overlayLayers.length;i++)if(r=this._overlayLayers[i],r===e){this._overlayLayers.splice(i,1),this.updateImagery(),this.emit("imagerychange");return}r=e,this._overlayLayers.push(r),this.updateImagery(),this.emit("imagerychange")}nudge(e,r){this._baseLayer&&(this._baseLayer.nudge(e,r),this.updateImagery(),this.emit("imagerychange"))}get offset(){return this._baseLayer&&this._baseLayer.offset||[0,0]}set offset([e,r]=[0,0]){let[i,n]=this._baseLayer&&this._baseLayer.offset||[0,0];e===i&&r===n||this._baseLayer&&(this._baseLayer.offset=[e,r],this.updateImagery(),this.emit("imagerychange"))}get brightness(){return this._brightness}set brightness(e=1){e!==this._brightness&&(this._brightness=e,this.context.scene().layers.get("background")?.setBrightness(e),this.emit("imagerychange"))}get contrast(){return this._contrast}set contrast(e=1){e!==this._contrast&&(this._contrast=e,this.context.scene().layers.get("background")?.setContrast(e),this.emit("imagerychange"))}get saturation(){return this._saturation}set saturation(e=1){e!==this._saturation&&(this._saturation=e,this.context.scene().layers.get("background")?.setSaturation(e),this.emit("imagerychange"))}get sharpness(){return this._sharpness}set sharpness(e=1){e!==this._sharpness&&(this._sharpness=e,this.context.scene().layers.get("background")?.setSharpness(e),this.emit("imagerychange"))}get numGridSplits(){return this._numGridSplits}set numGridSplits(e=0){e!==this._numGridSplits&&(this._numGridSplits=e,this.emit("imagerychange"))}_setupImageryAsync(){return this._setupPromise?this._setupPromise:Qe.get("imagery").then(e=>{this._imageryIndex={features:new Map,sources:new Map,query:null};let r=e.map(o=>{if(!o.polygon)return null;let a=o.polygon.map(c=>[c]),l={type:"Feature",properties:{id:o.id},geometry:{type:"MultiPolygon",coordinates:a}};return this._imageryIndex.features.set(o.id,l),l}).filter(Boolean);this._imageryIndex.query=(0,kA.default)({type:"FeatureCollection",features:r});for(let o of e){let a;o.type==="bing"?a=new Jh(o):/^EsriWorldImagery/.test(o.id)?a=new e6(o):a=new Es(o),this._imageryIndex.sources.set(o.id,a)}let i=new Kh;this._imageryIndex.sources.set(i.id,i);let n=new Zh;n.template=ee("background-custom-template")||"",this._imageryIndex.sources.set(n.id,n);let s=this._imageryIndex.sources.get("mapbox_locator_overlay");return s&&this.toggleOverlayLayer(s),this._imageryIndex}).catch(e=>{e instanceof Error&&console.error(e)})}};var t6=class extends xr.default{constructor(e){super(),this._enabled=!1,this.renderer=e,this.context=e.context,this.pointerOverRenderer=!1,this.modifierKeys=new Set,this.coord=[0,0],this._wheelDefault=Rr().os==="mac"?"auto":"zoom",this._click=this._click.bind(this),this._keydown=this._keydown.bind(this),this._keyup=this._keyup.bind(this),this._pointercancel=this._pointercancel.bind(this),this._pointerdown=this._pointerdown.bind(this),this._pointermove=this._pointermove.bind(this),this._pointerout=this._pointerout.bind(this),this._pointerover=this._pointerover.bind(this),this._pointerup=this._pointerup.bind(this),this._wheel=this._wheel.bind(this),this.enable()}get enabled(){return this._enabled}enable(){if(this._enabled)return;this._enabled=!0,this.modifierKeys.clear(),window.addEventListener("keydown",this._keydown),window.addEventListener("keyup",this._keyup),this.renderer.supersurface.node().addEventListener("wheel",this._wheel,{passive:!1});let r=this.context.pixi.view;r.addEventListener("pointerover",this._pointerover),r.addEventListener("pointerout",this._pointerout);let i=this.context.pixi.stage;i.addEventListener("click",this._click),i.addEventListener("pointerdown",this._pointerdown),i.addEventListener("pointermove",this._pointermove),i.addEventListener("pointerup",this._pointerup),i.addEventListener("pointerupoutside",this._pointercancel),i.addEventListener("pointercancel",this._pointercancel)}disable(){if(!this._enabled)return;this._enabled=!1,this.modifierKeys.clear(),window.removeEventListener("keydown",this._keydown),window.removeEventListener("keyup",this._keyup),this.renderer.supersurface.node().removeEventListener("wheel",this._wheel);let r=this.context.pixi.view;r.removeEventListener("pointerover",this._pointerover),r.removeEventListener("pointerout",this._pointerout);let i=this.context.pixi.stage;i.removeEventListener("click",this._click),i.removeEventListener("pointerdown",this._pointerdown),i.removeEventListener("pointermove",this._pointermove),i.removeEventListener("pointerup",this._pointerup),i.removeEventListener("pointerupoutside",this._pointercancel),i.removeEventListener("pointercancel",this._pointercancel)}setCursor(e){this.renderer.stage.cursor=e,this.renderer.pixi.view.style.cursor=e}_observeModifierKeys(e){let r=this.modifierKeys,i=["Alt","Control","Meta","Shift"],n=!1;for(let s of i){let o=e.getModifierState(s),a=r.has(s);o&&!a?(r.add(s),n=!0):!o&&a&&(r.delete(s),n=!0)}n&&this.emit("modifierchanged",r)}_keydown(e){this._observeModifierKeys(e),this.emit("keydown",e)}_keyup(e){this._observeModifierKeys(e),this.emit("keyup",e)}_pointerover(e){this._observeModifierKeys(e),this.pointerOverRenderer=!0,this.emit("pointerover",e)}_pointerout(e){this._observeModifierKeys(e),this.pointerOverRenderer=!1,this.emit("pointerout",e)}_pointerdown(e){this._observeModifierKeys(e),this.coord=[e.global.x,e.global.y],this.emit("pointerdown",e)}_pointermove(e){this._observeModifierKeys(e),this.coord=[e.global.x,e.global.y],this.emit("pointermove",e)}_pointerup(e){this._observeModifierKeys(e),this.coord=[e.global.x,e.global.y],this.emit("pointerup",e)}_pointercancel(e){this.emit("pointercancel",e)}_click(e){this.emit("click",e)}_wheel(e){e.preventDefault(),e.stopImmediatePropagation();let[r,i]=this._normalizeWheelDelta(e);this.coord=[e.offsetX,e.offsetY];let n=typeof i=="number"&&isFinite(i)&&Math.floor(i)===i,s=!n&&e.ctrlKey&&!this.modifierKeys.has("Control"),o="zoom",a=3;if(s)o="zoom",a=6;else if(e.shiftKey)o="zoom",a=3;else{let l=ee("prefs.mouse_wheel.interaction")??this._wheelDefault;l==="pan"||l==="auto"&&(r||n)?(o="pan",a=1):(o="zoom",a=3)}e._gesture=o,e._normalizedDeltaX=r*a,e._normalizedDeltaY=i*a,this.emit("wheel",e)}_normalizeWheelDelta(e){let[r,i]=[e.deltaX,e.deltaY];i===0&&e.shiftKey&&([r,i]=[e.deltaY,e.deltaX]);let[n,s]=[Math.sign(r),Math.sign(i)],[o,a]=[Math.abs(r),Math.abs(i)],l=typeof a=="number"&&isFinite(o)&&Math.floor(o)===o,c=typeof a=="number"&&isFinite(a)&&Math.floor(a)===a,u=l?0:.001,d=c?0:.001;if(e.deltaMode!==WheelEvent.DOM_DELTA_PIXEL){let g;e.deltaMode===WheelEvent.DOM_DELTA_LINE?g=8:e.deltaMode===WheelEvent.DOM_DELTA_PAGE?g=24:g=1,o*=g,a*=g}let h=40,p=n*(Math.min(h,o)+u),m=s*(Math.min(h,a)+d);return[p,m]}};var _r=class{static makeArea(t,e,r){return t|e<<15|r<<30}static getOpenOffset(t){return t&(1<<15)-1}static getCloseOffset(t){return t>>15&(1<<15)-1}static getOrientation(t){return t>>30&1}static setOpenOffset(t,e){return _r.makeArea(e,_r.getCloseOffset(t),_r.getOrientation(t))}static setCloseOffset(t,e){return _r.makeArea(_r.getOpenOffset(e),e,_r.getOrientation(t))}},xB=class extends an{constructor(t,e){super(t,e),this.managedItems=[]}upload(t,e,r){let i=t.gl,n=e.realWidth,s=e.realHeight;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===$r.UNPACK),(r.width!==n||r.height!==s)&&(r.width=n,r.height=s,i.texImage2D(e.target,0,e.format,n,s,0,e.format,e.type,void 0));let o=this.managedItems;for(let a=0,l=o.length;a<l;a++)this.uploadItem(t,e.target,e.format,e.type,o[a]);return!0}uploadItem(t,e,r,i,n){if(n.updateId===n.dirtyId)return;let s=t.gl,o=s instanceof WebGL2RenderingContext,a=n.frame,l=n.source;if(!o){if(l instanceof ImageData)l=l.data;else if(l instanceof HTMLCanvasElement){let c=l.getContext("2d"),[u,d]=[l.width,l.height];l=c.getImageData(0,0,u,d).data}else if(l instanceof HTMLImageElement){let[c,u]=[l.naturalWidth,l.naturalHeight],d=document.createElement("canvas");d.width=c,d.height=u;let h=d.getContext("2d");h.drawImage(l,0,0),l=h.getImageData(0,0,c,u).data}}s.texSubImage2D(e,0,a.x,a.y,a.width,a.height,r,i,l),n.updateId=n.dirtyId}};var IA=new Re,MA=class{constructor(t,e){this._width=t,this._height=e,this._root=[null,_r.makeArea(0,this._height,0),!1]}allocate(t,e,r){let i=this.findArea(t,e);if(!i)return null;r||(r=new Re),this.getFrame(i,r);let n=new Re(r.x,r.y,t,e),s=this.split(i,r,n);return r.copyFrom(n),r.__mem_area=s,r}free(t){let e=t.__mem_area;e[2]=!1,this.merge(e)}get width(){return this._width}get height(){return this._height}getAreaField(t){return t[1]}getFrame(t,e){e||(e=new Re);let r=this.getAreaField(t),i=this.getParent(t),n=_r.getOrientation(r),s=_r.getOpenOffset(r),o=_r.getCloseOffset(r),a=i?_r.getOpenOffset(i[1]):0,l=i?_r.getCloseOffset(i[1]):this._width;return n?(e.x=s,e.y=a,e.width=o-e.x,e.height=l-a):(e.x=a,e.y=s,e.width=l-e.x,e.height=o-e.y),e}getParent(t){return t[0]}hasChildren(t){return Array.isArray(t[2])&&t[2].length!==0}getChildren(t){if(!Array.isArray(t[2]))throw new Error("Children don't exist");return t[2]}addChild(t,...e){t[2]=Array.isArray(t[2])?t[2]:[],t[2].push(...e)}findArea(t,e){return this.findAreaRecursive(this._root,t,e)}findAreaRecursive(t,e,r){let i=this.getFrame(t,IA);if(i.width<e||i.height<r)return null;if(!this.hasChildren(t)){let a=i.width-e,l=i.height-r;return a<0||l<0||t[2]?null:t}let n=this.getChildren(t),s=null,o=1/0;for(let a=0,l=n.length;a<l;a++){let c=this.findAreaRecursive(n[a],e,r);if(!c)continue;let u=this.getFrame(c,IA),d=u.width-e,h=u.height-r;if(d<0||h<0)continue;if(!d&&!h)return c;let p=Math.min(d,h);o>p&&(s=c,o=p)}return s}splitOrientation(t,e){if(e.width===t.width&&e.height===t.height)return 2;if(e.width===t.width)return 1;if(e.height===t.height)return 0;let r=Math.abs((t.width-e.width)*t.height-e.width*(t.height-e.height)),i=Math.abs(t.width*(t.height-e.height)-(t.width-e.width)*e.height);return r>i?0:1}split(t,e,r,i=this.getParent(t)?this.splitOrientation(e,r):0){if(t[2]===!0)throw new Error("Cannot deallocate");return i===2?(t[2]=!0,t):this[i===0?"splitPrimaryHorizontal":"splitPrimaryVertical"](t,e,r)}splitPrimaryHorizontal(t,e,r){let i=this.getAreaField(t),n=_r.getOrientation(i),s=this.getParent(t);if(this.hasChildren(t))throw new Error("Can't split non-leaf node");let o=[t,_r.makeArea(e.left,e.x+r.width,1),[]],a=[t,_r.makeArea(e.x+r.width,e.right,1),!1];if(n===0)this.addChild(t,o,a);else{let l=this.getChildren(s).indexOf(t);o[0]=s,a[0]=s,this.getChildren(s).splice(l,1,o,a)}if(r.height!==e.height){let l=[o,_r.makeArea(e.top,e.y+r.height,0),!0],c=[o,_r.makeArea(e.y+r.height,e.bottom,0),!1];return this.addChild(o,l,c),l}else o[2]=!0;return o}splitPrimaryVertical(t,e,r){let i=this.getAreaField(t),n=_r.getOrientation(i),s=this.getParent(t);if(this.hasChildren(t))throw new Error("Can't split non-leaf node");let o=[t,_r.makeArea(e.top,e.y+r.height,0),[]],a=[t,_r.makeArea(e.y+r.height,e.bottom,0),!1];if(n===1)this.addChild(t,o,a);else{let l=this.getChildren(s).indexOf(t);o[0]=s,a[0]=s,this.getChildren(s).splice(l,1,o,a)}if(r.width!==e.height){let l=[o,_r.makeArea(e.left,e.x+r.width,1),!0],c=[o,_r.makeArea(e.x+r.width,e.right,1),!1];return this.addChild(o,l,c),l}else o[2]=!0;return o}merge(t){if(this.hasChildren(t))throw new Error("Cannot merge a non-leaf node");let e=this.getParent(t);if(!e)return;let r=this.getChildren(e),i=r.indexOf(t),n=r[i-1],s=r[i+1];s&&s[2]===!1&&(t[1]=_r.setCloseOffset(t[1],_r.getCloseOffset(s[1])),r.splice(i+1,1)),n&&n[2]===!1&&(t[1]=_r.setOpenOffset(t[1],_r.getOpenOffset(n[1])),r.splice(i-1,1)),r.length===1&&(e[2]=!1,this.merge(e))}printState(t){this.hasChildren(t)?this.getChildren(t).forEach(e=>this.printState(e)):console.log({...this.getFrame(t)},t[2])}},Gg=new Re,_B=class{constructor(t=2048,e=2048){this.slabWidth=t,this.slabHeight=e,this.textureSlabs=[]}get maxWidth(){return this.slabWidth-2*this.calculatePadding(this.slabWidth,this.slabHeight)}get maxHeight(){return this.slabHeight-2*this.calculatePadding(this.slabWidth,this.slabHeight)}allocate(t,e,r=this.calculatePadding(t,e)){if(t+2*r>this.slabWidth||e+2*r>this.slabHeight)return null;let i=this.textureSlabs;for(let s=0,o=i.length;s<o;s++){let a=i[s],l=this.issueTexture(a,t,e,r);if(l)return l}let n=this.createSlab();return this.textureSlabs.unshift(n),this.issueTexture(n,t,e,r)}free(t){let e=t.baseTexture,r=this.textureSlabs.find(n=>n.slab===e);if(!r)throw new Error("The texture cannot be freed because its base-texture is not pooled by this allocator. This is either a bug in TextureAllocator or you tried to free a texture that was never allocated by one.");let i=r.managedTextures.find(n=>n.texture===t);if(!i)throw new Error("The texture cannot be freed because it was not found in the managed list of issued textures on its slab. This may be because you duplicated this texture or a bug in TextureAllocator");r.managedArea.free(i.area),r.managedTextures.splice(r.managedTextures.indexOf(i),1)}calculatePadding(t,e){let r=Math.max(t,e);return r<64?2:r<128?4:r<1024?8:16}createSlab(){return{managedArea:new MA(this.slabWidth,this.slabHeight),managedTextures:[],slab:new Le(null,{width:this.slabWidth,height:this.slabHeight})}}createTexture(t,e){return new be(t,e)}issueTexture(t,e,r,i=0){let n=t.managedArea.allocate(e+2*i,r+2*i);if(!n)return null;Gg.copyFrom(n),Gg.pad(-i);let s=t.slab,o=this.createTexture(s,Gg.clone());return t.managedTextures.push({area:n,texture:o}),o}},xu=class extends _B{createSlab(){return{managedArea:new MA(this.slabWidth,this.slabHeight),managedTextures:[],slab:new Le(new xB(this.slabWidth,this.slabHeight),{width:this.slabWidth,height:this.slabHeight})}}allocate(t,e,r,i){let n;typeof r=="number"?n=r:(n=this.calculatePadding(t,e),i=r);let s=super.allocate(t,e,n);if(i){let o=s.baseTexture.resource,a={frame:s.frame,source:i,dirtyId:i instanceof HTMLImageElement&&!i.complete?-1:0,updateId:-1,texture:s};o.managedItems.push(a),i instanceof HTMLImageElement&&!i.complete&&i.addEventListener("load",()=>{s.baseTexture.valid&&!s.baseTexture.destroyed&&o.managedItems.indexOf(a)>=0&&(a.dirtyId++,s.baseTexture.update())}),s.baseTexture.update()}return s}free(t){super.free(t);let e=t.baseTexture.resource,r=e.managedItems.find(i=>i.texture===t);r&&e.managedItems.splice(e.managedItems.indexOf(r),1)}};var bB=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,wB=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform float gamma;
uniform float contrast;
uniform float saturation;
uniform float brightness;
uniform float red;
uniform float green;
uniform float blue;
uniform float alpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (c.a > 0.0) {
        c.rgb /= c.a;

        vec3 rgb = pow(c.rgb, vec3(1. / gamma));
        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);
        rgb.r *= red;
        rgb.g *= green;
        rgb.b *= blue;
        c.rgb = rgb * brightness;

        c.rgb *= c.a;
    }

    gl_FragColor = c * alpha;
}
`,r6=class extends ke{constructor(e){super(bB,wB),this.gamma=1,this.saturation=1,this.contrast=1,this.brightness=1,this.red=1,this.green=1,this.blue=1,this.alpha=1,Object.assign(this,e)}apply(e,r,i,n){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,e.applyFilter(this,r,i,n)}};var EB=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,SB=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,TB=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`,xl=class extends ke{constructor(e=4,r=3,i=!1){super(EB,i?TB:SB),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new Ne,this.pixelSize=1,this._clamp=i,Array.isArray(e)?this.kernels=e:(this._blur=e,this.quality=r)}apply(e,r,i,n){let s=this._pixelSize.x/r._frame.width,o=this._pixelSize.y/r._frame.height,a;if(this._quality===1||this._blur===0)a=this._kernels[0]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,r,i,n);else{let l=e.getFilterTexture(),c=r,u=l,d,h=this._quality-1;for(let p=0;p<h;p++)a=this._kernels[p]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,c,u,1),d=c,c=u,u=d;a=this._kernels[h]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,c,i,n),e.returnFilterTexture(l)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((e,r)=>e+r+.5,0))}_generateKernels(){let e=this._blur,r=this._quality,i=[e];if(e>0){let n=e,s=e/r;for(let o=1;o<r;o++)n-=s,i.push(n)}this._kernels=i,this._updatePadding()}get kernels(){return this._kernels}set kernels(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max(...e)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(e){typeof e=="number"?(this._pixelSize.x=e,this._pixelSize.y=e):Array.isArray(e)?(this._pixelSize.x=e[0],this._pixelSize.y=e[1]):e instanceof Ne?(this._pixelSize.x=e.x,this._pixelSize.y=e.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}get blur(){return this._blur}set blur(e){this._blur=e,this._generateKernels()}};var PA=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,AB=`
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform float threshold;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > threshold) {
        gl_FragColor = color;
    } else {
        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`,zg=class extends ke{constructor(e=.5){super(PA,AB),this.threshold=e}get threshold(){return this.uniforms.threshold}set threshold(e){this.uniforms.threshold=e}},CB=`uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform sampler2D bloomTexture;
uniform float bloomScale;
uniform float brightness;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);
    color.rgb *= brightness;
    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= bloomScale;
    gl_FragColor = color + bloomColor;
}
`,RA=class extends ke{constructor(t){super(PA,CB),this.bloomScale=1,this.brightness=1,this._resolution=ue.FILTER_RESOLUTION,typeof t=="number"&&(t={threshold:t});let e=Object.assign(RA.defaults,t);this.bloomScale=e.bloomScale,this.brightness=e.brightness;let{kernels:r,blur:i,quality:n,pixelSize:s,resolution:o}=e;this._extractFilter=new zg(e.threshold),this._extractFilter.resolution=o,this._blurFilter=r?new xl(r):new xl(i,n),this.pixelSize=s,this.resolution=o}apply(t,e,r,i,n){let s=t.getFilterTexture();this._extractFilter.apply(t,e,s,1,n);let o=t.getFilterTexture();this._blurFilter.apply(t,s,o,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=o,t.applyFilter(this,e,r,i),t.returnFilterTexture(o),t.returnFilterTexture(s)}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._extractFilter&&(this._extractFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get threshold(){return this._extractFilter.threshold}set threshold(t){this._extractFilter.threshold=t}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}},kB=RA;kB.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:ue.FILTER_RESOLUTION};var qn=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(qn||{}),Hg=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(Hg||{}),i6=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(i6||{}),lt=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(lt||{}),_u=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(_u||{}),Oe=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(Oe||{}),ba=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(ba||{}),kt=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(kt||{}),n6=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(n6||{}),Ss=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(Ss||{}),F3=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(F3||{}),Ks=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(Ks||{}),Cn=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(Cn||{}),_l=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(_l||{}),s6=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(s6||{}),fn=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(fn||{}),ci=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(ci||{});var lr=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(lr||{}),kn=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(kn||{});var $g={createCanvas:(t,e)=>{let r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};var Ye={ADAPTER:$g,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var IB=Wa.default??Wa,Zs=IB(globalThis.navigator);Ye.RETINA_PREFIX=/@([0-9\.]+)x/;Ye.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var R1=dt(X8(),1),FB=dt(K8(),1);var bu=dt(tp(),1),jg={parse:bu.parse,format:bu.format,resolve:bu.resolve};var NA={};function Nt(t,e,r=3){if(NA[e])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(i=i.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(i))),NA[e]=!0}var Vg;function Xg(){return typeof Vg>"u"&&(Vg=function(){let e={stencil:!0,failIfMajorPerformanceCaveat:Ye.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Ye.ADAPTER.getWebGLRenderingContext())return!1;let r=Ye.ADAPTER.createCanvas(),i=r.getContext("webgl",e)||r.getContext("experimental-webgl",e),n=!!i?.getContextAttributes()?.stencil;if(i){let s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,n}catch{return!1}}()),Vg}Hc([$c]);var wu=class{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof wu)this._value=t._value,this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");this._value!==t&&(this.normalize(t),this._value=t)}}get value(){return this._value}toRgba(){let[t,e,r,i]=this._components;return{r:t,g:e,b:r,a:i}}toRgb(){let[t,e,r]=this._components;return{r:t,g:e,b:r}}toRgbaString(){let[t,e,r]=this.toUint8RgbArray();return`rgba(${t},${e},${r},${this.alpha})`}toUint8RgbArray(t){let[e,r,i]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(r*255),t[2]=Math.round(i*255),t}toRgbArray(t){t=t??[];let[e,r,i]=this._components;return t[0]=e,t[1]=r,t[2]=i,t}toNumber(){return this._int}toLittleEndianNumber(){let t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){let[e,r,i,n]=wu.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=r,this._components[2]*=i,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t){if(t===1)return(t*255<<24)+this._int;if(t===0)return 0;let e=this._int>>16&255,r=this._int>>8&255,i=this._int&255;return e=e*t+.5|0,r=r*t+.5|0,i=i*t+.5|0,(t*255<<24)+(e<<16)+(r<<8)+i}toHex(){let t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){let e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=t,this}round(t){let[e,r,i]=this._components;return this._components.set([Math.min(255,e/t*t),Math.min(255,r/t*t),Math.min(255,i/t*t)]),this.refreshInt(),this._value=null,this}toArray(t){t=t??[];let[e,r,i,n]=this._components;return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}normalize(t){let e;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){let r=t;e=[(r>>16&255)/255,(r>>8&255)/255,(r&255)/255,1]}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4&&t.every(r=>r<=1&&r>=0)){let[r,i,n,s=1]=t;e=[r,i,n,s]}else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4){let[r,i,n,s=255]=t;e=[r/255,i/255,n/255,s/255]}else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){let i=wu.HEX_PATTERN.exec(t);i&&(t=`#${i[2]}`)}let r=Ji(t);if(r.isValid()){let{r:i,g:n,b:s,a:o}=r.rgba;e=[i/255,n/255,s/255,o]}}if(e)this._components.set(e),this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){let[t,e,r]=this._components;this._int=(t*255<<16)+(e*255<<8)+(r*255|0)}},In=wu;In.shared=new wu;In.temp=new wu;In.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function MB(){let t=[],e=[];for(let i=0;i<32;i++)t[i]=i,e[i]=i;t[lt.NORMAL_NPM]=lt.NORMAL,t[lt.ADD_NPM]=lt.ADD,t[lt.SCREEN_NPM]=lt.SCREEN,e[lt.NORMAL]=lt.NORMAL_NPM,e[lt.ADD]=lt.ADD_NPM,e[lt.SCREEN]=lt.SCREEN_NPM;let r=[];return r.push(e),r.push(t),r}var Wg=MB();function Eu(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function P1(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function o6(t){return!(t&t-1)&&!!t}function a6(t){let e=(t>65535?1:0)<<4;t>>>=e;let r=(t>255?1:0)<<3;return t>>>=r,e|=r,r=(t>15?1:0)<<2,t>>>=r,e|=r,r=(t>3?1:0)<<1,t>>>=r,e|=r,e|t>>1}function qg(t,e,r){let i=t.length,n;if(e>=i||r===0)return;r=e+r>i?i-e:r;let s=i-r;for(n=e;n<s;++n)t[n]=t[n+r];t.length=s}var PB=0;function wa(){return++PB}var DA=class{constructor(t,e,r,i){this.left=t,this.top=e,this.right=r,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}},Yg=DA;Yg.EMPTY=new DA(0,0,0,0);var l6={},Yn=Object.create(null),Ao=Object.create(null);var c6;function Qg(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location,c6||(c6=document.createElement("a")),c6.href=t;let r=jg.parse(c6.href),i=!r.port&&e.port===""||r.port===e.port;return r.hostname!==e.hostname||!i||r.protocol!==e.protocol?"anonymous":""}function u6(t,e=1){let r=Ye.RETINA_PREFIX?.exec(t);return r?parseFloat(r[1]):e}var Ve=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(Ve||{}),Kg=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},FA=(t,e)=>Kg(t).priority??e,Je={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Kg).forEach(e=>{e.type.forEach(r=>this._removeHandlers[r]?.(e))}),this},add(...t){return t.map(Kg).forEach(e=>{e.type.forEach(r=>{let i=this._addHandlers,n=this._queue;i[r]?i[r](e):(n[r]=n[r]||[],n[r].push(e))})}),this},handle(t,e,r){let i=this._addHandlers,n=this._removeHandlers;if(i[t]||n[t])throw new Error(`Extension type ${t} already has a handler`);i[t]=e,n[t]=r;let s=this._queue;return s[t]&&(s[t].forEach(o=>e(o)),delete s[t]),this},handleByMap(t,e){return this.handle(t,r=>{e[r.name]=r.ref},r=>{delete e[r.name]})},handleByList(t,e,r=-1){return this.handle(t,i=>{e.includes(i.ref)||(e.push(i.ref),e.sort((n,s)=>FA(s,r)-FA(n,r)))},i=>{let n=e.indexOf(i.ref);n!==-1&&e.splice(n,1)})}};var O3=class{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}};var OB=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function LB(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function f6(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let r=e.createShader(e.FRAGMENT_SHADER);for(;;){let i=OB.replace(/%forloop%/gi,LB(t));if(e.shaderSource(r,i),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}return t}var Zg=0,Jg=1,ey=2,ty=3,ry=4,iy=5,Js=class{constructor(){this.data=0,this.blendMode=lt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Zg)}set blend(e){!!(this.data&1<<Zg)!==e&&(this.data^=1<<Zg)}get offsets(){return!!(this.data&1<<Jg)}set offsets(e){!!(this.data&1<<Jg)!==e&&(this.data^=1<<Jg)}get culling(){return!!(this.data&1<<ey)}set culling(e){!!(this.data&1<<ey)!==e&&(this.data^=1<<ey)}get depthTest(){return!!(this.data&1<<ty)}set depthTest(e){!!(this.data&1<<ty)!==e&&(this.data^=1<<ty)}get depthMask(){return!!(this.data&1<<iy)}set depthMask(e){!!(this.data&1<<iy)!==e&&(this.data^=1<<iy)}get clockwiseFrontFace(){return!!(this.data&1<<ry)}set clockwiseFrontFace(e){!!(this.data&1<<ry)!==e&&(this.data^=1<<ry)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==lt.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){let e=new Js;return e.depthTest=!1,e.blend=!0,e}};var Su=[];function Tu(t,e){if(!t)return null;let r="";if(typeof t=="string"){let i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(let i=Su.length-1;i>=0;--i){let n=Su[i];if(n.test&&n.test(t,r))return new n(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}var ti=class{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,r,i,n,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");let{name:c,items:u}=this;this._aliasCount++;for(let d=0,h=u.length;d<h;d++)u[d][c](e,r,i,n,s,o,a,l);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){let r=this.items.indexOf(e);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}};Object.defineProperties(ti.prototype,{dispatch:{value:ti.prototype.emit},run:{value:ti.prototype.emit}});var Qn=class{constructor(e=0,r=0){this._width=e,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new ti("setRealSize"),this.onUpdate=new ti("update"),this.onError=new ti("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,r){(e!==this._width||r!==this._height)&&(this._width=e,this._height=r,this.onResize.emit(e,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,r,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,r){return!1}};var Co=class extends Qn{constructor(e,r){let{width:i,height:n}=r||{};if(!i||!n)throw new Error("BufferResource width or height invalid");super(i,n),this.data=e}upload(e,r,i){let n=e.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Cn.UNPACK);let s=r.realWidth,o=r.realHeight;return i.width===s&&i.height===o?n.texSubImage2D(r.target,0,0,0,s,o,r.format,i.type,this.data):(i.width=s,i.height=o,n.texImage2D(r.target,0,i.internalFormat,s,o,0,r.format,i.type,this.data)),!0}dispose(){this.data=null}static test(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array}};var BB={scaleMode:Ss.NEAREST,format:Oe.RGBA,alphaMode:Cn.NPM},Au=class extends R1.default{constructor(t=null,e=null){super(),e=Object.assign({},Au.defaultOptions,e);let{alphaMode:r,mipmap:i,anisotropicLevel:n,scaleMode:s,width:o,height:a,wrapMode:l,format:c,type:u,target:d,resolution:h,resourceOptions:p}=e;t&&!(t instanceof Qn)&&(t=Tu(t,p),t.internal=!0),this.resolution=h||Ye.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=n,this._wrapMode=l,this._scaleMode=s,this.format=c,this.type=u,this.target=d,this.alphaMode=r,this.uid=wa(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let r;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this}setSize(t,e,r){return r=r||this.resolution,this.setRealSize(t*r,e*r,r)}setRealSize(t,e,r){return this.resolution=r||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=o6(this.realWidth)&&o6(this.realHeight)}setResolution(t){let e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ao[this.cacheId],delete Yn[this.cacheId],this.cacheId=null),this.dispose(),Au.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,r=Ye.STRICT_TEXTURE_CACHE){let i=typeof t=="string",n=null;if(i)n=t;else{if(!t._pixiId){let o=e?.pixiIdPrefix||"pixiid";t._pixiId=`${o}_${wa()}`}n=t._pixiId}let s=Ao[n];if(i&&r&&!s)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return s||(s=new Au(t,e),s.cacheId=n,Au.addToCache(s,n)),s}static fromBuffer(t,e,r,i){t=t||new Float32Array(e*r*4);let n=new Co(t,{width:e,height:r}),s=t instanceof Float32Array?kt.FLOAT:kt.UNSIGNED_BYTE;return new Au(n,Object.assign({},BB,i||{width:e,height:r,type:s}))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Ao[e]&&Ao[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),Ao[e]=t)}static removeFromCache(t){if(typeof t=="string"){let e=Ao[t];if(e){let r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Ao[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete Ao[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}},Mt=Au;Mt.defaultOptions={mipmap:Ks.POW2,anisotropicLevel:0,scaleMode:Ss.LINEAR,wrapMode:F3.CLAMP,alphaMode:Cn.UNPACK,target:ba.TEXTURE_2D,format:Oe.RGBA,type:kt.UNSIGNED_BYTE};Mt._globalBatch=0;var L3=class{constructor(){this.texArray=null,this.blend=0,this.type=_u.TRIANGLES,this.start=0,this.size=0,this.data=null}};var UB=0,qr=class{constructor(e,r=!0,i=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=r,this.id=UB++,this.disposeRunner=new ti("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?kn.ELEMENT_ARRAY_BUFFER:kn.ARRAY_BUFFER}get index(){return this.type===kn.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new qr(e)}};var bl=class{constructor(e,r=0,i=!1,n=kt.FLOAT,s,o,a,l=1){this.buffer=e,this.size=r,this.normalized=i,this.type=n,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,r,i,n,s){return new bl(e,r,i,n,s)}};var GB={Float32Array,Uint32Array,Int32Array,Uint8Array};function OA(t,e){let r=0,i=0,n={};for(let l=0;l<t.length;l++)i+=e[l],r+=t[l].length;let s=new ArrayBuffer(r*4),o=null,a=0;for(let l=0;l<t.length;l++){let c=e[l],u=t[l],d=Eu(u);n[d]||(n[d]=new GB[d](s)),o=n[d];for(let h=0;h<u.length;h++){let p=(h/c|0)*i+a,m=h%c;o[p+m]=u[h]}a+=c}return new Float32Array(s)}var LA={5126:4,5123:2,5121:1},zB=0,HB={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Ts=class{constructor(e=[],r={}){this.buffers=e,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=zB++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ti("disposeGeometry"),this.refCount=0}addAttribute(e,r,i=0,n=!1,s,o,a,l=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof qr||(r instanceof Array&&(r=new Float32Array(r)),r=new qr(r));let c=e.split("|");if(c.length>1){for(let d=0;d<c.length;d++)this.addAttribute(c[d],r,i,n,s);return this}let u=this.buffers.indexOf(r);return u===-1&&(this.buffers.push(r),u=this.buffers.length-1),this.attributes[e]=new bl(u,i,n,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof qr||(e instanceof Array&&(e=new Uint16Array(e)),e=new qr(e)),e.type=kn.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;let e=[],r=[],i=new qr,n;for(n in this.attributes){let s=this.attributes[n],o=this.buffers[s.buffer];e.push(o.data),r.push(s.size*LA[s.type]/4),s.buffer=0}for(i.data=OA(e,r),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let e in this.attributes){let r=this.attributes[e];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let e=new Ts;for(let r=0;r<this.buffers.length;r++)e.buffers[r]=new qr(this.buffers[r].data.slice(0));for(let r in this.attributes){let i=this.attributes[r];e.attributes[r]=new bl(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=kn.ELEMENT_ARRAY_BUFFER),e}static merge(e){let r=new Ts,i=[],n=[],s=[],o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)n[l]=n[l]||0,n[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new HB[Eu(o.buffers[a].data)](n[a]),r.buffers[a]=new qr(i[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(r.attributes=o.attributes,o.indexBuffer){r.indexBuffer=r.buffers[o.buffers.indexOf(o.indexBuffer)],r.indexBuffer.type=kn.ELEMENT_ARRAY_BUFFER;let a=0,l=0,c=0,u=0;for(let d=0;d<o.buffers.length;d++)if(o.buffers[d]!==o.indexBuffer){u=d;break}for(let d in o.attributes){let h=o.attributes[d];(h.buffer|0)===u&&(l+=h.size*LA[h.type]/4)}for(let d=0;d<e.length;d++){let h=e[d].indexBuffer.data;for(let p=0;p<h.length;p++)r.indexBuffer.data[p+c]+=a;a+=e[d].buffers[u].data.length/l,c+=h.length}}return r}};var B3=class extends Ts{constructor(e=!1){super(),this._buffer=new qr(null,e,!1),this._indexBuffer=new qr(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,kt.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,kt.FLOAT).addAttribute("aColor",this._buffer,4,!0,kt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,kt.FLOAT).addIndex(this._indexBuffer)}};var ny=Math.PI*2,$B=180/Math.PI,jB=Math.PI/180,wl=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(wl||{});var Yr=class{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new Yr(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}};var d6=[new Yr,new Yr,new Yr,new Yr],Xt=class{constructor(e=0,r=0,i=0,n=0){this.x=Number(e),this.y=Number(r),this.width=Number(i),this.height=Number(n),this.type=wl.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Xt(0,0,0,0)}clone(){return new Xt(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(e,r){if(!r){let T=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=T)return!1;let C=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>C}let i=this.left,n=this.right,s=this.top,o=this.bottom;if(n<=i||o<=s)return!1;let a=d6[0].set(e.left,e.top),l=d6[1].set(e.left,e.bottom),c=d6[2].set(e.right,e.top),u=d6[3].set(e.right,e.bottom);if(c.x<=a.x||l.y<=a.y)return!1;let d=Math.sign(r.a*r.d-r.b*r.c);if(d===0||(r.apply(a,a),r.apply(l,l),r.apply(c,c),r.apply(u,u),Math.max(a.x,l.x,c.x,u.x)<=i||Math.min(a.x,l.x,c.x,u.x)>=n||Math.max(a.y,l.y,c.y,u.y)<=s||Math.min(a.y,l.y,c.y,u.y)>=o))return!1;let h=d*(l.y-a.y),p=d*(a.x-l.x),m=h*i+p*s,g=h*n+p*s,y=h*i+p*o,v=h*n+p*o;if(Math.max(m,g,y,v)<=h*a.x+p*a.y||Math.min(m,g,y,v)>=h*u.x+p*u.y)return!1;let x=d*(a.y-c.y),_=d*(c.x-a.x),b=x*i+_*s,w=x*n+_*s,E=x*i+_*o,A=x*n+_*o;return!(Math.max(b,w,E,A)<=x*a.x+_*a.y||Math.min(b,w,E,A)>=x*u.x+_*u.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){let r=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(i-r,0),this.y=n,this.height=Math.max(s-n,0),this}ceil(e=1,r=.001){let i=Math.ceil((this.x+this.width-r)*e)/e,n=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=i-this.x,this.height=n-this.y,this}enlarge(e){let r=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=i-r,this.y=n,this.height=s-n,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var nr=class{constructor(e=1,r=0,i=0,n=1,s=0,o=0){this.array=null,this.a=e,this.b=r,this.c=i,this.d=n,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,i,n,s,o){return this.a=e,this.b=r,this.c=i,this.d=n,this.tx=s,this.ty=o,this}toArray(e,r){this.array||(this.array=new Float32Array(9));let i=r||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,r){r=r||new Yr;let i=e.x,n=e.y;return r.x=this.a*i+this.c*n+this.tx,r.y=this.b*i+this.d*n+this.ty,r}applyInverse(e,r){r=r||new Yr;let i=1/(this.a*this.d+this.c*-this.b),n=e.x,s=e.y;return r.x=this.d*i*n+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,r.y=this.a*i*s+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){let r=Math.cos(e),i=Math.sin(e),n=this.a,s=this.c,o=this.tx;return this.a=n*r-this.b*i,this.b=n*i+this.b*r,this.c=s*r-this.d*i,this.d=s*i+this.d*r,this.tx=o*r-this.ty*i,this.ty=o*i+this.ty*r,this}append(e){let r=this.a,i=this.b,n=this.c,s=this.d;return this.a=e.a*r+e.b*n,this.b=e.a*i+e.b*s,this.c=e.c*r+e.d*n,this.d=e.c*i+e.d*s,this.tx=e.tx*r+e.ty*n+this.tx,this.ty=e.tx*i+e.ty*s+this.ty,this}setTransform(e,r,i,n,s,o,a,l,c){return this.a=Math.cos(a+c)*s,this.b=Math.sin(a+c)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(i*this.a+n*this.c),this.ty=r-(i*this.b+n*this.d),this}prepend(e){let r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){let i=this.a,n=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){let r=this.a,i=this.b,n=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-n,s),l=Math.atan2(i,r),c=Math.abs(a+l);return c<1e-5||Math.abs(ny-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(r*r+i*i),e.scale.y=Math.sqrt(n*n+s*s),e.position.x=this.tx+(o.x*r+o.y*n),e.position.y=this.ty+(o.x*i+o.y*s),e}invert(){let e=this.a,r=this.b,i=this.c,n=this.d,s=this.tx,o=e*n-r*i;return this.a=n/o,this.b=-r/o,this.c=-i/o,this.d=e/o,this.tx=(i*this.ty-n*s)/o,this.ty=-(e*this.ty-r*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let e=new nr;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new nr}static get TEMP_MATRIX(){return new nr}};var N1=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],D1=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],F1=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],O1=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],sy=[],BA=[],h6=Math.sign;function VB(){for(let t=0;t<16;t++){let e=[];sy.push(e);for(let r=0;r<16;r++){let i=h6(N1[t]*N1[r]+F1[t]*D1[r]),n=h6(D1[t]*N1[r]+O1[t]*D1[r]),s=h6(N1[t]*F1[r]+F1[t]*O1[r]),o=h6(D1[t]*F1[r]+O1[t]*O1[r]);for(let a=0;a<16;a++)if(N1[a]===i&&D1[a]===n&&F1[a]===s&&O1[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){let e=new nr;e.set(N1[t],D1[t],F1[t],O1[t],0,0),BA.push(e)}}VB();var Tr={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>N1[t],uY:t=>D1[t],vX:t=>F1[t],vY:t=>O1[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>sy[t][e],sub:(t,e)=>sy[t][Tr.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?Tr.S:Tr.N:Math.abs(e)*2<=Math.abs(t)?t>0?Tr.E:Tr.W:e>0?t>0?Tr.SE:Tr.SW:t>0?Tr.NE:Tr.NW,matrixAppendRotationInv:(t,e,r=0,i=0)=>{let n=BA[Tr.inv(e)];n.tx=r,n.ty=i,t.append(n)}};var ko=class{constructor(e,r,i=0,n=0){this._x=i,this._y=n,this.cb=e,this.scope=r}clone(e=this.cb,r=this.scope){return new ko(e,r,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}};var UA=class{constructor(){this.worldTransform=new nr,this.localTransform=new nr,this.position=new ko(this.onChange,this,0,0),this.scale=new ko(this.onChange,this,1,1),this.pivot=new ko(this.onChange,this,0,0),this.skew=new ko(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){let t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){let e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){let r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}},p6=UA;p6.IDENTITY=new UA;var GA=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`;var zA=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function m6(t,e,r){let i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function oy(t){let e=new Array(t);for(let r=0;r<e.length;r++)e[r]=!1;return e}function U3(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return oy(2*e);case"bvec3":return oy(3*e);case"bvec4":return oy(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Io=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}];var XB={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},WB={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function ay(t,e){let r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let i in t.uniforms){let n=e[i];if(!n){t.uniforms[i]?.group&&(t.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}let s=t.uniforms[i],o=!1;for(let a=0;a<Io.length;a++)if(Io[a].test(n,s)){r.push(Io[a].code(i,s)),o=!0;break}if(!o){let l=(n.size===1&&!n.isArray?XB:WB)[n.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}var HA={},g6=HA;function y6(){if(g6===HA||g6?.isContextLost()){let t=Ye.ADAPTER.createCanvas(),e;Ye.PREFER_ENV>=qn.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),g6=e}return g6}var v6;function ly(){if(!v6){v6=fn.MEDIUM;let t=y6();t&&t.getShaderPrecisionFormat&&(v6=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?fn.HIGH:fn.MEDIUM)}return v6}function $A(t,e){let r=t.getShaderSource(e).split(`
`).map((c,u)=>`${u}: ${c}`),i=t.getShaderInfoLog(e),n=i.split(`
`),s={},o=n.map(c=>parseFloat(c.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(c=>c&&!s[c]?(s[c]=!0,!0):!1),a=[""];o.forEach(c=>{r[c-1]=`%c${r[c-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});let l=r.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function cy(t,e,r,i){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||$A(t,r),t.getShaderParameter(i,t.COMPILE_STATUS)||$A(t,i),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}var qB={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function G3(t){return qB[t]}var x6=null,jA={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function z3(t,e){if(!x6){let r=Object.keys(jA);x6={};for(let i=0;i<r.length;++i){let n=r[i];x6[t[n]]=jA[n]}}return x6[e]}function _6(t,e,r){if(t.substring(0,9)!=="precision"){let i=e;return e===fn.HIGH&&r!==fn.HIGH&&(i=fn.MEDIUM),`precision ${i} float;
${t}`}else if(r!==fn.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}var H3;function b6(){if(typeof H3=="boolean")return H3;try{H3=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{H3=!1}return H3}var YB=0,w6={},Cu=class{constructor(t,e,r="pixi-shader",i={}){this.extra={},this.id=YB++,this.vertexSrc=t||Cu.defaultVertexSrc,this.fragmentSrc=e||Cu.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),w6[r]?(w6[r]++,r+=`-${w6[r]}`):w6[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=_6(this.vertexSrc,Cu.defaultVertexPrecision,fn.HIGH),this.fragmentSrc=_6(this.fragmentSrc,Cu.defaultFragmentPrecision,ly())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return zA}static get defaultFragmentSrc(){return GA}static from(t,e,r){let i=t+e,n=l6[i];return n||(l6[i]=n=new Cu(t,e,r)),n}},Mn=Cu;Mn.defaultVertexPrecision=fn.HIGH;Mn.defaultFragmentPrecision=Zs.apple.device?fn.HIGH:fn.MEDIUM;var QB=0,Ni=class{constructor(e,r,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=QB++,this.static=!!r,this.ubo=!!i,e instanceof qr?(this.buffer=e,this.buffer.type=kn.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new qr(new Float32Array(1)),this.buffer.type=kn.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,r,i){if(!this.ubo)this.uniforms[e]=new Ni(r,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,r,i){return new Ni(e,r,i)}static uboFrom(e,r){return new Ni(e,r??!0,!0)}};var Ea=class{constructor(e,r){this.uniformBindCount=0,this.program=e,r?r instanceof Ni?this.uniformGroup=r:this.uniformGroup=new Ni(r):this.uniformGroup=new Ni({}),this.disposeRunner=new ti("disposeShader")}checkUniformExists(e,r){if(r.uniforms[e])return!0;for(let i in r.uniforms){let n=r.uniforms[i];if(n.group&&this.checkUniformExists(e,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,r,i){let n=Mn.from(e,r);return new Ea(n,i)}};var $3=class{constructor(e,r){if(this.vertexSrc=e,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){let i=new Int32Array(e);for(let s=0;s<e;s++)i[s]=s;this.defaultGroupCache[e]=Ni.from({uSamplers:i},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${e}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Mn(this.vertexSrc,n)}let r={tint:new Float32Array([1,1,1,1]),translationMatrix:new nr,default:this.defaultGroupCache[e]};return new Ea(this.programCache[e],r)}generateSampleSrc(e){let r="";r+=`
`,r+=`
`;for(let i=0;i<e;i++)i>0&&(r+=`
else `),i<e-1&&(r+=`if(vTextureId < ${i}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}};var j3=class{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}};function VA(){return!Zs.apple.device}function XA(t){let e=!0,r=Ye.ADAPTER.getNavigator();if(Zs.tablet||Zs.phone){if(Zs.apple.device){let i=r.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(e=!1)}if(Zs.android.device){let i=r.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(e=!1)}}return e?t:4}var L1=class{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}};var WA=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;var qA=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;var eo=class extends L1{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=B3,this.vertexSize=6,this.state=Js.for2d(),this.size=eo.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??XA(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??VA(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return Nt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return qA}static get defaultFragmentTemplate(){return WA}setShaderGenerator({vertex:t=eo.defaultVertexSrc,fragment:e=eo.defaultFragmentTemplate}={}){this.shaderGenerator=new $3(t,e)}contextChange(){let t=this.renderer.gl;Ye.PREFER_ENV===qn.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),eo.defaultMaxTextures),this.maxTextures=f6(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:t,_textureArrayPool:e}=eo,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;t.length<r;)t.push(new L3);for(;e.length<i;)e.push(new j3);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){let{_bufferedTextures:t,maxTextures:e}=this,r=eo._textureArrayPool,i=this.renderer.batch,n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++Mt._globalBatch,a=0,l=r[0],c=0;i.copyBoundTextures(n,e);for(let u=0;u<this._bufferSize;++u){let d=t[u];t[u]=null,d._batchEnabled!==o&&(l.count>=e&&(i.boundArray(l,n,o,e),this.buildDrawCalls(l,c,u),c=u,l=r[++a],++o),d._batchEnabled=o,d.touched=s,l.elements[l.count++]=d)}l.count>0&&(i.boundArray(l,n,o,e),this.buildDrawCalls(l,c,this._bufferSize),++a,++o);for(let u=0;u<n.length;u++)n[u]=null;Mt._globalBatch=o}buildDrawCalls(t,e,r){let{_bufferedElements:i,_attributeBuffer:n,_indexBuffer:s,vertexSize:o}=this,a=eo._drawCallPool,l=this._dcIndex,c=this._aIndex,u=this._iIndex,d=a[l];d.start=this._iIndex,d.texArray=t;for(let h=e;h<r;++h){let p=i[h],m=p._texture.baseTexture,g=Wg[m.alphaMode?1:0][p.blendMode];i[h]=null,e<h&&d.blend!==g&&(d.size=u-d.start,e=h,d=a[++l],d.texArray=t,d.start=u),this.packInterleavedGeometry(p,n,s,c,u),c+=p.vertexData.length/2*o,u+=p.indices.length,d.blend=g}e<r&&(d.size=u-d.start,++l),this._dcIndex=l,this._aIndex=c,this._iIndex=u}bindAndClearTexArray(t){let e=this.renderer.texture;for(let r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0}updateGeometry(){let{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:r}=this;eo.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let t=this._dcIndex,{gl:e,state:r}=this.renderer,i=eo._drawCallPool,n=null;for(let s=0;s<t;s++){let{texArray:o,type:a,size:l,start:c,blend:u}=i[s];n!==o&&(n=o,this.bindAndClearTexArray(o)),this.state.blendMode=u,r.set(this.state),e.drawElements(a,l,e.UNSIGNED_SHORT,c*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),eo.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){let e=P1(Math.ceil(t/8)),r=a6(e),i=e*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new O3(i*this.vertexSize*4)),n}getIndexBuffer(t){let e=P1(Math.ceil(t/12)),r=a6(e),i=e*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n}packInterleavedGeometry(t,e,r,i,n){let{uint32View:s,float32View:o}=e,a=i/this.vertexSize,l=t.uvs,c=t.indices,u=t.vertexData,d=t._texture.baseTexture._batchLocation,h=Math.min(t.worldAlpha,1),p=In.shared.setValue(t._tintRGB).toPremultiplied(h);for(let m=0;m<u.length;m+=2)o[i++]=u[m],o[i++]=u[m+1],o[i++]=l[m],o[i++]=l[m+1],s[i++]=p,o[i++]=d;for(let m=0;m<c.length;m++)r[n++]=a+c[m]}},Kn=eo;Kn.defaultBatchSize=4096;Kn.extension={name:"batch",type:Ve.RendererPlugin};Kn._drawCallPool=[];Kn._textureArrayPool=[];Je.add(Kn);var YA=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`;var QA=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var V3=class extends Ea{constructor(t,e,r){let i=Mn.from(t||V3.defaultVertexSrc,e||V3.defaultFragmentSrc);super(i,r),this.padding=0,this.resolution=V3.defaultResolution,this.multisample=V3.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Js}apply(t,e,r,i,n){t.applyFilter(this,e,r,i)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return QA}static get defaultFragmentSrc(){return YA}},Zn=V3;Zn.defaultResolution=1;Zn.defaultMultisample=lr.NONE;var Sa=class{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new In(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;let{backgroundColor:r,background:i,backgroundAlpha:n}=e,s=i??r;s!==void 0&&(this.color=s),this.alpha=n}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}};Sa.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};Sa.extension={type:[Ve.RendererSystem,Ve.CanvasRendererSystem],name:"background"};Je.add(Sa);var ku=class{constructor(e){this.renderer=e,this.emptyRenderer=new L1(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,r){let{boundTextures:i}=this.renderer.texture;for(let n=r-1;n>=0;--n)e[n]=i[n]||null,e[n]&&(e[n]._batchLocation=n)}boundArray(e,r,i,n){let{elements:s,ids:o,count:a}=e,l=0;for(let c=0;c<a;c++){let u=s[c],d=u._batchLocation;if(d>=0&&d<n&&r[d]===u){o[c]=d;continue}for(;l<n;){let h=r[l];if(h&&h._batchEnabled===i&&h._batchLocation===l){l++;continue}o[c]=l,u._batchLocation=l,r[l]=u;break}}}destroy(){this.renderer=null}};ku.extension={type:Ve.RendererSystem,name:"batch"};Je.add(ku);var KA=0,Ta=class{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=KA++}init(e){if(e.context)this.initFromContext(e.context);else{let r=this.renderer.background.alpha<1,i=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:i,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=KA++,this.renderer.runners.contextChange.emit(e);let r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){let r=this.createContext(this.renderer.view,e);this.initFromContext(r)}createContext(e,r){let i;if(Ye.PREFER_ENV>=qn.WEBGL2&&(i=e.getContext("webgl2",r)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=e.getContext("webgl",r)||e.getContext("experimental-webgl",r),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){let{gl:e}=this,r={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){let r=e.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");let n=i||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}};Ta.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};Ta.extension={type:Ve.RendererSystem,name:"context"};Je.add(Ta);var E6=class extends Co{upload(e,r,i){let n=e.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Cn.UNPACK);let s=r.realWidth,o=r.realHeight;return i.width===s&&i.height===o?n.texSubImage2D(r.target,0,0,0,s,o,r.format,i.type,this.data):(i.width=s,i.height=o,n.texImage2D(r.target,0,i.internalFormat,s,o,0,r.format,i.type,this.data)),!0}};var El=class{constructor(e,r){this.width=Math.round(e||100),this.height=Math.round(r||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ti("disposeFramebuffer"),this.multisample=lr.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,r){return this.colorTextures[e]=r||new Mt(null,{scaleMode:Ss.NEAREST,resolution:1,mipmap:Ks.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new Mt(new E6(null,{width:this.width,height:this.height}),{scaleMode:Ss.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Ks.OFF,format:Oe.DEPTH_COMPONENT,type:kt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,r){if(e=Math.round(e),r=Math.round(r),!(e===this.width&&r===this.height)){this.width=e,this.height=r,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){let n=this.colorTextures[i],s=n.resolution;n.setSize(e/s,r/s)}if(this.depthTexture){let i=this.depthTexture.resolution;this.depthTexture.setSize(e/i,r/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}};var B1=class extends Mt{constructor(e={}){if(typeof e=="number"){let r=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:n,resolution:s}}e.width=e.width||100,e.height=e.height||100,e.multisample??(e.multisample=lr.NONE),super(null,e),this.mipmap=Ks.OFF,this.valid=!0,this._clear=new In([0,0,0,0]),this.framebuffer=new El(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(e,r){this.framebuffer.resize(e*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}};var Di=class extends Qn{constructor(e){let r=e,i=r.naturalWidth||r.videoWidth||r.width,n=r.naturalHeight||r.videoHeight||r.height;super(i,n),this.source=e,this.noSubImage=!1}static crossOrigin(e,r,i){i===void 0&&!r.startsWith("data:")?e.crossOrigin=Qg(r):i!==!1&&(e.crossOrigin=typeof i=="string"?i:"anonymous")}upload(e,r,i,n){let s=e.gl,o=r.realWidth,a=r.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1&&n.buffered.length===0)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Cn.UNPACK),!this.noSubImage&&r.target===s.TEXTURE_2D&&i.width===o&&i.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,r.format,i.type,n):(i.width=o,i.height=a,s.texImage2D(r.target,0,i.internalFormat,r.format,i.type,n)),!0}update(){if(this.destroyed)return;let e=this.source,r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(r,i),super.update()}dispose(){this.source=null}};var Sl=class extends Di{constructor(e,r){if(r=r||{},typeof e=="string"){let i=new Image;Di.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??Ye.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((r,i)=>{let n=this.source;this.url=n.src;let s=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.resize(n.width,n.height),this._load=null,this.createBitmap?r(this.process()):r(this))};n.complete&&n.src?s():(n.onload=s,n.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){let e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);let r=globalThis.createImageBitmap,i=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then(n=>n.blob()).then(n=>r(n,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Cn.UNPACK?"premultiply":"none"})).then(n=>this.destroyed?Promise.reject():(this.bitmap=n,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,r,i){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,r,i,this.bitmap),!this.preserveBitmap){let n=!0,s=r._glTextures;for(let o in s){let a=s[o];if(a!==i&&a.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}};var Iu=class{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,r,i){let n=r.width,s=r.height;if(i){let o=e.width/2/n,a=e.height/2/s,l=e.x/n+o,c=e.y/s+a;i=Tr.add(i,Tr.NW),this.x0=l+o*Tr.uX(i),this.y0=c+a*Tr.uY(i),i=Tr.add(i,2),this.x1=l+o*Tr.uX(i),this.y1=c+a*Tr.uY(i),i=Tr.add(i,2),this.x2=l+o*Tr.uX(i),this.y2=c+a*Tr.uY(i),i=Tr.add(i,2),this.x3=l+o*Tr.uX(i),this.y3=c+a*Tr.uY(i)}else this.x0=e.x/n,this.y0=e.y/s,this.x1=(e.x+e.width)/n,this.y1=e.y/s,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/s,this.x3=e.x/n,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}};var ZA=new Iu;function S6(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}var Qt=class extends R1.default{constructor(e,r,i,n,s,o,a){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new Xt(0,0,1,1)),e instanceof Qt&&(e=e.baseTexture),this.baseTexture=e,this._frame=r,this.trim=n,this.valid=!1,this._uvs=ZA,this.uvMatrix=null,this.orig=i||r,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Yr(o.x,o.y):new Yr(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=r:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){let{resource:r}=this.baseTexture;r?.url&&Yn[r.url]&&Qt.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Qt.removeFromCache(this),this.textureCacheIds=null}clone(){let e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),i=new Qt(this.baseTexture,!this.noFrame&&e,r,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=e),i}updateUvs(){this._uvs===ZA&&(this._uvs=new Iu),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,r={},i=Ye.STRICT_TEXTURE_CACHE){let n=typeof e=="string",s=null;if(n)s=e;else if(e instanceof Mt){if(!e.cacheId){let a=r?.pixiIdPrefix||"pixiid";e.cacheId=`${a}-${wa()}`,Mt.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){let a=r?.pixiIdPrefix||"pixiid";e._pixiId=`${a}_${wa()}`}s=e._pixiId}let o=Yn[s];if(n&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof Mt)?(r.resolution||(r.resolution=u6(e)),o=new Qt(new Mt(e,r)),o.baseTexture.cacheId=s,Mt.addToCache(o.baseTexture,s),Qt.addToCache(o,s)):!o&&e instanceof Mt&&(o=new Qt(e),Qt.addToCache(o,s)),o}static fromURL(e,r){let i=Object.assign({autoLoad:!1},r?.resourceOptions),n=Qt.from(e,Object.assign({resourceOptions:i},r),!1),s=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):s.load().then(()=>Promise.resolve(n))}static fromBuffer(e,r,i,n){return new Qt(Mt.fromBuffer(e,r,i,n))}static fromLoader(e,r,i,n){let s=new Mt(e,Object.assign({scaleMode:Mt.defaultOptions.scaleMode,resolution:u6(r)},n)),{resource:o}=s;o instanceof Sl&&(o.url=r);let a=new Qt(s);return i||(i=r),Mt.addToCache(a.baseTexture,i),Qt.addToCache(a,i),i!==r&&(Mt.addToCache(a.baseTexture,r),Qt.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),Yn[r]&&Yn[r]!==e&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),Yn[r]=e)}static removeFromCache(e){if(typeof e=="string"){let r=Yn[e];if(r){let i=r.textureCacheIds.indexOf(e);return i>-1&&r.textureCacheIds.splice(i,1),delete Yn[e],r}}else if(e?.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)Yn[e.textureCacheIds[r]]===e&&delete Yn[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;let{x:r,y:i,width:n,height:s}=e,o=r+n>this.baseTexture.width,a=i+s>this.baseTexture.height;if(o||a){let l=o&&a?"and":"or",c=`X: ${r} + ${n} = ${r+n} > ${this.baseTexture.width}`,u=`Y: ${i} + ${s} = ${i+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${c} ${l} ${u}`)}this.valid=n&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Qt._EMPTY||(Qt._EMPTY=new Qt(new Mt),S6(Qt._EMPTY),S6(Qt._EMPTY.baseTexture)),Qt._EMPTY}static get WHITE(){if(!Qt._WHITE){let e=Ye.ADAPTER.createCanvas(16,16),r=e.getContext("2d");e.width=16,e.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),Qt._WHITE=new Qt(Mt.from(e)),S6(Qt._WHITE),S6(Qt._WHITE.baseTexture)}return Qt._WHITE}};var Aa=class extends Qt{constructor(e,r){super(e,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r,i=!0){let n=this.baseTexture.resolution,s=Math.round(e*n)/n,o=Math.round(r*n)/n;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){let{baseTexture:r}=this;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))}static create(e){return new Aa(new B1(e))}};var Mu=class{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,r,i=lr.NONE){let n=new B1(Object.assign({width:e,height:r,resolution:1,multisample:i},this.textureOptions));return new Aa(n)}getOptimalTexture(e,r,i=1,n=lr.NONE){let s;e=Math.ceil(e*i-1e-6),r=Math.ceil(r*i-1e-6),!this.enableFullScreen||e!==this._pixelsWidth||r!==this._pixelsHeight?(e=P1(e),r=P1(r),s=((e&65535)<<16|r&65535)>>>0,n>1&&(s+=n*4294967296)):s=n>1?-n:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,r,n)),o.filterPoolKey=s,o.setResolution(i),o}getFilterTexture(e,r,i){let n=this.getOptimalTexture(e.width,e.height,r||e.resolution,i||lr.NONE);return n.filterFrame=e.filterFrame,n}returnTexture(e){let r=e.filterPoolKey;e.filterFrame=null,this.texturePool[r].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(let r in this.texturePool){let i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(let r in this.texturePool){if(!(Number(r)<0))continue;let i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}};Mu.SCREEN_KEY=-1;var X3=class extends Ts{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}};var W3=class extends Ts{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new qr(this.vertices),this.uvBuffer=new qr(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,r){let i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+r.width/e.width,this.uvs[3]=n,this.uvs[4]=i+r.width/e.width,this.uvs[5]=n+r.height/e.height,this.uvs[6]=i,this.uvs[7]=n+r.height/e.height,i=r.x,n=r.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+r.width,this.vertices[3]=n,this.vertices[4]=i+r.width,this.vertices[5]=n+r.height,this.vertices[6]=i,this.vertices[7]=n+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}};var q3=class{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=lr.NONE,this.sourceFrame=new Xt,this.destinationFrame=new Xt,this.bindingSourceFrame=new Xt,this.bindingDestinationFrame=new Xt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}};var T6=[new Yr,new Yr,new Yr,new Yr],uy=new nr,Pu=class{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new Mu,this.statePool=[],this.quad=new X3,this.quadUv=new W3,this.tempRect=new Xt,this.activeState={},this.globalUniforms=new Ni({outputFrame:new Xt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,r){let i=this.renderer,n=this.defaultFilterStack,s=this.statePool.pop()||new q3,o=this.renderer.renderTexture,a=r[0].resolution,l=r[0].multisample,c=r[0].padding,u=r[0].autoFit,d=r[0].legacy??!0;for(let m=1;m<r.length;m++){let g=r[m];a=Math.min(a,g.resolution),l=Math.min(l,g.multisample),c=this.useMaxPadding?Math.max(c,g.padding):c+g.padding,u=u&&g.autoFit,d=d||(g.legacy??!0)}n.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),n.push(s),s.resolution=a,s.multisample=l,s.legacy=d,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(c);let h=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(uy.copyFrom(i.projection.transform).invert(),h),u?(s.sourceFrame.fit(h),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(h)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,a,l),s.filters=r,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;let p=this.tempRect;p.x=0,p.y=0,p.width=s.sourceFrame.width,p.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=i.projection.transform,i.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,p),i.framebuffer.clear(0,0,0,0)}pop(){let e=this.defaultFilterStack,r=e.pop(),i=r.filters;this.activeState=r;let n=this.globalUniforms.uniforms;n.outputFrame=r.sourceFrame,n.resolution=r.resolution;let s=n.inputSize,o=n.inputPixel,a=n.inputClamp;if(s[0]=r.destinationFrame.width,s[1]=r.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*r.resolution),o[1]=Math.round(s[1]*r.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=r.sourceFrame.width*s[2]-.5*o[2],a[3]=r.sourceFrame.height*s[3]-.5*o[3],r.legacy){let c=n.filterArea;c[0]=r.destinationFrame.width,c[1]=r.destinationFrame.height,c[2]=r.sourceFrame.x,c[3]=r.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();let l=e[e.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,r.renderTexture,l.renderTexture,_l.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let c=r.renderTexture,u=this.getOptimalFilterTexture(c.width,c.height,r.resolution);u.filterFrame=c.filterFrame;let d=0;for(d=0;d<i.length-1;++d){d===1&&r.multisample>1&&(u=this.getOptimalFilterTexture(c.width,c.height,r.resolution),u.filterFrame=c.filterFrame),i[d].apply(this,c,u,_l.CLEAR,r);let h=c;c=u,u=h}i[d].apply(this,c,l.renderTexture,_l.BLEND,r),d>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(c),this.returnFilterTexture(u)}r.clear(),this.statePool.push(r)}bindAndClear(e,r=_l.CLEAR){let{renderTexture:i,state:n}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e?.filterFrame){let o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,i.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);let s=n.stateId&1||this.forceClear;(r===_l.CLEAR||r===_l.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,r,i,n){let s=this.renderer;s.state.set(e.state),this.bindAndClear(i,n),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(r._frame,r.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(_u.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(_u.TRIANGLE_STRIP))}calculateSpriteMatrix(e,r){let{sourceFrame:i,destinationFrame:n}=this.activeState,{orig:s}=r._texture,o=e.set(n.width,0,0,n.height,i.x,i.y),a=r.worldTransform.copyTo(nr.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(r.anchor.x,r.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,r,i=1,n=lr.NONE){return this.texturePool.getOptimalTexture(e,r,i,n)}getFilterTexture(e,r,i){if(typeof e=="number"){let s=e;e=r,r=s}e=e||this.activeState.renderTexture;let n=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution,i||lr.NONE);return n.filterFrame=e.filterFrame,n}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,r){let i=T6[0],n=T6[1],s=T6[2],o=T6[3];i.set(r.left,r.top),n.set(r.left,r.bottom),s.set(r.right,r.top),o.set(r.right,r.bottom),e.apply(i,i),e.apply(n,n),e.apply(s,s),e.apply(o,o);let a=Math.min(i.x,n.x,s.x,o.x),l=Math.min(i.y,n.y,s.y,o.y),c=Math.max(i.x,n.x,s.x,o.x),u=Math.max(i.y,n.y,s.y,o.y);r.x=a,r.y=l,r.width=c-a,r.height=u-l}roundFrame(e,r,i,n,s){if(!(e.width<=0||e.height<=0||i.width<=0||i.height<=0)){if(s){let{a:o,b:a,c:l,d:c}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(c)>1e-4))return}s=s?uy.copyFrom(s):uy.identity(),s.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.transformAABB(s,e),e.ceil(r),this.transformAABB(s.invert(),e)}}};Pu.extension={type:Ve.RendererSystem,name:"filter"};Je.add(Pu);var Y3=class{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=lr.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}};var KB=new Xt,Ru=class{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new El(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Xt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Ye.PREFER_ENV===qn.WEBGL_LEGACY&&(r=null,i=null),r?e.drawBuffers=n=>r.drawBuffersWEBGL(n):(this.hasMRT=!1,e.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,r,i=0){let{gl:n}=this;if(e){let s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,n.bindFramebuffer(n.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==i&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=i),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,i)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){let a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r){let o=r.width>>i,a=r.height>>i,l=o/r.width;this.setViewport(r.x*l,r.y*l,o,a)}else{let o=e.width>>i,a=e.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,r,i,n){let s=this.viewport;e=Math.round(e),r=Math.round(r),i=Math.round(i),n=Math.round(n),(s.width!==i||s.height!==n||s.x!==e||s.y!==r)&&(s.x=e,s.y=r,s.width=i,s.height=n,this.gl.viewport(e,r,i,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,r,i,n,s=i6.COLOR|i6.DEPTH){let{gl:o}=this;o.clearColor(e,r,i,n),o.clear(s)}initFramebuffer(e){let{gl:r}=this,i=new Y3(r.createFramebuffer());return i.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(e),e.disposeRunner.add(this),i}resizeFramebuffer(e){let{gl:r}=this,i=e.glFramebuffers[this.CONTEXT_UID];i.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e.width,e.height));let n=e.colorTextures,s=n.length;r.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){let a=n[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&i.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,r){let{gl:i}=this,n=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures,o=s.length;i.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&this.canMultisampleFramebuffer(e)?n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer():n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));let a=[];for(let l=0;l<o;l++){let c=s[l],u=c.parentTextureArray||c;this.renderer.texture.bind(u,0),l===0&&n.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,c.target,u._glTextures[this.CONTEXT_UID].texture,r),a.push(i.COLOR_ATTACHMENT0+l))}if(a.length>1&&i.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){let c=e.depthTexture;this.renderer.texture.bind(c,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,c._glTextures[this.CONTEXT_UID].texture,r)}(e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)?(n.stencil=n.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,i.DEPTH24_STENCIL8,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,n.stencil)):n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){let{msaaSamples:r}=this,i=lr.NONE;if(e<=1||r===null)return i;for(let n=0;n<r.length;n++)if(r[n]<=e){i=r[n];break}return i===1&&(i=lr.NONE),i}blit(e,r,i){let{current:n,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!n)return;let l=n.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;let u=n.colorTextures[0];if(!u)return;l.blitFramebuffer||(l.blitFramebuffer=new El(n.width,n.height),l.blitFramebuffer.addColorTexture(0,u)),e=l.blitFramebuffer,e.colorTextures[0]!==u&&(e.colorTextures[0]=u,e.dirtyId++,e.dirtyFormat++),(e.width!==n.width||e.height!==n.height)&&(e.width=n.width,e.height=n.height,e.dirtyId++,e.dirtySize++)}r||(r=KB,r.width=n.width,r.height=n.height),i||(i=r);let c=r.width===i.width&&r.height===i.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(r.left,r.top,r.right,r.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,c?o.NEAREST:o.LINEAR)}disposeFramebuffer(e,r){let i=e.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!i)return;delete e.glFramebuffers[this.CONTEXT_UID];let s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),r||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,r)}disposeAll(e){let r=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<r.length;i++)this.disposeFramebuffer(r[i],e)}forceStencil(){let e=this.current;if(!e)return;let r=e.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil)return;e.stencil=!0;let i=e.width,n=e.height,s=this.gl,o=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,s.DEPTH24_STENCIL8,i,n):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,i,n),r.stencil=o,s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Xt}destroy(){this.renderer=null}};Ru.extension={type:Ve.RendererSystem,name:"framebuffer"};Je.add(Ru);var fy={5126:4,5123:2,5121:1},Nu=class{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;Ye.PREFER_ENV===qn.WEBGL_LEGACY&&(i=null),i?(e.createVertexArray=()=>i.createVertexArrayOES(),e.bindVertexArray=n=>i.bindVertexArrayOES(n),e.deleteVertexArray=n=>i.deleteVertexArrayOES(n)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){let i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=(n,s)=>i.vertexAttribDivisorANGLE(n,s),e.drawElementsInstanced=(n,s,o,a,l)=>i.drawElementsInstancedANGLE(n,s,o,a,l),e.drawArraysInstanced=(n,s,o,a)=>i.drawArraysInstancedANGLE(n,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(e,r){r=r||this.renderer.shader.shader;let{gl:i}=this,n=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;n||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=n={},s=!0);let o=n[r.program.id]||this.initGeometryVao(e,r,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(e,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let e=this._activeGeometry,r=this.renderer.buffer;for(let i=0;i<e.buffers.length;i++){let n=e.buffers[i];r.update(n)}}checkCompatibility(e,r){let i=e.attributes,n=r.attributeData;for(let s in n)if(!i[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,r){let i=e.attributes,n=r.attributeData,s=["g",e.id];for(let o in i)n[o]&&s.push(o,n[o].location);return s.join("-")}initGeometryVao(e,r,i=!0){let n=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=r.program;a.glPrograms[s]||this.renderer.shader.generateProgram(r),this.checkCompatibility(e,a);let l=this.getSignature(e,a),c=e.glVertexArrayObjects[this.CONTEXT_UID],u=c[l];if(u)return c[a.id]=u,u;let d=e.buffers,h=e.attributes,p={},m={};for(let g in d)p[g]=0,m[g]=0;for(let g in h)!h[g].size&&a.attributeData[g]?h[g].size=a.attributeData[g].size:h[g].size||console.warn(`PIXI Geometry attribute '${g}' size cannot be determined (likely the bound shader does not have the attribute)`),p[h[g].buffer]+=h[g].size*fy[h[g].type];for(let g in h){let y=h[g],v=y.size;y.stride===void 0&&(p[y.buffer]===v*fy[y.type]?y.stride=0:y.stride=p[y.buffer]),y.start===void 0&&(y.start=m[y.buffer],m[y.buffer]+=v*fy[y.type])}u=n.createVertexArray(),n.bindVertexArray(u);for(let g=0;g<d.length;g++){let y=d[g];o.bind(y),i&&y._glBuffers[s].refCount++}return this.activateVao(e,a),c[a.id]=u,c[l]=u,n.bindVertexArray(null),o.unbind(kn.ARRAY_BUFFER),u}disposeGeometry(e,r){if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];let i=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,s=e.buffers,o=this.renderer?.buffer;if(e.disposeRunner.remove(this),!!i){if(o)for(let a=0;a<s.length;a++){let l=s[a]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!r&&o.dispose(s[a],r))}if(!r){for(let a in i)if(a[0]==="g"){let l=i[a];this._activeVao===l&&this.unbind(),n.deleteVertexArray(l)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){let r=Object.keys(this.managedGeometries);for(let i=0;i<r.length;i++)this.disposeGeometry(this.managedGeometries[r[i]],e)}activateVao(e,r){let i=this.gl,n=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(let c in a){let u=a[c],d=o[u.buffer],h=d._glBuffers[n];if(r.attributeData[c]){l!==h&&(s.bind(d),l=h);let p=r.attributeData[c].location;if(i.enableVertexAttribArray(p),i.vertexAttribPointer(p,u.size,u.type||i.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)i.vertexAttribDivisor(p,u.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,r,i,n){let{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){let a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,r||o.indexBuffer.data.length,l,(i||0)*a,n||1):s.drawElements(e,r||o.indexBuffer.data.length,l,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,i,r||o.getSize(),n||1):s.drawArrays(e,i,r||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}};Nu.extension={type:Ve.RendererSystem,name:"geometry"};Je.add(Nu);var JA=new nr,Q3=class{constructor(e,r){this._texture=e,this.mapCoord=new nr,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,r){r===void 0&&(r=e);let i=this.mapCoord;for(let n=0;n<e.length;n+=2){let s=e[n],o=e[n+1];r[n]=s*i.a+o*i.c+i.tx,r[n+1]=s*i.b+o*i.d+i.ty}return r}update(e){let r=this._texture;if(!r||!r.valid||!e&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;let i=r._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);let n=r.orig,s=r.trim;s&&(JA.set(n.width/s.width,0,0,n.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(JA));let o=r.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,c=this.clampOffset;return a[0]=(r._frame.x+l+c)/o.width,a[1]=(r._frame.y+l+c)/o.height,a[2]=(r._frame.x+r._frame.width-l+c)/o.width,a[3]=(r._frame.y+r._frame.height-l+c)/o.height,this.uClampOffset[0]=c/o.realWidth,this.uClampOffset[1]=c/o.realHeight,this.isSimple=r._frame.width===o.width&&r._frame.height===o.height&&r.rotate===0,!0}};var eC=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`;var tC=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;var K3=class extends Zn{constructor(e,r,i){let n=null;typeof e!="string"&&r===void 0&&i===void 0&&(n=e,e=void 0,r=void 0,i=void 0),super(e||tC,r||eC,i),this.maskSprite=n,this.maskMatrix=new nr}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,r,i,n){let s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Q3(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,r,i,n))}};var Z3=class{constructor(e=null){this.type=ci.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Zn.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=ci.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}};var Du=class{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,r){let i=r;if(!i.isMaskData){let s=this.maskDataPool.pop()||new Z3;s.pooled=!0,s.maskObject=r,i=s}let n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(n),i._colorMask=n?n._colorMask:15,i.autoDetect&&this.detect(i),i._target=e,i.type!==ci.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case ci.SCISSOR:this.renderer.scissor.push(i);break;case ci.STENCIL:this.renderer.stencil.push(i);break;case ci.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case ci.COLOR:this.pushColorMask(i);break;default:break}i.type===ci.SPRITE&&this.maskStack.push(i)}pop(e){let r=this.maskStack.pop();if(!(!r||r._target!==e)){if(r.enabled)switch(r.type){case ci.SCISSOR:this.renderer.scissor.pop(r);break;case ci.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case ci.SPRITE:this.popSpriteMask(r);break;case ci.COLOR:this.popColorMask(r);break;default:break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){let i=this.maskStack[this.maskStack.length-1];i.type===ci.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(e){let r=e.maskObject;r?r.isSprite?e.type=ci.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=ci.SCISSOR:e.type=ci.STENCIL:e.type=ci.COLOR}pushSpriteMask(e){let{maskObject:r}=e,i=e._target,n=e._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new K3]));let s=this.renderer,o=s.renderTexture,a,l;if(o.current){let u=o.current;a=e.resolution||u.resolution,l=e.multisample??u.multisample}else a=e.resolution||s.resolution,l=e.multisample??s.multisample;n[0].resolution=a,n[0].multisample=l,n[0].maskSprite=r;let c=i.filterArea;i.filterArea=r.getBounds(!0),s.filter.push(i,n),i.filterArea=c,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){let r=e._colorMask,i=e._colorMask=r&e.colorMask;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(e){let r=e._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}};Du.extension={type:Ve.RendererSystem,name:"mask"};Je.add(Du);var Fu=class{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){let{gl:r}=this.renderer,i=this.getStackLength();this.maskStack=e;let n=this.getStackLength();n!==i&&(n===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}};var rC=new nr,iC=[],A6=class extends Fu{constructor(t){super(t),this.glConst=Ye.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;let e=t._scissorRect,{maskObject:r}=t,{renderer:i}=this,n=i.renderTexture,s=r.getBounds(!0,iC.pop()??new Xt);this.roundFrameToPixels(s,n.current?n.current.resolution:i.resolution,n.sourceFrame,n.destinationFrame,i.projection.transform),e&&s.fit(e),t._scissorRectLocal=s}static isMatrixRotated(t){if(!t)return!1;let{a:e,b:r,c:i,d:n}=t;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4)}testScissor(t){let{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||A6.isMatrixRotated(e.worldTransform)||A6.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);let r=t._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(t,e,r,i,n){A6.isMatrixRotated(n)||(n=n?rC.copyFrom(n):rC.identity(),n.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(n,t),t.fit(i),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);let{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){let{gl:e}=this.renderer;t&&iC.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){let t=this.maskStack[this.maskStack.length-1]._scissorRect,e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}},C6=A6;C6.extension={type:Ve.RendererSystem,name:"scissor"};Je.add(C6);var Ou=class extends Fu{constructor(e){super(e),this.glConst=Ye.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){let r=e.maskObject,{gl:i}=this.renderer,n=e._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),e._stencilCounter++;let s=e._colorMask;s!==0&&(e._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,s!==0&&(e._colorMask=s,i.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){let r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{let i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(i._colorMask=n,r.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}}_useCurrent(){let e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}};Ou.extension={type:Ve.RendererSystem,name:"stencil"};Je.add(Ou);var Lu=class{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Nt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return Nt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return Nt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){let e=this.rendererPlugins;for(let r in e)this.plugins[r]=new e[r](this.renderer)}destroy(){for(let e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}};Lu.extension={type:[Ve.RendererSystem,Ve.CanvasRendererSystem],name:"_plugin"};Je.add(Lu);var Bu=class{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new nr,this.transform=null}update(e,r,i,n){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,n),this.transform&&this.projectionMatrix.append(this.transform);let s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,r,i,n){let s=this.projectionMatrix,o=n?-1:1;s.identity(),s.a=1/r.width*2,s.d=o*(1/r.height*2),s.tx=-1-r.x*s.a,s.ty=-o-r.y*s.d}setTransform(e){}destroy(){this.renderer=null}};Bu.extension={type:Ve.RendererSystem,name:"projection"};Je.add(Bu);var ZB=new p6,Uu=class{constructor(e){this.renderer=e,this._tempMatrix=new nr}generateTexture(e,r){let{region:i,...n}=r||{},s=i||e.getLocalBounds(null,!0);s.width===0&&(s.width=1),s.height===0&&(s.height=1);let o=Aa.create({width:s.width,height:s.height,...n});this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;let a=e.transform;return e.transform=ZB,this.renderer.render(e,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=a,o}destroy(){}};Uu.extension={type:[Ve.RendererSystem,Ve.CanvasRendererSystem],name:"textureGenerator"};Je.add(Uu);var U1=new Xt,J3=new Xt,Gu=class{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Xt,this.destinationFrame=new Xt,this.viewportFrame=new Xt}bind(e=null,r,i){let n=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,r||(U1.width=e.frame.width,U1.height=e.frame.height,r=U1),i||(J3.x=e.frame.x,J3.y=e.frame.y,J3.width=r.width,J3.height=r.height,i=J3),o=s.framebuffer):(a=n.resolution,r||(U1.width=n._view.screen.width,U1.height=n._view.screen.height,r=U1),i||(i=U1,i.width=r.width,i.height=r.height));let l=this.viewportFrame;l.x=i.x*a,l.y=i.y*a,l.width=i.width*a,l.height=i.height*a,e||(l.y=n.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(i,r,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(i)}clear(e,r){let i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=e?In.shared.setValue(e):i,s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:c,width:u,height:d}=this.viewportFrame;l=Math.round(l),c=Math.round(c),u=Math.round(u),d=Math.round(d),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,c,u,d)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,r),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}};Gu.extension={type:Ve.RendererSystem,name:"renderTexture"};Je.add(Gu);var e5=class{constructor(e,r){this.program=e,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}};function nC(t,e){let r={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){let s=e.getActiveAttrib(t,n);if(s.name.startsWith("gl_"))continue;let o=z3(e,s.type),a={type:o,name:s.name,size:G3(o),location:e.getAttribLocation(t,s.name)};r[s.name]=a}return r}function sC(t,e){let r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){let s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=z3(e,s.type);r[o]={name:o,index:n,type:l,size:s.size,isArray:a,value:U3(l,s.size)}}return r}function dy(t,e){let r=m6(t,t.VERTEX_SHADER,e.vertexSrc),i=m6(t,t.FRAGMENT_SHADER,e.fragmentSrc),n=t.createProgram();t.attachShader(n,r),t.attachShader(n,i);let s=e.extra?.transformFeedbackVaryings;if(s&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(n,s.names,s.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)||cy(t,n,r,i),e.attributeData=nC(n,t),e.uniformData=sC(n,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){let l=Object.keys(e.attributeData);l.sort((c,u)=>c>u?1:-1);for(let c=0;c<l.length;c++)e.attributeData[l[c]].location=c,t.bindAttribLocation(n,c,l[c]);t.linkProgram(n)}t.deleteShader(r),t.deleteShader(i);let o={};for(let l in e.uniformData){let c=e.uniformData[l];o[l]={location:t.getUniformLocation(n,l),value:U3(c.type,c.size)}}return new e5(n,o)}function JB(t,e,r,i,n){r.buffer.update(n)}var eU={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},oC={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function aC(t){let e=t.map(s=>({data:s,offset:0,dataLen:0,dirty:0})),r=0,i=0,n=0;for(let s=0;s<e.length;s++){let o=e[s];if(r=oC[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,i%r!==0&&i<16){let a=i%r%16;i+=a,n+=a}i+r>16?(n=Math.ceil(n/16)*16,o.offset=n,n+=r,i=r):(o.offset=n,i+=r,n+=r)}return n=Math.ceil(n/16)*16,{uboElements:e,size:n}}function lC(t,e){let r=[];for(let i in t)e[i]&&r.push(e[i]);return r.sort((i,n)=>i.index-n.index),r}function hy(t,e){if(!t.autoManage)return{size:0,syncFunc:JB};let r=lC(t.uniforms,e),{uboElements:i,size:n}=aC(r),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){let a=i[o],l=t.uniforms[a.data.name],c=a.data.name,u=!1;for(let d=0;d<Io.length;d++){let h=Io[d];if(h.codeUbo&&h.test(a.data,l)){s.push(`offset = ${a.offset/4};`,Io[d].codeUbo(a.data.name,l)),u=!0;break}}if(!u)if(a.data.size>1){let d=G3(a.data.type),h=Math.max(oC[a.data.type]/16,1),p=d/h,m=(4-p%4)%4;s.push(`
                cv = ud.${c}.value;
                v = uv.${c};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*h}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{let d=eU[a.data.type];s.push(`
                cv = ud.${c}.value;
                v = uv.${c};
                offset = ${a.offset/4};
                ${d};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}var tU=0,k6={textureCount:0,uboCount:0},zu=class{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=tU++}systemCheck(){if(!b6())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,r){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;let i=e.program,n=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==i&&(this.program=i,this.gl.useProgram(n.program)),r||(k6.textureCount=0,k6.uboCount=0,this.syncUniformGroup(e.uniformGroup,k6)),n}setUniforms(e){let r=this.shader.program,i=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(i.uniformData,e,this.renderer)}syncUniformGroup(e,r){let i=this.getGlProgram();(!e.static||e.dirtyId!==i.uniformDirtyGroups[e.id])&&(i.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,i,r))}syncUniforms(e,r,i){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,i)}createSyncGroups(e){let r=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=ay(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,r){let i=this.getGlProgram();if(!e.static||e.dirtyId!==0||!i.uniformGroups[e.id]){e.dirtyId=0;let n=i.uniformGroups[e.id]||this.createSyncBufferGroup(e,i,r);e.buffer.update(),n(i.uniformData,e.uniforms,this.renderer,k6,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,i.uniformBufferBindings[r])}createSyncBufferGroup(e,r,i){let{gl:n}=this.renderer;this.renderer.buffer.bind(e.buffer);let s=this.gl.getUniformBlockIndex(r.program,i);r.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(r.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;let o=this.getSignature(e,this.shader.program.uniformData,"ubo"),a=this._uboCache[o];if(a||(a=this._uboCache[o]=hy(e,this.shader.program.uniformData)),e.autoManage){let l=new Float32Array(a.size/4);e.buffer.update(l)}return r.uniformGroups[e.id]=a.syncFunc,r.uniformGroups[e.id]}getSignature(e,r,i){let n=e.uniforms,s=[`${i}-`];for(let o in n)s.push(o),r[o]&&s.push(r[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){let r=this.gl,i=e.program,n=dy(r,i);return i.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}};zu.extension={type:Ve.RendererSystem,name:"shader"};Je.add(zu);var Ca=class{constructor(e){this.renderer=e}run(e){let{renderer:r}=this;r.runners.init.emit(r.options),e.hello&&console.log(`PixiJS 7.2.1 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}};Ca.defaultOptions={hello:!1};Ca.extension={type:[Ve.RendererSystem,Ve.CanvasRendererSystem],name:"startup"};Je.add(Ca);function cC(t,e=[]){return e[lt.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.ADD]=[t.ONE,t.ONE],e[lt.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.NONE]=[0,0],e[lt.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[lt.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[lt.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[lt.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[lt.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[lt.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[lt.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[lt.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[lt.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[lt.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[lt.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}var rU=0,iU=1,nU=2,sU=3,oU=4,aU=5,py=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=lt.NONE,this._blendEq=!1,this.map=[],this.map[rU]=this.setBlend,this.map[iU]=this.setOffset,this.map[nU]=this.setCullFace,this.map[sU]=this.setDepthTest,this.map[oU]=this.setFrontFace,this.map[aU]=this.setDepthMask,this.checks=[],this.defaultState=new Js,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=cC(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,r=0;for(;e;)e&1&&this.map[r].call(this,!!(t.data&1<<r)),e=e>>1,r++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(py.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(py.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;let e=this.blendModes[t],r=this.gl;e.length===2?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){let r=this.checks.indexOf(t);e&&r===-1?this.checks.push(t):!e&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}},I6=py;I6.extension={type:Ve.RendererSystem,name:"state"};Je.add(I6);var Hu=class extends R1.default{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);let r=(e.priority??[]).filter(n=>e.systems[n]),i=[...r,...Object.keys(e.systems).filter(n=>!r.includes(n))];for(let n of i)this.addSystem(e.systems[n],n)}addRunners(...e){e.forEach(r=>{this.runners[r]=new ti(r)})}addSystem(e,r){let i=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=i,this._systemsHash[r]=i;for(let n in this.runners)this.runners[n].add(i);return this}emitWithCustomOptions(e,r){let i=Object.keys(this._systemsHash);e.items.forEach(n=>{let s=i.find(o=>this._systemsHash[o]===n);n[e.name](r[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}};var M6=class{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=M6.defaultMaxIdle,this.checkCountMax=M6.defaultCheckCountMax,this.mode=M6.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==s6.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let t=this.renderer.texture,e=t.managedTextures,r=!1;for(let i=0;i<e.length;i++){let n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){let i=0;for(let n=0;n<e.length;n++)e[n]!==null&&(e[i++]=e[n]);e.length=i}}unload(t){let e=this.renderer.texture,r=t._texture;r&&!r.framebuffer&&e.destroyTexture(r);for(let i=t.children.length-1;i>=0;i--)this.unload(t.children[i])}destroy(){this.renderer=null}},Pn=M6;Pn.defaultMode=s6.AUTO;Pn.defaultMaxIdle=60*60;Pn.defaultCheckCountMax=60*10;Pn.extension={type:Ve.RendererSystem,name:"textureGC"};Je.add(Pn);var G1=class{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=kt.UNSIGNED_BYTE,this.internalFormat=Oe.RGBA,this.samplerType=0}};function uC(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[kt.UNSIGNED_BYTE]:{[Oe.RGBA]:t.RGBA8,[Oe.RGB]:t.RGB8,[Oe.RG]:t.RG8,[Oe.RED]:t.R8,[Oe.RGBA_INTEGER]:t.RGBA8UI,[Oe.RGB_INTEGER]:t.RGB8UI,[Oe.RG_INTEGER]:t.RG8UI,[Oe.RED_INTEGER]:t.R8UI,[Oe.ALPHA]:t.ALPHA,[Oe.LUMINANCE]:t.LUMINANCE,[Oe.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[kt.BYTE]:{[Oe.RGBA]:t.RGBA8_SNORM,[Oe.RGB]:t.RGB8_SNORM,[Oe.RG]:t.RG8_SNORM,[Oe.RED]:t.R8_SNORM,[Oe.RGBA_INTEGER]:t.RGBA8I,[Oe.RGB_INTEGER]:t.RGB8I,[Oe.RG_INTEGER]:t.RG8I,[Oe.RED_INTEGER]:t.R8I},[kt.UNSIGNED_SHORT]:{[Oe.RGBA_INTEGER]:t.RGBA16UI,[Oe.RGB_INTEGER]:t.RGB16UI,[Oe.RG_INTEGER]:t.RG16UI,[Oe.RED_INTEGER]:t.R16UI,[Oe.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[kt.SHORT]:{[Oe.RGBA_INTEGER]:t.RGBA16I,[Oe.RGB_INTEGER]:t.RGB16I,[Oe.RG_INTEGER]:t.RG16I,[Oe.RED_INTEGER]:t.R16I},[kt.UNSIGNED_INT]:{[Oe.RGBA_INTEGER]:t.RGBA32UI,[Oe.RGB_INTEGER]:t.RGB32UI,[Oe.RG_INTEGER]:t.RG32UI,[Oe.RED_INTEGER]:t.R32UI,[Oe.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[kt.INT]:{[Oe.RGBA_INTEGER]:t.RGBA32I,[Oe.RGB_INTEGER]:t.RGB32I,[Oe.RG_INTEGER]:t.RG32I,[Oe.RED_INTEGER]:t.R32I},[kt.FLOAT]:{[Oe.RGBA]:t.RGBA32F,[Oe.RGB]:t.RGB32F,[Oe.RG]:t.RG32F,[Oe.RED]:t.R32F,[Oe.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[kt.HALF_FLOAT]:{[Oe.RGBA]:t.RGBA16F,[Oe.RGB]:t.RGB16F,[Oe.RG]:t.RG16F,[Oe.RED]:t.R16F},[kt.UNSIGNED_SHORT_5_6_5]:{[Oe.RGB]:t.RGB565},[kt.UNSIGNED_SHORT_4_4_4_4]:{[Oe.RGBA]:t.RGBA4},[kt.UNSIGNED_SHORT_5_5_5_1]:{[Oe.RGBA]:t.RGB5_A1},[kt.UNSIGNED_INT_2_10_10_10_REV]:{[Oe.RGBA]:t.RGB10_A2,[Oe.RGBA_INTEGER]:t.RGB10_A2UI},[kt.UNSIGNED_INT_10F_11F_11F_REV]:{[Oe.RGB]:t.R11F_G11F_B10F},[kt.UNSIGNED_INT_5_9_9_9_REV]:{[Oe.RGB]:t.RGB9_E5},[kt.UNSIGNED_INT_24_8]:{[Oe.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[kt.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[Oe.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[kt.UNSIGNED_BYTE]:{[Oe.RGBA]:t.RGBA,[Oe.RGB]:t.RGB,[Oe.ALPHA]:t.ALPHA,[Oe.LUMINANCE]:t.LUMINANCE,[Oe.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[kt.UNSIGNED_SHORT_5_6_5]:{[Oe.RGB]:t.RGB},[kt.UNSIGNED_SHORT_4_4_4_4]:{[Oe.RGBA]:t.RGBA},[kt.UNSIGNED_SHORT_5_5_5_1]:{[Oe.RGBA]:t.RGBA}},e}var $u=class{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Mt,this.hasIntegerTextures=!1}contextChange(){let e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=uC(e);let r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let n=0;n<r;n++)this.boundTextures[n]=null;this.emptyTextures={};let i=new G1(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new G1(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let n=0;n<6;n++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let n=0;n<this.boundTextures.length;n++)this.bind(null,n)}bind(e,r=0){let{gl:i}=this;if(e=e?.castToBaseTexture(),e?.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;let n=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(e.target,n.texture)),n.dirtyId!==e.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),this.updateTexture(e)):n.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[r]=e}else this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){let{gl:r,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(let n=0;n<i.length;n++)i[n]===e&&(this.currentLocation!==n&&(r.activeTexture(r.TEXTURE0+n),this.currentLocation=n),r.bindTexture(e.target,this.emptyTextures[e.target].texture),i[n]=null)}ensureSamplerType(e){let{boundTextures:r,hasIntegerTextures:i,CONTEXT_UID:n}=this;if(i)for(let s=e-1;s>=0;--s){let o=r[s];o&&o._glTextures[n].samplerType!==n6.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){let r=new G1(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r}initTextureType(e,r){r.internalFormat=this.internalFormats[e.type]?.[e.format]??e.format,this.webGLVersion===2&&e.type===kt.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=e.type}updateTexture(e){let r=e._glTextures[this.CONTEXT_UID];if(!r)return;let i=this.renderer;if(this.initTextureType(e,r),e.resource?.upload(i,e,r))r.samplerType!==n6.FLOAT&&(this.hasIntegerTextures=!0);else{let n=e.realWidth,s=e.realHeight,o=i.gl;(r.width!==n||r.height!==s||r.dirtyId<0)&&(r.width=n,r.height=s,o.texImage2D(e.target,0,r.internalFormat,n,s,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}destroyTexture(e,r){let{gl:i}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),i.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){let n=this.managedTextures.indexOf(e);n!==-1&&qg(this.managedTextures,n,1)}}updateTextureStyle(e){let r=e._glTextures[this.CONTEXT_UID];r&&((e.mipmap===Ks.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?r.mipmap=!1:r.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?r.wrapMode=F3.CLAMP:r.wrapMode=e.wrapMode,e.resource?.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)}setStyle(e,r){let i=this.gl;if(r.mipmap&&e.mipmap!==Ks.ON_MANUAL&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,r.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===Ss.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);let n=this.renderer.context.extensions.anisotropicFiltering;if(n&&e.anisotropicLevel>0&&e.scaleMode===Ss.LINEAR){let s=Math.min(e.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===Ss.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===Ss.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}};$u.extension={type:Ve.RendererSystem,name:"texture"};Je.add($u);var ju=class{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){let{gl:r,CONTEXT_UID:i}=this,n=e._glTransformFeedbacks[i]||this.createGLTransformFeedback(e);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n)}unbind(){let{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,r){let{gl:i,renderer:n}=this;r&&n.shader.bind(r),i.beginTransformFeedback(e)}endTransformFeedback(){let{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){let{gl:r,renderer:i,CONTEXT_UID:n}=this,s=r.createTransformFeedback();e._glTransformFeedbacks[n]=s,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){let a=e.buffers[o];a&&(i.buffer.update(a),a._glBuffers[n].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[n].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,r){let i=e._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this);let s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){let a=e.buffers[o];if(!a)continue;let l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!r&&s.dispose(a,r))}i&&(r||n.deleteTransformFeedback(i),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}};ju.extension={type:Ve.RendererSystem,name:"transformFeedback"};Je.add(ju);var ka=class{constructor(e){this.renderer=e}init(e){this.screen=new Xt(0,0,e.width,e.height),this.element=e.view||Ye.ADAPTER.createCanvas(),this.resolution=e.resolution||Ye.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,r){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(r*this.resolution);let i=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",i,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){e&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}};ka.defaultOptions={width:800,height:600,resolution:Ye.RESOLUTION,autoDensity:!1};ka.extension={type:[Ve.RendererSystem,Ve.CanvasRendererSystem],name:"_view"};Je.add(ka);Ye.PREFER_ENV=qn.WEBGL2;Ye.STRICT_TEXTURE_CACHE=!1;Ye.RENDER_OPTIONS={...Ta.defaultOptions,...Sa.defaultOptions,...ka.defaultOptions,...Ca.defaultOptions};Object.defineProperties(Ye,{WRAP_MODE:{get(){return Mt.defaultOptions.wrapMode},set(t){Nt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Mt.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return Mt.defaultOptions.scaleMode},set(t){Nt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Mt.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return Mt.defaultOptions.mipmap},set(t){Nt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Mt.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return Mt.defaultOptions.anisotropicLevel},set(t){Nt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Mt.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return Nt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Zn.defaultResolution},set(t){Zn.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return Nt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Zn.defaultMultisample},set(t){Zn.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return Kn.defaultMaxTextures},set(t){Nt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Kn.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return Kn.defaultBatchSize},set(t){Nt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Kn.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return Kn.canUploadSameBuffer},set(t){Nt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Kn.canUploadSameBuffer=t}},GC_MODE:{get(){return Pn.defaultMode},set(t){Nt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Pn.defaultMode=t}},GC_MAX_IDLE:{get(){return Pn.defaultMaxIdle},set(t){Nt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Pn.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return Pn.defaultCheckCountMax},set(t){Nt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Pn.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return Mn.defaultVertexPrecision},set(t){Nt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Mn.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return Mn.defaultFragmentPrecision},set(t){Nt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Mn.defaultFragmentPrecision=t}}});var z1=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(z1||{});var Vu=class{constructor(e,r=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=r,this.priority=i,this.once=n}match(e,r=null){return this.fn===e&&this.context===r}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));let r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let r=this.next;return this.next=e?null:r,this.previous=null,r}};var Jn=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Vu(null,null,1/0),this.deltaMS=1/Jn.targetFPMS,this.elapsedMS=1/Jn.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,r=z1.NORMAL){return this._addListener(new Vu(t,e,r))}addOnce(t,e,r=z1.NORMAL){return this._addListener(new Vu(t,e,r,!0))}_addListener(t){let e=this._head.next,r=this._head;if(!e)t.connect(r);else{for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}return this._startIfPossible(),this}remove(t,e){let r=this._head.next;for(;r;)r.match(t,e)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){let n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Jn.targetFPMS;let r=this._head,i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){let e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,Jn.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{let e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!Jn._shared){let t=Jn._shared=new Jn;t.autoStart=!0,t._protected=!0}return Jn._shared}static get system(){if(!Jn._system){let t=Jn._system=new Jn;t.autoStart=!0,t._protected=!0}return Jn._system}},dn=Jn;dn.targetFPMS=.06;Object.defineProperties(Ye,{TARGET_FPMS:{get(){return dn.targetFPMS},set(t){Nt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),dn.targetFPMS=t}}});var t5=class{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,z1.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?dn.shared:new dn,e.autoStart&&this.start()}static destroy(){if(this._ticker){let e=this._ticker;this.ticker=null,e.destroy()}}};t5.extension=Ve.Application;Je.add(t5);var lU=[];Je.handleByList(Ve.Renderer,lU);var r5=class{constructor(e){this.renderer=e}contextChange(e){let r;if(this.renderer.context.webGLVersion===1){let i=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,i)}else{let i=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,i)}r>=lr.HIGH?this.multisample=lr.HIGH:r>=lr.MEDIUM?this.multisample=lr.MEDIUM:r>=lr.LOW?this.multisample=lr.LOW:this.multisample=lr.NONE}destroy(){}};r5.extension={type:Ve.RendererSystem,name:"_multisample"};Je.add(r5);var P6=class{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}};var i5=class{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){let{gl:r,CONTEXT_UID:i}=this,n=e._glBuffers[i]||this.createGLBuffer(e);r.bindBuffer(e.type,n.buffer)}unbind(e){let{gl:r}=this;r.bindBuffer(e,null)}bindBufferBase(e,r){let{gl:i,CONTEXT_UID:n}=this;if(this.boundBufferBases[r]!==e){let s=e._glBuffers[n]||this.createGLBuffer(e);this.boundBufferBases[r]=e,i.bindBufferBase(i.UNIFORM_BUFFER,r,s.buffer)}}bindBufferRange(e,r,i){let{gl:n,CONTEXT_UID:s}=this;i=i||0;let o=e._glBuffers[s]||this.createGLBuffer(e);n.bindBufferRange(n.UNIFORM_BUFFER,r||0,o.buffer,i*256,256)}update(e){let{gl:r,CONTEXT_UID:i}=this,n=e._glBuffers[i]||this.createGLBuffer(e);if(e._updateID!==n.updateID)if(n.updateID=e._updateID,r.bindBuffer(e.type,n.buffer),n.byteLength>=e.data.byteLength)r.bufferSubData(e.type,0,e.data);else{let s=e.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;n.byteLength=e.data.byteLength,r.bufferData(e.type,e.data,s)}}dispose(e,r){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];let i=e._glBuffers[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this),i&&(r||n.deleteBuffer(i.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){let r=Object.keys(this.managedBuffers);for(let i=0;i<r.length;i++)this.dispose(this.managedBuffers[r[i]],e)}createGLBuffer(e){let{CONTEXT_UID:r,gl:i}=this;return e._glBuffers[r]=new P6(i.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[r]}};i5.extension={type:Ve.RendererSystem,name:"buffer"};Je.add(i5);var n5=class{constructor(e){this.renderer=e}render(e,r){let i=this.renderer,n,s,o,a;if(r&&(n=r.renderTexture,s=r.clear,o=r.transform,a=r.skipUpdateTransform),this.renderingToScreen=!n,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(n||(this.lastObjectRendered=e),!a){let l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}i.renderTexture.bind(n),i.batch.currentRenderer.start(),(s??i.background.clearBeforeRender)&&i.renderTexture.clear(),e.render(i),i.batch.currentRenderer.flush(),n&&(r.blit&&i.framebuffer.blit(),n.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}};n5.extension={type:Ve.RendererSystem,name:"objectRenderer"};Je.add(n5);var my=class extends Hu{constructor(t){super(),this.type=Hg.WEBGL,t=Object.assign({},Ye.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Ni({projectionMatrix:new nr},!0);let e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:my.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(Nt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=my.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t?.forceCanvas?!1:Xg()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Nt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Nt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Nt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Nt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){Nt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return Nt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){Nt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return Nt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}},H1=my;H1.extension={type:Ve.Renderer,priority:1};H1.__plugins={};H1.__systems={};Je.handleByMap(Ve.RendererPlugin,H1.__plugins);Je.handleByMap(Ve.RendererSystem,H1.__systems);Je.add(H1);var Tl=class extends Qn{constructor(e,r){let{width:i,height:n}=r||{};super(i,n),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){let o=new Mt;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,r){for(let i=0;i<this.length;i++)e[i]&&(e[i].castToBaseTexture?this.addBaseTextureAt(e[i].castToBaseTexture(),i):e[i]instanceof Qn?this.addResourceAt(e[i],i):this.addResourceAt(Tu(e[i],r),i))}dispose(){for(let e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)}unbind(e){super.unbind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)}load(){if(this._load)return this._load;let r=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(r).then(()=>{let{realWidth:i,realHeight:n}=this.items[0];return this.resize(i,n),Promise.resolve(this)}),this._load}};var Xu=class extends Tl{constructor(e,r){let{width:i,height:n}=r||{},s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:i,height:n}),s&&this.initFromArray(s,r)}addBaseTextureAt(e,r){if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=ba.TEXTURE_2D_ARRAY}upload(e,r,i){let{length:n,itemDirtyIds:s,items:o}=this,{gl:a}=e;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,n,0,r.format,i.type,null);for(let l=0;l<n;l++){let c=o[l];s[l]<c.dirtyId&&(s[l]=c.dirtyId,c.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,c.resource.width,c.resource.height,1,r.format,i.type,c.resource.source))}return!0}};var Wu=class extends Di{constructor(e){super(e)}static test(e){let{OffscreenCanvas:r}=globalThis;return r&&e instanceof r?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}};var s5=class extends Tl{constructor(t,e){let{width:r,height:i,autoLoad:n,linkBaseTexture:s}=e||{};if(t&&t.length!==s5.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:r,height:i});for(let o=0;o<s5.SIDES;o++)this.items[o].target=ba.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=s!==!1,t&&this.initFromArray(t,e),n!==!1&&this.load()}bind(t){super.bind(t),t.target=ba.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=ba.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,r){let i=this.itemDirtyIds;for(let n=0;n<s5.SIDES;n++){let s=this.items[n];(i[n]<s.dirtyId||r.dirtyId<e.dirtyId)&&(s.valid&&s.resource?(s.resource.upload(t,s,r),i[n]=s.dirtyId):i[n]<-1&&(t.gl.texImage2D(s.target,0,r.internalFormat,e.realWidth,e.realHeight,0,e.format,r.type,null),i[n]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===s5.SIDES}},o5=s5;o5.SIDES=6;var to=class extends Di{constructor(e,r){r=r||{};let i,n;typeof e=="string"?(i=to.EMPTY,n=e):(i=e,n=null),super(i),this.url=n,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,r)=>{if(this.url===null){e(this);return}try{let i=await Ye.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;let n=await i.blob();if(this.destroyed)return;let s=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Cn.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=s,this.update(),e(this)}catch(i){if(this.destroyed)return;r(i),this.onError.emit(i)}}),this._load)}upload(e,r,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(e,r,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return to._EMPTY=to._EMPTY??Ye.ADAPTER.createCanvas(0,0),to._EMPTY}};var R6=class extends Di{constructor(t,e){e=e||{},super(Ye.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),t(this)},R6.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){let t=new Image;Di.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;let e=t.width,r=t.height;if(!e||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=e*this.scale,n=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/r*e,n=this._overrideHeight||this._overrideWidth/e*r),i=Math.round(i),n=Math.round(n);let s=this.source;s.width=i,s.height=n,s._pixiId=`canvas_${wa()}`,s.getContext("2d").drawImage(t,0,0,e,r,0,0,i,n),this._resolve(),this._resolve=null}}static getSize(t){let e=R6.SVG_SIZE.exec(t),r={};return e&&(r[e[1]]=Math.round(parseFloat(e[3])),r[e[5]]=Math.round(parseFloat(e[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&R6.SVG_XML.test(t)}},qu=R6;qu.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;qu.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var gy=class extends Di{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){let r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),typeof t=="string"&&(t=[t]);let i=t[0].src||t[0];Di.crossOrigin(r,i,e.crossorigin);for(let n=0;n<t.length;++n){let s=document.createElement("source"),{src:o,mime:a}=t[n];o=o||t[n];let l=o.split("?").shift().toLowerCase(),c=l.slice(l.lastIndexOf(".")+1);a=a||gy.MIME_TYPES[c]||`video/${c}`,s.src=o,s.type=a,r.appendChild(s)}t=r}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){let e=dn.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;let t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise(e=>{this.valid?e(this):(this._resolve=e,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)}_isSourcePlaying(){let t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(dn.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(dn.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){let t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);let e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._isConnectedToTicker&&(dn.shared.remove(this.update,this),this._isConnectedToTicker=!1);let t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(dn.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(dn.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t)}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||gy.TYPES.includes(e)}},Yu=gy;Yu.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];Yu.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Su.push(to,Sl,Wu,Yu,qu,Co,o5,Xu);var cU=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,uU=`uniform float radius;
uniform float strength;
uniform vec2 center;
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

void main()
{
    vec2 coord = vTextureCoord * filterArea.xy;
    coord -= center * dimensions.xy;
    float distance = length(coord);
    if (distance < radius) {
        float percent = distance / radius;
        if (strength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
        }
    }
    coord += center * dimensions.xy;
    coord /= filterArea.xy;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    gl_FragColor = color;
}
`,fC=class extends ke{constructor(t){super(cU,uU),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,fC.defaults,t)}apply(t,e,r,i){let{width:n,height:s}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=s,t.applyFilter(this,e,r,i)}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}get strength(){return this.uniforms.strength}set strength(t){this.uniforms.strength=t}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}},fU=fC;fU.defaults={center:[.5,.5],radius:100,strength:1};var dU=`const float PI = 3.1415926538;
const float PI_2 = PI*2.;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;
uniform sampler2D uSampler;

const int TYPE_LINEAR = 0;
const int TYPE_RADIAL = 1;
const int TYPE_CONIC = 2;
const int MAX_STOPS = 32;

uniform int uNumStops;
uniform float uAlphas[3*MAX_STOPS];
uniform vec3 uColors[MAX_STOPS];
uniform float uOffsets[MAX_STOPS];
uniform int uType;
uniform float uAngle;
uniform float uAlpha;
uniform int uMaxColors;

struct ColorStop {
    float offset;
    vec3 color;
    float alpha;
};

mat2 rotate2d(float angle){
    return mat2(cos(angle), -sin(angle),
    sin(angle), cos(angle));
}

float projectLinearPosition(vec2 pos, float angle){
    vec2 center = vec2(0.5);
    vec2 result = pos - center;
    result = rotate2d(angle) * result;
    result = result + center;
    return clamp(result.x, 0., 1.);
}

float projectRadialPosition(vec2 pos) {
    float r = distance(vFilterCoord, vec2(0.5));
    return clamp(2.*r, 0., 1.);
}

float projectAnglePosition(vec2 pos, float angle) {
    vec2 center = pos - vec2(0.5);
    float polarAngle=atan(-center.y, center.x);
    return mod(polarAngle + angle, PI_2) / PI_2;
}

float projectPosition(vec2 pos, int type, float angle) {
    if (type == TYPE_LINEAR) {
        return projectLinearPosition(pos, angle);
    } else if (type == TYPE_RADIAL) {
        return projectRadialPosition(pos);
    } else if (type == TYPE_CONIC) {
        return projectAnglePosition(pos, angle);
    }

    return pos.y;
}

void main(void) {
    // current/original color
    vec4 currentColor = texture2D(uSampler, vTextureCoord);

    // skip calculations if gradient alpha is 0
    if (0.0 == uAlpha) {
        gl_FragColor = currentColor;
        return;
    }

    // project position
    float y = projectPosition(vFilterCoord, uType, radians(uAngle));

    // check gradient bounds
    float offsetMin = uOffsets[0];
    float offsetMax = 0.0;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (i == uNumStops-1){ // last index
            offsetMax = uOffsets[i];
        }
    }

    if (y  < offsetMin || y > offsetMax) {
        gl_FragColor = currentColor;
        return;
    }

    // limit colors
    if (uMaxColors > 0) {
        float stepSize = 1./float(uMaxColors);
        float stepNumber = float(floor(y/stepSize));
        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment
    }

    // find color stops
    ColorStop from;
    ColorStop to;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (y >= uOffsets[i]) {
            from = ColorStop(uOffsets[i], uColors[i], uAlphas[i]);
            to = ColorStop(uOffsets[i+1], uColors[i+1], uAlphas[i+1]);
        }

        if (i == uNumStops-1){ // last index
            break;
        }
    }

    // mix colors from stops
    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);
    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);

    float segmentHeight = to.offset - from.offset;
    float relativePos = y - from.offset;// position from 0 to [segmentHeight]
    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].

    float gradientAlpha = uAlpha * currentColor.a;
    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

    // mix resulting color with current color
    gl_FragColor = gradientColor + currentColor*(1.-gradientColor.a);
}
`,hU=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform vec4 inputSize;
uniform vec4 outputFrame;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
    vFilterCoord = vTextureCoord * inputSize.xy / outputFrame.zw;
}
`,$1=$1||{};$1.stringify=function(){var t={"visit_linear-gradient":function(e){return t.visit_gradient(e)},"visit_repeating-linear-gradient":function(e){return t.visit_gradient(e)},"visit_radial-gradient":function(e){return t.visit_gradient(e)},"visit_repeating-radial-gradient":function(e){return t.visit_gradient(e)},visit_gradient:function(e){var r=t.visit(e.orientation);return r&&(r+=", "),e.type+"("+r+t.visit(e.colorStops)+")"},visit_shape:function(e){var r=e.value,i=t.visit(e.at),n=t.visit(e.style);return n&&(r+=" "+n),i&&(r+=" at "+i),r},"visit_default-radial":function(e){var r="",i=t.visit(e.at);return i&&(r+=i),r},"visit_extent-keyword":function(e){var r=e.value,i=t.visit(e.at);return i&&(r+=" at "+i),r},"visit_position-keyword":function(e){return e.value},visit_position:function(e){return t.visit(e.value.x)+" "+t.visit(e.value.y)},"visit_%":function(e){return e.value+"%"},visit_em:function(e){return e.value+"em"},visit_px:function(e){return e.value+"px"},visit_literal:function(e){return t.visit_color(e.value,e)},visit_hex:function(e){return t.visit_color("#"+e.value,e)},visit_rgb:function(e){return t.visit_color("rgb("+e.value.join(", ")+")",e)},visit_rgba:function(e){return t.visit_color("rgba("+e.value.join(", ")+")",e)},visit_color:function(e,r){var i=e,n=t.visit(r.length);return n&&(i+=" "+n),i},visit_angular:function(e){return e.value+"deg"},visit_directional:function(e){return"to "+e.value},visit_array:function(e){var r="",i=e.length;return e.forEach(function(n,s){r+=t.visit(n),s<i-1&&(r+=", ")}),r},visit:function(e){if(!e)return"";var r="";if(e instanceof Array)return t.visit_array(e,r);if(e.type){var i=t["visit_"+e.type];if(i)return i(e);throw Error("Missing visitor visit_"+e.type)}else throw Error("Invalid node.")}};return function(e){return t.visit(e)}}();var $1=$1||{};$1.parse=function(){var t={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function r(L){var B=new Error(e+": "+L);throw B.source=e,B}function i(){var L=n();return e.length>0&&r("Invalid input not EOF"),L}function n(){return _(s)}function s(){return o("linear-gradient",t.linearGradient,l)||o("repeating-linear-gradient",t.repeatingLinearGradient,l)||o("radial-gradient",t.radialGradient,d)||o("repeating-radial-gradient",t.repeatingRadialGradient,d)}function o(L,B,O){return a(B,function(R){var U=O();return U&&(D(t.comma)||r("Missing comma before color stops")),{type:L,orientation:U,colorStops:_(b)}})}function a(L,B){var O=D(L);if(O){D(t.startCall)||r("Missing (");var R=B(O);return D(t.endCall)||r("Missing )"),R}}function l(){return c()||u()}function c(){return M("directional",t.sideOrCorner,1)}function u(){return M("angular",t.angleValue,1)}function d(){var L,B=h(),O;return B&&(L=[],L.push(B),O=e,D(t.comma)&&(B=h(),B?L.push(B):e=O)),L}function h(){var L=p()||m();if(L)L.at=y();else{var B=g();if(B){L=B;var O=y();O&&(L.at=O)}else{var R=v();R&&(L={type:"default-radial",at:R})}}return L}function p(){var L=M("shape",/^(circle)/i,0);return L&&(L.style=N()||g()),L}function m(){var L=M("shape",/^(ellipse)/i,0);return L&&(L.style=I()||g()),L}function g(){return M("extent-keyword",t.extentKeywords,1)}function y(){if(M("position",/^at/,0)){var L=v();return L||r("Missing positioning value"),L}}function v(){var L=x();if(L.x||L.y)return{type:"position",value:L}}function x(){return{x:I(),y:I()}}function _(L){var B=L(),O=[];if(B)for(O.push(B);D(t.comma);)B=L(),B?O.push(B):r("One extra comma");return O}function b(){var L=w();return L||r("Expected color definition"),L.length=I(),L}function w(){return A()||k()||T()||E()}function E(){return M("literal",t.literalColor,0)}function A(){return M("hex",t.hexColor,1)}function T(){return a(t.rgbColor,function(){return{type:"rgb",value:_(C)}})}function k(){return a(t.rgbaColor,function(){return{type:"rgba",value:_(C)}})}function C(){return D(t.number)[1]}function I(){return M("%",t.percentageValue,1)||P()||N()}function P(){return M("position-keyword",t.positionKeywords,1)}function N(){return M("px",t.pixelValue,1)||M("em",t.emValue,1)}function M(L,B,O){var R=D(B);if(R)return{type:L,value:R[O]}}function D(L){var B,O;return O=/^[\n\r\t\s]+/.exec(e),O&&F(O[0].length),B=L.exec(e),B&&F(B[0].length),B}function F(L){e=e.substr(L)}return function(L){return e=L.toString(),i()}}();var pU=$1.parse;$1.stringify;var dC={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},hC={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function mU(t){var e,r=[],i=1,n;if(typeof t=="string")if(dC[t])r=dC[t].slice(),n="rgb";else if(t==="transparent")i=0,n="rgb",r=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(t)){var s=t.slice(1),o=s.length,a=o<=4;i=1,a?(r=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],o===4&&(i=parseInt(s[3]+s[3],16)/255)):(r=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],o===8&&(i=parseInt(s[6]+s[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),n="rgb"}else if(e=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(t)){var l=e[1],c=l==="rgb",s=l.replace(/a$/,"");n=s;var o=s==="cmyk"?4:s==="gray"?1:3;r=e[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(h,p){if(/%$/.test(h))return p===o?parseFloat(h)/100:s==="rgb"?parseFloat(h)*255/100:parseFloat(h);if(s[p]==="h"){if(/deg$/.test(h))return parseFloat(h);if(hC[h]!==void 0)return hC[h]}return parseFloat(h)}),l===s&&r.push(1),i=c||r[o]===void 0?1:r[o],r=r.slice(0,o)}else t.length>10&&/[0-9](?:\s|\/)/.test(t)&&(r=t.match(/([0-9]+)/g).map(function(u){return parseFloat(u)}),n=t.match(/([a-z])/ig).join("").toLowerCase());else isNaN(t)?Array.isArray(t)||t.length?(r=[t[0],t[1],t[2]],n="rgb",i=t.length===4?t[3]:1):t instanceof Object&&(t.r!=null||t.red!=null||t.R!=null?(n="rgb",r=[t.r||t.red||t.R||0,t.g||t.green||t.G||0,t.b||t.blue||t.B||0]):(n="hsl",r=[t.h||t.hue||t.H||0,t.s||t.saturation||t.S||0,t.l||t.lightness||t.L||t.b||t.brightness]),i=t.a||t.alpha||t.opacity||1,t.opacity!=null&&(i/=100)):(n="rgb",r=[t>>>16,(t&65280)>>>8,t&255]);return{space:n,values:r,alpha:i}}var xy={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},yy={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e=t[0]/360,r=t[1]/100,i=t[2]/100,n,s,o,a,l;if(r===0)return l=i*255,[l,l,l];i<.5?s=i*(1+r):s=i+r-i*r,n=2*i-s,a=[0,0,0];for(var c=0;c<3;c++)o=e+1/3*-(c-1),o<0?o++:o>1&&o--,6*o<1?l=n+(s-n)*6*o:2*o<1?l=s:3*o<2?l=n+(s-n)*(2/3-o)*6:l=n,a[c]=l*255;return a}};xy.hsl=function(t){var e=t[0]/255,r=t[1]/255,i=t[2]/255,n=Math.min(e,r,i),s=Math.max(e,r,i),o=s-n,a,l,c;return s===n?a=0:e===s?a=(r-i)/o:r===s?a=2+(i-e)/o:i===s&&(a=4+(e-r)/o),a=Math.min(a*60,360),a<0&&(a+=360),c=(n+s)/2,s===n?l=0:c<=.5?l=o/(s+n):l=o/(2-s-n),[a,l*100,c*100]};function gU(t){Array.isArray(t)&&t.raw&&(t=String.raw(...arguments));var e,r=mU(t);if(!r.space)return[];let i=r.space[0]==="h"?yy.min:xy.min,n=r.space[0]==="h"?yy.max:xy.max;return e=Array(3),e[0]=Math.min(Math.max(r.values[0],i[0]),n[0]),e[1]=Math.min(Math.max(r.values[1],i[1]),n[1]),e[2]=Math.min(Math.max(r.values[2],i[2]),n[2]),r.space[0]==="h"&&(e=yy.rgb(e)),e.push(Math.min(Math.max(r.alpha,0),1)),e}function yC(t){switch(typeof t){case"string":return yU(t);case"number":return he.hex2rgb(t);default:return t}}function yU(t){let e=gU(t);if(!e)throw new Error(`Unable to parse color "${t}" as RGBA.`);return[e[0]/255,e[1]/255,e[2]/255,e[3]]}function vU(t){let e=pU(CU(t));if(e.length===0)throw new Error("Invalid CSS gradient.");if(e.length!==1)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");let r=e[0],i=xU(r.type),n=_U(r.colorStops),s=TU(r.orientation);return{type:i,stops:n,angle:s}}function xU(t){let e={"linear-gradient":0,"radial-gradient":1};if(!(t in e))throw new Error(`Unsupported gradient type "${t}"`);return e[t]}function _U(t){let e=EU(t),r=[];for(let i=0;i<t.length;i++){let n=bU(t[i]);r.push({offset:e[i],color:n.slice(0,3),alpha:n[3]})}return r}function bU(t){return yC(wU(t))}function wU(t){switch(t.type){case"hex":return`#${t.value}`;case"literal":return t.value;default:return`${t.type}(${t.value.join(",")})`}}function EU(t){let e=[];for(let n=0;n<t.length;n++){let s=t[n],o=-1;s.type==="literal"&&s.length&&"type"in s.length&&s.length.type==="%"&&"value"in s.length&&(o=parseFloat(s.length.value)/100),e.push(o)}let r=n=>{for(let s=n;s<e.length;s++)if(e[s]!==-1)return{indexDelta:s-n,offset:e[s]};return{indexDelta:e.length-1-n,offset:1}},i=0;for(let n=0;n<e.length;n++){let s=e[n];if(s!==-1)i=s;else if(n===0)e[n]=0;else if(n+1===e.length)e[n]=1;else{let o=r(n),a=(o.offset-i)/(1+o.indexDelta);for(let l=0;l<=o.indexDelta;l++)e[n+l]=i+(l+1)*a;n+=o.indexDelta,i=e[n]}}return e.map(SU)}function SU(t){return t.toString().length>6?parseFloat(t.toString().substring(0,6)):t}function TU(t){if(typeof t>"u")return 0;if("type"in t&&"value"in t)switch(t.type){case"angular":return parseFloat(t.value);case"directional":return AU(t.value)}return 0}function AU(t){let e={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(t in e))throw new Error(`Unsupported directional value "${t}"`);return e[t]}function CU(t){let e=t.replace(/\s{2,}/gu," ");return e=e.replace(/;/g,""),e=e.replace(/ ,/g,","),e=e.replace(/\( /g,"("),e=e.replace(/ \)/g,")"),e.trim()}var kU=Object.defineProperty,IU=Object.defineProperties,MU=Object.getOwnPropertyDescriptors,pC=Object.getOwnPropertySymbols,PU=Object.prototype.hasOwnProperty,RU=Object.prototype.propertyIsEnumerable,mC=(t,e,r)=>e in t?kU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vy=(t,e)=>{for(var r in e||(e={}))PU.call(e,r)&&mC(t,r,e[r]);if(pC)for(var r of pC(e))RU.call(e,r)&&mC(t,r,e[r]);return t},NU=(t,e)=>IU(t,MU(e)),gC=90;function DU(t){return[...t].sort((e,r)=>e.offset-r.offset)}var _y=class extends ke{constructor(t){t&&"css"in t&&(t=NU(vy({},vU(t.css||"")),{alpha:t.alpha,maxColors:t.maxColors}));let e=vy(vy({},_y.defaults),t);if(!e.stops||e.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");super(hU,dU),this._stops=[],this.autoFit=!1,Object.assign(this,e)}get stops(){return this._stops}set stops(t){let e=DU(t),r=new Float32Array(e.length*3),i=0,n=1,s=2;for(let o=0;o<e.length;o++){let a=yC(e[o].color),l=o*3;r[l+i]=a[i],r[l+n]=a[n],r[l+s]=a[s]}this.uniforms.uColors=r,this.uniforms.uOffsets=e.map(o=>o.offset),this.uniforms.uAlphas=e.map(o=>o.alpha),this.uniforms.uNumStops=e.length,this._stops=e}set type(t){this.uniforms.uType=t}get type(){return this.uniforms.uType}set angle(t){this.uniforms.uAngle=t-gC}get angle(){return this.uniforms.uAngle+gC}set alpha(t){this.uniforms.uAlpha=t}get alpha(){return this.uniforms.uAlpha}set maxColors(t){this.uniforms.uMaxColors=t}get maxColors(){return this.uniforms.uMaxColors}},N6=_y;N6.LINEAR=0,N6.RADIAL=1,N6.CONIC=2,N6.defaults={type:_y.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0};var FU=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,OU=`precision mediump float;

varying mediump vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec2 texelSize;
uniform float matrix[9];

void main(void)
{
   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left
   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center
   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right

   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left
   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center
   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right

   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left
   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center
   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right

   gl_FragColor =
       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +
       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +
       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];

   gl_FragColor.a = c22.a;
}
`,D6=class extends ke{constructor(e,r=200,i=200){super(FU,OU),this.uniforms.texelSize=new Float32Array(2),this.uniforms.matrix=new Float32Array(9),e!==void 0&&(this.matrix=e),this.width=r,this.height=i}get matrix(){return this.uniforms.matrix}set matrix(e){e.forEach((r,i)=>{this.uniforms.matrix[i]=r})}get width(){return 1/this.uniforms.texelSize[0]}set width(e){this.uniforms.texelSize[0]=1/e}get height(){return 1/this.uniforms.texelSize[1]}set height(e){this.uniforms.texelSize[1]=1/e}};var LU=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,BU=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec2 dimensions;

const float SQRT_2 = 1.414213;

const float light = 1.0;

uniform float curvature;
uniform float lineWidth;
uniform float lineContrast;
uniform bool verticalLine;
uniform float noise;
uniform float noiseSize;

uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;

uniform float seed;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));
    
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 rgb = gl_FragColor.rgb;

    if (noise > 0.0 && noiseSize > 0.0)
    {
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        rgb += _noise * noise;
    }

    if (lineWidth > 0.0)
    {
        float _c = curvature > 0. ? curvature : 1.;
        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
        vec2 uv = dir * k;

        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;
        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;
        rgb *= j;
        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);
        rgb *= 0.99 + ceil(segment) * 0.015;
    }

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    gl_FragColor.rgb = rgb;
}
`,vC=class extends ke{constructor(t){super(LU,BU),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,vC.defaults,t)}apply(t,e,r,i){let{width:n,height:s}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=s,this.uniforms.seed=this.seed,this.uniforms.time=this.time,t.applyFilter(this,e,r,i)}set curvature(t){this.uniforms.curvature=t}get curvature(){return this.uniforms.curvature}set lineWidth(t){this.uniforms.lineWidth=t}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(t){this.uniforms.lineContrast=t}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(t){this.uniforms.verticalLine=t}get verticalLine(){return this.uniforms.verticalLine}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}},UU=vC;UU.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};var GU=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,zU=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float alpha;
uniform vec3 color;

uniform vec2 shift;
uniform vec4 inputSize;

void main(void){
    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);

    // Premultiply alpha
    sample.rgb = color.rgb * sample.a;

    // alpha user alpha
    sample *= alpha;

    gl_FragColor = sample;
}`,HU=Object.defineProperty,xC=Object.getOwnPropertySymbols,$U=Object.prototype.hasOwnProperty,jU=Object.prototype.propertyIsEnumerable,_C=(t,e,r)=>e in t?HU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bC=(t,e)=>{for(var r in e||(e={}))$U.call(e,r)&&_C(t,r,e[r]);if(xC)for(var r of xC(e))jU.call(e,r)&&_C(t,r,e[r]);return t},by=class extends ke{constructor(t){super(),this.angle=45,this._distance=5,this._resolution=ue.FILTER_RESOLUTION;let e=t?bC(bC({},by.defaults),t):by.defaults,{kernels:r,blur:i,quality:n,pixelSize:s,resolution:o}=e;this._offset=new Pi(this._updatePadding,this),this._tintFilter=new ke(GU,zU),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=o,this._blurFilter=r?new xl(r):new xl(i,n),this.pixelSize=s,this.resolution=o;let{shadowOnly:a,rotation:l,distance:c,offset:u,alpha:d,color:h}=e;this.shadowOnly=a,l!==void 0&&c!==void 0?(this.rotation=l,this.distance=c):this.offset=u,this.alpha=d,this.color=h}apply(t,e,r,i){let n=t.getFilterTexture();this._tintFilter.apply(t,e,n,1),this._blurFilter.apply(t,n,r,i),this.shadowOnly!==!0&&t.applyFilter(this,e,r,0),t.returnFilterTexture(n)}_updatePadding(){let t=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y));this.padding=t+this.blur*2}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(t){this._offset.copyFrom(t),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._tintFilter&&(this._tintFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get distance(){return this._distance}set distance(t){he.deprecation("5.3.0","DropShadowFilter distance is deprecated, use offset"),this._distance=t,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/zs}set rotation(t){he.deprecation("5.3.0","DropShadowFilter rotation is deprecated, use offset"),this.angle=t*zs,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(t){this._tintFilter.uniforms.alpha=t}get color(){return he.rgb2hex(this._tintFilter.uniforms.color)}set color(t){he.hex2rgb(t,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}},VU=by;VU.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:ue.FILTER_RESOLUTION};var XU=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,WU=`// precision highp float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;
uniform float aspect;

uniform sampler2D displacementMap;
uniform float offset;
uniform float sinDir;
uniform float cosDir;
uniform int fillMode;

uniform float seed;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * aspect;
    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (offset / filterArea.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);

    if (fillMode == CLAMP) {
        coord = clamp(coord, filterClamp.xy, filterClamp.zw);
    } else {
        if( coord.x > filterClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = filterClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < filterClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -filterClamp.z;
            }
        }

        if( coord.y > filterClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = filterClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < filterClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -filterClamp.w;
            }
        }
    }

    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;
    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;
    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;
    gl_FragColor.a = texture2D(uSampler, coord).a;
}
`,wy=class extends ke{constructor(t){super(XU,WU),this.offset=100,this.fillMode=wy.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=be.from(this._canvas,{scaleMode:ki.NEAREST}),Object.assign(this,wy.defaults,t)}apply(t,e,r,i){let{width:n,height:s}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=s,this.uniforms.aspect=s/n,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,t.applyFilter(this,e,r,i)}_randomizeSizes(){let t=this._sizes,e=this._slices-1,r=this.sampleSize,i=Math.min(this.minSize/r,.9/this._slices);if(this.average){let n=this._slices,s=1;for(let o=0;o<e;o++){let a=s/(n-o),l=Math.max(a*(1-Math.random()*.6),i);t[o]=l,s-=l}t[e]=s}else{let n=1,s=Math.sqrt(1/this._slices);for(let o=0;o<e;o++){let a=Math.max(s*n*Math.random(),i);t[o]=a,n-=a}t[e]=n}this.shuffle()}shuffle(){let t=this._sizes,e=this._slices-1;for(let r=e;r>0;r--){let i=Math.random()*r>>0,n=t[r];t[r]=t[i],t[i]=n}}_randomizeOffsets(){for(let t=0;t<this._slices;t++)this._offsets[t]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){let t=this.sampleSize,e=this.texture,r=this._canvas.getContext("2d");r.clearRect(0,0,8,t);let i,n=0;for(let s=0;s<this._slices;s++){i=Math.floor(this._offsets[s]*256);let o=this._sizes[s]*t,a=i>0?i:0,l=i<0?-i:0;r.fillStyle=`rgba(${a}, ${l}, 0, 1)`,r.fillRect(0,n>>0,t,o+1>>0),n+=o}e.baseTexture.update(),this.uniforms.displacementMap=e}set sizes(t){let e=Math.min(this._slices,t.length);for(let r=0;r<e;r++)this._sizes[r]=t[r]}get sizes(){return this._sizes}set offsets(t){let e=Math.min(this._slices,t.length);for(let r=0;r<e;r++)this._offsets[r]=t[r]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(t){this._slices!==t&&(this._slices=t,this.uniforms.slices=t,this._sizes=this.uniforms.slicesWidth=new Float32Array(t),this._offsets=this.uniforms.slicesOffset=new Float32Array(t),this.refresh())}get direction(){return this._direction}set direction(t){if(this._direction===t)return;this._direction=t;let e=t*zs;this.uniforms.sinDir=Math.sin(e),this.uniforms.cosDir=Math.cos(e)}get red(){return this.uniforms.red}set red(t){this.uniforms.red=t}get green(){return this.uniforms.green}set green(t){this.uniforms.green=t}get blue(){return this.uniforms.blue}set blue(t){this.uniforms.blue=t}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}},Qu=wy;Qu.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},Qu.TRANSPARENT=0,Qu.ORIGINAL=1,Qu.LOOP=2,Qu.CLAMP=3,Qu.MIRROR=4;var qU=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,YU=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

uniform float outerStrength;
uniform float innerStrength;

uniform vec4 glowColor;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform bool knockout;
uniform float alpha;

const float PI = 3.14159265358979323846264;

const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);
const float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);

const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;

void main(void) {
    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);

    float totalAlpha = 0.0;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {
       direction = vec2(cos(angle), sin(angle)) * px;

       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {
           displaced = clamp(vTextureCoord + direction * 
                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);

           curColor = texture2D(uSampler, displaced);

           totalAlpha += (DIST - curDistance) * curColor.a;
       }
    }
    
    curColor = texture2D(uSampler, vTextureCoord);

    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);

    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;
    float innerGlowStrength = min(1.0, innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);

    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);
    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);

    if (knockout) {
      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;
      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;
      gl_FragColor = innerColor + outerGlowColor;
    }
}
`,wC=class extends ke{constructor(t){let e=Object.assign({},wC.defaults,t),{outerStrength:r,innerStrength:i,color:n,knockout:s,quality:o,alpha:a}=e,l=Math.round(e.distance);super(qU,YU.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/o/l).toFixed(7)}`).replace(/__DIST__/gi,`${l.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:n,outerStrength:r,innerStrength:i,padding:l,knockout:s,alpha:a})}get color(){return he.rgb2hex(this.uniforms.glowColor)}set color(t){he.hex2rgb(t,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(t){this.uniforms.outerStrength=t}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(t){this.uniforms.innerStrength=t}get knockout(){return this.uniforms.knockout}set knockout(t){this.uniforms.knockout=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}},j1=wC;j1.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};var QU=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,KU=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,ZU=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform vec2 light;
uniform bool parallel;
uniform float aspect;

uniform float gain;
uniform float lacunarity;
uniform float time;
uniform float alpha;

\${perlin}

void main(void) {
    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    float d;

    if (parallel) {
        float _cos = light.x;
        float _sin = light.y;
        d = (_cos * coord.x) + (_sin * coord.y * aspect);
    } else {
        float dx = coord.x - light.x / dimensions.x;
        float dy = (coord.y - light.y / dimensions.y) * aspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    vec3 dir = vec3(d, d, 0.0);

    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;

}
`,EC=class extends ke{constructor(t){super(QU,ZU.replace("${perlin}",KU)),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);let e=Object.assign(EC.defaults,t);this._angleLight=new Ne,this.angle=e.angle,this.gain=e.gain,this.lacunarity=e.lacunarity,this.alpha=e.alpha,this.parallel=e.parallel,this.center=e.center,this.time=e.time}apply(t,e,r,i){let{width:n,height:s}=e.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=s,this.uniforms.aspect=s/n,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,r,i)}get angle(){return this._angle}set angle(t){this._angle=t;let e=t*zs;this._angleLight.x=Math.cos(e),this._angleLight.y=Math.sin(e)}get gain(){return this.uniforms.gain}set gain(t){this.uniforms.gain=t}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(t){this.uniforms.lacunarity=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}},JU=EC;JU.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};var eG=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,tG=`precision mediump float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float uHue;
uniform float uAlpha;
uniform bool uColorize;
uniform float uSaturation;
uniform float uLightness;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

float getWeightedAverage(vec3 rgb) {
    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const vec3 k = vec3(0.57735, 0.57735, 0.57735);

vec3 hueShift(vec3 color, float angle) {
    float cosAngle = cos(angle);
    return vec3(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    vec4 result = color;

    // colorize
    if (uColorize) {
        result.rgb = vec3(getWeightedAverage(result.rgb), 0., 0.);
    }

    // hue
    result.rgb = hueShift(result.rgb, uHue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    float average = (result.r + result.g + result.b) / 3.0;

    if (uSaturation > 0.) {
        result.rgb += (average - result.rgb) * (1. - 1. / (1.001 - uSaturation));
    } else {
        result.rgb -= (average - result.rgb) * uSaturation;
    }

    // lightness
    result.rgb = mix(result.rgb, vec3(ceil(uLightness)) * color.a, abs(uLightness));

    // alpha
    gl_FragColor = mix(color, result, uAlpha);
}
`,SC=class extends ke{constructor(t){super(eG,tG),this._hue=0;let e=Object.assign({},SC.defaults,t);Object.assign(this,e)}get hue(){return this._hue}set hue(t){this._hue=t,this.uniforms.uHue=this._hue*(Math.PI/180)}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}get colorize(){return this.uniforms.uColorize}set colorize(t){this.uniforms.uColorize=t}get lightness(){return this.uniforms.uLightness}set lightness(t){this.uniforms.uLightness=t}get saturation(){return this.uniforms.uSaturation}set saturation(t){this.uniforms.uSaturation=t}},rG=SC;rG.defaults={hue:0,saturation:0,lightness:0,colorize:!1,alpha:1};var iG=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,nG=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform float sepia;
uniform float noise;
uniform float noiseSize;
uniform float scratch;
uniform float scratchDensity;
uniform float scratchWidth;
uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;
uniform float seed;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 color = gl_FragColor.rgb;

    if (sepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + sepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= dimensions.y / dimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    if (scratchDensity > seed && scratch != 0.0)
    {
        float phase = seed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));
        if (d < seed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / dimensions.x * (0.75 + seed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        color += _noise * noise;
    }

    gl_FragColor.rgb = color;
}
`,TC=class extends ke{constructor(t,e=0){super(iG,nG),this.seed=0,this.uniforms.dimensions=new Float32Array(2),typeof t=="number"?(this.seed=t,t=void 0):this.seed=e,Object.assign(this,TC.defaults,t)}apply(t,e,r,i){var n,s;this.uniforms.dimensions[0]=(n=e.filterFrame)==null?void 0:n.width,this.uniforms.dimensions[1]=(s=e.filterFrame)==null?void 0:s.height,this.uniforms.seed=this.seed,t.applyFilter(this,e,r,i)}set sepia(t){this.uniforms.sepia=t}get sepia(){return this.uniforms.sepia}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set scratch(t){this.uniforms.scratch=t}get scratch(){return this.uniforms.scratch}set scratchDensity(t){this.uniforms.scratchDensity=t}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(t){this.uniforms.scratchWidth=t}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}},sG=TC;sG.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};var oG=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aG=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterClamp;

uniform float uAlpha;
uniform vec2 uThickness;
uniform vec4 uColor;
uniform bool uKnockout;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${angleStep};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture2D(uSampler, vTextureCoord);
    vec4 contentColor = sourceColor * float(!uKnockout);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    gl_FragColor = contentColor + outlineColor;
}
`,F6=class extends ke{constructor(t=1,e=0,r=.1,i=1,n=!1){super(oG,aG.replace(/\$\{angleStep\}/,F6.getAngleStep(r))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=i,this.uniforms.uKnockout=n,Object.assign(this,{thickness:t,color:e,quality:r,alpha:i,knockout:n})}static getAngleStep(t){let e=Math.max(t*F6.MAX_SAMPLES,F6.MIN_SAMPLES);return(Math.PI*2/e).toFixed(7)}apply(t,e,r,i){this.uniforms.uThickness[0]=this._thickness/e._frame.width,this.uniforms.uThickness[1]=this._thickness/e._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,t.applyFilter(this,e,r,i)}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get color(){return he.rgb2hex(this.uniforms.uColor)}set color(t){he.hex2rgb(t,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(t){this._knockout=t}get thickness(){return this._thickness}set thickness(t){this._thickness=t,this.padding=t}},AC=F6;AC.MIN_SAMPLES=1,AC.MAX_SAMPLES=100;var lG=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,cG=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

uniform bool mirror;
uniform float boundary;
uniform vec2 amplitude;
uniform vec2 waveLength;
uniform vec2 alpha;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 coord = pixelCoord / dimensions;

    if (coord.y < boundary) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    float k = (coord.y - boundary) / (1. - boundary + 0.0001);
    float areaY = boundary * dimensions.y / filterArea.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = mirror ? v : vTextureCoord.y;

    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;
    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;
    float _alpha = (alpha.y - alpha.x) * k + alpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;
    x = clamp(x, filterClamp.x, filterClamp.z);

    vec4 color = texture2D(uSampler, vec2(x, y));

    gl_FragColor = color * _alpha;
}
`,CC=class extends ke{constructor(t){super(lG,cG),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,CC.defaults,t)}apply(t,e,r,i){var n,s;this.uniforms.dimensions[0]=(n=e.filterFrame)==null?void 0:n.width,this.uniforms.dimensions[1]=(s=e.filterFrame)==null?void 0:s.height,this.uniforms.time=this.time,t.applyFilter(this,e,r,i)}set mirror(t){this.uniforms.mirror=t}get mirror(){return this.uniforms.mirror}set boundary(t){this.uniforms.boundary=t}get boundary(){return this.uniforms.boundary}set amplitude(t){this.uniforms.amplitude[0]=t[0],this.uniforms.amplitude[1]=t[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(t){this.uniforms.waveLength[0]=t[0],this.uniforms.waveLength[1]=t[1]}get waveLength(){return this.uniforms.waveLength}set alpha(t){this.uniforms.alpha[0]=t[0],this.uniforms.alpha[1]=t[1]}get alpha(){return this.uniforms.alpha}},uG=CC;uG.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};var fG=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,dG=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 filterClamp;

uniform vec2 center;

uniform float amplitude;
uniform float wavelength;
// uniform float power;
uniform float brightness;
uniform float speed;
uniform float radius;

uniform float time;

const float PI = 3.14159;

void main()
{
    float halfWavelength = wavelength * 0.5 / filterArea.x;
    float maxRadius = radius / filterArea.x;
    float currentRadius = time * speed / filterArea.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);
    dir.y *= filterArea.y / filterArea.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );

    vec2 offset = diffUV * powDiff / filterArea.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);

    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;

    gl_FragColor = color;
}
`,kC=class extends ke{constructor(t=[0,0],e,r=0){super(fG,dG),this.center=t,Object.assign(this,kC.defaults,e),this.time=r}apply(t,e,r,i){this.uniforms.time=this.time,t.applyFilter(this,e,r,i)}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}get amplitude(){return this.uniforms.amplitude}set amplitude(t){this.uniforms.amplitude=t}get wavelength(){return this.uniforms.wavelength}set wavelength(t){this.uniforms.wavelength=t}get brightness(){return this.uniforms.brightness}set brightness(t){this.uniforms.brightness=t}get speed(){return this.uniforms.speed}set speed(t){this.uniforms.speed=t}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}},hG=kC;hG.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};var pG=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,mG=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float blur;
uniform float gradientBlur;
uniform vec2 start;
uniform vec2 end;
uniform vec2 delta;
uniform vec2 texSize;

float random(vec3 scale, float seed)
{
    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}

void main(void)
{
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));
    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;

    for (float t = -30.0; t <= 30.0; t++)
    {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);
        sample.rgb *= sample.a;
        color += sample * weight;
        total += weight;
    }

    color /= total;
    color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,O6=class extends ke{constructor(e){var r,i;super(pG,mG),this.uniforms.blur=e.blur,this.uniforms.gradientBlur=e.gradientBlur,this.uniforms.start=(r=e.start)!=null?r:new Ne(0,window.innerHeight/2),this.uniforms.end=(i=e.end)!=null?i:new Ne(600,window.innerHeight/2),this.uniforms.delta=new Ne(30,30),this.uniforms.texSize=new Ne(window.innerWidth,window.innerHeight),this.updateDelta()}updateDelta(){this.uniforms.delta.x=0,this.uniforms.delta.y=0}get blur(){return this.uniforms.blur}set blur(e){this.uniforms.blur=e}get gradientBlur(){return this.uniforms.gradientBlur}set gradientBlur(e){this.uniforms.gradientBlur=e}get start(){return this.uniforms.start}set start(e){this.uniforms.start=e,this.updateDelta()}get end(){return this.uniforms.end}set end(e){this.uniforms.end=e,this.updateDelta()}},Ey=class extends O6{updateDelta(){let e=this.uniforms.end.x-this.uniforms.start.x,r=this.uniforms.end.y-this.uniforms.start.y,i=Math.sqrt(e*e+r*r);this.uniforms.delta.x=e/i,this.uniforms.delta.y=r/i}},Sy=class extends O6{updateDelta(){let e=this.uniforms.end.x-this.uniforms.start.x,r=this.uniforms.end.y-this.uniforms.start.y,i=Math.sqrt(e*e+r*r);this.uniforms.delta.x=-r/i,this.uniforms.delta.y=e/i}},IC=class extends ke{constructor(t,e,r,i){super(),typeof t=="number"&&(he.deprecation("5.3.0","TiltShiftFilter constructor arguments is deprecated, use options."),t={blur:t,gradientBlur:e,start:r,end:i}),t=Object.assign({},IC.defaults,t),this.tiltShiftXFilter=new Ey(t),this.tiltShiftYFilter=new Sy(t)}apply(t,e,r,i){let n=t.getFilterTexture();this.tiltShiftXFilter.apply(t,e,n,1),this.tiltShiftYFilter.apply(t,n,r,i),t.returnFilterTexture(n)}get blur(){return this.tiltShiftXFilter.blur}set blur(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t}get gradientBlur(){return this.tiltShiftXFilter.gradientBlur}set gradientBlur(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t}get start(){return this.tiltShiftXFilter.start}set start(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t}get end(){return this.tiltShiftXFilter.end}set end(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t}},gG=IC;gG.defaults={blur:100,gradientBlur:600,start:void 0,end:void 0};var yG=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,vG=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform vec4 filterArea;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= offset;

    float dist = length(coord);

    if (dist < radius)
    {
        float ratioDist = (radius - dist) / radius;
        float angleMod = ratioDist * ratioDist * angle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += offset;

    return coord;
}

void main(void)
{

    vec2 coord = mapCoord(vTextureCoord);

    coord = twist(coord);

    coord = unmapCoord(coord);

    gl_FragColor = texture2D(uSampler, coord );

}
`,MC=class extends ke{constructor(t){super(yG,vG),Object.assign(this,MC.defaults,t)}get offset(){return this.uniforms.offset}set offset(t){this.uniforms.offset=t}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}get angle(){return this.uniforms.angle}set angle(t){this.uniforms.angle=t}},xG=MC;xG.defaults={radius:200,angle:4,padding:20,offset:new Ne};var _G=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,bG=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uCenter;
uniform float uStrength;
uniform float uInnerRadius;
uniform float uRadius;

const float MAX_KERNEL_SIZE = \${maxKernelSize};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {

    float minGradient = uInnerRadius * 0.3;
    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;

    float gradient = uRadius * 0.3;
    float radius = (uRadius - gradient * 0.5) / filterArea.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / filterArea.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture2D(uSampler, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,PC=Object.getOwnPropertySymbols,wG=Object.prototype.hasOwnProperty,EG=Object.prototype.propertyIsEnumerable,SG=(t,e)=>{var r={};for(var i in t)wG.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&PC)for(var i of PC(t))e.indexOf(i)<0&&EG.call(t,i)&&(r[i]=t[i]);return r},RC=class extends ke{constructor(t){let e=Object.assign(RC.defaults,t),{maxKernelSize:r}=e,i=SG(e,["maxKernelSize"]);super(_G,bG.replace("${maxKernelSize}",r.toFixed(1))),Object.assign(this,i)}get center(){return this.uniforms.uCenter}set center(t){this.uniforms.uCenter=t}get strength(){return this.uniforms.uStrength}set strength(t){this.uniforms.uStrength=t}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(t){this.uniforms.uInnerRadius=t}get radius(){return this.uniforms.uRadius}set radius(t){(t<0||t===1/0)&&(t=-1),this.uniforms.uRadius=t}},TG=RC;TG.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32};function NC(t){return t instanceof Set?t:new Set(t!==void 0&&[].concat(t))}var Bt=class{constructor(e,r){this.scene=e,this.renderer=e.renderer,this.context=e.context,this.layerID=r,this._enabled=!1,this.features=new Map,this.retained=new Map,this._featureHasData=new Map,this._dataHasFeature=new Map,this._parentHasChildren=new Map,this._childHasParents=new Map,this._dataHasClass=new Map,this._classHasData=new Map}render(){}cull(e){for(let[r,i]of this.features){let n=this.retained.get(r);n!==e&&(i.visible=!1,e-n>20&&i.destroy())}}addFeature(e){this.features.set(e.id,e)}removeFeature(e){this.unbindData(e.id),this.retained.delete(e.id),this.features.delete(e.id)}retainFeature(e,r){e.lod>0&&(e.visible=!0),this.retained.set(e.id,r)}syncFeatureClasses(e){let r=e.id,i=this._featureHasData.get(r);if(!i)return;let n=this._dataHasClass.get(i)??new Set;e.selected=n.has("selected"),e.hovered=n.has("hovered"),e.drawing=n.has("drawing"),e.active=n.has("drawing")}isDrawing(e){return this._dataHasClass.get(e)?.has("drawing")}isHovered(e){return this._dataHasClass.get(e)?.has("hovered")}bindData(e,r){this.unbindData(e);let i=this._dataHasFeature.get(r);i||(i=new Set,this._dataHasFeature.set(r,i)),i.add(e),this._featureHasData.set(e,r)}unbindData(e){let r=this._featureHasData.get(e);if(!r)return;let i=this._dataHasFeature.get(r);i&&(i.delete(e),i.size||(this._dataHasFeature.delete(r),this._parentHasChildren.delete(r),this._childHasParents.delete(r))),this._featureHasData.delete(e)}addChildData(e,r){let i=this._parentHasChildren.get(e);i||(i=new Set,this._parentHasChildren.set(e,i)),i.add(r);let n=this._childHasParents.get(r);n||(n=new Set,this._childHasParents.set(r,n)),n.add(e)}removeChildData(e,r){let i=this._parentHasChildren.get(e);i&&(i.delete(r),i.size||this._parentHasChildren.delete(r));let n=this._childHasParents.get(r);n&&(n.delete(r),n.size||this._childHasParents.delete(r))}clearChildData(e){let r=this._parentHasChildren.get(e)??new Set;for(let i of r)this.removeChildData(e,i)}getSelfAndDescendants(e,r){r instanceof Set?r.add(e):r=new Set([e]);let i=this._parentHasChildren.get(e)??new Set;for(let n of i)r.has(n)||this.getSelfAndDescendants(n,r);return r}getSelfAndAncestors(e,r){r instanceof Set?r.add(e):r=new Set([e]);let i=this._childHasParents.get(e)??new Set;for(let n of i)r.has(n)||this.getSelfAndAncestors(n,r);return r}getSelfAndSiblings(e,r){r instanceof Set?r.add(e):r=new Set([e]);let i=this._childHasParents.get(e)??new Set;for(let n of i){let s=this._parentHasChildren.get(n)??new Set;for(let o of s)r.add(o)}return r}classData(e,r){let i=this._dataHasClass.get(e);i||(i=new Set,this._dataHasClass.set(e,i)),i.add(r);let n=this._classHasData.get(r);n||(n=new Set,this._classHasData.set(r,n)),n.add(e)}unclassData(e,r){let i=this._dataHasClass.get(e);i&&(i.delete(r),i.size||this._dataHasClass.delete(e));let n=this._classHasData.get(r);n&&(n.delete(e),n.size||this._classHasData.delete(r))}clearClass(e){let r=this._classHasData.get(e)??new Set;for(let i of r)this.unclassData(i,e)}dirtyLayer(){for(let e of this.features.values())e.dirty=!0}dirtyFeatures(e){for(let r of NC(e)){let i=this.features.get(r);i&&(i.dirty=!0)}}dirtyData(e){for(let r of NC(e)){let i=this._dataHasFeature.get(r);i&&this.dirtyFeatures(i)}}get id(){return this.layerID}get supported(){return!0}get enabled(){return this._enabled}set enabled(e){e!==this._enabled&&(this._enabled=e,this.dirtyLayer())}};var DC=16776960,AG=[0,-.0125,0,-.0125,.5,-.0125,0,-.0125,0],Ku=class extends Bt{constructor(e,r,i){super(e,r),this.enabled=!0,this.isMinimap=i;let n=this.scene.groups.get("background");n.eventMode="none",this.filters={brightness:1,contrast:1,saturation:1,sharpness:1},this._atlasAllocator=new xu,this._tileMaps=new Map,this._failed=new Set,this._tiler=new Pr}render(e,r){let i=this.context.imagery(),n=this.scene.groups.get("background"),s=new Map,o=new Set,a=i.baseLayerSource();a&&a.id!=="none"&&(s.set(a,-1),o.add(a.id)),i.overlayLayerSources().forEach((c,u)=>{c.id==="mapbox_locator_overlay"&&(u=999),s.set(c,u),o.add(c.id)}),s.forEach((c,u)=>{if(!u||u.id==="none")return;let d=this._tileMaps.get(u.id);d||(d=new Map,this._tileMaps.set(u.id,d));let h=this.getSourceContainer(u.id);h.zIndex=c,!this.isMinimap&&c===-1&&this.applyFilters(h);let p=window.performance.now();this.renderTileSource(p,r,u,h,d)});let l=[];n.children.forEach(c=>{let u=c.name;o.has(u)||l.push(c)}),l.forEach(c=>{let u=c.name,d=this._tileMaps.get(u);d.forEach(h=>{this.destroyTile(h),d.delete(h.id)}),this._tileMaps.delete(u),c.destroy({children:!0})})}applyFilters(e){let r=new r6({brightness:this.filters.brightness,contrast:this.filters.contrast,saturation:this.filters.saturation});if(e.filters=[r],this.filters.sharpness>1){let i=AG.map((n,s)=>{if(s===4){let o=Hr(1,2)(this.filters.sharpness);return n*o}else return n});this.convolutionFilter=new D6(i),e.filters.push(this.convolutionFilter)}else if(this.filters.sharpness<1){let i=Hr(1,8)(1-this.filters.sharpness);this.blurFilter=new d3.BlurFilter(i,4),e.filters.push(this.blurFilter)}}renderTileSource(e,r,i,n,s){let o=this.context,a=this.renderer.pixi,l=o.connection(),c=!1,u;this.isMinimap||(c=o.getDebug("tile"),u=this.scene.layers.get("map-ui").container.getChildByName("tile-debug"),u.visible=c);let d=i.tileSize||256,h=r.scale(),p=xn(h,d),m=Yi(i.offset,Math.pow(2,p));n.position.set(m[0],m[1]);let g=new Map,y=Math.round(p),v=Math.max(0,y-5);i.overzoom||(y=v=Math.floor(p));let x=!1;for(let _=y;!x&&_>=v;_--){if(!i.validZoom(_))continue;let b=this._tiler.skipNullIsland(!!i.overlay).zoomRange(_).getTiles(this.isMinimap?r:o.projection),w=!1;for(let E=0;E<b.tiles.length;E++){let A=b.tiles[E];if(_>=10&&l&&i.id==="mapbox_locator_overlay"){let T=A.wgs84Extent.center();if(l.isDataLoaded(T))continue}A.url=i.url(A.xyz),!A.url||this._failed.has(A.url)?w=!0:g.set(A.id,A)}x=!w}g.forEach(_=>{if(s.has(_.id))return;let b=`${i.id}-${_.id}`,w=new ir;w.name=b,w.anchor.set(0,1),w.zIndex=_.xyz[2],n.addChild(w),_.sprite=w,s.set(_.id,_);let E=new Image;E.crossOrigin="anonymous",E.src=_.url,_.image=E,E.onload=()=>{if(this._failed.delete(_.url),!_.sprite||!_.image)return;_.loaded=!0;let A=_.image.naturalWidth,T=_.image.naturalHeight,k=_.image;if(a.renderer.context.webGLVersion===1){let N=document.createElement("canvas");N.width=A,N.height=T;let M=N.getContext("2d");M.drawImage(E,0,0),k=M.getImageData(0,0,A,T)}let C=0,I=this._atlasAllocator.allocate(A,T,C,k),P=I.frame.clone().pad(-.5);I.frame=P,w.texture=I,_.image=null,o.map().deferredRedraw()},E.onerror=()=>{_.image=null,this._failed.add(_.url),o.map().deferredRedraw()}}),s.forEach(_=>{let b=!1;if(g.has(_.id)?(b=!0,_.timestamp=e):i.overlay||(b=e-_.timestamp<3e3),b){let[w,E]=r.project(_.wgs84Extent.min);_.sprite.position.set(w,E);let A=d*Math.pow(2,p-_.xyz[2]);if(_.sprite.width=A,_.sprite.height=A,c&&u&&!i.overlay){if(!_.debug){_.debug=new it,_.debug.name=`debug-${_.id}`,_.debug.eventMode="none",_.debug.sortableChildren=!1,u.addChild(_.debug);let T=new lu(_.id,{fontName:"debug"});T.name=`label-${_.id}`,T.tint=DC,T.position.set(2,2),_.debug.addChild(T)}_.debug.position.set(w,E-A),_.debug.clear().lineStyle(2,DC).drawRect(0,0,A,A)}}else this.destroyTile(_),s.delete(_.id)})}destroyTile(e){e.sprite&&(e.sprite.texture&&e.sprite.texture!==be.EMPTY&&this._atlasAllocator.free(e.sprite.texture),e.sprite.destroy({children:!0,texture:!0,baseTexture:!1}),e.sprite=null,e.image=null),e.debug&&(e.debug.destroy({children:!0}),e.debug=null)}getSourceContainer(e){let r=this.scene.groups.get("background"),i=r.getChildByName(e);return i||(i=new st,i.name=e,i.eventMode="none",i.sortableChildren=!0,r.addChild(i)),i}setBrightness(e){this.filters.brightness=e}setContrast(e){this.filters.contrast=e}setSaturation(e){this.filters.saturation=e}setSharpness(e){this.filters.sharpness=e}};var CG={dash:[10,5],width:1,color:16777215,alpha:1,scale:1,useTexture:!1,alignment:.5},Al=class{constructor(t,e={}){this.cursor=new Ne,this.scale=1,this.graphics=t,e={...CG,...e},this.dash=e.dash,this.dashSize=this.dash.reduce((r,i)=>r+i),this.useTexture=e.useTexture,this.options=e,this.setLineStyle()}setLineStyle(){let t=this.options;if(this.useTexture){let e=Al.getTexture(t,this.dashSize);this.graphics.lineTextureStyle({width:t.width*t.scale,color:t.color,alpha:t.alpha,texture:e,alignment:t.alignment}),this.activeTexture=e}else this.graphics.lineStyle({width:t.width*t.scale,color:t.color,alpha:t.alpha,cap:t.cap,join:t.join,alignment:t.alignment});this.scale=t.scale}static distance(t,e,r,i){return Math.sqrt(Math.pow(r-t,2)+Math.pow(i-e,2))}moveTo(t,e){return this.lineLength=0,this.cursor.set(t,e),this.start=new Ne(t,e),this.graphics.moveTo(this.cursor.x,this.cursor.y),this}lineTo(t,e,r){typeof this.lineLength===void 0&&this.moveTo(0,0);let[i,n]=[this.cursor.x,this.cursor.y],s=Al.distance(i,n,t,e);if(s<1)return this;let o=Math.atan2(e-n,t-i),a=Math.cos(o),l=Math.sin(o),c=r&&t===this.start.x&&e===this.start.y;if(this.useTexture)if(this.graphics.moveTo(i,n),this.adjustLineStyle(o),c&&this.dash.length%2===0){let u=Math.min(this.dash[this.dash.length-1],s);this.graphics.lineTo(t-a*u,e-l*u),this.graphics.closePath()}else this.graphics.lineTo(t,e);else{this.setLineStyle();let u=this.lineLength%(this.dashSize*this.scale),d=0,h=0,p=0;for(let g=0;g<this.dash.length;g++){let y=this.dash[g]*this.scale;if(u<p+y){d=g,h=u-p;break}else p+=y}let m=s;for(;m>1;){let g=this.dash[d]*this.scale-h,y=m>g?g:m;if(c&&Al.distance(i+a*y,n+l*y,this.start.x,this.start.y)<=y){if(d%2===0){let x=Al.distance(i,n,this.start.x,this.start.y)-this.dash[this.dash.length-1]*this.scale;i+=a*x,n+=l*x,this.graphics.lineTo(i,n),this.lineLength+=x,this.cursor.set(i,n)}break}i+=a*y,n+=l*y,d%2?this.graphics.moveTo(i,n):this.graphics.lineTo(i,n),this.lineLength+=y,this.cursor.set(i,n),m-=y,d++,d=d===this.dash.length?0:d,h=0}}return this}closePath(){this.lineTo(this.start.x,this.start.y,!0)}drawCircle(t,e,r,i=80,n){let s=Math.PI*2/i,o=0,a=new Ne(t+Math.cos(o)*r,e+Math.sin(o)*r);n?(n.apply(a,a),this.moveTo(a[0],a[1])):this.moveTo(a.x,a.y),o+=s;for(let l=1;l<i+1;l++){let c=l===i?[a.x,a.y]:[t+Math.cos(o)*r,e+Math.sin(o)*r];this.lineTo(c[0],c[1]),o+=s}return this}drawEllipse(t,e,r,i,n=80,s){let o=Math.PI*2/n,a,l=new Ne,c=0;for(let u=0;u<Math.PI*2;u+=o){let d=t-r*Math.sin(u),h=e-i*Math.cos(u);s&&(l.set(d,h),s.apply(l,l),d=l.x,h=l.y),u===0?(this.moveTo(d,h),a={x:d,y:h}):this.lineTo(d,h)}return this.lineTo(a.x,a.y,!0),this}drawPolygon(t,e){let r=new Ne;if(typeof t[0]=="number")if(e){r.set(t[0],t[1]),e.apply(r,r),this.moveTo(r.x,r.y);for(let i=2;i<t.length;i+=2)r.set(t[i],t[i+1]),e.apply(r,r),this.lineTo(r.x,r.y,i===t.length-2)}else{this.moveTo(t[0],t[1]);for(let i=2;i<t.length;i+=2)this.lineTo(t[i],t[i+1],i===t.length-2)}else if(e){let i=t[0];r.copyFrom(i),e.apply(r,r),this.moveTo(r.x,r.y);for(let n=1;n<t.length;n++){let s=t[n];r.copyFrom(s),e.apply(r,r),this.lineTo(r.x,r.y,n===t.length-1)}}else{let i=t[0];this.moveTo(i.x,i.y);for(let n=1;n<t.length;n++){let s=t[n];this.lineTo(s.x,s.y,n===t.length-1)}}return this}drawRect(t,e,r,i,n){if(n){let s=new Ne;s.set(t,e),n.apply(s,s),this.moveTo(s.x,s.y),s.set(t+r,e),n.apply(s,s),this.lineTo(s.x,s.y),s.set(t+r,e+i),n.apply(s,s),this.lineTo(s.x,s.y),s.set(t,e+i),n.apply(s,s),this.lineTo(s.x,s.y),s.set(t,e),n.apply(s,s),this.lineTo(s.x,s.y,!0)}else this.moveTo(t,e).lineTo(t+r,e).lineTo(t+r,e+i).lineTo(t,e+i).lineTo(t,e,!0);return this}adjustLineStyle(t){let e=this.graphics.line;e.matrix=new gt,t&&e.matrix.rotate(t),this.scale!==1&&e.matrix.scale(this.scale,this.scale);let r=-this.lineLength;e.matrix.translate(this.cursor.x+r*Math.cos(t),this.cursor.y+r*Math.sin(t)),this.graphics.lineStyle(e)}static getTexture(t,e){let r=t.dash.toString();if(Al.dashTextureCache[r])return Al.dashTextureCache[r];let i=document.createElement("canvas");i.width=e,i.height=Math.ceil(t.width);let n=i.getContext("2d");if(!n)return console.warn("Did not get context from canvas"),null;n.strokeStyle="white",n.globalAlpha=t.alpha,n.lineWidth=t.width;let s=0,o=t.width/2;n.moveTo(s,o);for(let l=0;l<t.dash.length;l+=2)s+=t.dash[l],n.lineTo(s,o),t.dash.length!==l+1&&(s+=t.dash[l+1],n.moveTo(s,o));n.stroke();let a=Al.dashTextureCache[r]=be.from(i);return a.baseTexture.scaleMode=ki.NEAREST,a}},ro=Al;ro.dashTextureCache={};var BC=dt(LC(),1),L6=class{constructor(){this.type=null,this.dirty=!0,this.reset()}destroy(){this.reset()}reset(){this.origCoords=null,this.origExtent=null,this.origHull=null,this.origCentroid=null,this.origPoi=null,this.origSsr=null,this.coords=null,this.extent=null,this.hull=null,this.centroid=null,this.poi=null,this.ssr=null,this.outer=null,this.flatOuter=null,this.holes=null,this.flatHoles=null,this.width=0,this.height=0,this.lod=0}update(e){if(!this.dirty||!this.origCoords||!this.origExtent)return;if(this.dirty=!1,this.coords=null,this.extent=null,this.outer=null,this.flatOuter=null,this.holes=null,this.flatHoles=null,this.hull=null,this.centroid=null,this.poi=null,this.ssr=null,this.type==="point"){this.coords=e.project(this.origCoords),this.extent=new le(this.coords),this.centroid=this.coords,this.width=0,this.height=0,this.lod=2;return}this.extent=new le,this.extent.min=e.project([this.origExtent.min[0],this.origExtent.max[1]]),this.extent.max=e.project([this.origExtent.max[0],this.origExtent.min[1]]);let[r,i]=this.extent.min,[n,s]=this.extent.max;if(this.width=n-r,this.height=s-i,this.width<4&&this.height<4){this.lod=0;return}let o=this.type==="line"?[this.origCoords]:this.origCoords,a=new Array(o.length),l=new Array(o.length);for(let c=0;c<o.length;++c){let u=o[c];a[c]=new Array(u.length),l[c]=new Array(u.length*2);for(let d=0;d<u.length;++d){let h=e.project(u[d]);a[c][d]=h,l[c][d*2]=h[0],l[c][d*2+1]=h[1]}}if(this.type==="line"?(this.coords=a[0],this.outer=a[0],this.flatOuter=l[0],this.holes=null,this.flatHoles=null):(this.coords=a,this.outer=a[0],this.flatOuter=l[0],this.holes=a.slice(1),this.flatHoles=l.slice(1)),this.outer.length!==0)if(this.outer.length===1)this.centroid=this.outer[0],this.origCentroid=e.invert(this.centroid),this.poi=this.centroid,this.origPoi=this.origCentroid;else if(this.outer.length===2)this.centroid=Ct(this.outer[0],this.outer[1],.5),this.origCentroid=e.invert(this.centroid),this.poi=this.centroid,this.origPoi=this.origCentroid;else{if(this.origHull){this.hull=new Array(this.origHull.length);for(let c=0;c<this.origHull.length;++c)this.hull[c]=e.project(this.origHull[c])}else if(this.hull=Ds(this.outer),this.hull){this.origHull=new Array(this.hull.length);for(let c=0;c<this.origHull.length;++c)this.origHull[c]=e.invert(this.hull[c])}if(this.origCentroid?this.centroid=e.project(this.origCentroid):this.hull&&(this.hull.length===2?this.centroid=Ct(this.hull[0],this.hull[1],.5):this.centroid=yn(this.hull),this.origCentroid=e.invert(this.centroid)),this.origPoi?this.poi=e.project(this.origPoi):(this.poi=(0,BC.default)(this.coords),this.origPoi=e.invert(this.poi)),this.origSsr){this.ssr={angle:this.origSsr.angle,poly:new Array(this.origSsr.poly.length)};for(let c=0;c<this.origSsr.poly.length;++c)this.ssr.poly[c]=e.project(this.origSsr.poly[c])}else if(this.hull&&(this.ssr=Rc(this.hull),this.ssr)){this.origSsr={angle:this.ssr.angle,poly:new Array(this.ssr.poly.length)};for(let c=0;c<this.ssr.poly.length;++c)this.origSsr.poly[c]=e.invert(this.ssr.poly[c])}}this.lod=2}setCoords(e){let r=this._inferType(e);if(!r)return;this.reset(),this.type=r,this.origCoords=e,this.origExtent=new le;let i=this.origExtent;if(r==="point")i.min=e,i.max=e,this.origCentroid=e;else{let n=this.type==="line"?[this.origCoords]:this.origCoords;for(let s=0;s<n.length;++s){let o=n[s];for(let a=0;a<o.length;++a){let[l,c]=o[a];i.min=[Math.min(i.min[0],l),Math.min(i.min[1],c)],i.max=[Math.max(i.max[0],l),Math.max(i.max[1],c)]}}}this.dirty=!0}_inferType(e){let r=Array.isArray(e)&&e[0];if(typeof r=="number")return"point";let i=Array.isArray(r)&&r[0];return typeof i=="number"?"line":typeof(Array.isArray(i)&&i[0])=="number"?"polygon":null}};var kl=class{constructor(e,r){this.type="unknown",this.layer=e,this.scene=e.scene,this.renderer=e.renderer,this.context=e.context,this.featureID=r;let i=new st;this.container=i,i.__feature__=this,i.name=r,i.sortableChildren=!1,i.visible=!0,this._allowInteraction=!0,this._active=!1,i.eventMode="static",this.v=-1,this.lod=2,this.halo=null,this.geometry=new L6,this._style=null,this._styleDirty=!0,this._label=null,this._labelDirty=!0,this._data=null,this._selected=!1,this._hovered=!1,this._drawing=!1,this.sceneBounds=new Re,this.layer.addFeature(this),this.scene.addFeature(this)}destroy(){this.layer.removeFeature(this),this.scene.removeFeature(this),this.container.filters=null,this.container.__feature__=null,this.container.destroy({children:!0}),this.container=null,this.layer=null,this.scene=null,this.renderer=null,this.context=null,this.halo&&(this.halo.destroy({children:!0}),this.halo=null),this.geometry.destroy(),this.geometry=null,this._style=null,this._label=null,this._data=null,this.sceneBounds=null}update(e,r){this.dirty&&(this.geometry.update(e,r),this._styleDirty=!1)}updateHalo(){}get id(){return this.featureID}get parentContainer(){return this.container.parent}set parentContainer(e){let r=this.container.parent;e&&e!==r?this.container.setParent(e):!e&&r&&r.removeChild(this.container)}get visible(){return this.container.visible}set visible(e){e!==this.container.visible&&(this.container.visible=e,this.updateHalo(),this._labelDirty=!0)}get allowInteraction(){return this._allowInteraction}set allowInteraction(e){e!==this._allowInteraction&&(this._allowInteraction=e,this.container&&(this.container.eventMode=this._allowInteraction&&!this._active?"static":"none"))}get active(){return this._active}set active(e){e!==this._active&&(this._active=e,this.container&&(this.container.eventMode=this._allowInteraction&&!this._active?"static":"none"))}get dirty(){return this.geometry.dirty||this._styleDirty}set dirty(e){this.geometry.dirty=e,this._styleDirty=e,this._labelDirty=e}get hovered(){return this._hovered}set hovered(e){e!==this._hovered&&(this._hovered=e,this._styleDirty=!0)}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._styleDirty=!0,this._labelDirty=!0)}get drawing(){return this._drawing}set drawing(e){e!==this._drawing&&(this._drawing=e,this._styleDirty=!0)}get style(){return this._style}set style(e){this._style=e,this._styleDirty=!0}get label(){return this._label}set label(e){e!==this._label&&(this._label=e,this._labelDirty=!0)}get data(){return this._data}setData(e,r){this._data=r,this.dataID=e,this.layer.bindData(this.id,e),this.dirty=!0}addChildData(e,r){this.layer.addChildData(e,r),this.dirty=!0}clearChildData(e){this.layer.clearChildData(e),this.dirty=!0}};function UC(t,e){let r=/^maki-/.test(e),i=/^temaki-/.test(e),n,s;return r?(n=t._makiSheet,s="maki/"+e.slice(5)):i?(n=t._temakiSheet,s=e.slice(7)):(n=t._fontAwesomeSheet,s=e),s=s+".svg",n.textures[s]}function Zu(t,e={}){let i=[t[0],t[1]],n=[t[t.length-2],t[t.length-1]],s=pt(i,n,1e-4),o=new Ei(t);e.native=!1,o.closeStroke=!1;let a={shape:o,lineStyle:e},l={closePointEps:1e-4,indices:[],points:[],uvs:[]};$T.buildLine(a,l);let c=l.points,u=l.indices,d=new Map,h=[],p=[],m,g,y=0,v=0,x,_,b,w,E,A;for(let P=0;P<u.length;P+=3){let N=u[P],M=u[P+1],D=u[P+2],F=[c[N*2],c[N*2+1]],L=[c[M*2],c[M*2+1]],B=[c[D*2],c[D*2+1]];if(P===0)d.set(N,!0),d.set(M,!1),d.set(D,!0),h.push(F),p.push(L),h.push(B),g=L,m=B,y=ut(F,B);else{let O=d.get(N),R=d.get(M),U=d.get(D);O===void 0&&pt(F,x,1e-4)&&(O=d.get(w),d.set(N,O)),R===void 0&&pt(L,_,1e-4)&&(R=d.get(E),d.set(M,R)),U===void 0&&pt(B,b,1e-4)&&(U=d.get(A),d.set(D,U));let G,$,q;O===void 0&&(G=N,$=F,q=!U),R===void 0&&(G=M,$=L,q=!O),U===void 0&&(G=D,$=B,q=!R),G!==void 0&&(d.set(G,q),q===!0?(h.push($),y+=ut(m,$),m=$):(p.push($),v+=ut(g,$),g=$))}x=F,_=L,b=B,w=N,E=M,A=D}let T={},k=h.length+p.length+1,C=new Array(k*2),I=0;for(let P=0;P<h.length;++I,++P)C[I*2]=h[P][0],C[I*2+1]=h[P][1];p.reverse();for(let P=0;P<p.length;++I,++P)C[I*2]=p[P][0],C[I*2+1]=p[P][1];if(C[C.length-2]=C[0],C[C.length-1]=C[1],T.perimeter=C,s){let P=new Array((h.length+1)*2);for(let M=0;M<h.length;++M)P[M*2]=h[M][0],P[M*2+1]=h[M][1];P[P.length-2]=h[0][0],P[P.length-1]=h[0][1];let N=new Array((p.length+1)*2);for(let M=0;M<p.length;++M)N[M*2]=p[M][0],N[M*2+1]=p[M][1];N[N.length-2]=p[0][0],N[N.length-1]=p[0][1],y>v?(T.outer=P,T.inner=N):(T.outer=N,T.inner=P)}return T}function l5(t,e,r=!1,i=!1){let s=e,o,a=[];for(let l=0;l<t.length;l++){let c=t[l];if(o){let u=ut(o,c)-s;if(u>=0){let d=vr(o,c),h=e*Math.cos(d),p=e*Math.sin(d),m=0,g=0;r&&(m=7*Math.cos(d+Math.PI/2),g=7*Math.sin(d+Math.PI/2));let y=[o[0]+s*Math.cos(d)+m,o[1]+s*Math.sin(d)+g],v=[o,y];for(i&&u>=e*100&&(e=Math.floor(u/100)),u-=e;u>=0;u-=e)y=Ot(y,[h,p]),v.push(y);v.push(c),a.push({coords:v.slice(1,-1),angle:d+(r?Math.PI/2:0)})}s=-u}o=c}return a}var B6=32,Mo=class extends kl{constructor(e,r){super(e,r),this.type="polygon",this._ssrdata=null;let i=new ir;i.name="lowRes",i.anchor.set(.5,.5),i.visible=!1,i.eventMode="static",this.lowRes=i;let n=new it;n.name="fill",n.eventMode="static",n.sortableChildren=!1,this.fill=n;let s=new it;s.name="stroke",s.eventMode="none",s.sortableChildren=!1,this.stroke=s;let o=new qs(null,new bs(be.WHITE));o.name="mask",o.eventMode="static",o.visible=!1,this.mask=o,this.container.addChild(i,n,s,o)}destroy(){super.destroy(),this.lowRes=null,this.fill=null,this.mask=null,this._ssrdata&&(delete this._ssrdata.ssr,delete this._ssrdata.origSsr,delete this._ssrdata.origAxis1,delete this._ssrdata.origAxis2,delete this._ssrdata.origCenter,delete this._ssrdata.shapeType,this._ssrdata=null)}update(e,r){if(!this.dirty)return;let i=this.context.map().wireframeMode;if(this.geometry.dirty&&(this.geometry.update(e,r),this._ssrdata=null,this.geometry.ssr?.poly)){let b=this.geometry.ssr.poly,w=[(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2],E=[(b[2][0]+b[3][0])/2,(b[2][1]+b[3][1])/2],A=[(b[3][0]+b[0][0])/2,(b[3][1]+b[0][1])/2],T=[(b[1][0]+b[2][0])/2,(b[1][1]+b[2][1])/2],k=[w,E],C=[A,T],I=[(w[0]+E[0])/2,(w[1]+E[1])/2],P=.1,N,M,D,F;this.geometry.outer.forEach(B=>{N||(N=pt(B,b[0],P)),M||(M=pt(B,b[1],P)),D||(D=pt(B,b[2],P)),F||(F=pt(B,b[3],P))});let L=N||M||D||F;this._ssrdata={ssr:this.geometry.ssr,origSsr:this.geometry.origSsr,origAxis1:k.map(B=>e.invert(B)),origAxis2:C.map(B=>e.invert(B)),origCenter:e.invert(I),shapeType:L?"square":"circle"}}let[n,s]=this.geometry.extent.min,[o,a]=this.geometry.extent.max,[l,c]=[o-n,a-s];this.sceneBounds.x=n,this.sceneBounds.y=s,this.sceneBounds.width=l,this.sceneBounds.height=c;let u=this._style,d=this.context.pixi.rapidTextures,h=u.fill.color||11184810,p=u.fill.alpha||.3,m=u.fill.pattern,g=m&&d.get(m)||be.WHITE,y,v=ee("area-fill")||"partial",x=!u.requireFill&&v==="partial",_=2*B6+5;if((l<_||c<_)&&(x=!1),(l<B6||c<B6)&&(g=be.WHITE),l<4&&c<4)this.lod=0,this.visible=!1,this.fill.visible=!1,this.stroke.visible=!1,this.mask.visible=!1,this.lowRes.visible=!1;else if(this._ssrdata&&l<20&&c<20){this.lod=1,this.visible=!0;let b=this._ssrdata;this.fill.visible=!1,this.stroke.visible=!1,this.mask.visible=!1,this.lowRes.visible=!0;let E=`lowres${i?"-unfilled":""}-${b.shapeType}`,[A,T]=e.project(b.origCenter),k=b.ssr.angle,C=b.origAxis1.map(M=>e.project(M)),I=b.origAxis2.map(M=>e.project(M)),P=ut(C[0],C[1]),N=ut(I[0],I[1]);this.lowRes.texture=d.get(E)||be.WHITE,this.lowRes.position.set(A,T),this.lowRes.scale.set(P/10,N/10),this.lowRes.rotation=k,this.lowRes.tint=h}else this.lod=2,this.visible=!0,this.fill.visible=!0,this.stroke.visible=!0,this.lowRes.visible=!1,y={outer:new Ei(this.geometry.flatOuter),holes:(this.geometry.flatHoles||[]).map(b=>new Ei(b))};if(y&&this.stroke.visible&&(this.stroke.clear().lineStyle({alpha:1,width:i?1:u.fill.width||2,color:h}).drawShape(y.outer),y.holes.forEach(b=>this.stroke.drawShape(b))),i&&(this.fill.visible=!1,this.fill.clear()),y&&this.fill.visible)if(this.fill.clear().beginTextureFill({alpha:p,color:h,texture:g}).drawShape(y.outer),y.holes.length&&(this.fill.beginHole(),y.holes.forEach(b=>this.fill.drawShape(b)),this.fill.endHole()),this.fill.endFill(),x){let b=new it().clear().lineTextureStyle({alpha:1,alignment:0,color:0,cap:tt.BUTT,join:Yt.BEVEL,width:B6,texture:be.WHITE});b.drawShape(y.outer),y.holes.length&&y.holes.forEach(w=>b.drawShape(w)),b.geometry.updateBatches(!0),this.mask.geometry=new wi().addAttribute("aVertexPosition",b.geometry.points,2).addAttribute("aTextureCoord",b.geometry.uvs,2).addIndex(b.geometry.indices),this.mask.visible=!0,this.fill.mask=this.mask}else this.mask.visible=!1,this.fill.mask=null;this._styleDirty=!1,this.updateHalo()}updateHalo(){if(!this.geometry.flatOuter)return;let e=this.visible&&this.hovered,r=this.visible&&this.selected;if(e){if(!this.container.filters){let i=new j1({distance:15,outerStrength:3,color:16776960});i.resolution=2,this.container.filters=[i]}}else this.container.filters&&(this.container.filters=null);if(r){this.halo||(this.halo=new it,this.halo.name=`${this.id}-halo`,this.scene.layers.get("map-ui").container.addChild(this.halo));let i={alpha:.9,dash:[6,3],width:2,color:16776960},n={alignment:.5,color:0,width:16,alpha:1,join:Yt.BEVEL,cap:tt.BUTT},s=Zu(this.geometry.flatOuter,n);this.halo.clear();let o=new ro(this.halo,i);s?.outer&&o.drawPolygon(s.outer)}else this.halo&&(this.halo.destroy({children:!0}),this.halo=null)}get style(){return this._style}set style(e){this._style=Object.assign({},DG,e),this._styleDirty=!0}},DG={requireFill:!1,lineMarkerName:"",lineMarkerTint:0,labelTint:15658734,fill:{width:2,color:11184810,alpha:.3},casing:{width:5,color:4473924,alpha:1,cap:tt.ROUND,join:Yt.ROUND},stroke:{width:3,color:13421772,alpha:1,cap:tt.ROUND,join:Yt.ROUND}};var FG=4,U6=class extends Bt{constructor(e,r){super(e,r),this._enabled=!0,this._oldk=0}get enabled(){return this._enabled}set enabled(e){}render(e,r,i){let n;if(i>=FG){let a=this.context.map().extent().rectangle();n=wt.wpblocks().bbox(a),this.renderEditBlocks(e,r,i,n)}else n=[];let s=this.context.container().select(".main-content > .map-footer").selectAll(".api-status.blocks").data(n,a=>a.id);s.exit().remove();let o=s.enter().insert("div",".api-status").attr("class","api-status blocks error");o.append("span").attr("class","explanation-item").text(a=>a.text),o.append("a").attr("target","_blank").attr("href",a=>a.url).text("More Info")}renderEditBlocks(e,r,i,n){let s=this.scene.groups.get("blocks"),o={requireFill:!0,fill:{pattern:"construction",color:1,alpha:.7}};for(let a of n){let l=wt.feature(a.locationSetID).geometry;if(!l)continue;let c=l.type==="Polygon"?[l.coordinates]:l.type==="MultiPolygon"?l.coordinates:[];for(let u=0;u<c.length;++u){let d=c[u],h=`${this.layerID}-${a.locationSetID}-${u}`,p=this.features.get(h);p||(p=new Mo(this,h),p.geometry.setCoords(d),p.style=o,p.parentContainer=s,p.container.cursor="not-allowed",p.setData(a.locationSetID,a)),this.syncFeatureClasses(p),p.update(r,i),this.retainFeature(p,e)}}}};var sr=class extends kl{constructor(e,r){super(e,r),this.type="point",this._oldvfLength=0,this._isCircular=!1;let i=new st;i.name="viewfields",i.eventMode="none",i.sortableChildren=!1,i.visible=!1,this.viewfields=i;let n=new ir;n.name="marker",n.eventMode="none",n.sortableChildren=!1,n.visible=!0,this.marker=n;let s=new ir;s.name="icon",s.eventMode="none",s.sortableChildren=!1,s.visible=!1,this.icon=s,this.container.addChild(i,n,s)}destroy(){super.destroy(),this.viewfields=null,this.marker=null,this.icon=null}update(e,r){if(!this.dirty)return;this.updateGeometry(e,r),this.updateStyle(r);let i=this.container.position;this.sceneBounds=this.container.getLocalBounds().clone(),this.sceneBounds.x+=i.x,this.sceneBounds.y+=i.y,this.updateHitArea(),this.updateHalo()}updateGeometry(e,r){if(!this.geometry.dirty)return;this.geometry.update(e,r);let[i,n]=this.geometry.coords;this.container.position.set(i,n);let s=-this.geometry.origCoords[1];this.container.zIndex=this._oldvfLength>0?s+1e3:s}updateStyle(e){if(!this._styleDirty)return;let r=this.context,i=r.map().wireframeMode,n=r.pixi.rapidTextures,s=this._style,o=["pin","boldPin","improveosm","osmose"].includes(s.markerName),a=this.viewfields,l=this.marker,c=this.icon,u=this.geometry.origCoords[1];l.texture=s.markerTexture||n.get(s.markerName)||be.WHITE,l.tint=s.markerTint;let d=s.viewfieldAngles||[];if(d.length){let h=s.viewfieldTexture||n.get(s.viewfieldName)||be.WHITE;this.container.zIndex=-u+1e3,d.length!==this._oldvfLength&&(a.removeChildren(),d.forEach(()=>{let p=new ir(h);p.eventMode="none",p.anchor.set(.5,.5),a.addChild(p)}),this._oldvfLength=d.length),d.forEach((p,m)=>{let g=a.getChildAt(m);g.tint=s.viewfieldTint||3355443,g.angle=p}),a.visible=!0}else this.container.zIndex=-u,a.removeChildren(),a.visible=!1;if(s.iconTexture||s.iconName){c.texture=s.iconTexture||UC(r,s.iconName)||be.WHITE;let h=11;c.anchor.set(.5,.5),c.width=h,c.height=h,c.alpha=s.iconAlpha,c.visible=!0}else c.visible=!1;if(e<16)this.lod=0,this.visible=!1;else if(e<17||i){this.lod=1,this.visible=!0,a.renderable=!1,l.renderable=!0,l.scale.set(.8,.8);let h=o?"largeCircle":s.markerName;this._isCircular=!s.markerTexture&&/(circle|midpoint)$/i.test(h),l.texture=s.markerTexture||n.get(h)||be.WHITE,l.anchor.set(.5,.5),c.position.set(0,0)}else{this.lod=2,this.visible=!0,a.renderable=!0,l.renderable=!0,l.scale.set(1,1);let h=o&&d.length?"largeCircle":s.markerName;this._isCircular=!s.markerTexture&&/(circle|midpoint)$/i.test(h),l.texture=s.markerTexture||n.get(h)||be.WHITE,o&&!this._isCircular?(l.anchor.set(.5,1),c.position.set(0,-14)):(l.anchor.set(.5,.5),c.position.set(0,0))}this._styleDirty=!1}updateHitArea(){if(!this.visible)return;if(this._drawing){this.container.hitArea=null;return}let e=20,r=this.marker.getLocalBounds().clone();if(this._isCircular){let i=r.width/2;i<e/2&&(i=e/2),i=i+2;let n=new vo(0,0,i);this.container.hitArea=n}else r.width<e&&r.pad((e-r.width)/2,0),r.height<e&&r.pad(0,(e-r.height)/2),r.pad(4),this.container.hitArea=r}updateHalo(){let e=this.visible&&this.hovered,r=this.visible&&this.selected&&!this.virtual;if(e){if(!this.container.filters){let i=new j1({distance:15,outerStrength:3,color:16776960});i.resolution=2,this.container.filters=[i]}}else this.container.filters&&(this.container.filters=null);if(r){this.halo||(this.halo=new it,this.halo.name=`${this.id}-halo`,this.scene.layers.get("map-ui").container.addChild(this.halo));let i={alpha:.9,dash:[6,3],width:2,color:16776960};this.halo.clear();let n=this.container.hitArea;n instanceof vo?new ro(this.halo,i).drawCircle(n.x,n.y,n.radius,20):n instanceof Re&&new ro(this.halo,i).drawRect(n.x,n.y,n.width,n.height),this.halo.position=this.container.position}else this.halo&&(this.halo.destroy({children:!0}),this.halo=null)}get style(){return this._style}set style(e){this._style=Object.assign({},OG,e),this._styleDirty=!0}},OG={markerName:"smallCircle",markerTint:16777215,viewfieldAngles:[],viewfieldName:"viewfield",viewfieldTint:16777215,iconName:"",iconAlpha:1,labelTint:15658734};var LG=12,G6=class extends Bt{constructor(e,r){super(e,r),this._service=null,this.getService()}getService(){return K.improveOSM&&!this._service?(this._service=K.improveOSM,this._service.on("loaded",()=>this.context.map().deferredRedraw())):!K.improveOSM&&this._service&&(this._service=null),this._service}renderMarkers(e,r,i){let n=this.getService();if(!n)return;let s=this.scene.groups.get("qa"),o=n.getItems(this.context.projection);for(let a of o){let l=`${this.layerID}-${a.id}`,c=this.features.get(l);if(!c){let u={markerName:"improveosm",markerTint:n.getColor(a.itemType),iconName:a.icon};c=new sr(this,l),c.geometry.setCoords(a.loc),c.style=u,c.parentContainer=s,c.setData(a.id,a)}this.syncFeatureClasses(c),c.update(r,i),c._isCircular||c.icon.position.set(0,-17),this.retainFeature(c,e)}}render(e,r,i){let n=this.getService();!this._enabled||!n||i<LG||(n.loadIssues(this.context.projection),this.renderMarkers(e,r,i))}get supported(){return!!this.getService()}};var BG=35,UG=30,Rn=class extends kl{constructor(e,r){super(e,r),this.type="line",this._bufferdata=null;let i=new it;i.name="casing",i.eventMode="none",i.sortableChildren=!1,this.casing=i;let n=new it;n.name="stroke",n.eventMode="none",n.sortableChildren=!1,this.stroke=n,this.container.addChild(i,n)}destroy(){super.destroy(),this.casing=null,this.stroke=null,this._bufferdata&&(delete this._bufferdata.inner,delete this._bufferdata.outer,delete this._bufferdata.perimeter,this._bufferdata=null)}update(e,r){if(!this.dirty)return;let i=this.context.map().wireframeMode,s=this.context.pixi.rapidTextures,o=this.container,a=this._style;if(this.geometry.dirty){this.geometry.update(e,r);let[c,u]=this.geometry.extent.min,[d,h]=this.geometry.extent.max,[p,m]=[d-c,h-u];this.sceneBounds.x=c,this.sceneBounds.y=u,this.sceneBounds.width=p,this.sceneBounds.height=m,this.updateHitArea()}if(this._styleDirty){let{width:c,height:u}=this.sceneBounds,d=!0;c<4&&u<4?(this.lod=0,this.visible=!1,this.stroke.renderable=!1,this.casing.renderable=!1,d=!1):(this.visible=!0,this.stroke.renderable=!0,r<16?(this.lod=1,this.casing.renderable=!1,d=!1):(this.lod=2,this.casing.renderable=!0,d=!0));let h=o.getChildByName("lineMarkers");if(d&&(a.lineMarkerTexture||a.lineMarkerName||a.sidedMarkerTexture||a.sidedMarkerName)){h||(h=new st,h.name="lineMarkers",h.eventMode="none",h.sortableChildren=!1,h.roundPixels=!1,o.addChild(h));let p=a.lineMarkerTexture||s.get(a.lineMarkerName)||be.WHITE,m=a.sidedMarkerTexture||s.get(a.sidedMarkerName)||be.GREEN,g=a.sidedMarkerName==="sided",y=a.lineMarkerName==="oneway";h.removeChildren(),y&&l5(this.geometry.coords,BG,!1,!0).forEach(x=>{x.coords.forEach(([_,b])=>{let w=new ir(p);w.eventMode="none",w.sortableChildren=!1,w.anchor.set(.5,.5),w.position.set(_,b),w.rotation=x.angle,w.tint=a.lineMarkerTint,h.addChild(w)})}),g&&l5(this.geometry.coords,UG,!0,!0).forEach(x=>{x.coords.forEach(([_,b])=>{let w=new ir(m);w.eventMode="none",w.sortableChildren=!1,w.anchor.set(.5,.5),w.position.set(_,b),w.rotation=x.angle,w.tint=a.stroke.color,h.addChild(w)})})}else h&&(o.removeChild(h),h.destroy({children:!0}));this._styleDirty=!1}this.casing.renderable&&l("casing",this.casing,this.geometry.coords,a,i),this.stroke.renderable&&l("stroke",this.stroke,this.geometry.coords,a,i),this.updateHalo();function l(c,u,d,h,p){let m=c==="casing"?3:2,g=h[c].width;r<16?g-=4:r<17&&(g-=2),g<m&&(g=m),p&&(g=1);let y=u.clear();h[c].alpha!==0&&(h[c].dash?y=new ro(y,{dash:h[c].dash,color:h[c].color,width:g,alpha:h[c].alpha||1,join:h[c].join||Yt.ROUND,cap:h[c].cap||tt.ROUND}):y=y.lineStyle({color:h[c].color,width:g,alpha:h[c].alpha||1,join:h[c].join||Yt.ROUND,cap:h[c].cap||tt.ROUND}),d.forEach(([v,x],_)=>{_===0?y.moveTo(v,x):y.lineTo(v,x)}))}}updateHitArea(){if(!this.geometry.flatOuter){this.container.hitArea=null;return}let r={alignment:.5,color:0,width:Math.max(3,this._style.casing.width||0)+10,alpha:1,join:Yt.BEVEL,cap:tt.BUTT};this._bufferdata=Zu(this.geometry.flatOuter,r),this.container.hitArea=new Ei(this._bufferdata.perimeter)}updateHalo(){let e=this.visible&&this.hovered,r=this.visible&&this.selected;if(e){if(!this.container.filters){let i=new j1({distance:15,outerStrength:3,color:16776960});i.resolution=2,this.container.filters=[i]}}else this.container.filters&&(this.container.filters=null);if(r){this.halo||(this.halo=new it,this.halo.name=`${this.id}-halo`,this.scene.layers.get("map-ui").container.addChild(this.halo));let i={alpha:.9,dash:[6,3],width:2,color:16776960};this.halo.clear();let n=new ro(this.halo,i);this._bufferdata&&(this._bufferdata.outer&&this._bufferdata.inner?(n.drawPolygon(this._bufferdata.outer),n.drawPolygon(this._bufferdata.inner)):n.drawPolygon(this._bufferdata.perimeter))}else this.halo&&(this.halo.destroy({children:!0}),this.halo=null)}get style(){return this._style}set style(e){this._style=Object.assign({},GG,e),this._styleDirty=!0}},GG={lineMarkerName:"",lineMarkerTint:0,labelTint:15658734,fill:{width:2,color:11184810,alpha:.3},casing:{width:5,color:4473924,alpha:1,cap:tt.ROUND,join:Yt.ROUND},stroke:{width:3,color:13421772,alpha:1,cap:tt.ROUND,join:Yt.ROUND}};var zG=12,Cy=2147583,HG={casing:{alpha:0},stroke:{alpha:.9,width:4,color:Cy}},$G={markerName:"mediumCircle",markerTint:Cy,viewfieldName:"viewfield",viewfieldTint:Cy},z6=class extends Bt{constructor(e,r){super(e,r),this._service=null,this.getService()}getService(){return K.kartaview&&!this._service?(this._service=K.kartaview,this._service.on("loadedImages",()=>this.context.map().deferredRedraw())):!K.kartaview&&this._service&&(this._service=null),this._service}filterImages(e){let r=this.context.photos().fromDate,i=this.context.photos().toDate,n=this.context.photos().usernames;if(r){let s=new Date(r).getTime();e=e.filter(o=>new Date(o.captured_at).getTime()>=s)}if(i){let s=new Date(i).getTime();e=e.filter(o=>new Date(o.captured_at).getTime()<=s)}return n&&(e=e.filter(s=>n.indexOf(s.captured_by)!==-1)),e}filterSequences(e){let r=this.context.photos().fromDate,i=this.context.photos().toDate,n=this.context.photos().usernames;if(r){let s=new Date(r).getTime();e=e.filter(o=>new Date(o.properties.captured_at).getTime()>=s)}if(i){let s=new Date(i).getTime();e=e.filter(o=>new Date(o.properties.captured_at).getTime()<=s)}return n&&(e=e.filter(s=>n.indexOf(s.properties.captured_by)!==-1)),e}renderMarkers(e,r,i){let n=this.getService();if(!n)return;let s=this.scene.groups.get("streetview"),o=n.images(this.context.projection),a=n.sequences(this.context.projection),l=this.filterSequences(a),c=this.filterImages(o);for(let u of l){let d=`${this.layerID}-sequence-${u.properties.id}`,h=u.properties.v||0,p=this.features.get(d);p||(p=new Rn(this,d),p.style=HG,p.parentContainer=s,p.container.zIndex=-100),p.v!==h&&(p.v=h,p.geometry.setCoords(u.coordinates),p.setData(u.properties.id,u)),this.syncFeatureClasses(p),p.update(r,i),this.retainFeature(p,e)}for(let u of c){let d=`${this.layerID}-photo-${u.id}`,h=this.features.get(d);if(!h){let p=Object.assign({},$G);Number.isFinite(u.ca)&&(p.viewfieldAngles=[u.ca]),u.isPano&&(p.viewfieldName="pano"),h=new sr(this,d),h.geometry.setCoords(u.loc),h.style=p,h.parentContainer=s,h.setData(u.id,u),u.sequenceID&&h.addChildData(u.sequenceID,u.id)}this.syncFeatureClasses(h),h.update(r,i),this.retainFeature(h,e)}}render(e,r,i){let n=this.getService();!this._enabled||!n||i<zG||(n.loadImages(this.context.projection),this.renderMarkers(e,r,i))}get supported(){return!!this.getService()}};var jG=12,H6=class extends Bt{constructor(e,r){super(e,r),this._service=null,this.getService()}getService(){return K.keepRight&&!this._service?(this._service=K.keepRight,this._service.on("loaded",()=>this.context.map().deferredRedraw())):!K.keepRight&&this._service&&(this._service=null),this._service}renderMarkers(e,r,i){let n=this.getService();if(!n)return;let s=this.scene.groups.get("qa"),o=n.getItems(this.context.projection);for(let a of o){let l=`${this.layerID}-${a.id}`,c=this.features.get(l);if(!c){let u={markerName:"keepright",markerTint:n.getColor(a.parentIssueType)};c=new sr(this,l),c.geometry.setCoords(a.loc),c.style=u,c.parentContainer=s,c.setData(a.id,a)}this.syncFeatureClasses(c),c.update(r,i),this.retainFeature(c,e)}}render(e,r,i){let n=this.getService();!this._enabled||!n||i<jG||(n.loadIssues(this.context.projection),this.renderMarkers(e,r,i))}get supported(){return!!this.getService()}};var zC=dt(Us(),1);var VG=12,ky={fill:3355443,fontFamily:"Arial, Helvetica, sans-serif",fontSize:11,fontWeight:600,lineJoin:"round",stroke:16777215,strokeThickness:2.7},GC={fill:3355443,fontFamily:"Arial, Helvetica, sans-serif",fontSize:11,fontStyle:"italic",fontWeight:600,lineJoin:"round",stroke:16777215,strokeThickness:2.7},$6=class{constructor(e,r,i){this.id=e,this.type=r,this.options=i,this.displayObject=null}},j6=class extends Bt{constructor(e,r){super(e,r),this._enabled=!0;let i=this.scene.groups.get("labels");i.eventMode="none";let n=new E3(5e4);n.name="debug",n.eventMode="none",n.roundPixels=!1,n.sortableChildren=!1,this.debugContainer=n;let s=new st;s.name="labels",s.eventMode="none",s.sortableChildren=!0,this.labelContainer=s,i.addChild(n,s),this._atlasAllocator=new xu,this._textures=new Map,this._rbush=new zC.default,this._avoidBoxes=new Map,this._labelBoxes=new Map,this._labels=new Map,this._oldk=0,Lr.from("label-normal",ky,{chars:Lr.ASCII,padding:0,resolution:2}),this._textStyleNormal=new gi(ky),this._textStyleItalic=new gi(GC)}resetAll(){for(let e of this._labels.values())e.displayObject&&(e.displayObject.destroy({children:!0,texture:!1,baseTexture:!1}),e.displayObject=null);this._avoidBoxes.clear(),this._labelBoxes.clear(),this._labels.clear(),this._rbush.clear()}resetFeature(e){let r=new Set,i=new Set;(this._labelBoxes.get(e)||[]).forEach(n=>r.add(n)),(this._avoidBoxes.get(e)||[]).forEach(n=>r.add(n));for(let n of r.values())this._rbush.remove(n),n.labelID&&i.add(n.labelID);this._labelBoxes.delete(e),this._avoidBoxes.delete(e);for(let n of i.values()){let s=this._labels.get(n);s&&s.displayObject&&(s.displayObject.destroy({children:!0,texture:!1,baseTexture:!1}),s.displayObject=null),this._labels.delete(n)}}render(e,r,i){if(this._enabled&&i>=VG){this.labelContainer.visible=!0,this.debugContainer.visible=this.context.getDebug("label");let n=r.scale();n!==this._oldk&&(this.resetAll(),this._oldk=n);for(let l of this.scene.features.values())l._labelDirty&&(this.resetFeature(l.id),l._labelDirty=!1);this.gatherAvoids();let s=[],o=[],a=[];for(let l of this.scene.features.values())l.label&&l.visible&&!this._labelBoxes.has(l.id)&&(l.type==="point"?s.push(l):l.type==="line"?o.push(l):l.type==="polygon"&&a.push(l));this.labelPoints(s),this.labelLines(o),this.labelPolygons(a),this.renderObjects(r)}else this.labelContainer.visible=!1,this.debugContainer.visible=!1}getLabelSprite(e,r="normal"){let i=`${e}-${r}`,n=this._textures.get(i);if(!n){let o=0,a=e.match(/\p{M}/gu);a&&a.length>0&&(o=10),a&&a.length>20&&(o=50);let l;if(o){let y=Object.assign({},r==="normal"?ky:GC,{padding:o});l=new gi(y)}else l=r==="normal"?this._textStyleNormal:this._textStyleItalic;let c=new C1(e,l);c.resolution=2,c.updateText(!1);let[u,d]=[o*2,0],[h,p]=[c.canvas.width-o*4,c.canvas.height],m=c.context.getImageData(u,d,h,p),g=0;n=this._atlasAllocator.allocate(h,p,g,m),n.orig=c.texture.orig.clone(),n.orig.width=h/2,n.orig.height=p/2,this._textures.set(i,n),c.destroy()}let s=new ir(n);return s.name=e,s.anchor.set(.5,.5),s}gatherAvoids(){let e=this.context.getDebug("label"),r=l.bind(this),i=[],s=this.scene.layers.get("map-ui").container.getChildByName("selected");s&&i.push(s);let o=this.scene.groups.get("points");o&&i.push(o);let a=[];i.forEach(c=>c.children.forEach(r)),a.length&&this._rbush.load(a);function l(c){if(!c.visible||!c.renderable)return;let u=c.name;if(this._avoidBoxes.has(u))return;let d=this.scene.features.get(u),h=d&&d.sceneBounds;if(!h)return;let p=.01,m={type:"avoid",boxID:`${u}-avoid`,featureID:u,minX:h.x+p,minY:h.y+p,maxX:h.x+h.width-p,maxY:h.y+h.height-p};this._avoidBoxes.set(u,[m]),a.push(m);let g=this._rbush.search(m);for(let y of g)if(y.type==="label"){let v=this.scene.features.get(y.featureID);v&&(v._labelDirty=!0)}}}labelPoints(e){e.sort((r,i)=>i.geometry.origCoords[1]-r.geometry.origCoords[1]);for(let r of e){if(this._labelBoxes.has(r.id)||(this._labelBoxes.set(r.id,[]),!r.label))continue;let i;/^[\x20-\x7E]*$/.test(r.label)?(i=new lu(r.label,{fontName:"label-normal"}),i.updateText(),i.name=r.label,i.anchor.set(.5,1)):i=this.getLabelSprite(r.label,"normal"),this.placeTextLabel(r,i)}}labelLines(e){function r(i){let n=parseInt(i.container.parent.name,10);return isNaN(n)?999:n}e.sort((i,n)=>r(n)-r(i));for(let i of e){let n=i.id;if(this._labelBoxes.has(n)||(this._labelBoxes.set(n,[]),!i.label)||!i.geometry.coords||!i.container.visible||!i.container.renderable||i.geometry.width<40&&i.geometry.height<40)continue;let s=this.getLabelSprite(i.label,"normal");this.placeRopeLabel(i,s,i.geometry.coords)}}labelPolygons(e){for(let r of e){let i=r.id;if(this._labelBoxes.has(i)||(this._labelBoxes.set(i,[]),!r.label)||!r.geometry.flatOuter||!r.container.visible||!r.container.renderable||r.geometry.width<600&&r.geometry.height<600)continue;let n=this.getLabelSprite(r.label,"italic"),s={alignment:.5,color:0,width:24,alpha:1,join:Yt.BEVEL,cap:tt.BUTT},o=Zu(r.geometry.flatOuter,s);if(!o.inner)continue;let a=new Array(o.inner.length/2);for(let l=0;l<o.inner.length/2;++l)a[l]=[o.inner[l*2],o.inner[l*2+1]];this.placeRopeLabel(r,n,a)}}placeTextLabel(e,r){if(!e||!e.sceneBounds)return;let i=e.container;if(!i.visible||!i.renderable)return;let n=se.textDirection(),s=e.id,o=e.sceneBounds.clone().pad(1,0),a=o.x,l=o.y,c=o.width,u=o.height,d=o.x+c,h=o.x+c*.5,p=o.y+u,m=e.type==="point"?o.y+u-14:o.y+u*.5,g=r.getLocalBounds().clone().pad(0,-1),y=5,v=10,x=g.width,_=g.height,b=x*.5,w=_*.5,E={t1:[h-v,l-w],t2:[h-y,l-w],t3:[h,l-w],t4:[h+y,l-w],t5:[h+v,l-w],b1:[h-v,p+w],b2:[h-y,p+w],b3:[h,p+w],b4:[h+y,p+w],b5:[h+v,p+w],r1:[d+b,m-v],r2:[d+b,m-y],r3:[d+b,m],r4:[d+b,m+y],r5:[d+b,m+v],l1:[a-b,m-v],l2:[a-b,m-y],l3:[a-b,m],l4:[a-b,m+y],l5:[a-b,m+v]},A;n==="ltr"?A=["r3","r4","r2","b3","b4","b2","b5","b1","l3","l4","l2","t3","t4","t2","t5","t1","r5","r1","l5","l1"]:A=["l3","l4","l2","b3","b2","b4","b1","b5","t3","t2","t4","t1","t5","r3","r4","r2","l5","l1","r5","r1"];let T=null;for(let k=0;!T&&k<A.length;k++){let C=A[k],[I,P]=E[C],N=.01,M={type:"label",boxID:`${s}-${C}`,featureID:s,labelID:s,minX:I-b+N,minY:P-w+N,maxX:I+b-N,maxY:P+w-N};if(!this._rbush.collides(M)){let D=new $6(s,"text",{labelObj:r,x:I,y:P,tint:e.style.labelTint||15658734});this._labels.set(s,D),this._labelBoxes.get(s).push(M),this._rbush.insert(M),T=C}}}placeRopeLabel(e,r,i){if(!e||!r||!i||!e.container.visible||!e.container.renderable)return;let n=e.id,s=r.getLocalBounds(),o=s.width,a=s.height,l=Math.PI/8,c=a+4,u=c*.5,d=Math.ceil(o/c)+1,h=o/((d-1)*c),p=d+15,m=l5(i,c),g=[],y=[],v=[],x=null;function _(){let b=v.length>=d;b&&y.push(v),v.forEach(w=>{w.box.candidate=b,g.push(w.box)}),v=[]}m.forEach((b,w)=>{let E=b.angle;E<0&&(E+=Math.PI),b.coords.forEach((A,T)=>{let[k,C]=A,I=.01,P={type:"label",boxID:`${n}-${w}-${T}`,featureID:n,minX:k-u+I,minY:C-u+I,maxX:k+u-I,maxY:C+u-I},N=!1;if(x!==null){let M=Math.abs(E-x);N=Math.min(2*Math.PI-M,M)>l}x=E,N?(_(),P.bendy=!0,g.push(P)):this._rbush.collides(P)?(_(),P.collides=!0,g.push(P)):(v.push({box:P,coord:A,angle:E}),v.length===p&&_())})}),_(),y.forEach((b,w)=>{let E=Math.floor((b.length-d)/2),A=`${n}-rope-${w}`,T=[];for(let N=E;N<E+d;N++){T.push(b[N].coord);let M=b[N].box;M.labelID=A,this._rbush.insert(M),this._labelBoxes.get(n).push(M)}if(!T.length)return;T[0][0]>T[T.length-1][0]&&T.reverse();let k=vr(T[0],T[T.length-1]),C=T.reduce((N,M)=>Ot(N,M),[0,0]),I=Yi(C,1/T.length);T=T.map(N=>St(N,I)),T=Wo(T,-k,[0,0]),T=T.map(([N,M])=>[N*h,M]),T=Wo(T,k,[0,0]),T=T.map(N=>Ot(N,I));let P=new $6(A,"rope",{coords:T,labelObj:r,tint:e.style.labelTint||15658734});this._labels.set(A,P)})}renderObjects(e){let r=this.context,i=r.getDebug("label"),n=r.pixi.screen,s=r.pixi.stage.position,o=new le([n.x-s.x,n.y-s.y],[n.width-s.x,n.height-s.y]),a=new Set,l=this._rbush.search(o.bbox());for(let c of l)c.labelID&&a.add(c.labelID);for(let c of a.values()){let u=this._labels.get(c);if(!u)continue;let d=u.options;if(!u.displayObject){if(u.type==="text"){let h=d.labelObj;h.tint=d.tint||16777215,h.position.set(d.x,d.y),u.displayObject=h,this.labelContainer.addChild(h)}else if(u.type==="rope"){let h=d.labelObj,p=d.coords.map(([g,y])=>new Ne(g,y)),m=new w3(h.texture,p);m.name=c,m.autoUpdate=!1,m.sortableChildren=!1,m.tint=d.tint||16777215,u.displayObject=m,this.labelContainer.addChild(m)}}}}};var XG=12,V6=class extends Bt{constructor(e,r){super(e,r),this._service=null,this.getService()}getService(){return K.mapillary&&!this._service?(this._service=K.mapillary,this._service.on("loadedMapFeatures",()=>this.context.map().deferredRedraw())):!K.mapillary&&this._service&&(this._service=null),this._service}filterDetections(e){let r=this.context.photos().fromDate,i=this.context.photos().toDate;if(r){let n=new Date(r).getTime();e=e.filter(s=>new Date(s.last_seen_at).getTime()>=n)}if(i){let n=new Date(i).getTime();e=e.filter(s=>new Date(s.first_seen_at).getTime()>=n)}return e}renderMarkers(e,r,i){let n=this.getService();if(!n)return;let s=this.context._mapillarySheet;if(!s)return;let o=this.scene.groups.get("points"),a=n.mapFeatures(this.context.projection);a=this.filterDetections(a);for(let l of a){let c=`${this.layerID}-${l.id}`,u=this.features.get(c);if(!u){let d={markerTexture:s.textures[l.value+".svg"]};u=new sr(this,c),u.geometry.setCoords(l.loc),u.style=d,u.parentContainer=o,u.setData(l.id,l)}this.syncFeatureClasses(u),u.update(r,i),this.retainFeature(u,e)}}render(e,r,i){let n=this.getService();this._enabled&&n&&i>=XG?(n.loadMapFeatures(this.context.projection),n.showFeatureDetections(!0),this.renderMarkers(e,r,i)):n?.showFeatureDetections(!1)}get supported(){return!!this.getService()}};var WG=12,Iy=379747,qG={casing:{alpha:0},stroke:{alpha:.9,width:4,color:Iy}},YG={markerName:"mediumCircle",markerTint:Iy,viewfieldName:"viewfield",viewfieldTint:Iy},X6=class extends Bt{constructor(e,r){super(e,r),this._service=null,this.getService()}getService(){return K.mapillary&&!this._service?(this._service=K.mapillary,this._service.on("loadedImages",()=>this.context.map().deferredRedraw())):!K.mapillary&&this._service&&(this._service=null),this._service}filterImages(e){let r=this.context.photos().fromDate,i=this.context.photos().toDate,n=this.context.photos().usernames;if(r){let s=new Date(r).getTime();e=e.filter(o=>new Date(o.captured_at).getTime()>=s)}if(i){let s=new Date(i).getTime();e=e.filter(o=>new Date(o.captured_at).getTime()<=s)}return n&&(e=e.filter(s=>n.indexOf(s.captured_by)!==-1)),e}filterSequences(e){let r=this.context.photos().fromDate,i=this.context.photos().toDate,n=this.context.photos().usernames;if(r){let s=new Date(r).getTime();e=e.filter(o=>new Date(o[0].properties.captured_at).getTime()>=s)}if(i){let s=new Date(i).getTime();e=e.filter(o=>new Date(o[0].properties.captured_at).getTime()<=s)}return n&&(e=e.filter(s=>n.indexOf(s[0].properties.captured_by)!==-1)),e}renderMarkers(e,r,i){let n=this.getService();if(!n)return;let s=this.scene.groups.get("streetview"),o=n.sequences(this.context.projection),a=n.images(this.context.projection),l=this.filterSequences(o),c=this.filterImages(a);for(let u of l)for(let d=0;d<u.length;++d){let h=u[d],p=h.properties.id,m=`${this.layerID}-sequence-${p}-${d}`,g=this.features.get(m);g||(g=new Rn(this,m),g.geometry.setCoords(h.geometry.coordinates),g.style=qG,g.parentContainer=s,g.container.zIndex=-100,g.setData(p,h)),this.syncFeatureClasses(g),g.update(r,i),this.retainFeature(g,e)}for(let u of c){let d=`${this.layerID}-photo-${u.id}`,h=this.features.get(d);if(!h){let p=Object.assign({},YG);Number.isFinite(u.ca)&&(p.viewfieldAngles=[u.ca]),u.isPano&&(p.viewfieldName="pano"),h=new sr(this,d),h.geometry.setCoords(u.loc),h.style=p,h.parentContainer=s,h.setData(u.id,u),u.sequenceID&&h.addChildData(u.sequenceID,u.id)}this.syncFeatureClasses(h),h.update(r,i),this.retainFeature(h,e)}}render(e,r,i){let n=this.getService();!this._enabled||!n||i<WG||(n.loadImages(this.context.projection),this.renderMarkers(e,r,i))}get supported(){return!!this.getService()}};var QG=12,W6=class extends Bt{constructor(e,r){super(e,r),this._service=null,this.getService()}getService(){return K.mapillary&&!this._service?(this._service=K.mapillary,this._service.on("loadedSigns",()=>this.context.map().deferredRedraw())):!K.mapillary&&this._service&&(this._service=null),this._service}filterDetections(e){let r=this.context.photos().fromDate,i=this.context.photos().toDate;if(r){let n=new Date(r).getTime();e=e.filter(s=>new Date(s.last_seen_at).getTime()>=n)}if(i){let n=new Date(i).getTime();e=e.filter(s=>new Date(s.first_seen_at).getTime()>=n)}return e}renderMarkers(e,r,i){let n=this.getService();if(!n)return;let s=this.context._mapillarySignSheet;if(!s)return;let o=this.scene.groups.get("points"),a=n.signs(this.context.projection);a=this.filterDetections(a);for(let l of a){let c=`${this.layerID}-${l.id}`,u=this.features.get(c);if(!u){let d={markerTexture:s.textures[l.value+".svg"]};u=new sr(this,c),u.geometry.setCoords(l.loc),u.style=d,u.parentContainer=o,u.setData(l.id,l)}this.syncFeatureClasses(u),u.update(r,i),this.retainFeature(u,e)}}render(e,r,i){let n=this.getService();this._enabled&&n&&i>=QG?(n.loadSigns(this.context.projection),n.showSignDetections(!0),this.renderMarkers(e,r,i)):n?.showSignDetections(!1)}get supported(){return!!this.getService()}};var VC=dt(My(),1);var c5={DEFAULT:{fill:{width:2,color:11184810,alpha:.3},casing:{width:5,color:4473924,alpha:1,cap:tt.ROUND,join:Yt.ROUND},stroke:{width:3,color:13421772,alpha:1,cap:tt.ROUND,join:Yt.ROUND}},red:{fill:{color:14708319,alpha:.3}},green:{fill:{color:9228383,alpha:.3}},blue:{fill:{color:7853278,alpha:.3}},yellow:{fill:{color:16777108,alpha:.25}},gold:{fill:{color:12893721,alpha:.3}},orange:{fill:{color:14059546,alpha:.3}},pink:{fill:{color:14918901,alpha:.3}},teal:{fill:{color:10084778,alpha:.3}},lightgreen:{fill:{color:12511295,alpha:.3}},tan:{fill:{color:16112826,alpha:.3}},darkgray:{fill:{color:9211020,alpha:.5}},lightgray:{fill:{color:11184810,alpha:.3}},motorway:{casing:{width:10,color:7354159},stroke:{width:8,color:13574273}},trunk:{casing:{width:10,color:7354159},stroke:{width:8,color:14495522}},primary:{casing:{width:10,color:7354159},stroke:{width:8,color:16357382}},secondary:{casing:{width:10,color:7354159},stroke:{width:8,color:15987474}},tertiary:{casing:{width:10,color:7354159},stroke:{width:8,color:16775603}},unclassified:{casing:{width:10,color:4473924},stroke:{width:8,color:14535850}},residential:{casing:{width:10,color:4473924},stroke:{width:8,color:16777215}},living_street:{casing:{width:7,color:16777215},stroke:{width:5,color:13421772}},service:{casing:{width:7,color:4473924},stroke:{width:5,color:16777215}},special_service:{casing:{width:7,color:4473924},stroke:{width:5,color:14535850}},track:{casing:{width:7,color:7630703},stroke:{width:5,color:12957087}},pedestrian:{casing:{width:7,color:16777215},stroke:{width:5,color:10061960,dash:[8,8],cap:tt.BUTT}},path:{casing:{width:5,color:14535850},stroke:{width:3,color:10061960,dash:[6,6],cap:tt.BUTT}},footway:{casing:{width:5,color:16777215},stroke:{width:3,color:10061960,dash:[6,6],cap:tt.BUTT}},crossing_marked:{casing:{width:5,color:14535850},stroke:{width:3,color:4998212,dash:[6,3],cap:tt.BUTT}},crossing_unmarked:{casing:{width:5,color:14535850},stroke:{width:3,color:7826026,dash:[6,4],cap:tt.BUTT}},cycleway:{casing:{width:5,color:16777215},stroke:{width:3,color:5810669,dash:[6,6],cap:tt.BUTT}},bridleway:{casing:{width:5,color:16777215},stroke:{width:3,color:14708063,dash:[6,6],cap:tt.BUTT}},corridor:{casing:{width:5,color:16777215},stroke:{width:3,color:9228383,dash:[2,8],cap:tt.ROUND}},steps:{casing:{width:5,color:16777215},stroke:{width:3,color:8507996,dash:[3,3],cap:tt.BUTT}},river:{casing:{width:10,color:4473924},stroke:{width:8,color:7855581}},stream:{casing:{width:7,color:4473924},stroke:{width:5,color:7855581}},ridge:{stroke:{width:2,color:9228383}},runway:{casing:{width:10,color:0,cap:tt.BUTT},stroke:{width:8,color:16777215,dash:[24,48],cap:tt.BUTT}},taxiway:{casing:{width:7,color:4473924},stroke:{width:5,color:16776960}},railway:{casing:{width:7,color:5592405,cap:tt.BUTT},stroke:{width:2,color:15658734,dash:[12,12],cap:tt.BUTT}},ferry:{casing:{alpha:0},stroke:{width:3,color:5810669,dash:[12,8],cap:tt.BUTT}},boundary:{casing:{width:6,color:8566270,cap:tt.BUTT},stroke:{width:2,color:16777215,dash:[20,5,5,5],cap:tt.BUTT}},boundary_park:{casing:{width:6,color:8566270,cap:tt.BUTT},stroke:{width:2,color:11592344,dash:[20,5,5,5],cap:tt.BUTT}},barrier:{casing:{alpha:0},stroke:{width:3,color:14540253,dash:[10,5,1,5],cap:tt.ROUND}},barrier_wall:{casing:{alpha:0},stroke:{width:3,color:14540253,dash:[10,5,1,5],cap:tt.ROUND}},barrier_hedge:{fill:{color:9228383,alpha:.3},casing:{alpha:0},stroke:{width:3,color:9228383,dash:[10,5,1,5],cap:tt.ROUND}},tree_row:{casing:{width:7,color:4473924},stroke:{width:5,color:9228383}}},KG={aeroway:{runway:"runway",taxiway:"taxiway"},amenity:{childcare:"yellow",college:"yellow",fountain:"blue",kindergarten:"yellow",parking:"darkgray",research_institute:"yellow",school:"yellow",university:"yellow"},building:{"*":"red"},barrier:{city_wall:"barrier_wall",hedge:"barrier_hedge",retaining_wall:"barrier_wall",wall:"barrier_wall","*":"barrier"},boundary:{protected_area:"boundary_park",national_park:"boundary_park","*":"boundary"},crossing:{marked:"crossing_marked",zebra:"crossing_marked","*":"crossing_unmarked"},golf:{green:"lightgreen"},highway:{bridleway:"bridleway",bus_guideway:"railway",busway:"special_service",corridor:"corridor",cycleway:"cycleway",footway:"footway",living_street:"living_street",living_street_link:"living_street",motorway:"motorway",motorway_link:"motorway",path:"path",pedestrian:"pedestrian",primary:"primary",primary_link:"primary",residential:"residential",residential_link:"residential",secondary:"secondary",secondary_link:"secondary",service:"service",service_link:"service",steps:"steps",tertiary:"tertiary",tertiary_link:"tertiary",track:"track",trunk:"trunk",trunk_link:"trunk",unclassified:"unclassified",unclassified_link:"unclassified"},landuse:{cemetery:"lightgreen",commercial:"orange",construction:"gold",farmland:"lightgreen",farmyard:"tan",flowerbed:"green",forest:"green",grass:"green",industrial:"pink",landfill:"orange",meadow:"lightgreen",military:"orange",orchard:"lightgreen",quarry:"darkgray",railway:"darkgray",recreation_ground:"green",residential:"gold",retail:"orange",village_green:"green",vineyard:"lightgreen"},leisure:{garden:"green",golf_course:"green",nature_reserve:"green",park:"green",pitch:"green",swimming_pool:"blue",track:"yellow"},man_made:{adit:"darkgray",breakwater:"barrier_wall",groyne:"barrier_wall"},military:{"*":"orange"},natural:{bare_rock:"darkgray",bay:"blue",beach:"yellow",cave_entrance:"darkgray",cliff:"darkgray",glacier:"lightgray",ridge:"ridge",rock:"darkgray",sand:"yellow",scree:"darkgray",scrub:"yellow",shingle:"darkgray",stone:"darkgray",tree_row:"tree_row",water:"blue",wetland:"teal","*":"green"},power:{plant:"pink"},railway:{platform:"footway","*":"railway"},route:{ferry:"ferry"},sport:{baseball:"yellow",basketball:"darkgray",beachvolleyball:"yellow",skateboard:"darkgray",softball:"yellow"},type:{waterway:"river"},waterway:{river:"river",dam:"DEFAULT",weir:"DEFAULT","*":"stream"},service:{alley:"special_service",driveway:"special_service","drive-through":"special_service",parking_aisle:"special_service","*":"special_service"}},ZG={amenity:{fountain:"water_standing",grave_yard:"cemetery"},golf:{green:"grass"},landuse:{cemetery:"cemetery",construction:"construction",farmland:"farmland",farmyard:"farmyard",forest:"forest",grass:"grass",grave_yard:"cemetery",landfill:"landfill",meadow:"grass",military:"construction",orchard:"orchard",quarry:"quarry",vineyard:"vineyard"},leaf_type:{broadleaved:"forest_broadleaved",leafless:"forest_leafless",needleleaved:"forest_needleleaved"},natural:{beach:"dots",grassland:"grass",sand:"dots",scrub:"bushes",water:"waves",wetland:"wetland",wood:"forest"},religion:{buddhist:"cemetery_buddhist",christian:"cemetery_christian",jewish:"cemetery_jewish",muslim:"cemetery_muslim"},surface:{grass:"grass"},water:{pond:"pond",reservoir:"lines"},wetland:{bog:"wetland_bog",marsh:"wetland_marsh",reedbed:"wetland_reedbed",swamp:"wetland_swamp"}},JG={motorway:!0,motorway_link:!0,trunk:!0,trunk_link:!0,primary:!0,primary_link:!0,secondary:!0,secondary_link:!0,tertiary:!0,tertiary_link:!0,unclassified:!0,unclassified_link:!0,residential:!0,residential_link:!0,living_street:!0,living_street_link:!0,service:!0,service_link:!0,bus_guideway:!0,track:!0};function u5(t){let e=c5.DEFAULT,r=999;for(let o in t){let a=t[o],l=KG[o];if(!l||!a)continue;let c=Object.keys(l).length,u=l[a];if(u||(u=l["*"]),u&&c<=r){if(!c5[u]){console.error(`invalid stylename: ${u}`);continue}if(e=c5[u],r=c,r===1)break}}let i={};for(let o of["fill","casing","stroke"]){i[o]={};for(let a of["width","color","alpha","cap","dash"]){let l=e[o]&&e[o][a];if(l!==void 0){i[o][a]=l;continue}let c=c5.DEFAULT[o]&&c5.DEFAULT[o][a];c!==void 0&&(i[o][a]=c)}}t.bridge&&(i.casing.width+=7,i.casing.color=0,i.casing.cap=tt.BUTT),t.tunnel&&(i.stroke.alpha=.5);let n=t.surface,s=t.highway;if(s==="track"&&t.tracktype!=="grade1"&&(n=n||"dirt"),n&&JG[s]&&!Bl.surface[n]&&(t.bridge||(i.casing.color=13421772),i.casing.cap=tt.BUTT,i.casing.dash=[4,4]),i.fill.pattern||t.building)return i;r=999;for(let o in t){let a=t[o],l=ZG[o];if(!l||!a)continue;let c=Object.keys(l).length,u=l[a];if(u||(u=l["*"]),u&&c<=r&&(i.fill.pattern=u,r=c,r===1))break}return i}var ez=12,Y6=class extends Bt{constructor(e,r){super(e,r);let i=this.scene.groups.get("basemap");this._enabled=!0,this._service=null,this._resolved=new Map,this.getService();let n=new st;n.name=`${this.layerID}-areas`,n.sortableChildren=!0,this.areaContainer=n;let s=new st;s.name=`${this.layerID}-lines`,s.sortableChildren=!0,this.lineContainer=s,i.addChild(n,s)}getService(){return K.osm&&!this._service?this._service=K.osm:!K.osm&&this._service&&(this._service=null),this._service}get supported(){return!!this.getService()}render(e,r,i){let n=this.getService();if(!this._enabled||!n||i<ez)return;let s=this.context,o=s.graph(),a=s.map();s.loadTiles(s.projection);let l=s.history().intersects(a.extent());l=s.features().filter(l,this.context.graph());let c={polygons:new Map,lines:new Map,points:new Map,vertices:new Map};for(let y of l){let v=y.geometry(o);v==="point"?c.points.set(y.id,y):v==="vertex"?c.vertices.set(y.id,y):v==="line"?c.lines.set(y.id,y):v==="area"&&c.polygons.set(y.id,y)}this.renderPolygons(e,r,i,c),this.renderLines(e,r,i,c),this.renderPoints(e,r,i,c);let u=this._classHasData.get("selected")??new Set,d=this._classHasData.get("hovered")??new Set,h=this._classHasData.get("drawing")??new Set,p=new Set([...u,...d,...h]);for(let y of p){if(s.hasEntity(y)?.type==="node")continue;let x=this._dataHasFeature.get(y)??new Set,_=!1;for(let b of x){let w=this.features.get(b)?.geometry;if(!(!w||w.type==="point")&&w.width<25&&w.height<25){_=!0;break}}_&&p.delete(y)}let m=new Set(p);for(let y of p){let v=s.hasEntity(y);if(v?.type==="node")for(let x of o.parentWays(v))m.add(x.id)}let g={descendantIDs:new Set,siblingIDs:new Set};for(let y of m)this.getSelfAndDescendants(y,g.descendantIDs),this.getSelfAndSiblings(y,g.siblingIDs);this.renderVertices(e,r,i,c,g),s.mode()?.id==="select"&&this.renderMidpoints(e,r,i,c,g)}renderPolygons(e,r,i,n){let s=n.polygons,o=this.context.graph(),a=this.scene.groups.get("points"),l=this.context.features().hidden("points");function c(u){return!u||u.isFallback()||/^(address|building|indoor|landuse|man_made|military|natural|playground)/.test(u.id)?!1:!!(/^(club|craft|emergency|healthcare|office|power|shop|telecom|tourism)/.test(u.id)||/^amenity\/(?!parking|shelter)/.test(u.id)||/^leisure\/(?!garden|firepit|picnic_table|pitch|swimming_pool)/.test(u.id))}for(let[u,d]of s){let h=d.v||0,p=this._resolved.get(u);p?.v!==h&&(p=null),p||(p=(0,VC.default)(d.asGeoJSON(o),!0),p.v=h,this._resolved.set(u,p));let m=p.type==="Polygon"?[p.coordinates]:p.type==="MultiPolygon"?p.coordinates:[];for(let g=0;g<m.length;++g){let y=m[g],v=`${this.layerID}-${u}-fill-${g}`,x=this.features.get(v);if(x&&x.type!=="polygon"&&(x.destroy(),x=null),x||(x=new Mo(this,v),x.parentContainer=this.areaContainer),x.v!==h){x.v=h,x.geometry.setCoords(y);let _=x.geometry.origExtent.area();x.container.zIndex=-_,x.setData(u,d),x.clearChildData(u),d.type==="relation"&&d.members.forEach(b=>x.addChildData(u,b.id)),d.type==="way"&&d.nodes.forEach(b=>x.addChildData(u,b))}if(this.syncFeatureClasses(x),x.dirty){let _=xe.match(d,o),b=u5(d.tags);b.labelTint=b.fill.color??b.stroke.color??15658734,x.style=b;let w=Q6(d);x.label=w,!l&&(w||c(_))?(x.poiFeatureID=`${this.layerID}-${u}-poi-${g}`,x.poiPreset=_):(x.poiFeatureID=null,x.poiPreset=null)}if(x.update(r,i),this.retainFeature(x,e),x.poiFeatureID&&x.poiPreset&&x.geometry.origPoi){let _=this.features.get(x.poiFeatureID);if(_||(_=new sr(this,x.poiFeatureID),_.virtual=!0,_.parentContainer=a),_.v!==h&&(_.v=h,_.geometry.setCoords(x.geometry.origPoi),_.setData(u,d)),this.syncFeatureClasses(_),_.dirty){let b={markerName:"pin",markerTint:16777215,iconName:x.poiPreset.icon,iconAlpha:1};Py(d)&&(b.markerName="boldPin",b.markerTint=14540253,b.labelTint=14540253,b.iconAlpha=.6),_.style=b,_.label=x.label}_.update(r,i),this.retainFeature(_,e)}}}}renderLines(e,r,i,n){let s=n.lines,o=this.context.graph(),a=this.lineContainer;for(let[c,u]of s){let d=u.v||0,h=typeof u.layer=="function"?u.layer():0,p=l(h.toString()),m=rz(u.tags),g=this._resolved.get(c);g?.v!==d&&(g=null),g||(g=u.asGeoJSON(o),g.v=d,g.type==="LineString"&&u.tags.oneway==="-1"&&g.coordinates.reverse(),this._resolved.set(c,g));let y=g.type==="LineString"?[[g.coordinates]]:g.type==="Polygon"?[g.coordinates]:g.type==="MultiPolygon"?g.coordinates:[];for(let v=0;v<y.length;++v){let x=y[v];for(let _=0;_<x.length;++_){let b=x[_],w=`${this.layerID}-${c}-${v}-${_}`,E=this.features.get(w);if(E&&E.type!=="line"&&(E.destroy(),E=null),E||(E=new Rn(this,w)),E.v!==d&&(E.v=d,E.geometry.setCoords(b),E.parentContainer=p,E.container.zIndex=m,E.setData(c,u),E.clearChildData(c),u.type==="relation"&&u.members.forEach(A=>E.addChildData(c,A.id)),u.type==="way"&&u.nodes.forEach(A=>E.addChildData(c,A))),this.syncFeatureClasses(E),E.dirty){let A=u.tags,T=u.geometry(o);if(!u.hasInterestingTags()){let C=o.parentRelations(u).find(I=>I.isMultipolygon());C&&(A=C.tags,T="area")}let k=u5(A);T==="line"?(k.lineMarkerName=u.isOneWay()?"oneway":"",k.sidedMarkerName=u.isSided()?"sided":""):(k.casing.width=0,k.stroke.color=k.fill.color,k.stroke.width=2,k.stroke.alpha=1),E.style=k,E.label=qt(u)}E.update(r,i),this.retainFeature(E,e)}}}function l(c){let u=a.getChildByName(c);return u||(u=new st,u.name=c.toString(),u.sortableChildren=!0,u.zIndex=c,a.addChild(u)),u}}renderVertices(e,r,i,n,s){let o=n.vertices,a=this.context,l=a.graph(),u=this.scene.layers.get("map-ui").container.getChildByName("selected"),d=this.scene.groups.get("points");function h(m){return m.hasInterestingTags()||m.isEndpoint(l)||m.isIntersection(l)}function p(m){return s.descendantIDs.has(m)||s.siblingIDs.has(m)}for(let[m,g]of o){let y=null;if(i>=16&&h(g)&&(y=d),p(m)&&(y=u),!y)continue;let v=`${this.layerID}-${m}`,x=this.features.get(v);x&&x.type!=="point"&&(x.destroy(),x=null),x||(x=new sr(this,v));let _=g.v||0;if(x.v!==_&&(x.v=_,x.geometry.setCoords(g.loc),x.setData(m,g)),this.syncFeatureClasses(x),x.parentContainer=y,x.dirty){let b=xe.match(g,l),w=b&&b.icon,A={markerName:"smallCircle",markerTint:16777215,labelTint:15658734,viewfieldAngles:g.directions(l,a.projection),viewfieldName:"viewfieldDark",viewfieldTint:16777215,iconName:w,iconAlpha:1};w?(A.markerName="largeCircle",A.iconName=w):g.hasInterestingTags()&&(A.markerName="taggedCircle"),Py(g)&&(A.markerTint=14540253,A.labelTint=14540253,A.iconAlpha=.6),l.isShared(g)&&(A.markerTint=12303291,A.labelTint=12303291),x.style=A,x.label=qt(g)}x.update(r,i),this.retainFeature(x,e)}}renderPoints(e,r,i,n){let s=n.points,o=this.context.graph(),a=this.scene.groups.get("points");for(let[l,c]of s){let u=c.v||0,d=`${this.layerID}-${l}`,h=this.features.get(d);if(h&&h.type!=="point"&&(h.destroy(),h=null),h||(h=new sr(this,d),h.parentContainer=a),h.v!==u&&(h.v=u,h.geometry.setCoords(c.loc),h.setData(l,c)),this.syncFeatureClasses(h),h.dirty){let p=xe.match(c,o),m=p&&p.icon,y={markerName:"pin",markerTint:16777215,viewfieldAngles:c.directions(o,this.context.projection),viewfieldName:"viewfieldDark",viewfieldTint:16777215,iconName:m,iconAlpha:1};Py(c)&&(y.markerName="boldPin",y.markerTint=14540253,y.labelTint=14540253,y.iconAlpha=.6),p.id==="address"&&(y.markerName="largeCircle",y.iconName="maki-circle-stroked"),h.style=y,h.label=qt(c)}h.update(r,i),this.retainFeature(h,e)}}renderMidpoints(e,r,i,n,s){let a=this.context.graph(),l=new Map([...n.lines,...n.polygons]),u=this.scene.layers.get("map-ui").container.getChildByName("selected"),d=new Map,h={markerName:"midpoint"};for(let[p,m]of l){if(!s.descendantIDs.has(p))continue;let g=a.childNodes(m);if(!g.length)continue;let y=g.map(v=>({id:v.id,point:r.project(v.loc)}));m.tags.oneway==="-1"&&y.reverse(),y.slice(0,-1).forEach((v,x)=>{let _=y[x],b=y[x+1],w=[_.id,b.id].sort().join("-");if(ut(_.point,b.point)<40)return;let A=Ct(_.point,b.point,.5),T=vr(_.point,b.point),k=r.invert(A),C={type:"midpoint",id:w,a:_,b,way:m,loc:k,rot:T};d.has(w)||d.set(w,C)})}for(let[p,m]of d){let g=`${this.layerID}-${p}`,y=this.features.get(g);y||(y=new sr(this,g),y.style=h,y.parentContainer=u),y.v!==m.loc&&(y.v=m.loc,y.geometry.setCoords(m.loc),y.container.rotation=m.rot,y.setData(p,m),y.addChildData(m.way.id,p)),this.syncFeatureClasses(y),y.update(r,i),this.retainFeature(y,e)}}},tz={motorway:0,motorway_link:-1,trunk:-2,trunk_link:-3,primary:-4,primary_link:-5,secondary:-6,tertiary:-7,unclassified:-8,residential:-9,service:-10,track:-11,footway:-12};function rz(t){return tz[t.highway]||0}function Py(t){return t.tags.wikidata||t.tags["flag:wikidata"]||t.tags["brand:wikidata"]||t.tags["network:wikidata"]||t.tags["operator:wikidata"]}var iz=12,K6=class extends Bt{constructor(e,r){super(e,r),this._service=null,this.getService()}getService(){return K.osm&&!this._service?(this._service=K.osm,this._service.on("loadedNotes",()=>this.context.map().deferredRedraw())):!K.osm&&this._service&&(this._service=null),this._service}renderMarkers(e,r,i){let n=this.getService();if(!n)return;let s=this.scene.groups.get("qa"),o=n.notes(this.context.projection);for(let a of o){let l=`${this.layerID}-${a.id}`,c=this.features.get(l);if(!c){let u=16724736;a.status==="closed"&&(u=5627136),a.isNew()&&(u=16772608);let d={markerName:"osmnote",markerTint:u};c=new sr(this,l),c.geometry.setCoords(a.loc),c.style=d,c.parentContainer=s,c.setData(a.id,a)}this.syncFeatureClasses(c),c.update(r,i),this.retainFeature(c,e)}}render(e,r,i){let n=this.getService();!this.enabled||!n||i<iz||(n.loadNotes(this.context.projection),this.renderMarkers(e,r,i))}get supported(){return!!this.getService()}};var nz=12,Z6=class extends Bt{constructor(e,r){super(e,r),this._service=null,this.getService()}getService(){return K.osmose&&!this._service?(this._service=K.osmose,this._service.on("loaded",()=>this.context.map().deferredRedraw())):!K.osmose&&this._service&&(this._service=null),this._service}renderMarkers(e,r,i){let n=this.getService();if(!n)return;let s=this.scene.groups.get("qa"),o=n.getItems(this.context.projection);for(let a of o){let l=`${this.layerID}-${a.id}`,c=this.features.get(l);if(!c){let u={markerName:"osmose",markerTint:n.getColor(a.item),iconName:a.icon};c=new sr(this,l),c.geometry.setCoords(a.loc),c.style=u,c.parentContainer=s,c.setData(a.id,a)}this.syncFeatureClasses(c),c.update(r,i),c._isCircular||c.icon.position.set(0,-17),this.retainFeature(c,e)}}render(e,r,i){let n=this.getService();!this.enabled||!n||i<nz||(n.loadIssues(this.context.projection),this.renderMarkers(e,r,i))}get supported(){return!!this.getService()}};var XC=dt(My(),1);var sz=12,J6=class extends Bt{constructor(e,r){super(e,r),this._enabled=!0,this._serviceFB=null,this._serviceEsri=null,this._resolved=new Map,this.getServiceFB(),this.getServiceEsri(),this._acceptedIDs=new Set,this.context.history().on("undone.rapid",n.bind(this)).on("change.rapid",s.bind(this)).on("restore.rapid",o.bind(this));function i(a){return a&&a.type&&/^rapid/.test(a.type)}function n(a,l){let c=l.annotation;i(c)&&(this._acceptedIDs.delete(c.id),this.context.map().immediateRedraw())}function s(){let a=this.context.history().peekAnnotation();i(a)&&(this._acceptedIDs.add(a.id),this.context.map().immediateRedraw())}function o(){this._acceptedIDs=new Set,this.context.history().peekAllAnnotations().forEach(a=>{i(a)&&(this._acceptedIDs.add(a.id),a.origid&&this._acceptedIDs.add(a.origid))}),this.context.map().immediateRedraw()}}getServiceFB(){return K.fbMLRoads&&!this._serviceFB?(this._serviceFB=K.fbMLRoads,this._serviceFB.on("loadedData",()=>this.context.map().deferredRedraw())):!K.fbMLRoads&&this._serviceFB&&(this._serviceFB=null),this._serviceFB}getServiceEsri(){return K.esriData&&!this._serviceEsri?(this._serviceEsri=K.esriData,this._serviceEsri.on("loadedData",()=>this.context.map().deferredRedraw())):!K.esriData&&this._serviceEsri&&(this._serviceEsri=null),this._serviceEsri}render(e,r,i){let n=this.context.rapidContext(),s=Object.values(n.datasets());if(!(!this.enabled||!s.length||i<sz))for(let o of s)this.renderDataset(o,e,r,i)}renderDataset(e,r,i,n){let s=this.context,o=s.rapidContext();if(!(e.added&&e.enabled))return;let l=e.service==="fbml"?this.getServiceFB():this.getServiceEsri();if(!l)return;let c=e.id+(e.conflated?"-conflated":""),u=l.graph(c),d=this._acceptedIDs;function h(b){return d.has(b.id)||d.has(b.__origid__)}let p={points:[],vertices:new Set,lines:[],polygons:[]};if(e.service==="fbml"){n>=15&&l.loadTiles(c,s.projection,o.getTaskExtent());let b=l.intersects(c,s.map().extent()).filter(w=>w.type==="way"&&!h(w));e.id==="fbRoads"||e.id==="rapid_intro_graph"?(p.lines=b.filter(w=>w.geometry(u)==="line"&&!!w.tags.highway),p.lines.forEach(w=>{let E=u.entity(w.first()),A=u.entity(w.last());p.vertices.add(E),p.vertices.add(A)})):p.polygons=b.filter(w=>w.geometry(u)==="area")}else if(e.service==="esri"){n>=14&&l.loadTiles(c,s.projection);let b=l.intersects(c,s.map().extent());for(let w of b){if(h(w))continue;let E=w.geometry(u);E==="point"&&w.__fbid__?p.points.push(w):E==="line"?p.lines.push(w):E==="area"&&p.polygons.push(w)}}let m=this.scene.groups.get("points"),g=this.scene.groups.get("basemap"),y=`${this.layerID}-${e.id}-areas`,v=`${this.layerID}-${e.id}-lines`,x=g.getChildByName(y);x||(x=new st,x.name=y,x.sortableChildren=!0,g.addChild(x));let _=g.getChildByName(v);_||(_=new st,_.name=v,_.sortableChildren=!0,g.addChild(_)),this.renderPolygons(x,e,u,r,i,n,p),this.renderLines(_,e,u,r,i,n,p),this.renderPoints(m,e,u,r,i,n,p)}renderPolygons(e,r,i,n,s,o,a){let l=he.string2hex(r.color);for(let c of a.polygons){let u=this._resolved.get(c.id);u||(u=(0,XC.default)(c.asGeoJSON(i),!0),this._resolved.set(c.id,u));let d=u.type==="Polygon"?[u.coordinates]:u.type==="MultiPolygon"?u.coordinates:[];for(let h=0;h<d.length;++h){let p=d[h],m=`${this.layerID}-${r.id}-${c.id}-${h}`,g=this.features.get(m);if(!g){g=new Mo(this,m),g.geometry.setCoords(p);let y=g.geometry.origExtent.area();g.container.zIndex=-y,g.parentContainer=e,g.rapidFeature=!0,g.setData(c.id,c)}if(this.syncFeatureClasses(g),g.dirty){let y={labelTint:l,fill:{width:2,color:l,alpha:.3}};g.style=y,g.label=qt(c),g.update(s,o)}this.retainFeature(g,n)}}}renderLines(e,r,i,n,s,o,a){let l=he.string2hex(r.color);for(let c of a.lines){let u=`${this.layerID}-${r.id}-${c.id}`,d=this.features.get(u);if(!d){let p=c.asGeoJSON(i).coordinates;c.tags.oneway==="-1"&&p.reverse(),d=new Rn(this,u),d.geometry.setCoords(p),d.parentContainer=e,d.rapidFeature=!0,d.setData(c.id,c)}if(this.syncFeatureClasses(d),d.dirty){let h={labelTint:l,casing:{width:5,color:4473924},stroke:{width:3,color:l}};h.lineMarkerName=c.isOneWay()?"oneway":"",d.style=h,d.label=qt(c),d.update(s,o)}this.retainFeature(d,n)}}renderPoints(e,r,i,n,s,o,a){let l=he.string2hex(r.color),c={markerName:"largeCircle",markerTint:l,iconName:"maki-circle-stroked",labelTint:l},u={markerName:"smallCircle",markerTint:l,labelTint:l};for(let d of a.points){let h=`${this.layerID}-${r.id}-${d.id}`,p=this.features.get(h);if(p||(p=new sr(this,h),p.geometry.setCoords(d.loc),p.parentContainer=e,p.rapidFeature=!0,p.setData(d.id,d)),this.syncFeatureClasses(p),p.dirty){p.style=c,p.label=qt(d);let m=d.tags["addr:housenumber"];!p.label&&m&&(p.label=m),p.update(s,o)}this.retainFeature(p,n)}for(let d of a.vertices){let h=`${this.layerID}-${d.id}`,p=this.features.get(h);if(p||(p=new sr(this,h),p.geometry.setCoords(d.loc),p.parentContainer=e,p.rapidFeature=!0,p.allowInteraction=!1,p.setData(d.id,d)),this.syncFeatureClasses(p),p.dirty){p.style=u,p.label=qt(d);let m=d.tags["addr:housenumber"];!p.label&&m&&(p.label=m),p.update(s,o)}this.retainFeature(p,n)}}};var e7=class extends Bt{constructor(e,r){super(e,r);let i=new st;i.name=r,i.sortableChildren=!0,this.container=i,this.scene.groups.get("ui").addChild(i),this._enabled=!0,this._oldk=0,this._geolocationData=null,this._geolocationDirty=!1;let s=new st;s.name="geolocation",s.eventMode="none",s.sortableChildren=!1,s.visible=!1,this.geolocationContainer=s;let o=new st;o.name="tile-debug",o.eventMode="none",o.sortableChildren=!1,o.visible=!1,this.tileDebugContainer=o;let a=new st;a.name="selected",a.sortableChildren=!0,a.visible=!0,this.selectedContainer=a,this._lassoPolygonData=null,this._lassoPolygonDirty=!1,this._lassoLineGraphics=new it,this._lassoFillGraphics=new it;let l=new st;l.name="lasso",l.eventMode="none",l.sortableChildren=!1,l.visible=!0,l.addChild(this._lassoLineGraphics,this._lassoFillGraphics),this.lassoContainer=l,this.container.addChild(s,o,a,l)}get enabled(){return this._enabled}set enabled(e){}get geolocationData(){return this._geolocationData}set geolocationData(e){this._geolocationData=e,this._geolocationDirty=!0}get lassoPolygonData(){return this._lassoPolygonData}set lassoPolygonData(e){this._lassoPolygonData=e,this._lassoPolygonDirty=!0}render(e,r){let i=r.scale();i!==this._oldk&&(this._geolocationDirty=!0,this._lassoPolygonDirty=!0,this._oldk=i),this._geolocationDirty&&this.renderGeolocation(e,r),this._lassoPolygonDirty&&this.renderLasso(e,r)}renderLasso(e,r){this._lassoPolygonDirty&&(this._lassoPolygonDirty=!1);let i={alpha:.7,dash:[6,3],width:1,color:16777215};if(!this._lassoPolygonData&&this._lassoLineGraphics.parent)this.lassoContainer.removeChildren();else if(this._lassoLineGraphics.parent||(this.lassoContainer.addChild(this._lassoLineGraphics),this.lassoContainer.addChild(this._lassoFillGraphics)),this._lassoLineGraphics.clear(),this._lassoFillGraphics.clear(),this._lassoPolygonData?.length>0){let n=this._lassoPolygonData.map(s=>r.project(s));new ro(this._lassoLineGraphics,i).drawPolygon(n.flat()),this._lassoFillGraphics.beginFill(11184810,.5).drawPolygon(n.flat()).endFill()}}renderGeolocation(e,r){if(this._geolocationDirty)if(this._geolocationDirty=!1,this.geolocationContainer.removeChildren(),this.geolocationData&&this.geolocationData.coords){let i=this.geolocationData.coords,n=[i.longitude,i.latitude],[s,o]=r.project(n),a=fi(i.accuracy,n[1]),l=[i.longitude+a,i.latitude],c=r.project(l)[0],u=Math.max(Math.abs(c-s),15),d=942335,h=new it().beginFill(d,.4).drawCircle(s,o,u).endFill();if(h.name="aura",this.geolocationContainer.addChild(h),i.heading!==null&&!isNaN(i.heading)){let m=this.context.pixi.rapidTextures,g=new ir(m.get("viewfieldDark"));g.anchor.set(.5,1),g.angle=i.heading,g.name="heading",g.position.set(s,o),this.geolocationContainer.addChild(g)}let p=new it().lineStyle(1.5,16777215,1).beginFill(d,1).drawCircle(s,o,6.5).endFill();p.name="position",this.geolocationContainer.addChild(p),this.geolocationContainer.visible=!0}else this.geolocationContainer.visible=!1}};var oz=12,Ry=1048516,az={casing:{alpha:0},stroke:{alpha:.9,width:4,color:Ry}},lz={markerName:"mediumCircle",markerTint:Ry,viewfieldName:"viewfield",viewfieldTint:Ry},t7=class extends Bt{constructor(e,r){super(e,r),this._service=null,this.getService()}getService(){return K.streetside&&!this._service?(this._service=K.streetside,this._service.on("loadedImages",()=>this.context.map().deferredRedraw())):!K.streetside&&this._service&&(this._service=null),this._service}filterImages(e){let r=this.context.photos().fromDate,i=this.context.photos().toDate,n=this.context.photos().usernames;if(r){let s=new Date(r).getTime();e=e.filter(o=>new Date(o.captured_at).getTime()>=s)}if(i){let s=new Date(i).getTime();e=e.filter(o=>new Date(o.captured_at).getTime()<=s)}return n&&(e=e.filter(s=>n.indexOf(s.captured_by)!==-1)),e}filterSequences(e){let r=this.context.photos().fromDate,i=this.context.photos().toDate,n=this.context.photos().usernames;if(r){let s=new Date(r).getTime();e=e.filter(o=>new Date(o.properties.captured_at).getTime()>=s)}if(i){let s=new Date(i).getTime();e=e.filter(o=>new Date(o.properties.captured_at).getTime()<=s)}return n&&(e=e.filter(s=>n.indexOf(s.properties.captured_by)!==-1)),e}renderMarkers(e,r,i){let n=this.getService();if(!n)return;let s=this.scene.groups.get("streetview"),o=n.bubbles(this.context.projection),a=n.sequences(this.context.projection),l=this.filterSequences(a),c=this.filterImages(o);for(let u of l){let d=`${this.layerID}-sequence-${u.properties.id}`,h=this.features.get(d);h||(h=new Rn(this,d),h.geometry.setCoords(u.coordinates),h.style=az,h.parentContainer=s,h.container.zIndex=-100,h.setData(u.properties.id,u)),this.syncFeatureClasses(h),h.update(r,i),this.retainFeature(h,e)}for(let u of c){let d=`${this.layerID}-photo-${u.id}`,h=this.features.get(d);if(!h){let p=Object.assign({},lz);Number.isFinite(u.ca)&&(p.viewfieldAngles=[u.ca]),u.isPano&&(p.viewfieldName="pano"),h=new sr(this,d),h.geometry.setCoords(u.loc),h.style=p,h.parentContainer=s,h.setData(u.id,u),u.sequenceID&&h.addChildData(u.sequenceID,u.id)}this.syncFeatureClasses(h),h.update(r,i),this.retainFeature(h,e)}}render(e,r,i){let n=this.getService();!this.enabled||!n||i<oz||(n.loadBubbles(this.context.projection),this.renderMarkers(e,r,i))}get supported(){return!!this.getService()}};var qC=dt(Ny(),1);var r7=class extends Bt{constructor(e,r){super(e,r),this._enabled=!0,this._loadedUrlData=!1,this._vtService=null,this._geojson={},this._template=null,this._fileList=null,this._src=null,this.setFile=this.setFile.bind(this);function i(n){n.stopPropagation(),n.preventDefault(),n.dataTransfer.dropEffect="copy"}this.context.container().attr("dropzone","copy").on("dragenter.draganddrop",i).on("dragexit.draganddrop",i).on("dragover.draganddrop",i).on("drop.draganddrop",n=>{n.stopPropagation(),n.preventDefault(),this.fileList(n.dataTransfer.files)}),this.context.urlhash().on("hashchange",n=>this.url(n.gpx||"",".gpx"))}getService(){return K.vectorTile&&!this._vtService?this._vtService=K.vectorTile:!K.vectorTile&&this._vtService&&(this._vtService=null),this._vtService}ensureIDs(e){return e?(e.type==="FeatureCollection"?(e.features||[]).forEach(r=>this.ensureFeatureID(r)):this.ensureFeatureID(e),e):null}ensureFeatureID(e){if(e)return e.__featurehash__=Ll((0,qC.default)(e)),e.id||(e.id=e.__featurehash__.toString()),e}getFeatures(e){return e?e.type==="FeatureCollection"?e.features:[e]:[]}isPolygon(e){return e.geometry.type==="Polygon"||e.geometry.type==="MultiPolygon"}getExtension(e){if(!e)return;let r=/\.(gpx|kml|(geo)?json)$/i,i=e.toLowerCase().match(r);return i&&i.length&&i[0]}xmlToDom(e){return new DOMParser().parseFromString(e,"text/xml")}setFile(e,r){this._template=null,this._fileList=null,this._geojson=null,this._src=null;let i;switch(e){case".gpx":i=Td(this.xmlToDom(r));break;case".kml":i=dS(this.xmlToDom(r));break;case".geojson":case".json":i=JSON.parse(r);break}return i=i||{},Object.keys(i).length&&(this._geojson=this.ensureIDs(i),this._src=e+" data file",this.fitZoom()),this}hasData(){let e=this._geojson||{};return!!(this._template||Object.keys(e).length)}render(e,r,i){this.enabled&&this.renderCustomData(e,r,i)}renderCustomData(e,r,i){let n=this.getService(),s,o,a,l;if(this._template&&n){let c=this._template;n.loadTiles(c,this._template,this.context.projection),s=n.data(c,this.context.projection)}else s=this.getFeatures(this._geojson);if(this.hasData()){o=s.filter(u=>u.geometry.type==="Polygon"||u.geometry.type==="MultiPolygon"),a=s.filter(u=>u.geometry.type==="LineString"||u.geometry.type==="MultiLineString"),l=s.filter(u=>u.geometry.type==="Point"||u.geometry.type==="MultiPoint"),this.renderPolygons(e,r,i,o);let c=this.createGridLines(a);this.renderLines(e,r,i,a),this.renderLines(e,r,i,c,{stroke:{width:.5,color:65535,alpha:.5,cap:tt.ROUND}}),this.renderPoints(e,r,i,l)}}createGridLines(e){let r=this.context.imagery().numGridSplits,i=[];if(this.context.rapidContext().isTaskRectangular&&r>0){let n=e[0],s=n.geometry.coordinates.map(p=>p[0]),o=n.geometry.coordinates.map(p=>p[1]),a=Math.min(...s),l=Math.min(...o),c=Math.max(...s),u=Math.max(...o),d=(c-a)/r,h=(u-l)/r;for(let p=1;p<r;p++){let m=a+d*p,g=l+h*p;i.push({type:"Feature",geometry:{type:"LineString",coordinates:[[a,g],[c,g]]},id:r+"gridcol"+p}),i.push({type:"Feature",geometry:{type:"LineString",coordinates:[[m,l],[m,u]]},id:r+"gridrow"+p})}}return i}renderPolygons(e,r,i,n){let s=this.scene.groups.get("basemap"),o={fill:{color:65535,alpha:.3},stroke:{width:2,color:65535,alpha:1,cap:tt.ROUND}};for(let a of n){let l=a.geometry.type==="Polygon"?[a.geometry.coordinates]:a.geometry.type==="MultiPolygon"?a.geometry.coordinates:[];for(let c=0;c<l.length;++c){let u=l[c],d=a.id?a.id:a.__featurehash__.toString(),h=`${this.layerID}-${d}-${c}`,p=this.features.get(h),m=a.v||0;p||(p=new Mo(this,h),p.style=o,p.parentContainer=s),p.v!==m&&(p.v=m,p.geometry.setCoords(u),p.setData(a.id,a)),this.syncFeatureClasses(p),p.update(r,i),this.retainFeature(p,e)}}}renderLines(e,r,i,n,s){let o=this.scene.groups.get("basemap"),a={stroke:{width:2,color:65535,alpha:1,cap:tt.ROUND}},l=s||a;for(let c of n){let u=c.geometry.type==="LineString"?[c.geometry.coordinates]:c.geometry.type==="MultiLineString"?c.geometry.coordinates:[];for(let d=0;d<u.length;++d){let h=u[d],p=c.id?c.id:c.__featurehash__.toString(),m=`${this.layerID}-${p}-${d}`,g=this.features.get(m),y=c.v||0;g||(g=new Rn(this,m),g.style=l,g.parentContainer=o),g.v!==y&&(g.v=y,g.geometry.setCoords(h),g.setData(c.id,c)),this.syncFeatureClasses(g),g.update(r,i),this.retainFeature(g,e)}}}renderPoints(e,r,i,n){let s=this.scene.groups.get("points"),o={markerTint:65535};for(let a of n){let l=a.geometry.type==="Point"?[a.geometry.coordinates]:a.geometry.type==="MultiPoint"?a.geometry.coordinates:[];for(let c=0;c<l.length;++c){let u=l[c],d=`${this.layerID}-${a.id}-${c}`,h=this.features.get(d);h||(h=new sr(this,d),h.geometry.setCoords(u),h.style=o,h.parentContainer=s,h.setData(a.id,a)),this.syncFeatureClasses(h),h.update(r,i),this.retainFeature(h,e)}}}template(e,r){if(!arguments.length)return this._template;let i=this.context.connection();if(i){let n=i.imageryBlocklists(),s=!1,o=0,a;for(let l=0;l<n.length&&(a=n[l],s=a.test(e),o++,!s);l++);o||(a=/.*\.google(apis)?\..*\/(vt|kh)[\?\/].*([xyz]=.*){3}.*/,s=a.test(e))}return this._template=e,this._fileList=null,this._geojson=null,this._src=r||"vectortile:"+e.split(/[?#]/)[0],this}geojson(e,r){return arguments.length?(this._template=null,this._fileList=null,this._geojson=null,this._src=null,e=e||{},Object.keys(e).length&&(this._geojson=this.ensureIDs(e),this._src=r||"unknown.geojson"),this):this._geojson}fileList(e){if(!arguments.length)return this._fileList;if(this._template=null,this._fileList=e,this._geojson=null,this._src=null,!e||!e.length)return this;let r=e[0],i=this.getExtension(r.name),n=this.setFile,s=new FileReader;return s.onload=function(){return function(o){n(i,o.target.result)}}(r),s.readAsText(r),this}url(e,r){this._template=null,this._fileList=null,this._geojson=null,this._src=null;let i=e.split(/[?#]/)[0],n=this.getExtension(i)||r;if(n){this._template=null;let s=this.setFile;R2(e).then(o=>{s(n,o),n===".gpx"&&e.indexOf("project")>0&&e.indexOf("task")>0&&this.context.rapidContext().setTaskExtentByGpxData(o)}).catch(o=>console.error(o))}else this.template(e);return this}getSrc(){return this._src||""}fitZoom(){let e=this.getFeatures(this._geojson);if(!e.length)return;let r=this.context.map(),i=r.trimmedExtent().polygon(),n=e.reduce((s,o)=>{let a=o.geometry;if(!a)return s;let l=a.coordinates;switch(a.type){case"Point":l=[l];case"MultiPoint":case"LineString":break;case"MultiPolygon":l=Y9(l);case"Polygon":case"MultiLineString":l=Y9(l);break}return jt(s,l)},[]);if(!Vf(i,n,!0)){let s=N4({type:"LineString",coordinates:n}),o=new le(s[0],s[1]);r.centerZoom(o.center(),r.trimmedExtentZoom(o))}return this}};function Ju(t){return t instanceof Set?t:new Set(t!==void 0&&[].concat(t))}var i7=class extends xr.default{constructor(e){super(),this.renderer=e,this.context=e.context,this.groups=new Map,this.layers=new Map,this.features=new Map,["background","basemap","points","streetview","qa","labels","blocks","ui"].forEach((r,i)=>{let n=new st;n.name=r,n.sortableChildren=!0,n.zIndex=i,this.renderer.stage.addChild(n),this.groups.set(r,n)}),[new Ku(this,"background"),new Y6(this,"osm"),new J6(this,"rapid"),new V6(this,"mapillary-map-features"),new W6(this,"mapillary-signs"),new r7(this,"custom-data"),new K6(this,"notes"),new G6(this,"improveOSM"),new H6(this,"keepRight"),new Z6(this,"osmose"),new X6(this,"mapillary"),new z6(this,"kartaview"),new t7(this,"streetside"),new j6(this,"labels"),new U6(this,"edit-blocks"),new e7(this,"map-ui")].forEach(r=>this.layers.set(r.id,r))}render(e,r,i){for(let n of this.layers.values())n.render(e,r,i),n.cull(e)}enableLayers(e){for(let r of Ju(e)){let i=this.layers.get(r);i&&(i.enabled=!0)}this.emit("layerchange")}disableLayers(e){for(let r of Ju(e)){let i=this.layers.get(r);i&&(i.enabled=!1)}this.emit("layerchange")}toggleLayers(e){for(let r of Ju(e)){let i=this.layers.get(r);i&&(i.enabled=!i.enabled)}this.emit("layerchange")}onlyLayers(e){let r=Ju(e);for(let i of this.layers.values())i.enabled=r.has(i.id);this.emit("layerchange")}addFeature(e){this.features.set(e.id,e)}removeFeature(e){this.features.delete(e.id)}classData(e,r,i){this.layers.get(e)?.classData(r,i)}unclassData(e,r,i){this.layers.get(e)?.unclassData(e,r,i)}clearClass(e){for(let r of this.layers.values())r.clearClass(e)}dirtyScene(){for(let e of this.features.values())e.dirty=!0}dirtyLayers(e){for(let r of Ju(e))this.layers.get(r)?.dirtyLayer()}dirtyFeatures(e){for(let r of Ju(e)){let i=this.features.get(r);i&&(i.dirty=!0)}}dirtyData(e,r){this.layers.get(e)?.dirtyData(r)}};var n7=class{constructor(e){this.context=e,this.loaded=!1,this._atlasAllocator=new xu,this.textures=new Map;let r=e.assetPath(),i=["maki","temaki","fontawesome","mapillary-features","mapillary-signs"],n={};for(let O of i)n[O]=`${r}img/icons/${O}-spritesheet.json`;da.addBundle("spritesheets",n);let s=["bushes","cemetery","cemetery_buddhist","cemetery_christian","cemetery_jewish","cemetery_muslim","construction","dots","farmland","farmyard","forest","forest_broadleaved","forest_leafless","forest_needleleaved","grass","landfill","lines","orchard","pond","quarry","vineyard","waves","wetland","wetland_bog","wetland_marsh","wetland_reedbed","wetland_swamp"],o={};for(let O of s)o[O]=`${r}img/pattern/${O}.png`;da.addBundle("patterns",o),da.loadBundle(["spritesheets","patterns"]).then(O=>{e._makiSheet=O.spritesheets.maki,e._temakiSheet=O.spritesheets.temaki,e._fontAwesomeSheet=O.spritesheets.fontawesome,e._mapillarySheet=O.spritesheets["mapillary-features"],e._mapillarySignSheet=O.spritesheets["mapillary-signs"];for(let[R,U]of Object.entries(O.patterns))this.textures.set(R,U);e.pixi.rapidTextures=this.textures,this.loaded=!0}).catch(O=>console.error(O));let a={resolution:2},l=new Re(-13,0,26,52),c=new it().lineStyle(1,4473924).beginFill(16777215,.75).moveTo(-2,26).lineTo(2,26).lineTo(12,4).bezierCurveTo(12,0,-12,0,-12,4).closePath().endFill(),u=new it().lineStyle(1,13421772).beginFill(3355443,.75).moveTo(-2,26).lineTo(2,26).lineTo(12,4).bezierCurveTo(12,0,-12,0,-12,4).closePath().endFill(),d=new it().lineStyle(1,13421772).beginFill(16777215,0).moveTo(-2,26).lineTo(2,26).lineTo(12,4).bezierCurveTo(12,0,-12,0,-12,4).closePath().endFill();this.textures.set("viewfield",this.toAtlasTexture(c,{region:l,resolution:3})),this.textures.set("viewfieldDark",this.toAtlasTexture(u,{region:l,resolution:3})),this.textures.set("viewfieldOutline",this.toAtlasTexture(d,{region:l,resolution:3}));let h=new it().lineStyle(1,4473924).beginFill(16777215,.75).drawCircle(0,0,20).endFill(),p=new it().lineStyle(1,13421772).beginFill(3355443,.75).drawCircle(0,0,20).endFill(),m=new it().lineStyle(1,13421772).beginFill(16777215,0).drawCircle(0,0,20).endFill();this.textures.set("pano",this.toAtlasTexture(h,a)),this.textures.set("panoDark",this.toAtlasTexture(p,a)),this.textures.set("panoOutline",this.toAtlasTexture(m,a));let g=new it().lineStyle(1,4473924).beginFill(16777215,1).moveTo(0,0).bezierCurveTo(-2,-2,-8,-10,-8,-15).bezierCurveTo(-8,-19,-4,-23,0,-23).bezierCurveTo(4,-23,8,-19,8,-15).bezierCurveTo(8,-10,2,-2,0,0).closePath().endFill(),y=new it().lineStyle(1.5,6710886).beginFill(14540253,1).moveTo(0,0).bezierCurveTo(-2,-2,-8,-10,-8,-15).bezierCurveTo(-8,-19,-4,-23,0,-23).bezierCurveTo(4,-23,8,-19,8,-15).bezierCurveTo(8,-10,2,-2,0,0).closePath().endFill(),v=new it().lineStyle(1,4473924).beginFill(16777215,1).drawCircle(0,0,8).endFill(),x=new it().lineStyle(1,4473924).beginFill(16777215,1).drawCircle(0,0,6).endFill(),_=new it().lineStyle(1,4473924).beginFill(16777215,1).drawCircle(0,0,4.5).endFill(),b=new it().lineStyle(1,4473924).beginFill(16777215,1).drawCircle(0,0,4.5).beginFill(0,1).drawCircle(0,0,1.5).endFill();this.textures.set("pin",this.toAtlasTexture(g,a)),this.textures.set("boldPin",this.toAtlasTexture(y,a)),this.textures.set("largeCircle",this.toAtlasTexture(v,a)),this.textures.set("mediumCircle",this.toAtlasTexture(x,a)),this.textures.set("smallCircle",this.toAtlasTexture(_,a)),this.textures.set("taggedCircle",this.toAtlasTexture(b,a));let w=new it().lineStyle(1,3355443).beginFill(16777215).moveTo(15,6.5).lineTo(10.8,6.5).bezierCurveTo(12.2,1.3,11.7,.8,11.2,.8).lineTo(6.2,.8).bezierCurveTo(5.8,.7,5.4,1,5.4,1.5).lineTo(4.2,10.2).bezierCurveTo(4.1,10.8,4.6,11.2,5,11.2).lineTo(9.3,11.2).lineTo(7.6,18.3).bezierCurveTo(7.5,18.8,8,19.3,8.5,19.3).bezierCurveTo(8.8,19.3,9.1,19.1,9.2,18.8).lineTo(15.6,7.8).bezierCurveTo(16,7.2,15.6,6.5,15,6.5).endFill().closePath(),E=new it().lineStyle(1,3355443).beginFill(16777215).drawPolygon([16,3,4,3,1,6,1,17,4,20,7,20,10,27,13,20,16,20,19,17.033,19,6]).endFill().closePath(),A=new it().lineStyle(1.5,3355443).beginFill(16777215,1).moveTo(17.5,0).lineTo(2.5,0).bezierCurveTo(1.13,0,0,1.12,0,2.5).lineTo(0,13.75).bezierCurveTo(0,15.12,1.12,16.25,2.5,16.25).lineTo(6.25,16.25).lineTo(6.25,19.53).bezierCurveTo(6.25,19.91,6.68,20.13,7,19.9).lineTo(11.87,16.25).lineTo(17.49,16.25).bezierCurveTo(18.86,16.25,20,15.12,20,13.75).lineTo(20,2.5).bezierCurveTo(20,1.13,18.87,0,17.5,0).closePath().endFill(),T=new it().lineStyle(1,3355443).beginFill(16777215).drawPolygon([16,3,4,3,1,6,1,17,4,20,7,20,10,27,13,20,16,20,19,17.033,19,6]).endFill().closePath();this.textures.set("keepright",this.toAtlasTexture(w,a)),this.textures.set("improveosm",this.toAtlasTexture(E,a)),this.textures.set("osmnote",this.toAtlasTexture(A,a)),this.textures.set("osmose",this.toAtlasTexture(T,a));let k=new it().lineStyle(1,4473924).beginFill(16777215,1).drawPolygon([-3,4,7,0,-3,-4]).endFill(),C=new it().beginFill(16777215,1).drawPolygon([5,3,0,3,0,2,5,2,5,0,10,2.5,5,5]).endFill(),I=new it().beginFill(16777215,1).drawPolygon([0,5,5,0,0,-5]).endFill();this.textures.set("midpoint",this.toAtlasTexture(k,a)),this.textures.set("oneway",this.toAtlasTexture(C,a)),this.textures.set("sided",this.toAtlasTexture(I,a));let P=new it().lineStyle(2,16777215).moveTo(0,0).lineTo(4,0);this.textures.set("stripe",this.toAtlasTexture(P,{region:new Re(0,0,4,4),resolution:2}));let N=new it().lineStyle(1,16777215).beginFill(16777215,.6).drawRect(-5,-5,10,10).endFill(),M=new it().lineStyle(1,16777215).beginFill(16777215,.6).drawPolygon([-5,-5,5,-5,5,5,1,5,1,1,-5,1,-5,-5]).endFill(),D=new it().lineStyle(1,16777215).beginFill(16777215,.6).drawCircle(0,0,5).endFill();this.textures.set("lowres-square",this.toAtlasTexture(N,a)),this.textures.set("lowres-ell",this.toAtlasTexture(M,a)),this.textures.set("lowres-circle",this.toAtlasTexture(D,a));let F=new it().lineStyle(1,16777215).beginFill(0,0).drawRect(-5,-5,10,10).endFill(),L=new it().lineStyle(1,16777215).beginFill(0,0).drawPolygon([-5,-5,5,-5,5,5,1,5,1,1,-5,1,-5,-5]).endFill(),B=new it().lineStyle(1,16777215).beginFill(0,0).drawCircle(0,0,5).endFill();this.textures.set("lowres-unfilled-square",this.toAtlasTexture(F,a)),this.textures.set("lowres-unfilled-ell",this.toAtlasTexture(L,a)),this.textures.set("lowres-unfilled-circle",this.toAtlasTexture(B,a))}toAtlasTexture(e,r){let i=this.context.pixi.renderer,n=i.generateTexture(e,r),s=n.baseTexture;if(s.format!==Ce.RGBA||s.type!==Ge.UNSIGNED_BYTE)return;let o=s.framebuffer;if(!o)return n;let a=o.width,l=o.height,c=new Uint8Array(a*l*4),u=i.context.gl,d=o.glFramebuffers[1],h=d&&d.framebuffer;if(!u||!h)return n;u.bindFramebuffer(u.FRAMEBUFFER,h),u.readPixels(0,0,a,l,s.format,s.type,c);let p=1,m=this._atlasAllocator.allocate(a,l,p,c);return m.orig=n.orig.clone(),n.destroy(!0),m}};var Dy,cz=250,s7=class extends xr.default{constructor(e,r,i,n){super(),this.context=e,this.supersurface=r,this.surface=i,this.overlay=n,this._frame=0,this._timeToNextRender=0,this._appPending=!1,this._drawPending=!1,this.pixiProjection=new Qi,this._transformDraw=null,this._isTransformed=!1,this._transformEase=null,this._tick=this._tick.bind(this),this._onHoverChange=this._onHoverChange.bind(this),this._onSelectChange=this._onSelectChange.bind(this),Le.defaultOptions.mipmap=oi.OFF,ue.PREFER_ENV=en.WEBGL2,this.pixi=new _1({antialias:!0,autoDensity:!0,autoStart:!1,events:{move:!1,globalMove:!1,click:!0,wheel:!1},resizeTo:r.node(),resolution:window.devicePixelRatio,sharedLoader:!0,sharedTicker:!0,view:i.node()}),globalThis.__PIXI_APP__=this.pixi,e.pixi=this.pixi,Lr.from("debug",{fill:16777215,fontSize:14,stroke:3355443,strokeThickness:2},{chars:Lr.ASCII,padding:0,resolution:2});let s=this.pixi.ticker,o=s._head.next;s.remove(o.fn,o.context),s.add(this._tick,this),s.start();let a=this.pixi.stage;a.name="stage",a.sortableChildren=!0,a.eventMode="static",a.hitArea=new Re(-1e5,-1e5,2e5,2e5),this.stage=a,this.scene=new i7(this),this.events=new t6(this),Dy||(Dy=new n7(e)),this.textures=Dy,e.on("enter.PixiRenderer",this._onSelectChange),e.behaviors.get("hover").on("hoverchanged",this._onHoverChange)}_onSelectChange(){let e=Array.from(this.context.selectedIDs()),r=this.context.selectedData();this.scene.clearClass("selected");for(let i of e){let n;if(i){let s=r.get(i);s?s?.__fbid__&&(n="rapid"):n="osm"}n&&i&&this.scene.classData(n,i,"selected")}this.render()}_onHoverChange(e){let r=e.target,i=r?.layerID,n=r?.dataID,s=r?.data;this.context.mode()?.id!=="select"&&this.context.ui().sidebar.hover(s?[s]:[]),this.scene.clearClass("hovered"),i&&n&&this.scene.classData(i,n,"hovered"),this.render()}_tick(){let e=this.pixi.ticker;if(this._drawPending){let r=this._frame,i=`draw-${r}-start`,n=`draw-${r}-end`;window.performance.mark(i),this._draw(),window.performance.mark(n),window.performance.measure(`draw-${r}`,i,n);return}if(this._tform(),this._appPending){if(this._timeToNextRender-=e.deltaMS,this._timeToNextRender>=0)return;{let r=this._frame,i=`app-${r}-start`,n=`app-${r}-end`;window.performance.mark(i),this._app(),window.performance.mark(n),window.performance.measure(`app-${r}`,i,n);return}}}deferredRender(){this._appPending=!0}render(){this._timeToNextRender=0,this._appPending=!0}setTransformAsync(e,r=0){let i=window.performance.now(),n=this.context.projection.transform(),s;if(this._transformEase&&(this.context.projection.transform(n),this._transformEase.resolve(n),this._transformEase=null),r>0){let o;s=new Promise(a=>{o=a}),this._transformEase={time0:i,time1:i+r,xform0:n,xform1:e,promise:s,resolve:o}}else this.context.projection.transform(e),s=Promise.resolve(e);return this._appPending=!0,s}resize(e,r){this.pixi.renderer.resize(e,r),this._appPending=!0}_tform(){if(this._drawPending)return;if(this._transformEase){let{time0:n,time1:s,xform0:o,xform1:a,resolve:l}=this._transformEase,[c,u,d]=[o.x,o.y,o.k],[h,p,m]=[a.x,a.y,a.k],g=window.performance.now(),y=Math.max(0,Math.min(1,(g-n)/(s-n))),v=c+(h-c)*y,x=u+(p-u)*y,_=d+(m-d)*y,b={x:v,y:x,k:_};this.context.projection.transform(b),y===1&&(l(b),this._transformEase=null),this._appPending=!0}let e=this.context.projection.transform(),r=this._transformDraw;if(!r)return;if(this._isTransformed||r.x!==e.x||r.y!==e.y||r.k!==e.k){let n=e.k/r.k,s=(e.x/n-r.x)*n,o=(e.y/n-r.y)*n;As(this.supersurface,s,o,n),As(this.overlay,-s,-o),this._isTransformed=!0,this.emit("move")}}_app(){if(!this.textures?.loaded)return;let e=this.context,r=this.pixiProjection,i=e.projection.transform(),n=r.transform(),s=e.map().effectiveZoom(),o;n.k!==i.k?(o=[0,0],r.transform(i),this.scene.dirtyScene()):o=[n.x-i.x,n.y-i.y],this.pixi.stage.position.set(-o[0],-o[1]),this.scene.render(this._frame,r,s),this._appPending=!1,this._drawPending=!0}_draw(){this.pixi.render(),this._transformDraw=this.context.projection.transform(),this._timeToNextRender=cz,this._isTransformed&&(As(this.supersurface,0,0),As(this.overlay,0,0),this._isTransformed=!1,this.emit("move")),this._drawPending=!1,this.emit("draw"),this._frame++}};function uz(t,e){var r=e.getBoundingClientRect(),i=[r.width,r.height];return t.property("__dimensions__",i),i}function io(t,e){if(!t||t.empty())return[0,0];var r=t.node(),i=t.property("__dimensions__");return!i||e?uz(t,r):i}var f5=256,Fy=2,o7=24,YC=di(Fy,f5),QC=di(o7,f5);function Po(t,e,r){return Math.max(e,Math.min(t,r))}var e4=class extends xr.default{constructor(e){super(),this.context=e,this.supersurface=H(null),this.surface=H(null),this.overlay=H(null),this.redrawEnabled=!0,this.areaFillOptions=["wireframe","partial","full"],this._highlightEdits=!1,this._currFillMode=ee("area-fill")||"partial",this._toggleFillMode=ee("area-fill-toggle")||"partial",this._renderer=null,this._dimensions=[1,1],this._hashchange=this._hashchange.bind(this),this._updateHash=this._updateHash.bind(this),this.render=this.render.bind(this),this.immediateRedraw=this.immediateRedraw.bind(this),this.deferredRedraw=this.deferredRedraw.bind(this)}init(){}render(e){let r=this.context;e.on("contextmenu",a=>a.preventDefault()).on("wheel.map mousewheel.map",a=>a.preventDefault()),this.supersurface=e.append("div").attr("class","supersurface"),this.surface=this.supersurface.append("canvas").attr("class","surface"),this.overlay=this.supersurface.append("div").attr("class","overlay"),this._renderer=new s7(r,this.supersurface,this.surface,this.overlay),this._renderer.on("move",()=>this.emit("move")).on("draw",()=>{this._updateHash(),this.emit("draw",{full:!0})}),this.dimensions=io(e);let i=this._renderer.scene,n=this;function s(a){let l=r.mode().id;l!=="browse"&&l!=="select"||a&&n.transformEase(a)}r.history().on("merge",a=>{a&&i.dirtyData("osm",a),this.deferredRedraw()}).on("change",a=>{if(a){let l=a.complete(),c=r.features();for(let u of l.values())u&&(u.touch(),c.clearEntity(u))}this.immediateRedraw()}).on("undone.map",(a,l)=>s(l.transform)).on("redone.map",a=>s(a.transform)),r.features().on("change",()=>{i.dirtyLayers("osm"),this.immediateRedraw()}),r.imagery().on("imagerychange",this.immediateRedraw),r.photos().on("photochange",this.immediateRedraw),r.urlhash().on("hashchange",this._hashchange);let o=r.connection();o&&o.on("change",this.immediateRedraw),i.on("layerchange",()=>{r.imagery().updateImagery(),this.immediateRedraw()})}_hashchange(e){let r,i,n,s;typeof e.map=="string"&&([r,i,n,s]=e.map.split("/",4).map(Number)),(isNaN(r)||!isFinite(r))&&(r=2),(isNaN(i)||!isFinite(i))&&(i=0),(isNaN(n)||!isFinite(n))&&(n=0),(isNaN(s)||!isFinite(s))&&(s=0),r=Po(r,2,24),i=Po(i,-90,90),n=Po(n,-180,180),s=Po(s,0,360),this.centerZoom([n,i],r)}_updateHash(){let[e,r]=this.center(),i=this.zoom(),n=0,s=Math.max(0,Math.ceil(Math.log(i)/Math.LN2)),o=.1;if(isNaN(i)||!isFinite(i)||isNaN(r)||!isFinite(r)||isNaN(e)||!isFinite(e)||isNaN(n)||!isFinite(n))return;let a=i.toFixed(2),l=r.toFixed(s),c=e.toFixed(s),u=n.toFixed(1),d=`${a}/${l}/${c}`;Math.abs(n)>o&&(d+=`/${u}`),this.context.urlhash().setParam("map",d)}deferredRedraw(){this.redrawEnabled&&this._renderer.deferredRender()}immediateRedraw(){this.redrawEnabled&&this._renderer.render()}get dimensions(){return this._dimensions}set dimensions(e){let[r,i]=e;this._dimensions=e,this.context.projection.dimensions([[0,0],[r,i]]),this._renderer.resize(r,i)}centerPoint(){return Yi(this._dimensions,.5)}mouse(){return this._renderer.events.coord}mouseLoc(){let e=this.mouse()||this.centerPoint();return this.context.projection.invert(e)}transform(e,r){return e===void 0?this.context.projection.transform():(r===void 0&&(r=0),this._renderer.setTransformAsync(e,r),this)}setTransformAsync(e,r=0){return this._renderer.setTransformAsync(e,r)}centerZoom(e,r,i=0){let n=this.center(),s=this.zoom();if(e[0]===n[0]&&e[1]===n[1]&&r===s)return this;let o=Po(di(r,f5),YC,QC),a=new Qi;a.transform(this.context.projection.transform()),a.scale(o);let l=a.translate(),c=a.project(e),u=this.centerPoint(),d=St(u,c);return l=Ot(l,d),this.transform({x:l[0],y:l[1],k:o},i)}setCenterZoomAsync(e,r,i=0){let n=this.center(),s=this.zoom();if(e[0]===n[0]&&e[1]===n[1]&&r===s)return new Promise.resolve(this.context.projection.transform());let o=Po(di(r,f5),YC,QC),a=new Qi;a.transform(this.context.projection.transform()),a.scale(o);let l=a.translate(),c=a.project(e),u=this.centerPoint(),d=St(u,c);return l=Ot(l,d),this.setTransformAsync({x:l[0],y:l[1],k:o},i)}center(e,r){return e===void 0?this.context.projection.invert(this.centerPoint()):(r===void 0&&(r=0),e[0]=Po(e[0]||0,-180,180),e[1]=Po(e[1]||0,-90,90),this.centerZoom(e,this.zoom(),r))}zoom(e,r){return e===void 0?Math.max(0,xn(this.context.projection.scale(),f5)):(r===void 0&&(r=0),e=Po(e||0,Fy,o7),this.centerZoom(this.center(),e,r))}pan(e,r=0){let i=this.context.projection.transform();return this.transform({x:i.x+e[0],y:i.y+e[1],k:i.k},r)}zoomTo(e,r=0){let i;if(Array.isArray(e)?i=vt(e,this.context.graph()):i=e.extent(this.context.graph()),!isFinite(i.area()))return this;let n=Po(this.trimmedExtentZoom(i),0,20);return this.centerZoom(i.center(),n,r)}_zoomIn(e){return this.centerZoom(this.center(),~~this.zoom()+e,250)}_zoomOut(e){return this.centerZoom(this.center(),~~this.zoom()-e,250)}zoomIn(){return this._zoomIn(1)}zoomInFurther(){return this._zoomIn(4)}canZoomIn(){return this.zoom()<o7}zoomOut(){return this._zoomOut(1)}zoomOutFurther(){return this._zoomOut(4)}canZoomOut(){return this.zoom()>Fy}transformEase(e,r=250){return this.transform(e,r)}centerZoomEase(e,r,i=250){return this.centerZoom(e,r,i)}centerEase(e,r=250){return this.center(e,r)}zoomEase(e,r=250){return this.zoom(e,r)}zoomToEase(e,r=250){return this.zoomTo(e,r)}effectiveZoom(){let e=this.center()[1],r=this.zoom(),i=fi(1,e),n=fi(1,0),s=Math.log(i/n)/Math.LN2;return Math.min(r+s,o7)}extent(e){return e===void 0?new le(this.context.projection.invert([0,this._dimensions[1]]),this.context.projection.invert([this._dimensions[0],0])):this.centerZoom(e.center(),this.extentZoom(e))}trimmedExtent(e){return e===void 0?new le(this.context.projection.invert([10,this._dimensions[1]-30-10]),this.context.projection.invert([this._dimensions[0]-10,71+10])):this.centerZoom(e.center(),this.trimmedExtentZoom(e))}extentZoom(e,r){let[i,n]=r||this._dimensions,s=this.context.projection.project([e.min[0],e.max[1]]),o=this.context.projection.project([e.max[0],e.min[1]]),a=(o[0]-s[0])/i,l=(o[1]-s[1])/n,c=Math.log(Math.abs(a))/Math.LN2,u=Math.log(Math.abs(l))/Math.LN2,d=Math.max(c,u),h=this.zoom(),p=Math.max(h,19);return isFinite(d)?h-d:p}trimmedExtentZoom(e){let n=St(this._dimensions,[40,140]);return this.extentZoom(e,n)}get highlightEdits(){return this._highlightEdits}set highlightEdits(e){this._highlightEdits!==e&&(this._highlightEdits=e,this._renderer.scene.dirtyScene(),this.immediateRedraw(),this.emit("mapchange"))}get areaFillMode(){return this._currFillMode}set areaFillMode(e){let r=this._currFillMode;r!==e&&(r!=="wireframe"&&(this._toggleFillMode=r,ee("area-fill-toggle",r)),this._currFillMode=e,ee("area-fill",e),this._renderer.scene.dirtyScene(),this.immediateRedraw(),this.emit("mapchange"))}get wireframeMode(){return this._currFillMode==="wireframe"}set wireframeMode(e){e?this.areaFillMode!=="wireframe"&&(this.areaFillMode="wireframe"):this.areaFillMode=this._toggleFillMode}get scene(){return this._renderer.scene}get renderer(){return this._renderer}};var t4=class extends xr.default{constructor(e){super(),this.context=e,this._LAYERIDS=["streetside","mapillary","mapillary-map-features","mapillary-signs","kartaview"],this._PHOTOTYPES=["flat","panoramic"],this._DATEFILTERS=["fromDate","toDate"],this._shownPhotoTypes=new Set(this._PHOTOTYPES),this._fromDate=null,this._toDate=null,this._usernames=null,this._currLayerID=null,this._currPhotoID=null,this._hashchange=this._hashchange.bind(this),this._updateHash=this._updateHash.bind(this)}init(){let e=this.context;e.scene().on("layerchange",this._updateHash),e.urlhash().on("hashchange",this._hashchange)}_hashchange(e){let i=this.context.scene(),n=new Set;typeof e.photo_overlay=="string"&&(n=new Set(e.photo_overlay.replace(/;/g,",").split(",")));for(let s of this._LAYERIDS){let o=i.layers.get(s);o&&(o.enabled=n.has(o.id))}if(typeof e.photo_dates=="string"){let s=/^(.*)[_](.*)$/g.exec(e.photo_dates.trim());this.setDateFilter("fromDate",s&&s.length>=2&&s[1]),this.setDateFilter("toDate",s&&s.length>=3&&s[2])}else this._toDate=this._fromDate=null;if(this.setUsernameFilter(e.photo_username),typeof e.photo=="string"){let s=e.photo.replace(/;/g,",").split(","),o=s.length&&s[0].trim(),a=/(.*)\/(.*)/g.exec(o);if(a&&a.length>=3){let l=a[1],c=a[2];this.selectPhoto(l,c)}}}_updateHash(){let e=this.context.urlhash(),r=this.context.scene(),i=[];for(let o of this._LAYERIDS){let a=r.layers.get(o);a&&a.supported&&a.enabled&&i.push(o)}e.setParam("photo_overlay",i.length?i.join(","):null);let n;this._currLayerID&&this._currPhotoID&&(n=`${this._currLayerID}/${this._currPhotoID}`),e.setParam("photo",n);let s;(this._fromDate||this._toDate)&&(s=(this._fromDate||"")+"_"+(this._toDate||"")),e.setParam("photo_dates",s),e.setParam("photo_username",this._usernames?this._usernames.join(","):null)}get overlayLayerIDs(){return this._LAYERIDS}get allPhotoTypes(){return this._PHOTOTYPES}get dateFilters(){return this._DATEFILTERS}get fromDate(){return this._fromDate}get toDate(){return this._toDate}get usernames(){return this._usernames}selectPhoto(e=null,r=null){if(e===this._currLayerID&&r===this._currPhotoID)return;this._currLayerID=e,this._currPhotoID=r;let i=this.context,n=i.scene();if(n.clearClass("selected"),e&&r){let s=K[e];if(!s||!s.loadViewerAsync)return null;n.enableLayers(e),n.classData(e,r,"selected"),s.loadViewerAsync(i).then(()=>{s.selectImage(i,r),s.showViewer(i)})}this._updateHash(),this.emit("photochange")}dateFilterValue(e){return e==="fromDate"?this._fromDate:e==="toDate"?this._toDate:null}setDateFilter(e,r){let i=r&&new Date(r);i&&!isNaN(i)?r=i.toISOString().slice(0,10):r=null;let n=!1;e==="fromDate"&&(this._fromDate=r,n=!0,this._fromDate&&this._toDate&&new Date(this._toDate)<new Date(this._fromDate)&&(this._toDate=this._fromDate)),e==="toDate"&&(this._toDate=r,n=!0,this._fromDate&&this._toDate&&new Date(this._toDate)<new Date(this._fromDate)&&(this._fromDate=this._toDate)),n&&(this._updateHash(),this.emit("photochange"))}setUsernameFilter(e){e&&typeof e=="string"&&(e=e.replace(/;/g,",").split(",")),e&&(e=e.map(r=>r.trim()).filter(Boolean),e.length||(e=null)),this._usernames=e,this._updateHash(),this.emit("photochange")}togglePhotoType(e){this._PHOTOTYPES.includes(e)&&(this._shownPhotoTypes.has(e)?this._shownPhotoTypes.delete(e):this._shownPhotoTypes.add(e),this.emit("photochange"))}_showsLayer(e){let r=this.context.scene().layers.get(e);return r&&r.enabled}shouldFilterByDate(){return this._showsLayer("mapillary")||this._showsLayer("kartaview")||this._showsLayer("streetside")}shouldFilterByPhotoType(){return this._showsLayer("mapillary")||this._showsLayer("streetside")&&this._showsLayer("kartaview")}shouldFilterByUsername(){return!this._showsLayer("mapillary")&&this._showsLayer("kartaview")&&!this._showsLayer("streetside")}showsPhotoType(e){return this.shouldFilterByPhotoType()?this._shownPhotoTypes.has(e):!0}showsFlat(){return this.showsPhotoType("flat")}showsPanoramic(){return this.showsPhotoType("panoramic")}};function a7(t){var e=fe("change"),r=ge({},e,"on"),i=new Set,n={motorway:!0,motorway_link:!0,trunk:!0,trunk_link:!0,primary:!0,primary_link:!0,secondary:!0,secondary_link:!0,tertiary:!0,tertiary_link:!0,residential:!0,unclassified:!0,living_street:!0},s={busway:!0,service:!0,road:!0,track:!0},o={path:!0,footway:!0,cycleway:!0,bridleway:!0,steps:!0,pedestrian:!0},a=1,l={},c={},u={},d=[],h=[],p={};function m(x){let _=new Set;typeof x.disable_features=="string"&&(_=new Set(x.disable_features.replace(/;/g,",").split(",")));let b=!1;for(let w in c)c[w].enabled&&_.has(w)?(c[w].disable(),b=!0):!c[w].enabled&&!_.has(w)&&(c[w].enable(),b=!0);b&&g()}function g(){let x=r.disabled().join(",");t.urlhash().setParam("disable_features",x.length?x:null),ee("disabled-features",x),h=r.hidden(),e.call("change")}function y(x,_,b){var w=!0;d.push(x),c[x]={filter:_,enabled:w,count:0,currentMax:b||1/0,defaultMax:b||1/0,enable:function(){this.enabled=!0,this.currentMax=this.defaultMax},disable:function(){this.enabled=!1,this.currentMax=0},hidden:function(){return this.count===0&&!this.enabled||this.count>this.currentMax*a},autoHidden:function(){return this.hidden()&&this.currentMax>0}}}y("points",function(_,b){return b==="point"},200),y("traffic_roads",function(_){return n[_.highway]}),y("service_roads",function(_){return s[_.highway]}),y("paths",function(_){return o[_.highway]}),y("buildings",function(_){return!!_.building&&_.building!=="no"||_.parking==="multi-storey"||_.parking==="sheds"||_.parking==="carports"||_.parking==="garage_boxes"},250),y("building_parts",function(_){return _["building:part"]}),y("indoor",function(_){return _.indoor}),y("landuse",function(_,b){return b==="area"&&!c.buildings.filter(_)&&!c.building_parts.filter(_)&&!c.indoor.filter(_)&&!c.water.filter(_)&&!c.pistes.filter(_)}),y("boundaries",function(_){return!!_.boundary&&!(n[_.highway]||s[_.highway]||o[_.highway]||_.waterway||_.railway||_.landuse||_.natural||_.building||_.power)}),y("water",function(_){return!!_.waterway||_.natural==="water"||_.natural==="coastline"||_.natural==="bay"||_.landuse==="pond"||_.landuse==="basin"||_.landuse==="reservoir"||_.landuse==="salt_pond"}),y("rail",function(_){return(!!_.railway||_.landuse==="railway")&&!(n[_.highway]||s[_.highway]||o[_.highway])}),y("pistes",function(_){return _["piste:type"]}),y("aerialways",function(_){return _.aerialway&&_.aerialway!=="yes"&&_.aerialway!=="station"}),y("power",function(_){return!!_.power}),y("past_future",function(_){if(n[_.highway]||s[_.highway]||o[_.highway])return!1;for(var b=Object.keys(_),w=0;w<b.length;w++){var E=b[w];if(Oa[E]||Oa[_[E]])return!0}return!1}),y("others",function(_,b){return b==="line"||b==="area"}),r.features=function(){return c},r.keys=function(){return d},r.enabled=function(x){return arguments.length?c[x]&&c[x].enabled:d.filter(function(_){return c[_].enabled})},r.disabled=function(x){return arguments.length?c[x]&&!c[x].enabled:d.filter(function(_){return!c[_].enabled})},r.hidden=function(x){return arguments.length?c[x]&&c[x].hidden():d.filter(function(_){return c[_].hidden()})},r.autoHidden=function(x){return arguments.length?c[x]&&c[x].autoHidden():d.filter(function(_){return c[_].autoHidden()})},r.enable=function(x){c[x]&&!c[x].enabled&&(c[x].enable(),g())},r.enableAll=function(){var x=!1;for(var _ in c)c[_].enabled||(x=!0,c[_].enable());x&&g()},r.disable=function(x){c[x]&&c[x].enabled&&(c[x].disable(),g())},r.disableAll=function(){var x=!1;for(var _ in c)c[_].enabled&&(x=!0,c[_].disable());x&&g()},r.toggle=function(x){c[x]&&(function(_){return _.enabled?_.disable():_.enable()}(c[x]),g())},r.resetStats=function(){for(var x=0;x<d.length;x++)c[d[x]].count=0;e.call("change")},r.gatherStats=function(x,_,b){var w=!1,E=yr(x,"type"),A=[].concat(E.relation||[],E.way||[],E.node||[]),T,k,C,I,P;for(I=0;I<d.length;I++)c[d[I]].count=0;for(a=b[0]*b[1]/1e6,I=0;I<A.length;I++)for(k=A[I].geometry(_),C=Object.keys(r.getMatches(A[I],_,k)),P=0;P<C.length;P++)c[C[P]].count++;return T=r.hidden(),T!==h&&(h=T,w=!0,e.call("change")),w},r.stats=function(){for(var x=0;x<d.length;x++)u[d[x]]=c[d[x]].count;return u},r.clear=function(x){for(var _=0;_<x.length;_++)r.clearEntity(x[_])},r.clearEntity=function(x){delete l[Te.key(x)]},r.reset=function(){Array.from(i).forEach(function(x){window.cancelIdleCallback(x),i.delete(x)}),l={}};function v(x){return x.tags.type==="boundary"}return r.getMatches=function(x,_,b){if(b==="vertex"||b==="relation"&&!v(x))return{};var w=Te.key(x);if(l[w]||(l[w]={}),!l[w].matches){for(var E={},A=!1,T=0;T<d.length;T++){if(d[T]==="others"){if(A)continue;if(x.type==="way"){var k=r.getParents(x,_,b);if(k.length===1&&k[0].isMultipolygon()||k.length>0&&k.every(function(I){return I.tags.type==="boundary"})){var C=Te.key(k[0]);if(l[C]&&l[C].matches){E=Object.assign({},l[C].matches);continue}}}}c[d[T]].filter(x.tags,b)&&(E[d[T]]=A=!0)}l[w].matches=E}return l[w].matches},r.getParents=function(x,_,b){if(b==="point")return[];var w=Te.key(x);if(l[w]||(l[w]={}),!l[w].parents){var E=[];b==="vertex"?E=_.parentWays(x):E=_.parentRelations(x),l[w].parents=E}return l[w].parents},r.isHiddenPreset=function(x,_){if(!h.length||!x.tags)return!1;var b=x.setTags({},_);for(var w in c)if(c[w].filter(b,_))return h.indexOf(w)!==-1?w:!1;return!1},r.isHiddenFeature=function(x,_,b){if(!h.length||!x.version||p[x.id])return!1;var w=Object.keys(r.getMatches(x,_,b));return w.length&&w.every(function(E){return r.hidden(E)})},r.isHiddenChild=function(x,_,b){if(!h.length||!x.version||b==="point"||p[x.id])return!1;var w=r.getParents(x,_,b);if(!w.length)return!1;for(var E=0;E<w.length;E++)if(!r.isHidden(w[E],_,w[E].geometry(_)))return!1;return!0},r.hasHiddenConnections=function(x,_){if(!h.length)return!1;var b,w;return x.type==="midpoint"?(b=[_.entity(x.edge[0]),_.entity(x.edge[1])],w=[]):(b=x.nodes?_.childNodes(x):[],w=r.getParents(x,_,x.geometry(_))),w=b.reduce(function(E,A){return _.isShared(A)?jt(E,_.parentWays(A)):E},w),w.some(function(E){return r.isHidden(E,_,E.geometry(_))})},r.isHidden=function(x,_,b){if(!h.length||!x.version)return!1;var w=b==="vertex"?r.isHiddenChild:r.isHiddenFeature;return w(x,_,b)},r.filter=function(x,_){if(!h.length)return x;for(var b=[],w=0;w<x.length;w++){var E=x[w];r.isHidden(E,_,E.geometry(_))||b.push(E)}return b},r.forceVisible=function(x){if(!arguments.length)return Object.keys(p);p={};for(var _=0;_<x.length;_++){p[x[_]]=!0;var b=t.hasEntity(x[_]);if(b&&b.type==="relation")for(var w in b.members)p[b.members[w].id]=!0}return r},r.init=function(){var x=ee("disabled-features");if(x){var _=x.replace(/;/g,",").split(",");_.forEach(r.disable)}t.urlhash().on("hashchange",m)},r}function l7(t){let e=["rapid-sprite","maki-sprite","temaki-sprite","fa-sprite","community-sprite"];function r(i){i.selectAll("defs").data([0]).enter().append("defs").selectAll(".spritesheet").data(e).enter().append("g").attr("class",s=>`spritesheet spritesheet-${s}`).each((s,o,a)=>{let l=t.imagePath(`${s}.svg`),c=a[o];Fp(l).then(u=>{c.appendChild(H(u.documentElement).attr("id",s).node()),s!=="rapid-sprite"&&H(c).selectAll("path").attr("fill","currentColor")}).catch(u=>console.error(u))})}return r}function c7(t){let e=t.connection();function r(s){e&&(e.authenticated()?e.userDetails((o,a)=>i(s,a)):i(s,null))}function i(s,o){let a=s.select(".userInfo"),l=s.select(".loginLogout");if(o){a.html("").classed("hide",!1);let c=a.append("a").attr("href",e.userURL(o.display_name)).attr("target","_blank");o.image_url?c.append("img").attr("class","icon pre-text user-icon").attr("src",o.image_url):c.call(Z("#rapid-icon-avatar","pre-text light")),c.append("span").attr("class","label").html(o.display_name),l.classed("hide",!1).select("a").text(S("logout")).on("click",u=>{u.preventDefault(),e.logout(),n()})}else a.html("").classed("hide",!0),l.classed("hide",!1).select("a").text(S("login")).on("click",c=>{c.preventDefault(),e.authenticate()})}function n(){if(!e)return;let s=e.getUrlRoot()+"/logout?referer=%2Flogin",o=600,a=550,l=[["width",o],["height",a],["left",window.screen.width/2-o/2],["top",window.screen.height/2-a/2]].map(c=>c.join("=")).join(",");window.open(s,"_blank",l)}return function(s){e&&(s.append("li").attr("class","userInfo").classed("hide",!0),s.append("li").attr("class","loginLogout").classed("hide",!0).append("a").attr("href","#"),e.on("change.account",()=>r(s)),r(s))}}function u7(t){let e=H(null);function r(n,s,o){let a=n.selectAll(`.${o}`).data([0]);a=a.enter().append("div").attr("class",o).merge(a);let l=a.selectAll(".attribution").data(s,u=>u.id);l.exit().remove(),l=l.enter().append("span").attr("class","attribution").each((u,d,h)=>{let p=H(h[d]);if(u.terms_html){p.html(u.terms_html);return}u.terms_url&&(p=p.append("a").attr("href",u.terms_url).attr("target","_blank"));let m=S(`imagery.${u.idtx}.attribution.text`,{default:u.terms_text||u.id||u.name});u.icon&&!u.overlay&&p.append("img").attr("class","source-image").attr("src",u.icon),p.append("span").attr("class","attribution-text").html(m)}).merge(l);let c=l.selectAll(".copyright-notice").data(u=>{let d=u.copyrightNotices(t.map().zoom(),t.map().extent());return d?[d]:[]});c.exit().remove(),c=c.enter().append("span").attr("class","copyright-notice").merge(c),c.html(String)}function i(){let n=t.imagery().baseLayerSource();e.call(r,n?[n]:[],"base-layer-attribution");let s=t.map().zoom(),o=t.imagery().overlayLayerSources()||[];e.call(r,o.filter(a=>a.validZoom(s)),"overlay-layer-attribution")}return function(n){e=n,t.imagery().on("change.attribution",i),t.map().on("draw",Sn(i,400,{leading:!1})),i()}}function f7(t){var e=t.connection(),r=Gt(function(){o()},1e3),i=4,n=!1,s=H(null);function o(){if(e){var a={},l=t.history().intersects(t.map().extent());l.forEach(function(m){m&&m.user&&(a[m.user]=!0)});var c=Object.keys(a),u=c.slice(0,c.length>i?i-1:i);s.html("").call(Z("#rapid-icon-nearby","pre-text light"));var d=H(document.createElement("span"));if(d.selectAll().data(u).enter().append("a").attr("class","user-link").attr("href",function(m){return e.userURL(m)}).attr("target","_blank").html(String),c.length>i){var h=H(document.createElement("span")),p=c.length-i+1;h.append("a").attr("target","_blank").attr("href",function(){return e.changesetsURL(t.map().center(),t.map().zoom())}).html(p),s.append("span").html(S.html("contributors.truncated_list",{n:p,users:d.html(),count:h.html()}))}else s.append("span").html(S.html("contributors.list",{users:d.html()}));c.length?n&&s.transition().style("opacity",1):(n=!0,s.transition().style("opacity",0))}}return function(a){e&&(s=a,o(),e.on("loaded.contributors",r),t.map().on("draw",r))}}function d7(t){let e=fe("toggled"),r=85,i=45,n=35,s=10,o=4,a=210,l=H(null),c=[],u=[0,0],d=0,h="",p=!1,m,g,y=[],v=function(_){h===void 0&&(h="rightclick");let b=h.includes("touch")||h.includes("pen"),w=c.filter(N=>!b||!N.mouseOnly);if(!w.length)return;y=[],p=b;let E=!0,A=E?32:34;E?g=52+Math.min(120,6*Math.max.apply(Math,w.map(function(N){return N.title.length}))):g=44,m=o*2+w.length*A,d=t.projection.scale(),l=_.append("div").attr("class","edit-menu").classed("touch-menu",b).style("padding",o+"px 0");let T=l.selectAll(".edit-menu-item").data(w),k=T.enter().append("button").attr("class",N=>`edit-menu-item edit-menu-item-${N.id}`).style("height",`${A}px`).on("click",P).on("pointerup",I).on("pointerdown mousedown",function(N){N.stopPropagation()}).on("mouseenter.highlight",function(N,M){!M.relatedEntityIds||H(this).classed("disabled")||ct(M.relatedEntityIds(),!0,t)}).on("mouseleave.highlight",function(N,M){M.relatedEntityIds&&ct(M.relatedEntityIds(),!1,t)});k.each((N,M,D)=>{let F=Ae().heading(N.title).title(N.tooltip()).keys([N.keys[0]]);y.push(F),H(D[M]).call(F).append("div").attr("class","icon-wrap").call(Z(`#rapid-operation-${N.id}`,"operation"))}),E&&k.append("span").attr("class","label").html(N=>N.title),k.merge(T).classed("disabled",N=>N.disabled()),x(),t.map().on("move",x);let C;function I(N){C=N.pointerType}function P(N,M){N.stopPropagation(),M.relatedEntityIds&&ct(M.relatedEntityIds(),!1,t),M.disabled()?(C==="touch"||C==="pen")&&t.ui().flash.duration(4e3).iconName(`#rapid-operation-${M.id}`).iconClass("operation disabled").label(M.tooltip)():((C==="touch"||C==="pen")&&t.ui().flash.duration(2e3).iconName(`#rapid-operation-${M.id}`).iconClass("operation").label(M.annotation()||M.title)(),M(),v.close()),C=null}e.call("toggled",this,!0)};function x(){if(!l||l.empty())return;if(d!==t.projection.scale()){v.close();return}let _=t.projection.project(u),b=t.surfaceRect();if(_[0]<0||_[0]>b.width||_[1]<0||_[1]>b.height){v.close();return}let w=C(b),E=[0,0];E[0]=w?-1*(s+g):s,p?_[1]-m<r?E[1]=-_[1]+r:E[1]=-m:_[1]+m>b.height-i?E[1]=-_[1]-m+b.height-i:E[1]=0;let[A,T]=Ot(_,E);l.style("left",`${A}px`).style("top",`${T}px`);let k=I(b,w);y.forEach(P=>P.placement(k));function C(P){return se.textDirection()==="ltr"?_[0]+s+g>P.width-n:!(_[0]-s-g<n)}function I(P,N){return se.textDirection()==="ltr"?N||_[0]+s+g+a>P.width-n?"left":"right":!N||_[0]-s-g-a<n?"right":"left"}}return v.close=function(){t.map().off("move",x),l.remove(),y=[],e.call("toggled",this,!1)},v.anchorLoc=function(_){return arguments.length?(u=_,v):u},v.triggerType=function(_){return arguments.length?(h=_,v):h},v.operations=function(_){return arguments.length?(c=_,v):c},ge(v,e,"on")}function KC(t){function e(r){var i=t.features(),n=i.stats(),s=0,o=i.hidden().map(function(l){return n[l]?(s+=n[l],S("inspector.title_count",{title:S.html("feature."+l+".description"),count:n[l]})):null}).filter(Boolean);if(r.html(""),o.length){var a=Ae().placement("top").title(function(){return o.join("<br/>")});r.append("a").attr("class","chip").attr("href","#").html(S.html("feature_info.hidden_warning",{count:s})).call(a).on("click",function(l){a.hide(),l.preventDefault(),t.ui().togglePanes(t.container().select(".map-panes .map-data-pane"))})}r.classed("hide",!o.length)}return function(r){e(r),t.features().on("change.feature_info",function(){e(r)})}}function h7(t){var e=t.container().node();function r(){if(e.requestFullscreen)return e.requestFullscreen;if(e.msRequestFullscreen)return e.msRequestFullscreen;if(e.mozRequestFullScreen)return e.mozRequestFullScreen;if(e.webkitRequestFullscreen)return e.webkitRequestFullscreen}function i(){if(document.exitFullscreen)return document.exitFullscreen;if(document.msExitFullscreen)return document.msExitFullscreen;if(document.mozCancelFullScreen)return document.mozCancelFullScreen;if(document.webkitExitFullscreen)return document.webkitExitFullscreen}function n(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function s(){return!!r()}function o(a){a.preventDefault(),n()?i().apply(document):r().apply(e)}return function(){if(s()){var a=Rr(),l=a.os==="mac"?[et("\u2303\u2318F"),"f11"]:["f11"];t.keybinding().on(l,o)}}}var fz=1e4,dz=2e3,ZC={enableHighAccuracy:!1,timeout:6e3};function p7(t){let e=ra(t).message(S.html("geolocate.locating")).blocking(!0),r=t.scene().layers.get("map-ui"),i=!1,n,s=H(null);function o(){t.inIntro()||(i?(i=!1,r.geolocationData=null,t.map().deferredRedraw(),c()):(i=!0,s.classed("active",!0),n=window.setTimeout(l,fz),t.container().call(e),navigator.geolocation.getCurrentPosition(a,l,ZC)))}function a(u){if(i){t.enter("browse");let d=u.coords,h=new le([d.longitude,d.latitude]).padByMeters(d.accuracy);if(r.geolocationData=u,t.map().deferredRedraw(),n){window.clearTimeout(n),n=void 0;let p=t.map();p.centerZoomEase(h.center(),Math.min(20,p.extentZoom(h)))}window.setTimeout(()=>{navigator.geolocation.getCurrentPosition(a,l,ZC)},dz)}c()}function l(){i&&t.ui().flash.label(S.html("geolocate.location_unavailable")).iconName("#rapid-icon-geolocate")(),i=!1,r.geolocationData=null,t.map().deferredRedraw(),c()}function c(){n&&(window.clearTimeout(n),n=void 0),e.close(),s.classed("active",i)}return function(u){!navigator.geolocation||!navigator.geolocation.getCurrentPosition||(s=u.append("button").on("click",o).call(Z("#rapid-icon-geolocate","light")).call(Ae().placement(se.textDirection()==="rtl"?"right":"left").title(S.html("geolocate.title"))))}}var Ro=class{constructor(e){this.context=e,this._enabled=!1}enable(){this._enabled=!0}disable(){this._enabled=!1}get enabled(){return this._enabled}};var JC=["zoom","vintage","source","description","resolution","accuracy"],d5=class extends Ro{constructor(e){super(e),this.id="background",this.label=S.html("info_panels.background.title"),this.key=S("info_panels.background.key"),this._selection=H(null),this._currSourceID=null,this._metadata={},this.render=this.render.bind(this),this.updateMetadata=this.updateMetadata.bind(this),this._deferredRender=Gt(this.render,250),this._deferredUpdateMetadata=Gt(this.updateMetadata,250)}enable(e){this._enabled||(this._enabled=!0,this._selection=e,this._currSourceID=null,this._metadata={},this.context.map().on("draw",this._deferredRender).on("move",this._deferredUpdateMetadata))}disable(){this._enabled&&(this._deferredRender.cancel(),this._deferredUpdateMetadata.cancel(),this._selection.html(""),this._enabled=!1,this._selection=H(null),this._currSourceID=null,this._metadata={},this.context.map().off("draw",this._deferredRender).off("move",this._deferredUpdateMetadata))}render(){if(!this._enabled)return;let e=this.context,r=this._selection,n=e.imagery().baseLayerSource();if(!n)return;this._currSourceID!==n.id&&(this._currSourceID=n.id,this._metadata={}),r.html("");let s=r.append("ul").attr("class","background-info");s.append("li").html(n.label),JC.forEach(a=>{s.append("li").attr("class",`background-info-list-${a}`).classed("hide",!this._metadata[a]).html(S.html(`info_panels.background.${a}`)+":").append("span").attr("class",`background-info-span-${a}`).text(this._metadata[a])}),this._deferredUpdateMetadata();let o=e.getDebug("tile")?"hide_tiles":"show_tiles";r.append("a").html(S.html(`info_panels.background.${o}`)).attr("href","#").attr("class","button button-toggle-tiles").on("click",a=>{a.preventDefault(),e.setDebug("tile",!e.getDebug("tile")),this.render()})}updateMetadata(){if(!this._enabled)return;let e=this.context,r=this._selection,n=e.imagery().baseLayerSource();if(!n)return;this._currSourceID!==n.id&&(this._currSourceID=n.id,this._metadata={});let s=e.map().center(),o=new le(s),l=e.scene().layers.get("background")?._tileMaps.get(n.id),c,u;if(l){for(let h of l.values())if(h.loaded&&h.wgs84Extent.contains(o)){c=h.xyz,u=h.xyz[2];break}}let d=u||Math.floor(e.map().zoom());this._metadata.zoom=String(d),r.selectAll(".background-info-list-zoom").classed("hide",!1).selectAll(".background-info-span-zoom").text(this._metadata.zoom),c&&n.getMetadata(s,c,(h,p)=>{if(h||this._currSourceID!==n.id)return;let m=p.vintage;this._metadata.vintage=m&&m.range||S("info_panels.background.unknown"),r.selectAll(".background-info-list-vintage").classed("hide",!1).selectAll(".background-info-span-vintage").text(this._metadata.vintage),JC.forEach(g=>{if(g==="zoom"||g==="vintage")return;let y=p[g];this._metadata[g]=y,r.selectAll(`.background-info-list-${g}`).classed("hide",!y).selectAll(`.background-info-span-${g}`).text(y)})})}};var h5=class extends Ro{constructor(e){super(e),this.id="history",this.label=S.html("info_panels.history.title"),this.key=S("info_panels.history.key"),this._selection=H(null),this.render=this.render.bind(this),this.renderEntity=this.renderEntity.bind(this),this.renderNote=this.renderNote.bind(this),this.renderUser=this.renderUser.bind(this),this.renderChangeset=this.renderChangeset.bind(this),this.displayTimestamp=this.displayTimestamp.bind(this)}enable(e){this._enabled||(this._enabled=!0,this._selection=e,this.context.map().on("draw",this.render),this.context.on("enter.info-history",this.render))}disable(){this._enabled&&(this._selection.html(""),this._enabled=!1,this._selection=H(null),this.context.map().off("draw",this.render),this.context.on("enter.info-history",null))}render(){if(!this._enabled)return;let e=this.context,r=this._selection;r.html("");let i,n,s;i=e.selectedIDs().filter(a=>e.hasEntity(a)),i.length&&(s=e.entity(i[0]));let o=i.length===1?i[0]:null;r.append("h4").attr("class","history-heading").html(o||S.html("info_panels.selected",{n:i.length})),o&&(s?r.call(this.renderEntity,s):n&&r.call(this.renderNote,n))}renderNote(e,r){if(!r||r.isNew()){e.append("div").html(S.html("info_panels.history.note_no_history"));return}let i=e.append("ul");i.append("li").html(S.html("info_panels.history.note_comments")+":").append("span").html(r.comments.length),r.comments.length&&(i.append("li").html(S.html("info_panels.history.note_created_date")+":").append("span").text(this.displayTimestamp(r.comments[0].date)),i.append("li").html(S.html("info_panels.history.note_created_user")+":").call(this.renderUser,r.comments[0].user));let n=this.context.connection();n&&e.append("a").attr("class","view-history-on-osm").attr("target","_blank").attr("href",n.noteURL(r)).call(Z("#rapid-icon-out-link","inline")).append("span").html(S.html("info_panels.history.note_link_text"))}renderEntity(e,r){if(!r||r.isNew()){e.append("div").html(S.html("info_panels.history.no_history"));return}let i=e.append("div").attr("class","links"),n=this.context.connection();n&&i.append("a").attr("class","view-history-on-osm").attr("href",n.historyURL(r)).attr("target","_blank").attr("title",S("info_panels.history.link_text")).text("OSM"),i.append("a").attr("class","pewu-history-viewer-link").attr("href","https://pewu.github.io/osm-history/#/"+r.type+"/"+r.osmId()).attr("target","_blank").attr("tabindex",-1).text("PeWu");let s=e.append("ul");s.append("li").html(S.html("info_panels.history.version")+":").append("span").text(r.version),s.append("li").html(S.html("info_panels.history.last_edit")+":").append("span").text(this.displayTimestamp(r.timestamp)),s.append("li").html(S.html("info_panels.history.edited_by")+":").call(this.renderUser,r.user),s.append("li").html(S.html("info_panels.history.changeset")+":").call(this.renderChangeset,r.changeset)}displayTimestamp(e){if(!e)return S("info_panels.history.unknown");let r={day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},i=new Date(e);return isNaN(i.getTime())?S("info_panels.history.unknown"):i.toLocaleString(se.localeCode(),r)}renderUser(e,r){if(!r){e.append("span").html(S.html("info_panels.history.unknown"));return}e.append("span").attr("class","user-name").html(r);let i=e.append("div").attr("class","links"),n=this.context.connection();n&&i.append("a").attr("class","user-osm-link").attr("href",n.userURL(r)).attr("target","_blank").text("OSM"),i.append("a").attr("class","user-hdyc-link").attr("href","https://hdyc.neis-one.org/?"+r).attr("target","_blank").attr("tabindex",-1).text("HDYC")}renderChangeset(e,r){if(!r){e.append("span").html(S.html("info_panels.history.unknown"));return}e.append("span").attr("class","changeset-id").html(r);let i=e.append("div").attr("class","links"),n=this.context.connection();n&&i.append("a").attr("class","changeset-osm-link").attr("href",n.changesetURL(r)).attr("target","_blank").text("OSM"),i.append("a").attr("class","changeset-osmcha-link").attr("href",`https://osmcha.org/changesets/${r}`).attr("target","_blank").text("OSMCha"),i.append("a").attr("class","changeset-achavi-link").attr("href",`https://overpass-api.de/achavi/?changeset=${r}`).attr("target","_blank").text("Achavi")}};var ek=7;function p5(t,e){var r=t*(e?3.28084:1),i;return e?r>=5280?(r/=5280,i="miles"):i="feet":r>=1e3?(r/=1e3,i="kilometers"):i="meters",S("units."+i,{quantity:r.toLocaleString(se.localeCode(),{maximumSignificantDigits:4})})}function rk(t,e){var r=se.localeCode(),i=t*(e?10.7639111056:1),n,s,o,a="",l="";return e?(i>=6969600?(n=i/27878400,a="square_miles"):(n=i,a="square_feet"),i>4356&&i<4356e4&&(s=i/43560,l="acres")):(i>=25e4?(n=i/1e6,a="square_kilometers"):(n=i,a="square_meters"),i>1e3&&i<1e7&&(s=i/1e4,l="hectares")),o=S("units."+a,{quantity:n.toLocaleString(r,{maximumSignificantDigits:4})}),s?S("units.area_pair",{area1:o,area2:S("units."+l,{quantity:s.toLocaleString(r,{maximumSignificantDigits:2})})}):o}function ik(t,e,r){var i=r-e;return((t-e)%i+i)%i+e}function nk(t,e,r){return Math.max(e,Math.min(t,r))}function tk(t,e,r){var i=se.localeCode(),n=(Math.abs(t)-Math.floor(Math.abs(t)))*60,s=(n-Math.floor(n))*60,o=S("units.arcdegrees",{quantity:Math.floor(Math.abs(t)).toLocaleString(i)}),a;return Math.floor(s)>0?a=o+S("units.arcminutes",{quantity:Math.floor(n).toLocaleString(i)})+S("units.arcseconds",{quantity:Math.round(s).toLocaleString(i)}):Math.floor(n)>0?a=o+S("units.arcminutes",{quantity:Math.round(n).toLocaleString(i)}):a=S("units.arcdegrees",{quantity:Math.round(Math.abs(t)).toLocaleString(i)}),t===0?a:S("units.coordinate",{coordinate:a,direction:S("units."+(t>0?e:r))})}function Il(t){return S("units.coordinate_pair",{latitude:tk(nk(t[1],-90,90),"north","south"),longitude:tk(ik(t[0],-180,180),"east","west")})}function r4(t){return S("units.coordinate_pair",{latitude:nk(t[1],-90,90).toFixed(ek),longitude:ik(t[0],-180,180).toFixed(ek)})}var m5=class extends Ro{constructor(e){super(e),this.id="location",this.label=S.html("info_panels.location.title"),this.key=S("info_panels.location.key"),this._selection=H(null),this._currLocation=null,this.render=this.render.bind(this),this.updateLocation=this.updateLocation.bind(this),this._deferredUpdateLocation=Gt(this.updateLocation,1e3)}enable(e){this._enabled||(this._enabled=!0,this._selection=e,this._currLocation=null,this.context.surface().on("pointermove.info-location",this.render))}disable(){this._enabled&&(this._deferredUpdateLocation.cancel(),this._selection.html(""),this._enabled=!1,this._selection=H(null),this._currLocation=null,this.context.surface().on("pointermove.info-location",null))}render(){if(!this._enabled)return;let e=this.context,r=this._selection;r.html("");let i=r.append("ul"),n=e.map().mouseLoc();n.some(isNaN)&&(n=e.map().center()),i.append("li").text(Il(n)).append("li").text(r4(n)),r.append("div").attr("class","location-info").text(this._currLocation||" "),this._deferredUpdateLocation(n)}updateLocation(e){if(!this._enabled)return;let r=this._selection;K.geocoder?K.geocoder.reverse(e,(i,n)=>{this._currLocation=n?n.display_name:S("info_panels.location.unknown_location"),r.selectAll(".location-info").text(this._currLocation)}):(this._currLocation=S("info_panels.location.unknown_location"),r.selectAll(".location-info").text(this._currLocation))}};function hz(t){return t*63710071809e-4}function pz(t){return t/(4*Math.PI)*510065621724e3}function mz(t){if(t.type==="LineString")return t;let e={type:"LineString",coordinates:[]};return t.type==="Polygon"?e.coordinates=t.coordinates[0]:t.type==="MultiPolygon"&&(e.coordinates=t.coordinates[0][0]),e}var g5=class extends Ro{constructor(e){super(e),this.id="measurement",this.label=S.html("info_panels.measurement.title"),this.key=S("info_panels.measurement.key"),this._selection=H(null),this._isImperial=!se.usesMetric(),this.render=this.render.bind(this)}enable(e){this._enabled||(this._enabled=!0,this._selection=e,this.context.map().on("draw",this.render),this.context.on("enter.info-measurement",this.render))}disable(){this._enabled&&(this._selection.html(""),this._enabled=!1,this._selection=H(null),this.context.map().off("draw",this.render),this.context.on("enter.info-measurement",null))}render(){if(!this._enabled)return;let e=this._selection,r=this.context,i=r.graph(),n=se.localeCode();e.html("");let s,o,a,l,c,u,d,h=0,p=0,m,g=r.selectedIDs(),y=r.selectedData(),[v]=y.values();if(y.size===1&&v instanceof Jt){let b=v;s=S("note.note")+" "+b.id,a=b.loc,u="note"}else{let b=g.map(w=>r.hasEntity(w)).filter(Boolean);if(b.length===1?s=b[0].id:s=S("info_panels.selected",{n:b.length}),b.length>0){let w=new le;b.forEach(E=>{let A=E.extent(i),T=E.asGeoJSON(i);w=w.extend(A),u=E.geometry(i),(u==="line"||u==="area")&&(c=E.type==="relation"||E.isClosed()&&!E.isDegenerate(),h+=hz(y8(mz(T))),l=p8(T),(!l||!isFinite(l[0])||!isFinite(l[1]))&&(l=A.center()),c&&(p+=pz(E.area(i))))}),b.length>1&&(u=null,c=null,l=null),b.length===2&&b[0].type==="node"&&b[1].type==="node"&&(m=Tt(b[0].loc,b[1].loc)),b.length===1&&b[0].type==="node"?a=b[0].loc:d=dr(g,r.graph()).length,!a&&!l&&(o=w.center())}}s&&e.append("h4").attr("class","measurement-heading").text(s);let x=e.append("ul"),_;if(u&&x.append("li").html(S.html("info_panels.measurement.geometry")+":").append("span").text(c?S("info_panels.measurement.closed_"+u):S("geometry."+u)),d&&x.append("li").html(S.html("info_panels.measurement.node_count")+":").append("span").text(d.toLocaleString(n)),p&&x.append("li").html(S.html("info_panels.measurement.area")+":").append("span").text(rk(p,this._isImperial)),h&&x.append("li").html(S.html("info_panels.measurement."+(c?"perimeter":"length"))+":").append("span").text(p5(h,this._isImperial)),typeof m=="number"&&x.append("li").html(S.html("info_panels.measurement.distance")+":").append("span").text(p5(m,this._isImperial)),a&&(_=x.append("li").html(S.html("info_panels.measurement.location")+":"),_.append("span").text(Il(a)),_.append("span").text(r4(a))),l&&(_=x.append("li").html(S.html("info_panels.measurement.centroid")+":"),_.append("span").text(Il(l)),_.append("span").text(r4(l))),o&&(_=x.append("li").html(S.html("info_panels.measurement.center")+":"),_.append("span").text(Il(o)),_.append("span").text(r4(o))),h||p||typeof m=="number"){let b=this._isImperial?"imperial":"metric";e.append("a").html(S.html(`info_panels.measurement.${b}`)).attr("href","#").attr("class","button button-toggle-units").on("click",w=>{w.preventDefault(),this._isImperial=!this._isImperial,this.render()})}}};function m7(t){let e={background:new d5(t),history:new h5(t),location:new m5(t),measurement:new g5(t)},r=Object.keys(e),i=new Set,n=new Set;function s(o){function a(){let c=l.selectAll(".panel-container").data(Array.from(i),h=>h);c.exit().style("opacity",1).transition().duration(200).style("opacity",0).on("end",(h,p,m)=>{let g=H(m[p]);e[h].disable(),g.remove()});let u=c.enter().append("div").attr("class",h=>`fillD2 panel-container panel-container-${h}`);u.style("opacity",0).transition().duration(200).style("opacity",1);let d=u.append("div").attr("class","panel-title fillD2");d.append("h3").html(h=>e[h].label),d.append("button").attr("class","close").on("click",(h,p)=>{h.stopImmediatePropagation(),h.preventDefault(),s.toggle(p)}).call(Z("#rapid-icon-close")),u.append("div").attr("class",h=>`panel-content panel-content-${h}`).each((h,p,m)=>{let g=H(m[p]);e[h].enable(g)}),l.selectAll(".panel-content").each(h=>e[h].render())}s.toggle=function(c){c?i.has(c)?(i.delete(c),n.size>1&&n.delete(c)):(i.add(c),n.add(c)):i.size?i.clear():(n.size||n.add("measurement"),i=new Set(n)),r.forEach(u=>{t.container().selectAll(`.${u}-panel-toggle-item`).classed("active",i.has(u)).select("input").property("checked",i.has(u))}),a()};let l=o.selectAll(".info-panels").data([0]);l=l.enter().append("div").attr("class","info-panels").merge(l),a(),t.keybinding().on(et("\u2318"+S("info_panels.key")),c=>{c.stopImmediatePropagation(),c.preventDefault(),s.toggle()}),r.forEach(c=>{let u=S(`info_panels.${c}.key`,{default:null});u&&t.keybinding().on(et("\u2318\u21E7"+u),d=>{d.stopImmediatePropagation(),d.preventDefault(),s.toggle(c)})})}return s}function g7(t){var e={id:"warnings",count:0,iconID:"rapid-icon-alert",descriptionID:"issues.warnings_and_errors"},r={id:"resolved",count:0,iconID:"rapid-icon-apply",descriptionID:"issues.user_resolved_issues"};function i(n){var s=[],o=t.validator().getIssues({what:ee("validate-what")||"edited",where:ee("validate-where")||"all"});if(o.length&&(e.count=o.length,s.push(e)),ee("validate-what")==="all"){var a=t.validator().getResolvedIssues();a.length&&(r.count=a.length,s.push(r))}var l=n.selectAll(".chip").data(s,function(u){return u.id});l.exit().remove();var c=l.enter().append("a").attr("class",function(u){return"chip "+u.id+"-count"}).attr("href","#").each(function(u){var d=H(this),h=Ae().placement("top").title(S.html(u.descriptionID));d.call(h).on("click",function(p){p.preventDefault(),h.hide(H(this)),t.ui().togglePanes(t.container().select(".map-panes .issues-pane"))}),d.call(Z("#"+u.iconID))});c.append("span").attr("class","count"),c.merge(l).selectAll("span.count").html(function(u){return u.count.toString()})}return function(n){i(n),t.validator().on("validated.infobox",function(){i(n)})}}function V1(t){function e(r){let i=new Qi,n=Ic().scaleExtent([di(.5),di(24)]).on("start",x).on("zoom",_).on("end",b),s=H(null),o=H(null),a=null,l=!0,c=!1,u=!1,d=null,h=6,p,m,g,y,v;function x(){u||(g=y=i.transform(),d=null)}function _(C){if(u)return;let I=C.transform.x,P=C.transform.y,N=C.transform.k,M=N!==g.k,D=I!==g.x||P!==g.y;if(!M&&!D)return;d||(d=M?"zoom":"pan");let F=i.transform(),L,B,O;d==="zoom"?(O=N/F.k,L=(m[0]/O-m[0])*O,B=(m[1]/O-m[1])*O):(N=F.k,O=1,L=I-F.x,B=P-F.y),d==="pan"?(a.renderer.stage.x+=L,a.renderer.stage.y+=B):As(o,0,0,O),c=!0,y=cs.translate(I,P).scale(N);let R=xn(t.projection.scale()),U=xn(N);h=R-U,E()}function b(){u||d==="pan"&&(w(),d=null,t.map().center(i.invert(m)))}function w(){let C=t.map().center(),I=t.projection.transform(),P=xn(I.k),N=Math.max(P-h,.5),M=di(N);i.translate([I.x,I.y]).scale(M);let D=i.project(C),F=d==="pan"?St([y.x,y.y],[g.x,g.y]):[0,0],L=m[0]-D[0]+I.x+F[0],B=m[1]-D[1]+I.y+F[1];if(i.translate([L,B]).dimensions([[0,0],p]),y=i.transform(),c){let O=a.renderer.stage;O.x=0,O.y=0,As(o,0,0),c=!1}n.scaleExtent([di(.5),di(P-3)]),u=!0,s.call(n.transform,y),u=!1}function E(){l||(w(),A())}function A(){let C=t.map().extent().bbox(),I=i.project([C.minX,C.maxY]),P=i.project([C.maxX,C.minY]),N=Math.abs(P[0]-I[0]),M=Math.abs(P[1]-I[1]),D=v.stage,F=D.getChildByName("bbox");if(F)F.children[0].clear().lineStyle(2,65535).drawRect(I[0],I[1],N,M);else{let L=new st;L.name="bbox",L.eventMode="none",D.addChild(L);let B=new it().clear().lineStyle(2,65535).drawRect(I[0],I[1],N,M);L.addChild(B)}}function T(C){C&&C.preventDefault(),l=!l,t.container().select(".minimap-toggle-item").classed("active",!l).select("input").property("checked",!l),l?s.style("display","block").style("opacity","1").transition().duration(200).style("opacity","0").on("end",()=>r.selectAll(".map-in-map").style("display","none")):s.style("display","block").style("opacity","0").transition().duration(200).style("opacity","1").on("end",()=>E())}V1.toggle=T,s=r.selectAll(".map-in-map").data([0]);let k=s.enter().append("div").attr("class","map-in-map").style("display",l?"none":"block").call(n).on("dblclick.zoom",null);if(!v){v=new _1({antialias:!0,autoDensity:!0,autoStart:!1,events:{move:!1,globalMove:!1,click:!0,wheel:!1},resolution:window.devicePixelRatio,sharedLoader:!0,sharedTicker:!0});let[C,I]=[200,150];v.renderer.resize(C,I);let P=v.stage;P.name="minimap-stage",P.eventMode="none",P.sortableChildren=!1;let M={context:t,renderer:{context:t,pixi:v,stage:P},groups:new Map,layers:new Map,features:new Map},D=new st;D.name="background",P.addChild(D),M.groups.set("background",D),a=new Ku(M,"minimap-background",!0),M.layers.set(a.id,a),v.ticker.add(()=>{if(l)return;window.performance.mark("minimap-start");let F=0;a.render(F,i,10),window.performance.mark("minimap-end")}),p=[C,I],m=Yi(p,.5),t.map().on("draw",()=>E())}k.each((C,I,P)=>{P[I].appendChild(v.view)}),s=k.merge(s),o=H(v.view),E(),t.keybinding().on(S("background.minimap.key"),T)}return e}function sk(t){var e=fe("resize");function r(i){i.append("button").attr("class","thumb-hide").on("click",function(){K.streetside&&K.streetside.hideViewer(t),K.mapillary&&K.mapillary.hideViewer(t),K.kartaview&&K.kartaview.hideViewer(t)}).append("div").call(Z("#rapid-icon-close"));function n(o){o.preventDefault()}i.append("button").attr("class","resize-handle-xy").on("touchstart touchdown touchend",n).on("pointerdown",s(i,"resize",e,{resizeOnX:!0,resizeOnY:!0})),i.append("button").attr("class","resize-handle-x").on("touchstart touchdown touchend",n).on("pointerdown",s(i,"resize",e,{resizeOnX:!0})),i.append("button").attr("class","resize-handle-y").on("touchstart touchdown touchend",n).on("pointerdown",s(i,"resize",e,{resizeOnY:!0}));function s(o,a,l,c){var u=!!c.resizeOnX,d=!!c.resizeOnY,h=c.minHeight||240,p=c.minWidth||320,m,g,y,v,x;function _(E){if(m===(E.pointerId||"mouse")){E.preventDefault(),E.stopPropagation();var A=t.map().dimensions;if(u){var T=A[0],k=b(v+E.clientX-g,p,T);o.style("width",k+"px")}if(d){var C=A[1]-90,I=b(x+y-E.clientY,h,C);o.style("height",I+"px")}l.call(a,o,io(o,!0))}}function b(E,A,T){return Math.max(A,Math.min(E,T))}function w(E){m===(E.pointerId||"mouse")&&(E.preventDefault(),E.stopPropagation(),H(window).on("."+a,null))}return function(A){A.preventDefault(),A.stopPropagation(),m=A.pointerId||"mouse",g=A.clientX,y=A.clientY;var T=o.node().getBoundingClientRect();v=T.width,x=T.height,H(window).on("pointermove."+a,_,!1).on("pointerup."+a,w,!1).on("pointercancel."+a,w,!1)}}}return r.onMapResize=function(){var i=t.container().select(".photoviewer"),n=t.container().select(".main-content"),s=io(n,!0),o=io(i,!0);if(o[0]>s[0]||o[1]>s[1]-90){var a=[Math.min(o[0],s[0]),Math.min(o[1],s[1]-90)];i.style("width",a[0]+"px").style("height",a[1]+"px"),e.call("resize",i,a)}},ge(r,e,"on")}function y7(t){return function(e){if(!t.history().hasRestorableChanges())return;let r=Er(e,!0);r.select(".modal").attr("class","modal fillL");let i=r.select(".content");i.append("div").attr("class","modal-section").append("h3").html(S.html("restore.heading")),i.append("div").attr("class","modal-section").append("p").html(S.html("restore.description"));let n=i.append("div").attr("class","modal-actions"),s=n.append("button").attr("class","restore").on("click",()=>{t.history().restore(),r.remove()});s.append("svg").attr("class","logo logo-restore").append("use").attr("xlink:href","#rapid-logo-restore"),s.append("div").html(S.html("restore.restore"));let o=n.append("button").attr("class","reset").on("click",()=>{t.history().clearSaved(),r.remove()});o.append("svg").attr("class","logo logo-reset").append("use").attr("xlink:href","#rapid-logo-reset"),o.append("div").html(S.html("restore.reset")),s.node().focus()}}function v7(t){let e=t.projection,r=180,i=8,n=!se.usesMetric();function s(a,l){let c=(l[1]+a[1])/2,u=n?3.28084:1,d=c2(l[0]-a[0],c)*u,h={dist:0,px:0,text:""},p;n?p=[528e4,528e3,52800,5280,500,50,5,1]:p=[5e6,5e5,5e4,5e3,500,50,5,1];for(let g=0;g<p.length;g++){let y=p[g];if(d>=y){h.dist=Math.floor(d/y)*y;break}else h.dist=+d.toFixed(2)}let m=fi(h.dist/u,c);return h.px=Math.round(e.project([a[0]+m,a[1]])[0]),h.text=p5(h.dist/u,n),h}function o(a){let l=t.map().dimensions,c=e.invert([0,l[1]]),u=e.invert([r,l[1]]),d=s(c,u);a.select(".scale-path").attr("d","M0.5,0.5v"+i+"h"+d.px+"v-"+i),a.select(".scale-text").style(se.textDirection()==="ltr"?"left":"right",d.px+16+"px").html(d.text)}return function(a){function l(){n=!n,a.call(o)}a.append("svg").attr("class","scale").on("click",l).append("g").attr("transform","translate(10,11)").append("path").attr("class","scale-path"),a.append("div").attr("class","scale-text"),t.map().on("draw",()=>{window.requestIdleCallback(()=>o(a))})}}function ok(t){var e=Rr(),r=0,i,n=H(null),s;function o(l){l.select(".modal").classed("modal-shortcuts",!0);var c=l.select(".content");c.append("div").attr("class","modal-section").append("h3").html(S.html("shortcuts.title")),Qe.get("shortcuts").then(function(u){s=u,c.call(a)}).catch(u=>console.error(u))}function a(l){if(s){var c=l.selectAll(".wrapper").data([0]),u=c.enter().append("div").attr("class","wrapper modal-section"),d=u.append("div").attr("class","tabs-bar"),h=u.append("div").attr("class","shortcuts-list");c=c.merge(u);var p=d.selectAll(".tab").data(s),m=p.enter().append("a").attr("class","tab").attr("href","#").on("click",function(A,T){A.preventDefault();var k=s.indexOf(T);r=k,a(l)});m.append("span").html(function(A){return S.html(A.text)}),c.selectAll(".tab").classed("active",function(A,T){return T===r});var g=h.selectAll(".shortcut-tab").data(s),y=g.enter().append("div").attr("class",function(A){return"shortcut-tab shortcut-tab-"+A.tab}),v=y.selectAll(".shortcut-column").data(function(A){return A.columns}).enter().append("table").attr("class","shortcut-column"),x=v.selectAll(".shortcut-row").data(function(A){return A.rows}).enter().append("tr").attr("class","shortcut-row"),_=x.filter(function(A){return!A.shortcuts});_.append("td"),_.append("td").attr("class","shortcut-section").append("h3").html(function(A){return S.html(A.text)});var b=x.filter(function(A){return A.shortcuts}),w=b.append("td").attr("class","shortcut-keys"),E=w.filter(function(A){return A.modifiers});E.selectAll("kbd.modifier").data(function(A){return e.os==="win"&&A.text==="shortcuts.editing.commands.redo"?["\u2318"]:e.os!=="mac"&&A.text==="shortcuts.browsing.display_options.fullscreen"?[]:A.modifiers}).enter().each(function(){var A=H(this);A.append("kbd").attr("class","modifier").html(function(T){return et.display(T)}),A.append("span").html("+")}),w.selectAll("kbd.shortcut").data(function(A){var T=A.shortcuts;return e.os==="win"&&A.text==="shortcuts.editing.commands.redo"?T=["Y"]:e.os!=="mac"&&A.text==="shortcuts.browsing.display_options.fullscreen"&&(T=["F11"]),T=T.map(function(k){return et.display(k.indexOf(".")!==-1?S(k):k)}),$e(T).map(function(k){return{shortcut:k,separator:A.separator,suffix:A.suffix,rapid:A.rapid}})}).enter().each(function(A,T,k){var C=H(this),I=A.shortcut.toLowerCase().match(/(.*).click/);I&&I[1]?C.call(Z("#rapid-walkthrough-mouse-"+I[1],"operation")):A.shortcut.toLowerCase()==="long-press"?C.call(Z("#rapid-walkthrough-longpress","longpress operation")):A.shortcut.toLowerCase()==="tap"?C.call(Z("#rapid-walkthrough-tap","tap operation")):C.append("kbd").attr("class","shortcut").html(function(P){return P.shortcut}),T<k.length-1?C.append("span").html(A.separator||"\xA0"+S.html("shortcuts.or")+"\xA0"):T===k.length-1&&A.suffix&&C.append("span").html(A.suffix),A.rapid&&C.append("svg").lower().attr("class","icon logo-rapid").append("use").attr("xlink:href","#rapid-logo-rapid").attr("class","#rapid-logo-rapid")}),w.filter(function(A){return A.gesture}).each(function(){var A=H(this);A.append("span").html("+"),A.append("span").attr("class","gesture").html(function(T){return S.html(T.gesture)})}),b.append("td").attr("class","shortcut-desc").html(function(A){return A.text?S.html(A.text):"\xA0"}),c.selectAll(".shortcut-tab").style("display",function(A,T){return T===r?"flex":"none"})}}return function(l,c){n=l,c?(i=Er(l),i.call(o)):t.keybinding().on([S("shortcuts.toggle.key"),"?"],function(){t.container().selectAll(".modal-shortcuts").size()?i&&(i.close(),i=null):(i=Er(n),i.call(o))})}}var ck=dt(lk(),1);function x7(t){var e;function r(i){var n=i.append("div").attr("class","header fillL");n.append("h3").html(S.html("inspector.feature_list"));var s=i.append("div").attr("class","search-header");s.call(Z("#rapid-icon-search","pre-text"));var o=s.append("input").attr("placeholder",S("inspector.search")).attr("type","search").call(qe).on("keypress",d).on("keydown",u).on("input",h),a=i.append("div").attr("class","inspector-body"),l=a.append("div").attr("class","feature-list");t.on("exit.feature-list",p),t.keybinding().on(et("\u2318F"),c);function c(w){var E=t.mode()&&t.mode().id;E==="browse"&&(w.preventDefault(),o.node().focus())}function u(w){w.keyCode===27&&o.node().blur()}function d(w){var E=o.property("value"),A=l.selectAll(".feature-list-item");w.keyCode===13&&E.length&&A.size()&&_(w,A.datum())}function h(){e=void 0,y()}function p(){o.property("value",""),y()}function m(w){w.full&&y()}function g(){var w=[],E=t.graph(),A=t.map().extent().center(),T=o.property("value").toLowerCase();if(!T)return w;var k=ck.pair(T.toUpperCase())||T.match(/^(-?\d+\.?\d*)\s+(-?\d+\.?\d*)$/);if(k){var C=[parseFloat(k[0]),parseFloat(k[1])];w.push({id:-1,geometry:"point",type:S("inspector.location"),name:Il([C[1],C[0]]),location:C})}var I=!k&&T.match(/(?:^|\W)(node|way|relation|[nwr])\W?0*([1-9]\d*)(?:\W|$)/i);if(I){var P=I[1].charAt(0),N=I[2];w.push({id:P+N,geometry:P==="n"?"point":P==="w"?"line":"relation",type:P==="n"?S("inspector.node"):P==="w"?S("inspector.way"):S("inspector.relation"),name:N})}let M=E.base.entities,D=E.local.entities,F=new Set([...M.keys(),...D.keys()]);var L=[];for(var B of F){if(D.has(B)&&D.get(B)===void 0)continue;let q=E.hasEntity(B);if(q){var O=qt(q)||"";if(!(O.toLowerCase().indexOf(T)<0)){var R=xe.match(q,E),U=R&&R.name()||gs(q.id),G=q.extent(E),$=G?Tt(A,G.center()):0;if(L.push({id:q.id,entity:q,geometry:q.geometry(E),type:U,name:O,distance:$}),L.length>100)break}}}return L=L.sort(function(ie,Q){return ie.distance-Q.distance}),w=w.concat(L),(e||[]).forEach(function(q){if(q.osm_type&&q.osm_id){var ie=Te.id.fromOSM(q.osm_type,q.osm_id),Q={};Q[q.class]=q.type;var re={id:ie,type:q.osm_type,tags:Q};q.osm_type==="way"&&(re.nodes=["a","a"]);var ve=Te(re),de=new Dr([ve]),we=xe.match(ve,de),ne=we&&we.name()||gs(ie);w.push({id:ve.id,geometry:ve.geometry(de),type:ne,name:q.display_name,extent:new le([parseFloat(q.boundingbox[3]),parseFloat(q.boundingbox[0])],[parseFloat(q.boundingbox[2]),parseFloat(q.boundingbox[1])])})}}),T.match(/^[0-9]+$/)&&(w.push({id:"n"+T,geometry:"point",type:S("inspector.node"),name:T}),w.push({id:"w"+T,geometry:"line",type:S("inspector.way"),name:T}),w.push({id:"r"+T,geometry:"relation",type:S("inspector.relation"),name:T})),w}function y(){var w=o.property("value"),E=g();l.classed("filtered",w.length);var A=l.selectAll(".no-results-item").data([0]).enter().append("button").property("disabled",!0).attr("class","no-results-item").call(Z("#rapid-icon-alert","pre-text"));A.append("span").attr("class","entity-name"),l.selectAll(".no-results-item .entity-name").html(S.html("geocoder.no_results_worldwide")),K.geocoder&&l.selectAll(".geocode-item").data([0]).enter().append("button").attr("class","geocode-item secondary-action").on("click",b).append("div").attr("class","label").append("span").attr("class","entity-name").html(S.html("geocoder.search")),l.selectAll(".no-results-item").style("display",w.length&&!E.length?"block":"none"),l.selectAll(".geocode-item").style("display",w&&e===void 0?"block":"none"),l.selectAll(".feature-list-item").data([-1]).remove();var T=l.selectAll(".feature-list-item").data(E,function(I){return I.id}),k=T.enter().insert("button",".geocode-item").attr("class","feature-list-item").on("mouseover",v).on("mouseout",x).on("click",_),C=k.append("div").attr("class","label");C.each(function(I){H(this).call(Z("#rapid-icon-"+I.geometry,"pre-text"))}),C.append("span").attr("class","entity-type").html(function(I){return I.type}),C.append("span").attr("class","entity-name").html(function(I){return I.name}),k.style("opacity",0).transition().style("opacity",1),T.order(),T.exit().remove()}function v(w,E){E.id!==-1&&ct([E.id],!0,t)}function x(w,E){E.id!==-1&&ct([E.id],!1,t)}function _(w,E){w.preventDefault(),E.location?t.map().centerZoomEase([E.location[1],E.location[0]],19):E.entity?(ct([E.id],!1,t),t.map().zoomToEase(E.entity),t.enter(Se(t,[E.entity.id]))):t.zoomToEntity(E.id)}function b(){K.geocoder.search(o.property("value"),function(w,E){e=E||[],y()})}}return r}var By=dt(t1(),1);function _7(t){var e=ee("entity-issues.reference.expanded"),r=e===null?!0:e==="true",i=[],n=[],s,o=mt("entity-issues",t).shouldDisplay(function(){return n.length>0}).label(function(){return S("inspector.title_count",{title:S.html("issues.list_title"),count:n.length})}).disclosureContent(c);t.validator().on("validated.entity_issues",function(){a(),o.reRender()}).on("focusedIssue.entity_issues",function(u){l(u.id)});function a(){n=t.validator().getSharedEntityIssues(i,{includeDisabledRules:!0})}function l(u){s=u,o.selection().selectAll(".issue-container").classed("active",function(d){return d.id===s})}function c(u){u.classed("grouped-items-area",!0),s=n.length>0?n[0].id:null;var d=u.selectAll(".issue-container").data(n,function(w){return w.key});d.exit().remove();var h=d.enter().append("div").attr("class","issue-container"),p=h.append("div").attr("class",function(w){return"issue severity-"+w.severity}).on("mouseover.highlight",function(w,E){var A=E.entityIds.filter(function(T){return i.indexOf(T)===-1});ct(A,!0,t)}).on("mouseout.highlight",function(w,E){var A=E.entityIds.filter(function(T){return i.indexOf(T)===-1});ct(A,!1,t)}),m=p.append("div").attr("class","issue-label"),g=m.append("button").attr("class","issue-text").on("click",function(w,E){l(E.id);var A=E.extent(t.graph());if(A){var T=Math.max(t.map().zoom(),19);t.map().centerZoomEase(A.center(),T)}});g.each(function(w){var E="#rapid-icon-"+(w.severity==="warning"?"alert":"error");H(this).call(Z(E,"issue-icon"))}),g.append("span").attr("class","issue-message");var y=m.append("button").attr("class","issue-info-button").attr("title",S("icons.information")).call(Z("#rapid-icon-inspect"));y.on("click",function(w){w.stopPropagation(),w.preventDefault(),this.blur();var E=H(this.parentNode.parentNode.parentNode),A=E.selectAll(".issue-info"),T=A.classed("expanded");r=!T,ee("entity-issues.reference.expanded",r),T?A.transition().duration(200).style("max-height","0px").style("opacity","0").on("end",function(){A.classed("expanded",!1)}):A.classed("expanded",!0).transition().duration(200).style("max-height","200px").style("opacity","1").on("end",function(){A.style("max-height",null)})}),p.append("ul").attr("class","issue-fix-list"),h.append("div").attr("class","issue-info"+(r?" expanded":"")).style("max-height",r?null:"0").style("opacity",r?"1":"0").each(function(w){typeof w.reference=="function"?H(this).call(w.reference):H(this).html(S.html("inspector.no_documentation_key"))}),d=d.merge(h).classed("active",function(w){return w.id===s}),d.selectAll(".issue-message").html(function(w){return w.message(t)});var v=d.selectAll(".issue-fix-list"),x=v.selectAll(".issue-fix-item").data(function(w){return w.fixes?w.fixes(t):[]},function(w){return w.id});x.exit().remove();var _=x.enter().append("li").attr("class","issue-fix-item"),b=_.append("button").on("click",function(w,E){H(this).attr("disabled")||!E.onClick||E.issue.dateLastRanFix&&new Date-E.issue.dateLastRanFix<1e3||(E.issue.dateLastRanFix=new Date,ct(E.issue.entityIds.concat(E.entityIds),!1,t),new Promise(function(A,T){E.onClick(t,A,T),E.onClick.length<=1&&A()}).then(function(){t.validator().validate()}))}).on("mouseover.highlight",function(w,E){ct(E.entityIds,!0,t)}).on("mouseout.highlight",function(w,E){ct(E.entityIds,!1,t)});b.each(function(w){var E=w.icon||"rapid-icon-wrench";H(this).call(Z(`#${E}`,"fix-icon"))}),b.append("span").attr("class","fix-message").html(function(w){return w.title}),_.merge(x).selectAll("button").classed("actionable",function(w){return w.onClick}).attr("disabled",function(w){return w.onClick?null:"true"}).attr("title",function(w){return w.disabledReason?w.disabledReason:null})}return o.entityIDs=function(u){return arguments.length?((!i||!u||!ni(i,u))&&(i=u,s=null,a()),o):i},o}function X1(){let t,e;function r(p,m){return p.icon?p.icon:m==="line"?"rapid-other-line":m==="vertex"?p.isFallback()?"":"temaki-vertex":"maki-marker-stroked"}function i(p,m){let y=he.hex2string(m.fill.color),v=m.fill.alpha,x="M9.5,7.5 L25.5,7.5 L28.5,12.5 L49.5,12.5 C51.709139,12.5 53.5,14.290861 53.5,16.5 L53.5,43.5 C53.5,45.709139 51.709139,47.5 49.5,47.5 L10.5,47.5 C8.290861,47.5 6.5,45.709139 6.5,43.5 L6.5,12.5 L9.5,7.5 Z";p.append("svg").attr("class","preset-icon-category-border").attr("width","60px").attr("height","60px").attr("viewBox","0 0 60 60").append("path").attr("fill",y).attr("fill-opacity",v).attr("stroke",y).attr("d",x)}function n(p){let g="M 0,0 C -2,-2 -8,-10 -8,-15 C -8,-19 -4,-23 0,-23 C 4,-23 8,-19 8,-15 C 8,-10 2,-2 0,0 Z";p.append("svg").attr("class","preset-icon-point-border").attr("width","60px").attr("height","60px").attr("viewBox","-10 -27 20 30").append("path").attr("d",g)}function s(p){p.append("svg").attr("class","preset-icon-vertex-border").attr("width","60px").attr("height","60px").attr("viewBox","0 0 60 60").append("circle").attr("cx",30).attr("cy",30).attr("r",40/2)}function o(p,m){let b=he.hex2string(m.fill.color),w=m.fill.alpha,E=p.append("svg").attr("class","preset-icon-area-border").attr("width","60px").attr("height","60px").attr("viewBox","0 0 60 60");E.append("path").attr("fill",b).attr("fill-opacity",w).attr("stroke",b).attr("d","M10 10 L10 50 L50 50 L50 10 Z");let A=2.5;[[10,10],[10,50],[50,50],[50,10]].forEach(([k,C])=>{E.append("circle").attr("class","vertex").attr("cx",k).attr("cy",C).attr("r",A)});let T=1.25;[[10,30],[50,30],[30,10],[30,50]].forEach(([k,C])=>{E.append("circle").attr("class","midpoint").attr("cx",k).attr("cy",C).attr("r",T)})}function a(p,m){let y=Math.round(43.199999999999996),v=Math.round(60*.6),x=(60-v)/2,_=x+v,b=he.hex2string(m.casing.color),w=he.hex2string(m.stroke.color),E=m.stroke.dash,A=Array.isArray(E),T=p.append("svg").attr("class","preset-icon-line").attr("width","60px").attr("height","60px").attr("viewBox","0 0 60 60");T.append("path").attr("class","casing").attr("stroke",b).attr("stroke-opacity",A?1:.5).attr("d",`M${x} ${y} L${_} ${y}`),T.append("path").attr("class","stroke").attr("stroke",w).attr("stroke-dasharray",A?E.map(C=>C*.75).join(" "):null).attr("d",`M${x} ${y} L${_} ${y}`);let k=3;[[x-1,y],[_+1,y]].forEach(([C,I])=>{T.append("circle").attr("class","vertex").attr("cx",C).attr("cy",I).attr("r",k)})}function l(p){p.append("div").attr("class","preset-icon-route").call(Z("#rapid-route","rapid-icon lowered"))}function c(p,m,g,y){p.append("div").attr("class","preset-icon").call(Z(`#${m}`,g.join(" "))),p.selectAll(".preset-icon svg.icon").attr("color",y)}function u(p,m){p.selectAll("img.image-icon").data([m]).enter().append("img").attr("class","image-icon").attr("src",m).on("load",()=>p.classed("showing-img",!0)).on("error",()=>p.classed("showing-img",!1))}function d(p){let m=p.selectAll(".preset-icon-container").data([0]);m=m.enter().append("div").attr("class","preset-icon-container").merge(m).html("");let g=t,y=e;if(!g||!y)return;let v=typeof g.setTags=="function",x=!v,_=v?g.setTags({},y):{};for(let P in _)_[P]==="*"&&(_[P]="yes");y==="relation"&&(_.type==="route"||_.type==="waterway")&&(y="route");let w=(ee("preferences.privacy.thirdpartyicons")??"true")==="true"&&g.imageURL,E=r(g,y),A=v&&y==="vertex",T=v&&y==="line",k=v&&y==="area",C=v&&y==="route"&&g.id!=="type/route",I=u5(_);if(m.classed("showing-img",!!w),x&&i(m,I),A&&s(m),k&&o(m,I),T&&a(m,I),C&&l(m),E){let P=T||C,N=x||T||C,M=/^rapid-/.test(E),D=[];M&&D.push("rapid-icon"),N&&D.push("shrunk"),P&&D.push("raised");let F="#333";(T||C)&&M&&(F=he.hex2string(I.stroke.color)),c(m,E,D,F)}w&&u(m,w)}h.preset=function(p){return arguments.length?(t=p,h):t},h.geometry=function(p){return arguments.length?(e=p,h):e};function h(p){p.call(d)}return h}function b7(t){var e=fe("choose"),r=[],i=[],n,s=mt("feature-type",t).label(S.html("inspector.feature_type")).disclosureContent(o);function o(l){l.classed("preset-list-item",!0),l.classed("mixed-types",i.length>1);var c=l.selectAll(".preset-list-button-wrap").data([0]).enter().append("div").attr("class","preset-list-button-wrap"),u=c.append("button").attr("class","preset-list-button preset-reset").call(Ae().title(S.html("inspector.back_tooltip")).placement("bottom"));u.append("div").attr("class","preset-icon-container"),u.append("div").attr("class","label").append("div").attr("class","label-inner"),c.append("div").attr("class","accessory-buttons");var d=l.selectAll(".tag-reference-body-wrap").data([0]);d=d.enter().append("div").attr("class","tag-reference-body-wrap").merge(d),n&&(l.selectAll(".preset-list-button-wrap .accessory-buttons").style("display",i.length===1?null:"none").call(n.button),d.style("display",i.length===1?null:"none").call(n.body)),l.selectAll(".preset-reset").on("click",function(){e.call("choose",this,i)}).on("pointerdown pointerup mousedown mouseup",function(y){y.preventDefault(),y.stopPropagation()});var h=a();l.select(".preset-list-item button").call(X1().geometry(i.length===1?h.length===1&&h[0]:null).preset(i.length===1?i[0]:xe.item("point")));var p=i.length===1?[i[0].nameLabel(),i[0].subtitleLabel()].filter(Boolean):[S("inspector.multiple_types")],m=l.select(".label-inner"),g=m.selectAll(".namepart").data(p,function(y){return y});g.exit().remove(),g.enter().append("div").attr("class","namepart").html(function(y){return y})}s.entityIDs=function(l){return arguments.length?(r=l,s):r},s.presets=function(l){return arguments.length?(ni(l,i)||(i=l,i.length===1&&(n=yo(i[0].reference(),t).showing(!1))),s):i};function a(){var l={};for(var c in r){var u=t.graph().geometry(r[c]);l[u]||(l[u]=0),l[u]+=1}return Object.keys(l).sort(function(d,h){return l[h]-l[d]})}return ge(s,e,"on")}function w7(t){var e=mt("preset-fields",t).label(S.html("inspector.fields")).disclosureContent(c),r=fe("change","revert"),i=T0(t),n,s,o=[],a,l;function c(u){if(!s){var d=t.graph(),h=Object.keys(l.reduce(function(b,w){return b[d.entity(w).geometry(d)]=!0,b},{})),p=xe,m=[],g=[],y;o.forEach(function(b){var w=b.fields(),E=b.moreFields();m=jt(m,w),g=jt(g,E),y?y=y.filter(function(A){return w.indexOf(A)!==-1||E.indexOf(A)!==-1}):y=jt(w,E)});var v=m.filter(function(b){return y.indexOf(b)!==-1}),x=g.filter(function(b){return y.indexOf(b)!==-1});s=[],v.forEach(function(b){b.matchAllGeometry(h)&&s.push(vs(t,b,l))});var _=jt(x,p.universal());_.sort(function(b,w){return b.label().localeCompare(w.label(),se.localeCode())}),_.forEach(function(b){v.indexOf(b)===-1&&b.matchAllGeometry(h)&&s.push(vs(t,b,l,{show:!1}))}),s.forEach(function(b){b.on("change",function(w,E){r.call("change",b,l,w,E)}).on("revert",function(w){r.call("revert",b,w)})})}s.forEach(function(b){b.state(n).tags(a)}),u.call(i.fieldsArr(s).state(n).klass("grouped-items-area")),u.selectAll(".wrap-form-field input").on("keydown",function(b){b.keyCode===13&&t.container().select(".combobox").empty()&&t.enter("browse")})}return e.presets=function(u){return arguments.length?((!o||!u||!ni(o,u))&&(o=u,s=null),e):o},e.state=function(u){return arguments.length?(n=u,e):n},e.tags=function(u){return arguments.length?(a=u,e):a},e.entityIDs=function(u){return arguments.length?((!u||!l||!ni(l,u))&&(l=u,s=null),e):l},ge(e,r,"on")}function E7(t,e,r){return function(i){return i.replace(i.entity(t).moveMember(e,r))}}function S7(t){var e=mt("raw-member-editor",t).shouldDisplay(function(){if(!i||i.length!==1)return!1;var d=t.hasEntity(i[0]);return d&&d.type==="relation"}).label(function(){var d=t.hasEntity(i[0]);if(!d)return"";var h=d.members.length>n?">":"",p=h+d.members.slice(0,n).length;return S("inspector.title_count",{title:S.html("inspector.members"),count:p})}).disclosureContent(u),r=K.taginfo,i,n=1e3;function s(d,h){d.preventDefault(),H(this.parentNode).classed("tag-reference-loading",!0),t.loadEntity(h.id,function(){e.reRender()})}function o(d,h){d.preventDefault();var p=t.entity(h.id);t.map().zoomToEase(p),ct([h.id],!0,t)}function a(d,h){d.preventDefault(),ct([h.id],!1,t);var p=t.entity(h.id),m=t.map().extent();p.intersects(m,t.graph())||t.map().zoomToEase(p),t.enter(Se(t,[h.id]))}function l(d,h){var p=h.role,m=t.cleanRelationRole(H(this).property("value"));if(p!==m){var g={id:h.id,type:h.type,role:m};t.perform(Ja(h.relation.id,g,h.index),S("operations.change_role.annotation",{n:1})),t.validator().validate()}}function c(d,h){ct([h.id],!1,t),t.perform(el(h.relation.id,h.index),S("operations.delete_member.annotation",{n:1})),t.hasEntity(h.relation.id)?t.validator().validate():t.enter("browse")}function u(d){var h=i[0],p=[],m=t.entity(h);m.members.slice(0,n).forEach(function(A,T){p.push({index:T,id:A.id,type:A.type,role:A.role,relation:m,member:t.hasEntity(A.id),domId:ss(h+"-member-"+T)})});var g=d.selectAll(".member-list").data([0]);g=g.enter().append("ul").attr("class","member-list").merge(g);var y=g.selectAll("li").data(p,function(A){return Te.key(A.relation)+","+A.index+","+(A.member?Te.key(A.member):"incomplete")});y.exit().each(E).remove();var v=y.enter().append("li").attr("class","member-row form-field").classed("member-incomplete",function(A){return!A.member});v.each(function(A){var T=H(this),k=T.append("label").attr("class","field-label").attr("for",A.domId);if(A.member){T.on("mouseover",function(){ct([A.id],!0,t)}).on("mouseout",function(){ct([A.id],!1,t)});var C=k.append("span").attr("class","label-text").append("a").attr("href","#").on("click",a);C.append("span").attr("class","member-entity-type").html(function(P){var N=xe.match(P.member,t.graph());return N&&N.name()||gs(P.member.id)}),C.append("span").attr("class","member-entity-name").html(function(P){return qt(P.member)}),k.append("button").attr("title",S("icons.remove")).attr("class","remove member-delete").call(Z("#rapid-operation-delete")),k.append("button").attr("class","member-zoom").attr("title",S("icons.zoom_to")).call(Z("#rapid-icon-framed-dot","monochrome")).on("click",o)}else{var I=k.append("span").attr("class","label-text");I.append("span").attr("class","member-entity-type").html(S.html("inspector."+A.type,{id:A.id})),I.append("span").attr("class","member-entity-name").html(S.html("inspector.incomplete",{id:A.id})),k.append("button").attr("class","member-download").attr("title",S("icons.download")).call(Z("#rapid-icon-load")).on("click",s)}});var x=v.append("div").attr("class","form-field-input-wrap form-field-input-member");x.append("input").attr("class","member-role").attr("id",function(A){return A.domId}).property("type","text").attr("placeholder",S("inspector.role")).call(qe),r&&x.each(w),y=y.merge(v).order(),y.select("input.member-role").property("value",function(A){return A.role}).on("blur",l).on("change",l),y.select("button.member-delete").on("click",c);var _,b;y.call(V4().on("start",function(A){_={x:A.x,y:A.y},b=null}).on("drag",function(A){var T=A.x-_.x,k=A.y-_.y;if(!(!H(this).classed("dragging")&&Math.sqrt(Math.pow(T,2)+Math.pow(k,2))<=5)){var C=y.nodes().indexOf(this);H(this).classed("dragging",!0),b=null,d.selectAll("li.member-row").style("transform",function(I,P){var N=H(this).node();return C===P?"translate("+T+"px, "+k+"px)":P>C&&A.y>N.offsetTop?((b===null||P>b)&&(b=P),"translateY(-100%)"):P<C&&A.y<N.offsetTop+N.offsetHeight?((b===null||P<b)&&(b=P),"translateY(100%)"):null})}}).on("end",function(A,T){if(H(this).classed("dragging")){var k=y.nodes().indexOf(this);H(this).classed("dragging",!1),d.selectAll("li.member-row").style("transform",null),b!==null&&(t.perform(E7(T.relation.id,k,b),S("operations.reorder_members.annotation")),t.validator().validate())}}));function w(A){var T=H(this),k=T.selectAll("input.member-role"),C=k.property("value");function I(P,N){for(var M=[],D=[],F=0;F<N.length;F++)N[F].value.substring(0,P.length)===P?M.push(N[F]):D.push(N[F]);return M.concat(D)}k.call(At(t,"member-role").fetcher(function(P,N){var M;A.member?M=t.graph().geometry(A.member.id):A.type==="relation"?M="relation":A.type==="way"?M="line":M="point";var D=m.tags.type;r.roles({debounce:!0,rtype:D||"",geometry:M,query:P},function(F,L){F||N(I(P,L))})}).on("cancel",function(){k.property("value",C)}))}function E(){var A=H(this);A.selectAll("input.member-role").call(At.off,t)}}return e.entityIDs=function(d){return arguments.length?(i=d,e):i},e}function uk(t,e){return function(r){e.sort((n,s)=>s-n);for(var i in e)r=el(t,e[i])(r);return r}}function T7(t){var e=mt("raw-membership-editor",t).shouldDisplay(function(){return s&&s.length}).label(function(){var v=l(),x=v.length>a?">":"",_=x+v.slice(0,a).length;return S("inspector.title_count",{title:S.html("inspector.relations"),count:_})}).disclosureContent(y),r=K.taginfo,i=At(t,"parent-relation").minItems(1).fetcher(g).itemsMouseEnter(function(v,x){x.relation&&ct([x.relation.id],!0,t)}).itemsMouseLeave(function(v,x){x.relation&&ct([x.relation.id],!1,t)}),n=!1,s=[],o,a=1e3;function l(){for(var v=[],x=0;x<s.length;x++){var _=t.graph().hasEntity(s[x]);if(_&&(x===0?v=t.graph().parentRelations(_):v=Ir(v,t.graph().parentRelations(_)),!v.length))break}return v}function c(){var v=[],x=l().slice(0,a),_=s.length>1,b,w,E,A,T,k;for(b=0;b<x.length;b++){for(w=x[b],E={relation:w,members:[],hash:Te.key(w)},A=0;A<w.members.length;A++)T=w.members[A],s.indexOf(T.id)!==-1&&(k=Object.assign({},T,{index:A}),E.members.push(k),E.hash+=","+A.toString(),_||(v.push(E),E={relation:w,members:[],hash:Te.key(w)}));E.members.length&&v.push(E)}return v.forEach(function(C){C.domId=ss("membership-"+C.relation.id);var I=[];C.members.forEach(function(P){I.indexOf(P.role)===-1&&I.push(P.role)}),C.role=I.length===1?I[0]:I}),v}function u(v,x){v.preventDefault(),ct([x.relation.id],!1,t),t.enter(Se(t,[x.relation.id]))}function d(v,x){v.preventDefault();var _=t.entity(x.relation.id);t.map().zoomToEase(_),ct([x.relation.id],!0,t)}function h(v,x){if(x!==0&&!n){var _=t.cleanRelationRole(H(this).property("value"));if(!(!_.trim()&&typeof x.role!="string")){var b=x.members.filter(function(w){return w.role!==_});b.length&&(n=!0,t.perform(function(E){return b.forEach(function(A){var T=Object.assign({},A,{role:_});delete T.index,E=Ja(x.relation.id,T,A.index)(E)}),E},S("operations.change_role.annotation",{n:b.length})),t.validator().validate()),n=!1}}}function p(v,x){this.blur(),o=!1;function _(w,E,A){return function(T){for(var k in E){var C={id:E[k],type:T.entity(E[k]).type,role:A};T=Ql(w,C)(T)}return T}}if(v.relation)t.perform(_(v.relation.id,s,x),S("operations.add_member.annotation",{n:s.length})),t.validator().validate();else{var b=Cr();t.perform(Wt(b),_(b.id,s,x),S("operations.add.annotation.relation")),t.enter(Se(t,[b.id]).newFeature(!0))}}function m(v,x){if(this.blur(),x!==0){ct([x.relation.id],!1,t);var _=x.members.map(function(b){return b.index});t.perform(uk(x.relation.id,_),S("operations.delete_member.annotation",{n:s.length})),t.validator().validate()}}function g(v,x){var _={relation:null,value:S("inspector.new_relation"),display:S.html("inspector.new_relation")},b=s[0],w=[],E=t.graph();function A(C){var I=xe.match(C,E),P=I&&I.name()||S("inspector.relation"),N=qt(C)||"";return P+" "+N}var T=v&&t.hasEntity(v.toLowerCase());if(T&&T.type==="relation"&&T.id!==b)w.push({relation:T,value:A(T)+" "+T.id});else{t.history().intersects(t.map().extent()).forEach(function(C){if(!(C.type!=="relation"||C.id===b)){var I=A(C);v&&(I+" "+C.id).toLowerCase().indexOf(v.toLowerCase())===-1||w.push({relation:C,value:I})}}),w.sort(function(C,I){return Cr.creationOrder(C.relation,I.relation)});var k=Object.values(yr(w,"value")).filter(function(C){return C.length>1});k.forEach(function(C){C.forEach(function(I){I.value+=" "+I.relation.id})})}w.forEach(function(C){C.title=C.value}),w.unshift(_),x(w)}function y(v){var x=c(),_=v.selectAll(".member-list").data([0]);_=_.enter().append("ul").attr("class","member-list").merge(_);var b=_.selectAll("li.member-row-normal").data(x,function(R){return R.hash});b.exit().each(O).remove();var w=b.enter().append("li").attr("class","member-row member-row-normal form-field");w.on("mouseover",function(R,U){ct([U.relation.id],!0,t)}).on("mouseout",function(R,U){ct([U.relation.id],!1,t)});var E=w.append("label").attr("class","field-label").attr("for",function(R){return R.domId}),A=E.append("span").attr("class","label-text").append("a").attr("href","#").on("click",u);A.append("span").attr("class","member-entity-type").html(function(R){var U=xe.match(R.relation,t.graph());return U&&U.name()||S("inspector.relation")}),A.append("span").attr("class","member-entity-name").html(function(R){let U=xe.match(R.relation,t.graph());return qt(R.relation,U.suggestion)}),E.append("button").attr("class","remove member-delete").call(Z("#rapid-operation-delete")).on("click",m),E.append("button").attr("class","member-zoom").attr("title",S("icons.zoom_to")).call(Z("#rapid-icon-framed-dot","monochrome")).on("click",d);var T=w.append("div").attr("class","form-field-input-wrap form-field-input-member");T.append("input").attr("class","member-role").attr("id",function(R){return R.domId}).property("type","text").property("value",function(R){return typeof R.role=="string"?R.role:""}).attr("title",function(R){return Array.isArray(R.role)?R.role.filter(Boolean).join(`
`):R.role}).attr("placeholder",function(R){return Array.isArray(R.role)?S("inspector.multiple_roles"):S("inspector.role")}).classed("mixed",function(R){return Array.isArray(R.role)}).call(qe).on("blur",h).on("change",h),r&&T.each(B);var k=_.selectAll(".member-row-new").data(o?[0]:[]);k.exit().remove();var C=k.enter().append("li").attr("class","member-row member-row-new form-field"),I=C.append("label").attr("class","field-label");I.append("input").attr("placeholder",S("inspector.choose_relation")).attr("type","text").attr("class","member-entity-input").call(qe),I.append("button").attr("class","remove member-delete").call(Z("#rapid-operation-delete")).on("click",function(){_.selectAll(".member-row-new").remove()});var P=C.append("div").attr("class","form-field-input-wrap form-field-input-member");P.append("input").attr("class","member-role").property("type","text").attr("placeholder",S("inspector.role")).call(qe),k=k.merge(C),k.selectAll(".member-entity-input").on("blur",L).call(i.on("accept",F).on("cancel",L));var N=v.selectAll(".add-row").data([0]),M=N.enter().append("div").attr("class","add-row"),D=M.append("button").attr("class","add-relation");D.call(Z("#rapid-icon-plus","light")),D.call(Ae().title(S.html("inspector.add_to_relation")).placement(se.textDirection()==="ltr"?"right":"left")),M.append("div").attr("class","space-value"),M.append("div").attr("class","space-buttons"),N=N.merge(M),N.select(".add-relation").on("click",function(){o=!0,e.reRender(),_.selectAll(".member-entity-input").node().focus()});function F(R){if(!R){L();return}R.relation&&ct([R.relation.id],!1,t);var U=t.cleanRelationRole(_.selectAll(".member-row-new .member-role").property("value"));p(R,U)}function L(){var R=k.selectAll(".member-entity-input");R.property("value",""),t.surface().selectAll(".highlighted").classed("highlighted",!1)}function B(R){var U=H(this),G=U.selectAll("input.member-role"),$=G.property("value");function q(ie,Q){for(var re=[],ve=[],de=0;de<Q.length;de++)Q[de].value.substring(0,ie.length)===ie?re.push(Q[de]):ve.push(Q[de]);return re.concat(ve)}G.call(At(t,"member-role").fetcher(function(ie,Q){var re=R.relation.tags.type;r.roles({debounce:!0,rtype:re||"",geometry:t.graph().geometry(s[0]),query:ie},function(ve,de){ve||Q(q(ie,de))})}).on("cancel",function(){G.property("value",$)}))}function O(){var R=H(this);R.selectAll("input.member-role").call(At.off,t)}}return e.entityIDs=function(v){return arguments.length?(s=v,o=!1,e):s},e}function A7(t){let e=mt("selected-features",t).shouldDisplay(i).label(n).disclosureContent(a);e.entityIDs=function(l){return arguments.length?(r=l,e):r};let r=[];function i(){return r.length>1}function n(){return S("inspector.title_count",{title:S.html("inspector.features"),count:r.length})}function s(l,c){t.enter(Se(t,[c.id]))}function o(l,c){let u=r.slice(),d=u.indexOf(c.id);d>-1&&(u.splice(d,1),t.enter(Se(t,u)))}function a(l){let c=l.selectAll(".feature-list").data([0]);c=c.enter().append("ul").attr("class","feature-list").merge(c);let u=r.map(m=>t.hasEntity(m)).filter(Boolean),d=c.selectAll(".feature-list-item").data(u,Te.key);d.exit().remove();let h=d.enter().append("li").attr("class","feature-list-item").each((m,g,y)=>{H(y[g]).on("mouseover",()=>ct([m.id],!0,t)).on("mouseout",()=>ct([m.id],!1,t))}),p=h.append("button").attr("class","label").on("click",s);p.append("span").attr("class","entity-geom-icon").call(Z("","pre-text")),p.append("span").attr("class","entity-type"),p.append("span").attr("class","entity-name"),h.append("button").attr("class","close").attr("title",S("icons.deselect")).on("click",o).call(Z("#rapid-icon-close")),d=d.merge(h),d.selectAll(".entity-geom-icon use").attr("href",(m,g,y)=>"#rapid-icon-"+H(y[g])._groups[0][0].parentNode.parentNode.__data__.geometry(t.graph())),d.selectAll(".entity-type").html(m=>xe.match(m,t.graph()).name()),d.selectAll(".entity-name").html(m=>{let g=t.entity(m.id);return qt(g)})}return t.history().on("change.selectionList",l=>{l&&e.reRender()}),e}function C7(t){var e=fe("choose"),r="select",i=!1,n=!1,s,o,a=[],l,c;function u(g,y){var v={},x={},_=new Set,b=g.map(function(E){return y.hasEntity(E)}).filter(Boolean);b.forEach(function(E){var A=Object.keys(E.tags).filter(Boolean);A.forEach(function(T){_.add(T)})}),b.forEach(function(E){_.forEach(function(A){var T=E.tags[A];v.hasOwnProperty(A)?Array.isArray(v[A])?v[A].indexOf(T)===-1&&v[A].push(T):v[A]!==T&&(v[A]=[v[A],T]):v[A]=T;var k=A+"="+T;x[k]||(x[k]=0),x[k]+=1})});for(var w in v)Array.isArray(v[w])&&(v[w]=v[w].sort(function(E,A){var T=T,k=x[T+"="+A],C=x[T+"="+E];return k!==C?k-C:A&&E?E.localeCompare(A):E?1:-1}));return v}function d(g){var y=u(o,t.graph()),v=g.selectAll(".header").data([0]),x=v.enter().append("div").attr("class","header fillL");x.append("button").attr("class","preset-reset preset-choose").call(Z(se.textDirection()==="rtl"?"#rapid-icon-forward":"#rapid-icon-backward")),x.append("button").attr("class","close").on("click",function(){t.enter("browse")}).call(Z(n?"#rapid-icon-apply":"#rapid-icon-close")),x.append("h3"),v=v.merge(x),v.selectAll("h3").html(o.length===1?S.html("inspector.edit"):S.html("rapid_multiselect")),v.selectAll(".preset-reset").on("click",function(){e.call("choose",this,a)});var _=g.selectAll(".inspector-body").data([0]),b=_.enter().append("div").attr("class","entity-editor inspector-body");_=_.merge(b),c||(c=[A7(t),b7(t).on("choose",function(E){e.call("choose",this,E)}),_7(t),w7(t).on("change",h).on("revert",p),rl("raw-tag-editor",t).on("change",h),S7(t),T7(t)]),c.forEach(function(E){E.entityIDs&&E.entityIDs(o),E.presets&&E.presets(a),E.tags&&E.tags(y),E.state&&E.state(r),_.call(E.render)}),t.history().on("change.entity-editor",w);function w(E){if(!g.selectAll(".entity-editor").empty()&&r!=="hide"){var A=!E||E.didChange.properties||E.didChange.addition||E.didChange.deletion;if(A&&(o=o.filter(t.hasEntity),!!o.length)){var T=a.length===1&&a[0];m();var k=t.graph();d.modified(s!==k),d(g),T&&a.length===1&&T!==a[0]&&t.container().selectAll(".entity-editor button.preset-reset .label").style("background-color","#fff").transition().duration(750).style("background-color",null)}}}}function h(g,y,v){var x=[];for(var _ in g){var b=g[_],w=t.entity(b),E=Object.assign({},w.tags);for(var A in y)if(A&&!(w.__fbid__&&A==="source"&&(w.tags.source==="digitalglobe"||w.tags.source==="maxar"))){var T=y[A];(T!==void 0||E.hasOwnProperty(A))&&(E[A]=T)}v||(E=Q9(E)),(0,By.default)(w.tags,E)||x.push(er(b,E))}if(x.length){var k=function(I){return x.forEach(function(P){I=P(I)}),I},C=S("operations.change_tags.annotation");i?t.overwrite(k,C):(t.perform(k,C),i=!!v)}v||t.validator().validate()}function p(g){var y=[];for(var v in o){var x=o[v],_=t.graph().base.entities.get(x),b={};for(var w in g){var E=g[w];b[E]=_?_.tags[E]:void 0}var A=t.entity(x),T=Object.assign({},A.tags);for(var k in b)if(k){var C=b[k];(C!==void 0||T.hasOwnProperty(k))&&(T[k]=C)}T=Q9(T),(0,By.default)(A.tags,T)||y.push(er(x,T))}if(y.length){var I=function(N){return y.forEach(function(M){N=M(N)}),N},P=S("operations.change_tags.annotation");i?t.overwrite(I,P):(t.perform(I,P),i=!1)}t.validator().validate()}d.modified=function(g){return arguments.length?(n=g,d):n},d.state=function(g){return arguments.length?(r=g,d):r},d.entityIDs=function(g){return arguments.length?(s=t.graph(),i=!1,g&&o&&ni(o,g)?d:(o=g,m(!0),d.modified(!1))):o},d.newFeature=function(g){return arguments.length?(l=g,d):l};function m(g){var y=t.graph(),v={};for(var x in o){var _=y.hasEntity(o[x]);if(!_)return;var b=xe.match(_,y);v[b.id]||(v[b.id]=0),v[b.id]+=1}var w=Object.keys(v).sort(function(A,T){return v[T]-v[A]}).map(function(A){return xe.item(A)});if(!g){var E=a.length===1&&!a[0].isFallback()&&Object.keys(a[0].addTags||{}).length===0;if(E&&w.length===1&&w[0].isFallback())return}d.presets(w)}return d.presets=function(g){return arguments.length?(ni(g,a)||(a=g),d):a},ge(d,e,"on")}function k7(t){var e=fe("cancel","choose"),r,i,n,s=!1;function o(p){if(!r)return;var m=xe.matchAllGeometry(h());p.html("");var g=p.append("div").attr("class","header fillL"),y=g.append("h3").html(S.html("inspector.choose"));g.append("button").attr("class","preset-choose").on("click",function(){e.call("cancel",this)}).call(Z(se.textDirection()==="rtl"?"#rapid-icon-backward":"#rapid-icon-forward"));function v(k){E.property("value").length===0&&(k.keyCode===rt.keyCodes["\u232B"]||k.keyCode===rt.keyCodes["\u2326"])?(k.preventDefault(),k.stopPropagation(),on(t,r)()):E.property("value").length===0&&(k.ctrlKey||k.metaKey)&&k.keyCode===rt.keyCodes.z?(k.preventDefault(),k.stopPropagation(),t.undo()):!k.ctrlKey&&!k.metaKey&&(H(this).on("keydown",x),x.call(this,k))}function x(k){if(k.keyCode===rt.keyCodes["\u2193"]&&E.node().selectionStart===E.property("value").length){k.preventDefault(),k.stopPropagation();var C=T.selectAll(".preset-list-button");C.empty()||C.nodes()[0].focus()}}function _(k){var C=E.property("value");k.keyCode===13&&C.length&&T.selectAll(".preset-list-item:first-child").each(function(I){I.choose.call(this)})}function b(){var k=E.property("value");T.classed("filtered",k.length);var C,I;k.length?(C=m.search(k,h()[0],i),I=S("inspector.results",{n:C.collection.length,search:k})):(C=xe.defaults(h()[0],36,!t.inIntro(),i),I=S("inspector.choose")),T.call(a,C),y.html(I)}var w=p.append("div").attr("class","search-header");w.call(Z("#rapid-icon-search","pre-text"));var E=w.append("input").attr("class","preset-search-input").attr("placeholder",S("inspector.search")).attr("type","search").call(qe).on("keydown",v).on("keypress",_).on("input",Gt(b));s&&(E.node().focus(),setTimeout(function(){E.node().focus()},0));var A=p.append("div").attr("class","inspector-body"),T=A.append("div").attr("class","preset-list").call(a,xe.defaults(h()[0],36,!t.inIntro(),i));t.features().on("change.preset-list",d)}function a(p,m){m=m.matchAllGeometry(h());var g=m.collection.reduce(function(v,x){return x&&(x.members?x.members.collection.filter(function(_){return _.addable()}).length>1&&v.push(c(x)):x.addable()&&v.push(u(x))),v},[]),y=p.selectAll(".preset-list-item").data(g,function(v){return v.preset.id});y.order(),y.exit().remove(),y.enter().append("div").attr("class",function(v){return"preset-list-item preset-"+v.preset.id.replace("/","-")}).classed("current",function(v){return n.indexOf(v.preset)!==-1}).each(function(v){H(this).call(v)}).style("opacity",0).transition().style("opacity",1),d()}function l(p){var m=H(this.closest(".preset-list-item")),g=H(m.node().parentNode.closest(".preset-list-item"));if(p.keyCode===rt.keyCodes["\u2193"]){p.preventDefault(),p.stopPropagation();var y=H(m.node().nextElementSibling);y.empty()?g.empty()||(y=H(g.node().nextElementSibling)):H(this).classed("expanded")&&(y=m.select(".subgrid .preset-list-item:first-child")),y.empty()||y.select(".preset-list-button").node().focus()}else if(p.keyCode===rt.keyCodes["\u2191"]){p.preventDefault(),p.stopPropagation();var v=H(m.node().previousElementSibling);if(v.empty()?g.empty()||(v=g):v.select(".preset-list-button").classed("expanded")&&(v=v.select(".subgrid .preset-list-item:last-child")),!v.empty())v.select(".preset-list-button").node().focus();else{var x=H(this.closest(".preset-list-pane")).select(".preset-search-input");x.node().focus()}}else p.keyCode===rt.keyCodes[se.textDirection()==="rtl"?"\u2192":"\u2190"]?(p.preventDefault(),p.stopPropagation(),g.empty()||g.select(".preset-list-button").node().focus()):p.keyCode===rt.keyCodes[se.textDirection()==="rtl"?"\u2190":"\u2192"]&&(p.preventDefault(),p.stopPropagation(),m.datum().choose.call(H(this).node()))}function c(p){var m,g,y=!1;function v(x){var _=x.append("div").attr("class","preset-list-button-wrap category");function b(){var T=H(this).classed("expanded"),k=T?se.textDirection()==="rtl"?"#rapid-icon-backward":"#rapid-icon-forward":"#rapid-icon-down";H(this).classed("expanded",!T),H(this).selectAll("div.label-inner svg.icon use").attr("href",k),v.choose()}var w=h(),E=_.append("button").attr("class","preset-list-button").classed("expanded",!1).call(X1().geometry(w.length===1&&w[0]).preset(p)).on("click",b).on("keydown",function(T){T.keyCode===rt.keyCodes[se.textDirection()==="rtl"?"\u2190":"\u2192"]?(T.preventDefault(),T.stopPropagation(),H(this).classed("expanded")||b.call(this,T)):T.keyCode===rt.keyCodes[se.textDirection()==="rtl"?"\u2192":"\u2190"]?(T.preventDefault(),T.stopPropagation(),H(this).classed("expanded")&&b.call(this,T)):l.call(this,T)}),A=E.append("div").attr("class","label").append("div").attr("class","label-inner");A.append("div").attr("class","namepart").call(Z(se.textDirection()==="rtl"?"#rapid-icon-backward":"#rapid-icon-forward","inline")).append("span").html(function(){return p.nameLabel()+"&hellip;"}),m=x.append("div").attr("class","subgrid").style("max-height","0px").style("opacity",0),m.append("div").attr("class","arrow"),g=m.append("div").attr("class","preset-list fillL3")}return v.choose=function(){if(!(!m||!g))if(y)y=!1,m.transition().duration(200).style("opacity","0").style("max-height","0px").style("padding-bottom","0px");else{y=!0;var x=p.members.matchAllGeometry(h());g.call(a,x),m.transition().duration(200).style("opacity","1").style("max-height",200+x.collection.length*190+"px").style("padding-bottom","10px")}},v.preset=p,v}function u(p){function m(g){var y=g.append("div").attr("class","preset-list-button-wrap"),v=h(),x=y.append("button").attr("class","preset-list-button").call(X1().geometry(v.length===1&&v[0]).preset(p)).on("click",m.choose).on("keydown",l),_=x.append("div").attr("class","label").append("div").attr("class","label-inner"),b=[p.nameLabel(),p.subtitleLabel()].filter(Boolean);_.selectAll(".namepart").data(b).enter().append("div").attr("class","namepart").html(function(w){return w}),y.call(m.reference.button),g.call(m.reference.body)}return m.choose=function(){H(this).classed("disabled")||(t.inIntro()||xe.setMostRecent(p,h()[0]),t.perform(function(g){for(var y in r){var v=r[y],x=xe.match(g.entity(v),g);g=Hn(v,x,p)(g)}return g},S("operations.change_tags.annotation")),t.validator().validate(),e.call("choose",this,p))},m.help=function(g){g.stopPropagation(),m.reference.toggle()},m.preset=p,m.reference=yo(p.reference(),t),m}function d(){if(r.every(t.hasEntity)){var p=h(),m=t.container().selectAll(".preset-list .preset-list-button");m.call(Ae().destroyAny),m.each(function(g,y){var v;for(var x in p)if(v=t.features().isHiddenPreset(g.preset,p[x]),v)break;var _=!t.inIntro()&&!!v&&(n.length!==1||g.preset!==n[0]);if(H(this).classed("disabled",_),_){var b=t.features().autoHidden(v);H(this).call(Ae().title(S.html("inspector.hidden_preset."+(b?"zoom":"manual"),{features:S.html("feature."+v+".description")})).placement(y<2?"bottom":"top"))}})}}o.autofocus=function(p){return arguments.length?(s=p,o):s},o.entityIDs=function(p){if(!arguments.length)return r;if(r=p,i=null,r&&r.length){i=vt(r,t.graph()).center();var m=r.map(function(g){return xe.match(t.entity(g),t.graph())});o.presets(m)}return o},o.presets=function(p){return arguments.length?(n=p,o):n};function h(){var p={};for(var m in r){var g=r[m],y=t.entity(g),v=y.geometry(t.graph());v==="vertex"&&y.isOnAddressLine(t.graph())&&(v="point"),p[v]||(p[v]=0),p[v]+=1}return Object.keys(p).sort(function(x,_){return p[_]-p[x]})}return ge(o,e,"on")}function I7(t){var e=k7(t),r=C7(t),i=H(null),n=H(null),s=H(null),o="select",a,l=!1;function c(u){e.entityIDs(a).autofocus(l).on("choose",c.setPreset).on("cancel",function(){c.setPreset()}),r.state(o).entityIDs(a).on("choose",c.showList),i=u.selectAll(".panewrap").data([0]);var d=i.enter().append("div").attr("class","panewrap");d.append("div").attr("class","preset-list-pane pane"),d.append("div").attr("class","entity-editor-pane pane"),i=i.merge(d),n=i.selectAll(".preset-list-pane"),s=i.selectAll(".entity-editor-pane");function h(){if(o!=="select"||a.length!==1)return!1;var m=a[0],g=t.hasEntity(m);return!g||g.hasNonGeometryTags()?!1:l?!0:!(g.geometry(t.graph())!=="vertex"||t.graph().parentRelations(g).length||t.validator().getEntityIssues(m).length||g.isHighwayIntersection(t.graph()))}h()?(i.style("right","-100%"),s.classed("hide",!0),n.classed("hide",!1).call(e)):(i.style("right","0%"),n.classed("hide",!0),s.classed("hide",!1).call(r));var p=u.selectAll(".footer").data([0]);p=p.enter().append("div").attr("class","footer").merge(p),p.call(hu(t).what(t.hasEntity(a.length===1&&a[0])))}return c.showList=function(u){n.classed("hide",!1),i.transition().styleTween("right",function(){return $a("0%","-100%")}).on("end",function(){s.classed("hide",!0)}),u&&e.presets(u),n.call(e.autofocus(!0))},c.setPreset=function(u){u&&u.id==="type/multipolygon"?n.call(e.autofocus(!0)):(s.classed("hide",!1),i.transition().styleTween("right",function(){return $a("-100%","0%")}).on("end",function(){n.classed("hide",!0)}),u&&r.presets([u]),s.call(r))},c.state=function(u){return arguments.length?(o=u,r.state(o),t.container().selectAll(".field-help-body").remove(),c):o},c.entityIDs=function(u){return arguments.length?(a=u,c):a},c.newFeature=function(u){return arguments.length?(l=u,c):l},c}function M7(t){var e=I7(t),r=yu(t),i=I0(t),n=pu(t),s=fu(t),o=du(t),a=Vh(t),l,c=!1,u=!1,d=!1,h=!1;function p(m){var g=t.container(),y=240,v,x,_;m.style("min-width",y+"px").style("max-width","400px").style("width","33.3333%");var b=m.append("div").attr("class","sidebar-resizer").on("pointerdown.sidebar-resizer",T),w,E,A;function T(D){if(!w&&!("button"in D&&D.button!==0)){w=D.pointerId||"mouse",E=D.clientX,A=y5(g.node()),_=y5(b.node())(D)[0]-1,v=m.node().getBoundingClientRect().width,x=g.node().getBoundingClientRect().width;var F=v/x*100;m.style("width",F+"%").style("max-width","85%"),b.classed("dragging",!0),H(window).on("touchmove.sidebar-resizer",function(L){L.preventDefault()},{passive:!1}).on("pointermove.sidebar-resizer",k).on("pointerup.sidebar-resizer pointercancel.sidebar-resizer",C)}}function k(D){if(w===(D.pointerId||"mouse")){D.preventDefault();var F=D.clientX-E;E=D.clientX;var L=se.textDirection()==="rtl",B=L?0:1,O=L?"margin-right":"margin-left",R=A(D)[0]-_;v=L?x-R:R;var U=m.classed("collapsed"),G=v<y;if(m.classed("collapsed",G),G)U||(m.style(O,"-400px").style("width","400px"),t.ui().onResize([(v-F)*B,0]));else{var $=v/x*100;m.style(O,null).style("width",$+"%"),U?t.ui().onResize([-v*B,0]):t.ui().onResize([-F*B,0])}}}function C(D){w===(D.pointerId||"mouse")&&(w=null,b.classed("dragging",!1),H(window).on("touchmove.sidebar-resizer",null).on("pointermove.sidebar-resizer",null).on("pointerup.sidebar-resizer pointercancel.sidebar-resizer",null))}var I=m.append("div").attr("class","feature-list-pane").call(x7(t)),P=m.append("div").attr("class","inspector-hidden inspector-wrap"),N=function(D){if(t.container().selectAll(".feature-list-item button").classed("hover",!1),t.selectedIDs().length>1&&D&&D.length){var F=t.container().selectAll(".feature-list-item button").filter(function(L){return D.indexOf(L)!==-1});F.empty()||F.classed("hover",!0)}};p.hoverModeSelect=Sn(N,200);function M(D){var F=D&&D.length&&D[0];if(F&&F.__featurehash__)u=!0,p.show(i.datum(F)),m.selectAll(".sidebar-component").classed("inspector-hover",!0);else if(F&&F.__fbid__)c=!0,p.show(r.datum(F)),m.selectAll(".sidebar-component").classed("inspector-hover",!0).classed("rapid-inspector-fadein",!0);else if(F instanceof Jt){if(t.mode().id==="drag-note")return;d=!0;var L=K.osm;L&&(F=L.getNote(F.id)),p.show(n.note(F)),m.selectAll(".sidebar-component").classed("inspector-hover",!0)}else if(F instanceof Rt){h=!0;var B=K[F.service];B&&(F=B.getError(F.id));var O;F.service==="keepRight"?O=o:F.service==="osmose"?O=a:O=s,t.container().selectAll(".qaItem."+F.service).classed("hover",function(R){return R.id===F.id}),p.show(O.error(F)),m.selectAll(".sidebar-component").classed("inspector-hover",!0)}else!l&&F instanceof Te&&t.hasEntity(F)?(I.classed("inspector-hidden",!0),P.classed("inspector-hidden",!1).classed("inspector-hover",!0),(!e.entityIDs()||!ni(e.entityIDs(),[F.id])||e.state()!=="hover")&&(e.state("hover").entityIDs([F.id]).newFeature(!1),P.call(e))):l?(c||u||d||h)&&(c=!1,d=!1,u=!1,h=!1,t.container().selectAll(".layer-ai-features .hover").classed("hover",!1),t.container().selectAll(".note").classed("hover",!1),t.container().selectAll(".qaItem").classed("hover",!1),p.hide()):(I.classed("inspector-hidden",!1),P.classed("inspector-hidden",!0),e.state("hide"))}p.hover=Sn(M,200),p.intersects=function(D){var F=m.node().getBoundingClientRect();return D.intersects(new le(t.projection.invert([0,F.height]),t.projection.invert([F.width,0])))},p.select=function(D,F){if(p.hide(),D&&D.length){var L=D.length===1&&t.entity(D[0]);if(L&&F&&m.classed("collapsed")){var B=L.extent(t.graph());p.expand(p.intersects(B))}I.classed("inspector-hidden",!0),P.classed("inspector-hidden",!1).classed("inspector-hover",!1),e.state("select").entityIDs(D).newFeature(F),P.call(e)}else e.state("hide")},p.showPresetList=function(){e.showList()},p.show=function(D,F){I.classed("inspector-hidden",!0),P.classed("inspector-hidden",!0),l&&l.remove(),l=m.append("div").attr("class","sidebar-component").call(D,F)},p.hide=function(){I.classed("inspector-hidden",!1),P.classed("inspector-hidden",!0),l&&l.remove(),l=null},p.expand=function(D){m.classed("collapsed")&&p.toggle(D)},p.collapse=function(D){m.classed("collapsed")||p.toggle(D)},p.toggle=function(D){if(!t.inIntro()){var F=m.classed("collapsed"),L=!F,B=se.textDirection()==="rtl",O=B?0:1,R=B?"margin-right":"margin-left";v=m.node().getBoundingClientRect().width,m.style("width",v+"px");var U,G,$;L?(U=$=0,G=-v):(U=$=-v,G=0),L||m.classed("collapsed",L),m.transition().style(R,G+"px").tween("panner",function(){var q=Hr(U,G);return function(ie){var Q=$-Math.round(q(ie));$=$-Q,t.ui().onResize(D?void 0:[Q*O,0])}}).on("end",function(){L&&m.classed("collapsed",L);let q=t.pixi.view.parentNode;if(t.pixi.resize(q.clientWidth,q.clientHeight),!L){var ie=g.node().getBoundingClientRect().width,Q=v/ie*100;m.style(R,null).style("width",Q+"%")}})}},b.on("dblclick",function(D){D.preventDefault(),D.sourceEvent&&D.sourceEvent.preventDefault(),p.toggle()})}return p.showPresetList=function(){},p.hover=function(){},p.hover.cancel=function(){},p.intersects=function(){},p.select=function(){},p.show=function(){},p.hide=function(){},p.expand=function(){},p.collapse=function(){},p.toggle=function(){},p}function P7(t){var e;function r(n){n.preventDefault();var s=t.connection();if(s&&!t.inIntro()&&!(t.history().hasChanges()&&!window.confirm(S("source_switch.lose_changes")))){var o=H(this).classed("live");o=!o,t.enter("browse"),t.history().clearSaved(),t.flush(),H(this).html(o?S.html("source_switch.live"):S.html("source_switch.dev")).classed("live",o).classed("chip",o),s.switch(o?e[0]:e[1])}}var i=function(n){n.append("a").attr("href","#").html(S.html("source_switch.live")).attr("class","live chip").on("click",r)};return i.keys=function(n){return arguments.length?(e=n,i):e},i}function R7(t){var e=t.connection();return function(r){var i=r.append("img").attr("src",t.imagePath("loader-black.gif")).style("opacity",0);e&&e.on("loading.spinner",function(){i.transition().style("opacity",1)}).on("loaded.spinner",function(){i.transition().style("opacity",0)})}}function N7(t){var e=t.connection();return function(r){if(!e)return;function i(n,s){if(r.html(""),n){if(s==="connectionSwitched")return;if(s==="rateLimited")r.html(S.html("osm_api_status.message.rateLimit")).append("a").attr("href","#").attr("class","api-status-login").attr("target","_blank").call(Z("#rapid-icon-out-link","inline")).append("span").html(S.html("login")).on("click.login",function(a){a.preventDefault(),e.authenticate()});else{var o=Sn(function(){t.loadTiles(t.projection),e.reloadApiStatus()},2e3);r.html(S.html("osm_api_status.message.error")+" ").append("a").attr("href","#").html(S.html("osm_api_status.retry")).on("click.retry",function(a){a.preventDefault(),o()})}}else s==="readonly"?r.html(S.html("osm_api_status.message.readonly")):s==="offline"&&r.html(S.html("osm_api_status.message.offline"));r.attr("class","api-status "+(n?"error":s))}e.on("apiStatusChange.uiStatus",i),t.history().on("storage_error",()=>{r.html(S.html("osm_api_status.message.local_storage_full")),r.attr("class","api-status error")}),window.setInterval(function(){e.reloadApiStatus()},9e4),e.reloadApiStatus()}}function fk(t){let e={id:"download_osc",label:S("download_osc.title")},r=H(null),i=null,n=0;function s(){return n===0}function o(c){c.preventDefault();let u=t.history();if(!t.inIntro()&&u.hasChanges()){let d=u.changes(ia(u.difference())),h=new nn,p=go.stringify(h.osmChangeJXON(d));l(p,"change.osc")}}function a(){let c=t.history().difference().summary().size;c!==n&&(n=c,r.classed("disabled",s()),i&&i.title(S(n>0?"download_osc.help":"download_osc.no_changes")))}function l(c,u){let d=document.createElement("a");d.style.display="none",document.body.appendChild(d),d.href=window.URL.createObjectURL(new Blob([c])),d.setAttribute("download",u),d.click(),window.URL.revokeObjectURL(d.href),document.body.removeChild(d)}return e.install=function(c){i=Ae().placement("bottom").title(S("download_osc.no_changes")),r=c.append("button").attr("class","downloadOsc disabled bar-button").on("click",o).call(i),r.call(Z("#rapid-icon-download-osc")),a(),t.history().on("change.download_osc",a),t.on("enter.download_osc",()=>{r.classed("disabled",s())})},e.uninstall=function(){t.history().on("change.download_osc",null),t.on("enter.download_osc",null),r=H(null),i=null},e}function dk(t){let e={id:"draw_modes",label:S.html("toolbar.add_feature")},r=[{id:"add-point",title:S.html("modes.add_point.title"),button:"point",description:S.html("modes.add_point.description"),preset:xe.item("point"),key:"1"},{id:"draw-line",title:S.html("modes.add_line.title"),button:"line",description:S.html("modes.add_line.description"),preset:xe.item("line"),key:"2"},{id:"draw-area",title:S.html("modes.add_area.title"),button:"area",description:S.html("modes.add_area.description"),preset:xe.item("area"),key:"3"}],i;return e.install=function(n){let s=n.append("div").attr("class","joined").style("display","flex");i=Gt(o,500,{leading:!0,trailing:!0}),r.forEach(a=>{t.keybinding().on(a.key,()=>{t.editable()&&(a.id===t.mode().id?t.enter("browse"):t.enter(a.id))})}),t.map().on("draw",i),t.on("enter.modes",o),o();function o(){let a=s.selectAll("button.add-button").data(r,c=>c.id);a.exit().remove();let l=a.enter().append("button").attr("class",c=>`${c.id} add-button bar-button`).on("click.mode-buttons",(c,u)=>{if(!t.editable()||u.id==="add-area")return;let d=t.mode().id;/^draw/.test(d)||(u.id===d?t.enter("browse"):t.enter(u.id))}).call(Ae().placement("bottom").title(c=>c.description).keys(c=>[c.key]).scrollContainer(t.container().select(".top-toolbar")));l.each((c,u,d)=>{H(d[u]).call(Z(`#rapid-icon-${c.button}`))}),l.append("span").attr("class","label").html(c=>c.title),(a.enter().size()||a.exit().size())&&t.ui().checkOverflow(".top-toolbar",!0),a=a.merge(l).classed("disabled",()=>!t.editable()).classed("active",c=>t.mode()&&t.mode().id===c.id)}},e.uninstall=function(){r.forEach(n=>{t.keybinding().off(n.key)}),t.map().off("draw",i),t.on("enter.modes",null)},e}function hk(t){let e={id:"notes",label:S.html("modes.add_note.label")},r={id:"add-note",title:S.html("modes.add_note.title"),button:"note",description:S.html("modes.add_note.description"),key:S("modes.add_note.key")};function i(){return t.scene().layers.get("notes")?.enabled}function n(){return t.mode()?.id!=="save"}let s;return e.install=function(o){s=Gt(a,500,{leading:!0,trailing:!0}),t.keybinding().on(r.key,()=>{n()&&(r.id===t.mode().id?t.enter("browse"):t.enter(r.id))}),t.map().on("draw",s),t.on("enter.notes",a),a();function a(){let l=i()?[r]:[],c=o.selectAll("button.add-button").data(l,d=>d.id);c.exit().remove();let u=c.enter().append("button").attr("class",d=>`${d.id} add-button bar-button`).on("click.notes",(d,h)=>{if(n()){var p=t.mode().id;/^draw/.test(p)||(h.id===p?t.enter("browse"):t.enter(h.id))}}).call(Ae().placement("bottom").title(d=>d.description).keys(d=>[d.key]).scrollContainer(t.container().select(".top-toolbar")));u.each((d,h,p)=>{H(p[h]).call(Z(d.icon||`#rapid-icon-${d.button}`))}),(c.enter().size()||c.exit().size())&&t.ui().checkOverflow(".top-toolbar",!0),c=c.merge(u).classed("disabled",()=>!i()).classed("active",d=>t.mode()&&t.mode().id===d.id)}},e.uninstall=function(){t.keybinding().off(r.key),t.on("enter.notes",null),t.map().off("draw",s)},e}function pk(t){let e={id:"save",label:S.html("save.title")},r=H(null),i=null,n=et("\u2318S"),s=0;function o(){let d=t.mode();return d&&d.id==="save"}function a(){return s===0||o()}function l(d){d.preventDefault(),!t.inIntro()&&!o()&&t.history().hasChanges()&&t.enter("save")}function c(){let d;return s===0?null:s<=50?(d=s/50,lo("#fff","#ff8")(d)):(d=Math.min((s-50)/50,1),lo("#ff8","#f88")(d))}function u(){let d=t.history().difference().summary().size;d!==s&&(s=d,i&&i.title(S.html(s>0?"save.help":"save.no_changes")).keys([n]),r.classed("disabled",a()).style("background",c(s)),r.select("span.count").html(s))}return e.install=function(d){i=Ae().placement("bottom").title(S.html("save.no_changes")).keys([n]).scrollContainer(t.container().select(".top-toolbar")),r=d.append("button").attr("class","save disabled bar-button").on("click",h=>{l(h)}).call(i),r.call(Z("#rapid-icon-save")),r.append("span").attr("class","count").attr("aria-hidden","true").html("0"),u(),t.keybinding().on(n,l,!0),t.history().on("change.save",u),t.on("enter.save",()=>{r.classed("disabled",a()),o()&&r.call(i.hide)})},e.uninstall=function(){t.keybinding().off(n,!0),t.history().on("change.save",null),t.on("enter.save",null),r=H(null),i=null},e}function mk(t){let e=se.textDirection()==="rtl",r={id:"sidebar_toggle",label:S.html("toolbar.inspect")};return r.install=function(i){i.append("button").attr("class","bar-button").on("click",()=>t.ui().sidebar.toggle()).call(Ae().placement("bottom").title(S.html("sidebar.tooltip")).keys([S("sidebar.key")]).scrollContainer(t.container().select(".top-toolbar"))).call(Z("#rapid-icon-sidebar-"+(e?"right":"left")))},r}function gk(t){let e={id:"undo_redo",label:S.html("toolbar.undo_redo")},r=se.textDirection()==="rtl",i=[{id:"undo",key:et("\u2318Z"),action:()=>t.undo(),annotation:()=>t.history().undoAnnotation(),icon:r?"redo":"undo"},{id:"redo",key:et("\u2318\u21E7Z"),action:()=>t.redo(),annotation:()=>t.history().redoAnnotation(),icon:r?"undo":"redo"}],n;return e.install=function(s){let o=Ae().placement("bottom").title(c=>{let u=c.annotation();return u&&u.description&&(u=u.description),u?S(`${c.id}.tooltip`,{action:u}):S(`${c.id}.nothing`)}).keys(c=>[c.key]).scrollContainer(t.container().select(".top-toolbar")),a=s.selectAll("button").data(i).enter().append("button").attr("class",c=>`disabled ${c.id}-button bar-button`).on("click",(c,u)=>{c.preventDefault();let d=u.annotation();t.editable()&&d&&u.action()}).call(o);a.each((c,u,d)=>{H(d[u]).call(Z(`#rapid-icon-${c.icon}`))}),n=Gt(l,500,{leading:!0,trailing:!0}),i.forEach(c=>{t.keybinding().on(c.key,u=>{u.preventDefault(),t.editable()&&c.action()})}),t.map().on("draw",n),t.history().on("change.undo_redo",c=>{c&&l()}),t.on("enter.undo_redo",l);function l(){a.classed("disabled",c=>!t.editable()||!c.annotation()).each((c,u,d)=>{let h=H(d[u]);h.select(".tooltip.in").empty()||h.call(o.updateContent)})}},e.uninstall=function(){i.forEach(s=>{t.keybinding().off(s.key)}),t.map().off("draw",n),t.history().on("change.undo_redo",null),t.on("enter.undo_redo",null)},e}function Ek(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}var W1=Ek();function _z(t){W1=t}var Sk=/[&<>"']/,bz=new RegExp(Sk.source,"g"),Tk=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,wz=new RegExp(Tk.source,"g"),Ez={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},yk=t=>Ez[t];function Hi(t,e){if(e){if(Sk.test(t))return t.replace(bz,yk)}else if(Tk.test(t))return t.replace(wz,yk);return t}var Sz=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Ak(t){return t.replace(Sz,(e,r)=>(r=r.toLowerCase(),r==="colon"?":":r.charAt(0)==="#"?r.charAt(1)==="x"?String.fromCharCode(parseInt(r.substring(2),16)):String.fromCharCode(+r.substring(1)):""))}var Tz=/(^|[^\[])\^/g;function mr(t,e){t=typeof t=="string"?t:t.source,e=e||"";let r={replace:(i,n)=>(n=n.source||n,n=n.replace(Tz,"$1"),t=t.replace(i,n),r),getRegex:()=>new RegExp(t,e)};return r}var Az=/[^\w:]/g,Cz=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function vk(t,e,r){if(t){let i;try{i=decodeURIComponent(Ak(r)).replace(Az,"").toLowerCase()}catch{return null}if(i.indexOf("javascript:")===0||i.indexOf("vbscript:")===0||i.indexOf("data:")===0)return null}e&&!Cz.test(r)&&(r=Pz(e,r));try{r=encodeURI(r).replace(/%25/g,"%")}catch{return null}return r}var D7={},kz=/^[^:]+:\/*[^/]*$/,Iz=/^([^:]+:)[\s\S]*$/,Mz=/^([^:]+:\/*[^/]*)[\s\S]*$/;function Pz(t,e){D7[" "+t]||(kz.test(t)?D7[" "+t]=t+"/":D7[" "+t]=F7(t,"/",!0)),t=D7[" "+t];let r=t.indexOf(":")===-1;return e.substring(0,2)==="//"?r?e:t.replace(Iz,"$1")+e:e.charAt(0)==="/"?r?e:t.replace(Mz,"$1")+e:t+e}var O7={exec:function(){}};function xk(t,e){let r=t.replace(/\|/g,(s,o,a)=>{let l=!1,c=o;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),i=r.split(/ \|/),n=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i}function F7(t,e,r){let i=t.length;if(i===0)return"";let n=0;for(;n<i;){let s=t.charAt(i-n-1);if(s===e&&!r)n++;else if(s!==e&&r)n++;else break}return t.slice(0,i-n)}function Rz(t,e){if(t.indexOf(e[1])===-1)return-1;let r=t.length,i=0,n=0;for(;n<r;n++)if(t[n]==="\\")n++;else if(t[n]===e[0])i++;else if(t[n]===e[1]&&(i--,i<0))return n;return-1}function Nz(t){t&&t.sanitize&&!t.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function _k(t,e){if(e<1)return"";let r="";for(;e>1;)e&1&&(r+=t),e>>=1,t+=t;return r+t}function bk(t,e,r,i){let n=e.href,s=e.title?Hi(e.title):null,o=t[1].replace(/\\([\[\]])/g,"$1");if(t[0].charAt(0)!=="!"){i.state.inLink=!0;let a={type:"link",raw:r,href:n,title:s,text:o,tokens:i.inlineTokens(o)};return i.state.inLink=!1,a}return{type:"image",raw:r,href:n,title:s,text:Hi(o)}}function Dz(t,e){let r=t.match(/^(\s+)(?:```)/);if(r===null)return e;let i=r[1];return e.split(`
`).map(n=>{let s=n.match(/^\s+/);if(s===null)return n;let[o]=s;return o.length>=i.length?n.slice(i.length):n}).join(`
`)}var v5=class{constructor(e){this.options=e||W1}space(e){let r=this.rules.block.newline.exec(e);if(r&&r[0].length>0)return{type:"space",raw:r[0]}}code(e){let r=this.rules.block.code.exec(e);if(r){let i=r[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:r[0],codeBlockStyle:"indented",text:this.options.pedantic?i:F7(i,`
`)}}}fences(e){let r=this.rules.block.fences.exec(e);if(r){let i=r[0],n=Dz(i,r[3]||"");return{type:"code",raw:i,lang:r[2]?r[2].trim().replace(this.rules.inline._escapes,"$1"):r[2],text:n}}}heading(e){let r=this.rules.block.heading.exec(e);if(r){let i=r[2].trim();if(/#$/.test(i)){let n=F7(i,"#");(this.options.pedantic||!n||/ $/.test(n))&&(i=n.trim())}return{type:"heading",raw:r[0],depth:r[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){let r=this.rules.block.hr.exec(e);if(r)return{type:"hr",raw:r[0]}}blockquote(e){let r=this.rules.block.blockquote.exec(e);if(r){let i=r[0].replace(/^ *>[ \t]?/gm,""),n=this.lexer.state.top;this.lexer.state.top=!0;let s=this.lexer.blockTokens(i);return this.lexer.state.top=n,{type:"blockquote",raw:r[0],tokens:s,text:i}}}list(e){let r=this.rules.block.list.exec(e);if(r){let i,n,s,o,a,l,c,u,d,h,p,m,g=r[1].trim(),y=g.length>1,v={type:"list",raw:"",ordered:y,start:y?+g.slice(0,-1):"",loose:!1,items:[]};g=y?`\\d{1,9}\\${g.slice(-1)}`:`\\${g}`,this.options.pedantic&&(g=y?g:"[*+-]");let x=new RegExp(`^( {0,3}${g})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;e&&(m=!1,!(!(r=x.exec(e))||this.rules.block.hr.test(e)));){if(i=r[0],e=e.substring(i.length),u=r[2].split(`
`,1)[0].replace(/^\t+/,b=>" ".repeat(3*b.length)),d=e.split(`
`,1)[0],this.options.pedantic?(o=2,p=u.trimLeft()):(o=r[2].search(/[^ ]/),o=o>4?1:o,p=u.slice(o),o+=r[1].length),l=!1,!u&&/^ *$/.test(d)&&(i+=d+`
`,e=e.substring(d.length+1),m=!0),!m){let b=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),w=new RegExp(`^ {0,${Math.min(3,o-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),E=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:\`\`\`|~~~)`),A=new RegExp(`^ {0,${Math.min(3,o-1)}}#`);for(;e&&(h=e.split(`
`,1)[0],d=h,this.options.pedantic&&(d=d.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(E.test(d)||A.test(d)||b.test(d)||w.test(e)));){if(d.search(/[^ ]/)>=o||!d.trim())p+=`
`+d.slice(o);else{if(l||u.search(/[^ ]/)>=4||E.test(u)||A.test(u)||w.test(u))break;p+=`
`+d}!l&&!d.trim()&&(l=!0),i+=h+`
`,e=e.substring(h.length+1),u=d.slice(o)}}v.loose||(c?v.loose=!0:/\n *\n *$/.test(i)&&(c=!0)),this.options.gfm&&(n=/^\[[ xX]\] /.exec(p),n&&(s=n[0]!=="[ ] ",p=p.replace(/^\[[ xX]\] +/,""))),v.items.push({type:"list_item",raw:i,task:!!n,checked:s,loose:!1,text:p}),v.raw+=i}v.items[v.items.length-1].raw=i.trimRight(),v.items[v.items.length-1].text=p.trimRight(),v.raw=v.raw.trimRight();let _=v.items.length;for(a=0;a<_;a++)if(this.lexer.state.top=!1,v.items[a].tokens=this.lexer.blockTokens(v.items[a].text,[]),!v.loose){let b=v.items[a].tokens.filter(E=>E.type==="space"),w=b.length>0&&b.some(E=>/\n.*\n/.test(E.raw));v.loose=w}if(v.loose)for(a=0;a<_;a++)v.items[a].loose=!0;return v}}html(e){let r=this.rules.block.html.exec(e);if(r){let i={type:"html",raw:r[0],pre:!this.options.sanitizer&&(r[1]==="pre"||r[1]==="script"||r[1]==="style"),text:r[0]};if(this.options.sanitize){let n=this.options.sanitizer?this.options.sanitizer(r[0]):Hi(r[0]);i.type="paragraph",i.text=n,i.tokens=this.lexer.inline(n)}return i}}def(e){let r=this.rules.block.def.exec(e);if(r){let i=r[1].toLowerCase().replace(/\s+/g," "),n=r[2]?r[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",s=r[3]?r[3].substring(1,r[3].length-1).replace(this.rules.inline._escapes,"$1"):r[3];return{type:"def",tag:i,raw:r[0],href:n,title:s}}}table(e){let r=this.rules.block.table.exec(e);if(r){let i={type:"table",header:xk(r[1]).map(n=>({text:n})),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:r[3]&&r[3].trim()?r[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(i.header.length===i.align.length){i.raw=r[0];let n=i.align.length,s,o,a,l;for(s=0;s<n;s++)/^ *-+: *$/.test(i.align[s])?i.align[s]="right":/^ *:-+: *$/.test(i.align[s])?i.align[s]="center":/^ *:-+ *$/.test(i.align[s])?i.align[s]="left":i.align[s]=null;for(n=i.rows.length,s=0;s<n;s++)i.rows[s]=xk(i.rows[s],i.header.length).map(c=>({text:c}));for(n=i.header.length,o=0;o<n;o++)i.header[o].tokens=this.lexer.inline(i.header[o].text);for(n=i.rows.length,o=0;o<n;o++)for(l=i.rows[o],a=0;a<l.length;a++)l[a].tokens=this.lexer.inline(l[a].text);return i}}}lheading(e){let r=this.rules.block.lheading.exec(e);if(r)return{type:"heading",raw:r[0],depth:r[2].charAt(0)==="="?1:2,text:r[1],tokens:this.lexer.inline(r[1])}}paragraph(e){let r=this.rules.block.paragraph.exec(e);if(r){let i=r[1].charAt(r[1].length-1)===`
`?r[1].slice(0,-1):r[1];return{type:"paragraph",raw:r[0],text:i,tokens:this.lexer.inline(i)}}}text(e){let r=this.rules.block.text.exec(e);if(r)return{type:"text",raw:r[0],text:r[0],tokens:this.lexer.inline(r[0])}}escape(e){let r=this.rules.inline.escape.exec(e);if(r)return{type:"escape",raw:r[0],text:Hi(r[1])}}tag(e){let r=this.rules.inline.tag.exec(e);if(r)return!this.lexer.state.inLink&&/^<a /i.test(r[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(r[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:r[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):Hi(r[0]):r[0]}}link(e){let r=this.rules.inline.link.exec(e);if(r){let i=r[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;let o=F7(i.slice(0,-1),"\\");if((i.length-o.length)%2===0)return}else{let o=Rz(r[2],"()");if(o>-1){let l=(r[0].indexOf("!")===0?5:4)+r[1].length+o;r[2]=r[2].substring(0,o),r[0]=r[0].substring(0,l).trim(),r[3]=""}}let n=r[2],s="";if(this.options.pedantic){let o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);o&&(n=o[1],s=o[3])}else s=r[3]?r[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(this.options.pedantic&&!/>$/.test(i)?n=n.slice(1):n=n.slice(1,-1)),bk(r,{href:n&&n.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},r[0],this.lexer)}}reflink(e,r){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){let n=(i[2]||i[1]).replace(/\s+/g," ");if(n=r[n.toLowerCase()],!n){let s=i[0].charAt(0);return{type:"text",raw:s,text:s}}return bk(i,n,i[0],this.lexer)}}emStrong(e,r,i=""){let n=this.rules.inline.emStrong.lDelim.exec(e);if(!n||n[3]&&i.match(/[\p{L}\p{N}]/u))return;let s=n[1]||n[2]||"";if(!s||s&&(i===""||this.rules.inline.punctuation.exec(i))){let o=n[0].length-1,a,l,c=o,u=0,d=n[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(d.lastIndex=0,r=r.slice(-1*e.length+o);(n=d.exec(r))!=null;){if(a=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!a)continue;if(l=a.length,n[3]||n[4]){c+=l;continue}else if((n[5]||n[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);let h=e.slice(0,o+n.index+(n[0].length-a.length)+l);if(Math.min(o,l)%2){let m=h.slice(1,-1);return{type:"em",raw:h,text:m,tokens:this.lexer.inlineTokens(m)}}let p=h.slice(2,-2);return{type:"strong",raw:h,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){let r=this.rules.inline.code.exec(e);if(r){let i=r[2].replace(/\n/g," "),n=/[^ ]/.test(i),s=/^ /.test(i)&&/ $/.test(i);return n&&s&&(i=i.substring(1,i.length-1)),i=Hi(i,!0),{type:"codespan",raw:r[0],text:i}}}br(e){let r=this.rules.inline.br.exec(e);if(r)return{type:"br",raw:r[0]}}del(e){let r=this.rules.inline.del.exec(e);if(r)return{type:"del",raw:r[0],text:r[2],tokens:this.lexer.inlineTokens(r[2])}}autolink(e,r){let i=this.rules.inline.autolink.exec(e);if(i){let n,s;return i[2]==="@"?(n=Hi(this.options.mangle?r(i[1]):i[1]),s="mailto:"+n):(n=Hi(i[1]),s=n),{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}url(e,r){let i;if(i=this.rules.inline.url.exec(e)){let n,s;if(i[2]==="@")n=Hi(this.options.mangle?r(i[0]):i[0]),s="mailto:"+n;else{let o;do o=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0];while(o!==i[0]);n=Hi(i[0]),i[1]==="www."?s="http://"+i[0]:s=i[0]}return{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e,r){let i=this.rules.inline.text.exec(e);if(i){let n;return this.lexer.state.inRawBlock?n=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):Hi(i[0]):i[0]:n=Hi(this.options.smartypants?r(i[0]):i[0]),{type:"text",raw:i[0],text:n}}}},ot={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:O7,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};ot._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;ot._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;ot.def=mr(ot.def).replace("label",ot._label).replace("title",ot._title).getRegex();ot.bullet=/(?:[*+-]|\d{1,9}[.)])/;ot.listItemStart=mr(/^( *)(bull) */).replace("bull",ot.bullet).getRegex();ot.list=mr(ot.list).replace(/bull/g,ot.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+ot.def.source+")").getRegex();ot._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";ot._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;ot.html=mr(ot.html,"i").replace("comment",ot._comment).replace("tag",ot._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();ot.paragraph=mr(ot._paragraph).replace("hr",ot.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ot._tag).getRegex();ot.blockquote=mr(ot.blockquote).replace("paragraph",ot.paragraph).getRegex();ot.normal={...ot};ot.gfm={...ot.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};ot.gfm.table=mr(ot.gfm.table).replace("hr",ot.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ot._tag).getRegex();ot.gfm.paragraph=mr(ot._paragraph).replace("hr",ot.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",ot.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ot._tag).getRegex();ot.pedantic={...ot.normal,html:mr(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ot._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:O7,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:mr(ot.normal._paragraph).replace("hr",ot.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ot.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};var Ue={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:O7,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:O7,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};Ue._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";Ue.punctuation=mr(Ue.punctuation).replace(/punctuation/g,Ue._punctuation).getRegex();Ue.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;Ue.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;Ue._comment=mr(ot._comment).replace("(?:-->|$)","-->").getRegex();Ue.emStrong.lDelim=mr(Ue.emStrong.lDelim).replace(/punct/g,Ue._punctuation).getRegex();Ue.emStrong.rDelimAst=mr(Ue.emStrong.rDelimAst,"g").replace(/punct/g,Ue._punctuation).getRegex();Ue.emStrong.rDelimUnd=mr(Ue.emStrong.rDelimUnd,"g").replace(/punct/g,Ue._punctuation).getRegex();Ue._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;Ue._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;Ue._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;Ue.autolink=mr(Ue.autolink).replace("scheme",Ue._scheme).replace("email",Ue._email).getRegex();Ue._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;Ue.tag=mr(Ue.tag).replace("comment",Ue._comment).replace("attribute",Ue._attribute).getRegex();Ue._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;Ue._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;Ue._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;Ue.link=mr(Ue.link).replace("label",Ue._label).replace("href",Ue._href).replace("title",Ue._title).getRegex();Ue.reflink=mr(Ue.reflink).replace("label",Ue._label).replace("ref",ot._label).getRegex();Ue.nolink=mr(Ue.nolink).replace("ref",ot._label).getRegex();Ue.reflinkSearch=mr(Ue.reflinkSearch,"g").replace("reflink",Ue.reflink).replace("nolink",Ue.nolink).getRegex();Ue.normal={...Ue};Ue.pedantic={...Ue.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:mr(/^!?\[(label)\]\((.*?)\)/).replace("label",Ue._label).getRegex(),reflink:mr(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ue._label).getRegex()};Ue.gfm={...Ue.normal,escape:mr(Ue.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};Ue.gfm.url=mr(Ue.gfm.url,"i").replace("email",Ue.gfm._extended_email).getRegex();Ue.breaks={...Ue.gfm,br:mr(Ue.br).replace("{2,}","*").getRegex(),text:mr(Ue.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function Fz(t){return t.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function wk(t){let e="",r,i,n=t.length;for(r=0;r<n;r++)i=t.charCodeAt(r),Math.random()>.5&&(i="x"+i.toString(16)),e+="&#"+i+";";return e}var No=class{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||W1,this.options.tokenizer=this.options.tokenizer||new v5,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={block:ot.normal,inline:Ue.normal};this.options.pedantic?(r.block=ot.pedantic,r.inline=Ue.pedantic):this.options.gfm&&(r.block=ot.gfm,this.options.breaks?r.inline=Ue.breaks:r.inline=Ue.gfm),this.tokenizer.rules=r}static get rules(){return{block:ot,inline:Ue}}static lex(e,r){return new No(r).lex(e)}static lexInline(e,r){return new No(r).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let r;for(;r=this.inlineQueue.shift();)this.inlineTokens(r.src,r.tokens);return this.tokens}blockTokens(e,r=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,c)=>l+"    ".repeat(c.length));let i,n,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(i=a.call({lexer:this},e,r))?(e=e.substring(i.raw.length),r.push(i),!0):!1))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),i.raw.length===1&&r.length>0?r[r.length-1].raw+=`
`:r.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),n=r[r.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text):r.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),n=r[r.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+i.raw,n.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),r.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0,l=e.slice(1),c;this.options.extensions.startBlock.forEach(function(u){c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){n=r[r.length-1],o&&n.type==="paragraph"?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):r.push(i),o=s.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),n=r[r.length-1],n&&n.type==="text"?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):r.push(i);continue}if(e){let a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){let i,n,s,o=e,a,l,c;if(this.tokens.links){let u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+_k("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+_k("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,a.index+a[0].length-2)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;e;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(i=u.call({lexer:this},e,r))?(e=e.substring(i.raw.length),r.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),n=r[r.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):r.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),n=r[r.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):r.push(i);continue}if(i=this.tokenizer.emStrong(e,o,c)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.autolink(e,wk)){e=e.substring(i.raw.length),r.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e,wk))){e=e.substring(i.raw.length),r.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0,d=e.slice(1),h;this.options.extensions.startInline.forEach(function(p){h=p.call({lexer:this},d),typeof h=="number"&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(i=this.tokenizer.inlineText(s,Fz)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(c=i.raw.slice(-1)),l=!0,n=r[r.length-1],n&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):r.push(i);continue}if(e){let u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return r}},x5=class{constructor(e){this.options=e||W1}code(e,r,i){let n=(r||"").match(/\S*/)[0];if(this.options.highlight){let s=this.options.highlight(e,n);s!=null&&s!==e&&(i=!0,e=s)}return e=e.replace(/\n$/,"")+`
`,n?'<pre><code class="'+this.options.langPrefix+Hi(n)+'">'+(i?e:Hi(e,!0))+`</code></pre>
`:"<pre><code>"+(i?e:Hi(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e){return e}heading(e,r,i,n){if(this.options.headerIds){let s=this.options.headerPrefix+n.slug(i);return`<h${r} id="${s}">${e}</h${r}>
`}return`<h${r}>${e}</h${r}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,r,i){let n=r?"ol":"ul",s=r&&i!==1?' start="'+i+'"':"";return"<"+n+s+`>
`+e+"</"+n+`>
`}listitem(e){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return`<p>${e}</p>
`}table(e,r){return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,r){let i=r.header?"th":"td";return(r.align?`<${i} align="${r.align}">`:`<${i}>`)+e+`</${i}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return`<del>${e}</del>`}link(e,r,i){if(e=vk(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let n='<a href="'+e+'"';return r&&(n+=' title="'+r+'"'),n+=">"+i+"</a>",n}image(e,r,i){if(e=vk(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let n=`<img src="${e}" alt="${i}"`;return r&&(n+=` title="${r}"`),n+=this.options.xhtml?"/>":">",n}text(e){return e}},L7=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,r,i){return""+i}image(e,r,i){return""+i}br(){return""}},B7=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,r){let i=e,n=0;if(this.seen.hasOwnProperty(i)){n=this.seen[e];do n++,i=e+"-"+n;while(this.seen.hasOwnProperty(i))}return r||(this.seen[e]=n,this.seen[i]=0),i}slug(e,r={}){let i=this.serialize(e);return this.getNextSafeSlug(i,r.dryrun)}},Do=class{constructor(e){this.options=e||W1,this.options.renderer=this.options.renderer||new x5,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new L7,this.slugger=new B7}static parse(e,r){return new Do(r).parse(e)}static parseInline(e,r){return new Do(r).parseInline(e)}parse(e,r=!0){let i="",n,s,o,a,l,c,u,d,h,p,m,g,y,v,x,_,b,w,E,A=e.length;for(n=0;n<A;n++){if(p=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[p.type]&&(E=this.options.extensions.renderers[p.type].call({parser:this},p),E!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(p.type))){i+=E||"";continue}switch(p.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue}case"heading":{i+=this.renderer.heading(this.parseInline(p.tokens),p.depth,Ak(this.parseInline(p.tokens,this.textRenderer)),this.slugger);continue}case"code":{i+=this.renderer.code(p.text,p.lang,p.escaped);continue}case"table":{for(d="",u="",a=p.header.length,s=0;s<a;s++)u+=this.renderer.tablecell(this.parseInline(p.header[s].tokens),{header:!0,align:p.align[s]});for(d+=this.renderer.tablerow(u),h="",a=p.rows.length,s=0;s<a;s++){for(c=p.rows[s],u="",l=c.length,o=0;o<l;o++)u+=this.renderer.tablecell(this.parseInline(c[o].tokens),{header:!1,align:p.align[o]});h+=this.renderer.tablerow(u)}i+=this.renderer.table(d,h);continue}case"blockquote":{h=this.parse(p.tokens),i+=this.renderer.blockquote(h);continue}case"list":{for(m=p.ordered,g=p.start,y=p.loose,a=p.items.length,h="",s=0;s<a;s++)x=p.items[s],_=x.checked,b=x.task,v="",x.task&&(w=this.renderer.checkbox(_),y?x.tokens.length>0&&x.tokens[0].type==="paragraph"?(x.tokens[0].text=w+" "+x.tokens[0].text,x.tokens[0].tokens&&x.tokens[0].tokens.length>0&&x.tokens[0].tokens[0].type==="text"&&(x.tokens[0].tokens[0].text=w+" "+x.tokens[0].tokens[0].text)):x.tokens.unshift({type:"text",text:w}):v+=w),v+=this.parse(x.tokens,y),h+=this.renderer.listitem(v,b,_);i+=this.renderer.list(h,m,g);continue}case"html":{i+=this.renderer.html(p.text);continue}case"paragraph":{i+=this.renderer.paragraph(this.parseInline(p.tokens));continue}case"text":{for(h=p.tokens?this.parseInline(p.tokens):p.text;n+1<A&&e[n+1].type==="text";)p=e[++n],h+=`
`+(p.tokens?this.parseInline(p.tokens):p.text);i+=r?this.renderer.paragraph(h):h;continue}default:{let T='Token with "'+p.type+'" type was not found.';if(this.options.silent){console.error(T);return}else throw new Error(T)}}}return i}parseInline(e,r){r=r||this.renderer;let i="",n,s,o,a=e.length;for(n=0;n<a;n++){if(s=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]&&(o=this.options.extensions.renderers[s.type].call({parser:this},s),o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type))){i+=o||"";continue}switch(s.type){case"escape":{i+=r.text(s.text);break}case"html":{i+=r.html(s.text);break}case"link":{i+=r.link(s.href,s.title,this.parseInline(s.tokens,r));break}case"image":{i+=r.image(s.href,s.title,s.text);break}case"strong":{i+=r.strong(this.parseInline(s.tokens,r));break}case"em":{i+=r.em(this.parseInline(s.tokens,r));break}case"codespan":{i+=r.codespan(s.text);break}case"br":{i+=r.br();break}case"del":{i+=r.del(this.parseInline(s.tokens,r));break}case"text":{i+=r.text(s.text);break}default:{let l='Token with "'+s.type+'" type was not found.';if(this.options.silent){console.error(l);return}else throw new Error(l)}}}return i}},n4=class{constructor(e){this.options=e||W1}preprocess(e){return e}postprocess(e){return e}};ix(n4,"passThroughHooks",new Set(["preprocess","postprocess"]));function Oz(t,e,r){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let n="<p>An error occurred:</p><pre>"+Hi(i.message+"",!0)+"</pre>";if(e)return Promise.resolve(n);if(r){r(null,n);return}return n}if(e)return Promise.reject(i);if(r){r(i);return}throw i}}function Ck(t,e){return(r,i,n)=>{typeof i=="function"&&(n=i,i=null);let s={...i};i={...ze.defaults,...s};let o=Oz(i.silent,i.async,n);if(typeof r>"u"||r===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(Nz(i),i.hooks&&(i.hooks.options=i),n){let a=i.highlight,l;try{i.hooks&&(r=i.hooks.preprocess(r)),l=t(r,i)}catch(d){return o(d)}let c=function(d){let h;if(!d)try{i.walkTokens&&ze.walkTokens(l,i.walkTokens),h=e(l,i),i.hooks&&(h=i.hooks.postprocess(h))}catch(p){d=p}return i.highlight=a,d?o(d):n(null,h)};if(!a||a.length<3||(delete i.highlight,!l.length))return c();let u=0;ze.walkTokens(l,function(d){d.type==="code"&&(u++,setTimeout(()=>{a(d.text,d.lang,function(h,p){if(h)return c(h);p!=null&&p!==d.text&&(d.text=p,d.escaped=!0),u--,u===0&&c()})},0))}),u===0&&c();return}if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(r):r).then(a=>t(a,i)).then(a=>i.walkTokens?Promise.all(ze.walkTokens(a,i.walkTokens)).then(()=>a):a).then(a=>e(a,i)).then(a=>i.hooks?i.hooks.postprocess(a):a).catch(o);try{i.hooks&&(r=i.hooks.preprocess(r));let a=t(r,i);i.walkTokens&&ze.walkTokens(a,i.walkTokens);let l=e(a,i);return i.hooks&&(l=i.hooks.postprocess(l)),l}catch(a){return o(a)}}}function ze(t,e,r){return Ck(No.lex,Do.parse)(t,e,r)}ze.options=ze.setOptions=function(t){return ze.defaults={...ze.defaults,...t},_z(ze.defaults),ze};ze.getDefaults=Ek;ze.defaults=W1;ze.use=function(...t){let e=ze.defaults.extensions||{renderers:{},childTokens:{}};t.forEach(r=>{let i={...r};if(i.async=ze.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(n=>{if(!n.name)throw new Error("extension name required");if(n.renderer){let s=e.renderers[n.name];s?e.renderers[n.name]=function(...o){let a=n.renderer.apply(this,o);return a===!1&&(a=s.apply(this,o)),a}:e.renderers[n.name]=n.renderer}if(n.tokenizer){if(!n.level||n.level!=="block"&&n.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");e[n.level]?e[n.level].unshift(n.tokenizer):e[n.level]=[n.tokenizer],n.start&&(n.level==="block"?e.startBlock?e.startBlock.push(n.start):e.startBlock=[n.start]:n.level==="inline"&&(e.startInline?e.startInline.push(n.start):e.startInline=[n.start]))}n.childTokens&&(e.childTokens[n.name]=n.childTokens)}),i.extensions=e),r.renderer){let n=ze.defaults.renderer||new x5;for(let s in r.renderer){let o=n[s];n[s]=(...a)=>{let l=r.renderer[s].apply(n,a);return l===!1&&(l=o.apply(n,a)),l}}i.renderer=n}if(r.tokenizer){let n=ze.defaults.tokenizer||new v5;for(let s in r.tokenizer){let o=n[s];n[s]=(...a)=>{let l=r.tokenizer[s].apply(n,a);return l===!1&&(l=o.apply(n,a)),l}}i.tokenizer=n}if(r.hooks){let n=ze.defaults.hooks||new n4;for(let s in r.hooks){let o=n[s];n4.passThroughHooks.has(s)?n[s]=a=>{if(ze.defaults.async)return Promise.resolve(r.hooks[s].call(n,a)).then(c=>o.call(n,c));let l=r.hooks[s].call(n,a);return o.call(n,l)}:n[s]=(...a)=>{let l=r.hooks[s].apply(n,a);return l===!1&&(l=o.apply(n,a)),l}}i.hooks=n}if(r.walkTokens){let n=ze.defaults.walkTokens;i.walkTokens=function(s){let o=[];return o.push(r.walkTokens.call(this,s)),n&&(o=o.concat(n.call(this,s))),o}}ze.setOptions(i)})};ze.walkTokens=function(t,e){let r=[];for(let i of t)switch(r=r.concat(e.call(ze,i)),i.type){case"table":{for(let n of i.header)r=r.concat(ze.walkTokens(n.tokens,e));for(let n of i.rows)for(let s of n)r=r.concat(ze.walkTokens(s.tokens,e));break}case"list":{r=r.concat(ze.walkTokens(i.items,e));break}default:ze.defaults.extensions&&ze.defaults.extensions.childTokens&&ze.defaults.extensions.childTokens[i.type]?ze.defaults.extensions.childTokens[i.type].forEach(function(n){r=r.concat(ze.walkTokens(i[n],e))}):i.tokens&&(r=r.concat(ze.walkTokens(i.tokens,e)))}return r};ze.parseInline=Ck(No.lexInline,Do.parseInline);ze.Parser=Do;ze.parser=Do.parse;ze.Renderer=x5;ze.TextRenderer=L7;ze.Lexer=No;ze.lexer=No.lex;ze.Tokenizer=v5;ze.Slugger=B7;ze.Hooks=n4;ze.parse=ze;var Unt=ze.options,Gnt=ze.setOptions,znt=ze.use,Hnt=ze.walkTokens,$nt=ze.parseInline;var jnt=Do.parse,Vnt=No.lex;function U7(t,e){let r=t.rapidContext(),i=fe("change","done"),n=()=>{};function s(u){let d=t.container().selectAll(".shaded");d.empty()||(d.selectAll(".colorpicker-popup").size()?n():c(d,u.currentTarget))}function o(u){let d=u.target,h=d&&d.className||"";/colorpicker/i.test(h)||(u.stopPropagation(),u.preventDefault(),n())}function a(u){let d=u.length<6,h=parseInt(d?u[1]+u[1]:u[1]+u[2],16),p=parseInt(d?u[2]+u[2]:u[3]+u[4],16),m=parseInt(d?u[3]+u[3]:u[5]+u[6],16);return(h*299+p*587+m*114)/1e3}function l(u){let d=u.selectAll(".rapid-colorpicker").data(p=>[p],p=>p.id),h=d.enter().append("div").attr("class","rapid-colorpicker").on("click",s);h.append("div").attr("class","rapid-colorpicker-fill").call(Z("#fas-palette")),d.merge(h).selectAll(".rapid-colorpicker-fill").style("background",p=>p.color).select(".icon").style("color",p=>a(p.color)>140.5?"#333":"#fff")}function c(u,d){let h=d.__data__,p=d.getBoundingClientRect(),m=180,g=p.bottom+15,y=se.textDirection()==="rtl"?p.right-.3333*m:p.left-.6666*m,v=se.textDirection()==="rtl"?.3333*m-p.width+10:.6666*m+10,x=e.close;e.close=()=>{},n=()=>{b.transition().duration(200).style("opacity",0).remove(),e.close=x;let k=rt("modal");k.on(["\u232B","\u238B"],x),H(document).call(k),H(document).on("click.colorpicker",null),n=()=>{},i.call("done")};let _=rt("modal");_.on(["\u232B","\u238B"],n),H(document).call(_),H(document).on("click.colorpicker",o);let b=u.append("div").attr("class","colorpicker-popup").style("opacity",0).style("width",m+"px").style("top",g+"px").style("left",y+"px");b.append("div").attr("class","colorpicker-arrow").style("left",v+"px");let E=b.append("div").attr("class","colorpicker-content").selectAll(".colorpicker-colors").data([0]);E=E.enter().append("div").attr("class","colorpicker-colors").merge(E);let A=E.selectAll(".colorpicker-option").data(r.colors()),T=A.enter().append("div").attr("class","colorpicker-option").style("color",k=>k).on("click",(k,C)=>{i.call("change",this,h.id,C),A.classed("selected",I=>I===C)});T.append("div").attr("class","colorpicker-option-fill"),A=A.merge(T),A.classed("selected",k=>k===h.color),b.transition().style("opacity",1)}return ge(l,i,"on")}function G7(t,e){let r=t.rapidContext(),i=fe("done"),n=At(t,"dataset-categories"),s=100,o=H(null),a,l,c,u=()=>!0;function d(){let _=t.container().selectAll(".shaded");if(_.empty()||_.selectAll(".modal-view-manage").size())return;let b=e.close;e.close=()=>{},u=()=>{a=null,l=null,A.transition().duration(200).style("top","0px").on("end",()=>E.remove()),e.close=b;let T=rt("modal");T.on(["\u232B","\u238B"],b),H(document).call(T),i.call("done")};let w=rt("modal");w.on(["\u232B","\u238B"],u),H(document).call(w);let E=_.append("div").attr("class","view-manage-wrap"),A=E.append("div").attr("class","modal rapid-modal modal-view-manage").style("opacity",0);A.append("button").attr("class","close").on("click",u).call(Z("#rapid-icon-close")),o=A.append("div").attr("class","rapid-stack content"),o.call(h),o.selectAll(".ok-button").node().focus(),A.transition().style("opacity",1)}function h(_){let b=_.selectAll(".rapid-view-manage-header").data([0]).enter().append("div").attr("class","modal-section rapid-view-manage-header"),w=b.append("div");w.append("div").attr("class","rapid-view-manage-header-icon").call(Z("#rapid-icon-data","icon-30")),w.append("div").attr("class","rapid-view-manage-header-text").text(S("rapid_feature_toggle.esri.title"));let E=b.append("div");E.append("div").attr("class","rapid-view-manage-header-about").html(ze.parse(S("rapid_feature_toggle.esri.about"))),E.selectAll("a").attr("target","_blank");let A=_.selectAll(".rapid-view-manage-filter").data([0]).enter().append("div").attr("class","modal-section rapid-view-manage-filter"),T=A.append("div").attr("class","rapid-view-manage-filter-search-wrap");T.call(Z("#fas-filter","inline")),T.append("input").attr("class","rapid-view-manage-filter-search").attr("placeholder",S("rapid_feature_toggle.esri.filter_datasets")).call(qe).on("input",N=>{let M=N.currentTarget;a=(M&&M.value||"").trim().toLowerCase(),C.call(p)}),A.append("div").attr("class","rapid-view-manage-filter-type-wrap").append("input").attr("class","rapid-view-manage-filter-type").attr("placeholder",S("rapid_feature_toggle.esri.any_type")).call(qe).call(n).on("blur change",N=>{let M=N.currentTarget,D=M&&M.value||"";n.data().some(L=>L.value===D)?l=D:(N.currentTarget.value="",l=null),C.call(p)}),A.append("div").attr("class","rapid-view-manage-filter-clear").append("a").attr("href","#").text(S("rapid_feature_toggle.esri.clear_filters")).on("click",N=>{N.preventDefault(),N.currentTarget.blur(),_.selectAll("input").property("value",""),a=null,l=null,C.call(p)}),A.append("div").attr("class","rapid-view-manage-filter-results");let C=_.selectAll(".rapid-view-manage-datasets-section").data([0]),I=C.enter().append("div").attr("class","modal-section rapid-view-manage-datasets-section");I.append("div").attr("class","rapid-view-manage-datasets-status"),I.append("div").attr("class","rapid-view-manage-datasets"),C=C.merge(I).call(p),_.selectAll(".modal-section.buttons").data([0]).enter().append("div").attr("class","modal-section buttons").append("button").attr("class","button ok-button action").on("click",u).text(S("confirm.okay"))}function p(_){let b=_.selectAll(".rapid-view-manage-datasets-status"),w=_.selectAll(".rapid-view-manage-datasets"),E=ee("rapid-internal-feature.previewDatasets")==="true",A=K.esriData;if(!A||Array.isArray(c)&&!c.length){w.classed("hide",!0),b.classed("hide",!1).text(S("rapid_feature_toggle.esri.no_datasets"));return}if(!c){w.classed("hide",!0),b.classed("hide",!1).text(S("rapid_feature_toggle.esri.fetching_datasets")),b.append("br"),b.append("img").attr("class","rapid-view-manage-datasets-spinner").attr("src",t.imagePath("loader-black.gif")),A.loadDatasets().then(F=>{let L=new Set;Object.values(F).forEach(O=>{O.groupCategories.forEach(R=>{L.add(R.toLowerCase().replace("/categories/",""))})}),E||L.delete("preview");let B=Array.from(L).sort().map(O=>{let R={title:O,value:O};return O==="preview"&&(R.display=`${O} <span class="rapid-view-manage-dataset-beta beta"></span>`),R});return n.data(B),c=Object.values(F).filter(O=>E||!O.groupCategories.some(R=>R.toLowerCase()==="/categories/preview")),c}).then(()=>o.call(h));return}w.classed("hide",!1),b.classed("hide",!0);let T=0;c.forEach(F=>{let L=(F.title||"").toLowerCase(),B=(F.snippet||"").toLowerCase();if(y(F)){F.filtered=!1,++T;return}if(a&&L.indexOf(a)===-1&&B.indexOf(a)===-1){F.filtered=!0;return}if(l&&!F.groupCategories.some(O=>O.toLowerCase()===`/categories/${l}`)){F.filtered=!0;return}F.filtered=++T>s});let k=w.selectAll(".rapid-view-manage-dataset").data(c,F=>F.id);k.exit().remove();let C=k.enter().append("div").attr("class","rapid-view-manage-dataset"),I=C.append("div").attr("class","rapid-view-manage-dataset-label");I.append("div").attr("class","rapid-view-manage-dataset-name"),I.append("div").attr("class","rapid-view-manage-dataset-license").append("a").attr("class","rapid-view-manage-dataset-link").attr("target","_blank").attr("href",F=>F.itemURL).text(S("rapid_feature_toggle.esri.more_info")).call(Z("#rapid-icon-out-link","inline"));let P=I.selectAll(".rapid-view-manage-dataset-featured").data(F=>F.groupCategories.filter(L=>L.toLowerCase()==="/categories/featured")).enter().append("div").attr("class","rapid-view-manage-dataset-featured");P.append("span").text("\u2B50"),P.append("span").text(S("rapid_feature_toggle.esri.featured")),I.selectAll(".rapid-view-manage-dataset-beta").data(F=>F.groupCategories.filter(L=>L.toLowerCase()==="/categories/preview")).enter().append("div").attr("class","rapid-view-manage-dataset-beta beta").attr("title",S("rapid_poweruser_features.beta")),I.append("div").attr("class","rapid-view-manage-dataset-snippet"),I.append("button").attr("class","rapid-view-manage-dataset-action").on("click",g),C.append("div").attr("class","rapid-view-manage-dataset-thumb").append("img").attr("class","rapid-view-manage-dataset-thumbnail").attr("src",F=>`https://openstreetmap.maps.arcgis.com/sharing/rest/content/items/${F.id}/info/${F.thumbnail}?w=400`),k=k.merge(C).sort(m).classed("hide",F=>F.filtered),k.selectAll(".rapid-view-manage-dataset-name").html(F=>v(a,F.title)),k.selectAll(".rapid-view-manage-dataset-snippet").html(F=>v(a,F.snippet)),k.selectAll(".rapid-view-manage-dataset-action").classed("secondary",F=>y(F)).text(F=>y(F)?S("rapid_feature_toggle.esri.remove"):S("rapid_feature_toggle.esri.add_to_map"));let M=c.filter(F=>!F.filtered).length,D=T>s&&M===s?">":"";o.selectAll(".rapid-view-manage-filter-results").text(S("rapid_feature_toggle.esri.datasets_found",{num:`${D}${M}`}))}function m(_,b){let w=y(_),E=y(b),A=_.groupCategories.some(k=>k.toLowerCase()==="/categories/featured"),T=b.groupCategories.some(k=>k.toLowerCase()==="/categories/featured");return w&&!E?-1:E&&!w?1:A&&!T?-1:T&&!A?1:_.title.localeCompare(b.title)}function g(_,b){let w=r.datasets(),E=w[b.id];if(E)E.added=!E.added;else{let k=K.esriData;k&&k.loadLayer(b.id);let C=b.groupCategories.some(D=>D.toLowerCase()==="/categories/preview"),I=b.groupCategories.some(D=>D.toLowerCase()==="/categories/buildings"),P=r.colors(),N=Object.keys(w).length%P.length,M={id:b.id,beta:C,added:!0,enabled:!0,conflated:!1,service:"esri",color:P[N],label:b.title,license_markdown:S("rapid_feature_toggle.esri.license_markdown")};b.extent&&(M.extent=new le(b.extent[0],b.extent[1])),I&&(M.conflated=!0,M.service="fbml",w.msBuildings&&(w.msBuildings.enabled=!1)),w[b.id]=M}let A=t.urlhash(),T=Object.values(w).filter(k=>k.added&&k.enabled).map(k=>k.id).join(",");A.setParam("datasets",T.length?T:null),o.call(h),t.enter("browse"),t.map().immediateRedraw()}function y(_){let b=r.datasets();return b[_.id]&&b[_.id].added}function v(_,b){let w=b;if(_){let E=new RegExp("("+x(_)+")","gi");w=w.replace(E,"<mark>$1</mark>")}return w}function x(_){return _.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}return ge(d,i,"on")}function z7(t,e,r){let i=t.rapidContext(),n=H(null),s=H(null),o,a;function l(g){let y=i.datasets()[g.id];return y&&y.enabled}function c(g,y){let v=i.datasets(),x=v[y.id];if(x){x.enabled=!x.enabled;let _=t.urlhash(),b=Object.values(v).filter(w=>w.added&&w.enabled).map(w=>w.id).join(",");_.setParam("datasets",b.length?b:null),t.scene().dirtyLayers("rapid"),t.enter("browse")}}function u(g,y){let x=i.datasets()[g];if(x){x.color=y,t.scene().dirtyLayers("rapid"),t.map().immediateRedraw(),s.call(p);let _=t.mode();if(_.id==="select"&&_.selectedData){let b=new Map(_.selectedData);t.enter("select",{selection:b})}}}function d(){t.scene().toggleLayers("rapid"),s.call(p)}function h(g){g.shiftKey&&g.key===S("map_data.layers.ai-features.key")&&d()}return function(y){n=Er(y),n.select(".modal").attr("class","modal rapid-modal"),o=G7(t,n).on("done",()=>s.call(p)),a=U7(t,n).on("change",u),s=n.select(".content").append("div").attr("class","rapid-stack").on("keypress",h),s.call(p),s.selectAll(".ok-button").node().focus(),r.on("ai_feature_toggle",()=>s.call(p))};function p(g){let y=t.scene().layers.get("rapid");if(!y)return;let v=g.selectAll(".rapid-toggle-all").data([0]),x=v.enter().append("div").attr("class","modal-section rapid-checkbox rapid-toggle-all"),_=x.append("div").attr("class","rapid-feature-label-container");_.append("div").attr("class","rapid-feature-label").html(S("rapid_feature_toggle.toggle_all",{rapidicon:Be("#rapid-logo-rapid-wordmark","logo-rapid")})),_.append("span").attr("class","rapid-feature-hotkey").html("("+e+")");let b=x.append("div").attr("class","rapid-checkbox-inputs").append("label").attr("class","rapid-checkbox-label");b.append("input").attr("type","checkbox").attr("class","rapid-feature-checkbox").on("click",d),b.append("div").attr("class","rapid-checkbox-custom"),v=v.merge(x),v.selectAll(".rapid-feature-checkbox").property("checked",y.enabled);let w=g.selectAll(".rapid-datasets-container").data([0]),E=w.enter().append("div").attr("class","rapid-datasets-container");w.merge(E).call(m);let A=g.selectAll(".rapid-manage-datasets").data([0]).enter().append("div").attr("class","modal-section rapid-checkbox rapid-manage-datasets").on("click",()=>t.container().call(o));A.append("div").attr("class","rapid-feature-label-container").append("div").attr("class","rapid-feature-label").text(S("rapid_feature_toggle.view_manage_datasets")),A.append("div").attr("class","rapid-checkbox-inputs").append("div").attr("class","rapid-checkbox-label").call(Z(se.textDirection()==="rtl"?"#rapid-icon-backward":"#rapid-icon-forward","icon-30")),g.selectAll(".modal-section.buttons").data([0]).enter().append("div").attr("class","modal-section buttons").append("button").attr("class","button ok-button action").on("click",()=>n.remove()).text(S("confirm.okay"))}function m(g){let y=ee("rapid-internal-feature.previewDatasets")==="true",v=Object.values(i.datasets()).filter(A=>A.added&&(y||!A.beta)),x=t.scene().layers.get("rapid");if(!x)return;let _=g.selectAll(".rapid-checkbox-dataset").data(v,A=>A.id);_.exit().remove();let b=_.enter().append("div").attr("class","modal-section rapid-checkbox rapid-checkbox-dataset");b.append("div").attr("class","rapid-feature").each((A,T,k)=>{let C=H(k[T]),I=C.append("div").attr("class","rapid-feature-label-container");I.append("div").attr("class","rapid-feature-label").text(A.label||A.id),A.beta&&I.append("div").attr("class","rapid-feature-label-beta beta").attr("title",S("rapid_poweruser_features.beta")),A.description&&(I.append("div").attr("class","rapid-feature-label-divider"),I.append("div").attr("class","rapid-feature-description").text(A.description)),A.license_markdown&&(I.append("div").attr("class","rapid-feature-label-divider"),I.append("div").attr("class","rapid-feature-license").html(ze.parse(A.license_markdown)),I.select("p a").attr("target","_blank")),C.append("div").attr("class","rapid-feature-extent-container").each((P,N,M)=>{let D=H(M[N]);P.extent&&P.extent.area()<1e4?D.append("a").attr("href","#").text(S("rapid_feature_toggle.center_map")).on("click",F=>{F.preventDefault(),t.map().extent(P.extent)}):D.text(S("rapid_feature_toggle.worldwide"))})});let w=b.append("div").attr("class","rapid-checkbox-inputs");w.append("label").attr("class","rapid-colorpicker-label");let E=w.append("label").attr("class","rapid-checkbox-label");E.append("input").attr("type","checkbox").attr("class","rapid-feature-checkbox").on("click",c),E.append("div").attr("class","rapid-checkbox-custom"),_=_.merge(b).classed("disabled",!x.enabled),_.selectAll(".rapid-colorpicker-label").attr("disabled",x.enabled?null:!0).call(a),_.selectAll(".rapid-checkbox-label").classed("disabled",!x.enabled),_.selectAll(".rapid-feature-checkbox").property("checked",l).attr("disabled",x.enabled?null:!0)}}function H7(t){let e=["previewDatasets","tagnosticRoadCombine","tagSources","showAutoFix","allowLargeEdits"],r=t.rapidContext(),i=r.showPowerUser,n=H(null),s=H(null);i?e.forEach(u=>{let d=ee(`rapid-internal-feature.was.${u}`);d&&(ee(`rapid-internal-feature.${u}`,d),ee(`rapid-internal-feature.was.${u}`,null))}):e.forEach(u=>{let d=ee(`rapid-internal-feature.${u}`);d&&(ee(`rapid-internal-feature.was.${u}`,d),ee(`rapid-internal-feature.${u}`,null))});function o(u){return ee(`rapid-internal-feature.${u}`)==="true"}function a(u,d){let h=ee(`rapid-internal-feature.${d}`)==="true";if(h=!h,ee(`rapid-internal-feature.${d}`,h),d==="previewDatasets"&&!h){let p=r.datasets();Object.values(p).forEach(m=>{m.beta&&(m.added=!1,m.enabled=!1)}),t.enter("browse"),t.map().immediateRedraw()}}return u=>{n=Er(u),n.select(".modal").attr("class","modal rapid-modal"),s=n.select(".content").append("div").attr("class","rapid-stack poweruser"),s.call(l),s.selectAll(".ok-button").node().focus()};function l(u){let d=u.selectAll(".modal-section-heading").data([0]).enter().append("div").attr("class","modal-section-heading");d.append("h3").attr("class","modal-heading").html(S("rapid_poweruser_features.heading.label")),d.append("div").attr("class","modal-heading-desc").text(S("rapid_poweruser_features.heading.description")).append("span").attr("class","smile").text("\u{1F60E}");let h=u.selectAll(".rapid-features-container").data([0]),p=h.enter().append("div").attr("class","rapid-features-container");h.merge(p).call(c),u.selectAll(".modal-section.buttons").data([0]).enter().append("div").attr("class","modal-section buttons").append("button").attr("class","button ok-button action").on("click",()=>n.remove()).text(S("confirm.okay"))}function c(u){let d=u.selectAll(".rapid-checkbox-feature").data(e,g=>g),h=d.enter().append("div").attr("class","modal-section rapid-checkbox rapid-checkbox-feature");h.append("div").attr("class","rapid-feature").each((g,y,v)=>{let x=H(v[y]);x.append("div").attr("class","rapid-feature-label").text(_=>S(`rapid_poweruser_features.${_}.label`)),x.append("div").attr("class","rapid-feature-description").text(_=>S(`rapid_poweruser_features.${_}.description`))});let m=h.append("div").attr("class","rapid-checkbox-inputs").append("label").attr("class","rapid-checkbox-label");m.append("input").attr("type","checkbox").attr("class","rapid-feature-checkbox").on("click",a),m.append("div").attr("class","rapid-checkbox-custom"),d=d.merge(h),d.selectAll(".rapid-feature-checkbox").property("checked",o)}}function kk(t){let e=fe("ai_feature_toggle"),r="\u21E7"+S("map_data.layers.ai-features.key"),i=z7(t,et(r),e),n=H7(t),s=t.rapidContext().showPowerUser,o={id:"rapid_features",label:S("toolbar.rapid_features")};function a(){return t.scene?t.scene().layers.get("rapid")?.enabled:!1}function l(){t.scene().toggleLayers("rapid"),e.call("ai_feature_toggle")}function c(){t.container().call(i)}function u(){t.container().call(n)}let d;return o.install=h=>{d=Gt(m,100,{leading:!0,trailing:!0}),t.keybinding().on(et(r),g=>{g.preventDefault(),g.stopPropagation(),l()}),t.map().on("draw",d),t.on("enter.rapid_features",m);let p=h.append("div").attr("class",s?"joined":null).style("display","flex");m();function m(){let g=p.selectAll(".rapid-features").data([0]),y=g.enter().append("button").attr("class","bar-button rapid-features").attr("tabindex",-1).on("click",c).call(Ae().placement("bottom").title(S("shortcuts.browsing.display_options.rapid_features_data")).keys(r));y.append("svg").attr("class","logo-rapid").append("use").attr("xlink:href","#rapid-logo-rapid-wordmark"),g.merge(y).classed("layer-off",!a()),p.selectAll(".rapid-poweruser-features").data(s?[0]:[]).enter().append("button").attr("class","bar-button rapid-poweruser-features").attr("tabindex",-1).on("click",u).call(Ae().placement("bottom").title(S("rapid_poweruser_features.heading.label"))).append("div").attr("class","beta")}},o.uninstall=function(){t.map().off("draw",d),t.keybinding().off(et(r))},o}function Ik(t){let e=mk(t),r=kk(t),i=dk(t),n=hk(t),s=gk(t),o=pk(t),a=fk(t);function l(){return t.scene().layers.get("notes")?.enabled}function c(d){let h=[e,"spacer",i,r];l()&&h.push("spacer",n),h.push("spacer",s,o),t.urlhash().initialHashParams.get("support_download_osc")==="true"&&h.push(a);let m=d.selectAll(".toolbar-item").data(h,v=>v.id||v);m.exit().each(v=>{v.uninstall&&v.uninstall()}).remove();let y=m.enter().append("div").attr("class",v=>{let x="toolbar-item "+(v.id||v).replace("_","-");return v.klass&&(x+=" "+v.klass),x}).filter(v=>v!=="spacer");y.append("div").attr("class","item-content").each((v,x,_)=>{H(_[x]).call(v.install,d)}),y.append("div").attr("class","item-label").html(v=>v.label)}function u(d){t.scene().on("layerchange",()=>c(d)),c(d)}return u}var Mk=null,Uy=!1,Gy=!1;function $7(t){let e=t.version,r=e.match(/\d+\.\d+\.\d+.*/);return Mk===null&&r!==null&&(ee("sawVersion")?(Gy=!1,Uy=ee("sawVersion")!==e&&e.indexOf("-")===-1):(Gy=!0,Uy=!0),ee("sawVersion",e),Mk=e),function(n){n.append("a").attr("target","_blank").attr("tabindex",-1).attr("href","https://github.com/facebook/Rapid/blob/main/CHANGELOG.md").text(e),Uy&&!Gy&&n.append("a").attr("class","badge").attr("target","_blank").attr("tabindex",-1).attr("href","https://github.com/facebook/Rapid/blob/main/CHANGELOG.md").call(Z("#maki-gift")).call(Ae().title(S.html("version.whats_new",{version:e})).placement("top").scrollContainer(t.container().select(".main-footer-wrap")))}}function rt(t){var e={};function r(o,a){var l=!1,c=Object.keys(e).map(function(p){return e[p]}),u,d;for(u=0;u<c.length;u++)if(d=c[u],!!d.event.modifiers.shiftKey&&!!d.capture===a&&h(o,d,!0)){d.callback(o),l=!0;break}if(l)return;for(u=0;u<c.length;u++)if(d=c[u],!d.event.modifiers.shiftKey&&!!d.capture===a&&h(o,d,!1)){d.callback(o);break}function h(p,m,g){var y=p,v=!1,x=!0;return y.key!==void 0&&(x=y.key.charCodeAt(0)>255,v=!0,m.event.key===void 0?v=!1:Array.isArray(m.event.key)?m.event.key.map(function(_){return _.toLowerCase()}).indexOf(y.key.toLowerCase())===-1&&(v=!1):y.key.toLowerCase()!==m.event.key.toLowerCase()&&(v=!1)),!v&&x&&(v=y.keyCode===m.event.keyCode),!(!v||!(y.ctrlKey&&y.altKey)&&(y.ctrlKey!==m.event.modifiers.ctrlKey||y.altKey!==m.event.modifiers.altKey)||y.metaKey!==m.event.modifiers.metaKey||g&&y.shiftKey!==m.event.modifiers.shiftKey)}}function i(o){r(o,!0)}function n(o){var a=H(o.target).node().tagName;a==="INPUT"||a==="SELECT"||a==="TEXTAREA"||r(o,!1)}function s(o){return o=o||H(document),o.on("keydown.capture."+t,i,!0),o.on("keydown.bubble."+t,n,!1),s}return s.unbind=function(o){return e=[],o=o||H(document),o.on("keydown.capture."+t,null),o.on("keydown.bubble."+t,null),s},s.clear=function(){return e={},s},s.off=function(o,a){for(var l=$e([].concat(o)),c=0;c<l.length;c++){var u=l[c]+(a?"-capture":"-bubble");delete e[u]}return s},s.on=function(o,a,l){if(typeof a!="function")return s.off(o,l);for(var c=$e([].concat(o)),u=0;u<c.length;u++){var d=c[u]+(l?"-capture":"-bubble"),h={id:d,capture:l,callback:a,event:{key:void 0,keyCode:0,modifiers:{shiftKey:!1,ctrlKey:!1,altKey:!1,metaKey:!1}}};e[d]&&console.warn('warning: duplicate keybinding for "'+d+'"'),e[d]=h;for(var p=c[u].toLowerCase().match(/(?:(?:[^+])+|[]|\+\+|^\+$)/g),m=0;m<p.length;m++)if(p[m]==="++"&&(p[m]="+"),p[m]in rt.modifierCodes){var g=rt.modifierProperties[rt.modifierCodes[p[m]]];h.event.modifiers[g]=!0}else h.event.key=rt.keys[p[m]]||p[m],p[m]in rt.keyCodes&&(h.event.keyCode=rt.keyCodes[p[m]])}return s},s}rt.modifierCodes={"\u21E7":16,shift:16,"\u2303":17,ctrl:17,"\u2325":18,alt:18,option:18,"\u2318":91,meta:91,cmd:91,super:91,win:91};rt.modifierProperties={16:"shiftKey",17:"ctrlKey",18:"altKey",91:"metaKey"};rt.plusKeys=["plus","ffplus","=","ffequals","\u2260","\xB1"];rt.minusKeys=["_","-","ffminus","dash","\u2013","\u2014"];rt.keys={"\u232B":"Backspace",backspace:"Backspace","\u21E5":"Tab","\u21C6":"Tab",tab:"Tab","\u21A9":"Enter","\u21B5":"Enter","\u23CE":"Enter",return:"Enter",enter:"Enter","\u2305":"Enter",pause:"Pause","pause-break":"Pause","\u21EA":"CapsLock",caps:"CapsLock","caps-lock":"CapsLock","\u238B":["Escape","Esc"],escape:["Escape","Esc"],esc:["Escape","Esc"],space:[" ","Spacebar"],"\u2196":"PageUp",pgup:"PageUp","page-up":"PageUp","\u2198":"PageDown",pgdown:"PageDown","page-down":"PageDown","\u21DF":"End",end:"End","\u21DE":"Home",home:"Home",ins:"Insert",insert:"Insert","\u2326":["Delete","Del"],del:["Delete","Del"],delete:["Delete","Del"],"\u2190":["ArrowLeft","Left"],left:["ArrowLeft","Left"],"arrow-left":["ArrowLeft","Left"],"\u2191":["ArrowUp","Up"],up:["ArrowUp","Up"],"arrow-up":["ArrowUp","Up"],"\u2192":["ArrowRight","Right"],right:["ArrowRight","Right"],"arrow-right":["ArrowRight","Right"],"\u2193":["ArrowDown","Down"],down:["ArrowDown","Down"],"arrow-down":["ArrowDown","Down"],"*":["*","Multiply"],star:["*","Multiply"],asterisk:["*","Multiply"],multiply:["*","Multiply"],"+":["+","Add"],plus:["+","Add"],"-":["-","Subtract"],subtract:["-","Subtract"],dash:["-","Subtract"],semicolon:";",equals:"=",comma:",",period:".","full-stop":".",slash:"/","forward-slash":"/",tick:"`","back-quote":"`","open-bracket":"[","back-slash":"\\","close-bracket":"]",quote:"'",apostrophe:"'","num-0":"0","num-1":"1","num-2":"2","num-3":"3","num-4":"4","num-5":"5","num-6":"6","num-7":"7","num-8":"8","num-9":"9",f1:"F1",f2:"F2",f3:"F3",f4:"F4",f5:"F5",f6:"F6",f7:"F7",f8:"F8",f9:"F9",f10:"F10",f11:"F11",f12:"F12",f13:"F13",f14:"F14",f15:"F15",f16:"F16",f17:"F17",f18:"F18",f19:"F19",f20:"F20",f21:"F21",f22:"F22",f23:"F23",f24:"F24",f25:"F25"};rt.keyCodes={"\u232B":8,backspace:8,"\u21E5":9,"\u21C6":9,tab:9,"\u21A9":13,"\u21B5":13,"\u23CE":13,return:13,enter:13,"\u2305":13,pause:19,"pause-break":19,"\u21EA":20,caps:20,"caps-lock":20,"\u238B":27,escape:27,esc:27,space:32,"\u2196":33,pgup:33,"page-up":33,"\u2198":34,pgdown:34,"page-down":34,"\u21DF":35,end:35,"\u21DE":36,home:36,ins:45,insert:45,"\u2326":46,del:46,delete:46,"\u2190":37,left:37,"arrow-left":37,"\u2191":38,up:38,"arrow-up":38,"\u2192":39,right:39,"arrow-right":39,"\u2193":40,down:40,"arrow-down":40,ffequals:61,"*":106,star:106,asterisk:106,multiply:106,"+":107,plus:107,"-":109,subtract:109,"|":124,ffplus:171,ffminus:173,";":186,semicolon:186,"=":187,equals:187,",":188,comma:188,dash:189,".":190,period:190,"full-stop":190,"/":191,slash:191,"forward-slash":191,"`":192,tick:192,"back-quote":192,"[":219,"open-bracket":219,"\\":220,"back-slash":220,"]":221,"close-bracket":221,"'":222,quote:222,apostrophe:222};var Cs=95,Ml=0;for(;++Cs<106;)rt.keyCodes["num-"+Ml]=Cs,++Ml;Cs=47;Ml=0;for(;++Cs<58;)rt.keyCodes[Ml]=Cs,++Ml;Cs=111;Ml=1;for(;++Cs<136;)rt.keyCodes["f"+Ml]=Cs,++Ml;Cs=64;for(;++Cs<91;)rt.keyCodes[String.fromCharCode(Cs).toLowerCase()]=Cs;function j7(t){let e=[{id:"zoom-in",icon:"rapid-icon-plus",title:S("zoom.in"),action:r,isDisabled:()=>!t.map().canZoomIn(),disabledTitle:S("zoom.disabled.in"),key:"+"},{id:"zoom-out",icon:"rapid-icon-minus",title:S("zoom.out"),action:i,isDisabled:()=>!t.map().canZoomOut(),disabledTitle:S("zoom.disabled.out"),key:"-"}];function r(o){o.shiftKey||(o.preventDefault(),t.map().zoomIn())}function i(o){o.shiftKey||(o.preventDefault(),t.map().zoomOut())}function n(o){o.shiftKey||(o.preventDefault(),t.map().zoomInFurther())}function s(o){o.shiftKey||(o.preventDefault(),t.map().zoomOutFurther())}return function(o){let a=Ae().placement(se.textDirection()==="rtl"?"right":"left").title(d=>d.isDisabled()?d.disabledTitle:d.title).keys(d=>[d.key]),l,c=o.selectAll("button").data(e).enter().append("button").attr("class",d=>d.id).on("pointerup",d=>l=d.pointerType).on("click",(d,h)=>{h.isDisabled()?(l==="touch"||l==="pen")&&t.ui().flash.duration(2e3).iconName(`#${h.icon}`).iconClass("disabled").label(h.disabledTitle)():h.action(d),l=null}).call(a);c.each((d,h,p)=>{H(p[h]).call(Z(`#${d.icon}`,"light"))}),rt.plusKeys.forEach(d=>{t.keybinding().on([d],r),t.keybinding().on([et("\u2325"+d)],n)}),rt.minusKeys.forEach(d=>{t.keybinding().on([d],i),t.keybinding().on([et("\u2325"+d)],s)});function u(){c.classed("disabled",d=>d.isDisabled()).each((d,h,p)=>{let m=H(p[h]);m.select(".tooltip.in").empty()||m.call(a.updateContent)})}u(),t.map().on("draw",u)}}function Pk(t){let e=S("inspector.zoom_to.key"),r,i;return function(n){let s=Ae().placement(se.textDirection()==="rtl"?"right":"left").title(()=>a()?S("inspector.zoom_to.no_selection"):S("inspector.zoom_to.title")).keys([e]),o=n.append("button").on("pointerup",u=>r=u.pointerType).on("click",l).call(Z("#rapid-icon-framed-dot","light")).call(s);t.keybinding().on(e,l),t.on("enter.uiZoomToSelection",c),c();function a(){let u=t.mode();return!i&&!u?.extent}function l(u){u&&u.preventDefault();let h=t.mode()?.extent,p=t.map();if(i)p.transformEase(i),i=null;else if(h){i=p.transform();let[m,g]=p.dimensions,y=p.extentZoom(h,[m/2,g/2]);p.centerZoomEase(h.center(),y)}else(r==="touch"||r==="pen")&&t.ui().flash.duration(2e3).iconName("#rapid-icon-framed-dot").iconClass("disabled").label(S("inspector.zoom_to.no_selection"))();r=null}function c(){i=null,o.classed("disabled",a()),o.select(".tooltip.in").empty()||o.call(s.updateContent)}}}function Fo(t,e){var r,i="",n="",s="",o,a=H(null),l,c={id:t};c.label=function(d){return arguments.length?(i=d,c):i},c.key=function(d){return arguments.length?(r=d,c):r},c.description=function(d){return arguments.length?(n=d,c):n},c.iconName=function(d){return arguments.length?(s=d,c):s},c.sections=function(d){return arguments.length?(o=d,c):o},c.selection=function(){return a};function u(){e.ui().togglePanes()}return c.togglePane=function(d){d&&d.preventDefault(),l.hide();let h=!a.classed("shown");e.ui().togglePanes(h?a:void 0),c.id==="issues"&&h&&e.validator().validate()},c.renderToggleButton=function(d){l||(l=Ae().placement(se.textDirection()==="rtl"?"right":"left").title(n).keys([r])),d.append("button").on("click",c.togglePane).call(Z("#"+s,"light")).call(l)},c.renderContent=function(d){o&&o.forEach(function(h){d.call(h.render)})},c.renderPane=function(d){a=d.append("div").attr("class","fillL map-pane hide "+t+"-pane").attr("pane",t);var h=a.append("div").attr("class","pane-heading");h.append("h2").html(i),h.append("button").on("click",u).call(Z("#rapid-icon-close")),a.append("div").attr("class","pane-content").call(c.renderContent),r&&e.keybinding().on(r,c.togglePane)},c}function V7(t){let e=mt("background-display-options",t).label(S.html("background.display_options")).disclosureContent(c),r=ee("background-opacity"),i=0,n=3,s=["brightness","contrast","saturation","sharpness"],o={brightness:r!==null?+r:1,contrast:1,saturation:1,sharpness:1};function a(u,d,h){return Math.max(d,Math.min(u,h))}function l(u,d){d=a(d,i,n);let h=t.imagery();o[u]=d,u==="brightness"?(ee("background-opacity",d),h.brightness=d):u==="contrast"?h.contrast=d:u==="saturation"?h.saturation=d:u==="sharpness"&&(h.sharpness=d),e.reRender()}function c(u){let d=u.selectAll(".display-options-container").data([0]),h=d.enter().append("div").attr("class","display-options-container controls-list"),p=h.selectAll(".display-control").data(s).enter().append("div").attr("class",g=>`display-control display-control-${g}`);p.append("h5").html(g=>S.html(`background.${g}`)).append("span").attr("class",g=>`display-option-value display-option-value-${g}`);let m=p.append("div").attr("class","control-wrap");m.append("input").attr("class",g=>`display-option-input display-option-input-${g}`).attr("type","range").attr("min",i).attr("max",n).attr("step","0.05").on("input",(g,y)=>{l(y,g.target.value||1)}),m.append("button").attr("title",S("background.reset")).attr("class",g=>`display-option-reset display-option-reset-${g}`).on("click",(g,y)=>{g.button===0&&l(y,1)}).call(Z("#rapid-icon-"+(se.textDirection()==="rtl"?"redo":"undo"))),h.append("a").attr("class","display-option-resetlink").attr("href","#").html(S.html("background.reset_all")).on("click",g=>{g.preventDefault();for(let y=0;y<s.length;y++)l(s[y],1)}),d=h.merge(d),d.selectAll(".display-option-input").property("value",g=>o[g]),d.selectAll(".display-option-value").text(g=>Math.floor(o[g]*100)+"%"),d.selectAll(".display-option-reset").classed("disabled",g=>o[g]===1),h.size()&&o.brightness!==1&&(t.imagery().brightness=o.brightness)}return e}function X7(){var t=fe("change");function e(r){var i={template:ee("background-custom-template")},n={template:ee("background-custom-template")},s="https://{switch:a,b,c}.tile.openstreetmap.org/{zoom}/{x}/{y}.png",o=tl(r).okButton();o.classed("settings-modal settings-custom-background",!0),o.select(".modal-section.header").append("h3").html(S.html("settings.custom_background.header"));var a=o.select(".modal-section.message-text"),l=`${S.html("settings.custom_background.instructions.info")}

#### ${S.html("settings.custom_background.instructions.wms.tokens_label")}
* ${S.html("settings.custom_background.instructions.wms.tokens.proj")}
* ${S.html("settings.custom_background.instructions.wms.tokens.wkid")}
* ${S.html("settings.custom_background.instructions.wms.tokens.dimensions")}
* ${S.html("settings.custom_background.instructions.wms.tokens.bbox")}

#### ${S.html("settings.custom_background.instructions.tms.tokens_label")}
* ${S.html("settings.custom_background.instructions.tms.tokens.xyz")}
* ${S.html("settings.custom_background.instructions.tms.tokens.flipped_y")}
* ${S.html("settings.custom_background.instructions.tms.tokens.switch")}
* ${S.html("settings.custom_background.instructions.tms.tokens.quadtile")}
* ${S.html("settings.custom_background.instructions.tms.tokens.scale_factor")}

#### ${S.html("settings.custom_background.instructions.example")}
\`${s}\``;a.append("div").attr("class","instructions-template").html(ze.parse(l)),a.append("textarea").attr("class","field-template").attr("placeholder",S("settings.custom_background.template.placeholder")).call(qe).property("value",n.template);var c=o.select(".modal-section.buttons");c.insert("button",".ok-button").attr("class","button cancel-button secondary-action").html(S.html("confirm.cancel")),c.select(".cancel-button").on("click.cancel",d),c.select(".ok-button").attr("disabled",u).on("click.save",h);function u(){return null}function d(){a.select(".field-template").property("value",i.template),ee("background-custom-template",i.template),this.blur(),o.close()}function h(){n.template=a.select(".field-template").property("value"),ee("background-custom-template",n.template),this.blur(),o.close(),t.call("change",this,n)}}return ge(e,t,"on")}function W7(t){let e=mt("background-list",t).label(S("background.backgrounds")).disclosureContent(l),r=H(null),i=t.imagery().findSource("custom"),n=X7(t).on("change",m),s=ee("background-favorites"),o=s?JSON.parse(s):{};function a(){return ee("background-last-used-toggle")}function l(b){let w=b.selectAll(".layer-background-list").data([0]);r=w.enter().append("ul").attr("class","layer-list layer-background-list").attr("dir","auto").merge(w);let E=b.selectAll(".bg-extras-list").data([0]).enter().append("ul").attr("class","layer-list bg-extras-list"),A=E.append("li").attr("class","minimap-toggle-item").append("label").call(Ae().title(S("background.minimap.tooltip")).keys([S("background.minimap.key")]).placement("top"));A.append("input").attr("type","checkbox").on("change",C=>{C.preventDefault(),V1.toggle()}),A.append("span").text(S("background.minimap.description"));let T=E.append("li").attr("class","background-panel-toggle-item").append("label").call(Ae().title(S("background.panel.tooltip")).keys([et("\u2318\u21E7"+S("info_panels.background.key"))]).placement("top"));T.append("input").attr("type","checkbox").on("change",C=>{C.preventDefault(),t.ui().info.toggle("background")}),T.append("span").text(S("background.panel.description"));let k=E.append("li").attr("class","location-panel-toggle-item").append("label").call(Ae().title(S("background.location_panel.tooltip")).keys([et("\u2318\u21E7"+S("info_panels.location.key"))]).placement("top"));k.append("input").attr("type","checkbox").on("change",C=>{C.preventDefault(),t.ui().info.toggle("location")}),k.append("span").text(S("background.location_panel.description")),b.selectAll(".imagery-faq").data([0]).enter().append("div").attr("class","imagery-faq").append("a").attr("target","_blank").call(Z("#rapid-icon-out-link","inline")).attr("href","https://github.com/openstreetmap/iD/blob/develop/FAQ.md#how-can-i-report-an-issue-with-background-imagery").append("span").text(S("background.imagery_problem_faq")),r.call(d,"radio",p,C=>!C.isHidden()&&!C.overlay)}function c(b){b.each((w,E,A)=>{let T=H(A[E]).select("label"),k=T.select("span"),C=E<A.length/2?"bottom":"top",I=k.property("clientWidth")!==k.property("scrollWidth");T.call(Ae().destroyAny),w.id===a()?T.call(Ae().placement(C).title("<div>"+S("background.switch")+"</div>").keys([et("\u2318"+S("background.key"))])):(w.description||I)&&T.call(Ae().placement(C).title(w.description||w.name))})}function u(b,w){return o[b.id]&&!o[w.id]?-1:o[w.id]&&!o[b.id]?1:b.best&&!w.best?-1:w.best&&!b.best?1:hc(b.area,w.area)||Go(b.name,w.name)||0}function d(b,w,E,A){let T=t.imagery().sources(t.map().extent(),t.map().zoom()).filter(A),k=b.selectAll("li").data(T,P=>P.id);k.exit().remove();let C=k.enter().append("li").classed("layer-custom",P=>P.id==="custom").classed("best",P=>P.best),I=C.append("label");I.append("input").attr("type",w).attr("name","layers").on("change",E),I.append("span").attr("class","background-name").text(P=>P.name),C.append("button").attr("class","background-favorite-button").classed("active",P=>!!o[P.id]).attr("tabindex",-1).call(Z("#rapid-icon-favorite")).on("click",(P,N)=>{o[N.id]?(H(P.currentTarget).classed("active",!1),delete o[N.id]):(H(P.currentTarget).classed("active",!0),o[N.id]=!0),ee("background-favorites",JSON.stringify(o)),H(P.currentTarget.parentElement).transition().duration(300).ease(Xl).style("background-color","orange").transition().duration(300).ease(Xl).style("background-color",null),b.selectAll("li").sort(u),b.call(h)}),C.filter(P=>P.id==="custom").append("button").attr("class","layer-browse").call(Ae().title(S("settings.custom_background.tooltip")).placement(se.textDirection()==="rtl"?"right":"left")).on("click",g).call(Z("#rapid-icon-more")),C.filter(P=>P.best).selectAll("label").append("span").attr("class","best").call(Ae().title(S("background.best_imagery")).placement("bottom")).call(Z("#rapid-icon-best-background")),b.selectAll("li").sort(u),b.call(h)}function h(b){function w(E){return t.imagery().showsLayer(E)}b.selectAll("li").classed("active",w).classed("switch",E=>E.id===a()).call(c).selectAll("input").property("checked",w)}function p(b,w){if(w.id==="custom"&&!w.template)return g();let E=t.imagery().baseLayerSource();E instanceof Es&&ee("background-last-used-toggle",E.id),ee("background-last-used",w.id),t.imagery().baseLayerSource(w)}function m(b){b&&b.template?(i.template=b.template,p(void 0,i)):(i.template="",p(void 0,t.imagery().findSource("none")))}function g(b){b.preventDefault(),t.container().call(n)}function y(b){return t.imagery().sources(t.map().extent(),t.map().zoom()).filter(b)}function v(b){let w=y(C=>!C.isHidden()&&!C.overlay);w.sort(u);let E=t.imagery().baseLayerSource(),A=w.indexOf(E);if(A===-1)return;let T=(A+b+w.length)%w.length,k=w[T];k.id==="custom"&&!k.template&&(T=(T+b+w.length)%w.length,k=w[T]),p(void 0,k)}function x(){v(1)}function _(){v(-1)}return t.imagery().on("imagerychange",()=>r.call(h)),t.map().on("draw",Gt(()=>{window.requestIdleCallback(e.reRender)},1e3)),t.keybinding().on(S("background.next_background.key"),x).on(S("background.previous_background.key"),_),e}function q7(t){let e=mt("background-offset",t).label(S.html("background.fix_misalignment")).disclosureContent(l).expandedByDefault(!1),r=[["top",[0,-.5]],["left",[-.5,0]],["right",[.5,0]],["bottom",[0,.5]]];function i(){let c=Gf(t.imagery().offset),u=+c[0].toFixed(2),d=+c[1].toFixed(2);t.container().selectAll(".nudge-inner-rect").select("input").classed("error",!1).property("value",`${u},${d}`),t.container().selectAll(".nudge-reset").classed("disabled",u===0&&d===0)}function n(){t.imagery().offset=[0,0],i()}function s(c){t.imagery().nudge(c,t.map().zoom()),i()}function o(c){let u=H(c.target),d=u.node().value;if(d==="")return n();if(d=d.replace(/;/g,",").split(",").map(function(h){return!isNaN(h)&&h}),d.length!==2||!d[0]||!d[1]){u.classed("error",!0);return}t.imagery().offset=Uf(d),i()}function a(c){if(c.button!==0)return;let u=[c.clientX,c.clientY],d=c.pointerId||"mouse";t.container().append("div").attr("class","nudge-surface"),H(window).on("pointermove.drag-bg-offset",h).on("pointerup.drag-bg-offset",p).on("pointercancel.drag-bg-offset",p);function h(m){if(d!==(m.pointerId||"mouse"))return;let g=[m.clientX,m.clientY],y=[-(u[0]-g[0])/4,-(u[1]-g[1])/4];u=g,s(y)}function p(m){d===(m.pointerId||"mouse")&&m.button===0&&(t.container().selectAll(".nudge-surface").remove(),H(window).on(".drag-bg-offset",null))}}function l(c){let d=c.selectAll(".nudge-container").data([0]).enter().append("div").attr("class","nudge-container");d.append("div").attr("class","nudge-instructions").html(S.html("background.offset"));let h=d.append("div").attr("class","nudge-controls-wrap");h.append("div").attr("class","nudge-outer-rect").on("pointerdown",a).append("div").attr("class","nudge-inner-rect").append("input").attr("type","text").on("change",o),h.append("div").selectAll("button").data(r).enter().append("button").attr("class",m=>`${m[0]} nudge`).attr("tabindex",-1).on("click",(m,g)=>s(g[1])),h.append("button").attr("title",S("background.reset")).attr("class","nudge-reset disabled").on("click",m=>{m.preventDefault(),n()}).call(Z("#rapid-icon-"+(se.textDirection()==="rtl"?"redo":"undo"))),i()}return t.imagery().on("imagerychange",i),e}function Rk(t){var e=mt("grid-display-options",t).label(S("background.grid.grids")).disclosureContent(n);function r(s,o){s.preventDefault(),t.imagery().numGridSplits=o.numSplit}function i(s){var o=s.selectAll(".layer-grid-list").data([0]),a=o.enter().append("ul").attr("class","layer-list layer-grid-list").attr("dir","auto").merge(o),l=a.selectAll("li").data([{numSplit:0,name:S("background.grid.no_grid")},{numSplit:2,name:S("background.grid.n_by_n",{num:2})},{numSplit:3,name:S("background.grid.n_by_n",{num:3})},{numSplit:4,name:S("background.grid.n_by_n",{num:4})},{numSplit:5,name:S("background.grid.n_by_n",{num:5})},{numSplit:6,name:S("background.grid.n_by_n",{num:6})}],function(d){return d.name}),c=l.enter().insert("li",".custom-gridsopt").attr("class","gridsopt"),u=c.append("label");u.append("input").attr("type","radio").attr("name","grids").property("checked",function(d){return d.numSplit===t.imagery().numGridSplits}).on("change",r),u.append("span").text(function(d){return d.name}),l.exit().remove()}function n(s){var o=H(".section-grid-display-options");if(t.rapidContext().on("task_extent_set.grid_display_options",function(){t.rapidContext().isTaskRectangular()&&(o.classed("hide",!1),s.call(i))}),!t.rapidContext().isTaskRectangular()){o.classed("hide",!0);return}}return e}function Y7(t){let e=mt("overlay-list",t).label(S.html("background.overlays")).disclosureContent(l),r=H(null);function i(c){c.each((u,d,h)=>{let p=H(h[d]).select("label"),m=p.select("span"),g=d<h.length/2?"bottom":"top",y=m.property("clientWidth")!==m.property("scrollWidth");p.call(Ae().destroyAny),(u.description||y)&&p.call(Ae().placement(g).title(u.description||u.name))})}function n(c){function u(d){return t.imagery().showsLayer(d)}c.selectAll("li").classed("active",u).call(i).selectAll("input").property("checked",u)}function s(c,u,d,h){let p=t.imagery().sources(t.map().extent(),t.map().zoom()).filter(h),m=c.selectAll("li").data(p,x=>x.name);m.exit().remove();let y=m.enter().append("li").append("label");y.append("input").attr("type",u).attr("name","layers").on("change",d),y.append("span").html(x=>x.label),c.selectAll("li").sort(v),c.call(n);function v(x,_){return x.best&&!_.best?-1:_.best&&!x.best?1:hc(x.area,_.area)||Go(x.name,_.name)||0}}function o(c,u){c.preventDefault(),t.imagery().toggleOverlayLayer(u),r.call(n)}function a(c){return!c.isHidden()&&c.overlay}function l(c){let u=c.selectAll(".layer-overlay-list").data([0]);r=u.enter().append("ul").attr("class","layer-list layer-overlay-list").attr("dir","auto").merge(u),r.call(s,"checkbox",o,a)}return t.imagery().on("imagerychange",()=>e.reRender),t.map().on("draw",Gt(()=>{window.requestIdleCallback(e.reRender)},1e3)),e}function Q7(t){var e=Fo("background",t).key(S("background.key")).label(S.html("background.title")).description(S.html("background.description")).iconName("rapid-icon-layers").sections([W7(t),Y7(t),Rk(t),V7(t),q7(t)]);return e}function K7(t){var e=[["help",["welcome","open_data_h","open_data","before_start_h","before_start","open_source_h","open_source","open_source_help"]],["overview",["navigation_h","navigation_drag","navigation_zoom","features_h","features","nodes_ways"]],["editing",["select_h","select_left_click","select_right_click","select_space","multiselect_h","multiselect","multiselect_shift_click","multiselect_lasso","undo_redo_h","undo_redo","save_h","save","save_validation","upload_h","upload","backups_h","backups","keyboard_h","keyboard"]],["feature_editor",["intro","definitions","type_h","type","type_picker","fields_h","fields_all_fields","fields_example","fields_add_field","tags_h","tags_all_tags","tags_resources"]],["points",["intro","add_point_h","add_point","add_point_finish","move_point_h","move_point","delete_point_h","delete_point","delete_point_command"]],["lines",["intro","add_line_h","add_line","add_line_draw","add_line_continue","add_line_finish","modify_line_h","modify_line_dragnode","modify_line_addnode","connect_line_h","connect_line","connect_line_display","connect_line_drag","connect_line_tag","disconnect_line_h","disconnect_line_command","move_line_h","move_line_command","move_line_connected","delete_line_h","delete_line","delete_line_command"]],["areas",["intro","point_or_area_h","point_or_area","add_area_h","add_area_command","add_area_draw","add_area_continue","add_area_finish","square_area_h","square_area_command","modify_area_h","modify_area_dragnode","modify_area_addnode","delete_area_h","delete_area","delete_area_command"]],["relations",["intro","edit_relation_h","edit_relation","edit_relation_add","edit_relation_delete","maintain_relation_h","maintain_relation","relation_types_h","multipolygon_h","multipolygon","multipolygon_create","multipolygon_merge","turn_restriction_h","turn_restriction","turn_restriction_field","turn_restriction_editing","route_h","route","route_add","boundary_h","boundary","boundary_add"]],["operations",["intro","intro_2","straighten","orthogonalize","circularize","move","rotate","reflect","continue","reverse","disconnect","split","extract","merge","delete","downgrade","copy_paste"]],["notes",["intro","add_note_h","add_note","place_note","move_note","update_note_h","update_note","save_note_h","save_note"]],["imagery",["intro","sources_h","choosing","sources","offsets_h","offset","offset_change"]],["streetlevel",["intro","using_h","using","photos","viewer"]],["gps",["intro","survey","using_h","using","tracing","upload"]],["qa",["intro","tools_h","tools","issues_h","issues"]]],r={"help.help.open_data_h":3,"help.help.before_start_h":3,"help.help.open_source_h":3,"help.overview.navigation_h":3,"help.overview.features_h":3,"help.editing.select_h":3,"help.editing.multiselect_h":3,"help.editing.undo_redo_h":3,"help.editing.save_h":3,"help.editing.upload_h":3,"help.editing.backups_h":3,"help.editing.keyboard_h":3,"help.feature_editor.type_h":3,"help.feature_editor.fields_h":3,"help.feature_editor.tags_h":3,"help.points.add_point_h":3,"help.points.move_point_h":3,"help.points.delete_point_h":3,"help.lines.add_line_h":3,"help.lines.modify_line_h":3,"help.lines.connect_line_h":3,"help.lines.disconnect_line_h":3,"help.lines.move_line_h":3,"help.lines.delete_line_h":3,"help.areas.point_or_area_h":3,"help.areas.add_area_h":3,"help.areas.square_area_h":3,"help.areas.modify_area_h":3,"help.areas.delete_area_h":3,"help.relations.edit_relation_h":3,"help.relations.maintain_relation_h":3,"help.relations.relation_types_h":2,"help.relations.multipolygon_h":3,"help.relations.turn_restriction_h":3,"help.relations.route_h":3,"help.relations.boundary_h":3,"help.notes.add_note_h":3,"help.notes.update_note_h":3,"help.notes.save_note_h":3,"help.imagery.sources_h":3,"help.imagery.offsets_h":3,"help.streetlevel.using_h":3,"help.gps.using_h":3,"help.qa.tools_h":3,"help.qa.issues_h":3},i=e.map(function(s){var o="help."+s[0],a={version:`**${t.version}**`,rapidicon:'<svg class="icon pre-text rapid"><use xlink:href="#rapid-logo-rapid-wordmark"></use></svg>'},l=s[1].reduce(function(c,u){var d=o+"."+u,h=r[d],p=h?Array(h+1).join("#")+" ":"";return c+p+oe(d,a)+`

`},"");return{title:S.html(o+".title"),content:ze.parse(l.trim()).replace(/<code>/g,"<kbd>").replace(/<\/code>/g,"</kbd>")}}),n=Fo("help",t).key(S("help.key")).label(S.html("help.title")).description(S.html("help.title")).iconName("rapid-icon-help");return n.renderContent=function(s){function o(y,v){var x=se.textDirection()==="rtl";s.property("scrollTop",0),n.selection().select(".pane-heading h2").html(y.title),m.html(y.content),m.selectAll("a").attr("target","_blank"),u.classed("selected",function(w){return w.title===y.title}),g.html(""),x?g.call(_).call(b):g.call(b).call(_);function _(w){if(v<i.length-1){var E=w.append("a").attr("href","#").attr("class","next").on("click",function(A){A.preventDefault(),o(i[v+1],v+1)});E.append("span").html(i[v+1].title).call(Z(x?"#rapid-icon-backward":"#rapid-icon-forward","inline"))}}function b(w){if(v>0){var E=w.append("a").attr("href","#").attr("class","previous").on("click",function(A){A.preventDefault(),o(i[v-1],v-1)});E.call(Z(x?"#rapid-icon-forward":"#rapid-icon-backward","inline")).append("span").html(i[v-1].title)}}}function a(y){y.preventDefault(),!t.inIntro()&&(t.container().call(Qs(t)),t.ui().togglePanes())}function l(y){y.preventDefault(),t.container().call(t.ui().shortcuts,!0)}var c=s.append("ul").attr("class","toc"),u=c.selectAll("li").data(i).enter().append("li").append("a").attr("href","#").html(function(y){return y.title}).on("click",function(y,v){y.preventDefault(),o(v,i.indexOf(v))}),d=c.append("li").attr("class","shortcuts").call(Ae().title(S.html("shortcuts.tooltip")).keys(["?"]).placement("top")).append("a").attr("href","#").on("click",l);d.append("div").html(S.html("shortcuts.title"));var h=c.append("li").attr("class","walkthrough").append("a").attr("href","#").on("click",a);h.append("svg").attr("class","logo logo-walkthrough").append("use").attr("xlink:href","#rapid-logo-walkthrough"),h.append("div").html(S.html("splash.walkthrough"));var p=s.append("div").attr("class","left-content"),m=p.append("div").attr("class","body"),g=p.append("div").attr("class","nav");o(i[0],0)},n}function _5(t,e,r){let i=mt(e,t).label(s).shouldDisplay(o).disclosureContent(a),n=[];function s(){let h=n.length>1e3?"1000+":String(n.length),p=S(`issues.${r}s.list_title`);return S("inspector.title_count",{title:p,count:h})}function o(){return n.length}function a(h){let p=t.map().center(),m=t.graph(),g=n.map(function(v){let x=v.extent(m),_=x?Tt(p,x.center()):0;return Object.assign(v,{dist:_})}).sort((y,v)=>y.dist-v.dist);g=g.slice(0,1e3),h.call(l,g)}function l(h,p){let m=ee("rapid-internal-feature.showAutoFix")==="true",g=h.selectAll(".issues-list").data([0]);g=g.enter().append("ul").attr("class",`layer-list issues-list ${r}s-list`).merge(g);let y=g.selectAll("li").data(p,T=>T.key);y.exit().remove();let v=y.enter().append("li").attr("class",T=>`issue severity-${T.severity}`),x=v.append("button").attr("class","issue-label").on("click",(T,k)=>t.validator().focusIssue(k)).on("mouseover",(T,k)=>ct(k.entityIds,!0,t)).on("mouseout",(T,k)=>ct(k.entityIds,!1,t)),_=x.append("span").attr("class","issue-text");_.append("span").attr("class","issue-icon").each((T,k,C)=>{let I="#rapid-icon-"+(T.severity==="warning"?"alert":"error");H(C[k]).call(Z(I))}),_.append("span").attr("class","issue-message"),m&&x.append("span").attr("class","issue-autofix").each((T,k,C)=>{T.autoArgs&&H(C[k]).append("button").attr("title",S("issues.fix_one.title")).datum(T).attr("class","autofix action").on("click",(I,P)=>{I.preventDefault(),I.stopPropagation(),ct(P.entityIds,!1,t),t.perform.apply(t,P.autoArgs),t.validator().validate()}).call(Z("#rapid-icon-wrench"))}),y=y.merge(v).order(),y.selectAll(".issue-message").html(T=>T.message(t));let b=p.filter(T=>T.autoArgs),w=h.selectAll(".autofix-all").data(m&&b.length?[0]:[]);w.exit().remove();let E=w.enter().insert("div",".issues-list").attr("class","autofix-all"),A=E.append("a").attr("class","autofix-all-link").attr("href","#");A.append("span").attr("class","autofix-all-link-text").html(S.html("issues.fix_all.title")),A.append("span").attr("class","autofix-all-link-icon").call(Z("#rapid-icon-wrench")),w=w.merge(E),w.selectAll(".autofix-all-link").on("click",()=>{t.pauseChangeDispatch(),t.perform(hr()),b.forEach(T=>{let k=T.autoArgs.slice();typeof k[k.length-1]!="function"&&k.pop(),k.push(S("issues.fix_all.annotation")),t.replace.apply(t,k)}),t.resumeChangeDispatch(),t.validator().validate()})}function c(){return{what:ee("validate-what")||"edited",where:ee("validate-where")||"all"}}function u(){let h=c();n=t.validator().getIssuesBySeverity(h)[r]}function d(){return t.container().selectAll(".map-panes .issues-pane.shown").size()}return t.validator().on(`validated.uiSectionValidationIssues-${e}`,()=>{window.requestIdleCallback(()=>{d()&&(u(),i.reRender())})}),t.map().on("draw",Gt(()=>{window.requestIdleCallback(()=>{d()&&(c().where==="visible"&&u(),i.reRender())})},1e3)),i}function Z7(t){let e=mt("issues-options",t).content(r);function r(s){let o=s.selectAll(".issues-options-container").data([0]);o=o.enter().append("div").attr("class","issues-options-container").merge(o);let a=[{key:"what",values:["edited","all"]},{key:"where",values:["visible","all"]}],c=o.selectAll(".issues-option").data(a,d=>d.key).enter().append("div").attr("class",d=>`issues-option issues-option-${d.key}`);c.append("div").attr("class","issues-option-title").html(d=>S.html(`issues.options.${d.key}.title`));let u=c.selectAll("label").data(d=>d.values.map(h=>({value:h,key:d.key}))).enter().append("label");u.append("input").attr("type","radio").attr("name",d=>`issues-option-${d.key}`).attr("value",d=>d.value).property("checked",d=>i()[d.key]===d.value).on("change",(d,h)=>n(d,h.key,h.value)),u.append("span").html(d=>S.html(`issues.options.${d.key}.${d.value}`))}function i(){return{what:ee("validate-what")||"edited",where:ee("validate-where")||"all"}}function n(s,o,a){!a&&s&&s.target&&(a=s.target.value),ee(`validate-${o}`,a),t.validator().validate()}return e}function J7(t){let n=mt("issues-rules",t).disclosureContent(o).label(S.html("issues.rules.title")),s=t.validator().getRuleKeys().filter(d=>d!=="maprules").sort((d,h)=>S(`issues.${d}.title`)<S(`issues.${h}.title`)?-1:1);function o(d){let h=d.selectAll(".issues-rulelist-container").data([0]),p=h.enter().append("div").attr("class","issues-rulelist-container");p.append("ul").attr("class","layer-list issue-rules-list");let m=p.append("div").attr("class","issue-rules-links section-footer");m.append("a").attr("class","issue-rules-link").attr("href","#").html(S.html("issues.disable_all")).on("click",g=>{g.preventDefault(),t.validator().disableRules(s)}),m.append("a").attr("class","issue-rules-link").attr("href","#").html(S.html("issues.enable_all")).on("click",g=>{g.preventDefault(),t.validator().disableRules([])}),h=h.merge(p),h.selectAll(".issue-rules-list").call(a,s,"checkbox","rule",u,c)}function a(d,h,p,m,g,y){let v=d.selectAll("li").data(h);v.exit().remove();let x=v.enter().append("li");m==="rule"&&x.call(Ae().title(A=>S.html(`issues.${A}.tip`)).placement("top"));let _=x.append("label");_.append("input").attr("type",p).attr("name",m).on("change",g),_.append("span").html(A=>{let T={};return A==="unsquare_way"&&(T.val='<span class="square-degrees"></span>'),S.html(`issues.${A}.title`,T)}),v=v.merge(x),v.classed("active",y).selectAll("input").property("checked",y).property("indeterminate",!1);let b=ee("validate-square-degrees");b===null&&(b=5 .toString());let E=v.selectAll(".square-degrees").selectAll(".square-degrees-input").data([0]);E.enter().append("input").attr("type","number").attr("min",0 .toString()).attr("max",20 .toString()).attr("step","0.5").attr("class","square-degrees-input").call(qe).on("click",function(A){A.preventDefault(),A.stopPropagation(),this.select()}).on("keyup",function(A){A.keyCode===13&&(this.blur(),this.select())}).on("blur",l).merge(E).property("value",b)}function l(){let d=H(this),h=De(d).trim(),p=parseFloat(h,10);isFinite(p)?p>20?p=20:p<0&&(p=0):p=5,p=Math.round(p*10)/10,h=p.toString(),d.property("value",h),ee("validate-square-degrees",h),t.validator().revalidateUnsquare()}function c(d){return t.validator().isRuleEnabled(d)}function u(d,h){t.validator().toggleRule(h)}return t.validator().on("validated.uiSectionValidationRules",()=>{window.requestIdleCallback(n.reRender)}),n}function e9(t){let e=mt("issues-status",t).shouldDisplay(r).content(n);function r(){return t.validator().getIssues(i()).length===0}function i(){return{what:ee("validate-what")||"edited",where:ee("validate-where")||"all"}}function n(a){let c=a.selectAll(".box").data([0]).enter().append("div").attr("class","box");c.append("div").call(Z("#rapid-icon-apply","pre-text"));let u=c.append("span");u.append("strong").attr("class","message"),u.append("br"),u.append("span").attr("class","details"),s(a),o(a)}function s(a){let l=t.validator().getIssues({what:"all",where:"all",includeDisabledRules:!0,includeIgnored:"only"}),c=a.selectAll(".reset-ignored").data(l.length?[0]:[]);c.exit().remove();let u=c.enter().append("div").attr("class","reset-ignored section-footer");u.append("a").attr("href","#"),c=c.merge(u),c.select("a").html(S("inspector.title_count",{title:S.html("issues.reset_ignored"),count:l.length})),c.on("click",d=>{d.preventDefault(),t.validator().resetIgnoredIssues()})}function o(a){let l=i();function c(d){for(let h in d){let p=d[h],m=t.validator().getIssues(p);if(m.length){a.select(".box .details").html(S.html("issues.no_issues.hidden_issues."+h,{count:m.length.toString()}));return}}a.select(".box .details").html(S.html("issues.no_issues.hidden_issues.none"))}let u;l.what==="edited"&&l.where==="visible"?(u="edits_in_view",c({elsewhere:{what:"edited",where:"all"},everything_else:{what:"all",where:"visible"},disabled_rules:{what:"edited",where:"visible",includeDisabledRules:"only"},everything_else_elsewhere:{what:"all",where:"all"},disabled_rules_elsewhere:{what:"edited",where:"all",includeDisabledRules:"only"},ignored_issues:{what:"edited",where:"visible",includeIgnored:"only"},ignored_issues_elsewhere:{what:"edited",where:"all",includeIgnored:"only"}})):l.what==="edited"&&l.where==="all"?(u="edits",c({everything_else:{what:"all",where:"all"},disabled_rules:{what:"edited",where:"all",includeDisabledRules:"only"},ignored_issues:{what:"edited",where:"all",includeIgnored:"only"}})):l.what==="all"&&l.where==="visible"?(u="everything_in_view",c({elsewhere:{what:"all",where:"all"},disabled_rules:{what:"all",where:"visible",includeDisabledRules:"only"},disabled_rules_elsewhere:{what:"all",where:"all",includeDisabledRules:"only"},ignored_issues:{what:"all",where:"visible",includeIgnored:"only"},ignored_issues_elsewhere:{what:"all",where:"all",includeIgnored:"only"}})):l.what==="all"&&l.where==="all"&&(u="everything",c({disabled_rules:{what:"all",where:"all",includeDisabledRules:"only"},ignored_issues:{what:"all",where:"all",includeIgnored:"only"}})),l.what==="edited"&&t.history().difference().summary().size===0&&(u="no_edits"),a.select(".box .message").html(S.html(`issues.no_issues.message.${u}`))}return t.validator().on("validated.uiSectionValidationStatus",()=>{window.requestIdleCallback(e.reRender)}),t.map().on("draw",Gt(()=>{window.requestIdleCallback(e.reRender)},1e3)),e}function t9(t){return Fo("issues",t).key(S("issues.key")).label(S.html("issues.title")).description(S.html("issues.title")).iconName("rapid-icon-alert").sections([Z7(t),e9(t),_5(t,"issues-errors","error"),_5(t,"issues-warnings","warning"),J7(t)])}function r9(t){var e=fe("change");function r(i){var n=t.scene().layers.get("custom-data"),s={fileList:n&&n.fileList()||null,url:ee("settings-custom-data-url")},o={fileList:n&&n.fileList()||null,url:ee("settings-custom-data-url")},a=tl(i).okButton();a.classed("settings-modal settings-custom-data",!0),a.select(".modal-section.header").append("h3").html(S.html("settings.custom_data.header"));var l=a.select(".modal-section.message-text");l.append("pre").attr("class","instructions-file").html(S.html("settings.custom_data.file.instructions")),l.append("input").attr("class","field-file").attr("type","file").property("files",o.fileList).on("change",function(p){var m=p.target.files;m&&m.length?(o.url="",l.select(".field-url").property("value",""),o.fileList=m):o.fileList=null}),l.append("h4").html(S.html("settings.custom_data.or")),l.append("pre").attr("class","instructions-url").html(S.html("settings.custom_data.url.instructions")),l.append("textarea").attr("class","field-url").attr("placeholder",S("settings.custom_data.url.placeholder")).call(qe).property("value",o.url);var c=a.select(".modal-section.buttons");c.insert("button",".ok-button").attr("class","button cancel-button secondary-action").html(S.html("confirm.cancel")),c.select(".cancel-button").on("click.cancel",d),c.select(".ok-button").attr("disabled",u).on("click.save",h);function u(){return null}function d(){l.select(".field-url").property("value",s.url),ee("settings-custom-data-url",s.url),this.blur(),a.close()}function h(){o.url=l.select(".field-url").property("value").trim(),o.url&&(o.fileList=null),o.fileList&&(o.url=""),ee("settings-custom-data-url",o.url),this.blur(),a.close(),e.call("change",this,o)}}return ge(r,e,"on")}function i9(t){let e=mt("data-layers",t).label(S.html("map_data.data_layers")).disclosureContent(n),r=r9(t).on("change",h),i=t.scene();function n(m){let g=m.selectAll(".data-layer-container").data([0]);g.enter().append("div").attr("class","data-layer-container").merge(g).call(l).call(c).call(u).call(p)}function s(m){let g=i.layers.get(m);return g&&g.enabled}function o(m,g){let y=t.mode();y&&/^draw/.test(y.id)||(g?i.enableLayers(m):(i.disableLayers(m),(m==="osm"||m==="notes")&&t.enter("browse")))}function a(m){o(m,!s(m))}function l(m){let y=["osm","notes"].map(w=>i.layers.get(w)).filter(Boolean),v=m.selectAll(".layer-list-osm").data([0]);v=v.enter().append("ul").attr("class","layer-list layer-list-osm").merge(v);let x=v.selectAll(".list-item").data(y);x.exit().remove();let _=x.enter().append("li").attr("class",w=>`list-item list-item-${w.id}`),b=_.append("label").each((w,E,A)=>{w.id==="osm"?H(A[E]).call(Ae().title(S.html(`map_data.layers.${w.id}.tooltip`)).keys([et("\u2325"+S("area_fill.wireframe.key"))]).placement("bottom")):H(A[E]).call(Ae().title(S.html(`map_data.layers.${w.id}.tooltip`)).placement("bottom"))});b.append("input").attr("type","checkbox").on("change",(w,E)=>a(E.id)),b.append("span").html(w=>S.html(`map_data.layers.${w.id}.title`)),x.merge(_).classed("active",w=>w.enabled).selectAll("input").property("checked",w=>w.enabled)}function c(m){let y=["keepRight","improveOSM","osmose"].map(w=>i.layers.get(w)).filter(Boolean),v=m.selectAll(".layer-list-qa").data([0]);v=v.enter().append("ul").attr("class","layer-list layer-list-qa").merge(v);let x=v.selectAll(".list-item").data(y);x.exit().remove();let _=x.enter().append("li").attr("class",w=>`list-item list-item-${w.id}`),b=_.append("label").each((w,E,A)=>{H(A[E]).call(Ae().title(S.html(`map_data.layers.${w.id}.tooltip`)).placement("bottom"))});b.append("input").attr("type","checkbox").on("change",(w,E)=>a(E.id)),b.append("span").html(w=>S.html(`map_data.layers.${w.id}.title`)),x.merge(_).classed("active",w=>w.enabled).selectAll("input").property("checked",w=>w.enabled)}function u(m){let g=i.layers.get("custom-data"),y=g&&g.hasData(),v=y&&g.enabled,x=m.selectAll(".layer-list-data").data(g?[0]:[]);x.exit().remove();let _=x.enter().append("ul").attr("class","layer-list layer-list-data"),b=_.append("li").attr("class","list-item-data"),w=b.append("label").call(Ae().title(S.html("map_data.layers.custom.tooltip")).placement("top"));w.append("input").attr("type","checkbox").on("change",()=>a("custom-data")),w.append("span").html(S.html("map_data.layers.custom.title")),b.append("button").attr("class","open-data-options").call(Ae().title(S.html("settings.custom_data.tooltip")).placement(se.textDirection()==="rtl"?"right":"left")).on("click",E=>{E.preventDefault(),d()}).call(Z("#rapid-icon-more")),b.append("button").attr("class","zoom-to-data").call(Ae().title(S.html("map_data.layers.custom.zoom")).placement(se.textDirection()==="rtl"?"right":"left")).on("click",function(E){H(this).classed("disabled")||(E.preventDefault(),E.stopPropagation(),g.fitZoom())}).call(Z("#rapid-icon-framed-dot","monochrome")),x=x.merge(_),x.selectAll(".list-item-data").classed("active",v).selectAll("label").classed("deemphasize",!y).selectAll("input").property("disabled",!y).property("checked",v),x.selectAll("button.zoom-to-data").classed("disabled",!y)}function d(){t.container().call(r)}function h(m){let g=i.layers.get("custom-data");m&&m.url?g.url(m.url):m&&m.fileList&&g.fileList(m.fileList)}function p(m){let g=m.selectAll(".md-extras-list").data([0]).enter().append("ul").attr("class","layer-list md-extras-list"),y=g.append("li").attr("class","history-panel-toggle-item").append("label").call(Ae().title(S.html("map_data.history_panel.tooltip")).keys([et("\u2318\u21E7"+S("info_panels.history.key"))]).placement("top"));y.append("input").attr("type","checkbox").on("change",x=>{x.preventDefault(),t.ui().info.toggle("history")}),y.append("span").html(S.html("map_data.history_panel.title"));let v=g.append("li").attr("class","measurement-panel-toggle-item").append("label").call(Ae().title(S.html("map_data.measurement_panel.tooltip")).keys([et("\u2318\u21E7"+S("info_panels.measurement.key"))]).placement("top"));v.append("input").attr("type","checkbox").on("change",x=>{x.preventDefault(),t.ui().info.toggle("measurement")}),v.append("span").html(S.html("map_data.measurement_panel.title"))}return t.scene().on("layerchange",e.reRender),e}function n9(t){let e=mt("map-features",t).label(S.html("map_data.map_features")).disclosureContent(i).expandedByDefault(!1),r=t.features().keys();function i(c){let u=c.selectAll(".layer-feature-list-container").data([0]),d=u.enter().append("div").attr("class","layer-feature-list-container");d.append("ul").attr("class","layer-list layer-feature-list");let h=d.append("div").attr("class","feature-list-links section-footer");h.append("a").attr("class","feature-list-link").attr("href","#").html(S.html("issues.disable_all")).on("click",p=>{p.preventDefault(),t.features().disableAll()}),h.append("a").attr("class","feature-list-link").attr("href","#").html(S.html("issues.enable_all")).on("click",p=>{p.preventDefault(),t.features().enableAll()}),u=u.merge(d),u.selectAll(".layer-feature-list").call(n,r,"checkbox","feature",a,o)}function n(c,u,d,h,p,m){let g=c.selectAll("li").data(u);g.exit().remove();let y=g.enter().append("li").call(Ae().title(function(x){let _=S.html(`${h}.${x}.tooltip`);if(s(x)){let b=l("osm")?S.html("map_data.autohidden"):S.html("map_data.osmhidden");_+=`<div>${b}</div>`}return _}).placement("top")),v=y.append("label");v.append("input").attr("type",d).attr("name",h).on("change",p),v.append("span").html(x=>S.html(`${h}.${x}.description`)),g=g.merge(y),g.classed("active",m).selectAll("input").property("checked",m).property("indeterminate",s)}function s(c){return t.features().autoHidden(c)}function o(c){return t.features().enabled(c)}function a(c,u){t.features().toggle(u)}function l(c){let u=t.scene().layer(c);return u&&u.enabled()}return t.features().on("change.map_features",e.reRender),e}function s9(t){let e=mt("fill-area",t).label(S.html("map_data.style_options")).disclosureContent(r).expandedByDefault(!1);function r(l){let c=l.selectAll(".layer-fill-list").data([0]);c.enter().append("ul").attr("class","layer-list layer-fill-list").merge(c).call(i,t.map().areaFillOptions,"radio","area_fill",s,n);let u=l.selectAll(".layer-visual-diff-list").data([0]);u.enter().append("ul").attr("class","layer-list layer-visual-diff-list").merge(u).call(i,["highlight_edits"],"checkbox","visual_diff",a,o)}function i(l,c,u,d,h,p){let m=l.selectAll("li").data(c);m.exit().remove();let g=m.enter().append("li").call(Ae().title(v=>S.html(`${d}.${v}.tooltip`)).keys(v=>{let x=v==="wireframe"?S("area_fill.wireframe.key"):null;return v==="highlight_edits"&&(x=S("map_data.highlight_edits.key")),x?[x]:null}).placement("top")),y=g.append("label");y.append("input").attr("type",u).attr("name",d).on("change",h),y.append("span").html(v=>S.html(`${d}.${v}.description`)),m=m.merge(g),m.classed("active",p).selectAll("input").property("checked",p).property("indeterminate",!1)}function n(l){return t.map().areaFillMode===l}function s(l,c){t.map().areaFillMode=c}function o(){return t.map().highlightEdits}function a(l){let c=l.currentTarget;t.map().highlightEdits=c.checked}return t.map().on("mapchange",e.reRender),e}function o9(t){let e=mt("photo-overlays",t).label(S.html("photo_overlays.title")).disclosureContent(i).expandedByDefault(!1),r=t.scene();function i(d){let h=d.selectAll(".photo-overlay-container").data([0]);h.enter().append("div").attr("class","photo-overlay-container").merge(h).call(a).call(l).call(c).call(u)}function n(d){let h=r.layers.get(d);return h&&h.enabled}function s(d,h){let p=t.mode();p&&/^draw/.test(p.id)||(h?r.enableLayers(d):r.disableLayers(d))}function o(d){s(d,!n(d))}function a(d){let m=t.photos().overlayLayerIDs.map(w=>r.layers.get(w)).filter(Boolean).filter(w=>w.supported);function g(w){return w&&w.supported}function y(w){return g(w)&&w.enabled}let v=d.selectAll(".layer-list-photos").data([0]);v=v.enter().append("ul").attr("class","layer-list layer-list-photos").merge(v);let x=v.selectAll(".list-item-photos").data(m);x.exit().remove();let _=x.enter().append("li").attr("class",function(w){var E="list-item-photos list-item-"+w.id;return(w.id==="mapillary-signs"||w.id==="mapillary-map-features")&&(E+=" indented"),E}),b=_.append("label").each((w,E,A)=>{let T;w.id==="mapillary-signs"?T="mapillary.signs.tooltip":w.id==="mapillary"?T="mapillary_images.tooltip":w.id==="kartaview"?T="kartaview_images.tooltip":T=w.id.replace(/-/g,"_")+".tooltip",H(A[E]).call(Ae().title(S.html(T)).placement("top"))});b.append("input").attr("type","checkbox").on("change",(w,E)=>o(E.id)),b.append("span").html(w=>{let E=w.id;return E==="mapillary-signs"&&(E="photo_overlays.traffic_signs"),S.html(E.replace(/-/g,"_")+".title")}),x.merge(_).classed("active",y).selectAll("input").property("checked",y)}function l(d){let h=t.photos().allPhotoTypes;function p(x){return t.photos().showsPhotoType(x)}let m=d.selectAll(".layer-list-photo-types").data([0]);m.exit().remove(),m=m.enter().append("ul").attr("class","layer-list layer-list-photo-types").merge(m);let g=m.selectAll(".list-item-photo-types").data(t.photos().shouldFilterByPhotoType()?h:[]);g.exit().remove();let y=g.enter().append("li").attr("class",x=>`list-item-photo-types list-item-${x}`),v=y.append("label").each(function(x){H(this).call(Ae().title(S.html(`photo_overlays.photo_type.${x}.tooltip`)).placement("top"))});v.append("input").attr("type","checkbox").on("change",(x,_)=>t.photos().togglePhotoType(_)),v.append("span").html(x=>S.html(`photo_overlays.photo_type.${x}.title`)),g.merge(y).classed("active",p).selectAll("input").property("checked",p)}function c(d){let h=t.photos().dateFilters;function p(x){return t.photos().dateFilterValue(x)}let m=d.selectAll(".layer-list-date-filter").data([0]);m.exit().remove(),m=m.enter().append("ul").attr("class","layer-list layer-list-date-filter").merge(m);let g=m.selectAll(".list-item-date-filter").data(t.photos().shouldFilterByDate()?h:[]);g.exit().remove();let y=g.enter().append("li").attr("class","list-item-date-filter"),v=y.append("label").each((x,_,b)=>{H(b[_]).call(Ae().title(S.html(`photo_overlays.date_filter.${x}.tooltip`)).placement("top"))});v.append("span").html(x=>S.html(`photo_overlays.date_filter.${x}.title`)),v.append("input").attr("type","date").attr("class","list-item-input").attr("placeholder",S("units.year_month_day")).call(qe).each((x,_,b)=>{De(H(b[_]),t.photos().dateFilterValue(x)||"")}).on("change",function(x,_){let b=De(H(this)).trim();t.photos().setDateFilter(_,b,!0),g.selectAll("input").each(function(w){De(H(this),t.photos().dateFilterValue(w)||"")})}),g=g.merge(y).classed("active",p)}function u(d){function h(){return t.photos().usernames}let p=d.selectAll(".layer-list-username-filter").data([0]);p.exit().remove(),p=p.enter().append("ul").attr("class","layer-list layer-list-username-filter").merge(p);let m=p.selectAll(".list-item-username-filter").data(t.photos().shouldFilterByUsername()?["username-filter"]:[]);m.exit().remove();let g=m.enter().append("li").attr("class","list-item-username-filter"),y=g.append("label").each((x,_,b)=>{H(b[_]).call(Ae().title(S.html("photo_overlays.username_filter.tooltip")).placement("top"))});y.append("span").html(S.html("photo_overlays.username_filter.title")),y.append("input").attr("type","text").attr("class","list-item-input").call(qe).property("value",v).on("change",function(){let x=H(this).property("value");t.photos().setUsernameFilter(x,!0),H(this).property("value",v)}),m.merge(g).classed("active",h);function v(){let x=t.photos().usernames;return x&&x.join("; ")}}return t.scene().on("layerchange",e.reRender),t.photos().on("photochange",e.reRender),e}function a9(t){return Fo("map-data",t).key(S("map_data.key")).label(S.html("map_data.title")).description(S.html("map_data.description")).iconName("rapid-icon-data").sections([i9(t),o9(t),s9(t),n9(t)])}function l9(t){let e=mt("preferences-third-party",t).label(S.html("preferences.privacy.title")).disclosureContent(i),r=ee("preferences.privacy.thirdpartyicons")||"true";function i(n){let o=n.selectAll(".privacy-options-list").data([0]).enter().append("ul").attr("class","layer-list privacy-options-list").append("li").attr("class","privacy-third-party-icons-item").append("label").call(Ae().title(S.html("preferences.privacy.third_party_icons.tooltip")).placement("bottom"));o.append("input").attr("type","checkbox").on("change",l=>{l.preventDefault(),r=r==="true"?"false":"true",ee("preferences.privacy.thirdpartyicons",r),a()}),o.append("span").html(S.html("preferences.privacy.third_party_icons.description")),n.selectAll(".privacy-link").data([0]).enter().append("div").attr("class","privacy-link").append("a").attr("target","_blank").call(Z("#rapid-icon-out-link","inline")).attr("href","https://mapwith.ai/doc/license/MapWithAIPrivacyPolicy.pdf").append("span").html(S.html("preferences.privacy.privacy_link")),a();function a(){n.selectAll(".privacy-third-party-icons-item").classed("active",r==="true").select("input").property("checked",r==="true")}}return e}function c9(t){let e=mt("map-interaction",t).label(S.html("preferences.map_interaction.title")).disclosureContent(i).expandedByDefault(!0),r=["auto","zoom","pan"];function i(a){let l=a.selectAll(".mouse-wheel-options").data([0]),c=l.enter().append("div").attr("class","mouse-wheel-options");c.append("div").attr("class","mouse-wheel-title").text(S("preferences.map_interaction.mouse_wheel.title")),c.append("ul").attr("class","layer-list mouse-wheel-options-list"),l.merge(c).selectAll(".mouse-wheel-options-list").call(n,r,"radio","mouse_wheel",o,s)}function n(a,l,c,u,d,h){let p=a.selectAll("li").data(l);p.exit().remove();let m=p.enter().append("li").call(Ae().title(y=>S(`preferences.map_interaction.${u}.${y}.tooltip`)).placement("top")),g=m.append("label");g.append("input").attr("type",c).attr("name",u).on("change",d),g.append("span").text(y=>S(`preferences.map_interaction.${u}.${y}.title`)),p.merge(m).classed("active",h).selectAll("input").property("checked",h).property("indeterminate",!1)}function s(a){return(ee("prefs.mouse_wheel.interaction")??"auto")===a}function o(a,l){ee("prefs.mouse_wheel.interaction",l),e.reRender()}return e}function u9(t){return Fo("preferences",t).key(S("preferences.key")).label(S.html("preferences.title")).description(S.html("preferences.description")).iconName("fas-user-cog").sections([l9(t),c9(t)])}function f9(){return function(t){t.append("a").attr("href","https://mapwith.ai/doc/license/MapWithAILicense.pdf").attr("target","_blank").text(S("rapid_feature_license"))}}function d9(t){let e=!1;return function(r){if((parseInt(ee("sawWhatsNewVersion"),10)||0)===20230323)return;let s=Er(r);s.select(".modal").attr("class","modal rapid-modal modal-splash modal-whatsnew");let o=s.select(".content");o.append("div").attr("class","modal-section").append("h2").html(S("rapid_whats_new.welcome",{rapidicon:Be("#rapid-logo-rapid-wordmark","pre-text rapid")}));let a=o.append("div").attr("class","modal-section body").html(ze.parse(S("rapid_whats_new.text",{rapidicon:Be("#rapid-logo-rapid-wordmark","pre-text rapid"),bugicon:Be("#rapid-icon-bug","bugnub")})));a.append("div").attr("class","whatsnew-images").append("img").attr("class","whatsnew-image").attr("src",t.asset("img/rapid-v2-splash.jpg")),a.selectAll("p a").attr("target","_blank");let u=o.append("div").attr("class","modal-section rapid-checkbox dontshow").attr("id","dontshowagain").append("label").attr("class","rapid-checkbox-label dontshow");u.append("span").attr("class","rapid-checkbox-text").text(S("rapid_whats_new.dontshowagain")),u.append("input").attr("type","checkbox").attr("class","rapid-feature-checkbox").property("checked",e).on("click",p=>{e=p.target.checked}),u.append("div").attr("class","rapid-checkbox-custom"),o.append("div").attr("class","modal-actions").append("button").attr("class","whats-new-okay").append("div").text(S("rapid_whats_new.ok")).on("click",()=>{e&&ee("sawWhatsNewVersion",20230323),s.close()})}}function h9(t){let e=0,r={},i=()=>{let u=new URL("https://github.com/facebook/Rapid/issues/new");u.searchParams.append("template","bug_report.yml");let d=Rr(),h=`${d.browser} v${d.version}`,p=`${d.os}`,m=navigator.userAgent;u.searchParams.append("browser",h),u.searchParams.append("os",p),u.searchParams.append("useragent",m),u.searchParams.append("URL",window.location.href),u.searchParams.append("version",t.version),window.open(u.toString(),"_blank")},n;function s(u){u.attr("lang",se.localeCode()).attr("dir",se.textDirection()),u.call(h7(t));let d=t.map();d.redrawEnabled=!1,u.append("svg").attr("id","rapid-defs").call(o.svgDefs),u.append("div").attr("class","sidebar").call(o.sidebar);let h=u.append("div").attr("class","main-content active");h.append("div").attr("class","main-map").attr("dir","ltr").call(d.render),h.append("div").attr("class","top-toolbar-wrap").append("div").attr("class","top-toolbar fillD").call(Ik(t));let p=h.append("div").attr("class","over-map");p.append("div").attr("class","select-trap").text("t"),p.call(V1(t)),p.append("div").attr("class","spinner").call(R7(t)),n=p.append("div").attr("class","map-controls"),n.append("div").attr("class","map-control zoombuttons").call(j7(t)),n.append("div").attr("class","map-control zoom-to-selection-control").call(Pk(t)),n.append("div").attr("class","map-control geolocate-control").call(p7(t));let m=p.append("div").attr("class","map-panes");[Q7(t),a9(t),t9(t),u9(t),K7(t)].forEach(k=>{n.append("div").attr("class",`map-control map-pane-control ${k.id}-control`).call(k.renderToggleButton),m.call(k.renderPane)}),o.info=m7(t),p.call(o.info),p.append("div").attr("class","photoviewer").classed("al",!0).classed("hide",!0).call(o.photoviewer),p.append("div").attr("class","attribution-wrap").attr("dir","ltr").call(u7(t));let y=h.append("div").attr("class","map-footer");y.append("div").attr("class","api-status").call(N7(t));let v=y.append("div").attr("class","map-footer-bar fillD");v.append("div").attr("class","flash-wrap footer-hide");let x=v.append("div").attr("class","main-footer-wrap footer-show");x.append("div").attr("class","scale-block").call(v7(t));let _=x.append("div").attr("class","info-block").append("ul").attr("class","map-footer-list");_.append("li").attr("class","user-list").call(f7(t)),_.append("li").attr("class","fb-road-license").attr("tabindex",-1).call(f9());let b=t.apiConnections();b&&b.length>1&&_.append("li").attr("class","source-switch").call(P7(t).keys(b)),_.append("li").attr("class","issues-info").call(g7(t));let w=_.append("li");w.append("button").attr("class","bugnub").attr("tabindex",-1).on("click",i).call(Z("#rapid-icon-bug","bugnub")).call(Ae().title(S.html("report_a_bug")).placement("top")),w.append("a").attr("target","_blank").attr("href","https://github.com/openstreetmap/iD/blob/develop/CONTRIBUTING.md#translating").call(Z("#rapid-icon-translate","light")).call(Ae().title(S.html("help_translate")).placement("top")),_.append("li").attr("class","version").call($7(t)),t.embed()||_.call(c7(t)),o.onResize(),d.redrawEnabled=!0,window.onbeforeunload=function(){return t.save()},window.onunload=function(){t.history().unlock()},H(window).on("resize.editor",function(){o.onResize()}),t.keybinding().on("\u232B",function(k){k.preventDefault()}).on([S("sidebar.key"),"`","\xB2","@"],o.sidebar.toggle).on(et("\u2318"+S("background.key")),function(C){C&&(C.stopImmediatePropagation(),C.preventDefault());let I=t.imagery().findSource(ee("background-last-used-toggle"));if(I){let P=t.imagery().baseLayerSource();ee("background-last-used-toggle",P.id),ee("background-last-used",I.id),t.imagery().baseLayerSource(I)}}).on(S("area_fill.wireframe.key"),function(C){C.preventDefault(),C.stopPropagation();let I=t.map();I.wireframeMode=!I.wireframeMode}).on(et("\u2325"+S("area_fill.wireframe.key")),function(C){C.preventDefault(),C.stopPropagation();let I=t.mode();I&&/^draw/.test(I.id)||(t.scene().toggleLayers("osm"),t.enter("browse"))}).on(S("map_data.highlight_edits.key"),function(C){C.preventDefault(),d.highlightEdits=!d.highlightEdits}),t.enter("browse");let E=t.connection(),A=t.urlhash().initialHashParams.get("walkthrough")==="true";e++||(A||(t.history().lock()&&t.history().hasRestorableChanges()?t.container().call(y7(t)):t.container().call(d9(t))),t.container().call(o.shortcuts));let T=ra(t).message(S.html("loading_auth")).blocking(!0);E&&T&&E.on("authLoading.ui",()=>t.container().call(T)).on("authDone.ui",()=>T.close()),A&&t.container().call(Qs(t))}let o={};o.svgDefs=l7(t),o.flash=gu(t),o.sidebar=M7(t),o.photoviewer=sk(t),o.shortcuts=ok(t);let a;o.ensureLoaded=()=>a||(a=Promise.all([se.ensureLoaded(),xe.ensureLoaded()]).then(()=>{t.container().empty()||s(t.container())}).catch(u=>console.error(u))),o.restart=function(){t.keybinding().clear(),a=null,t.container().selectAll("*").remove(),o.ensureLoaded()},o.onResize=function(u){let d=t.map(),h=io(t.container().select(".main-content"),!0);io(t.container().select(".sidebar"),!0),u!==void 0&&d.pan(u),d.dimensions=h,o.photoviewer.onMapResize(),o.checkOverflow(".top-toolbar"),o.checkOverflow(".map-footer-bar")},o.checkOverflow=function(u,d){d&&delete r[u];let h=t.container().select(u);if(h.empty())return;let p=h.property("scrollWidth"),m=h.property("clientWidth"),g=r[u]||p;p>m?(h.classed("narrow",!0),r[u]||(r[u]=p)):p>=g&&h.classed("narrow",!1)},o.togglePanes=function(u){let d=t.container().selectAll(".map-pane.shown"),h=se.textDirection()==="ltr"?"right":"left";d.classed("shown",!1).classed("hide",!0),t.container().selectAll(".map-pane-control button").classed("active",!1),u?(d.classed("shown",!1).classed("hide",!0).style(h,"-500px"),t.container().selectAll("."+u.attr("pane")+"-control button").classed("active",!0),u.classed("shown",!0).classed("hide",!1),d.empty()?u.style(h,"-500px").transition().duration(200).style(h,"0px"):u.style(h,"0px")):d.classed("shown",!0).classed("hide",!1).style(h,"0px").transition().duration(200).style(h,"-500px").on("end",function(){H(this).classed("shown",!1).classed("hide",!0)})};let l=d7(t);o.editMenu=function(){return l},o.showEditMenu=function(u,d,h){if(l.close(),!h&&t.mode().operations&&(h=typeof t.mode().operations=="function"?t.mode().operations():t.mode().operations),!h||!h.length||!t.editable())return;let p=t.surface().node();p.focus&&p.focus(),h.forEach(m=>{m.point&&m.point(u)}),l.anchorLoc(t.projection.invert(u)).triggerType(d).operations(h),t.map().overlay.call(l)},o.closeEditMenu=function(){l.close()};let c=H(null);return t.uploader().on("saveStarted.ui",()=>{c=ra(t).message(S.html("save.uploading")).blocking(!0),t.container().call(c)}).on("saveEnded.ui",()=>{c.close(),c=H(null)}),o}function Nk(){let t=fe("enter","exit"),e=ge({},t,"on"),r=new Set;e.version="2.0.2",e.privacyVersion="20201202",e.initialHashParams=window.location.hash?Fn(window.location.hash):{},e.isFirstSession=!ee("sawSplash")&&!ee("sawPrivacyVersion"),e.changeset=null;let i=e.initialHashParams.comment,n=e.initialHashParams.source,s=e.initialHashParams.hashtags;e.defaultChangesetComment=function(D){return arguments.length?(i=D,e):i},e.defaultChangesetSource=function(D){return arguments.length?(n=D,e):n},e.defaultChangesetHashtags=function(D){return arguments.length?(s=D,e):s};let o;e.ui=()=>o,e.lastPointerType=()=>"mouse";let a=rt("context");e.keybinding=()=>a,H(document).call(a);let l=K.osm,c,u,d,h;e.connection=()=>l,e.history=()=>c,e.uploader=()=>u,e.urlhash=()=>d,e.validator=()=>h,e.preauth=D=>(l&&l.switch(D),e);let p;e.apiConnections=function(D){return arguments.length?(p=D,e):p},e.locale=function(D){return arguments.length?(se.preferredLocaleCodes(D),e):se.localeCode()};function m(D,F){return(L,B)=>{if(L){(L.status===400||L.status===401||L.status===403)&&l&&l.logout(),typeof F=="function"&&F(L);return}else if(l&&l.getConnectionId()!==D){typeof F=="function"&&F({message:"Connection Switched",status:-1});return}else{c.merge(B.data,B.seenIDs),typeof F=="function"&&F(L,B);return}}}e.loadTiles=(D,F)=>{if(xn(D.scale(),256)<15)return;let R=window.requestIdleCallback(()=>{if(r.delete(R),!(xn(D.scale(),256)<15)&&l&&e.editable()){let G=l.getConnectionId();l.loadTiles(D,m(G,F))}});r.add(R)},e.loadTileAtLoc=(D,F)=>{let L=window.requestIdleCallback(()=>{if(r.delete(L),l&&e.editable()){let B=l.getConnectionId();l.loadTileAtLoc(D,m(B,F))}});r.add(L)},e.loadEntity=(D,F)=>{if(l){let L=l.getConnectionId();l.loadEntity(D,m(L,F)),l.loadEntityRelations(D,m(L,F))}},e.zoomToEntity=(D,F)=>{let L=e.hasEntity(D);L?(e.enter(Se(e,[D])),F!==!1&&T.zoomTo(L)):e.loadEntity(D,(B,O)=>{if(B)return;let R=O.data.find(U=>U.id===D);R&&(e.enter(Se(e,[D])),F!==!1&&T.zoomTo(R))})},e.maxCharsForTagKey=()=>255,e.maxCharsForTagValue=()=>255,e.maxCharsForRelationRole=()=>255;function g(D,F){return D==null?D="":D=D.toString(),D=D.trim(),D.normalize&&(D=D.normalize("NFC")),$5(D,F)}e.cleanTagKey=D=>g(D,e.maxCharsForTagKey()),e.cleanTagValue=D=>g(D,e.maxCharsForTagValue()),e.cleanRelationRole=D=>g(D,e.maxCharsForRelationRole());let y=!1;e.inIntro=function(D){return arguments.length?(y=D,d&&(D?d.disable():d.enable()),e):y},e.save=()=>{if(y||e.container().select(".modal").size())return;let D;if(e._currMode&&e._currMode.id==="save"){if(D=!1,K.osm&&K.osm.isChangesetInflight()){c.clearSaved();return}}else D=e.selectedIDs().every(F=>{let L=e.hasEntity(F);return L&&!L.isDegenerate()});if(D&&c.save(),c.hasChanges())return S("save.unsaved_changes")},e.debouncedSave=Gt(e.save,350);function v(D){return function(){let F=D.apply(c,arguments);return e.debouncedSave(),F}}e.modes=new Map,e._currMode=null,e.mode=()=>e._currMode,e.enter=(D,F)=>{let L=e._currMode,B;return typeof D=="string"?B=e.modes.get(D):B=D,B||(console.error(`context.enter: no such mode: ${D}`),B=e.modes.get("browse")),L&&(L.exit(),C.classed(`mode-${L.id}`,!1),t.call("exit",this,L)),e._currMode=B,e._currMode.enter(F)||(e._currMode=e.modes.get("browse"),e._currMode.enter()),C.classed(`mode-${e._currMode.id}`,!0),t.call("enter",this,e._currMode),e._currMode},e.selectedData=()=>e._currMode?e._currMode.selectedData||new Map:new Map,e.selectedIDs=()=>e._currMode?typeof e._currMode.selectedIDs=="function"?e._currMode.selectedIDs():e._currMode.selectedIDs||[]:[],e.selectedNoteID=()=>(console.error("error: do not call context.selectedNoteID anymore"),null),e.selectedErrorID=()=>(console.error("error: do not call context.selectedErrorID anymore"),null),e.behaviors=new Map,e.enableBehaviors=function(D){D instanceof Set||(D=new Set([].concat(D))),e.behaviors.forEach((F,L)=>{D.has(L)?F.enabled||F.enable():F.enabled&&F.disable()})},e.install=()=>{console.error("error: do not call context.install anymore")},e.uninstall=()=>{console.error("error: do not call context.uninstall anymore")};let x;e.copyGraph=()=>x;let _=[];e.copyIDs=function(D){return arguments.length?(_=D,x=c.graph(),e):_};let b;e.copyLoc=function(D){return arguments.length?(b=D,e):b};let w;e.imagery=()=>w,e.background=()=>w;let E;e.features=()=>E,e.hasHiddenConnections=D=>{let F=c.graph(),L=F.entity(D);return E.hasHiddenConnections(L,F)};let A;e.photos=()=>A;let T;e.map=()=>T,e.scene=()=>T.scene,e.surface=()=>T.surface,e.surfaceRect=()=>T.surface.node().getBoundingClientRect(),e.editable=()=>{let D=e.mode();return!(!D||D.id==="save")};let k={tile:!1,label:!1,imagery:!1,target:!1,downloaded:!1};e.debugFlags=()=>k,e.getDebug=D=>D&&k[D],e.setDebug=function(D,F=!0){return k[D]=F,T&&T.immediateRedraw(),e};let C=H(null);e.container=function(D){return arguments.length?(C=D,C.classed("ideditor",!0),e):C},e.containerNode=function(D){return arguments.length?(e.container(H(D)),e):e.container().node()};let I;e.embed=function(D){return arguments.length?(I=D,e):I};let P="";e.assetPath=function(D){return arguments.length?(P=D,Qe.assetPath(D),e):P};let N={};e.assetMap=function(D){return arguments.length?(N=D,Qe.assetMap(D),e):N},e.asset=D=>{if(/^http(s)?:\/\//i.test(D))return D;let F=P+D;return N[F]||F},e.imagePath=D=>e.asset(`img/${D}`),e.reset=e.flush=()=>(e.debouncedSave.cancel(),Array.from(r).forEach(D=>{window.cancelIdleCallback(D),r.delete(D)}),Object.values(K).forEach(D=>{D&&typeof D.reset=="function"&&D.reset(e)}),e.changeset=null,M.reset(),h.reset(),E.reset(),c.reset(),u.reset(),e.container().select(".inspector-wrap *").remove(),e),e.projection=new Qi;let M;return e.rapidContext=()=>M,e.init=()=>{return D(),F(),e;function D(){c=Cd(e),e.graph=c.graph,e.hasEntity=L=>c.graph().hasEntity(L),e.entity=L=>c.graph().entity(L),e.pauseChangeDispatch=c.pauseChangeDispatch,e.resumeChangeDispatch=c.resumeChangeDispatch,e.perform=v(c.perform),e.replace=v(c.replace),e.pop=v(c.pop),e.overwrite=v(c.overwrite),e.undo=v(c.undo),e.redo=v(c.redo),h=Bd(e),u=Ud(e),w=new vu(e),E=a7(e),T=new e4(e),A=new t4(e),M=Ad(e),d=new Gd(e),o=h9(e),[new l0(e),new c0(e),new u0(e),new f0(e),new d0(e),new zd(e),new h0(e),new p0(e)].forEach(L=>e.behaviors.set(L.id,L)),[new m0(e),new g0(e),new y0(e),new v0(e),new x0(e),new _0(e),new b0(e),new w0(e),new k0(e),new mu(e)].forEach(L=>e.modes.set(L.id,L))}function F(){e.initialHashParams.presets&&xe.addablePresetIDs(new Set(e.initialHashParams.presets.split(","))),e.initialHashParams.locale&&se.preferredLocaleCodes(e.initialHashParams.locale),se.ensureLoaded(),xe.ensureLoaded(),Object.values(K).forEach(L=>{L&&typeof L.init=="function"&&L.init()}),h.init(),w.init(),E.init(),T.init(),M.init(),e.container().empty()||o.ensureLoaded().then(()=>{A.init(),d.init()})}},e}var Lz="bdf6c800b3ae453b9db239e03d7c1727",Bz="https://openstreetmap.maps.arcgis.com/sharing/rest/content",Uz="https://openstreetmap.maps.arcgis.com/home",Gz=14,zz=new Pr().zoomRange(Gz),Ok=fe("loadedData"),Ia={},zy=!1,Dk;function Fk(t){t.abort()}function Hz(t){let e={f:"json",sortField:"title",sortOrder:"asc",num:100,start:t};return`${Bz}/groups/${Lz}/search?`+xt(e)}function $z(t){return`${t}/layers?f=json`}function jz(t){return`${Uz}/item.html?id=${t}`}function Vz(t,e,r){r=r||0;let i=t.layer.id,n=t.layer.maxRecordCount||2e3,s=n*r,o={f:"geojson",outfields:"*",outSR:4326,geometryType:"esriGeometryEnvelope",geometry:e.toParam(),resultOffset:s,resultRecordCount:n};return`${t.url}/${i}/query?`+xt(o)}function Xz(t){if(Ia[t.id])return;Ia[t.id]=t,t.graph=new Dr,t.tree=new zn(t.graph),t.cache={inflight:{},loaded:{},seen:{},origIdTile:{}};let e=H(document.createElement("div"));e.html(t.licenseInfo),e.selectAll("*").attr("style",null).attr("size",null),t.license_html=e.html(),t.itemURL=jz(t.id)}function Lk(t,e,r){let i=t.cache;if(i.loaded[e.id])return;let n=new AbortController,s=Vz(t,e.wgs84Extent,r);It(s,{signal:n.signal}).then(o=>{if(!o)throw new Error("no geojson");return Wz(t,e,o,(a,l)=>{if(a)throw new Error(a);t.graph.rebase(l,[t.graph],!0),t.tree.rebase(l,!0)}),o.properties&&o.properties.exceededTransferLimit}).then(o=>{o?Lk(t,e,++r):(i.loaded[e.id]=!0,Ok.call("loadedData"),delete i.inflight[e.id])}).catch(o=>{o.name!=="AbortError"&&console.error(o)}),i.inflight[e.id]=n}function Wz(t,e,r,i){if(!r)return i({message:"No GeoJSON",status:-1});let n=[];(r.features||[]).forEach(s=>{let o=qz(s,t);o&&n.push.apply(n,o)}),i(null,n)}function qz(t,e){let r=t.geometry,i=t.properties;if(!r||!i)return null;let n=i[e.layer.idfield]||i.OBJECTID||i.FID||i.id;if(!n||e.cache.seen[n])return null;e.cache.seen[n]=!0;let s=`${e.id}-${n}`,o={__fbid__:s,__origid__:s,__service__:"esri",__datasetid__:e.id},a=[],l=new Map;if(r.type==="Point")return[new je({loc:r.coordinates,tags:u(i)},o)];if(r.type==="LineString"){let h=c(r.coordinates);if(h.length<2)return null;let p=new Lt({nodes:h,tags:u(i)},o);return a.push(p),a}else if(r.type==="Polygon"){let h=[];if(r.coordinates.forEach(p=>{let m=c(p);if(m.length<3)return null;let g=m[0],y=m[m.length-1];g!==y&&m.push(g);let v=new Lt({nodes:m});h.push(v)}),h.length===1)a.push(h[0].update(Object.assign({tags:u(i)},o)));else{let p=h.map((y,v)=>(a.push(y),{id:y.id,role:v===0?"outer":"inner",type:"way"})),m=Object.assign(u(i),{type:"multipolygon"}),g=new Cr({members:p,tags:m},o);a.push(g)}return a}function c(h){let p=[];return h.forEach(m=>{let g=m.toString(),y=l.get(g);y||(y=new je({loc:m}),a.push(y),l.set(g,y)),p.push(y.id)}),p}function u(h){let p={};return Object.keys(h).forEach(m=>{let g=d(e.layer.tagmap[m]),y=d(h[m]);g&&y&&(p[g]=y)}),p.source=`esri/${e.name}`,p}function d(h){return h?h.toString().trim():null}}var Hy={init:function(){this.event=ge(this,Ok,"on")},reset:function(){return Object.values(Ia).forEach(t=>{t.cache.inflight&&Object.values(t.cache.inflight).forEach(Fk),t.graph=new Dr,t.tree=new zn(t.graph),t.cache={inflight:{},loaded:{},seen:{},origIdTile:{}}}),this},graph:function(t){let e=Ia[t];return e&&e.graph},intersects:function(t,e){let r=Ia[t];return!r||!r.tree||!r.graph?[]:r.tree.intersects(e,r.graph)},toggle:function(t){return Dk=!t,this},loadTiles:function(t,e){if(Dk)return;let r=Ia[t];if(!r||!r.layer)return;let i=r.cache,n=zz.getTiles(e).tiles;Object.keys(i.inflight).forEach(s=>{n.find(a=>a.id===s)||(Fk(i.inflight[s]),delete i.inflight[s])}),n.forEach(s=>{if(i.loaded[s.id]||i.inflight[s.id])return;if(s.wgs84Extent.polygon().slice(0,4).every(l=>wt.blocksAt(l).length)){i.loaded[s.id]=!0;return}Lk(r,s,0)})},loadDatasets:function(){return zy?Promise.resolve(Ia):new Promise((t,e)=>{i(1);function i(n){It(Hz(n)).then(s=>{(s.results||[]).forEach(o=>Xz(o)),s.nextStart>0?i(s.nextStart):(zy=!0,t(Ia))}).catch(s=>{zy=!1,e(s)})}})},loadLayer:function(t){let e=Ia[t];return!e||!e.url?Promise.reject(`Unknown datasetID: ${t}`):e.layer?Promise.resolve(e.layer):It($z(e.url)).then(r=>{if(!r.layers||!r.layers.length)throw new Error(`Missing layer info for datasetID: ${t}`);e.layer=r.layers[0];let i={};return e.layer.fields.forEach(n=>{n.type==="esriFieldTypeOID"&&(e.layer.idfield=n.name),n.editable&&(i[n.name]=n.alias)}),e.layer.tagmap=i,e.layer}).catch(r=>{r.name!=="AbortError"&&console.error(r)})}};var Yz="https://mapwith.ai/maps/ml_roads",Qz=16,Kz=new Pr().zoomRange(Qz),Bk=fe("loadedData"),Pl={},p9=new Set,Uk;function Gk(t){t.abort()}function Zz(t,e,r){var i=/-conflated$/.test(t.id),n=t.id.replace("-conflated",""),s={conflate_with_osm:i,theme:"ml_road_vector",collaborator:"fbid",token:"ASZUVdYpCkd3M6ZrzjXdQzHulqRMnxdlkeBJWEKOeTUoY_Gwm9fuEd2YObLrClgDB_xfavizBsh0oDfTWTF7Zb4C",hash:"ASYM8LPNy8k1XoJiI7A"};n==="fbRoads"?s.result_type="road_vector_xml":n==="msBuildings"?(s.result_type="road_building_vector_xml",s.building_source="microsoft"):(s.result_type="osm_xml",s.sources=`esri_building.${n}`),s.bbox=e.toParam(),r&&(s.crop_bbox=r.toParam());var o=Yz+"?"+a(s,!0);return o;function a(l,c){function u(d){return encodeURIComponent(d).replace(/(%2F|%3A|%2C|%7B|%7D)/g,decodeURIComponent)}return Object.keys(l).map(function(d){return encodeURIComponent(d)+"="+(c?u(l[d]):encodeURIComponent(l[d]))}).join("&")}}function Jz(t){var e=t.lon&&t.lon.value,r=t.lat&&t.lat.value;return[parseFloat(e),parseFloat(r)]}function eH(t){for(var e=t.getElementsByTagName("nd"),r=new Array(e.length),i=0,n=e.length;i<n;i++)r[i]="n"+e[i].attributes.ref.value;return r}function zk(t){for(var e=t.getElementsByTagName("tag"),r={},i=0,n=e.length;i<n;i++){var s=e[i].attributes,o=(s.k.value||"").trim(),a=(s.v.value||"").trim();o&&a&&(r[o]=a)}return r}function Hk(t){return!t.visible||t.visible.value!=="false"}var tH={node:function(e,r){var i=e.attributes;return new je({id:r,visible:Hk(i),loc:Jz(i),tags:zk(e)})},way:function(e,r){var i=e.attributes;return new Lt({id:r,visible:Hk(i),tags:zk(e),nodes:eH(e)})}};function rH(t,e,r,i,n){if(n=Object.assign({skipSeen:!0},n),!e||!e.childNodes)return i({message:"No XML",status:-1});var s=t.graph,o=t.cache,a=e.childNodes[0],l=a.childNodes,c=window.requestIdleCallback(function(){p9.delete(c);for(var d=[],h=0;h<l.length;h++){var p=u(l[h]);p&&d.push(p)}i(null,d)});p9.add(c);function u(d){var h=tH[d.nodeName];if(!h)return null;var p=Te.id.fromOSM(d.nodeName,d.attributes.id.value);if(n.skipSeen){if(o.seen[p]||o.origIdTile[p])return null;o.seen[p]=!0}var m;if(d.attributes.orig_id){if(m=Te.id.fromOSM(d.nodeName,d.attributes.orig_id.value),s.hasEntity(m)||o.origIdTile[m]&&o.origIdTile[m]!==r.id)return null;o.origIdTile[m]=r.id}var g=h(d,p);if(/^msBuildings/.test(t.id)&&g.type==="way"){let v=g.nodes[0];if(o.firstNodeIDs.has(v))return null;o.firstNodeIDs.add(v)}var y={__fbid__:d.attributes.id.value,__origid__:m,__service__:"fbml",__datasetid__:t.id};return Object.assign(g,y)}}var $y={init:function(){this.event=ge(this,Bk,"on");var t="rapid_intro_graph",e=new Dr,r=new zn(e),i={inflight:{},loaded:{},seen:{},origIdTile:{},firstNodeIDs:new Set},n={id:t,graph:e,tree:r,cache:i};Pl[t]=n},reset:function(){return Array.from(p9).forEach(function(t){window.cancelIdleCallback(t),p9.delete(t)}),Object.values(Pl).forEach(function(t){t.cache.inflight&&Object.values(t.cache.inflight).forEach(Gk),t.graph=new Dr,t.tree=new zn(t.graph),t.cache={inflight:{},loaded:{},seen:{},origIdTile:{},firstNodeIDs:new Set}}),this},graph:function(t){var e=Pl[t];return e&&e.graph},intersects:function(t,e){var r=Pl[t];return!r||!r.tree||!r.graph?[]:r.tree.intersects(e,r.graph)},merge:function(t,e){var r=Pl[t];!r||!r.tree||!r.graph||(r.graph.rebase(e,[r.graph],!1),r.tree.rebase(e,!1))},cache:function(t,e){var r=Pl[t];if(!r||!r.cache)return;function i(n){return JSON.parse(JSON.stringify(n))}if(!arguments.length)return{tile:i(r.cache)};if(e==="get")return r.cache;r.cache=e},toggle:function(t){return Uk=!t,this},loadTiles:function(t,e,r){if(!Uk){var i=Pl[t],n,s,o;i?(n=i.graph,s=i.tree,o=i.cache):(n=new Dr,s=new zn(n),o={inflight:{},loaded:{},seen:{},origIdTile:{},firstNodeIDs:new Set},i={id:t,graph:n,tree:s,cache:o},Pl[t]=i);var a=Kz.getTiles(e).tiles;Object.keys(o.inflight).forEach(l=>{var c=a.find(function(u){return l===u.id});c||(Gk(o.inflight[l]),delete o.inflight[l])}),a.forEach(function(l){if(o.loaded[l.id]||o.inflight[l.id])return;if(l.wgs84Extent.polygon().slice(0,4).every(h=>wt.blocksAt(h).length)){o.loaded[l.id]=!0;return}var d=new AbortController;e0(Zz(i,l.wgs84Extent,r),{signal:d.signal}).then(function(h){delete o.inflight[l.id],h&&rH(i,h,l,function(p,m){p||(n.rebase(m,[n],!0),s.rebase(m,!0),o.loaded[l.id]=!0,Bk.call("loadedData"))})}).catch(h=>{h.name!=="AbortError"&&console.error(h)}),o.inflight[l.id]=d})}}};var Vk=dt(Us(),1);var iH=14,nH=new Pr().zoomRange(iH),$k=fe("loaded"),jy="https://www.keepright.at",Rl={errorTypes:{},localizeStrings:{}},br,sH=[30,40,50,60,70,90,100,110,120,130,150,160,170,180,190,191,192,193,194,195,196,197,198,200,201,202,203,204,205,206,207,208,210,220,230,231,232,270,280,281,282,283,284,285,290,291,292,293,294,295,296,297,298,300,310,311,312,313,320,350,360,370,380,390,400,401,402,410,411,412,413],Ti=new Map;["20","40","210","270","310","320","350"].forEach(t=>Ti.set(t,16777113));["60","70","90","100","110","150","220","380"].forEach(t=>Ti.set(t,5627136));["360","370","410"].forEach(t=>Ti.set(t,16751035));Ti.set("50",16777113);Ti.set("120",13382485);Ti.set("130",16755251);Ti.set("160",12281344);Ti.set("170",16776960);Ti.set("180",11193582);Ti.set("190",16724787);Ti.set("200",16629615);Ti.set("230",12281344);Ti.set("280",6244256);Ti.set("290",11193582);Ti.set("300",39168);Ti.set("390",39168);Ti.set("400",13382485);function Xk(t){t&&t.abort()}function oH(t,e){Object.keys(t.inflightTile).forEach(r=>{e.find(n=>r===n.id)||(Xk(t.inflightTile[r]),delete t.inflightTile[r])})}function Vy(t){return{minX:t.loc[0],minY:t.loc[1],maxX:t.loc[0],maxY:t.loc[1],data:t}}function jk(t,e){br.rtree.remove(t,(r,i)=>r.data.id===i.data.id),e&&br.rtree.insert(t)}function aH(t){if(!(t instanceof Rt))return;let e=new RegExp(/<\/[a-z][\s\S]*>/),r={},i=Rl.errorTypes[t.whichType];if(!i){console.log("No Template: ",t.whichType),console.log("  ",t.description);return}if(!i.regex)return;let n=new RegExp(i.regex,"i"),s=n.exec(t.description);if(!s){console.log("Unmatched: ",t.whichType),console.log("  ",t.description),console.log("  ",n);return}for(let o=1;o<s.length;o++){let a=s[o],l;if(l="IDs"in i?i.IDs[o-1]:"",l&&a)a=lH(a,l);else if(e.test(a))a="\\"+a+"\\";else{let c=a.toLowerCase();Rl.localizeStrings[c]&&(a=S("QA.keepRight.error_parts."+Rl.localizeStrings[c]))}r["var"+o]=a}return r}function lH(t,e){let r=t.toLowerCase();switch(Rl.localizeStrings[r]&&(t=S("QA.keepRight.error_parts."+Rl.localizeStrings[r])),e){case"this":t=i(t);break;case"url":t=s(t);break;case"n":case"w":case"r":t=n(e+t);break;case"20":t=u(t);break;case"211":t=o(t);break;case"231":t=a(t);break;case"294":t=l(t);break;case"370":t=c(t);break}return t;function i(d){return`<a class="error_object_link">${d}</a>`}function n(d){return`<a class="error_entity_link">${d}</a>`}function s(d){return`<a class="kr_external_link" target="_blank" href="${d}">${d}</a>`}function o(d){let h=[];return d.split(", ").forEach(m=>{let g=n("n"+m.slice(1));h.push(g)}),h.join(", ")}function a(d){let h=[];return d.split("),").forEach(m=>{let g=m.match(/\#(\d+)\((.+)\)?/);g!==null&&g.length>2&&h.push(n("w"+g[1])+" "+S("QA.keepRight.errorTypes.231.layer",{layer:g[2]}))}),h.join(", ")}function l(d){let h=[];return d.split(",").forEach(m=>{m=m.split(" ");let g=`"${m[0]}"`,y=m[1].slice(0,1),v=m[2].slice(1);v=n(y+v),h.push(`${g} ${m[1]} ${v}`)}),h.join(", ")}function c(d){if(!d)return"";let h=d.match(/\(including the name (\'.+\')\)/);return h&&h.length?S("QA.keepRight.errorTypes.370.including_the_name",{name:h[1]}):""}function u(d){let h=[];return d.split(",").forEach(m=>{let g=n("n"+m.slice(1));h.push(g)}),h.join(", ")}}var Xy={title:"keepRight",init(){Qe.get("keepRight").then(t=>Rl=t),br||this.reset(),this.event=ge(this,$k,"on")},reset(){br&&Object.values(br.inflightTile).forEach(Xk),br={data:{},loadedTile:{},inflightTile:{},inflightPost:{},closed:{},rtree:new Vk.default}},loadIssues(t){let e={format:"geojson",ch:sH},r=nH.getTiles(t).tiles;oH(br,r),r.forEach(i=>{if(br.loadedTile[i.id]||br.inflightTile[i.id])return;let[n,s,o,a]=i.wgs84Extent.rectangle(),l=Object.assign({},e,{left:n,bottom:a,right:o,top:s}),c=`${jy}/export.php?`+xt(l),u=new AbortController;br.inflightTile[i.id]=u,It(c,{signal:u.signal}).then(d=>{if(delete br.inflightTile[i.id],br.loadedTile[i.id]=!0,!d||!d.features||!d.features.length)throw new Error("No Data");d.features.forEach(h=>{let{properties:{error_type:p,error_id:m,comment:g=null,object_id:y,object_type:v,schema:x,title:_}}=h,{geometry:{coordinates:b},properties:{description:w=""}}=h,E=Rl.errorTypes[p],A=(Math.floor(p/10)*10).toString(),T=E?p:A,k=Rl.errorTypes[T];switch(T){case"170":w=`This feature has a FIXME tag: ${w}`;break;case"292":case"293":w=w.replace("A turn-","This turn-");break;case"294":case"295":case"296":case"297":case"298":w=`This turn-restriction~${w}`;break;case"300":w="This highway is missing a maxspeed tag";break;case"411":case"412":case"413":w=`This feature~${w}`;break}let C=!1;do{b=Ot(b,C?[1e-5,0]:[0,1e-5]);let N=new le(b).bbox();C=br.rtree.search(N).length}while(C);let I=new Rt(b,this,p,m,{comment:g,description:w,whichType:T,parentIssueType:A,severity:k.severity||"error",objectId:y,objectType:v,schema:x,title:_});I.replacements=aH(I),br.data[m]=I,br.rtree.insert(Vy(I))}),$k.call("loaded")}).catch(()=>{delete br.inflightTile[i.id],br.loadedTile[i.id]=!0})})},postUpdate(t,e){if(br.inflightPost[t.id])return e({message:"Error update already inflight",status:-2},t);let r={schema:t.schema,id:t.id};t.newStatus&&(r.st=t.newStatus),t.newComment!==void 0&&(r.co=t.newComment);let i=`${jy}/comment.php?`+xt(r),n=new AbortController;br.inflightPost[t.id]=n,It(i,{signal:n.signal}).finally(()=>{delete br.inflightPost[t.id],t.newStatus==="ignore"?this.removeItem(t):t.newStatus==="ignore_t"?(this.removeItem(t),br.closed[`${t.schema}:${t.id}`]=!0):t=this.replaceItem(t.update({comment:t.newComment,newComment:void 0,newState:void 0})),e&&e(null,t)})},getItems(t){let e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox();return br.rtree.search(n).map(s=>s.data)},getError(t){return br.data[t]},getColor(t){return Ti.get(t)??16777215},replaceItem(t){if(!(!(t instanceof Rt)||!t.id))return br.data[t.id]=t,jk(Vy(t),!0),t},removeItem(t){!(t instanceof Rt)||!t.id||(delete br.data[t.id],jk(Vy(t),!1))},issueURL(t){return`${jy}/report_map.php?schema=${t.schema}&error=${t.id}`},getClosedIDs(){return Object.keys(br.closed).sort()}};var Zk=dt(Us(),1);var cH=14,uH=new Pr().zoomRange(cH),Wk=fe("loaded"),m9={ow:"https://grab.community.improve-osm.org/directionOfFlowService",mr:"https://grab.community.improve-osm.org/missingGeoService",tr:"https://grab.community.improve-osm.org/turnRestrictionService"},qk={icons:{}},q1=new Map;q1.set("tr",15473700);q1.set("ow",2003199);q1.set("mr-road",11817677);q1.set("mr-path",10506797);q1.set("mr-parking",15658496);q1.set("mr-both",16753920);var Dt;function Jk(t){Object.values(t).forEach(e=>{e&&e.abort()})}function fH(t,e){Object.keys(t.inflightTile).forEach(r=>{e.find(n=>r===n.id)||(Jk(t.inflightTile[r]),delete t.inflightTile[r])})}function b5(t){return{minX:t.loc[0],minY:t.loc[1],maxX:t.loc[0],maxY:t.loc[1],data:t}}function Yk(t,e){Dt.rtree.remove(t,(r,i)=>r.data.id===i.data.id),e&&Dt.rtree.insert(t)}function Qk(t){return`<a class="error_object_link">${t}</a>`}function g9(t){return`<a class="error_entity_link">${t}</a>`}function Kk(t){if(t.length){let e=t.reduce((r,i)=>Ot(r,[i.lon,i.lat]),[0,0]);return Yi(e,1/t.length)}else return[0,0]}function dH(t,e){let r=Math.atan2(e.lon-t.lon,e.lat-t.lat);return r<0&&(r+=2*Math.PI),r*180/Math.PI}function hH(t){let e=45*Math.round(t/45);return S(`QA.improveOSM.directions.${{0:"north",45:"northeast",90:"east",135:"southeast",180:"south",225:"southwest",270:"west",315:"northwest",360:"north"}[e]}`)}function Wy(t,e){let r=!1;do{t=Ot(t,r?[1e-5,0]:e?[0,1e-5]:[0,0]);let n=new le(t).bbox();r=Dt.rtree.search(n).length}while(r);return t}var qy={title:"improveOSM",init(){Qe.get("qa_data").then(t=>qk=t.improveOSM),Dt||this.reset(),this.event=ge(this,Wk,"on")},reset(){Dt&&Object.values(Dt.inflightTile).forEach(Jk),Dt={data:{},loadedTile:{},inflightTile:{},inflightPost:{},closed:{},rtree:new Zk.default}},loadIssues(t){let e={client:"Rapid",status:"OPEN",zoom:"19"},r=uH.getTiles(t).tiles;fH(Dt,r),r.forEach(i=>{if(Dt.loadedTile[i.id]||Dt.inflightTile[i.id])return;let[n,s,o,a]=i.wgs84Extent.rectangle(),l=Object.assign({},e,{east:n,south:a,west:o,north:s}),c={};Object.keys(m9).forEach(u=>{let d=Object.assign({},l,u==="mr"?{type:"PARKING,ROAD,BOTH,PATH"}:{confidenceLevel:"C1"}),h=`${m9[u]}/search?`+xt(d),p=new AbortController;c[u]=p,It(h,{signal:p.signal}).then(m=>{delete Dt.inflightTile[i.id][u],Object.keys(Dt.inflightTile[i.id]).length||(delete Dt.inflightTile[i.id],Dt.loadedTile[i.id]=!0),m.roadSegments&&m.roadSegments.forEach(g=>{let{points:y,wayId:v,fromNodeId:x,toNodeId:_}=g,b=`${v}${x}${_}`,w=y.length/2,E;w%1===0?E=Kk([y[w-1],y[w]]):(w=y[Math.floor(w)],E=[w.lon,w.lat]),E=Wy(E,!1);let A=new Rt(E,this,u,b,{issueKey:u,identifier:{wayId:v,fromNodeId:x,toNodeId:_},objectId:v,objectType:"way"});A.replacements={percentage:g.percentOfTrips,num_trips:g.numberOfTrips,highway:Qk(S("QA.keepRight.error_parts.highway")),from_node:g9("n"+g.fromNodeId),to_node:g9("n"+g.toNodeId)},Dt.data[A.id]=A,Dt.rtree.insert(b5(A))}),m.tiles&&m.tiles.forEach(g=>{let{type:y,x:v,y:x,numberOfTrips:_}=g,b=y.toLowerCase(),w=`${b}${v}${x}${_}`,E=Kk(g.points);E=Wy(E,!1);let A=new Rt(E,this,`${u}-${b}`,w,{issueKey:u,identifier:{x:v,y:x}});A.replacements={num_trips:_,geometry_type:S(`QA.improveOSM.geometry_types.${b}`)},_===-1&&(A.desc=S("QA.improveOSM.error_types.mr.description_alt",A.replacements)),Dt.data[A.id]=A,Dt.rtree.insert(b5(A))}),m.entities&&m.entities.forEach(g=>{let{point:y,id:v,segments:x,numberOfPasses:_,turnType:b}=g,w=`${v.replace(/[,:+#]/g,"_")}`,E=Wy([y.lon,y.lat],!0),A=v.split(","),T=A[0],k=A[3],C=A[2].split(":")[1],I=new Rt(E,this,u,w,{issueKey:u,identifier:v,objectId:k,objectType:"node"}),[P,N]=x[0].points,M=hH(dH(P,N));I.replacements={num_passed:_,num_trips:x[0].numberOfTrips,turn_restriction:b.toLowerCase(),from_way:g9("w"+T),to_way:g9("w"+C),travel_direction:M,junction:Qk(S("QA.keepRight.error_parts.this_node"))},Dt.data[I.id]=I,Dt.rtree.insert(b5(I)),Wk.call("loaded")})}).catch(m=>{console.error(m),delete Dt.inflightTile[i.id][u],Object.keys(Dt.inflightTile[i.id]).length||(delete Dt.inflightTile[i.id],Dt.loadedTile[i.id]=!0)})}),Dt.inflightTile[i.id]=c})},getComments(t){if(t.comments)return Promise.resolve(t);let e=t.issueKey,r={};e==="ow"?r=t.identifier:e==="mr"?(r.tileX=t.identifier.x,r.tileY=t.identifier.y):e==="tr"&&(r.targetId=t.identifier);let i=`${m9[e]}/retrieveComments?`+xt(r),n=s=>{t.comments=s.comments?s.comments.reverse():[],this.replaceItem(t)};return It(i).then(n).then(()=>t)},postUpdate(t,e){if(!s4.authenticated())return e({message:"Not Authenticated",status:-3},t);if(Dt.inflightPost[t.id])return e({message:"Error update already inflight",status:-2},t);s4.userDetails(r.bind(this));function r(i,n){if(i)return e(i,t);let s=t.issueKey,o=`${m9[s]}/comment`,a={username:n.display_name,targetIds:[t.identifier]};t.newStatus&&(a.status=t.newStatus,a.text="status changed"),t.newComment&&(a.text=t.newComment);let l=new AbortController;Dt.inflightPost[t.id]=l;let c={method:"POST",signal:l.signal,body:JSON.stringify(a)};It(o,c).then(()=>{if(delete Dt.inflightPost[t.id],t.newStatus)this.removeItem(t),t.newStatus==="SOLVED"&&(t.issueKey in Dt.closed||(Dt.closed[t.issueKey]=0),Dt.closed[t.issueKey]+=1);else{let u=new Date,d=t.comments?t.comments:[];d.push({username:a.username,text:a.text,timestamp:u.getTime()/1e3}),this.replaceItem(t.update({comments:d,newComment:void 0}))}e&&e(null,t)}).catch(u=>{delete Dt.inflightPost[t.id],e&&e(u.message)})}},getItems(t){let e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox();return Dt.rtree.search(n).map(s=>s.data)},getError(t){return Dt.data[t]},getColor(t){return q1.get(t)??16777215},getIcon(t){return qk.icons[t]},replaceItem(t){if(!(!(t instanceof Rt)||!t.id))return Dt.data[t.id]=t,Yk(b5(t),!0),t},removeItem(t){!(t instanceof Rt)||!t.id||(delete Dt.data[t.id],Yk(b5(t),!1))},getClosedCounts(){return Dt.closed}};var nI=dt(Us(),1);var pH=14,mH=new Pr().zoomRange(pH),eI=fe("loaded"),y9="https://osmose.openstreetmap.fr/api/0.3",tI=new Map,rI=new Map,o4={icons:{},types:[]},ur;function sI(t){t&&t.abort()}function gH(t,e){Object.keys(t.inflightTile).forEach(r=>{e.find(n=>r===n.id)||(sI(t.inflightTile[r]),delete t.inflightTile[r])})}function Yy(t){return{minX:t.loc[0],minY:t.loc[1],maxX:t.loc[0],maxY:t.loc[1],data:t}}function iI(t,e){ur.rtree.remove(t,(r,i)=>r.data.id===i.data.id),e&&ur.rtree.insert(t)}function yH(t){let e=!1;do{t=Ot(t,e?[1e-5,0]:[0,1e-5]);let i=new le(t).bbox();e=ur.rtree.search(i).length}while(e);return t}var Qy={title:"osmose",init(){this.reset(),this.event=ge(this,eI,"on"),Qe.get("qa_data").then(t=>{o4.icons=t.osmose.icons,o4.types=Object.keys(t.osmose.icons).map(e=>e.split("-")[0]).reduce((e,r)=>e.indexOf(r)!==-1?e:[...e,r],[])}).then(this.loadStringsAsync)},reset(){ur&&Object.values(ur.inflightTile).forEach(sI),ur={issues:new Map,loadedTile:{},inflightTile:{},inflightPost:{},closed:{},rtree:new nI.default}},loadIssues(t){let e=mH.getTiles(t).tiles;gH(ur,e),e.forEach(r=>{if(ur.loadedTile[r.id]||ur.inflightTile[r.id])return;let[i,n,s]=r.xyz,o={item:o4.types},a=`${y9}/issues/${s}/${i}/${n}.json?`+xt(o),l=new AbortController;ur.inflightTile[r.id]=l,It(a,{signal:l.signal}).then(c=>{delete ur.inflightTile[r.id],ur.loadedTile[r.id]=!0,c.features&&c.features.forEach(u=>{let{item:d,class:h,uuid:p}=u.properties,m=`${d}-${h}`;if(m in o4.icons){let g=u.geometry.coordinates;g=yH(g);let y=new Rt(g,this,m,p,{item:d});(d===8300||d===8360)&&(y.elems=[]),ur.issues.set(y.id,y),ur.rtree.insert(Yy(y))}}),eI.call("loaded")}).catch(()=>{delete ur.inflightTile[r.id],ur.loadedTile[r.id]=!0})})},loadIssueDetailAsync(t){if(t.elems!==void 0)return Promise.resolve(t);let e=`${y9}/issue/${t.id}?langs=${se.localeCode()}`,r=i=>{t.elems=i.elems.map(n=>n.type.substring(0,1)+n.id),t.detail=i.subtitle?ze.parse(i.subtitle.auto):"",this.replaceItem(t)};return It(e).then(r).then(()=>t)},loadStringsAsync(){let t=Object.keys(o4.icons),e={},r=se.localeCode();rI.set(r,e);let i=t.map(n=>{let s=c=>{let[u={items:[]}]=c.categories,[d={class:[]}]=u.items,[h=null]=d.class;if(!h){console.log(`Osmose strings request (${n}) had unexpected data`);return}let{item:p,color:m}=d;/^#[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3}/.test(m)&&tI.set(p,he.string2hex(m));let{title:g,detail:y,fix:v,trap:x}=h,_={};g&&(_.title=g.auto.charAt(0).toUpperCase()+g.auto.slice(1)),y&&(_.detail=ze.parse(y.auto)),x&&(_.trap=ze.parse(x.auto)),v&&(_.fix=ze.parse(v.auto)),e[n]=_},[o,a]=n.split("-"),l=`${y9}/items/${o}/class/${a}?langs=${r}`;return It(l).then(s)}).filter(Boolean);return Promise.all(i)},getStrings(t,e=se.localeCode()){return(rI.get(e)??{})[t]??{}},getColor(t){return tI.get(t)??16777215},postUpdate(t,e){if(ur.inflightPost[t.id])return e({message:"Issue update already inflight",status:-2},t);let r=`${y9}/issue/${t.id}/${t.newStatus}`,i=new AbortController,n=()=>{delete ur.inflightPost[t.id],this.removeItem(t),t.newStatus==="done"&&(t.item in ur.closed||(ur.closed[t.item]=0),ur.closed[t.item]+=1),e&&e(null,t)};ur.inflightPost[t.id]=i,fetch(r,{signal:i.signal}).then(n).catch(s=>{delete ur.inflightPost[t.id],e&&e(s.message)})},getItems(t){let e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox();return ur.rtree.search(n).map(s=>s.data)},getError(t){return ur.issues.get(t)},getIcon(t){return o4.icons[t]},replaceItem(t){if(!(!(t instanceof Rt)||!t.id))return ur.issues.set(t.id,t),iI(Yy(t),!0),t},removeItem(t){!(t instanceof Rt)||!t.id||(ur.isseus.delete(t.id),iI(Yy(t),!1))},getClosedCounts(){return ur.closed},itemURL(t){return`https://osmose.openstreetmap.fr/en/error/${t.id}`}};var ov=dt(Jy(),1),av=dt(rv(),1),S9=dt(Us(),1);var f4="MLY|3376030635833192|f13ab0bdf6b2f7b99e0d8bd5868e1d88",xI="https://graph.mapillary.com/",lv="https://tiles.mapillary.com/maps/vtp",XH=`${lv}/mly_map_feature_point/2/{z}/{x}/{y}?access_token=${f4}`,WH=`${lv}/mly1_public/2/{z}/{x}/{y}?access_token=${f4}`,qH=`${lv}/mly_map_feature_traffic_sign/2/{z}/{x}/{y}?access_token=${f4}`,YH="mapillary-js/mapillary.css",QH="mapillary-js/mapillary.js",KH=14,Pa=fe("change","loadedImages","loadedSigns","loadedMapFeatures","bearingChanged","imageChanged"),ZH=new Pr().skipNullIsland(!0),w5,Y1,vi,b9=!1,iv,w9=!1,E9=!1,Ai,nv=["all"];function sv(t,e,r,i){ZH.zoomRange(KH,r).getTiles(i).tiles.forEach(s=>JH(t,e,s))}function JH(t,e,r){let i=vi.requests,n=`${r.id}-${t}`;if(i.loaded[n]||i.inflight[n])return;let s=new AbortController;i.inflight[n]=s;let o=e.replace("{x}",r.xyz[0]).replace("{y}",r.xyz[1]).replace("{z}",r.xyz[2]);fetch(o,{signal:s.signal}).then(a=>{if(!a.ok)throw new Error(a.status+" "+a.statusText);return i.loaded[n]=!0,a.arrayBuffer()}).then(a=>{if(!a)throw new Error("No Data");e$(a,r),t==="images"?Pa.call("loadedImages"):t==="signs"?Pa.call("loadedSigns"):t==="points"&&Pa.call("loadedMapFeatures")}).catch(a=>{a.name!=="AbortError"&&(a instanceof Error&&console.error(a),i.loaded[n]=!0)}).finally(()=>{delete i.inflight[n]})}function e$(t,e){let r=new ov.VectorTile(new av.default(t));if(r.layers.hasOwnProperty("image")){let i=vi.images,n=r.layers.image,s=[];for(let o=0;o<n.length;o++){let a=n.feature(o).toGeoJSON(e.xyz[0],e.xyz[1],e.xyz[2]);if(!a||i.forImageID[a.properties.id]!==void 0)continue;let l=a.geometry.coordinates,c={id:a.properties.id,loc:l,captured_at:a.properties.captured_at,ca:a.properties.compass_angle,isPano:a.properties.is_pano,sequenceID:a.properties.sequence_id};i.forImageID[c.id]=c,s.push({minX:l[0],minY:l[1],maxX:l[0],maxY:l[1],data:c})}i.rtree.load(s)}if(r.layers.hasOwnProperty("sequence")){let i=vi.sequences,n=r.layers.sequence;for(let s=0;s<n.length;s++){let o=n.feature(s).toGeoJSON(e.xyz[0],e.xyz[1],e.xyz[2]);if(!o)continue;let a=o.properties.id,l=i.get(a);l||(l=[],i.set(a,l)),l.push(o)}}if(r.layers.hasOwnProperty("point")){let i=vi.points,n=r.layers.point,s=[];for(let o=0;o<n.length;o++){let a=n.feature(o).toGeoJSON(e.xyz[0],e.xyz[1],e.xyz[2]);if(!a)continue;let l=a.geometry.coordinates,c={id:a.properties.id,loc:l,first_seen_at:a.properties.first_seen_at,last_seen_at:a.properties.last_seen_at,value:a.properties.value};s.push({minX:l[0],minY:l[1],maxX:l[0],maxY:l[1],data:c})}i.rtree.load(s)}if(r.layers.hasOwnProperty("traffic_sign")){let i=vi.signs,n=r.layers.traffic_sign,s=[];for(let o=0;o<n.length;o++){let a=n.feature(o).toGeoJSON(e.xyz[0],e.xyz[1],e.xyz[2]),l=a.geometry.coordinates,c={id:a.properties.id,loc:l,first_seen_at:a.properties.first_seen_at,last_seen_at:a.properties.last_seen_at,value:a.properties.value};s.push({minX:l[0],minY:l[1],maxX:l[0],maxY:l[1],data:c})}i.rtree.load(s)}}function _I(t){return fetch(t).then(e=>{if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.json()}).then(e=>e?.data||[]).catch(e=>{e.name!=="AbortError"&&e instanceof Error&&console.error(e)})}var cv={init:function(){vi||this.reset(),this.event=ge(this,Pa,"on")},reset:function(){vi&&Object.values(vi.requests.inflight).forEach(function(t){t.abort()}),vi={images:{rtree:new S9.default,forImageID:{}},image_detections:{forImageID:{}},signs:{rtree:new S9.default},points:{rtree:new S9.default},sequences:new Map,requests:{loaded:{},inflight:{}}},Y1=null},images:function(t){let e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox();return vi.images.rtree.search(n).map(s=>s.data)},signs:function(t){let e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox();return vi.signs.rtree.search(n).map(s=>s.data)},mapFeatures:function(t){let e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox();return vi.points.rtree.search(n).map(s=>s.data)},cachedImage:function(t){return vi.images.forImageID[t]},sequences:function(t){let e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox(),s=new Map;for(let o of vi.images.rtree.search(n)){let a=o.data.sequenceID;if(!a)continue;let l=vi.sequences.get(a);l&&(s.has(a)||s.set(a,l))}return[...s.values()]},loadImages:function(t){sv("images",WH,14,t)},loadSigns:function(t){sv("signs",qH,14,t)},loadMapFeatures:function(t){sv("points",XH,14,t)},loadViewerAsync:function(t){if(w5)return w5;t.container().select(".photoviewer").selectAll(".mly-wrapper").data([0]).enter().append("div").attr("id","ideditor-mly").attr("class","photo-wrapper mly-wrapper").classed("hide",!0);let r=this;return w5=new Promise((i,n)=>{let s=0;function o(){s+=1,s===2&&i()}let a=H("head");a.selectAll("#ideditor-mapillary-viewercss").data([0]).enter().append("link").attr("id","ideditor-mapillary-viewercss").attr("rel","stylesheet").attr("crossorigin","anonymous").attr("href",t.asset(YH)).on("load.serviceMapillary",o).on("error.serviceMapillary",n),a.selectAll("#ideditor-mapillary-viewerjs").data([0]).enter().append("script").attr("id","ideditor-mapillary-viewerjs").attr("crossorigin","anonymous").attr("src",t.asset(QH)).on("load.serviceMapillary",o).on("error.serviceMapillary",n)}).then(()=>r.initViewer(t)).catch(i=>{i instanceof Error&&console.error(i),w5=null}),w5},resetTags:function(){Ai&&!b9&&Ai.getComponent("tag").removeAll()},showFeatureDetections:function(t){w9=t,!w9&&!E9&&this.resetTags()},showSignDetections:function(t){E9=t,!w9&&!E9&&this.resetTags()},filterViewer:function(t){let e=t.photos().showsPanoramic,r=t.photos().showsFlat,i=t.photos().fromDate,n=t.photos().toDate,s=["all"];return e||s.push(["!=","cameraType","spherical"]),!r&&e&&s.push(["==","pano",!0]),i&&s.push([">=","capturedAt",new Date(i).getTime()]),n&&s.push([">=","capturedAt",new Date(n).getTime()]),Ai&&Ai.setFilter(s),nv=s,s},showViewer:function(t){let e=t.container().select(".photoviewer").classed("hide",!1);return e.selectAll(".photo-wrapper.mly-wrapper.hide").size()&&Ai&&(e.selectAll(".photo-wrapper:not(.mly-wrapper)").classed("hide",!0),e.selectAll(".photo-wrapper.mly-wrapper").classed("hide",!1),Ai.resize()),this},hideViewer:function(t){Y1=null,t.photos().selectPhoto(null),!b9&&Ai&&Ai.getComponent("sequence").stop();let e=t.container().select(".photoviewer");return e.empty()||e.datum(null),e.classed("hide",!0).selectAll(".photo-wrapper").classed("hide",!0),Pa.call("imageChanged"),Pa.call("loadedMapFeatures"),Pa.call("loadedSigns"),this.setStyles(t,null)},highlightDetection:function(t){return t&&(iv=t.id),this},initViewer:function(t){let e=this;if(!window.mapillary)return;let r={accessToken:f4,component:{cover:!1,keyboard:!1,tag:!0},container:"ideditor-mly"};!mapillary.isSupported()&&mapillary.isFallbackSupported()&&(b9=!0,r.component={cover:!1,direction:!1,imagePlane:!1,keyboard:!1,mouse:!1,sequence:!1,tag:!1,image:!0,navigation:!0}),Ai=new mapillary.Viewer(r),Ai.on("image",i),Ai.on("bearing",n),nv&&Ai.setFilter(nv),t.ui().photoviewer.on("resize.mapillary",()=>{Ai&&Ai.resize()});function i(s){e.resetTags();let o=s.image;e.setActiveImage(o),e.setStyles(t,null);let a=[o.originalLngLat.lng,o.originalLngLat.lat];t.map().centerEase(a),t.photos().selectPhoto("mapillary",o.id),(w9||E9)&&e.updateDetections(o.id,`${xI}/${o.id}/detections?access_token=${f4}&fields=id,image,geometry,value`),Pa.call("imageChanged")}function n(s){Pa.call("bearingChanged",void 0,s)}},selectImage:function(t,e){return Ai&&e&&Ai.moveTo(e).catch(r=>console.error("mly3",r)),this},getActiveImage:function(){return Y1},getDetections:function(t){return _I(`${xI}/${t}/detections?access_token=${f4}&fields=id,value,image`)},setActiveImage:function(t){t?Y1={ca:t.originalCompassAngle,id:t.id,loc:[t.originalLngLat.lng,t.originalLngLat.lat],isPano:t.cameraType==="spherical",sequenceID:t.sequenceID}:Y1=null},setStyles:function(t,e){let r=e?.id,i=e?.sequenceID,n=Y1&&Y1.sequenceID;return t.container().selectAll(".layer-mapillary .viewfield-group").classed("highlighted",function(s){return s.sequenceID===n||s.id===r}).classed("hovered",function(s){return s.id===r}),t.container().selectAll(".layer-mapillary .sequence").classed("highlighted",function(s){return s.properties.id===i}).classed("currentView",function(s){return s.properties.id===n}),this},updateDetections:function(t,e){if(!Ai||b9||!t)return;let r=vi.image_detections;r.forImageID[t]?i(vi.image_detections.forImageID[t]):_I(e).then(s=>{s.forEach(function(o){r.forImageID[t]||(r.forImageID[t]=[]),r.forImageID[t].push({geometry:o.geometry,id:o.id,image_id:t,value:o.value})}),i(vi.image_detections.forImageID[t]||[])});function i(s){let o=Ai.getComponent("tag");for(let a of s){let l=n(a);l&&o.add([l])}}function n(s){let o=s.value.split("--");if(!o.length)return;let a,l,c=16777215;iv===s.id&&(c=16776960,l=o[1],(l==="flat"||l==="discrete"||l==="sign")&&(l=o[2]),l=l.replace(/-/g," "),l=l.charAt(0).toUpperCase()+l.slice(1),iv=null);let u=window.atob(s.geometry),d=new Uint8Array(u.length);for(let y=0;y<u.length;y++)d[y]=u.charCodeAt(y);let p=new ov.VectorTile(new av.default(d.buffer)).layers["mpy-or"],g=p.feature(0).loadGeometry().map(y=>y.map(v=>[v.x/p.extent,v.y/p.extent]));return a=new mapillary.OutlineTag(s.id,new mapillary.PolygonGeometry(g[0]),{text:l,textColor:c,lineColor:c,lineWidth:2,fillColor:c,fillOpacity:.3}),a}},cache:function(){return vi}};var t$=function(){return{equals:function(t){return function(e){return Object.keys(t).every(function(r){return t[r]===e[r]})}},notEquals:function(t){return function(e){return Object.keys(t).some(function(r){return t[r]!==e[r]})}},absence:function(t){return function(e){return Object.keys(e).indexOf(t)===-1}},presence:function(t){return function(e){return Object.keys(e).indexOf(t)>-1}},greaterThan:function(t){var e=Object.keys(t)[0],r=t[e];return function(i){return i[e]>r}},greaterThanEqual:function(t){var e=Object.keys(t)[0],r=t[e];return function(i){return i[e]>=r}},lessThan:function(t){var e=Object.keys(t)[0],r=t[e];return function(i){return i[e]<r}},lessThanEqual:function(t){var e=Object.keys(t)[0],r=t[e];return function(i){return i[e]<=r}},positiveRegex:function(t){var e=Object.keys(t)[0],r=t[e].join("|"),i=new RegExp(r);return function(n){return i.test(n[e])}},negativeRegex:function(t){var e=Object.keys(t)[0],r=t[e].join("|"),i=new RegExp(r);return function(n){return!i.test(n[e])}}}},r$=function(){return{highway:{rest_area:!0,services:!0},railway:{roundhouse:!0,station:!0,traverser:!0,turntable:!0,wash:!0}}},uv={init:function(){this._ruleChecks=t$(),this._validationRules=[],this._areaKeys=Uo,this._lineKeys=r$()},filterRuleChecks:function(t){var e=this._ruleChecks;return Object.keys(t).reduce(function(r,i){return["geometry","error","warning"].indexOf(i)===-1&&r.push(e[i](t[i])),r},[])},buildTagMap:function(t){var e=function(i){return i.map(function(n){return n.replace(/\$|\^/g,"")})},r=Object.keys(t).reduce(function(i,n){var s,o=/regex/gi.test(n),a=/equals/gi.test(n);if(o||a)Object.keys(t[n]).forEach(function(c){s=a?[t[n][c]]:e(t[n][c]),i.hasOwnProperty(c)&&(s=s.concat(i[c])),i[c]=s});else if(/(greater|less)Than(Equal)?|presence/g.test(n)){var l=/presence/.test(n)?t[n]:Object.keys(t[n])[0];s=[t[n][l]],i.hasOwnProperty(l)&&(s=s.concat(i[l])),i[l]=s}return i},{});return r},inferGeometry:function(t){var e=this._lineKeys,r=this._areaKeys,i=function(o){return Ir(t[o],Object.keys(r[o])).length>0},n=function(o){return Ir(t[o],Object.keys(e[o])).length>0};if(t.hasOwnProperty("area")){if(t.area.indexOf("yes")>-1)return"area";if(t.area.indexOf("no")>-1)return"line"}for(var s in t)if(s in r&&!i(s)||s in e&&n(s))return"area";return"line"},addRule:function(t){var e={checks:this.filterRuleChecks(t),matches:function(r){return this.checks.every(function(i){return i(r.tags)})},inferredGeometry:this.inferGeometry(this.buildTagMap(t),this._areaKeys),geometryMatches:function(r,i){if(r.type==="node"||r.type==="relation")return t.geometry===r.type;if(r.type==="way")return this.inferredGeometry===r.geometry(i)},findIssues:function(r,i,n){if(this.geometryMatches(r,i)&&this.matches(r)){var s=Object.keys(t).indexOf("error")>-1?"error":"warning",o=t[s];n.push(new _t({type:"maprules",severity:s,message:function(){return o},entityIds:[r.id]}))}}};this._validationRules.push(e)},clearRules:function(){this._validationRules=[]},validationRules:function(){return this._validationRules},ruleChecks:function(){return this._ruleChecks}};var fv=dt(Us(),1);var bI="https://nominatim.openstreetmap.org/",no={},T9,dv={init:function(){no={},T9=new fv.default},reset:function(){Object.values(no).forEach(function(t){t.abort()}),no={},T9=new fv.default},countryCode:function(t,e){this.reverse(t,function(r,i){return r?e(r):i.address?e(null,i.address.country_code):e("Unable to geocode",null)})},reverse:function(t,e){var r=T9.search({minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]});if(r.length>0){e&&e(null,r[0].data);return}var i={zoom:13,format:"json",addressdetails:1,lat:t[1],lon:t[0]},n=bI+"reverse?"+xt(i);if(!no[n]){var s=new AbortController;no[n]=s,It(n,{signal:s.signal,headers:{"Accept-Language":se.localeCodes().join(",")}}).then(function(o){if(delete no[n],o&&o.error)throw new Error(o.error);var a=new le(t).padByMeters(200);T9.insert(Object.assign(a.bbox(),{data:o})),e&&e(null,o)}).catch(function(o){delete no[n],o.name!=="AbortError"&&e&&e(o.message)})}},search:function(t,e){var r=encodeURIComponent(t),i=bI+"search/"+r+"?limit=10&format=json";if(!no[i]){var n=new AbortController;no[i]=n,It(i,{signal:n.signal,headers:{"Accept-Language":se.localeCodes().join(",")}}).then(function(s){if(delete no[i],s&&s.error)throw new Error(s.error);e&&e(null,s)}).catch(function(s){delete no[i],s.name!=="AbortError"&&e&&e(s.message)})}}};var AI=dt(C2(),1);var wI=dt(U5(),1);function Q1(t){return typeof t!="string"?"":wI.default.remove(t.replace(/&/g,"and").replace(//ig,"i").replace(/[\s\-=_!"#%'*{},.\/:;?\(\)\[\]@\\$\^*+<>~`\u00a1\u00a7\u00b6\u00b7\u00bf\u037e\u0387\u055a-\u055f\u0589\u05c0\u05c3\u05c6\u05f3\u05f4\u0609\u060a\u060c\u060d\u061b\u061e\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0830-\u083e\u085e\u0964\u0965\u0970\u0af0\u0df4\u0e4f\u0e5a\u0e5b\u0f04-\u0f12\u0f14\u0f85\u0fd0-\u0fd4\u0fd9\u0fda\u104a-\u104f\u10fb\u1360-\u1368\u166d\u166e\u16eb-\u16ed\u1735\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u1805\u1807-\u180a\u1944\u1945\u1a1e\u1a1f\u1aa0-\u1aa6\u1aa8-\u1aad\u1b5a-\u1b60\u1bfc-\u1bff\u1c3b-\u1c3f\u1c7e\u1c7f\u1cc0-\u1cc7\u1cd3\u2000-\u206f\u2cf9-\u2cfc\u2cfe\u2cff\u2d70\u2e00-\u2e7f\u3001-\u3003\u303d\u30fb\ua4fe\ua4ff\ua60d-\ua60f\ua673\ua67e\ua6f2-\ua6f7\ua874-\ua877\ua8ce\ua8cf\ua8f8-\ua8fa\ua92e\ua92f\ua95f\ua9c1-\ua9cd\ua9de\ua9df\uaa5c-\uaa5f\uaade\uaadf\uaaf0\uaaf1\uabeb\ufe10-\ufe16\ufe19\ufe30\ufe45\ufe46\ufe49-\ufe4c\ufe50-\ufe52\ufe54-\ufe57\ufe5f-\ufe61\ufe68\ufe6a\ufe6b\ufeff\uff01-\uff03\uff05-\uff07\uff0a\uff0c\uff0e\uff0f\uff1a\uff1b\uff1f\uff20\uff3c\uff61\uff64\uff65]+/g,"").toLowerCase())}var EI={matchGroups:{adult_gaming_centre:["amenity/casino","amenity/gambling","leisure/adult_gaming_centre"],bar:["amenity/bar","amenity/pub","amenity/restaurant"],beauty:["shop/beauty","shop/hairdresser_supply"],bed:["shop/bed","shop/furniture"],beverages:["shop/alcohol","shop/beer","shop/beverages","shop/kiosk","shop/wine"],camping:["tourism/camp_site","tourism/caravan_site"],car_parts:["shop/car_parts","shop/car_repair","shop/tires","shop/tyres"],clinic:["amenity/clinic","amenity/doctors","healthcare/clinic","healthcare/laboratory","healthcare/physiotherapist","healthcare/sample_collection","healthcare/dialysis"],convenience:["shop/beauty","shop/chemist","shop/convenience","shop/cosmetics","shop/grocery","shop/kiosk","shop/newsagent","shop/perfumery"],coworking:["amenity/coworking_space","office/coworking","office/coworking_space"],dentist:["amenity/dentist","amenity/doctors","healthcare/dentist"],electronics:["office/telecommunication","shop/computer","shop/electronics","shop/hifi","shop/kiosk","shop/mobile","shop/mobile_phone","shop/telecommunication"],fabric:["shop/fabric","shop/haberdashery","shop/sewing"],fashion:["shop/accessories","shop/bag","shop/boutique","shop/clothes","shop/department_store","shop/fashion","shop/fashion_accessories","shop/sports","shop/shoes"],financial:["amenity/bank","office/accountant","office/financial","office/financial_advisor","office/tax_advisor","shop/tax"],fitness:["leisure/fitness_centre","leisure/fitness_center","leisure/sports_centre","leisure/sports_center"],food:["amenity/cafe","amenity/fast_food","amenity/ice_cream","amenity/restaurant","shop/bakery","shop/candy","shop/chocolate","shop/coffee","shop/confectionary","shop/confectionery","shop/food","shop/kiosk","shop/ice_cream","shop/pastry","shop/tea"],fuel:["amenity/fuel","shop/gas","shop/convenience;gas","shop/gas;convenience"],gift:["shop/gift","shop/card","shop/cards","shop/kiosk","shop/stationery"],hardware:["shop/bathroom_furnishing","shop/carpet","shop/diy","shop/doityourself","shop/doors","shop/electrical","shop/flooring","shop/hardware","shop/hardware_store","shop/power_tools","shop/tool_hire","shop/tools","shop/trade"],health_food:["shop/health","shop/health_food","shop/herbalist","shop/nutrition_supplements"],hobby:["shop/electronics","shop/hobby","shop/books","shop/games","shop/collector","shop/toys","shop/model","shop/video_games","shop/anime"],hospital:["amenity/doctors","amenity/hospital","healthcare/hospital"],houseware:["shop/houseware","shop/interior_decoration"],lifeboat_station:["amenity/lifeboat_station","emergency/lifeboat_station","emergency/marine_rescue"],lodging:["tourism/hotel","tourism/motel"],money_transfer:["amenity/money_transfer","shop/money_transfer"],office_supplies:["shop/office_supplies","shop/stationary","shop/stationery"],outdoor:["shop/clothes","shop/outdoor","shop/sports"],parcel_locker:["amenity/parcel_locker","amenity/vending_machine"],pharmacy:["amenity/doctors","amenity/pharmacy","healthcare/pharmacy"],playground:["amenity/theme_park","leisure/amusement_arcade","leisure/playground"],rental:["amenity/bicycle_rental","amenity/boat_rental","amenity/car_rental","amenity/truck_rental","amenity/vehicle_rental","shop/kiosk","shop/plant_hire","shop/rental","shop/tool_hire"],school:["amenity/childcare","amenity/college","amenity/kindergarten","amenity/language_school","amenity/prep_school","amenity/school","amenity/university"],storage:["shop/storage_units","shop/storage_rental"],substation:["power/station","power/substation","power/sub_station"],supermarket:["shop/food","shop/frozen_food","shop/greengrocer","shop/grocery","shop/supermarket","shop/wholesale"],thrift:["shop/charity","shop/clothes","shop/second_hand"],variety_store:["shop/variety_store","shop/discount","shop/convenience"],vending:["amenity/vending_machine","shop/kiosk","shop/vending_machine"],weight_loss:["amenity/clinic","amenity/doctors","amenity/weight_clinic","healthcare/counselling","leisure/fitness_centre","office/therapist","shop/beauty","shop/diet","shop/food","shop/health_food","shop/herbalist","shop/nutrition","shop/nutrition_supplements","shop/weight_loss"],wholesale:["shop/wholesale","shop/supermarket","shop/department_store"]}};var SI={genericWords:["^(barn|bazaa?r|bench|bou?tique|building|casa|church)$","^(baseball|basketball|football|soccer|softball|tennis(halle)?)\\s?(field|court)?$","^(club|green|out|ware)\\s?house$","^(driveway|el \xE1rbol|fountain|generic|golf|government|graveyard)$","^(fixme|n\\s?\\/?\\s?a|name|no\\s?name|none|null|temporary|test|unknown)$","^(hofladen|librairie|magazine?|maison)$","^(mobile home|skate)?\\s?park$","^(obuwie|pond|pool|sale|shops?|sklep|stores?)$","^\\?+$","^private$","^tattoo( studio)?$","^windmill$","^\u0446\u0435\u0440\u043A\u043E\u0432\u043D\u0430\u044F( \u043B\u0430\u0432\u043A\u0430)?$"]};var TI={trees:{brands:{emoji:"\u{1F354}",mainTag:"brand:wikidata",sourceTags:["brand","name"],nameTags:{primary:"^(name|name:\\w+)$",alternate:"^(brand|brand:\\w+|operator|operator:\\w+|\\w+_name|\\w+_name:\\w+)$"}},flags:{emoji:"\u{1F6A9}",mainTag:"flag:wikidata",nameTags:{primary:"^(flag:name|flag:name:\\w+)$",alternate:"^(country|country:\\w+|flag|flag:\\w+|subject|subject:\\w+)$"}},operators:{emoji:"\u{1F4BC}",mainTag:"operator:wikidata",sourceTags:["operator"],nameTags:{primary:"^(name|name:\\w+|operator|operator:\\w+)$",alternate:"^(brand|brand:\\w+|\\w+_name|\\w+_name:\\w+)$"}},transit:{emoji:"\u{1F687}",mainTag:"network:wikidata",sourceTags:["network"],nameTags:{primary:"^network$",alternate:"^(operator|operator:\\w+|network:\\w+|\\w+_name|\\w+_name:\\w+)$"}}}};var hv=EI.matchGroups,o$=TI.trees,E5=class{constructor(){this.matchIndex=void 0,this.genericWords=new Map,(SI.genericWords||[]).forEach(e=>this.genericWords.set(e,new RegExp(e,"i"))),this.itemLocation=void 0,this.locationSets=void 0,this.locationIndex=void 0,this.warnings=[]}buildMatchIndex(e){let r=this;if(r.matchIndex)return;r.matchIndex=new Map;let i=new Map;Object.keys(e).forEach(o=>{let a=e[o],l=o.split("/",3),c=l[0],u=l[1],d=l[2],h=`${u}/${d}`,p=o$[c],m=r.matchIndex.get(h);m||(m={primary:new Map,alternate:new Map,excludeGeneric:new Map,excludeNamed:new Map},r.matchIndex.set(h,m));let y=(a.properties||{}).exclude||{};(y.generic||[]).forEach(k=>m.excludeGeneric.set(k,new RegExp(k,"i"))),(y.named||[]).forEach(k=>m.excludeNamed.set(k,new RegExp(k,"i")));let v=[...m.excludeGeneric.values(),...m.excludeNamed.values()],x=a.items;if(!Array.isArray(x)||!x.length)return;let _=new RegExp(p.nameTags.primary,"i"),b=new RegExp(p.nameTags.alternate,"i"),w=/:(colou?r|type|forward|backward|left|right|etymology|pronunciation|wikipedia)$/i,E=s(c,u,d),A=new Set([`${u}/yes`,"building/yes"]),T=new Set;Object.values(hv).forEach(k=>{k.some(I=>I===h)&&k.forEach(I=>{if(I===h)return;T.add(I);let P=I.split("/",2)[0];A.add(`${P}/yes`)})}),x.forEach(k=>{if(!k.id)return;Array.isArray(k.matchTags)&&k.matchTags.length&&(k.matchTags=k.matchTags.filter(P=>!T.has(P)&&!A.has(P)),k.matchTags.length||delete k.matchTags);let C=[`${h}`].concat(k.matchTags||[]);E||(C=C.concat(Array.from(A))),Object.keys(k.tags).forEach(P=>{if(w.test(P))return;let N=k.tags[P];!N||v.some(M=>M.test(N))||(_.test(P)?C.forEach(M=>n("primary",c,M,Q1(N),k.id)):b.test(P)&&C.forEach(M=>n("alternate",c,M,Q1(N),k.id)))});let I=new Set;(k.matchNames||[]).forEach(P=>{let N=Q1(P);C.forEach(M=>{let D=r.matchIndex.get(M),F=D&&D.primary.get(N),L=D&&D.alternate.get(N),B=F&&F.has(k.id),O=L&&L.has(k.id);!B&&!O&&(n("alternate",c,M,N,k.id),I.add(P))})}),I.size?k.matchNames=Array.from(I):delete k.matchNames})});function n(o,a,l,c,u){if(!c){r.warnings.push(`Warning: skipping empty ${o} name for item ${a}/${l}: ${u}`);return}let d=r.matchIndex.get(l);d||(d={primary:new Map,alternate:new Map,excludeGeneric:new Map,excludeNamed:new Map},r.matchIndex.set(l,d));let h=d[o].get(c);if(h||(h=new Set,d[o].set(c,h)),h.add(u),!/yes$/.test(l)){let p=`${l}/${c}`,m=i.get(p);if(m&&m!==a){let g=Array.from(h);r.warnings.push(`Duplicate cache key "${p}" in trees "${a}" and "${m}", check items: ${g}`);return}i.set(p,a)}}function s(o,a,l){return o==="flags"||o==="transit"||a==="landuse"||l==="atm"||l==="bicycle_parking"||l==="car_sharing"||l==="caravan_site"||l==="charging_station"||l==="dog_park"||l==="parking"||l==="phone"||l==="playground"||l==="post_box"||l==="public_bookcase"||l==="recycling"||l==="vending_machine"}}buildLocationIndex(e,r){let i=this;if(i.locationIndex)return;i.itemLocation=new Map,i.locationSets=new Map,Object.keys(e).forEach(s=>{let o=e[s].items;!Array.isArray(o)||!o.length||o.forEach(a=>{if(i.itemLocation.has(a.id))return;let l;try{l=r.resolveLocationSet(a.locationSet)}catch(u){console.warn(`buildLocationIndex: ${u.message}`)}if(!l||!l.id||(i.itemLocation.set(a.id,l.id),i.locationSets.has(l.id)))return;let c=n(l.feature);if(c.id=l.id,c.properties.id=l.id,!c.geometry.coordinates.length||!c.properties.area){console.warn(`buildLocationIndex: locationSet ${l.id} for ${a.id} resolves to an empty feature:`),console.warn(JSON.stringify(c));return}i.locationSets.set(l.id,c)})}),i.locationIndex=(0,AI.default)({type:"FeatureCollection",features:[...i.locationSets.values()]});function n(s){return JSON.parse(JSON.stringify(s))}}match(e,r,i,n){let s=this;if(!s.matchIndex)throw new Error("match:  matchIndex not built.");let o;Array.isArray(n)&&s.locationIndex&&(o=s.locationIndex([n[0],n[1],n[0],n[1]],!0));let a=Q1(i),l=new Set,c=[];if(u("primary"),u("alternate"),c.length)return c;return u("exclude"),c.length?c:null;function u(h){let p=`${e}/${r}`,m=d(h,p);if(!m){for(let g in hv){let y=hv[g];if(y.some(x=>x===p))for(let x=0;x<y.length;x++){let _=y[x];if(_!==p&&(m=d(h,_),m))return}}if(h==="exclude"){let g=[...s.genericWords.values()].find(y=>y.test(i));if(g){c.push({match:"excludeGeneric",pattern:String(g)});return}}}}function d(h,p){let m=s.matchIndex.get(p);if(!m)return;if(h==="exclude"){let w=[...m.excludeNamed.values()].find(E=>E.test(i));if(w){c.push({match:"excludeNamed",pattern:String(w),kv:p});return}if(w=[...m.excludeGeneric.values()].find(E=>E.test(i)),w){c.push({match:"excludeGeneric",pattern:String(w),kv:p});return}return}let g=m[h].get(a);if(!g||!g.size)return;let y=Array.from(g).map(w=>{let E=1/0;if(s.itemLocation&&s.locationSets){let A=s.locationSets.get(s.itemLocation.get(w));E=A&&A.properties.area||1/0}return{match:h,itemID:w,area:E,kv:p,nsimple:a}}),v=b;if(o&&(y=y.filter(x),v=_),!y.length)return;return y.sort(v).forEach(w=>{l.has(w.itemID)||(l.add(w.itemID),c.push(w))}),!0;function x(w){return s.itemLocation?o.find(E=>E.id===s.itemLocation.get(w.itemID)):!0}function _(w,E){return w.area-E.area}function b(w,E){return E.area-w.area}}}getWarnings(){return this.warnings}};var pv="loading",gr={},a$={"building/commercial":!0,"building/government":!0,"building/hotel":!0,"building/retail":!0,"building/office":!0,"building/supermarket":!0,"building/yes":!0},l$=/:(colou?r|type|forward|backward|left|right|etymology|pronunciation|wikipedia)$/i,c$=/(coop|express|wireless|factory|outlet)/i;function u$(){let t={nsi_data:"https://cdn.jsdelivr.net/npm/name-suggestion-index@6.0/dist/nsi.min.json",nsi_dissolved:"https://cdn.jsdelivr.net/npm/name-suggestion-index@6.0/dist/dissolved.min.json",nsi_features:"https://cdn.jsdelivr.net/npm/name-suggestion-index@6.0/dist/featureCollection.min.json",nsi_generics:"https://cdn.jsdelivr.net/npm/name-suggestion-index@6.0/dist/genericWords.min.json",nsi_presets:"https://cdn.jsdelivr.net/npm/name-suggestion-index@6.0/dist/presets/nsi-id-presets.min.json",nsi_replacements:"https://cdn.jsdelivr.net/npm/name-suggestion-index@6.0/dist/replacements.min.json",nsi_trees:"https://cdn.jsdelivr.net/npm/name-suggestion-index@6.0/dist/trees.min.json"},e=Qe.fileMap();for(let r in t)e[r]||(e[r]=t[r])}function f$(){return Promise.all([Qe.get("nsi_presets"),Qe.get("nsi_features")]).then(t=>{Object.values(t[0].presets).forEach(e=>e.suggestion=!0),xe.merge({presets:t[0].presets,featureCollection:t[1]})})}function d$(){return Promise.all([Qe.get("nsi_data"),Qe.get("nsi_dissolved"),Qe.get("nsi_replacements"),Qe.get("nsi_trees")]).then(t=>{gr={data:t[0].nsi,dissolved:t[1].dissolved,replacements:t[2].replacements,trees:t[3].trees,kvt:new Map,qids:new Map,ids:new Map};let e=gr.matcher=new E5;e.buildMatchIndex(gr.data),e.itemLocation=new Map,e.locationSets=new Map,Object.keys(gr.data).forEach(r=>{let i=gr.data[r].items;!Array.isArray(i)||!i.length||i.forEach(n=>{if(e.itemLocation.has(n.id))return;let s=wt.locationSetID(n.locationSet);if(e.itemLocation.set(n.id,s),e.locationSets.has(s))return;let o={id:s,properties:{id:s,area:1}};e.locationSets.set(s,o)})}),e.locationIndex=r=>{let i=wt.locationSetsAt([r[0],r[1]]),n=[];for(let[s,o]of Object.entries(i)){let a=e.locationSets.get(s);a&&(a.properties.area=o,n.push(a))}return n},Object.keys(gr.data).forEach(r=>{let i=gr.data[r],n=r.split("/",3),s=n[0],o=n[1],a=n[2],l=gr.kvt.get(o);l||(l=new Map,gr.kvt.set(o,l)),l.set(a,s);let u=gr.trees[s].mainTag;(i.items||[]).forEach(h=>{h.tkv=r,h.mainTag=u,gr.ids.set(h.id,h);let p=h.tags[u],m=h.tags[u.replace("wikidata","wikipedia")];p&&gr.qids.set(p,p),m&&p&&gr.qids.set(m,p)})})})}function kI(t){let e=new Set,r=new Set;Object.keys(t).forEach(n=>{let s=t[n];if(!s)return;n==="route_master"&&(n="route");let o=gr.kvt.get(n);o&&(o.get(s)?e.add(`${n}/${s}`):s==="yes"&&r.add(`${n}/${s}`))});let i=xe.matchTags(t,"area");return a$[i.id]&&r.add("building/yes"),{primary:e,alternate:r}}function h$(t){let e,r;return Object.keys(t).forEach(i=>{if(r)return;let n=t[i];if(!n)return;i==="route_master"&&(i="route");let s=gr.kvt.get(i);s&&(n==="yes"?e="unknown":r=s.get(n))}),r||e||null}function CI(t){let e={primary:new Set,alternate:new Set},r=new Set,i=new Set,n=!1,s=!1,o,a=h$(t);if(!a)return e;if(a==="transit"?o={primary:/^network$/i,alternate:/^(operator|operator:\w+|network:\w+|\w+_name|\w+_name:\w+)$/i}:a==="flags"?o={primary:/^(flag:name|flag:name:\w+)$/i,alternate:/^(flag|flag:\w+|subject|subject:\w+)$/i}:a==="brands"?(s=!0,o={primary:/^(name|name:\w+)$/i,alternate:/^(brand|brand:\w+|operator|operator:\w+|\w+_name|\w+_name:\w+)/i}):a==="operators"?(s=!0,o={primary:/^(name|name:\w+|operator|operator:\w+)$/i,alternate:/^(brand|brand:\w+|\w+_name|\w+_name:\w+)/i}):(s=!0,o={primary:/^(name|name:\w+)$/i,alternate:/^(brand|brand:\w+|network|network:\w+|operator|operator:\w+|\w+_name|\w+_name:\w+)/i}),t.name&&s){let c=t.name.split(/[\s\-\/,.]/);for(let u=c.length;u>0;u--){let d=c.slice(0,u).join(" ");r.add(d)}}if(Object.keys(t).forEach(c=>{let u=t[c];u&&(l(c,"primary")?/;/.test(u)?n=!0:(r.add(u),i.delete(u)):!r.has(u)&&l(c,"alternate")&&(/;/.test(u)?n=!0:i.add(u)))}),t.man_made==="flagpole"&&!r.size&&!i.size&&t.country){let c=t.country;/;/.test(c)?n=!0:i.add(c)}if(n)return e;return{primary:r,alternate:i};function l(c,u){return c==="old_name"?!1:o[u].test(c)&&!l$.test(c)}}function II(t,e){let r=[];return["primary","alternate"].forEach(i=>{Array.from(e[i]).sort((s,o)=>o.length-s.length).forEach(s=>{["primary","alternate"].forEach(o=>{t[o].forEach(a=>{let l=a.split("/",2),c=l[0],u=l[1];r.push({k:c,v:u,n:s})})})})}),r}function p$(t,e){let r=Object.assign({},t),i=!1;Object.keys(r).forEach(c=>{let u=c.match(/^(\w+:)?wikidata$/);if(u){let d=u[1]||"",h=r[c],p=gr.replacements[h];if(p&&p.wikidata!==void 0&&(i=!0,p.wikidata?r[c]=p.wikidata:delete r[c]),p&&p.wikipedia!==void 0){i=!0;let m=`${d}wikipedia`;p.wikipedia?r[m]=p.wikipedia:delete r[m]}}});let n=t.type==="route_master",s=kI(t);if(!s.primary.size&&!s.alternate.size)return i?{newTags:r,matched:null}:null;let o=CI(t),a=gr.qids.get(t.wikidata)||gr.qids.get(t.wikipedia);if(a&&o.primary.add(a),!o.primary.size&&!o.alternate.size)return i?{newTags:r,matched:null}:null;let l=II(s,o);for(let c=0;c<l.length;c++){let u=l[c],d=gr.matcher.match(u.k,u.v,u.n,e);if(!d||!d.length)continue;if(d[0].match!=="primary"&&d[0].match!=="alternate")break;let h,p;for(let k=0;k<d.length;k++){if(h=d[k].itemID,gr.dissolved[h]||(p=gr.ids.get(h),!p))continue;let I=p.mainTag,P=p.tags[I],N=r[`not:${I}`];if(!P||P===N||r.office&&!p.tags.office){p=null;continue}else break}if(!p)continue;p=JSON.parse(JSON.stringify(p));let m=p.tkv,g=m.split("/",3),y=g[1],v=g[2],_=gr.data[m].properties||{},b=p.preserveTags||_.preserveTags||[];["building","emergency","internet_access","takeaway"].forEach(k=>{y!==k&&b.push(`^${k}$`)});let w=b.map(k=>new RegExp(k,"i")),E={};Object.keys(r).forEach(k=>{w.some(C=>C.test(k))&&(E[k]=r[k])}),gr.kvt.forEach((k,C)=>{r[C]==="yes"&&delete r[C]}),a&&(delete r.wikipedia,delete r.wikidata),Object.assign(r,p.tags,E),n&&(r.route_master=r.route,delete r.route);let A=t.name,T=r.name;if(T&&A&&T!==A&&!r.branch){let k=CI(r);if(!new Set([...k.primary,...k.alternate]).has(A)){let P=A.split(/[\s\-\/,.]/);for(let N=P.length;N>0;N--){let M=P.slice(0,N).join(" "),D=P.slice(N).join(" "),F=gr.matcher.match(y,v,M,e);if(!(!F||!F.length)&&F.some(L=>L.itemID===h)){if(D)if(c$.test(D))r.name=A;else{let L=gr.matcher.match(y,v,D,e);if(L&&L.length){if(L[0].match==="primary"||L[0].match==="alternate")return null}else r.branch=D}break}}}}return{newTags:r,matched:p}}return i?{newTags:r,matched:null}:null}function m$(t){let e=t.name;if(!e)return!1;let r={primary:new Set([e]),alternate:new Set},i=kI(t);if(!i.primary.size&&!i.alternate.size)return!1;let n=II(i,r);for(let s=0;s<n.length;s++){let o=n[s],a=gr.matcher.match(o.k,o.v,o.n);if(a&&a.length&&a[0].match==="excludeGeneric")return!0}return!1}var mv={init:()=>{u$(),xe.ensureLoaded().then(()=>f$()).then(()=>d$()).then(()=>pv="ok").catch(t=>{console.error(t),pv="failed"})},reset:()=>{},status:()=>pv,isGenericName:t=>m$(t),upgradeTags:(t,e)=>p$(t,e),cache:()=>gr};var PI=dt(Us(),1);var RI="https://kartaview.org",MI=1e3,g$=14,y$=new Pr().skipNullIsland(!0),NI=fe("loadedImages"),A9=Ic().extent([[0,0],[320,240]]).translateExtent([[0,0],[320,240]]).scaleExtent([1,15]),fr,Ra,C9;function v$(t){if(t<15)return 2;if(t===15)return 5;if(t===16)return 10;if(t===17)return 20;if(t===18)return 40;if(t>18)return 80}function x$(t){let e=Math.floor(xn(t.scale())),r=y$.zoomRange(g$).getTiles(t).tiles;for(let[i,n]of fr.inflight.entries())r.find(o=>i.indexOf(o.id)===0)||n.controller.abort();for(let i of r)DI(e,i)}function DI(t,e){let r=e.wgs84Extent.bbox(),i=v$(t),n=fr.nextPage.get(e.id)??1;if(n>i)return;let s=`${e.id},${n}`;if(fr.loaded.has(s)||fr.inflight.has(s))return;let o=xt({ipp:MI,page:n,bbTopLeft:[r.maxY,r.minX].join(","),bbBottomRight:[r.minY,r.maxX].join(",")},!0),a=new AbortController,l={method:"POST",signal:a.signal,body:o,headers:{"Content-Type":"application/x-www-form-urlencoded"}},c=`${RI}/1.0/list/nearby-photos/`,u=It(c,l).then(d=>{if(fr.loaded.add(s),!d||!d.currentPageItems||!d.currentPageItems.length)throw new Error("No Data");let h=d.currentPageItems.map(p=>{if(fr.images.has(p.id))return null;let m=[+p.lng,+p.lat],g={id:p.id,loc:m,ca:+p.heading,captured_at:p.shot_date||p.date_added,captured_by:p.username,imagePath:p.lth_name,sequenceID:p.sequence_id,sequenceIndex:+p.sequence_index};fr.images.set(g.id,g);let y=fr.sequences.get(g.sequenceID);return y||(y={rotation:0,images:[],v:0},fr.sequences.set(g.sequenceID,y)),y.images[g.sequenceIndex]=g,y.v++,{minX:m[0],minY:m[1],maxX:m[0],maxY:m[1],data:g}}).filter(Boolean);fr.rtree.load(h),d.currentPageItems.length===MI?(fr.nextPage.set(e.id,n+1),DI(t,e)):fr.nextPage.set(e.id,1/0),NI.call("loadedImages")}).catch(d=>{d.name!=="AbortError"&&d instanceof Error&&console.error(d)}).finally(()=>{fr.inflight.delete(s)});fr.inflight.set(s,{promise:u,controller:a})}var gv={init:function(){fr||this.reset(),this.event=ge(this,NI,"on")},reset:function(){if(fr)for(let t of fr.inflight.values())t.controller.abort();fr={inflight:new Map,loaded:new Set,nextPage:new Map,images:new Map,sequences:new Map,rtree:new PI.default},Ra=null},images:function(t){let e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox();return fr.rtree.search(n).map(s=>s.data)},sequences:function(t){let e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox(),s=new Set;for(let a of fr.rtree.search(n))a.data.sequenceID&&s.add(a.data.sequenceID);let o=[];for(let a of s){let l=fr.sequences.get(a),c=l?.images??[];c.length&&o.push({type:"LineString",coordinates:c.map(u=>u.loc).filter(Boolean),properties:{id:a,v:l.v,captured_at:c[0]?.captured_at,captured_by:c[0]?.captured_by}})}return o},cachedImage:function(t){return fr.images.get(t)},loadImages:function(t){x$(t)},loadViewerAsync:function(t){if(C9)return C9;let r=t.container().select(".photoviewer").selectAll(".osc-wrapper").data([0]).enter().append("div").attr("class","photo-wrapper osc-wrapper").classed("hide",!0).call(A9.on("zoom",n)).on("dblclick.zoom",null);r.append("div").attr("class","photo-attribution fillD");let i=r.append("div").attr("class","photo-controls-wrap").append("div").attr("class","photo-controls");i.append("button").on("click.back",()=>o(-1)).html("\u25C4"),i.append("button").on("click.rotate-ccw",()=>s(-90)).html("\u293F"),i.append("button").on("click.rotate-cw",()=>s(90)).html("\u293E"),i.append("button").on("click.forward",()=>o(1)).html("\u25BA"),r.append("div").attr("class","osc-image-wrap"),t.ui().photoviewer.on("resize.kartaview",a=>{A9=Ic().extent([[0,0],a]).translateExtent([[0,0],a]).scaleExtent([1,15]).on("zoom",n)});function n(a){let l=a.transform;t.container().select(".photoviewer .osc-image-wrap").call(As,l.x,l.y,l.k)}function s(a){if(!Ra)return;let l=Ra.sequenceID,c=fr.sequences.get(l);if(!c)return;let u=c.rotation||0;u+=a,u>180&&(u-=360),u<-180&&(u+=360),c.rotation=u;let d=t.container().select(".photoviewer .osc-wrapper");d.transition().duration(100).call(A9.transform,cs),d.selectAll(".osc-image").transition().duration(100).style("transform",`rotate(${u}deg)`)}function o(a){if(!Ra)return;let l=Ra.sequenceID,c=fr.sequences.get(l);if(!c)return;let u=Ra.sequenceIndex+a,d=c.images[u];d&&(t.map().centerEase(d.loc),t.photos().selectPhoto("kartaview",d.id))}return C9=Promise.resolve(),C9},showViewer:function(t){let e=t.container().select(".photoviewer").classed("hide",!1);return e.selectAll(".photo-wrapper.osc-wrapper.hide").size()&&(e.selectAll(".photo-wrapper:not(.osc-wrapper)").classed("hide",!0),e.selectAll(".photo-wrapper.osc-wrapper").classed("hide",!1)),this},hideViewer:function(t){Ra=null,t.photos().selectPhoto(null);let e=t.container().select(".photoviewer");return e.empty()||e.datum(null),e.classed("hide",!0).selectAll(".photo-wrapper").classed("hide",!0),t.container().selectAll(".viewfield-group, .sequence, .icon-sign").classed("currentView",!1),this.setStyles(t,null,!0)},selectImage:function(t,e){let r=this.cachedImage(e);Ra=r;let i=t.container().select(".photoviewer");if(i.empty()||i.datum(r),this.setStyles(t,null,!0),t.container().selectAll(".icon-sign").classed("currentView",!1),!r)return this;let n=t.container().select(".photoviewer .osc-wrapper"),s=n.selectAll(".osc-image-wrap"),o=n.selectAll(".photo-attribution").html("");if(n.transition().duration(100).call(A9.transform,cs),s.selectAll(".osc-image").remove(),r){let c=fr.sequences.get(r.sequenceID)?.rotation??0;s.append("img").attr("class","osc-image").attr("src",`${RI}/${r.imagePath}`).style("transform",`rotate(${c}deg)`),r.captured_by&&(o.append("a").attr("class","captured_by").attr("target","_blank").attr("href","https://kartaview.org/user/"+encodeURIComponent(r.captured_by)).text("@"+r.captured_by),o.append("span").text("|")),r.captured_at&&(o.append("span").attr("class","captured_at").text(a(r.captured_at)),o.append("span").text("|")),o.append("a").attr("class","image-link").attr("target","_blank").attr("href",`https://kartaview.org/details/${r.sequenceID}/${r.sequenceIndex}`).text("kartaview.org")}return this;function a(l){if(!l)return null;let c={day:"numeric",month:"short",year:"numeric"},u=new Date(l);return isNaN(u.getTime())?null:u.toLocaleDateString(se.localeCode(),c)}},getSelectedImage:function(){return Ra},setStyles:function(t,e,r){r&&(t.container().selectAll(".viewfield-group").classed("highlighted",!1).classed("hovered",!1).classed("currentView",!1),t.container().selectAll(".sequence").classed("highlighted",!1).classed("currentView",!1));let i=e?.id,n=e?.sequenceID,s=n&&fr.sequences.get(n),o=s&&s.images.map(function(g){return g.id})||[],a=t.container().select(".photoviewer"),l=a.empty()?void 0:a.datum(),c=l?.id,u=l?.sequenceID,d=u&&fr.sequences.get(u),h=d&&d.images.map(function(g){return g.id})||[],p=jt(o,h);t.container().selectAll(".layer-kartaview .viewfield-group").classed("highlighted",function(g){return p.indexOf(g.id)!==-1}).classed("hovered",function(g){return g.id===i}).classed("currentView",function(g){return g.id===c}),t.container().selectAll(".layer-kartaview .sequence").classed("highlighted",function(g){return g.properties.id===n}).classed("currentView",function(g){return g.properties.id===u}),t.container().selectAll(".layer-kartaview .viewfield-group .viewfield").attr("d",m);function m(){let g=this.parentNode.__data__;return g.isPano&&g.id!==c?"M 8,13 m -10,0 a 10,10 0 1,0 20,0 a 10,10 0 1,0 -20,0":"M 6,9 C 8,8.4 8,8.4 10,9 L 16,-2 C 12,-5 4,-5 0,-2 z"}return this},cache:function(){return fr}};var k9=dt(fM(),1);function dM(t){var e={};e.authenticated=function(){return!!r("oauth2_access_token")},e.logout=function(){return r("oauth2_access_token",""),r("oauth_token",""),r("oauth_token_secret",""),r("oauth_request_token_secret",""),e},e.authenticate=function(n){if(e.authenticated()){n(null,e);return}e.logout();var s=t.url+"/oauth2/authorize?"+Av({client_id:t.client_id,redirect_uri:t.redirect_uri,response_type:"code",scope:t.scope});if(!t.singlepage){var o=600,a=550,l=[["width",o],["height",a],["left",window.screen.width/2-o/2],["top",window.screen.height/2-a/2]].map(function(p){return p.join("=")}).join(","),c=window.open("about:blank","oauth_window",l);if(e.popupWindow=c,c.location=s,!c){var u=new Error("Popup was blocked");throw u.status="popup-blocked",u}}window.authComplete=function(p){var m=Ej(p.split("?")[1]);d(m.code),delete window.authComplete};function d(p){var m=t.url+"/oauth2/token?"+Av({client_id:t.client_id,grant_type:"authorization_code",code:p,redirect_uri:t.redirect_uri,client_secret:t.client_secret});e.rawxhr("POST",m,null,null,null,h),t.loading()}function h(p,m){if(t.done(),p){n(p);return}var g=JSON.parse(m.response);r("oauth2_access_token",g.access_token),n(null,e)}},e.bringPopupWindowToFront=function(){var n=!1;try{e.popupWindow&&!e.popupWindow.closed&&(e.popupWindow.focus(),n=!0)}catch{}return n},e.bootstrapToken=function(n,s){function o(l){var c=t.url+"/oauth2/token?"+Av({client_id:t.client_id,grant_type:"authorization_code",code:l,redirect_uri:t.redirect_uri,client_secret:t.client_secret});e.rawxhr("POST",c,null,null,null,a),t.loading()}function a(l,c){if(t.done(),l){s(l);return}var u=JSON.parse(c.response);r("oauth2_access_token",u.access_token),s(null,e)}o(n)},e.xhr=function(n,s){if(e.authenticated())return o();if(t.auto){e.authenticate(o);return}else{s("not authenticated",null);return}function o(){var l=n.prefix!==!1?t.url+n.path:n.path;return e.rawxhr(n.method,l,r("oauth2_access_token"),n.content,n.headers,a)}function a(l,c){l?s(l):c.responseXML?s(l,c.responseXML):s(l,c.response)}},e.rawxhr=function(n,s,o,a,l,c){l=l||{"Content-Type":"application/x-www-form-urlencoded"},o&&(l.Authorization="Bearer "+o);var u=new XMLHttpRequest;u.onreadystatechange=function(){u.readyState===4&&u.status!==0&&(/^20\d$/.test(u.status)?c(null,u):c(u,null))},u.onerror=function(h){c(h,null)},u.open(n,s,!0);for(var d in l)u.setRequestHeader(d,l[d]);return u.send(a),u},e.preauth=function(n){return n&&n.access_token&&r("oauth2_access_token",n.access_token),e},e.options=function(n){return arguments.length?(t=n,t.url=t.url||"https://www.openstreetmap.org",t.auto=t.auto||!1,t.singlepage=t.singlepage||!1,t.loading=t.loading||function(){},t.done=t.done||function(){},e.preauth(t)):t};var r;if(k9.default.enabled)r=function(n,s){if(arguments.length===1)return k9.default.get(t.url+n);if(arguments.length===2)return k9.default.set(t.url+n,s)};else{var i={};r=function(n,s){if(arguments.length===1)return i[t.url+n];if(arguments.length===2)return i[t.url+n]=s}}return e.options(t),e}function Av(t){return Object.keys(t).sort().map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}function Ej(t){for(var e=0;e<t.length&&(t[e]==="?"||t[e]==="#");)e++;return t=t.slice(e),t.split("&").reduce(function(r,i){var n=i.split("=");return n.length===2&&(r[n[0]]=decodeURIComponent(n[1])),r},{})}var g4=dt(Us(),1);var Cv=new Pr,ks=fe("apiStatusChange","authLoading","authDone","change","loading","loaded","loadedNotes"),rs="https://www.openstreetmap.org",hM=Fn(window.location.hash),_M="omit";hM.hasOwnProperty("osm_api_url")&&(rs=hM.osm_api_url,_M="include");var pM=window.location.origin,P9;pM==="https://mapwith.ai"?P9="https://mapwith.ai/rapid/":pM==="https://rapideditor.org"?P9="https://rapideditor.org/rapid/":P9=window.location.origin+window.location.pathname;var hn=dM({url:rs,client_id:"O3g0mOUuA2WY5Fs826j5tP260qR3DDX7cIIE2R2WWSc",client_secret:"b4aeHD1cNeapPPQTrvpPoExqQRjybit6JBlNnxh62uE",scope:"read_prefs write_prefs write_api read_gpx write_notes",redirect_uri:P9+"land.html",loading:Tj,done:Aj}),mM=[/.*\.google(apis)?\..*\/(vt|kh)[\?\/].*([xyz]=.*){3}.*/],cr={toLoad:{},loaded:{},inflight:{},seen:{},rtree:new g4.default},Ht={toLoad:{},loaded:{},inflight:{},inflightPost:{},note:{},closed:{},rtree:new g4.default},ri={toLoad:{},user:{}},k5,es={},Dl=new Set,ts=1,kv=16,Sj=12,m4,ec,tc,I9,gM=2e3;function Tj(){ks.call("authLoading")}function Aj(){ks.call("authDone")}function I5(t){t&&t.abort()}function M9(t){return Object.keys(t.inflight).length}function yM(t,e){Object.keys(t.inflight).forEach(function(r){t.toLoad[r]||e.find(function(i){return r===i.id})||(I5(t.inflight[r]),delete t.inflight[r])})}function vM(t){var e=t.lon&&t.lon.value,r=t.lat&&t.lat.value;return[parseFloat(e),parseFloat(r)]}function Cj(t){for(var e=t.getElementsByTagName("nd"),r=new Array(e.length),i=0,n=e.length;i<n;i++)r[i]="n"+e[i].attributes.ref.value;return r}function kj(t){for(var e=t.nodes,r=new Array(e.length),i=0,n=e.length;i<n;i++)r[i]="n"+e[i];return r}function R9(t){for(var e=t.getElementsByTagName("tag"),r={},i=0,n=e.length;i<n;i++){var s=e[i].attributes;r[s.k.value]=s.v.value}return r}function Ij(t){for(var e=t.getElementsByTagName("member"),r=new Array(e.length),i=0,n=e.length;i<n;i++){var s=e[i].attributes;r[i]={id:s.type.value[0]+s.ref.value,type:s.type.value,role:s.role.value}}return r}function Mj(t){for(var e=t.members,r=new Array(e.length),i=0,n=e.length;i<n;i++){var s=e[i];r[i]={id:s.type[0]+s.ref,type:s.type,role:s.role}}return r}function Iv(t){return!t.visible||t.visible.value!=="false"}function Pj(t){for(var e=[],r=0;r<t.length;r++){var i=t[r];if(i.nodeName==="comment"){for(var n=i.childNodes,s={},o=0;o<n.length;o++){var a=n[o],l=a.nodeName;if(l!=="#text"&&(s[l]=a.textContent,l==="uid")){var c=a.textContent;c&&!ri.user[c]&&(ri.toLoad[c]=!0)}}s&&e.push(s)}}return e}function Rv(t){return{minX:t.loc[0],minY:t.loc[1],maxX:t.loc[0],maxY:t.loc[1],data:t}}var bM={node:function(e,r){return new je({id:r,visible:typeof e.visible=="boolean"?e.visible:!0,version:e.version&&e.version.toString(),changeset:e.changeset&&e.changeset.toString(),timestamp:e.timestamp,user:e.user,uid:e.uid&&e.uid.toString(),loc:[parseFloat(e.lon),parseFloat(e.lat)],tags:e.tags})},way:function(e,r){return new Lt({id:r,visible:typeof e.visible=="boolean"?e.visible:!0,version:e.version&&e.version.toString(),changeset:e.changeset&&e.changeset.toString(),timestamp:e.timestamp,user:e.user,uid:e.uid&&e.uid.toString(),tags:e.tags,nodes:kj(e)})},relation:function(e,r){return new Cr({id:r,visible:typeof e.visible=="boolean"?e.visible:!0,version:e.version&&e.version.toString(),changeset:e.changeset&&e.changeset.toString(),timestamp:e.timestamp,user:e.user,uid:e.uid&&e.uid.toString(),tags:e.tags,members:Mj(e)})},user:function(e,r){return{id:r,display_name:e.display_name,account_created:e.account_created,image_url:e.img&&e.img.href,changesets_count:e.changesets&&e.changesets.count&&e.changesets.count.toString()||"0",active_blocks:e.blocks&&e.blocks.received&&e.blocks.received.active&&e.blocks.received.active.toString()||"0"}}};function Rj(t,e,r){if(r=Object.assign({skipSeen:!0},r),!t)return e({message:"No JSON",status:-1});let i=t;if(typeof i!="object"&&(i=JSON.parse(t)),!i.elements)return e({message:"No JSON",status:-1});if(i.elements.some(o=>o.type==="error"))return e({message:"Partial JSON",status:-1});let n=i.elements,s=window.requestIdleCallback(()=>{Dl.delete(s);let o={data:[],seenIDs:new Set};for(let a=0;a<n.length;a++){let l=n[a],c=bM[l.type];if(!c)continue;let u=Te.id.fromOSM(l.type,l.id);if(o.seenIDs.add(u),r.skipSeen){if(cr.seen[u])continue;cr.seen[u]=!0}let d=c(l,u);d&&o.data.push(d)}e(null,o)});Dl.add(s)}function Mv(t,e,r){if(r=Object.assign({skipSeen:!0},r),!t)return e({message:"No JSON",status:-1});let i=t;if(typeof i!="object"&&(i=JSON.parse(t)),!i.users&&!i.user)return e({message:"No JSON",status:-1});let n=i.users||[i],s=window.requestIdleCallback(()=>{Dl.delete(s);let o={data:[],seenIDs:new Set};for(let a=0;a<n.length;a++){let l=n[a],c=l.user.id&&l.user.id.toString();if(o.seenIDs.add(c),r.skipSeen&&ri.user[c]){delete ri.toLoad[c];continue}let u=bM.user(l.user,c);u&&(delete ri.toLoad[c],ri.user[c]=u,o.data.push(u))}e(null,o)});Dl.add(s)}var Nj={node:function(e,r){var i=e.attributes;return new je({id:r,visible:Iv(i),version:i.version.value,changeset:i.changeset&&i.changeset.value,timestamp:i.timestamp&&i.timestamp.value,user:i.user&&i.user.value,uid:i.uid&&i.uid.value,loc:vM(i),tags:R9(e)})},way:function(e,r){var i=e.attributes;return new Lt({id:r,visible:Iv(i),version:i.version.value,changeset:i.changeset&&i.changeset.value,timestamp:i.timestamp&&i.timestamp.value,user:i.user&&i.user.value,uid:i.uid&&i.uid.value,tags:R9(e),nodes:Cj(e)})},relation:function(e,r){var i=e.attributes;return new Cr({id:r,visible:Iv(i),version:i.version.value,changeset:i.changeset&&i.changeset.value,timestamp:i.timestamp&&i.timestamp.value,user:i.user&&i.user.value,uid:i.uid&&i.uid.value,tags:R9(e),members:Ij(e)})},note:function(e,r){var i=e.attributes,n=e.childNodes,s={};s.id=r,s.loc=vM(i);var o=!1,a=1e-5;do{o&&(s.loc=Ot(s.loc,[a,a]));var l=new le(s.loc).bbox();o=Ht.rtree.search(l).length}while(o);for(var c=0;c<n.length;c++){var u=n[c],d=u.nodeName;d!=="#text"&&(d==="comments"?s[d]=Pj(u.childNodes):s[d]=u.textContent)}var h=new Jt(s),p=Rv(h);return Ht.note[h.id]=h,Ht.rtree.insert(p),h},user:function(e,r){var i=e.attributes,n={id:r,display_name:i.display_name&&i.display_name.value,account_created:i.account_created&&i.account_created.value,changesets_count:"0",active_blocks:"0"},s=e.getElementsByTagName("img");s&&s[0]&&s[0].getAttribute("href")&&(n.image_url=s[0].getAttribute("href"));var o=e.getElementsByTagName("changesets");o&&o[0]&&o[0].getAttribute("count")&&(n.changesets_count=o[0].getAttribute("count"));var a=e.getElementsByTagName("blocks");if(a&&a[0]){var l=a[0].getElementsByTagName("received");l&&l[0]&&l[0].getAttribute("active")&&(n.active_blocks=l[0].getAttribute("active"))}return ri.user[r]=n,delete ri.toLoad[r],n}};function Pv(t,e,r){if(r=Object.assign({skipSeen:!0},r),!t||!t.childNodes)return e({message:"No XML",status:-1});let i=t.childNodes[0],n=Array.from(i.childNodes);if(n.some(o=>o.nodename==="error"))return e({message:"Partial XML",status:-1});let s=window.requestIdleCallback(()=>{Dl.delete(s);let o={data:[],seenIDs:new Set};for(let a=0;a<n.length;a++){let l=n[a],c=Nj[l.nodeName];if(!c)continue;let u;if(l.nodeName==="user"){if(u=l.attributes.id.value,o.seenIDs.add(u),r.skipSeen&&ri.user[u]){delete ri.toLoad[u];continue}}else if(l.nodeName==="note")u=l.getElementsByTagName("id")[0].textContent,o.seenIDs.add(u);else if(u=Te.id.fromOSM(l.nodeName,l.attributes.id.value),o.seenIDs.add(u),r.skipSeen){if(cr.seen[u])continue;cr.seen[u]=!0}let d=c(l,u);d&&o.data.push(d)}e(null,o)});Dl.add(s)}function xM(t,e){Ht.rtree.remove(t,function(i,n){return i.data.id===n.data.id}),e&&Ht.rtree.insert(t)}function Oo(t,e,r){return function(i,n){return i?((i.status===400||i.status===401||i.status===403)&&t.logout(),e.call(t,i)):t.getConnectionId()!==r?e.call(t,{message:"Connection Switched",status:-1}):e.call(t,i,n)}}var s4={init:function(){ge(this,ks,"on")},reset:function(){return Array.from(Dl).forEach(function(t){window.cancelIdleCallback(t),Dl.delete(t)}),ts++,ec=void 0,tc=void 0,m4=void 0,Object.values(cr.inflight).forEach(I5),Object.values(Ht.inflight).forEach(I5),Object.values(Ht.inflightPost).forEach(I5),es.inflight&&I5(es.inflight),cr={toLoad:{},loaded:{},inflight:{},seen:{},rtree:new g4.default},Ht={toLoad:{},loaded:{},inflight:{},inflightPost:{},note:{},closed:{},rtree:new g4.default},ri={toLoad:{},user:{}},k5=void 0,es={},this},getConnectionId:function(){return ts},getUrlRoot:function(){return rs},changesetURL:function(t){return rs+"/changeset/"+t},changesetsURL:function(t,e){var r=Math.max(0,Math.ceil(Math.log(e)/Math.LN2));return rs+"/history#map="+Math.floor(e)+"/"+t[1].toFixed(r)+"/"+t[0].toFixed(r)},entityURL:function(t){return rs+"/"+t.type+"/"+t.osmId()},historyURL:function(t){return rs+"/"+t.type+"/"+t.osmId()+"/history"},userURL:function(t){return rs+"/user/"+t},noteURL:function(t){return rs+"/note/"+t.id},noteReportURL:function(t){return rs+"/reports/new?reportable_type=Note&reportable_id="+t.id},loadFromAPI:function(t,e,r){r=Object.assign({skipSeen:!0},r);var i=this,n=ts;function s(c,u){if(i.getConnectionId()!==n){e&&e({message:"Connection Switched",status:-1});return}var d=i.authenticated();if(d&&c&&c.status&&(c.status===400||c.status===401||c.status===403))i.logout(),i.loadFromAPI(t,e,r);else if(!d&&!m4&&c&&c.status&&(c.status===509||c.status===429)?(m4=c,ks.call("change"),i.reloadApiStatus()):(c&&k5==="online"||!c&&k5!=="online")&&i.reloadApiStatus(),e)return c?e(c):t.indexOf(".json")!==-1?Rj(u,e,r):Pv(u,e,r)}if(this.authenticated())return hn.xhr({method:"GET",path:t},s);var o=rs+t,a=new AbortController,l;return t.indexOf(".json")!==-1?l=It:l=e0,l(o,{signal:a.signal}).then(function(c){s(null,c)}).catch(function(c){if(c.name!=="AbortError"){var u=c.message.match(/^\d{3}/);s(u?{status:+u[0],statusText:c.message}:c.message)}}),a},loadEntity:function(t,e){var r=Te.id.type(t),i=Te.id.toOSM(t),n={skipSeen:!1};this.loadFromAPI("/api/0.6/"+r+"/"+i+(r!=="node"?"/full":"")+".json",e,n)},loadEntityVersion:function(t,e,r){var i=Te.id.type(t),n=Te.id.toOSM(t),s={skipSeen:!1};this.loadFromAPI("/api/0.6/"+i+"/"+n+"/"+e+".json",r,s)},loadEntityRelations:function(t,e){var r=Te.id.type(t),i=Te.id.toOSM(t),n={skipSeen:!1};this.loadFromAPI("/api/0.6/"+r+"/"+i+"/relations.json",e,n)},loadMultiple:function(t,e){var r=this,i=yr($e(t),Te.id.type);Object.keys(i).forEach(function(n){var s=n+"s",o=i[n].map(function(l){return Te.id.toOSM(l)}),a={skipSeen:!1};S4(o,150).forEach(function(l){r.loadFromAPI("/api/0.6/"+s+".json?"+s+"="+l.join(),e,a)})})},putChangeset:function(t,e,r){var i=ts;if(es.inflight)return r({message:"Changeset already inflight",status:-2},t);if(es.open)return s.call(this,null,es.open);var n={method:"PUT",path:"/api/0.6/changeset/create",headers:{"Content-Type":"text/xml"},content:go.stringify(t.asJXON())};es.inflight=hn.xhr(n,Oo(this,s,i));function s(a,l){if(es.inflight=null,a)return r(a,t);es.open=l,t=t.update({id:l});var c={method:"POST",path:"/api/0.6/changeset/"+l+"/upload",headers:{"Content-Type":"text/xml"},content:go.stringify(t.osmChangeJXON(e))};es.inflight=hn.xhr(c,Oo(this,o,i))}function o(a){if(es.inflight=null,a)return r(a,t);window.setTimeout(function(){r(null,t)},2500),es.open=null,this.getConnectionId()===i&&hn.xhr({method:"PUT",path:"/api/0.6/changeset/"+t.id+"/close",headers:{"Content-Type":"text/xml"}},function(){return!0})}},loadUsers:function(t,e){var r=[],i=[];if($e(t).forEach(function(s){ri.user[s]?(delete ri.toLoad[s],i.push(ri.user[s])):r.push(s)}),(i.length||!this.authenticated())&&(e(void 0,i),!this.authenticated()))return;S4(r,150).forEach(function(s){hn.xhr({method:"GET",path:"/api/0.6/users.json?users="+s.join()},Oo(this,n,ts))}.bind(this));function n(s,o){if(s)return e(s);var a={skipSeen:!0};return Mv(o,function(l,c){return l?e(l):e(void 0,c.data)},a)}},loadUser:function(t,e){if(ri.user[t]||!this.authenticated())return delete ri.toLoad[t],e(void 0,ri.user[t]);hn.xhr({method:"GET",path:"/api/0.6/user/"+t+".json"},Oo(this,r,ts));function r(i,n){if(i)return e(i);var s={skipSeen:!0};return Mv(n,function(o,a){return o?e(o):e(void 0,a.data[0])},s)}},userDetails:function(t){if(tc)return t(void 0,tc);hn.xhr({method:"GET",path:"/api/0.6/user/details.json"},Oo(this,e,ts));function e(r,i){if(r)return t(r);var n={skipSeen:!1};return Mv(i,function(s,o){return s?t(s):(tc=o.data[0],t(void 0,tc))},n)}},userChangesets:function(t){if(ec)return t(void 0,ec);this.userDetails(Oo(this,e,ts));function e(i,n){if(i)return t(i);hn.xhr({method:"GET",path:"/api/0.6/changesets?user="+n.id},Oo(this,r,ts))}function r(i,n){return i?t(i):(ec=Array.prototype.map.call(n.getElementsByTagName("changeset"),function(s){return{tags:R9(s)}}).filter(function(s){var o=s.tags.comment;return o&&o!==""}),t(void 0,ec))}},status:function(t){var e=rs+"/api/capabilities",r=Oo(this,i,ts);e0(e,{credentials:_M}).then(function(n){r(null,n)}).catch(function(n){r(n.message)});function i(n,s){if(n)return t(n,null);for(var o=s.getElementsByTagName("blacklist"),a=[],l=0;l<o.length;l++){var c=o[l].getAttribute("regex");if(c)try{var u=new RegExp(c);a.push(u)}catch{}}if(a.length&&(mM=a),m4)return t(m4,"rateLimited");var d=s.getElementsByTagName("waynodes"),h=d.length&&parseInt(d[0].getAttribute("maximum"),10);h&&isFinite(h)&&(gM=h);var p=s.getElementsByTagName("status"),m=p[0].getAttribute("api");return t(void 0,m)}},reloadApiStatus:function(){if(!this.throttledReloadApiStatus){var t=this;this.throttledReloadApiStatus=Sn(function(){t.status(function(e,r){r!==k5&&(k5=r,ks.call("apiStatusChange",t,e,r))})},500)}this.throttledReloadApiStatus()},maxWayNodes:function(){return gM},loadTiles:function(t,e){if(!I9){var r=Cv.zoomRange(kv).margin(1).getTiles(t).tiles,i=M9(cr);yM(cr,r),i&&!M9(cr)&&ks.call("loaded"),r.forEach(function(n){this.loadTile(n,e)},this)}},loadTile:function(t,e){if(I9||cr.loaded[t.id]||cr.inflight[t.id])return;if(t.wgs84Extent.polygon().slice(0,4).every(a=>wt.blocksAt(a).length)){cr.loaded[t.id]=!0;return}M9(cr)||ks.call("loading");var n="/api/0.6/map.json?bbox=",s={skipSeen:!0};cr.inflight[t.id]=this.loadFromAPI(n+t.wgs84Extent.toParam(),o,s);function o(a,l){if(delete cr.inflight[t.id],!a){delete cr.toLoad[t.id],cr.loaded[t.id]=!0;var c=t.wgs84Extent.bbox();c.id=t.id,cr.rtree.insert(c)}e&&e(a,Object.assign({},l,{tile:t})),M9(cr)||ks.call("loaded")}},isDataLoaded:function(t){var e={minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]};return cr.rtree.collides(e)},loadTileAtLoc:function(t,e){if(!(Object.keys(cr.toLoad).length>50)){var r=di(kv+1),i=new Qi().scale(r).project(t),n=new Qi().transform({k:r,x:-i[0],y:-i[1]}),s=Cv.zoomRange(kv).getTiles(n).tiles;s.forEach(function(o){cr.toLoad[o.id]||cr.loaded[o.id]||cr.inflight[o.id]||(cr.toLoad[o.id]=!0,this.loadTile(o,e))},this)}},loadNotes:function(t,e){if(e=Object.assign({limit:1e4,closed:7},e),!I9){var r=this,i="/api/0.6/notes?limit="+e.limit+"&closed="+e.closed+"&bbox=",n=Sn(function(){var o=Object.keys(ri.toLoad);o.length&&r.loadUsers(o,function(){})},750),s=Cv.zoomRange(Sj).margin(1).getTiles(t).tiles;yM(Ht,s),s.forEach(function(o){if(Ht.loaded[o.id]||Ht.inflight[o.id])return;if(o.wgs84Extent.polygon().slice(0,4).every(u=>wt.blocksAt(u).length)){Ht.loaded[o.id]=!0;return}var c={skipSeen:!1};Ht.inflight[o.id]=r.loadFromAPI(i+o.wgs84Extent.toParam(),function(u){delete Ht.inflight[o.id],u||(Ht.loaded[o.id]=!0),n(),ks.call("loadedNotes")},c)})}},postNoteCreate:function(t,e){if(!this.authenticated())return e({message:"Not Authenticated",status:-3},t);if(Ht.inflightPost[t.id])return e({message:"Note update already inflight",status:-2},t);if(!t.loc[0]||!t.loc[1]||!t.newComment)return;var r=t.newComment;t.newCategory&&t.newCategory!=="None"&&(r+=" #"+t.newCategory);var i="/api/0.6/notes?"+xt({lon:t.loc[0],lat:t.loc[1],text:r});Ht.inflightPost[t.id]=hn.xhr({method:"POST",path:i},Oo(this,n,ts));function n(s,o){if(delete Ht.inflightPost[t.id],s)return e(s);this.removeNote(t);var a={skipSeen:!1};return Pv(o,function(l,c){return l?e(l):e(void 0,c.data[0])},a)}},postNoteUpdate:function(t,e,r){if(!this.authenticated())return r({message:"Not Authenticated",status:-3},t);if(Ht.inflightPost[t.id])return r({message:"Note update already inflight",status:-2},t);var i;if(t.status!=="closed"&&e==="closed")i="close";else if(t.status!=="open"&&e==="open")i="reopen";else if(i="comment",!t.newComment)return;var n="/api/0.6/notes/"+t.id+"/"+i;t.newComment&&(n+="?"+xt({text:t.newComment})),Ht.inflightPost[t.id]=hn.xhr({method:"POST",path:n},Oo(this,s,ts));function s(o,a){if(delete Ht.inflightPost[t.id],o)return r(o);this.removeNote(t),i==="close"?Ht.closed[t.id]=!0:i==="reopen"&&delete Ht.closed[t.id];var l={skipSeen:!1};return Pv(a,function(c,u){return c?r(c):r(void 0,u.data[0])},l)}},switch:function(t){rs=t.url;var e=Fi(hn.options(),"access_token");return hn.options(Object.assign(e,t)),this.reset(),this.userChangesets(function(){}),ks.call("change"),this},toggle:function(t){return I9=!t,this},isChangesetInflight:function(){return!!es.inflight},caches:function(t){function e(r){var i={};return Object.keys(r).forEach(function(n){n==="rtree"?i.rtree=new g4.default().fromJSON(r.rtree.toJSON()):n==="note"?(i.note={},Object.keys(r.note).forEach(function(s){i.note[s]=Jt(r.note[s])})):i[n]=JSON.parse(JSON.stringify(r[n]))}),i}return arguments.length?t==="get"?{tile:cr,note:Ht,user:ri}:(t.tile&&(cr=t.tile,cr.inflight={}),t.note&&(Ht=t.note,Ht.inflight={},Ht.inflightPost={}),t.user&&(ri=t.user),this):{tile:e(cr),note:e(Ht),user:e(ri)}},logout:function(){return ec=void 0,tc=void 0,hn.logout(),ks.call("change"),this},authenticated:function(){return hn.authenticated()},authenticate:function(t){var e=this,r=ts;ec=void 0,tc=void 0;function i(n,s){if(n){t&&t(n);return}if(e.getConnectionId()!==r){t&&t({message:"Connection Switched",status:-1});return}m4=void 0,ks.call("change"),t&&t(n,s),e.userChangesets(function(){})}hn.authenticate(i)},imageryBlocklists:function(){return mM},notes:function(t){var e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox();return Ht.rtree.search(n).map(function(s){return s.data})},getNote:function(t){return Ht.note[t]},removeNote:function(t){!(t instanceof Jt)||!t.id||(delete Ht.note[t.id],xM(Rv(t),!1))},replaceNote:function(t){if(!(!(t instanceof Jt)||!t.id))return Ht.note[t.id]=t,xM(Rv(t),!0),t},getClosedIDs:function(){return Object.keys(Ht.closed).sort()}};var Nv="https://wiki.openstreetmap.org/w/api.php",rc={},Lo={},N9={en:!1},Dj=Gt(wM,500,{leading:!1});function wM(t,e){if(!rc[t]){var r=new AbortController;rc[t]=r,It(t,{signal:r.signal}).then(function(i){delete rc[t],e&&e(null,i)}).catch(function(i){delete rc[t],i.name!=="AbortError"&&e&&e(i.message)})}}var Dv={init:function(){rc={},Lo={},N9={}},reset:function(){Object.values(rc).forEach(function(t){t.abort()}),rc={}},claimToValue:function(t,e,r){if(t.claims[e]){var i=N9[r],n,s;t.claims[e].forEach(function(l){!n&&l.rank==="preferred"&&(n=l),i&&l.qualifiers&&l.qualifiers.P26&&l.qualifiers.P26[0].datavalue.value.id===i&&(s=l)});var o=s||n;if(o){var a=o.mainsnak.datavalue;return a.type==="wikibase-entityid"?a.value.id:a.value}else return}},monolingualClaimToValueObj:function(t,e){if(!(!t||!t.claims[e]))return t.claims[e].reduce(function(r,i){var n=i.mainsnak.datavalue.value;return r[n.language]=n.text,r},{})},toSitelink:function(t,e){var r=e?"Tag:"+t+"="+e:"Key:"+t;return r.replace(/_/g," ").trim()},getEntity:function(t,e){var r=t.debounce?Dj:wM,i=this,n=[],s={},o=t.key==="type"&&t.value?("Relation:"+t.value).replace(/_/g," ").trim():!1,a=t.key?this.toSitelink(t.key):!1,l=t.key&&t.value?this.toSitelink(t.key,t.value):!1,c;if(t.langCodes&&t.langCodes.forEach(function(h){N9[h]===void 0&&(c=("Locale:"+h).replace(/_/g," ").trim(),n.push(c))}),o&&(Lo[o]?s.rtype=Lo[o]:n.push(o)),a&&(Lo[a]?s.key=Lo[a]:n.push(a)),l&&(Lo[l]?s.tag=Lo[l]:n.push(l)),!n.length)return e(null,s);var u={action:"wbgetentities",sites:"wiki",titles:n.join("|"),languages:t.langCodes.join("|"),languagefallback:1,origin:"*",format:"json"},d=Nv+"?"+xt(u);r(d,function(h,p){if(h)e(h);else if(!p.success||p.error)e(p.error.messages.map(function(g){return g.html["*"]}).join("<br>"));else{var m=!1;Object.values(p.entities).forEach(function(g){if(g.missing!==""){var y=g.sitelinks.wiki.title;y===o?(Lo[o]=g,s.rtype=g):y===a?(Lo[a]=g,s.key=g):y===l?(Lo[l]=g,s.tag=g):y===c?m=g.id:console.log("Unexpected title "+y)}}),c&&i.addLocale(t.langCodes[0],m),e(null,s)}})},getDocs:function(t,e){var r=this,i=se.localeCodes().map(function(n){return n.toLowerCase()});t.langCodes=i,this.getEntity(t,function(n,s){if(n){e(n);return}var o=s.rtype||s.tag||s.key;if(!o){e("No entity");return}var a,l;for(a in i){let E=i[a];if(o.descriptions[E]&&o.descriptions[E].language===E){l=o.descriptions[E];break}}!l&&Object.values(o.descriptions).length&&(l=Object.values(o.descriptions)[0]);var c={title:o.title,description:l?l.value:"",descriptionLocaleCode:l?l.language:"",editURL:"https://wiki.openstreetmap.org/wiki/"+o.title};if(o.claims){var u,d=r.claimToValue(o,"P4",i[0]);d?u="https://commons.wikimedia.org/w/index.php":(d=r.claimToValue(o,"P28",i[0]),d&&(u="https://wiki.openstreetmap.org/w/index.php")),u&&d&&(c.imageURL=u+"?"+xt({title:"Special:Redirect/file/"+d,width:400}))}var h=r.monolingualClaimToValueObj(s.rtype,"P31"),p=r.monolingualClaimToValueObj(s.tag,"P31"),m=r.monolingualClaimToValueObj(s.key,"P31"),g=[h,p,m];for(a in g){var y=g[a];for(var v in i){var x=i[v],_=i[0].split("-")[0]!=="en"&&x.split("-")[0]==="en"?"inspector.wiki_en_reference":"inspector.wiki_reference",b=w(y,x,_);if(b){c.wiki=b;break}}if(c.wiki)break}e(null,c);function w(E,A,T){if(E&&E[A])return{title:E[A],text:T,url:"https://wiki.openstreetmap.org/wiki/"+E[A]}}})},addLocale:function(t,e){N9[t]=e},apibase:function(t){return arguments.length?(Nv=t,this):Nv}};var TM=dt(Us(),1);var D9={};window.jsonpCache=D9;function EM(t,e){var r={abort:function(){}};if(window.JSONP_FIX){if(window.JSONP_DELAY===0)e(window.JSONP_FIX);else{var i=window.setTimeout(function(){e(window.JSONP_FIX)},window.JSONP_DELAY||0);r.abort=function(){window.clearTimeout(i)}}return r}function n(){for(var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",c="",u=-1;++u<15;)c+=l.charAt(Math.floor(Math.random()*52));return c}function s(l){var c=l.match(/callback=(\w+)/),u=c?c[1]:n();D9[u]=function(h){D9[u]&&e(h),d()};function d(){delete D9[u],a.remove()}return r.abort=d,"jsonpCache."+u}var o=s(t),a=H("head").append("script").attr("type","text/javascript").attr("src",t.replace(/(\{|%7B)callback(\}|%7D)/,o));return r}var Fj="pannellum-streetside/pannellum.css",Oj="pannellum-streetside/pannellum.js",AM=16.5,Lj=new Pr().zoomRange(AM).skipNullIsland(!0),O9=fe("loadedImages","viewerChanged"),F9=!1,L9=512,y4=0,or,Is,M5,ic={showFullscreenCtrl:!1,autoLoad:!0,compass:!0,yaw:0,hfov:45,minHfov:10,maxHfov:90,type:"cubemap",cubeMap:[]};function Bj(t){if(!t)return null;let e={day:"numeric",month:"short",year:"numeric"},r=new Date(t);return isNaN(r.getTime())?null:r.toLocaleString(se.localeCode(),e)}function Uj(t,e){let r=Lj.zoomRange(AM).margin(e).getTiles(t).tiles;for(let[n,s]of or.inflight.entries())r.find(a=>a.id===n)||s.controller.abort();for(let n of r){let s=n.id;or.loaded.has(s)||or.inflight.has(s)||zj(n).then(i).catch(o=>{o.name!=="AbortError"&&o instanceof Error&&console.error(o)})}function i(n){or.loaded.add(n.tile.id);let s=n.data;if(!s||s.error)return;s.shift();let o=s.map(a=>{if(or.bubbles.has(a.id))return null;let l=[a.lo,a.la],c={loc:l,id:a.id,ca:a.he,captured_at:a.cd,captured_by:"microsoft",pr:a.pr,ne:a.ne,isPano:!0,sequenceID:null};return or.bubbles.set(a.id,c),a.pr===void 0&&or.leaders.push(a.id),{minX:l[0],minY:l[1],maxX:l[0],maxY:l[1],data:c}}).filter(Boolean);or.rtree.load(o),Gj(),O9.call("loadedImages")}}function Gj(){let t=[];for(let e=0;e<or.leaders.length;e++){let r=or.bubbles.get(or.leaders[e]),i={},n={id:r.id,bubbles:[]},s=!1;do n.bubbles.push(r),i[r.id]=!0,r.ne===void 0?s=!0:r=or.bubbles.get(r.ne);while(r&&!i[r.id]&&!s);if(s){for(let o=0;o<n.bubbles.length;o++)n.bubbles[o].sequenceID=n.id;n.geojson={type:"LineString",properties:{id:n.id,captured_at:n.bubbles[0]?n.bubbles[0].captured_at:null,captured_by:n.bubbles[0]?n.bubbles[0].captured_by:null},coordinates:n.bubbles.map(o=>o.loc)},or.sequences.set(n.id,n)}else t.push(or.leaders[e])}or.leaders=t}function zj(t){let[e,r,i,n]=t.wgs84Extent.rectangle(),l="https://dev.virtualearth.net/mapcontrol/HumanScaleServices/GetBubbles.ashx?"+xt({n,s:r,e:i,w:e,c:2e3,appkey:"AuftgJsO0Xs8Ts4M1xZUQJQXJNsvmh3IV8DkNieCiy3tCwCUMq76-WpkrBtNAuEm",jsCallback:"{callback}"}),c=or.inflight.get(t.id);if(c)return c.promise;let u=new AbortController,d=new Promise((h,p)=>{let m,g=EM(l,y=>{m&&u.signal.removeEventListener("abort",m),h({data:y,tile:t})});m=()=>{u.signal.removeEventListener("abort",m),g.abort(),p(new DOMException("Aborted","AbortError"))},u.signal.addEventListener("abort",m)}).finally(()=>{or.inflight.delete(t.id)});return or.inflight.set(t.id,{promise:d,controller:u}),d}function Hj(t){return new Promise(e=>{let r=t.face,i=document.getElementById(`ideditor-canvas${r}`),n=i.getContext("2d"),s=new Image;s.onload=()=>{n.drawImage(s,t.x,t.y),e({imgInfo:t,status:"ok"})},s.onerror=()=>{n.clearRect(0,0,i.width,i.height),e({imgInfo:t,status:"error"})},s.setAttribute("crossorigin",""),s.src=t.url})}function $j(t){return Promise.all(t.map(Hj)).then(e=>{let r=e[0].imgInfo.face,i=document.getElementById(`ideditor-canvas${r}`),n={"01":0,"02":1,"03":2,10:3,11:4,12:5};return ic.cubeMap[n[r]]=i.toDataURL("image/jpeg",1),{status:`face ${r} ok`}})}function jj(t){return Promise.all(t.map($j)).then(()=>({status:"loadFacesAsync done"}))}function SM(t){t.selectAll("#ideditor-stitcher-canvases").remove(),t.selectAll("#ideditor-stitcher-canvases").data([0]).enter().append("div").attr("id","ideditor-stitcher-canvases").attr("display","none").selectAll("canvas").data(["canvas01","canvas02","canvas03","canvas10","canvas11","canvas12"]).enter().append("canvas").attr("id",e=>`ideditor-${e}`).attr("width",L9).attr("height",L9)}function Vj(t){let e=0,r=0,i=256;for(let n=t.length;n>0;n--){let s=t[n-1];e+=+(s==="1"||s==="3")*i,r+=+(s==="2"||s==="3")*i,i*=2}return[e,r]}function Xj(){let t=L9/256,e;return t===16?e=["0000","0001","0010","0011","0100","0101","0110","0111","1000","1001","1010","1011","1100","1101","1110","1111","0002","0003","0012","0013","0102","0103","0112","0113","1002","1003","1012","1013","1102","1103","1112","1113","0020","0021","0030","0031","0120","0121","0130","0131","1020","1021","1030","1031","1120","1121","1130","1131","0022","0023","0032","0033","0122","0123","0132","0133","1022","1023","1032","1033","1122","1123","1132","1133","0200","0201","0210","0211","0300","0301","0310","0311","1200","1201","1210","1211","1300","1301","1310","1311","0202","0203","0212","0213","0302","0303","0312","0313","1202","1203","1212","1213","1302","1303","1312","1313","0220","0221","0230","0231","0320","0321","0330","0331","1220","1221","1230","1231","1320","1321","1330","1331","0222","0223","0232","0233","0322","0323","0332","0333","1222","1223","1232","1233","1322","1323","1332","1333","2000","2001","2010","2011","2100","2101","2110","2111","3000","3001","3010","3011","3100","3101","3110","3111","2002","2003","2012","2013","2102","2103","2112","2113","3002","3003","3012","3013","3102","3103","3112","3113","2020","2021","2030","2031","2120","2121","2130","2131","3020","3021","3030","3031","3120","3121","3130","3131","2022","2023","2032","2033","2122","2123","2132","2133","3022","3023","3032","3033","3122","3123","3132","3133","2200","2201","2210","2211","2300","2301","2310","2311","3200","3201","3210","3211","3300","3301","3310","3311","2202","2203","2212","2213","2302","2303","2312","2313","3202","3203","3212","3213","3302","3303","3312","3313","2220","2221","2230","2231","2320","2321","2330","2331","3220","3221","3230","3231","3320","3321","3330","3331","2222","2223","2232","2233","2322","2323","2332","2333","3222","3223","3232","3233","3322","3323","3332","3333"]:t===8?e=["000","001","010","011","100","101","110","111","002","003","012","013","102","103","112","113","020","021","030","031","120","121","130","131","022","023","032","033","122","123","132","133","200","201","210","211","300","301","310","311","202","203","212","213","302","303","312","313","220","221","230","231","320","321","330","331","222","223","232","233","322","323","332","333"]:t===4?e=["00","01","10","11","02","03","12","13","20","21","30","31","22","23","32","33"]:e=["0","1","2","3"],e}var Fv={init:function(){or||this.reset(),this.event=ge(this,O9,"on")},reset:function(){if(or)for(let t of or.inflight.values())t.controller.abort();or={inflight:new Map,loaded:new Set,bubbles:new Map,sequences:new Map,rtree:new TM.default,leaders:[],metadataPromsie:null}},bubbles:function(t){let e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox();return or.rtree.search(n).map(s=>s.data)},cachedImage:function(t){return or.bubbles.get(t)},sequences:function(t){let e=t.dimensions(),r=[e[0][0],e[1][1]],i=[e[1][0],e[0][1]],n=new le(t.invert(r),t.invert(i)).bbox(),s=new Map;for(let o of or.rtree.search(n)){let a=o.data.sequenceID;a&&(s.has(a)||s.set(a,or.sequences.get(a).geojson))}return[...s.values()]},loadBubbles:function(t,e=2){Uj(t,e)},viewer:function(){return Is},initViewer:function(){if(!window.pannellum||Is)return;y4++;let t=y4.toString(),e={default:{firstScene:t},scenes:{}};e.scenes[t]=ic,Is=window.pannellum.viewer("ideditor-viewer-streetside",e)},loadViewerAsync:function(t){if(M5)return M5;let e=t.container().select(".photoviewer").selectAll(".ms-wrapper").data([0]),r=e.enter().append("div").attr("class","photo-wrapper ms-wrapper").classed("hide",!0),i=this;r.append("div").attr("id","ideditor-viewer-streetside").on("pointerdown.streetside",()=>{H(window).on("pointermove.streetside",()=>{O9.call("viewerChanged")},!0)}).on("pointerup.streetside pointercancel.streetside",()=>{H(window).on("pointermove.streetside",null);let o=Tc(a=>{O9.call("viewerChanged"),a>2e3&&o.stop()})}).append("div").attr("class","photo-attribution fillD");let n=r.append("div").attr("class","photo-controls-wrap").append("div").attr("class","photo-controls");return n.append("button").on("click.back",()=>s(-1)).html("\u25C4"),n.append("button").on("click.forward",()=>s(1)).html("\u25BA"),e=e.merge(r).call(SM),t.ui().photoviewer.on("resize.streetside",()=>{Is&&Is.resize()}),M5=new Promise((o,a)=>{let l=0;function c(){l+=1,l===2&&o()}let u=H("head");u.selectAll("#ideditor-streetside-viewercss").data([0]).enter().append("link").attr("id","ideditor-streetside-viewercss").attr("rel","stylesheet").attr("crossorigin","anonymous").attr("href",t.asset(Fj)).on("load.serviceStreetside",c).on("error.serviceStreetside",a),u.selectAll("#ideditor-streetside-viewerjs").data([0]).enter().append("script").attr("id","ideditor-streetside-viewerjs").attr("crossorigin","anonymous").attr("src",t.asset(Oj)).on("load.serviceStreetside",c).on("error.serviceStreetside",a)}).catch(o=>{o instanceof Error&&console.error(o),M5=null}),M5;function s(o){let a=t.container().select(".photoviewer"),l=a.empty()?void 0:a.datum();if(!l)return;let c=o===1?l.ne:l.pr,u=Is.getYaw();ic.yaw=u;let d=l.ca+u,h=l.loc,p=35,m=[h[0]+fi(p/5,h[1]),h[1]],g=[h[0]+fi(p/2,h[1]),h[1]+uo(p)],y=[h[0]-fi(p/2,h[1]),h[1]+uo(p)],v=[h[0]-fi(p/5,h[1]),h[1]],x=[m,g,y,v,m],_=(o===1?d:d+180)*(Math.PI/180);x=Wo(x,-_,h);let b=x.reduce((A,T)=>(A.min=[Math.min(A.min[0],T[0]),Math.min(A.min[1],T[1])],A.max=[Math.max(A.max[0],T[0]),Math.max(A.max[1],T[1])],A),new le),w=1/0;or.rtree.search(b.bbox()).forEach(A=>{if(A.data.id===l.id||!Pc(A.data.loc,x))return;let T=ut(A.data.loc,l.loc),k=l.ca-A.data.ca;Math.min(Math.abs(k),360-Math.abs(k))>20&&(T+=5),T<w&&(c=A.data.id,w=T)});let E=c&&i.cachedImage(c);E&&(t.map().centerEase(E.loc),t.photos().selectPhoto("streetside",E.id))}},showViewer:function(t){let e=t.container().select(".photoviewer").classed("hide",!1);return e.selectAll(".photo-wrapper.ms-wrapper.hide").size()&&(e.selectAll(".photo-wrapper:not(.ms-wrapper)").classed("hide",!0),e.selectAll(".photo-wrapper.ms-wrapper").classed("hide",!1)),this},hideViewer:function(t){t.photos().selectPhoto(null);let e=t.container().select(".photoviewer");return e.empty()||e.datum(null),e.classed("hide",!0).selectAll(".photo-wrapper").classed("hide",!0),t.container().selectAll(".viewfield-group, .sequence, .icon-sign").classed("currentView",!1),this.setStyles(t,null,!0)},selectImage:function(t,e){let r=this,i=this.cachedImage(e),n=t.container().select(".photoviewer");n.empty()||n.datum(i),this.setStyles(t,null,!0);let s=t.container().select(".photoviewer .ms-wrapper"),o=s.selectAll(".photo-attribution").html("");if(s.selectAll(".pnlm-load-box").style("display","block").style("transform","translate(-50%, -50%)"),!i)return this;ic.northOffset=i.ca;let a=o.append("div").attr("class","attribution-row"),l=ss("streetside-hires"),c=a.append("label").attr("for",l).attr("class","streetside-hires");c.append("input").attr("type","checkbox").attr("id",l).property("checked",F9).on("click",b=>{b.stopPropagation(),F9=!F9,L9=F9?1024:512,s.call(SM);let w={yaw:Is.getYaw(),pitch:Is.getPitch(),hfov:Is.getHfov()};ic=Object.assign(ic,w),t.photos().selectPhoto("streetside",i.id)}),c.append("span").html(S.html("streetside.hires"));let u=a.append("div").attr("class","attribution-capture-info");if(i.captured_by){let b=new Date().getFullYear();u.append("a").attr("class","captured_by").attr("target","_blank").attr("href","https://www.microsoft.com/en-us/maps/streetside").text(`\xA9 ${b} Microsoft`),u.append("span").text("|")}i.captured_at&&u.append("span").attr("class","captured_at").text(Bj(i.captured_at));let d=o.append("div").attr("class","attribution-row");d.append("a").attr("class","image-view-link").attr("target","_blank").attr("href","https://www.bing.com/maps?cp="+i.loc[1]+"~"+i.loc[0]+"&lvl=17&dir="+i.ca+"&style=x&v=2&sV=1").html(S.html("streetside.view_on_bing")),d.append("a").attr("class","image-report-link").attr("target","_blank").attr("href","https://www.bing.com/maps/privacyreport/streetsideprivacyreport?bubbleid="+encodeURIComponent(i.id)+"&focus=photo&lat="+i.loc[1]+"&lng="+i.loc[0]+"&z=17").html(S.html("streetside.report"));let h="http://ecn.t0.tiles.virtualearth.net/tiles/",p=i.id.toString(4),m=16-p.length;for(let b=0;b<m;b++)p="0"+p;let g=h+"hs"+p,y="?g=13305&n=z",v=["01","02","03","10","11","12"],x=Xj(),_=v.map(b=>x.map(w=>{let E=Vj(w);return{face:b,url:g+b+w+y,x:E[0],y:E[1]}}));return jj(_).then(()=>{if(!Is)r.initViewer();else{y4++;let b=y4.toString();Is.addScene(b,ic).loadScene(b),y4>2&&(b=(y4-1).toString(),Is.removeScene(b))}}),this},setStyles:function(t,e,r){r&&(t.container().selectAll(".viewfield-group").classed("highlighted",!1).classed("hovered",!1).classed("currentView",!1),t.container().selectAll(".sequence").classed("highlighted",!1).classed("currentView",!1));let i=e?.id,n=e?.sequenceID,s=n&&or.sequences.get(n),o=s&&s.bubbles.map(g=>g.id)||[],a=t.container().select(".photoviewer"),l=a.empty()?void 0:a.datum(),c=l?.id,u=l?.sequenceID,d=u&&or.sequences.get(u),h=d&&d.bubbles.map(g=>g.id)||[],p=jt(o,h);t.container().selectAll(".layer-streetside-images .viewfield-group").classed("highlighted",g=>p.indexOf(g.id)!==-1).classed("hovered",g=>g.id===i).classed("currentView",g=>g.id===c),t.container().selectAll(".layer-streetside-images .sequence").classed("highlighted",g=>g.properties.id===n).classed("currentView",g=>g.properties.id===u),t.container().selectAll(".layer-streetside-images .viewfield-group .viewfield").attr("d",m);function m(){let g=this.parentNode.__data__;return g.isPano&&g.id!==c?"M 8,13 m -10,0 a 10,10 0 1,0 20,0 a 10,10 0 1,0 -20,0":"M 6,9 C 8,8.4 8,8.4 10,9 L 16,-2 C 12,-5 4,-5 0,-2 z"}return this},cache:function(){return or}};var nc="https://taginfo.openstreetmap.org/api/4/",oc={},Ov={},sc={},Wj={point:"count_nodes",vertex:"count_nodes",area:"count_ways",line:"count_ways"},qj={point:"count_node_members",vertex:"count_node_members",area:"count_way_members",line:"count_way_members",relation:"count_relation_members"},Yj={point:"nodes",vertex:"nodes",area:"ways",line:"ways"},Qj={point:"count_node_members_fraction",vertex:"count_node_members_fraction",area:"count_way_members_fraction",line:"count_way_members_fraction",relation:"count_relation_members_fraction"};function Lv(t,e,r){return t.geometry&&r[t.geometry]&&(t[e]=r[t.geometry]),t}function Kj(t){return Lv(t,"filter",Yj)}function B9(t){return Lv(t,"sortname",Wj)}function Zj(t){return Lv(t,"sortname",qj)}function P5(t){return Fi(t,["geometry","debounce"])}function Jj(t){var e=t?"count_"+t:"count_all";return function(r){return parseFloat(r[e])>2500||r.in_wiki}}function eV(t){return function(e){var r=new RegExp("^"+t+"(.*)$"),i=e.key.match(r)||[];return i.length===2&&i[1].indexOf(":")===-1}}function tV(t){return function(e){return e.value.match(/[;,]/)!==null||!t&&e.value.match(/[A-Z*]/)!==null?!1:parseFloat(e.fraction)>0}}function rV(t){return function(e){return e.role===""||e.role.match(/[A-Z*;,]/)!==null?!1:parseFloat(e[Qj[t]])>0}}function CM(t){return{value:t.key,title:t.key}}function iV(t){var e={value:t.value,title:t.description||t.value};return t.count&&(e.count=t.count),e}function nV(t){return{value:t.role,title:t.role}}function sV(t,e){return t.key.indexOf(":")===-1&&e.key.indexOf(":")!==-1?-1:t.key.indexOf(":")!==-1&&e.key.indexOf(":")===-1?1:0}var R5=Gt(v4,300,{leading:!1});function v4(t,e,r,i,n){if(!oc[t]&&!oV(t,e,r,i)){var s=new AbortController;oc[t]=s,It(t,{signal:s.signal}).then(function(o){delete oc[t],n&&n(null,o)}).catch(function(o){delete oc[t],o.name!=="AbortError"&&n&&n(o.message)})}}function oV(t,e,r,i){var n=e.rp||25,s=e.query||"",o=t;do{var a=sc[o];if(a&&(t===o||a.length<n))return i(null,a),!0;if(r||!s.length)return!1;s=s.slice(0,-1),o=t.replace(/&query=(.*?)&/,"&query="+s+"&")}while(s.length>=0);return!1}var Bv={init:function(){oc={},sc={},Ov={postal_code:!0,full_name:!0,loc_name:!0,reg_name:!0,short_name:!0,sorting_name:!0,artist_name:!0,nat_name:!0,long_name:!0,"bridge:name":!0};var t={rp:100,sortname:"values_all",sortorder:"desc",page:1,debounce:!1,lang:se.languageCode()};this.keys(t,function(e,r){e||r.forEach(function(i){i.value!=="opening_hours"&&(Ov[i.value]=!0)})})},reset:function(){Object.values(oc).forEach(function(t){t.abort()}),oc={}},keys:function(t,e){var r=t.debounce?R5:v4;t=P5(B9(t)),t=Object.assign({rp:10,sortname:"count_all",sortorder:"desc",page:1,lang:se.languageCode()},t);var i=nc+"keys/all?"+xt(t);r(i,t,!1,e,function(n,s){if(n)e(n);else{var o=Jj(t.filter),a=s.data.filter(o).sort(sV).map(CM);sc[i]=a,e(null,a)}})},multikeys:function(t,e){var r=t.debounce?R5:v4;t=P5(B9(t)),t=Object.assign({rp:25,sortname:"count_all",sortorder:"desc",page:1,lang:se.languageCode()},t);var i=t.query,n=nc+"keys/all?"+xt(t);r(n,t,!0,e,function(s,o){if(s)e(s);else{var a=eV(i),l=o.data.filter(a).map(CM);sc[n]=l,e(null,l)}})},values:function(t,e){var r=t.key;if(r&&Ov[r]){e(null,[]);return}var i=t.debounce?R5:v4;t=P5(B9(Kj(t))),t=Object.assign({rp:25,sortname:"count_all",sortorder:"desc",page:1,lang:se.languageCode()},t);var n=nc+"key/values?"+xt(t);i(n,t,!1,e,function(s,o){if(s)e(s);else{var a=/network|taxon|genus|species|brand|grape_variety|royal_cypher|listed_status|booth|rating|stars|:output|_hours|_times|_ref|manufacturer|country|target|brewery/,l=a.test(t.key),c=tV(l),u=o.data.filter(c).map(iV);sc[n]=u,e(null,u)}})},roles:function(t,e){var r=t.debounce?R5:v4,i=t.geometry;t=P5(Zj(t)),t=Object.assign({rp:25,sortname:"count_all_members",sortorder:"desc",page:1,lang:se.languageCode()},t);var n=nc+"relation/roles?"+xt(t);r(n,t,!0,e,function(s,o){if(s)e(s);else{var a=rV(i),l=o.data.filter(a).map(nV);sc[n]=l,e(null,l)}})},docs:function(t,e){var r=t.debounce?R5:v4;t=P5(B9(t));var i="key/wiki_pages?";t.value?i="tag/wiki_pages?":t.rtype&&(i="relation/wiki_pages?");var n=nc+i+xt(t);r(n,t,!0,e,function(s,o){s?e(s):(sc[n]=o.data,e(null,o.data))})},apibase:function(t){return arguments.length?(nc=t,this):nc}};var BM=dt(t1(),1);var pn=63710088e-1,C4t={centimeters:pn*100,centimetres:pn*100,degrees:pn/111325,feet:pn*3.28084,inches:pn*39.37,kilometers:pn/1e3,kilometres:pn/1e3,meters:pn,metres:pn,miles:pn/1609.344,millimeters:pn*1e3,millimetres:pn*1e3,nauticalmiles:pn/1852,radians:1,yards:pn*1.0936},k4t={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/pn,yards:1.0936133};function U9(t,e,r){r===void 0&&(r={});var i={type:"Feature"};return(r.id===0||r.id)&&(i.id=r.id),r.bbox&&(i.bbox=r.bbox),i.properties=e||{},i.geometry=t,i}function kM(t,e,r){r===void 0&&(r={});for(var i=0,n=t;i<n.length;i++){var s=n[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<s[s.length-1].length;o++)if(s[s.length-1][o]!==s[0][o])throw new Error("First and last Position are not equivalent.")}var a={type:"Polygon",coordinates:t};return U9(a,e,r)}function IM(t,e,r){if(r===void 0&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:t};return U9(i,e,r)}function MM(t,e,r){r===void 0&&(r={});var i={type:"MultiLineString",coordinates:t};return U9(i,e,r)}function PM(t,e,r){r===void 0&&(r={});var i={type:"MultiPolygon",coordinates:t};return U9(i,e,r)}function RM(t){return t.type==="Feature"?t.geometry:t}function NM(t,e,r){var i=t.length,n=x4(t[0],e),s=[],o,a,l,c,u;for(r||(r=[]),o=1;o<i;o++){for(c=t[o-1],u=t[o],a=l=x4(u,e);;)if(n|a){if(n&a)break;n?(c=Uv(c,u,n,e),n=x4(c,e)):(u=Uv(c,u,a,e),a=x4(u,e))}else{s.push(c),a!==l?(s.push(u),o<i-1&&(r.push(s),s=[])):o===i-1&&s.push(u);break}n=l}return s.length&&r.push(s),r}function DM(t,e){var r,i,n,s,o,a,l;for(i=1;i<=8;i*=2){for(r=[],n=t[t.length-1],s=!(x4(n,e)&i),o=0;o<t.length;o++)a=t[o],l=!(x4(a,e)&i),l!==s&&r.push(Uv(n,a,i,e)),l&&r.push(a),n=a,s=l;if(t=r,!t.length)break}return r}function Uv(t,e,r,i){return r&8?[t[0]+(e[0]-t[0])*(i[3]-t[1])/(e[1]-t[1]),i[3]]:r&4?[t[0]+(e[0]-t[0])*(i[1]-t[1])/(e[1]-t[1]),i[1]]:r&2?[i[2],t[1]+(e[1]-t[1])*(i[2]-t[0])/(e[0]-t[0])]:r&1?[i[0],t[1]+(e[1]-t[1])*(i[0]-t[0])/(e[0]-t[0])]:null}function x4(t,e){var r=0;return t[0]<e[0]?r|=1:t[0]>e[2]&&(r|=2),t[1]<e[1]?r|=4:t[1]>e[3]&&(r|=8),r}function Gv(t,e){var r=RM(t),i=r.type,n=t.type==="Feature"?t.properties:{},s=r.coordinates;switch(i){case"LineString":case"MultiLineString":{var o=[];return i==="LineString"&&(s=[s]),s.forEach(function(a){NM(a,e,o)}),o.length===1?IM(o[0],n):MM(o,n)}case"Polygon":return kM(FM(s,e),n);case"MultiPolygon":return PM(s.map(function(a){return FM(a,e)}),n);default:throw new Error("geometry "+i+" not supported")}}function FM(t,e){for(var r=[],i=0,n=t;i<n.length;i++){var s=n[i],o=DM(s,e);o.length>0&&((o[0][0]!==o[o.length-1][0]||o[0][1]!==o[o.length-1][1])&&o.push(o[0]),o.length>=4&&r.push(o))}return r}var zv=dt(Ny(),1),UM=dt(Cp(),1),GM=dt(rv(),1),zM=dt(Jy(),1);var OM=new Pr().tileSize(512).margin(1),HM=fe("loadedData"),Na;function LM(t){t.abort()}function aV(t,e,r){var i=new zM.default.VectorTile(new GM.default(t)),n=Object.keys(i.layers);Array.isArray(n)||(n=[n]);var s=[];return n.forEach(function(o){var a=i.layers[o];if(a)for(var l=0;l<a.length;l++){var c=a.feature(l).toGeoJSON(e.xyz[0],e.xyz[1],e.xyz[2]),u=c.geometry;u.type==="Polygon"&&(u.type="MultiPolygon",u.coordinates=[u.coordinates]);var d=!1;if(u.type==="MultiPolygon"){var h=Gv(c,e.wgs84Extent.rectangle());if((0,BM.default)(c.geometry,h.geometry)||(d=!0),!c.geometry.coordinates.length||!c.geometry.coordinates[0].length)continue}var p=Ll((0,zv.default)(c)),m=Ll((0,zv.default)(c.properties||{}));if(c.__layerID__=o.replace(/[^_a-zA-Z0-9\-]/g,"_"),c.__featurehash__=p,c.__propertyhash__=m,c.v=0,s.push(c),d&&u.type==="MultiPolygon"){var g=r[m];if(g&&g.length){var y=g[0],v=UM.default.union(c.geometry.coordinates,y.geometry.coordinates);if(!v||!v.length)continue;c.v++,g.push(c);for(var x=0;x<g.length;x++)g[x].geometry.coordinates=v,g[x].__featurehash__=p}else r[m]=[c]}}}),s}function lV(t,e){if(!(t.loaded[e.id]||t.inflight[e.id])){var r=t.template.replace("{x}",e.xyz[0]).replace("{y}",e.xyz[1]).replace(/\{[t-]y\}/,Math.pow(2,e.xyz[2])-e.xyz[1]-1).replace(/\{z(oom)?\}/,e.xyz[2]).replace(/\{switch:([^}]+)\}/,function(n,s){var o=s.split(",");return o[(e.xyz[0]+e.xyz[1])%o.length]}),i=new AbortController;t.inflight[e.id]=i,fetch(r,{signal:i.signal}).then(function(n){if(!n.ok)throw new Error(n.status+" "+n.statusText);return t.loaded[e.id]=[],delete t.inflight[e.id],n.arrayBuffer()}).then(function(n){if(!n)throw new Error("No Data");var s=e.xyz[2];t.canMerge[s]||(t.canMerge[s]={}),t.loaded[e.id]=aV(n,e,t.canMerge[s]),HM.call("loadedData")}).catch(function(){t.loaded[e.id]=[],delete t.inflight[e.id]})}}var Hv={init:function(){Na||this.reset(),this.event=ge(this,HM,"on")},reset:function(){for(var t in Na){var e=Na[t];e&&e.inflight&&Object.values(e.inflight).forEach(LM)}Na={}},addSource:function(t,e){return Na[t]={template:e,inflight:{},loaded:{},canMerge:{}},Na[t]},data:function(t,e){var r=Na[t];if(!r)return[];for(var i=OM.getTiles(e).tiles,n={},s=[],o=0;o<i.length;o++){var a=r.loaded[i[o].id];if(!(!a||!a.length))for(var l=0;l<a.length;l++){var c=a[l],u=c.__featurehash__;n[u]||(n[u]=!0,s.push(Object.assign({},c)))}}return s},loadTiles:function(t,e,r){var i=Na[t];i||(i=this.addSource(t,e));var n=OM.getTiles(r).tiles;Object.keys(i.inflight).forEach(function(s){var o=n.find(function(a){return s===a.id});o||(LM(i.inflight[s]),delete i.inflight[s])}),n.forEach(function(s){lV(i,s)})},cache:function(){return Na}};var $v="https://www.wikidata.org/w/api.php?",jv={},Vv={init:function(){},reset:function(){jv={}},itemsForSearchQuery:function(t,e){if(!t){e&&e("No query",{});return}var r=this.languagesToQuery()[0],i=$v+xt({action:"wbsearchentities",format:"json",formatversion:2,search:t,type:"item",language:r,uselang:r,limit:10,origin:"*"});It(i).then(function(n){if(n&&n.error)throw new Error(n.error);e&&e(null,n.search||{})}).catch(function(n){e&&e(n.message,{})})},itemsByTitle:function(t,e,r){if(!e){r&&r("No title",{});return}t=t||"en";var i=$v+xt({action:"wbgetentities",format:"json",formatversion:2,sites:t.replace(/-/g,"_")+"wiki",titles:e,languages:"en",origin:"*"});It(i).then(function(n){if(n&&n.error)throw new Error(n.error);r&&r(null,n.entities||{})}).catch(function(n){r&&r(n.message,{})})},languagesToQuery:function(){return se.localeCodes().map(function(t){return t.toLowerCase()}).filter(function(t){return t!=="en-us"})},entityByQID:function(t,e){if(!t){e("No qid",{});return}if(jv[t]){e&&e(null,jv[t]);return}var r=this.languagesToQuery(),i=$v+xt({action:"wbgetentities",format:"json",formatversion:2,ids:t,props:"labels|descriptions|claims|sitelinks",sitefilter:r.map(function(n){return n+"wiki"}).join("|"),languages:r.join("|"),languagefallback:1,origin:"*"});It(i).then(function(n){if(n&&n.error)throw new Error(n.error);e&&e(null,n.entities[t]||{})}).catch(function(n){e&&e(n.message,{})})},getDocs:function(t,e){var r=this.languagesToQuery();this.entityByQID(t.qid,function(i,n){if(i||!n){e(i||"No entity");return}var s,o;for(s in r){let y=r[s];if(n.descriptions[y]&&n.descriptions[y].language===y){o=n.descriptions[y];break}}!o&&Object.values(n.descriptions).length&&(o=Object.values(n.descriptions)[0]);var a={title:n.id,description:o?o.value:"",descriptionLocaleCode:o?o.language:"",editURL:"https://www.wikidata.org/wiki/"+n.id};if(n.claims){var l="https://commons.wikimedia.org/w/index.php",c=["P154","P18"],u,d;for(s=0;s<c.length;s++)if(u=n.claims[c[s]],u&&Object.keys(u).length>0&&(d=u[Object.keys(u)[0]].mainsnak.datavalue.value,d)){a.imageURL=l+"?"+xt({title:"Special:Redirect/file/"+d,width:400});break}}if(n.sitelinks){var h=se.languageCode().toLowerCase()==="en";for(s=0;s<r.length;s++){var p=r[s]+"wiki";if(n.sitelinks[p]){var m=n.sitelinks[p].title,g="inspector.wiki_reference";!h&&r[s]==="en"&&(g="inspector.wiki_en_reference"),a.wiki={title:m,text:g,url:"https://"+r[s]+".wikipedia.org/wiki/"+m.replace(/ /g,"_")};break}}}e(null,a)})}};var Xv="https://en.wikipedia.org/w/api.php?",Wv={init:function(){},reset:function(){},search:function(t,e,r){if(!e){r&&r("No Query",[]);return}t=t||"en";var i=Xv.replace("en",t)+xt({action:"query",list:"search",srlimit:"10",srinfo:"suggestion",format:"json",origin:"*",srsearch:e});It(i).then(function(n){if(n&&n.error)throw new Error(n.error);if(!n||!n.query||!n.query.search)throw new Error("No Results");if(r){var s=n.query.search.map(function(o){return o.title});r(null,s)}}).catch(function(n){r&&r(n,[])})},suggestions:function(t,e,r){if(!e){r&&r("",[]);return}t=t||"en";var i=Xv.replace("en",t)+xt({action:"opensearch",namespace:0,suggest:"",format:"json",origin:"*",search:e});It(i).then(function(n){if(n&&n.error)throw new Error(n.error);if(!n||n.length<2)throw new Error("No Results");r&&r(null,n[1]||[])}).catch(function(n){r&&r(n.message,[])})},translations:function(t,e,r){if(!e){r&&r("No Title");return}var i=Xv.replace("en",t)+xt({action:"query",prop:"langlinks",format:"json",origin:"*",lllimit:500,titles:e});It(i).then(function(n){if(n&&n.error)throw new Error(n.error);if(!n||!n.query||!n.query.pages)throw new Error("No Results");if(r){var s=n.query.pages[Object.keys(n.query.pages)[0]],o={};s&&s.langlinks&&s.langlinks.forEach(function(a){o[a.lang]=a["*"]}),r(null,o)}}).catch(function(n){r&&r(n.message)})}};var K={esriData:Hy,fbMLRoads:$y,geocoder:dv,keepRight:Xy,improveOSM:qy,osmose:Qy,mapillary:cv,nsi:mv,kartaview:gv,osm:s4,osmWikibase:Dv,maprules:uv,streetside:Fv,taginfo:Bv,vectorTile:Hv,wikidata:Vv,wikipedia:Wv};function is(t,e){var r=fe("change"),i=t.type==="multiCombo"||t.type==="manyCombo",n=t.type==="networkCombo",s=t.type==="semiCombo",o=t.options,a=t.type!=="manyCombo"&&t.autoSuggestions!==!1,l=t.type!=="manyCombo"&&t.customValues!==!1,c=t.snake_case||t.snake_case===void 0,u=At(e,"combo-"+t.safeid).caseSensitive(t.caseSensitive).minItems(i||s?1:2),d=H(null),h=H(null),p=H(null),m=[],g=[],y=[],v,x,_,b=[];Qe.get("deprecated").then(function(R){b=R}).catch(R=>console.error(R)),i&&t.key&&/[^:]$/.test(t.key)&&(t.key+=":");function w(R){return R.replace(/\s+/g,"_").toLowerCase()}function E(R){return R.split(";").map(function(U){return U.trim()}).join(";")}function A(R){R=E(R||"");var U=m.find(function(G){return G.key&&E(G.value)===R});return U?U.key:t.type==="typeCombo"&&!R?"yes":(c?w(R):R)||void 0}function T(R){return R=R||"",t.hasTextForStringId("options."+R)?t.t("options."+R,{default:R}):t.type==="typeCombo"&&R.toLowerCase()==="yes"?"":R}function k(R,U){return R.filter(function(G){return!U.some(function($){return!$.isMixed&&G.value===$.value})})}function C(R,U){l||R.attr("readonly","readonly"),a&&K.taginfo?(R.call(u.fetcher(P),U),P("",N)):(R.call(u,U),I(N))}function I(R){o&&(m=o.map(function(U){return{key:U,value:t.t("options."+U,{default:U}),title:U,display:t.t.html("options."+U,{default:U}),klass:t.hasTextForStringId("options."+U)?"":"raw-option"}}),u.data(k(m,g)),R&&R(m))}function P(R,U){var G=i?"multikeys":"values",$=(i?t.key:"")+R,q=n&&x&&x.indexOf(R.toLowerCase())===0;q&&($=x+":");var ie={debounce:R!=="",key:t.key,query:$};y.length&&(ie.geometry=e.graph().geometry(y[0])),K.taginfo[G](ie,function(Q,re){if(!Q){re=re.filter(function(de){return t.type==="typeCombo"&&de.value==="yes"?!1:!de.count||de.count>10});var ve=Te.deprecatedTagValuesByKey(b)[t.key];ve&&(re=re.filter(function(de){return ve.indexOf(de.value)===-1})),q&&(re=re.filter(function(de){return de.value.toLowerCase().indexOf(x+":")===0})),d.classed("empty-combobox",re.length===0),m=re.map(function(de){var we=de.value;i&&(we=we.replace(t.key,""));var ne=t.t("options."+we,{default:we});return{key:we,value:ne,display:t.t.html("options."+we,{default:we}),title:de.title||ne,klass:t.hasTextForStringId("options."+we)?"":"raw-option"}}),m=k(m,g),U&&U(m)}})}function N(R){if(i||s)_=t.placeholder()||S("inspector.add");else{var U=R.map(function(q){return q.value}).filter(function(q){return q.length<20}),G=U.length>1?U:R.map(function(q){return q.key});_=t.placeholder()||G.slice(0,3).join(", ")}/(|\.\.\.)$/.test(_)||(_+="\u2026");var $;!i&&!s&&v&&Array.isArray(v[t.key])?$=S("inspector.multiple_values"):$=_,d.selectAll("input").attr("placeholder",$)}function M(){var R={},U;if(i||s){U=A(De(p))||"",d.classed("active",!1),De(p,"");var G=U.split(";").filter(Boolean);if(!G.length)return;if(i)$e(G).forEach(function(ie){var Q=(t.key||"")+ie;if(v){var re=v[Q];if(typeof re=="string"&&re.toLowerCase()!=="no")return}Q=e.cleanTagKey(Q),t.keys.push(Q),R[Q]="yes"});else if(s){var $=g.map(function(ie){return ie.key});$=$.concat(G),R[t.key]=e.cleanTagValue($e($).filter(Boolean).join(";"))}window.setTimeout(function(){p.node().focus()},10)}else{var q=De(p);if(!q&&Array.isArray(v[t.key]))return;U=e.cleanTagValue(A(q)),R[t.key]=U||void 0}r.call("change",this,R)}function D(R){return R.id?R.id.startswith("w-"):!1}function F(R,U){if(R.preventDefault(),R.stopPropagation(),!(t.key==="source"&&y[0]&&D(y[0])&&(U.value==="digitalglobe"||U.value==="maxar"))){var G={};if(i)G[U.key]=void 0;else if(s){var $=g.map(function(q){return q.key===U.key?null:q.key}).filter(Boolean);$=$e($),G[t.key]=$.length?$.join(";"):void 0}r.call("change",this,G)}}function L(R){d=R.selectAll(".form-field-input-wrap").data([0]);var U=i||s?"multicombo":"combo";if(d=d.enter().append("div").attr("class","form-field-input-wrap form-field-input-"+U).merge(d),i||s){d=d.selectAll(".chiplist").data([0]);var G="chiplist";(t.key==="destination"||t.key==="via")&&(G+=" full-line-chips"),d=d.enter().append("ul").attr("class",G).on("click",function(){window.setTimeout(function(){p.node().focus()},10)}).merge(d),h=d.selectAll(".input-wrap").data([0]),h=h.enter().append("li").attr("class","input-wrap").merge(h),p=h.selectAll("input").data([0])}else p=d.selectAll("input").data([0]);if(p=p.enter().append("input").attr("type","text").attr("id",t.domId).call(qe).call(C,R).merge(p),n){var $=O(),q=$&&Qa($.center());x=q&&q.toLowerCase()}p.on("change",M).on("blur",M),p.on("keydown.field",function(ie){switch(ie.keyCode){case 13:p.node().blur(),ie.stopPropagation();break}}),(i||s)&&(u.on("accept",function(){p.node().blur(),p.node().focus()}),p.on("focus",function(){d.classed("active",!0)}))}L.tags=function(R){if(v=R,i||s){g=[];var U;if(i){for(var G in R)if(!(t.key&&G.indexOf(t.key)!==0)&&!(!t.key&&t.keys.indexOf(G)===-1)){var $=R[G];if(!(!$||typeof $=="string"&&$.toLowerCase()==="no")){var q=t.key?G.slice(t.key.length):G;g.push({key:G,value:T(q),isMixed:Array.isArray($)})}}t.key?(t.keys=g.map(function(z){return z.key}),U=e.maxCharsForTagKey()-Z9(t.key)):U=e.maxCharsForTagKey()}else if(s){var ie=[],Q;Array.isArray(R[t.key])?(R[t.key].forEach(function(z){var X=$e((z||"").split(";")).filter(Boolean);ie=ie.concat(X),Q?Q=Q.filter(W=>X.includes(W)):Q=X}),ie=$e(ie).filter(Boolean)):(ie=$e((R[t.key]||"").split(";")).filter(Boolean),Q=ie),g=ie.map(function(z){return{key:z,value:T(z),isMixed:!Q.includes(z)}});var re=Z9(Q.join(";"));U=e.maxCharsForTagValue()-re,re>0&&(U-=1)}U=Math.max(0,U);var ve=s&&!Array.isArray(R[t.key]),de=k(m,g);u.data(de);var we=!l&&!de.length||U<=0;d.selectAll(".chiplist .input-wrap").style("display",we?"none":null);var ne=d.selectAll(".chip").data(g);ne.exit().remove();var Ie=ne.enter().insert("li",".input-wrap").attr("class","chip");Ie.append("span"),Ie.append("a"),ne=ne.merge(Ie).order().classed("raw-value",function(z){var X=z.key;return i&&(X=X.replace(t.key,"")),!t.hasTextForStringId("options."+X)}).classed("draggable",ve).classed("mixed",function(z){return z.isMixed}).attr("title",function(z){return z.isMixed?S("inspector.unshared_value_tooltip"):null}),ve&&B(ne),ne.select("span").html(function(z){return z.value}),ne.select("a").attr("href","#").on("click",F).attr("class","remove").text(function(z){return y[0]&&D(y[0])&&t.key==="source"&&(z.value==="digitalglobe"||z.value==="maxar")?"":"\xD7"})}else{var at=Array.isArray(R[t.key]),Et=at&&R[t.key].map(function(z){return T(z)}).filter(Boolean),$t=!at&&R[t.key]&&!(t.type==="typeCombo"&&R[t.key]==="yes"),Pt=$t&&!t.hasTextForStringId("options."+R[t.key]),J=$t&&!Pt,V=!l||J;De(p,at?"":T(R[t.key])).classed("raw-value",Pt).classed("known-value",J).attr("readonly",V?"readonly":void 0).attr("title",at?Et.join(`
`):void 0).attr("placeholder",at?S("inspector.multiple_values"):_||"").classed("mixed",at).on("keydown.deleteCapture",function(z){if(V&&J&&(z.keyCode===rt.keyCodes["\u232B"]||z.keyCode===rt.keyCodes["\u2326"])){z.preventDefault(),z.stopPropagation();var X={};X[t.key]=void 0,r.call("change",this,X)}})}};function B(R){var U,G;R.call(V4().on("start",function($){U={x:$.x,y:$.y},G=null}).on("drag",function($){var q=$.x-U.x,ie=$.y-U.y;if(!(!H(this).classed("dragging")&&Math.sqrt(Math.pow(q,2)+Math.pow(ie,2))<=5)){var Q=R.nodes().indexOf(this);H(this).classed("dragging",!0),G=null;var re=null,ve=H(this).node().offsetWidth;t.key==="destination"||t.key==="via"?d.selectAll(".chip").style("transform",function(de,we){var ne=H(this).node();return Q===we?"translate("+q+"px, "+ie+"px)":we>Q&&$.y>ne.offsetTop?((G===null||we>G)&&(G=we),"translateY(-100%)"):we<Q&&$.y<ne.offsetTop+ne.offsetHeight?((G===null||we<G)&&(G=we),"translateY(100%)"):null}):d.selectAll(".chip").each(function(de,we){var ne=H(this).node();Q!==we&&$.x<ne.offsetLeft+ne.offsetWidth+5&&$.x>ne.offsetLeft&&$.y<ne.offsetTop+ne.offsetHeight&&$.y>ne.offsetTop&&(G=we,re=ne.offsetTop)}).style("transform",function(de,we){var ne=H(this).node();if(Q===we)return"translate("+q+"px, "+ie+"px)";if(ne.offsetTop===re){if(we<Q&&we>=G)return"translateX("+ve+"px)";if(we>Q&&we<=G)return"translateX(-"+ve+"px)"}return null})}}).on("end",function(){if(H(this).classed("dragging")){var $=R.nodes().indexOf(this);if(H(this).classed("dragging",!1),d.selectAll(".chip").style("transform",null),typeof G=="number"){var q=g[$];g.splice($,1),g.splice(G,0,q);var ie={};g.length?ie[t.key]=g.map(function(Q){return Q.key}).join(";"):ie[t.key]=void 0,r.call("change",this,ie)}U=void 0,G=void 0}}))}L.focus=function(){p.node().focus()},L.entityIDs=function(R){return arguments.length?(y=R,L):y};function O(){return y&&y.length&&vt(y,e.graph())}return ge(L,r,"on")}function Nn(t,e){var r=fe("change"),i=H(null),n=H(null),s=[],o,a={};t.type==="tel"&&Qe.get("phone_formats").then(function(g){a=g,u()}).catch(g=>console.error(g));function l(){var g=(t.id==="brand"||t.id==="network"||t.id==="operator"||t.id==="flag")&&s.length&&s.some(function(y){var v=e.graph().hasEntity(y);if(!v)return!1;if(v.tags.wikidata)return!0;var x=xe.match(v,e.graph()),_=x&&x.suggestion,b=t.id;return _&&!!v.tags[b]&&!!v.tags[b+":wikidata"]});t.locked(g)}function c(g){l();var y=t.locked(),v=g.selectAll(".form-field-input-wrap").data([0]);if(v=v.enter().append("div").attr("class","form-field-input-wrap form-field-input-"+t.type).merge(v),i=v.selectAll("input").data([0]),i=i.enter().append("input").attr("type",t.type==="identifier"||t.type==="roadheight"?"text":t.type).attr("id",t.domId).classed(t.type,!0).call(qe).merge(i),i.classed("disabled",!!y).attr("readonly",y||null).on("input",p(!0)).on("blur",p()).on("change",p()),t.type==="tel")u();else if(t.type==="number"){var x=se.textDirection()==="rtl";i.attr("type","text");var _=t.increment,b=v.selectAll(".increment, .decrement").data(x?[_,-_]:[-_,_]);b.enter().append("button").attr("class",function(w){var E=w>0?"increment":"decrement";return"form-field-button "+E}).merge(b).on("click",function(w,E){w.preventDefault();var A=i.node().value||"0",T=A.split(";");T=T.map(function(k){var C=parseFloat(k.trim(),10);return isFinite(C)?h(C+E):k.trim()}),i.node().value=T.join(";"),p()()})}else t.type==="identifier"&&t.urlFormat&&t.pattern?(i.attr("type","text"),n=v.selectAll(".foreign-id-permalink").data([0]),n.enter().append("button").call(Z("#rapid-icon-out-link")).attr("class","form-field-button foreign-id-permalink").attr("title",function(){var w=/^https?:\/\/(.{1,}?)\//.exec(t.urlFormat);if(w.length>=2&&w[1]){var E=w[1];return S("icons.view_on",{domain:E})}return""}).on("click",function(w){w.preventDefault();var E=d();if(E){var A=t.urlFormat.replace(/{value}/,encodeURIComponent(E));window.open(A,"_blank")}}).merge(n)):t.type==="url"&&(i.attr("type","text"),n=v.selectAll(".foreign-id-permalink").data([0]),n.enter().append("button").call(Z("#rapid-icon-out-link")).attr("class","form-field-button foreign-id-permalink").attr("title",()=>S("icons.visit_website")).on("click",function(w){w.preventDefault();let E=d();E&&window.open(E,"_blank")}).merge(n))}function u(){if(!(i.empty()||!Object.keys(a).length)){var g=m(),y=g&&Qa(g.center()),v=y&&a[y.toLowerCase()];v&&i.attr("placeholder",v)}}function d(){let g=De(i).trim().split(";")[0];return t.type==="url"&&g?g:t.type==="identifier"&&t.pattern?g&&g.match(new RegExp(t.pattern)):null}function h(g){return t.minValue!==void 0&&(g=Math.max(g,t.minValue)),t.maxValue!==void 0&&(g=Math.min(g,t.maxValue)),g}function p(g){return function(){var y={},v=De(i);if(g||(v=e.cleanTagValue(v)),!(!v&&Array.isArray(o[t.key]))){if(!g){if(t.type==="number"&&v){var x=v.split(";");x=x.map(function(_){var b=parseFloat(_.trim(),10);return isFinite(b)?h(b):_.trim()}),v=x.join(";")}De(i,v)}y[t.key]=v||void 0,r.call("change",this,y,g)}}}c.entityIDs=function(g){return arguments.length?(s=g,c):s},c.tags=function(g){o=g;var y=Array.isArray(g[t.key]);if(De(i,!y&&g[t.key]?g[t.key]:"").attr("title",y?g[t.key].filter(Boolean).join(`
`):void 0).attr("placeholder",y?S("inspector.multiple_values"):t.placeholder()||S("inspector.unknown")).classed("mixed",y),n&&!n.empty()){var v=!d();n.classed("disabled",v)}},c.focus=function(){var g=i.node();g&&g.focus()};function m(){return s&&s.length&&vt(s,e.graph())}return ge(c,r,"on")}function qv(t,e){var r=fe("change"),i=H(null),n;function s(l){var c=l.selectAll(".form-field-input-wrap").data([0]);c=c.enter().append("div").attr("class","form-field-input-wrap form-field-input-"+t.type).merge(c);var u=c.selectAll("ul").data([0]);u=u.enter().append("ul").attr("class","rows").merge(u),i=u.selectAll("li").data(t.keys);var d=i.enter().append("li").attr("class",function(h){return"labeled-input preset-access-"+h});d.append("span").attr("class","label preset-label-access").attr("for",function(h){return"preset-input-access-"+h}).html(function(h){return t.t.html("types."+h)}),d.append("div").attr("class","preset-input-access-wrap").append("input").attr("type","text").attr("class",function(h){return"preset-input-access preset-input-access-"+h}).call(qe).each(function(h){H(this).call(At(e,"access-"+h).data(s.options(h)))}),i=i.merge(d),c.selectAll(".preset-input-access").on("change",o).on("blur",o)}function o(l,c){var u={},d=e.cleanTagValue(De(H(this)));!d&&typeof n[c]!="string"||(u[c]=d||void 0,r.call("change",this,u))}s.options=function(l){var c=["no","permissive","private","permit","destination"];return l!=="access"&&(c.unshift("yes"),c.push("designated"),l==="bicycle"&&c.push("dismount")),c.map(function(u){return{title:t.t("options."+u+".description"),value:u}})};var a={footway:{foot:"designated",motor_vehicle:"no"},steps:{foot:"yes",motor_vehicle:"no",bicycle:"no",horse:"no"},pedestrian:{foot:"yes",motor_vehicle:"no"},cycleway:{motor_vehicle:"no",bicycle:"designated"},bridleway:{motor_vehicle:"no",horse:"designated"},path:{foot:"yes",motor_vehicle:"no",bicycle:"yes",horse:"yes"},motorway:{foot:"no",motor_vehicle:"yes",bicycle:"no",horse:"no"},trunk:{motor_vehicle:"yes"},primary:{foot:"yes",motor_vehicle:"yes",bicycle:"yes",horse:"yes"},secondary:{foot:"yes",motor_vehicle:"yes",bicycle:"yes",horse:"yes"},tertiary:{foot:"yes",motor_vehicle:"yes",bicycle:"yes",horse:"yes"},residential:{foot:"yes",motor_vehicle:"yes",bicycle:"yes",horse:"yes"},unclassified:{foot:"yes",motor_vehicle:"yes",bicycle:"yes",horse:"yes"},service:{foot:"yes",motor_vehicle:"yes",bicycle:"yes",horse:"yes"},motorway_link:{foot:"no",motor_vehicle:"yes",bicycle:"no",horse:"no"},trunk_link:{motor_vehicle:"yes"},primary_link:{foot:"yes",motor_vehicle:"yes",bicycle:"yes",horse:"yes"},secondary_link:{foot:"yes",motor_vehicle:"yes",bicycle:"yes",horse:"yes"},tertiary_link:{foot:"yes",motor_vehicle:"yes",bicycle:"yes",horse:"yes"}};return s.tags=function(l){n=l,De(i.selectAll(".preset-input-access"),function(c){return typeof l[c]=="string"?l[c]:""}).classed("mixed",function(c){return l[c]&&Array.isArray(l[c])}).attr("title",function(c){return l[c]&&Array.isArray(l[c])&&l[c].filter(Boolean).join(`
`)}).attr("placeholder",function(c){if(l[c]&&Array.isArray(l[c]))return S("inspector.multiple_values");if(c==="access")return"yes";if(l.access&&typeof l.access=="string")return l.access;if(l.highway)if(typeof l.highway=="string"){if(a[l.highway]&&a[l.highway][c])return a[l.highway][c]}else{var u=l.highway.filter(Boolean).map(function(d){return a[d]&&a[d][c]}).filter(Boolean);if(u.length===l.highway.length&&new Set(u).size===1)return u[0]}return t.placeholder()})},s.focus=function(){i.selectAll(".preset-input-access").node().focus()},ge(s,r,"on")}function Yv(t,e){var r=fe("change"),i=H(null),n=H(null),s=xe.field("address"),o=[],a,l,c=[{format:[["housenumber","street"],["city","postcode"]]}];Qe.get("address_formats").then(function(_){c=_,i.empty()||i.call(m)}).catch(_=>console.error(_));function u(){var _=x(),b=_.center(),w=new le(b).padByMeters(200),E=e.history().intersects(w).filter(A).map(function(T){var k=e.projection.project([(_.min[0]+_.max[0])/2,(_.min[1]+_.max[1])/2]),C=Fr(e.graph().childNodes(T),k,e.projection);return{title:T.tags.name,value:T.tags.name,dist:C.distance}}).sort(function(T,k){return T.dist-k.dist});return ac(E,"value");function A(T){return T.tags.highway&&T.tags.name&&T.type==="way"}}function d(){var _=x(),b=_.center(),w=new le(b).padByMeters(200),E=e.history().intersects(w).filter(A).map(function(T){return{title:T.tags["addr:city"]||T.tags.name,value:T.tags["addr:city"]||T.tags.name,dist:Tt(T.extent(e.graph()).center(),b)}}).sort(function(T,k){return T.dist-k.dist});return ac(E,"value");function A(T){return!!(T.tags.name&&(T.tags.admin_level==="8"&&T.tags.boundary==="administrative"||T.tags.border_type==="city"||T.tags.place==="city"||T.tags.place==="town"||T.tags.place==="village")||T.tags["addr:city"])}}function h(_){var b=x(),w=b.center(),E=new le(w).padByMeters(200),A=e.history().intersects(E).filter(function(k){return o.indexOf(k.id)===-1&&k.tags[_]}).map(function(T){return{title:T.tags[_],value:T.tags[_],dist:Tt(T.extent(e.graph()).center(),w)}}).sort(function(T,k){return T.dist-k.dist});return ac(A,"value")}function p(){if(!l)return;for(var _,b=0;b<c.length;b++){var w=c[b];if(!w.countryCodes)_=w;else if(w.countryCodes.indexOf(l)!==-1){_=w;break}}var E=_.dropdowns||["city","county","country","district","hamlet","neighbourhood","place","postcode","province","quarter","state","street","subdistrict","suburb"],A=_.widths||{housenumber:1/3,street:2/3,city:2/3,state:1/4,postcode:1/3};function T(I){var P=I.reduce(function(N,M){return N+(A[M]||.5)},0);return I.map(function(N){return{id:N,width:(A[N]||.5)/P}})}var k=n.selectAll(".addr-row").data(_.format,function(I){return I.toString()});k.exit().remove(),k.enter().append("div").attr("class","addr-row").selectAll("input").data(T).enter().append("input").property("type","text").call(y).attr("class",function(I){return"addr-"+I.id}).call(qe).each(C).style("width",function(I){return I.width*100+"%"});function C(I){if(E.indexOf(I.id)!==-1){var P=I.id==="street"?u:I.id==="city"?d:h;H(this).call(At(e,"address-"+I.id).minItems(1).caseSensitive(!0).fetcher(function(N,M){M(P("addr:"+I.id))}))}}n.selectAll("input").on("blur",g()).on("change",g()),n.selectAll("input:not(.combobox-input)").on("input",g(!0)),a&&v(a)}function m(_){i=_,n=_.selectAll(".form-field-input-wrap").data([0]),n=n.enter().append("div").attr("class","form-field-input-wrap form-field-input-"+t.type).merge(n);var b=x();if(b){var w;if(e.inIntro())w=S("intro.graph.countrycode");else{var E=b.center();w=Qa(E)}w&&(l=w.toLowerCase(),p())}}function g(_){return function(){var b={};n.selectAll("input").each(function(w){var E=t.key+":"+w.id,A=this.value;_||(A=e.cleanTagValue(A)),!(Array.isArray(a[E])&&!A)&&(b[E]=A||void 0)}),r.call("change",this,b,_)}}function y(_){return _.attr("placeholder",function(b){if(a&&Array.isArray(a[t.key+":"+b.id]))return S("inspector.multiple_values");if(l){var w=b.id+"!"+l,E=s.hasTextForStringId("placeholders."+w)?w:b.id;return s.t("placeholders."+E)}})}function v(_){De(n.selectAll("input"),function(b){var w=_[t.key+":"+b.id];return typeof w=="string"?w:""}).attr("title",function(b){var w=_[t.key+":"+b.id];return w&&Array.isArray(w)&&w.filter(Boolean).join(`
`)}).classed("mixed",function(b){return Array.isArray(_[t.key+":"+b.id])}).call(y)}function x(){return o&&o.length&&vt(o,e.graph())}return m.entityIDs=function(_){return arguments.length?(o=_,m):o},m.tags=function(_){a=_,v(_)},m.focus=function(){var _=n.selectAll("input").node();_&&_.focus()},ge(m,r,"on")}function Qv(t,e){var r=fe("change"),i=H(null),n=H(null),s;function o(l){function c(p){return p.replace(":","")}n=l.selectAll(".form-field-input-wrap").data([0]),n=n.enter().append("div").attr("class","form-field-input-wrap form-field-input-"+t.type).merge(n);var u=n.selectAll("ul").data([0]);u=u.enter().append("ul").attr("class","rows").merge(u);var d=["cycleway:left","cycleway:right"];i=u.selectAll("li").data(d);var h=i.enter().append("li").attr("class",function(p){return"labeled-input preset-cycleway-"+c(p)});h.append("span").attr("class","label preset-label-cycleway").attr("for",function(p){return"preset-input-cycleway-"+c(p)}).html(function(p){return t.t.html("types."+p)}),h.append("div").attr("class","preset-input-cycleway-wrap").append("input").attr("type","text").attr("class",function(p){return"preset-input-cycleway preset-input-"+c(p)}).call(qe).each(function(p){H(this).call(At(e,"cycleway-"+c(p)).data(o.options(p)))}),i=i.merge(h),n.selectAll(".preset-input-cycleway").on("change",a).on("blur",a)}function a(l,c){var u=e.cleanTagValue(De(H(this)));if(!(!u&&(Array.isArray(s.cycleway)||Array.isArray(s[c])))){(u==="none"||u==="")&&(u=void 0);var d=c==="cycleway:left"?"cycleway:right":"cycleway:left",h=typeof s.cycleway=="string"?s.cycleway:s[d];h&&Array.isArray(h)&&(h=h[0]),(h==="none"||h==="")&&(h=void 0);var p={};u===h?p={cycleway:u,"cycleway:left":void 0,"cycleway:right":void 0}:(p={cycleway:void 0},p[c]=u,p[d]=h),r.call("change",this,p)}}return o.options=function(){return t.options.map(function(l){return{title:t.t("options."+l+".description"),value:l}})},o.tags=function(l){s=l;var c=typeof l.cycleway=="string"&&l.cycleway;De(i.selectAll(".preset-input-cycleway"),function(u){return c||(!l.cycleway&&typeof l[u]=="string"?l[u]:"")}).attr("title",function(u){if(Array.isArray(l.cycleway)||Array.isArray(l[u])){var d=[];return Array.isArray(l.cycleway)&&(d=d.concat(l.cycleway)),Array.isArray(l[u])&&(d=d.concat(l[u])),d.filter(Boolean).join(`
`)}return null}).attr("placeholder",function(u){return Array.isArray(l.cycleway)||Array.isArray(l[u])?S("inspector.multiple_values"):t.placeholder()}).classed("mixed",function(u){return Array.isArray(l.cycleway)||Array.isArray(l[u])})},o.focus=function(){var l=n.selectAll("input").node();l&&l.focus()},ge(o,r,"on")}function G9(t,e){var r=fe("change"),i=40,n=200,s=[];function o(a){var l=e.entity(s[0]).lanes();if(!e.container().select(".inspector-wrap.inspector-hidden").empty()||!a.node().parentNode){a.call(o.off);return}var c=a.selectAll(".form-field-input-wrap").data([0]);c=c.enter().append("div").attr("class","form-field-input-wrap form-field-input-"+t.type).merge(c);var u=c.selectAll(".surface").data([0]),d=io(c),h=d[0]-l.lanes.length*i*1.5+i*.5;u=u.enter().append("svg").attr("width",d[0]).attr("height",300).attr("class","surface").merge(u);var p=u.selectAll(".lanes").data([0]);p=p.enter().append("g").attr("class","lanes").merge(p),p.attr("transform",function(){return"translate("+h/2+", 0)"});var m=p.selectAll(".lane").data(l.lanes);m.exit().remove();var g=m.enter().append("g").attr("class","lane");g.append("g").append("rect").attr("y",50).attr("width",i).attr("height",n),g.append("g").attr("class","forward").append("text").attr("y",40).attr("x",14).html("\u25B2"),g.append("g").attr("class","bothways").append("text").attr("y",40).attr("x",14).html("\u25B2\u25BC"),g.append("g").attr("class","backward").append("text").attr("y",40).attr("x",14).html("\u25BC"),m=m.merge(g),m.attr("transform",function(y){return"translate("+i*y.index*1.5+", 0)"}),m.select(".forward").style("visibility",function(y){return y.direction==="forward"?"visible":"hidden"}),m.select(".bothways").style("visibility",function(y){return y.direction==="bothways"?"visible":"hidden"}),m.select(".backward").style("visibility",function(y){return y.direction==="backward"?"visible":"hidden"})}return o.entityIDs=function(a){s=a},o.tags=function(){},o.focus=function(){},o.off=function(){},ge(o,r,"on")}G9.supportsMultiselection=!1;var _4=[];function Kv(t,e){var r=fe("change","input"),i=K.wikipedia,n=H(null),s=H(null),o,a;Qe.get("languages").then(g).catch(C=>console.error(C));var l={};Qe.get("territory_languages").then(function(C){l=C}).catch(C=>console.error(C));var c=At(e,"localized-lang").fetcher(E).minItems(0),u=H(null),d=[],h=Ae().title(S.html("translate.translate")).placement("left"),p,m=[];function g(C){if(_4.length===0){var I={sr:"sr-Cyrl","sr-Cyrl":!1};for(var P in C)if(I[P]!==!1){var N=P;I[P]&&(N=I[P]),_4.push({localName:se.languageName(N,{localOnly:!0}),nativeName:C[N].nativeName,code:P,label:se.languageName(N)})}}}function y(){var C=t.id==="name"&&m.length&&m.some(function(I){var P=e.graph().hasEntity(I);if(!P)return!1;if(P.tags.wikidata||P.tags["name:etymology:wikidata"])return!0;var N=xe.match(P,e.graph());if(N){var M=N.suggestion,D=N.fields(),F=D.some(function(U){return U.id==="brand"}),L=D.some(function(U){return U.id==="operator"}),B=N.addTags.name,O=N.addTags["brand:wikidata"],R=N.addTags["operator:wikidata"];return M&&B&&(O&&!F||R&&!L)}return!1});t.locked(C)}function v(C){var I=d.map(function(F){return F.lang}),P=new Set(I.filter(Boolean));for(var N in C){var M=N.match(/^(.*):([a-z]{2,3}(?:-[A-Z][a-z]{3})?(?:-[A-Z]{2})?)$/);if(M&&M[1]===t.key&&M[2]){var D={lang:M[2],value:C[N]};P.has(D.lang)?(d[I.indexOf(D.lang)].value=D.value,P.delete(D.lang)):d.push(D)}}d.forEach(function(F){F.lang&&P.has(F.lang)&&(F.value="")})}function x(C){u=C,y();var I=t.locked(),P=C.selectAll(".form-field-input-wrap").data([0]);P=P.enter().append("div").attr("class","form-field-input-wrap form-field-input-"+t.type).merge(P),n=P.selectAll(".localized-main").data([0]),n=n.enter().append("input").attr("type","text").attr("id",t.domId).attr("class","localized-main").call(qe).merge(n),n.classed("disabled",!!I).attr("readonly",I||null).on("input",D(!0)).on("blur",D()).on("change",D());var N=P.selectAll(".localized-add").data([0]);N=N.enter().append("button").attr("class","localized-add form-field-button").call(Z("#rapid-icon-plus")).merge(N),N.classed("disabled",!!I).call(I?h.destroy:h).on("click",M),a&&!d.length&&v(a),s=C.selectAll(".localized-multilingual").data([0]),s=s.enter().append("div").attr("class","localized-multilingual").merge(s),s.call(A),s.selectAll("button, input").classed("disabled",!!I).attr("readonly",I||null);function M(F){if(F.preventDefault(),!t.locked()){var L=se.languageCode().toLowerCase(),B=d.find(function(R){return R.lang===L}),O=L.indexOf("en")>-1;(O||B)&&(L="",B=d.find(function(R){return R.lang===L})),B||(d.unshift({lang:L,value:""}),s.call(A))}}function D(F){return function(L){if(t.locked()){L.preventDefault();return}var B=De(H(this));if(F||(B=e.cleanTagValue(B)),!(!B&&Array.isArray(a[t.key]))){var O={};O[t.key]=B||void 0,r.call("change",this,O,F)}}}}function _(C){return t.key+":"+C}function b(C,I){var P={},N=De(H(this)).toLowerCase(),M=_4.find(function(L){return L.label.toLowerCase()===N||L.localName&&L.localName.toLowerCase()===N||L.nativeName&&L.nativeName.toLowerCase()===N});M&&(N=M.code),I.lang&&I.lang!==N&&(P[_(I.lang)]=void 0);var D=N&&e.cleanTagKey(_(N)),F=De(H(this.parentNode).selectAll(".localized-value"));D&&F?P[D]=F:D&&p&&p[I.lang]&&(P[D]=p[I.lang]),I.lang=N,r.call("change",this,P)}function w(C,I){if(I.lang){var P=e.cleanTagValue(De(H(this)))||void 0;if(!(!P&&Array.isArray(I.value))){var N={};N[_(I.lang)]=P,I.value=P,r.call("change",this,N)}}}function E(C,I){var P=C.toLowerCase(),N=[se.localeCode(),se.languageCode()];o&&l[o]&&(N=N.concat(l[o]));var M=[];N.forEach(function(D){var F=_4.find(function(L){return L.code===D});F&&M.push(F)}),M=$e(M.concat(_4)),I(M.filter(function(D){return D.label.toLowerCase().indexOf(P)>=0||D.localName&&D.localName.toLowerCase().indexOf(P)>=0||D.nativeName&&D.nativeName.toLowerCase().indexOf(P)>=0||D.code.toLowerCase().indexOf(P)>=0}).map(function(D){return{value:D.label}}))}function A(C){var I=C.selectAll("div.entry").data(d,function(N){return N.lang});I.exit().style("top","0").style("max-height","240px").transition().duration(200).style("opacity","0").style("max-height","0px").remove();var P=I.enter().append("div").attr("class","entry").each(function(N,M){var D=H(this),F=ss(M),L=D.append("label").attr("class","field-label").attr("for",F),B=L.append("span").attr("class","label-text");B.append("span").attr("class","label-textvalue").html(S.html("translate.localized_translation_label")),B.append("span").attr("class","label-textannotation"),L.append("button").attr("class","remove-icon-multilingual").on("click",function(O,R){if(!t.locked()){O.preventDefault(),d.splice(d.indexOf(R),1);var U=R.lang&&_(R.lang);if(U&&U in a){delete a[U];var G={};G[U]=void 0,r.call("change",this,G);return}A(C)}}).call(Z("#rapid-operation-delete")),D.append("input").attr("class","localized-lang").attr("id",F).attr("type","text").attr("placeholder",S("translate.localized_translation_language")).on("blur",b).on("change",b).call(c),D.append("input").attr("type","text").attr("class","localized-value").on("blur",w).on("change",w)});P.style("margin-top","0px").style("max-height","0px").style("opacity","0").transition().duration(200).style("margin-top","10px").style("max-height","240px").style("opacity","1").on("end",function(){H(this).style("max-height","").style("overflow","visible")}),I=I.merge(P),I.order(),I.classed("present",!0),De(I.select(".localized-lang"),function(N){var M=_4.find(function(D){return D.code===N.lang});return M?M.label:N.lang}),De(I.select(".localized-value"),function(N){return typeof N.value=="string"?N.value:""}).attr("title",function(N){return Array.isArray(N.value)?N.value.filter(Boolean).join(`
`):null}).attr("placeholder",function(N){return Array.isArray(N.value)?S("inspector.multiple_values"):S("translate.localized_translation_name")}).classed("mixed",function(N){return Array.isArray(N.value)})}x.tags=function(C){if(a=C,typeof C.wikipedia=="string"&&!p){p={};var I=C.wikipedia.match(/([^:]+):(.+)/);I&&I[0]&&I[1]&&i.translations(I[1],I[2],function(N,M){N||!M||(p=M)})}var P=Array.isArray(C[t.key]);De(n,typeof C[t.key]=="string"?C[t.key]:"").attr("title",P?C[t.key].filter(Boolean).join(`
`):void 0).attr("placeholder",P?S("inspector.multiple_values"):t.placeholder()).classed("mixed",P),v(C),u.call(x)},x.focus=function(){n.node().focus()},x.entityIDs=function(C){return arguments.length?(m=C,d=[],T(),x):m};function T(){var C=k(),I=C&&Qa(C.center());o=I&&I.toLowerCase()}function k(){return m&&m.length&&vt(m,e.graph())}return ge(x,r,"on")}function Zv(t,e){var r=fe("change"),i=H(null),n=H(null),s=[],o,a,l=At(e,"roadspeed"),c=At(e,"roadspeed-unit").data(["km/h","mph"].map(m)),u=[20,30,40,50,60,70,80,90,100,110,120],d=[5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80];function h(v){var x=v.selectAll(".form-field-input-wrap").data([0]);x=x.enter().append("div").attr("class","form-field-input-wrap form-field-input-"+t.type).merge(x),n=x.selectAll("input.roadspeed-number").data([0]),n=n.enter().append("input").attr("type","text").attr("class","roadspeed-number").attr("id",t.domId).call(qe).call(l).merge(n),n.on("change",g).on("blur",g);var _=y().center();a=iE(_)==="mph",i=x.selectAll("input.roadspeed-unit").data([0]),i=i.enter().append("input").attr("type","text").attr("class","roadspeed-unit").call(c).merge(i),i.on("blur",b).on("change",b);function b(){a=De(i)==="mph",De(i,a?"mph":"km/h"),p(),g()}}function p(){l.data((a?d:u).map(m)),De(i,a?"mph":"km/h")}function m(v){return{value:v.toString(),title:v.toString()}}function g(){var v={},x=De(n).trim();!x&&Array.isArray(o[t.key])||(x?isNaN(x)||!a?v[t.key]=e.cleanTagValue(x):v[t.key]=e.cleanTagValue(x+" mph"):v[t.key]=void 0,r.call("change",this,v))}h.tags=function(v){o=v;var x=v[t.key],_=Array.isArray(x);_||(x&&x.indexOf("mph")>=0?(x=parseInt(x,10).toString(),a=!0):x&&(a=!1)),p(),De(n,typeof x=="string"?x:"").attr("title",_?x.filter(Boolean).join(`
`):null).attr("placeholder",_?S("inspector.multiple_values"):t.placeholder()).classed("mixed",_)},h.focus=function(){n.node().focus()},h.entityIDs=function(v){s=v};function y(){return s&&s.length&&vt(s,e.graph())}return ge(h,r,"on")}function N5(t,e){var r=fe("change"),i=H(null),n=H(null),s=H(null),o=H(null),a=(t.options||t.keys).slice(),l,c,u={},d=[];function h(){var x=n.selectAll(".form-field-input-radio label.active input");return!x.empty()&&x.datum()}function p(x){x.classed("preset-radio",!0),n=x.selectAll(".form-field-input-wrap").data([0]);var _=n.enter().append("div").attr("class","form-field-input-wrap form-field-input-radio");_.append("span").attr("class","placeholder"),n=n.merge(_),i=n.selectAll(".placeholder"),s=n.selectAll("label").data(a),_=s.enter().append("label"),_.append("input").attr("type","radio").attr("name",t.id).attr("value",function(b){return t.t("options."+b,{default:b})}).attr("checked",!1),_.append("span").html(function(b){return t.t.html("options."+b,{default:b})}),s=s.merge(_),o=s.selectAll("input").on("change",v)}function m(x,_){var b=h()||_.layer!==void 0,w=xe.field(b),E=xe.field("layer"),A=b==="bridge"||b==="tunnel"||_.layer!==void 0,T=x.selectAll(".structure-extras-wrap").data(b?[0]:[]);T.exit().remove(),T=T.enter().append("div").attr("class","structure-extras-wrap").merge(T);var k=T.selectAll("ul").data([0]);k=k.enter().append("ul").attr("class","rows").merge(k),w?((!l||l.id!==b)&&(l=vs(e,w,d,{wrap:!1}).on("change",g)),l.tags(_)):l=null;var C=k.selectAll(".structure-type-item").data(l?[l]:[],function(M){return M.id});C.exit().remove();var I=C.enter().insert("li",":first-child").attr("class","labeled-input structure-type-item");I.append("span").attr("class","label structure-label-type").attr("for","preset-input-"+b).html(S.html("inspector.radio.structure.type")),I.append("div").attr("class","structure-input-type-wrap"),C=C.merge(I),l&&C.selectAll(".structure-input-type-wrap").call(l.render),E&&A?(c||(c=vs(e,E,d,{wrap:!1}).on("change",y)),c.tags(_),t.keys=jt(t.keys,["layer"])):(c=null,t.keys=t.keys.filter(function(M){return M!=="layer"}));var P=k.selectAll(".structure-layer-item").data(c?[c]:[]);P.exit().remove();var N=P.enter().append("li").attr("class","labeled-input structure-layer-item");N.append("span").attr("class","label structure-label-layer").attr("for","preset-input-layer").html(S.html("inspector.radio.structure.layer")),N.append("div").attr("class","structure-input-layer-wrap"),P=P.merge(N),c&&P.selectAll(".structure-input-layer-wrap").call(c.render)}function g(x,_){var b=h();if(b){var w=x[b];w!=="no"&&(u[b]=w),t.type==="structureRadio"&&((w==="no"||b!=="bridge"&&b!=="tunnel"||b==="tunnel"&&w==="building_passage")&&(x.layer=void 0),x.layer===void 0&&(b==="bridge"&&w!=="no"&&(x.layer="1"),b==="tunnel"&&w!=="no"&&w!=="building_passage"&&(x.layer="-1"))),r.call("change",this,x,_)}}function y(x,_){x.layer==="0"&&(x.layer=void 0),r.call("change",this,x,_)}function v(){var x={},_;t.key&&(x[t.key]=void 0),o.each(function(b){var w=H(this).property("checked");if(w&&(_=b),t.key)w&&(x[t.key]=b);else{var E=u[_]||"yes";x[b]=w?E:void 0}}),t.type==="structureRadio"&&(_==="bridge"?x.layer="1":_==="tunnel"&&x.tunnel!=="building_passage"?x.layer="-1":x.layer=void 0),r.call("change",this,x)}return p.tags=function(x){o.property("checked",function(w){return t.key?x[t.key]===w:typeof x[w]=="string"&&x[w].toLowerCase()!=="no"});function _(w){return t.key?Array.isArray(x[t.key])&&x[t.key].includes(w):Array.isArray(x[w])}s.classed("active",function(w){return t.key?Array.isArray(x[t.key])&&x[t.key].includes(w)||x[t.key]===w:Array.isArray(x[w])||!!(x[w]&&x[w].toLowerCase()!=="no")}).classed("mixed",_).attr("title",function(w){return _(w)?S("inspector.unshared_value_tooltip"):null});var b=o.filter(function(){return this.checked});b.empty()?i.html(S.html("inspector.none")):(i.html(b.attr("value")),u[b.datum()]=x[b.datum()]),t.type==="structureRadio"&&(x.waterway&&!u.tunnel&&(u.tunnel="culvert"),n.call(m,x))},p.focus=function(){o.node().focus()},p.entityIDs=function(x){return arguments.length?(d=x,u={},p):d},p.isAllowed=function(){return d.length===1},ge(p,r,"on")}function Jv(t,e){var r=fe("change"),i=H(null),n;function s(a){var l=a.selectAll(".form-field-input-wrap").data([0]);l=l.enter().append("div").attr("class","form-field-input-wrap form-field-input-"+t.type).merge(l),i=l.selectAll("textarea").data([0]),i=i.enter().append("textarea").attr("id",t.domId).call(qe).on("input",o(!0)).on("blur",o()).on("change",o()).merge(i)}function o(a){return function(){var l=De(i);if(a||(l=e.cleanTagValue(l)),!(!l&&Array.isArray(n[t.key]))){var c={};c[t.key]=l||void 0,r.call("change",this,c,a)}}}return s.tags=function(a){n=a;var l=Array.isArray(a[t.key]);De(i,!l&&a[t.key]?a[t.key]:"").attr("title",l?a[t.key].filter(Boolean).join(`
`):void 0).attr("placeholder",l?S("inspector.multiple_values"):t.placeholder()||S("inspector.unknown")).classed("mixed",l)},s.focus=function(){i.node().focus()},ge(s,r,"on")}function ex(t,e){var r=K.wikidata,i=fe("change"),n=H(null),s=H(null),o=null,a=null,l="",c=[],u=t.keys&&t.keys.find(function(x){return x.includes("wikipedia")}),d=t.key==="wikidata"?"name":t.key.split(":")[0],h=At(e,"combo-"+t.safeid).caseSensitive(!0).minItems(1);function p(x){n=x;var _=x.selectAll(".form-field-input-wrap").data([0]);_=_.enter().append("div").attr("class","form-field-input-wrap form-field-input-"+t.type).merge(_);var b=_.selectAll("ul").data([0]);b=b.enter().append("ul").attr("class","rows").merge(b);var w=b.selectAll("li.wikidata-search").data([0]),E=w.enter().append("li").attr("class","wikidata-search");E.append("input").attr("type","text").attr("id",t.domId).style("flex","1").call(qe).on("focus",function(){var C=H(this).node();C.setSelectionRange(0,C.value.length)}).on("blur",function(){y()}).call(h.fetcher(m)),h.on("accept",function(C){C&&(o=C.id,g())}).on("cancel",function(){y()}),E.append("button").attr("class","form-field-button wiki-link").attr("title",S("icons.view_on",{domain:"wikidata.org"})).call(Z("#rapid-icon-out-link")).on("click",function(C){C.preventDefault(),l&&window.open(l,"_blank")}),w=w.merge(E),s=w.select("input");var A=["description","identifier"],T=b.selectAll("li.labeled-input").data(A),k=T.enter().append("li").attr("class",function(C){return"labeled-input preset-wikidata-"+C});k.append("span").attr("class","label").html(function(C){return S.html("wikidata."+C)}),k.append("input").attr("type","text").call(qe).classed("disabled","true").attr("readonly","true"),k.append("button").attr("class","form-field-button").attr("title",S("icons.copy")).call(Z("#rapid-operation-copy")).on("click",function(C){C.preventDefault(),H(this.parentNode).select("input").node().select(),document.execCommand("copy")})}function m(x,_){if(!x&&d)for(var b in c){var w=e.hasEntity(c[b]);if(w.tags[d]){x=w.tags[d];break}}r.itemsForSearchQuery(x,function(E,A){if(!E){var T=A.map(function(k){return{id:k.id,value:k.label+" ("+k.id+")",title:k.description,terms:k.aliases}});_&&_(T)}})}function g(){var x={};x[t.key]=o,i.call("change",this,x);var _=e.graph(),b=c;r.entityByQID(o,function(w,E){if(!w&&e.graph()===_&&E.sitelinks){var A=r.languagesToQuery();["labels","descriptions"].forEach(function(L){if(E[L]){var B=Object.keys(E[L]);if(B.length!==0){var O=B[0];A.indexOf(O)===-1&&A.push(O)}}});var T;if(u){var k;for(var C in A){var I=A[C],P=I.replace("-","_")+"wiki";if(E.sitelinks[P]){k=!0,T=I+":"+E.sitelinks[P].title;break}}if(!k){var N=Object.keys(E.sitelinks).filter(function(L){return L.endsWith("wiki")});if(N.length===0)T=null;else{var M=N[0].slice(0,-4).replace("_","-"),D=E.sitelinks[N[0]].title;T=M+":"+D}}}if(T&&(T=e.cleanTagValue(T)),!(typeof T>"u")){var F=b.map(function(L){var B=e.hasEntity(L);if(!B)return null;var O=Object.assign({},B.tags);if(T===null){if(!O[u])return null;delete O[u]}else O[u]=T;return er(L,O)}).filter(Boolean);F.length&&e.overwrite(function(B){return F.forEach(function(O){B=O(B)}),B},e.history().undoAnnotation())}}})}function y(){var x="";a&&(x=v(a,"labels"),x.length===0&&(x=a.id.toString())),De(s,x)}p.tags=function(x){var _=Array.isArray(x[t.key]);if(s.attr("title",_?x[t.key].filter(Boolean).join(`
`):null).attr("placeholder",_?S("inspector.multiple_values"):"").classed("mixed",_),o=typeof x[t.key]=="string"&&x[t.key]||"",!/^Q[0-9]*$/.test(o)){b();return}l="https://wikidata.org/wiki/"+o,r.entityByQID(o,function(w,E){if(w){b();return}a=E,y();var A=v(E,"descriptions");n.select("button.wiki-link").classed("disabled",!1),n.select(".preset-wikidata-description").style("display",function(){return A.length>0?"flex":"none"}).select("input").attr("value",A),n.select(".preset-wikidata-identifier").style("display",function(){return E.id?"flex":"none"}).select("input").attr("value",E.id)});function b(){a=null,y(),n.select(".preset-wikidata-description").style("display","none"),n.select(".preset-wikidata-identifier").style("display","none"),n.select("button.wiki-link").classed("disabled",!0),o&&o!==""?l="https://wikidata.org/wiki/Special:Search?search="+o:l=""}};function v(x,_){if(!x[_])return"";var b=x[_],w=Object.keys(b);if(w.length===0)return"";var E=r.languagesToQuery();for(var A in E){var T=E[A],k=b[T];if(k&&k.value&&k.value.length>0)return k.value}return b[w[0]].value}return p.entityIDs=function(x){return arguments.length?(c=x,p):c},p.focus=function(){s.node().focus()},ge(p,i,"on")}function z9(t,e){let r=fe("change"),i=K.wikipedia,n=K.wikidata,s=H(null),o=H(null),a="",l,c,u=[];Qe.get("wmf_sitematrix").then(_=>{u=_,c&&x(c)}).catch(_=>console.error(_));let d=At(e,"wikipedia-lang").fetcher((_,b)=>{let w=_.toLowerCase();b(u.filter(E=>E[0].toLowerCase().indexOf(w)>=0||E[1].toLowerCase().indexOf(w)>=0||E[2].toLowerCase().indexOf(w)>=0).map(E=>({value:E[1]})))}),h=At(e,"wikipedia-title").fetcher((_,b)=>{if(!_){_="";for(let E in l){let A=e.hasEntity(l[E]);if(A.tags.name){_=A.tags.name;break}}}(_.length>7?i.search:i.suggestions)(g()[2],_,(E,A)=>{b(A.map(T=>({value:T})))})});function p(_){let b=_.selectAll(".form-field-input-wrap").data([0]);b=b.enter().append("div").attr("class",`form-field-input-wrap form-field-input-${t.type}`).merge(b);let w=b.selectAll(".wiki-lang-container").data([0]);w=w.enter().append("div").attr("class","wiki-lang-container").merge(w),s=w.selectAll("input.wiki-lang").data([0]),s=s.enter().append("input").attr("type","text").attr("class","wiki-lang").attr("placeholder",S("translate.localized_translation_language")).call(qe).call(d).merge(s),s.on("blur",y).on("change",y);let E=b.selectAll(".wiki-title-container").data([0]);E=E.enter().append("div").attr("class","wiki-title-container").merge(E),o=E.selectAll("input.wiki-title").data([0]),o=o.enter().append("input").attr("type","text").attr("class","wiki-title").attr("id",t.domId).call(qe).call(h).merge(o),o.on("blur",function(){v(!0)}).on("change",function(){v(!1)});let A=E.selectAll(".wiki-link").data([0]);A=A.enter().append("button").attr("class","form-field-button wiki-link").attr("title",S("icons.view_on",{domain:"wikipedia.org"})).call(Z("#rapid-icon-out-link")).merge(A),A.on("click",T=>{T.preventDefault(),a&&window.open(a,"_blank")})}function m(_){let b=se.languageCode().toLowerCase();for(let w in u){let E=u[w];if(E[2]===b)return E}return _?["","",""]:["English","English","en"]}function g(_){let b=De(s).toLowerCase();for(let w in u){let E=u[w];if(E[0].toLowerCase()===b||E[1].toLowerCase()===b||E[2]===b)return E}return m(_)}function y(){De(s,g()[1]),v(!0)}function v(_){let b=De(o),w=b.match(/https?:\/\/([-a-z]+)\.wikipedia\.org\/(?:wiki|\1-[-a-z]+)\/([^#]+)(?:#(.+))?/),E=w&&u.find(C=>w[1]===C[2]),A={};if(E){let C=E[1];if(b=decodeURIComponent(w[2]).replace(/_/g," "),w[3]){let I;I=decodeURIComponent(w[3]),b+="#"+I.replace(/_/g," ")}b=b.slice(0,1).toUpperCase()+b.slice(1),De(s,C),De(o,b)}if(b?A.wikipedia=e.cleanTagValue(g()[2]+":"+b):A.wikipedia=void 0,r.call("change",this,A),_||!b||!g()[2])return;let T=e.graph(),k=l;n.itemsByTitle(g()[2],b,(C,I)=>{if(C||!I||!Object.keys(I).length||e.graph()!==T)return;let P=Object.keys(I),N=P&&P.find(D=>D.match(/^Q\d+$/)),M=k.map(D=>{let F=e.entity(D).tags,L=Object.assign({},F);return L.wikidata!==N?(L.wikidata=N,er(D,L)):null}).filter(Boolean);M.length&&e.overwrite(function(F){return M.forEach(function(L){F=L(F)}),F},e.history().undoAnnotation())})}p.tags=_=>{c=_,x(_)};function x(_){let b=typeof _[t.key]=="string"?_[t.key]:"",w=b.match(/([^:]+):([^#]+)(?:#(.+))?/),E=w&&w[1],A=w&&w[2],T=w&&w[3],k=E&&u.find(C=>E===C[2]);if(k){let C=k[1];if(De(s,C),De(o,A+(T?"#"+T:"")),T)try{T=encodeURIComponent(T.replace(/ /g,"_")).replace(/%/g,".")}catch{T=T.replace(/ /g,"_")}a="https://"+E+".wikipedia.org/wiki/"+A.replace(/ /g,"_")+(T?"#"+T:"")}else if(De(o,b),b&&b!=="")De(s,""),a=`https://${m()[2]}.wikipedia.org/w/index.php?fulltext=1&search=${b}`;else{let C=g(!0);De(s,C[1]),a=""}}return p.entityIDs=_=>arguments.length?(l=_,p):l,p.focus=()=>{o.node().focus()},ge(p,r,"on")}z9.supportsMultiselection=!1;var S0={access:qv,address:Yv,check:Kl,combo:is,cycleway:Qv,defaultCheck:Kl,email:Nn,identifier:Nn,lanes:G9,localized:Kv,roadspeed:Zv,roadheight:Nn,manyCombo:is,multiCombo:is,networkCombo:is,number:Nn,onewayCheck:Kl,radio:N5,semiCombo:is,structureRadio:N5,tel:Nn,text:Nn,textarea:Jv,typeCombo:is,url:Nn,wikidata:ex,wikipedia:z9};var xe=jM();var cV=!0,$M={"roentgen-buses":"temaki-bus","roentgen-city_limit_sign":"maki-information","roentgen-crane":"temaki-crane","roentgen-crane_gantry":"temaki-crane","roentgen-crane_portal":"temaki-crane","roentgen-diving_1_platforms":"temaki-diving","roentgen-pole_dancer":"temaki-money_hand","roentgen-slide":"temaki-slide","roentgen-slide_and_water":"temaki-slide","roentgen-turning_loop":"maki-circle"};function jM(){let t=fe("favoritePreset","recentsChange"),e=30,r=6,i=Yl("point",{name:"Point",tags:{},geometry:["point","vertex"],matchScore:.1}),n=Yl("line",{name:"Line",tags:{},geometry:["line"],matchScore:.1}),s=Yl("area",{name:"Area",tags:{area:"yes"},geometry:["area"],matchScore:.1}),o=Yl("relation",{name:"Relation",tags:{},geometry:["relation"],matchScore:.1}),a=Ii([i,n,s,o]),l={point:i,line:n,area:s,relation:o},c={point:Ii([i]),vertex:Ii([i]),line:Ii([n]),area:Ii([s]),relation:Ii([o])},u={},d={},h=[],p=null,m,g,y={point:{},vertex:{},line:{},area:{},relation:{}},v;a.ensureLoaded=()=>v||(v=Promise.all([Qe.get("preset_categories"),Qe.get("preset_defaults"),Qe.get("preset_presets"),Qe.get("preset_fields")]).then(E=>{a.merge({categories:E[0],defaults:E[1],presets:E[2],fields:E[3]}),j5(a.areaKeys()),V5(a.pointTags()),X5(a.vertexTags())})),a.merge=E=>{let A=[];return E.fields&&Object.keys(E.fields).forEach(T=>{let k=E.fields[T];if(k){if(!S0[k.type]){cV&&console.warn(`"${k.type}" type not supported for ${T}`);return}k=Np(T,k,u),k.locationSet&&A.push(k),u[T]=k}else delete u[T]}),E.presets&&Object.keys(E.presets).forEach(T=>{let k=E.presets[T];if(k){let C=!p||p.has(T);k.icon&&(k.icon=k.icon.replace(/^iD-/,"rapid-")),T==="address"&&(k.icon="maki-circle-stroked"),T==="highway/crossing/traffic_signals"&&(k.icon="temaki-pedestrian_crosswalk"),$M[k.icon]&&(k.icon=$M[k.icon]),k=Yl(T,k,C,u,l),k.locationSet&&A.push(k),l[T]=k}else{let C=l[T];C&&!C.isFallback()&&delete l[T]}}),E.categories&&Object.keys(E.categories).forEach(T=>{let k=E.categories[T];k?(k.icon&&(k.icon=k.icon.replace(/^iD-/,"rapid-")),k=Rp(T,k,l),k.locationSet&&A.push(k),d[T]=k):delete d[T]}),a.collection=Object.values(l).concat(Object.values(d)),E.defaults&&Object.keys(E.defaults).forEach(T=>{let k=E.defaults[T];Array.isArray(k)?c[T]=Ii(k.map(C=>l[C]||d[C]).filter(Boolean)):delete c[T]}),h=Object.values(u).filter(T=>T.universal),Object.values(l).forEach(T=>T.resetFields()),y={point:{},vertex:{},line:{},area:{},relation:{}},a.collection.forEach(T=>{(T.geometry||[]).forEach(k=>{let C=y[k];for(let I in T.tags){C[I]=C[I]||{};let P=T.tags[I];(C[I][P]=C[I][P]||[]).push(T)}})}),E.featureCollection&&Array.isArray(E.featureCollection.features)&&wt.mergeCustomGeoJSON(E.featureCollection),A.length&&wt.mergeLocationSets(A),a},a.match=(E,A)=>A.transient(E,"presetMatch",()=>{let T=E.geometry(A);T==="vertex"&&E.isOnAddressLine(A)&&(T="point");let k=E.extent(A);return a.matchTags(E.tags,T,k.center())}),a.matchTags=(E,A,T)=>{let k=y[A],C=-1,I,P=[];for(let N in E){let M=[],D=k[N];if(!D)continue;let F=D[E[N]];F&&M.push(...F);let L=D["*"];if(L&&M.push(...L),M.length!==0)for(let B=0;B<M.length;B++){let O=M[B],R=O.matchScore(E);R!==-1&&(P.push({score:R,candidate:O}),R>C&&(C=R,I=O))}}if(I&&I.locationSetID&&I.locationSetID!=="+[Q2]"&&Array.isArray(T)){let N=wt.locationSetsAt(T);if(!N[I.locationSetID]){P.sort((M,D)=>M.score<D.score?1:-1);for(let M=0;M<P.length;M++){let D=P[M];if(!D.candidate.locationSetID||N[D.candidate.locationSetID]){I=D.candidate,C=D.score;break}}}}if(!I||I.isFallback()){for(let N in E)if(/^addr:/.test(N)&&k["addr:*"]&&k["addr:*"]["*"]){I=k["addr:*"]["*"][0];break}}return I||a.fallback(A)},a.allowsVertex=(E,A)=>E.type!=="node"?!1:Object.keys(E.tags).length===0?!0:A.transient(E,"vertexMatch",()=>{if(E.isOnAddressLine(A))return!0;let T=Ba(E.tags);return T.vertex?!0:!T.point}),a.areaKeys=()=>{let E=["barrier","highway","footway","railway","junction","type"],A={},T=a.collection.filter(k=>!k.suggestion&&!k.replacement);return T.forEach(k=>{let C=k.tags&&Object.keys(k.tags),I=C&&C.length&&C[0];I&&E.indexOf(I)===-1&&k.geometry.indexOf("area")!==-1&&(A[I]=A[I]||{})}),T.forEach(k=>{let C;for(C in k.addTags){let I=k.addTags[C];C in A&&k.geometry.indexOf("line")!==-1&&I!=="*"&&(A[C][I]=!0)}}),A},a.pointTags=()=>a.collection.reduce((E,A)=>{if(A.suggestion||A.replacement||A.searchable===!1)return E;let T=A.tags&&Object.keys(A.tags),k=T&&T.length&&T[0];return k&&A.geometry.indexOf("point")!==-1&&(E[k]=E[k]||{},E[k][A.tags[k]]=!0),E},{}),a.vertexTags=()=>a.collection.reduce((E,A)=>{if(A.suggestion||A.replacement||A.searchable===!1)return E;let T=A.tags&&Object.keys(A.tags),k=T&&T.length&&T[0];return k&&A.geometry.indexOf("vertex")!==-1&&(E[k]=E[k]||{},E[k][A.tags[k]]=!0),E},{}),a.field=E=>u[E],a.universal=()=>h,a.defaults=(E,A,T,k)=>{let C=[];T&&(C=a.recent().matchGeometry(E).collection.slice(0,r));let I;p?I=Array.from(p).map(function(N){var M=a.item(N);return M&&M.matchGeometry(E)?M:null}).filter(Boolean):I=c[E].collection.concat(a.fallback(E));let P=Ii($e(C.concat(I)).slice(0,A-1));if(Array.isArray(k)){let N=wt.locationSetsAt(k);P.collection=P.collection.filter(M=>!M.locationSetID||N[M.locationSetID])}return P},a.addablePresetIDs=function(E){return arguments.length?(Array.isArray(E)&&(E=new Set(E)),p=E,p?a.collection.forEach(A=>{A.addable&&A.addable(p.has(A.id))}):a.collection.forEach(A=>{A.addable&&A.addable(!0)}),a):p},a.recent=()=>Ii($e(a.getRecents().map(E=>E.preset)));function x(E,A){let T={};return T.preset=E,T.source=A,T.isFavorite=()=>T.source==="favorite",T.isRecent=()=>T.source==="recent",T.matches=k=>T.preset.id===k.id,T.minified=()=>({pID:T.preset.id}),T}function _(E,A){if(E&&E.pID){let T=a.item(E.pID);return T?x(T,A):null}return null}a.getGenericRibbonItems=()=>["point","line","area"].map(E=>x(a.item(E),"generic")),a.getAddable=()=>p?p.map(E=>{let A=a.item(E);return A?x(A,"addable"):null}).filter(Boolean):[];function b(E){m=E;let A=E.map(T=>T.minified());ee("preset_recents",JSON.stringify(A)),t.call("recentsChange")}a.getRecents=()=>(m||(m=(JSON.parse(ee("preset_recents"))||[]).reduce((E,A)=>{let T=_(A,"recent");return T&&T.preset.addable()&&E.push(T),E},[])),m),a.addRecent=(E,A,T)=>{let k=a.getRecents(),C=a.recentMatching(A),I=k.indexOf(C);T&&(I+=1);let P=x(E,"recent");k.splice(I,0,P),b(k)},a.removeRecent=E=>{let A=a.recentMatching(E);if(A){let T=a.getRecents();T.splice(T.indexOf(A),1),b(T)}},a.recentMatching=E=>{let A=a.getRecents();for(let T in A)if(A[T].matches(E))return A[T];return null},a.moveItem=(E,A,T)=>A===T||A<0||T<0||A>=E.length||T>=E.length?null:(E.splice(T,0,E.splice(A,1)[0]),E),a.moveRecent=(E,A)=>{let T=a.getRecents(),k=T.indexOf(E),C=T.indexOf(A),I=a.moveItem(T,k,C);I&&b(I)},a.setMostRecent=E=>{if(E.searchable===!1)return;let A=a.getRecents(),T=a.recentMatching(E);for(T?A.splice(A.indexOf(T),1):T=x(E,"recent");A.length>=e;)A.pop();A.unshift(T),b(A)};function w(E){g=E;let A=E.map(T=>T.minified());ee("preset_favorites",JSON.stringify(A)),t.call("favoritePreset")}return a.addFavorite=(E,A,T)=>{let k=a.getFavorites(),C=a.favoriteMatching(A),I=k.indexOf(C);T&&(I+=1);let P=x(E,"favorite");k.splice(I,0,P),w(k)},a.toggleFavorite=E=>{let A=a.getFavorites(),T=a.favoriteMatching(E);T?A.splice(A.indexOf(T),1):(A.length===10&&A.pop(),A.push(x(E,"favorite"))),w(A)},a.removeFavorite=E=>{let A=a.favoriteMatching(E);if(A){let T=a.getFavorites();T.splice(T.indexOf(A),1),w(T)}},a.getFavorites=()=>{if(!g){let E=JSON.parse(ee("preset_favorites"));E||(E=[],ee("preset_favorites",JSON.stringify(E))),g=E.reduce((A,T)=>{let k=_(T,"favorite");return k&&k.preset.addable()&&A.push(k),A},[])}return g},a.favoriteMatching=E=>{let A=a.getFavorites();for(let T in A)if(A[T].matches(E))return A[T];return null},ge(a,t,"on")}function vt(t,e){return t.reduce(function(r,i){var n=typeof i=="string"?e.hasEntity(i):i;if(n){var s=n.extent(e);r.min=[Math.min(r.min[0],s.min[0]),Math.min(r.min[1],s.min[1])],r.max=[Math.max(r.max[0],s.max[0]),Math.max(r.max[1],s.max[1])]}return r},new le)}function ct(t,e,r){r.surface().selectAll(z5(t,r.graph())).classed("highlighted",e)}function qt(t,e){var r="name:"+se.languageCode().toLowerCase(),i=t.tags[r]||t.tags.name||"",n={name:i,direction:t.tags.direction,from:t.tags.from,network:e?void 0:t.tags.cycle_network||t.tags.network,ref:t.tags.ref,to:t.tags.to,via:t.tags.via};if(i&&n.ref&&t.tags.route)return n.network?S("inspector.display_name.network_ref_name",n):S("inspector.display_name.ref_name",n);if(i)return i;var s=[];return n.network&&s.push("network"),n.ref&&s.push("ref"),t.tags.route&&(n.direction?s.push("direction"):n.from&&n.to&&(s.push("from"),s.push("to"),n.via&&s.push("via"))),s.length&&(i=S("inspector.display_name."+s.join("_"),n)),i}function Q6(t){let e=se.languageCode().toLowerCase(),r=t.tags;return r[`name:${e}`]??r.name??r[`brand:${e}`]??r.brand}function gs(t){return{n:S("inspector.node"),w:S("inspector.way"),r:S("inspector.relation")}[t.charAt(0)]}function ft(t,e,r){var i,n=qt(t),s=typeof e=="string"?xe.matchTags(t.tags,e):xe.match(t,e),o=s&&(s.suggestion?s.subtitle():s.name());return r?i=[o,n].filter(Boolean).join(" "):i=n||o,i||gs(t.id)}function As(t,e,r,i,n){let s=`translate3d(${e}px,${r}px,0)`,o=i?` scale(${i})`:"",a=n?` rotate(${n}deg)`:"";return t.style("transform",`${s}${o}${a}`)}function y5(t){var e=t.getBoundingClientRect(),r=e.left,i=e.top,n=+t.clientLeft,s=+t.clientTop;return function(o){return[o.clientX-r-n,o.clientY-i-s]}}function Kc(t,e){return t<0&&(t+=Math.ceil(-t/e)*e),t%e}function tr(t){return typeof t=="function"?t:function(){return t}}function qe(t){var e=t.size()&&t.node().tagName.toLowerCase()==="textarea";return t.attr("autocomplete","new-password").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck",e?"true":"false")}function De(t,e){function r(i){function n(){delete this.value}function s(){this.value!==i&&(this.value=i)}function o(){var a=i.apply(this,arguments);a==null?delete this.value:this.value!==a&&(this.value=a)}return i==null?n:typeof i=="function"?o:s}return arguments.length===1?t.property("value"):t.each(r(e))}function E0(t,e){t.each(function(){var r=document.createEvent("HTMLEvents");r.initEvent(e,!0,!0),this.dispatchEvent(r)})}function Lt(){if(this instanceof Lt)arguments.length&&this.initialize(arguments);else return new Lt().initialize(arguments)}Te.way=Lt;Lt.prototype=Object.create(Te.prototype);Object.assign(Lt.prototype,{type:"way",nodes:[],copy:function(t,e){if(e[this.id])return e[this.id];var r=Te.prototype.copy.call(this,t,e),i=this.nodes.map(function(n){return t.entity(n).copy(t,e).id});return r=r.update({nodes:i}),e[this.id]=r,r},extent:function(t){return t.transient(this,"extent",function(){return vt(this.nodes,t)})},first:function(){return this.nodes[0]},last:function(){return this.nodes[this.nodes.length-1]},contains:function(t){return this.nodes.indexOf(t)>=0},affix:function(t){if(this.nodes[0]===t)return"prefix";if(this.nodes[this.nodes.length-1]===t)return"suffix"},layer:function(){return isFinite(this.tags.layer)?Math.max(-10,Math.min(+this.tags.layer,10)):this.tags.covered==="yes"?-1:this.tags.location==="overground"?1:this.tags.location==="underground"?-1:this.tags.location==="underwater"?-10:this.tags.power==="line"||this.tags.power==="minor_line"||this.tags.aerialway?10:this.tags.bridge?1:this.tags.cutting||this.tags.tunnel||this.tags.waterway?-1:this.tags.man_made==="pipeline"||this.tags.boundary?-10:0},impliedLineWidthMeters:function(){var t={highway:{motorway:5,motorway_link:5,trunk:4.5,trunk_link:4.5,primary:4,secondary:4,tertiary:4,primary_link:4,secondary_link:4,tertiary_link:4,unclassified:4,road:4,living_street:4,bus_guideway:4,pedestrian:4,residential:3.5,service:3.5,track:3,cycleway:2.5,bridleway:2,corridor:2,steps:2,path:1.5,footway:1.5},railway:{rail:2.5,light_rail:2.5,tram:2.5,subway:2.5,monorail:2.5,funicular:2.5,disused:2.5,preserved:2.5,miniature:1.5,narrow_gauge:1.5},waterway:{river:50,canal:25,stream:5,tidal_channel:5,fish_pass:2.5,drain:2.5,ditch:1.5}};for(var e in t)if(this.tags[e]&&t[e][this.tags[e]]){var r=t[e][this.tags[e]];if(e==="highway"){var i=this.tags.lanes&&parseInt(this.tags.lanes,10);return i||(i=this.isOneWay()?1:2),r*i}return r}return null},isOneWay:function(){var t={yes:!0,1:!0,"-1":!0,reversible:!0,alternating:!0,no:!1,0:!1};if(t[this.tags.oneway]!==void 0)return t[this.tags.oneway];for(var e in this.tags)if(e in Ms&&this.tags[e]in Ms[e])return!0;return!1},sidednessIdentifier:function(){for(let t in this.tags){let e=this.tags[t],r=A4(t);if(r in C4&&e in C4[r])return C4[r][e]===!0?r:C4[r][e]}return null},isSided:function(){return this.tags.two_sided==="yes"?!1:this.sidednessIdentifier()!==null},lanes:function(){return Wf(this)},isClosed:function(){return this.nodes.length>1&&this.first()===this.last()},isConvex:function(t){if(!this.isClosed()||this.isDegenerate())return null;for(var e=$e(t.childNodes(this)),r=e.map(function(u){return u.loc}),i=0,n=0,s=0;s<r.length;s++){var o=r[(s+1)%r.length],a=r[s],l=r[(s+2)%r.length],c=l2(a,l,o);if(i=c>0?1:c<0?-1:0,i!==0){if(n&&i!==n)return!1;n=i}}return!0},tagSuggestingArea:function(){return La(this.tags)},isArea:function(){return this.tags.area==="yes"?!0:!this.isClosed()||this.tags.area==="no"?!1:this.tagSuggestingArea()!==null},isDegenerate:function(){return new Set(this.nodes).size<(this.isArea()?3:2)},areAdjacent:function(t,e){for(var r=0;r<this.nodes.length;r++)if(this.nodes[r]===t&&(this.nodes[r-1]===e||this.nodes[r+1]===e))return!0;return!1},geometry:function(t){return t.transient(this,"geometry",function(){return this.isArea()?"area":"line"})},segments:function(t){function e(r){var i=r.hasEntity(this.nodes[0]),n=r.hasEntity(this.nodes[1]);return i&&n&&new le([Math.min(i.loc[0],n.loc[0]),Math.min(i.loc[1],n.loc[1])],[Math.max(i.loc[0],n.loc[0]),Math.max(i.loc[1],n.loc[1])])}return t.transient(this,"segments",function(){for(var r=[],i=0;i<this.nodes.length-1;i++)r.push({id:this.id+"-"+i,wayId:this.id,index:i,nodes:[this.nodes[i],this.nodes[i+1]],extent:e});return r})},close:function(){if(this.isClosed()||!this.nodes.length)return this;var t=this.nodes.slice();return t=t.filter(b4),t.push(t[0]),this.update({nodes:t})},unclose:function(){if(!this.isClosed())return this;for(var t=this.nodes.slice(),e=this.first(),r=t.length-1;r>0&&t.length>1&&t[r]===e;)t.splice(r,1),r=t.length-1;return t=t.filter(b4),this.update({nodes:t})},addNode:function(t,e){var r=this.nodes.slice(),i=this.isClosed(),n=i?r.length-1:r.length;if(e===void 0&&(e=n),e<0||e>n)throw new RangeError("index "+e+" out of range 0.."+n);if(i){for(var s=this.first(),o=1;o<r.length&&r.length>2&&r[o]===s;)r.splice(o,1),e>o&&e--;for(o=r.length-1;o>0&&r.length>1&&r[o]===s;)r.splice(o,1),e>o&&e--,o=r.length-1}return r.splice(e,0,t),r=r.filter(b4),i&&(r.length===1||r[0]!==r[r.length-1])&&r.push(r[0]),this.update({nodes:r})},updateNode:function(t,e){var r=this.nodes.slice(),i=this.isClosed(),n=r.length-1;if(e===void 0||e<0||e>n)throw new RangeError("index "+e+" out of range 0.."+n);if(i){for(var s=this.first(),o=1;o<r.length&&r.length>2&&r[o]===s;)r.splice(o,1),e>o&&e--;for(o=r.length-1;o>0&&r.length>1&&r[o]===s;)r.splice(o,1),e===o&&(e=0),o=r.length-1}return r.splice(e,1,t),r=r.filter(b4),i&&(r.length===1||r[0]!==r[r.length-1])&&r.push(r[0]),this.update({nodes:r})},replaceNode:function(t,e){for(var r=this.nodes.slice(),i=this.isClosed(),n=0;n<r.length;n++)r[n]===t&&(r[n]=e);return r=r.filter(b4),i&&(r.length===1||r[0]!==r[r.length-1])&&r.push(r[0]),this.update({nodes:r})},removeNode:function(t){var e=this.nodes.slice(),r=this.isClosed();return e=e.filter(function(i){return i!==t}).filter(b4),r&&(e.length===1||e[0]!==e[e.length-1])&&e.push(e[0]),this.update({nodes:e})},asJXON:function(t){var e={way:{"@id":this.osmId(),"@version":this.version||0,nd:this.nodes.map(function(r){return{keyAttributes:{ref:Te.id.toOSM(r)}}},this),tag:Object.keys(this.tags).map(function(r){return{keyAttributes:{k:r,v:this.tags[r]}}},this)}};return t&&(e.way["@changeset"]=t),e},asGeoJSON:function(t){return t.transient(this,"GeoJSON",function(){var e=t.childNodes(this).map(function(r){return r.loc});return this.isArea()&&this.isClosed()?{type:"Polygon",coordinates:[e]}:{type:"LineString",coordinates:e}})},area:function(t){return t.transient(this,"area",function(){var e=t.childNodes(this),r={type:"Polygon",coordinates:[e.map(function(n){return n.loc})]};!this.isClosed()&&e.length&&r.coordinates[0].push(e[0].loc);var i=oo(r);return i>2*Math.PI&&(r.coordinates[0]=r.coordinates[0].reverse(),i=oo(r)),isNaN(i)?0:i})}});function b4(t,e,r){return e===0||t!==r[e-1]}function Jc(t,e){if(t.type!=="relation"||!t.isMultipolygon()||Object.keys(t.tags).filter($i).length>1)return!1;var r;for(var i in t.members){var n=t.members[i];if((!n.role||n.role==="outer")&&(r||n.type!=="way"||!e.hasEntity(n.id)||(r=e.entity(n.id),Object.keys(r.tags).filter($i).length===0)))return!1}return r}function Zc(t,e){if(t.type!=="way"||Object.keys(t.tags).filter($i).length===0)return!1;var r=e.parentRelations(t);if(r.length!==1)return!1;var i=r[0];if(!i.isMultipolygon()||Object.keys(i.tags).filter($i).length>1)return!1;for(var n=i.members,s,o=0;o<n.length;o++)if(s=n[o],s.id===t.id&&s.role&&s.role!=="outer"||s.id!==t.id&&(!s.role||s.role==="outer"))return!1;return i}function UE(t,e){if(t.type!=="way")return!1;var r=e.parentRelations(t);if(r.length!==1)return!1;var i=r[0];if(!i.isMultipolygon()||Object.keys(i.tags).filter($i).length>1)return!1;for(var n=i.members,s,o,a=0;a<n.length;a++)if(s=n[a],!s.role||s.role==="outer"){if(o)return!1;o=s}if(!o)return!1;var l=e.hasEntity(o.id);return!l||!Object.keys(l.tags).filter($i).length?!1:l}function En(t,e){function r(m){return e.childNodes(e.entity(m.id))}function i(m){var g=os(m.id,{reverseOneway:!0});return o.actions.push(g),m instanceof Lt?g(e).entity(m.id):m}t=t.filter(function(m){return m.type==="way"&&e.hasEntity(m.id)});var n,s=!0;for(n=0;n<t.length;n++)if(t[n]instanceof Lt){s=!1;break}var o=[];for(o.actions=[];t.length;){for(var a=t.shift(),l=[a],c=r(a).slice();t.length;){var u=c[0],d=c[c.length-1],h=null,p=null;for(n=0;n<t.length;n++)if(a=t[n],p=r(a),s&&l.length===1&&p[0]!==d&&p[p.length-1]!==d&&(p[p.length-1]===u||p[0]===u)&&(l[0]=i(l[0]),c.reverse(),u=c[0],d=c[c.length-1]),p[0]===d){h=c.push,p=p.slice(1);break}else if(p[p.length-1]===d){h=c.push,p=p.slice(0,-1).reverse(),a=i(a);break}else if(p[p.length-1]===u){h=c.unshift,p=p.slice(0,-1);break}else if(p[0]===u){h=c.unshift,p=p.slice(1).reverse(),a=i(a);break}else h=p=null;if(!p)break;h.apply(l,[a]),h.apply(c,p),t.splice(n,1)}l.nodes=c,o.push(l)}return o}function Ql(t,e,r,i){return function(o){var a=o.entity(t),l=/stop|platform/.test(e.role);return(isNaN(r)||i)&&e.type==="way"&&!l?o=n(a,o):(l&&isNaN(r)&&(r=0),o=o.replace(a.addMember(e,r))),o};function n(s,o){var a,l,c,u,d,h,p=[],m=[];for(u=0;u<s.members.length;u++){var g=s.members[u];/stop|platform/.test(g.role)?p.push(g):m.push(g)}if(s=s.update({members:m}),i){l=Lt({id:"wTemp",nodes:i.nodes}),o=o.replace(l);var y={id:l.id,type:"way",role:e.role},v=s.replaceMember({id:i.originalID},y,!0);a=yr(v.members,"type"),a.way=a.way||[]}else a=yr(s.members,"type"),a.way=a.way||[],a.way.push(e);m=C(a.way);var x=En(m,o);for(u=0;u<x.length;u++){var _=x[u],b=_.nodes.slice(),w=_[0].index;for(d=0;d<m.length&&m[d].index!==w;d++);for(h=0;h<_.length;h++){c=_[h];var E=o.entity(c.id);l&&c.id===l.id&&(b[0].id===i.nodes[0]?c.pair=[{id:i.originalID,type:"way",role:c.role},{id:i.insertedID,type:"way",role:c.role}]:c.pair=[{id:i.insertedID,type:"way",role:c.role},{id:i.originalID,type:"way",role:c.role}]),h>0&&(d+h>=m.length||c.index!==m[d+h].index)&&k(m,c.index,d+h),b.splice(0,E.nodes.length-1)}}l&&(o=o.remove(l));var A=[];for(u=0;u<m.length;u++)c=m[u],c.index!==-1&&(c.pair?(A.push(c.pair[0]),A.push(c.pair[1])):A.push(Fi(c,["index"])));var T=p.concat(a.node||[],A,a.relation||[]);return o.replace(s.update({members:T}));function k(I,P,N){var M;for(M=0;M<I.length&&I[M].index!==P;M++);var D=Object.assign({},I[M]);I[M].index=-1,D.index=N,I.splice(N,0,D)}function C(I){for(var P=new Array(I.length),N=0;N<I.length;N++)P[N]=Object.assign({},I[N]),P[N].index=N;return P}}}function VM(t,e,r){return function(i){var n=i.entity(t.from.way),s=i.entity(t.to.way),o=t.via.node&&i.entity(t.via.node),a=t.via.ways&&t.via.ways.map(function(c){return i.entity(c)}),l=[];return l.push({id:n.id,type:"way",role:"from"}),o?l.push({id:o.id,type:"node",role:"via"}):a&&a.forEach(function(c){l.push({id:c.id,type:"way",role:"via"})}),l.push({id:s.id,type:"way",role:"to"}),i.replace(Cr({id:r,tags:{type:"restriction",restriction:e},members:l}))}}function XM(t,e,r,i){return function(n){return n.update(function(s){let o,a;dr(t,s).forEach(function(l){o=i.project(l.loc),a=[o[0]-e[0],o[1]-e[1]],o=[e[0]+r*a[0],e[1]+r*a[1]],s=s.replace(l.move(i.invert(o)))})})}}function WM(t){return function(e){return Qr(t.restrictionID)(e)}}function uV(t,e,r,i,n){var s=Math.abs(i.loc[0]-n.loc[0])>Math.abs(i.loc[1]-n.loc[1]),o=s?function(y,v){return i.loc[0]<n.loc[0]?y.loc[0]-v.loc[0]:v.loc[0]-y.loc[0]}:function(y,v){return i.loc[1]<n.loc[1]?y.loc[1]-v.loc[1]:v.loc[1]-y.loc[1]},a=r.nodes,l=a.indexOf(i.id),c=a.indexOf(n.id);if(l===-1||c===-1||l>=c||o(i,n)>=0)return null;for(var u=l+1;u<c&&o(e,t.entity(a[u]))>0;)u++;var d=t.entity(a[u-1]).loc,h=t.entity(a[u]).loc,p=e.loc,m=Math.abs(d[0]-h[0])>Math.abs(d[1]-h[1])?(p[0]-d[0])/(h[0]-d[0]):(p[1]-d[1])/(h[1]-d[1]),g=Ct(d,h,m);return{insertIdx:u,interpLoc:g}}function tx(t,e){return Math.abs(t[0]-e[0])>2e-5||Math.abs(t[1]-e[1])>2e-5}function H9(t){delete t.__fbid__,delete t.__origid__,delete t.__service__,delete t.__datasetid__,delete t.tags.conn,delete t.tags.dupe}function Qh(t,e){return function(r){var i={},n=e.entity(t);return n.type==="node"?s(n):n.type==="way"?o(n):n.type==="relation"&&a(n),r;function s(l){var c=je(l);return c.tags=Object.assign({},c.tags),H9(c),r=r.replace(c),c}function o(l){var c=Lt(l);c.nodes=l.nodes.slice(),c.tags=Object.assign({},c.tags),H9(c);var u=c.nodes.map(function(d){var h=je(e.entity(d));h.tags=Object.assign({},h.tags);var p=h.tags.conn&&h.tags.conn.split(","),m=h.tags.dupe;if(H9(h),m&&r.hasEntity(m)&&!tx(r.entity(m).loc,h.loc)?h=r.entity(m):r.hasEntity(h.id)&&tx(r.entity(h.id).loc,h.loc)&&(h=je({loc:h.loc})),p&&r.hasEntity(p[0])){var g=r.hasEntity(p[0]),y=r.hasEntity(p[1]),v=r.hasEntity(p[2]);if(g&&y&&v){var x=uV(r,h,g,y,v);x&&!tx(x.interpLoc,h.loc)&&(h.loc=x.interpLoc,r=r.replace(g.addNode(h.id,x.insertIdx)))}}return r=r.replace(h),h.id});return c=c.update({nodes:u}),r=r.replace(c),c}function a(l){var c=i[l.id];if(c)return c;var u=Cr(l);u.members=l.members.slice(),u.tags=Object.assign({},l.tags),H9(u);var d=u.members.map(function(h){var p=e.entity(h.id),m;return p.type==="node"?m=s(p):p.type==="way"?m=o(p):p.type==="relation"&&(m=a(p)),Object.assign(h,{id:m.id})});return u=u.update({members:d}),r=r.replace(u),i[l.id]=u,u}}}function qM(){var t=["building","highway","railway","waterway","aeroway","aerialway","piste:type","boundary","power","amenity","natural","landuse","leisure","military","place","man_made","route","attraction","building:part","indoor"],e=Object.keys(Oa),r=["oneway","bridge","tunnel","embankment","cutting","barrier","surface","tracktype","footway","crossing","service","sport","public_transport","location","parking","golf","type","leisure","man_made","indoor"],i=function(s){return s.tags},n=function(s){s.each(function(a){var l=this.className;l.baseVal!==void 0&&(l=l.baseVal);var c=i(a),u=n.getClassesString(c,l);u!==l&&H(this).attr("class",u)})};return n.getClassesString=function(s,o){var a,l,c,u,d,h,p;/\bstroke\b/.test(o)&&s.barrier&&s.barrier!=="no"&&(p="line");var m=o.trim().split(/\s+/).filter(function(v){return v.length&&!/^tag-/.test(v)}).map(function(v){return(v==="line"||v==="area")&&p||v});for(c=0;c<t.length;c++)if(d=t[c],h=s[d],!(!h||h==="no")){d==="piste:type"?d="piste":d==="building:part"&&(d="building_part"),a=d,e.indexOf(h)!==-1?(l=h,m.push("tag-"+d)):(m.push("tag-"+d),m.push("tag-"+d+"-"+h));break}if(!a){for(c=0;c<e.length;c++)for(u=0;u<t.length;u++)if(d=e[c]+":"+t[u],h=s[d],!(!h||h==="no")){l=e[c];break}}if(!l)for(c=0;c<e.length&&(d=e[c],h=s[d],!(!(!h||h==="no")&&(h==="yes"||a&&a===h?l=d:!a&&t.indexOf(h)!==-1&&(l=d,a=h,m.push("tag-"+h)),l)));c++);for(l&&(m.push("tag-status"),m.push("tag-status-"+l)),c=0;c<r.length;c++)d=r[c],h=s[d],!(!h||h==="no"||d===a)&&(m.push("tag-"+d),m.push("tag-"+d+"-"+h));if(a==="highway"&&!Ps[s.highway]||a==="aeroway"){var g=s.highway==="track"?"unpaved":"paved";for(d in s)h=s[d],d in Bl&&(g=Bl[d][h]?"paved":"unpaved"),d in J9&&J9[d][h]&&(g="semipaved");m.push("tag-"+g)}var y=s.wikidata||s["flag:wikidata"]||s["brand:wikidata"]||s["network:wikidata"]||s["operator:wikidata"];return y&&m.push("tag-wikidata"),m.join(" ").trim()},n.tags=function(s){return arguments.length?(i=s,n):i},n}function YM(t){return e=>{if(t.history().hasRestorableChanges())return;let r="",i=ee("sawPrivacyVersion"),n=!ee("sawSplash");if(i!==t.privacyVersion&&(r=S("splash.privacy_update"),n=!0),!n)return;ee("sawSplash",!0),ee("sawPrivacyVersion",t.privacyVersion),Qe.get("intro_graph");let s=Er(e);s.select(".modal").attr("class","modal-splash modal");let o=s.select(".content").append("div").attr("class","fillL");o.append("div").attr("class","modal-section").append("h3").html(S.html("splash.welcome"));let a=o.append("div").attr("class","modal-section");a.append("p").html(S.html("splash.text",{version:t.version,website:'<a target="_blank" href="https://github.com/openstreetmap/iD/blob/develop/CHANGELOG.md#whats-new">changelog</a>',github:'<a target="_blank" href="https://github.com/openstreetmap/iD/issues">github.com</a>'})),a.append("p").html(S.html("splash.privacy",{updateMessage:r,privacyLink:'<a target="_blank" href="https://github.com/openstreetmap/iD/blob/release/PRIVACY.md">'+S("splash.privacy_policy")+"</a>"}));let l=o.append("div").attr("class","modal-actions"),c=l.append("button").attr("class","walkthrough").on("click",()=>{t.container().call(Qs(t)),s.close()});c.append("svg").attr("class","logo logo-walkthrough").append("use").attr("xlink:href","#rapid-logo-walkthrough"),c.append("div").html(S.html("splash.walkthrough"));let u=l.append("button").attr("class","start-editing").on("click",s.close);u.append("svg").attr("class","logo logo-features").append("use").attr("xlink:href","#rapid-logo-features"),u.append("div").html(S.html("splash.start")),s.select("button.close").attr("class","hide")}}var{abs:i7t,max:n7t,min:s7t}=Math;function QM(t){return[+t[0],+t[1]]}function fV(t){return[QM(t[0]),QM(t[1])]}var o7t={name:"x",handles:["w","e"].map(rx),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},a7t={name:"y",handles:["n","s"].map(rx),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},l7t={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(rx),input:function(t){return t==null?null:fV(t)},output:function(t){return t}};function rx(t){return{type:t}}var hV={dispatch:fe,polygonArea:bc,polygonCentroid:yn,select:H,selectAll:w8,timerFlush:Mf},pV={Projection:Qi,Extent:le,geoSphericalDistance:Tt,geoZoomToScale:di,vecLength:ut,utilQsString:xt,utilStringQs:Fn};window.requestIdleCallback=window.requestIdleCallback||function(t){var e=Date.now();return window.requestAnimationFrame(function(){t({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-e))}})})};window.cancelIdleCallback=window.cancelIdleCallback||function(t){window.cancelAnimationFrame(t)};window.Rapid=$9;window.iD=$9;})();
//# sourceMappingURL=rapid.min.js.map
